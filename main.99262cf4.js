parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function Am(a){return a&&a.__esModule?{d:a.default}:{d:a}}var Rb=this;var a=(Ad(),Vb).Buffer;function Bm(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,a)}return t}function Cm(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?Bm(Object(t),!0).forEach(function(e){_x(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):Bm(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function _x(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function Dm(r,e){return dy(r)||cy(r,e)||by(r,e)||ay()}function ay(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function by(r,e){if(r){if("string"==typeof r)return Em(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Em(r,e):void 0}}function Em(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=r[t];return a}function cy(r,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var t=[],a=!0,n=!1,o=void 0;try{for(var $,c=r[Symbol.iterator]();!(a=($=c.next()).done)&&(t.push($.value),!e||t.length!==e);a=!0);}catch(i){n=!0,o=i}finally{try{a||null==c.return||c.return()}finally{if(n)throw o}}return t}}function dy(r){if(Array.isArray(r))return r}var kf,lf,yd,Ab,Vf,Od,Hj,Fm,ey=false;function Ij(){throw new Error("setTimeout has not been defined")}function Jj(){throw new Error("clearTimeout has not been defined")}function Gm($){if(kf===setTimeout)return setTimeout($,0);if((kf===Ij||!kf)&&setTimeout)return kf=setTimeout,setTimeout($,0);try{return kf($,0)}catch(e){try{return kf.call(null,$,0)}catch(e){return kf.call(this,$,0)}}}function fy($){if(lf===clearTimeout)return clearTimeout($);if((lf===Jj||!lf)&&clearTimeout)return lf=clearTimeout,clearTimeout($);try{return lf($)}catch(e){try{return lf.call(null,$)}catch(e){return lf.call(this,$)}}}function gy(){Hj&&Vf&&(Hj=!1,Vf.length?Od=Vf.concat(Od):Fm=-1,Od.length&&Hm())}function Hm(){if(!Hj){var $=Gm(gy);Hj=!0;for(var e=Od.length;e;){for(Vf=Od,Od=[];++Fm<e;)Vf&&Vf[Fm].run();Fm=-1,e=Od.length}Vf=null,Hj=!1,fy($)}}function Im($,e){this.fun=$,this.array=e}function jd(){}function zd(){if(ey)return;ey=true;yd={};Ab=yd={};!function(){try{kf="function"==typeof setTimeout?setTimeout:Ij}catch($){kf=Ij}try{lf="function"==typeof clearTimeout?clearTimeout:Jj}catch($){lf=Jj}}();Od=[];Hj=!1;Fm=-1;Ab.nextTick=function($){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Od.push(new Im($,e)),1!==Od.length||Hj||Gm(Hm)},Im.prototype.run=function(){this.fun.apply(null,this.array)},Ab.title="browser",Ab.env={},Ab.argv=[],Ab.version="",Ab.versions={},Ab.on=jd,Ab.addListener=jd,Ab.once=jd,Ab.off=jd,Ab.removeListener=jd,Ab.removeAllListeners=jd,Ab.emit=jd,Ab.prependListener=jd,Ab.prependOnceListener=jd,Ab.listeners=function($){return[]},Ab.binding=function($){throw new Error("process.binding is not supported")},Ab.cwd=function(){return"/"},Ab.chdir=function($){throw new Error("process.chdir is not supported")},Ab.umask=function(){return 0}}var Zb={},Jm=(zd(),yd),hy=zy;Zb.log=hy;var iy=yy;Zb.formatArgs=iy;var jy=Ay;Zb.save=jy;var ky=By;Zb.load=ky;var ly=xy;var my,mf,nf,of,Pd,ny,oy,py=false;function qy($){if(!(($=String($)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec($);if(r){var a=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*oy;case"weeks":case"week":case"w":return a*ny;case"days":case"day":case"d":return a*Pd;case"hours":case"hour":case"hrs":case"hr":case"h":return a*of;case"minutes":case"minute":case"mins":case"min":case"m":return a*nf;case"seconds":case"second":case"secs":case"sec":case"s":return a*mf;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return;}}}}function ry($){var r=Math.abs($);return r>=Pd?Math.round($/Pd)+"d":r>=of?Math.round($/of)+"h":r>=nf?Math.round($/nf)+"m":r>=mf?Math.round($/mf)+"s":$+"ms"}function sy($){var r=Math.abs($);return r>=Pd?Cg($,r,Pd,"day"):r>=of?Cg($,r,of,"hour"):r>=nf?Cg($,r,nf,"minute"):r>=mf?Cg($,r,mf,"second"):$+" ms"}function Cg($,r,a,s){var e=r>=1.5*a;return Math.round($/a)+" "+s+(e?"s":"")}function ty(){if(py)return;py=true;my={};mf=1e3;nf=60*mf;of=60*nf;Pd=24*of;ny=7*Pd;oy=365.25*Pd;my=function($,r){r=r||{};var a=typeof $;if("string"===a&&$.length>0)return qy($);if("number"===a&&isFinite($))return r.long?sy($):ry($);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify($))}}var uy={};function vy(e){function n(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]}function t(e){let o;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),r=s-(o||s);n.diff=r,n.prev=o,n.curr=s,o=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(s,r)=>{if("%%"===s)return s;i++;const o=t.formatters[r];if("function"==typeof o){const t=e[i];s=o.call(n,t),e.splice(i,1),i--}return s}),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.enabled=t.enabled(e),a.useColors=t.useColors(),a.color=n(e),a.destroy=s,a.extend=r,"function"==typeof t.init&&t.init(a),t.instances.push(a),a}function s(){const e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function r(e,n){const s=t(this.namespace+(void 0===n?":":n)+e);return s.log=this.log,s}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const s=("string"==typeof e?e:"").split(/[\s,]+/),r=s.length;for(n=0;n<r;n++)s[n]&&("-"===(e=s[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){const e=t.instances[n];e.enabled=t.enabled(e.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,s;for(n=0,s=t.skips.length;n<s;n++)if(t.skips[n].test(e))return!1;for(n=0,s=t.names.length;n<s;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=(ty(),my),Object.keys(e).forEach(n=>{t[n]=e[n]}),t.instances=[],t.names=[],t.skips=[],t.formatters={},t.selectColor=n,t.enable(t.load()),t}uy=vy;Zb.useColors=ly;var Dg=Cy();Zb.storage=Dg;var wy=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function xy(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function yy(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Zb.humanize(this.diff),!this.useColors)return;const o="color: "+this.color;e.splice(1,0,o,"color: inherit");let r=0,t=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(t=r))}),e.splice(t,0,o)}function zy(...e){return"object"==typeof console&&console.log&&console.log(...e)}function Ay(e){try{e?Dg.setItem("debug",e):Dg.removeItem("debug")}catch(o){}}function By(){let e;try{e=Dg.getItem("debug")}catch(o){}return!e&&void 0!==Jm&&"env"in Jm&&(e=void 0),e}function Cy(){try{return localStorage}catch(e){}}Zb.colors=wy,Zb=uy(Zb);const{formatters:Dy}=Zb;Dy.j=function(e){try{return JSON.stringify(e)}catch(o){return"[UnexpectedJSONParseError]: "+o.message}};var Km={};Km=function(){if("undefined"==typeof window)return null;var n={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return n.RTCPeerConnection?n:null};var Eg,Ey,Fy,Gy,Hy=false;function Lm($){var r=$.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=$.indexOf("=");return-1===p&&(p=r),[p,p===r?0:4-p%4]}function Iy($){var r=Lm($),p=r[0],o=r[1];return 3*(p+o)/4-o}function Jy($,r,p){return 3*(r+p)/4-p}function Ky($){var r,p,o=Lm($),e=o[0],y=o[1],h=new $yh9p$var$Arr(Jy($,e,y)),a=0,t=y>0?e-4:e;for(p=0;p<t;p+=4)r=$yh9p$var$revLookup[$.charCodeAt(p)]<<18|$yh9p$var$revLookup[$.charCodeAt(p+1)]<<12|$yh9p$var$revLookup[$.charCodeAt(p+2)]<<6|$yh9p$var$revLookup[$.charCodeAt(p+3)],h[a++]=r>>16&255,h[a++]=r>>8&255,h[a++]=255&r;return 2===y&&(r=$yh9p$var$revLookup[$.charCodeAt(p)]<<2|$yh9p$var$revLookup[$.charCodeAt(p+1)]>>4,h[a++]=255&r),1===y&&(r=$yh9p$var$revLookup[$.charCodeAt(p)]<<10|$yh9p$var$revLookup[$.charCodeAt(p+1)]<<4|$yh9p$var$revLookup[$.charCodeAt(p+2)]>>2,h[a++]=r>>8&255,h[a++]=255&r),h}function Ly($){return $yh9p$var$lookup[$>>18&63]+$yh9p$var$lookup[$>>12&63]+$yh9p$var$lookup[$>>6&63]+$yh9p$var$lookup[63&$]}function My($,r,p){for(var o,e=[],y=r;y<p;y+=3)o=($[y]<<16&16711680)+($[y+1]<<8&65280)+(255&$[y+2]),e.push(Ly(o));return e.join("")}function Ny($){for(var r,p=$.length,o=p%3,e=[],y=0,h=p-o;y<h;y+=16383)e.push(My($,y,y+16383>h?h:y+16383));return 1===o?(r=$[p-1],e.push($yh9p$var$lookup[r>>2]+$yh9p$var$lookup[r<<4&63]+"==")):2===o&&(r=($[p-2]<<8)+$[p-1],e.push($yh9p$var$lookup[r>>10]+$yh9p$var$lookup[r>>4&63]+$yh9p$var$lookup[r<<2&63]+"=")),e.join("")}function Oy(){if(Hy)return;Hy=true;Eg={};Ey=Iy;Eg.byteLength=Ey;Fy=Ky;Eg.toByteArray=Fy;Gy=Ny;Eg.fromByteArray=Gy;for(var $yh9p$var$lookup=[],$yh9p$var$revLookup=[],$yh9p$var$Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,$yh9p$var$code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$yh9p$var$i=0,$yh9p$var$len=$yh9p$var$code.length;$yh9p$var$i<$yh9p$var$len;++$yh9p$var$i)$yh9p$var$lookup[$yh9p$var$i]=$yh9p$var$code[$yh9p$var$i],$yh9p$var$revLookup[$yh9p$var$code.charCodeAt($yh9p$var$i)]=$yh9p$var$i;$yh9p$var$revLookup["-".charCodeAt(0)]=62,$yh9p$var$revLookup["_".charCodeAt(0)]=63}var Kj,Py,Qy,Ry=false;function Sy(){if(Ry)return;Ry=true;Kj={};Py=function(t,r,o,a,$){var e,p,J=8*$-a-1,N=(1<<J)-1,h=N>>1,M=-7,w=o?$-1:0,f=o?-1:1,i=t[r+w];for(w+=f,e=i&(1<<-M)-1,i>>=-M,M+=J;M>0;e=256*e+t[r+w],w+=f,M-=8);for(p=e&(1<<-M)-1,e>>=-M,M+=a;M>0;p=256*p+t[r+w],w+=f,M-=8);if(0===e)e=1-h;else{if(e===N)return p?NaN:1/0*(i?-1:1);p+=Math.pow(2,a),e-=h}return(i?-1:1)*p*Math.pow(2,e-a)};Kj.read=Py;Qy=function(t,r,o,a,$,e){var p,J,N,h=8*e-$-1,M=(1<<h)-1,w=M>>1,f=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,i=a?0:e-1,g=a?1:-1,s=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(J=isNaN(r)?1:0,p=M):(p=Math.floor(Math.log(r)/Math.LN2),r*(N=Math.pow(2,-p))<1&&(p--,N*=2),(r+=p+w>=1?f/N:f*Math.pow(2,1-w))*N>=2&&(p++,N/=2),p+w>=M?(J=0,p=M):p+w>=1?(J=(r*N-1)*Math.pow(2,$),p+=w):(J=r*Math.pow(2,w-1)*Math.pow(2,$),p=0));$>=8;t[o+i]=255&J,i+=g,J/=256,$-=8);for(p=p<<$|J,h+=$;h>0;t[o+i]=255&p,i+=g,p/=256,h-=8);t[o+i-g]|=128*s};Kj.write=Qy}var Ty,Uy,Vy=false;function Wy(){if(Vy)return;Vy=true;Ty={};Uy={}.toString;Ty=Array.isArray||function(r){return"[object Array]"==Uy.call(r)}}var Vb,Lj,pf,Mm,Xy,Yy,Nm,Zy,Om,$y,_y=false;function az(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(r){return!1}}function Fg(){return bb.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function kd(e,r){if(Fg()<r)throw new RangeError("Invalid typed array length");return bb.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(r)).__proto__=bb.prototype:(null===e&&(e=new bb(r)),e.length=r),e}function bb(e,r,t){if(!(bb.TYPED_ARRAY_SUPPORT||this instanceof bb))return new bb(e,r,t);if("number"==typeof e){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return Mj(this,e)}return Pm(this,e,r,t)}function Pm(e,r,t,$){if("number"==typeof r)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?dz(e,r,t,$):"string"==typeof r?cz(e,r,t):ez(e,r)}function Qm(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be a number");if(e<0)throw new RangeError("\"size\" argument must not be negative")}function bz(e,r,t,$){return Qm(r),r<=0?kd(e,r):void 0!==t?"string"==typeof $?kd(e,r).fill(t,$):kd(e,r).fill(t):kd(e,r)}function Mj(e,r){if(Qm(r),e=kd(e,r<0?0:0|Oj(r)),!bb.TYPED_ARRAY_SUPPORT)for(var t=0;t<r;++t)e[t]=0;return e}function cz(e,r,t){if("string"==typeof t&&""!==t||(t="utf8"),!bb.isEncoding(t))throw new TypeError("\"encoding\" must be a valid string encoding");var $=0|Rm(r,t),n=(e=kd(e,$)).write(r,t);return n!==$&&(e=e.slice(0,n)),e}function Nj(e,r){var t=r.length<0?0:0|Oj(r.length);e=kd(e,t);for(var $=0;$<t;$+=1)e[$]=255&r[$];return e}function dz(e,r,t,$){if(r.byteLength,t<0||r.byteLength<t)throw new RangeError("'offset' is out of bounds");if(r.byteLength<t+($||0))throw new RangeError("'length' is out of bounds");return r=void 0===t&&void 0===$?new Uint8Array(r):void 0===$?new Uint8Array(r,t):new Uint8Array(r,t,$),bb.TYPED_ARRAY_SUPPORT?(e=r).__proto__=bb.prototype:e=Nj(e,r),e}function ez(e,r){if(bb.isBuffer(r)){var t=0|Oj(r.length);return 0===(e=kd(e,t)).length?e:(r.copy(e,0,0,t),e)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||xz(r.length)?kd(e,0):Nj(e,r);if("Buffer"===r.type&&Mm(r.data))return Nj(e,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Oj(e){if(e>=Fg())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Fg().toString(16)+" bytes");return 0|e}function fz(e){return+e!=e&&(e=0),bb.alloc(+e)}function Rm(e,r){if(bb.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var t=e.length;if(0===t)return 0;for(var $=!1;;)switch(r){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":case void 0:return Ig(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t;case"hex":return t>>>1;case"base64":return Zm(e).length;default:if($)return Ig(e).length;r=(""+r).toLowerCase(),$=!0;}}function gz(e,r,t){var $=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===t||t>this.length)&&(t=this.length),t<=0)return"";if((t>>>=0)<=(r>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return qz(this,r,t);case"utf8":case"utf-8":return Vm(this,r,t);case"ascii":return oz(this,r,t);case"latin1":case"binary":return pz(this,r,t);case"base64":return mz(this,r,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return rz(this,r,t);default:if($)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),$=!0;}}function Qd(e,r,t){var $=e[r];e[r]=e[t],e[t]=$}function Sm(e,r,t,$,n){if(0===e.length)return-1;if("string"==typeof t?($=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,isNaN(t)&&(t=n?0:e.length-1),t<0&&(t=e.length+t),t>=e.length){if(n)return-1;t=e.length-1}else if(t<0){if(!n)return-1;t=0}if("string"==typeof r&&(r=bb.from(r,$)),bb.isBuffer(r))return 0===r.length?-1:Tm(e,r,t,$,n);if("number"==typeof r)return r&=255,bb.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,r,t):Uint8Array.prototype.lastIndexOf.call(e,r,t):Tm(e,[r],t,$,n);throw new TypeError("val must be string, number or Buffer")}function Tm(e,r,t,$,n){var f,a=1,i=e.length,o=r.length;if(void 0!==$&&("ucs2"===($=String($).toLowerCase())||"ucs-2"===$||"utf16le"===$||"utf-16le"===$)){if(e.length<2||r.length<2)return-1;a=2,i/=2,o/=2,t/=2}function u(e,r){return 1===a?e[r]:e.readUInt16BE(r*a)}if(n){var p=-1;for(f=t;f<i;f++)if(u(e,f)===u(r,-1===p?0:f-p)){if(-1===p&&(p=f),f-p+1===o)return p*a}else-1!==p&&(f-=f-p),p=-1}else for(t+o>i&&(t=i-o),f=t;f>=0;f--){for(var s=!0,h=0;h<o;h++)if(u(e,f+h)!==u(r,h)){s=!1;break}if(s)return f}return-1}function hz(e,r,t,$){t=Number(t)||0;var n=e.length-t;$?($=Number($))>n&&($=n):$=n;var f=r.length;if(f%2!=0)throw new TypeError("Invalid hex string");$>f/2&&($=f/2);for(var a=0;a<$;++a){var i=parseInt(r.substr(2*a,2),16);if(isNaN(i))return a;e[t+a]=i}return a}function iz(e,r,t,$){return Jg(Ig(r,e.length-t),e,t,$)}function Um(e,r,t,$){return Jg(vz(r),e,t,$)}function jz(e,r,t,$){return Um(e,r,t,$)}function kz(e,r,t,$){return Jg(Zm(r),e,t,$)}function lz(e,r,t,$){return Jg(wz(r,e.length-t),e,t,$)}function mz(e,r,t){return 0===r&&t===e.length?Lj.fromByteArray(e):Lj.fromByteArray(e.slice(r,t))}function Vm(e,r,t){t=Math.min(e.length,t);for(var $=[],n=r;n<t;){var f,a,i,o,u=e[n],p=null,s=u>239?4:u>223?3:u>191?2:1;if(n+s<=t)switch(s){case 1:u<128&&(p=u);break;case 2:128==(192&(f=e[n+1]))&&(o=(31&u)<<6|63&f)>127&&(p=o);break;case 3:f=e[n+1],a=e[n+2],128==(192&f)&&128==(192&a)&&(o=(15&u)<<12|(63&f)<<6|63&a)>2047&&(o<55296||o>57343)&&(p=o);break;case 4:f=e[n+1],a=e[n+2],i=e[n+3],128==(192&f)&&128==(192&a)&&128==(192&i)&&(o=(15&u)<<18|(63&f)<<12|(63&a)<<6|63&i)>65535&&o<1114112&&(p=o);}null===p?(p=65533,s=1):p>65535&&(p-=65536,$.push(p>>>10&1023|55296),p=56320|1023&p),$.push(p),n+=s}return nz($)}function nz(e){var r=e.length;if(r<=Om)return String.fromCharCode.apply(String,e);for(var t="",$=0;$<r;)t+=String.fromCharCode.apply(String,e.slice($,$+=Om));return t}function oz(e,r,t){var $="";t=Math.min(e.length,t);for(var n=r;n<t;++n)$+=String.fromCharCode(127&e[n]);return $}function pz(e,r,t){var $="";t=Math.min(e.length,t);for(var n=r;n<t;++n)$+=String.fromCharCode(e[n]);return $}function qz(e,r,t){var $=e.length;(!r||r<0)&&(r=0),(!t||t<0||t>$)&&(t=$);for(var n="",f=r;f<t;++f)n+=uz(e[f]);return n}function rz(e,r,t){for(var $=e.slice(r,t),n="",f=0;f<$.length;f+=2)n+=String.fromCharCode($[f]+256*$[f+1]);return n}function Fb(e,r,t){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+r>t)throw new RangeError("Trying to access beyond buffer length")}function Pb(e,r,t,$,n,f){if(!bb.isBuffer(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(r>n||r<f)throw new RangeError("\"value\" argument is out of bounds");if(t+$>e.length)throw new RangeError("Index out of range")}function Gg(e,r,t,$){r<0&&(r=65535+r+1);for(var n=0,f=Math.min(e.length-t,2);n<f;++n)e[t+n]=(r&255<<8*($?n:1-n))>>>8*($?n:1-n)}function Hg(e,r,t,$){r<0&&(r=4294967295+r+1);for(var n=0,f=Math.min(e.length-t,4);n<f;++n)e[t+n]=r>>>8*($?n:3-n)&255}function Wm(e,r,t,$,n,f){if(t+$>e.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Xm(e,r,t,$,n){return n||Wm(e,r,t,4,3.4028234663852886e38,-3.4028234663852886e38),pf.write(e,r,t,$,23,4),t+4}function Ym(e,r,t,$,n){return n||Wm(e,r,t,8,1.7976931348623157e308,-1.7976931348623157e308),pf.write(e,r,t,$,52,8),t+8}function sz(e){if((e=tz(e).replace($y,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function tz(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function uz(e){return e<16?"0"+e.toString(16):e.toString(16)}function Ig(e,r){var t;r=r||1/0;for(var $=e.length,n=null,f=[],a=0;a<$;++a){if((t=e.charCodeAt(a))>55295&&t<57344){if(!n){if(t>56319){(r-=3)>-1&&f.push(239,191,189);continue}if(a+1===$){(r-=3)>-1&&f.push(239,191,189);continue}n=t;continue}if(t<56320){(r-=3)>-1&&f.push(239,191,189),n=t;continue}t=65536+(n-55296<<10|t-56320)}else n&&(r-=3)>-1&&f.push(239,191,189);if(n=null,t<128){if((r-=1)<0)break;f.push(t)}else if(t<2048){if((r-=2)<0)break;f.push(t>>6|192,63&t|128)}else if(t<65536){if((r-=3)<0)break;f.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;f.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return f}function vz(e){for(var r=[],t=0;t<e.length;++t)r.push(255&e.charCodeAt(t));return r}function wz(e,r){for(var t,$,n,f=[],a=0;a<e.length&&!((r-=2)<0);++a)$=(t=e.charCodeAt(a))>>8,n=t%256,f.push(n),f.push($);return f}function Zm(e){return Lj.toByteArray(sz(e))}function Jg(e,r,t,$){for(var n=0;n<$&&!(n+t>=r.length||n>=e.length);++n)r[n+t]=e[n];return n}function xz(e){return e!=e}function Ad(){if(_y)return;_y=true;Vb={};Lj=(Oy(),Eg);pf=(Sy(),Kj);Mm=(Wy(),Ty);Xy=bb;Vb.Buffer=Xy;Yy=fz;Vb.SlowBuffer=Yy;Nm=50;Vb.INSPECT_MAX_BYTES=Nm,bb.TYPED_ARRAY_SUPPORT=void 0!==Rb.TYPED_ARRAY_SUPPORT?Rb.TYPED_ARRAY_SUPPORT:az();Zy=Fg();Vb.kMaxLength=Zy,bb.poolSize=8192,bb._augment=function(e){return e.__proto__=bb.prototype,e},bb.from=function(e,r,t){return Pm(null,e,r,t)},bb.TYPED_ARRAY_SUPPORT&&(bb.prototype.__proto__=Uint8Array.prototype,bb.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&bb[Symbol.species]===bb&&Object.defineProperty(bb,Symbol.species,{value:null,configurable:!0})),bb.alloc=function(e,r,t){return bz(null,e,r,t)},bb.allocUnsafe=function(e){return Mj(null,e)},bb.allocUnsafeSlow=function(e){return Mj(null,e)},bb.isBuffer=function(e){return!(null==e||!e._isBuffer)},bb.compare=function(e,r){if(!bb.isBuffer(e)||!bb.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var t=e.length,$=r.length,n=0,f=Math.min(t,$);n<f;++n)if(e[n]!==r[n]){t=e[n],$=r[n];break}return t<$?-1:$<t?1:0},bb.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},bb.concat=function(e,r){if(!Mm(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return bb.alloc(0);var t;if(void 0===r)for(r=0,t=0;t<e.length;++t)r+=e[t].length;var $=bb.allocUnsafe(r),n=0;for(t=0;t<e.length;++t){var f=e[t];if(!bb.isBuffer(f))throw new TypeError("\"list\" argument must be an Array of Buffers");f.copy($,n),n+=f.length}return $},bb.byteLength=Rm,bb.prototype._isBuffer=!0,bb.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)Qd(this,r,r+1);return this},bb.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)Qd(this,r,r+3),Qd(this,r+1,r+2);return this},bb.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)Qd(this,r,r+7),Qd(this,r+1,r+6),Qd(this,r+2,r+5),Qd(this,r+3,r+4);return this},bb.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?Vm(this,0,e):gz.apply(this,arguments)},bb.prototype.equals=function(e){if(!bb.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===bb.compare(this,e)},bb.prototype.inspect=function(){var e="",r=Nm;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},bb.prototype.compare=function(e,r,t,$,n){if(!bb.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===t&&(t=e?e.length:0),void 0===$&&($=0),void 0===n&&(n=this.length),r<0||t>e.length||$<0||n>this.length)throw new RangeError("out of range index");if($>=n&&r>=t)return 0;if($>=n)return-1;if(r>=t)return 1;if(this===e)return 0;for(var f=(n>>>=0)-($>>>=0),a=(t>>>=0)-(r>>>=0),i=Math.min(f,a),o=this.slice($,n),u=e.slice(r,t),p=0;p<i;++p)if(o[p]!==u[p]){f=o[p],a=u[p];break}return f<a?-1:a<f?1:0},bb.prototype.includes=function(e,r,t){return-1!==this.indexOf(e,r,t)},bb.prototype.indexOf=function(e,r,t){return Sm(this,e,r,t,!0)},bb.prototype.lastIndexOf=function(e,r,t){return Sm(this,e,r,t,!1)},bb.prototype.write=function(e,r,t,$){if(void 0===r)$="utf8",t=this.length,r=0;else if(void 0===t&&"string"==typeof r)$=r,t=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(t)?(t|=0,void 0===$&&($="utf8")):($=t,t=void 0)}var n=this.length-r;if((void 0===t||t>n)&&(t=n),e.length>0&&(t<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");$||($="utf8");for(var f=!1;;)switch($){case"hex":return hz(this,e,r,t);case"utf8":case"utf-8":return iz(this,e,r,t);case"ascii":return Um(this,e,r,t);case"latin1":case"binary":return jz(this,e,r,t);case"base64":return kz(this,e,r,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return lz(this,e,r,t);default:if(f)throw new TypeError("Unknown encoding: "+$);$=(""+$).toLowerCase(),f=!0;}},bb.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};Om=4096;bb.prototype.slice=function(e,r){var t,$=this.length;if((e=~~e)<0?(e+=$)<0&&(e=0):e>$&&(e=$),(r=void 0===r?$:~~r)<0?(r+=$)<0&&(r=0):r>$&&(r=$),r<e&&(r=e),bb.TYPED_ARRAY_SUPPORT)(t=this.subarray(e,r)).__proto__=bb.prototype;else{var n=r-e;t=new bb(n,void 0);for(var f=0;f<n;++f)t[f]=this[f+e]}return t},bb.prototype.readUIntLE=function(e,r,t){e|=0,r|=0,t||Fb(e,r,this.length);for(var $=this[e],n=1,f=0;++f<r&&(n*=256);)$+=this[e+f]*n;return $},bb.prototype.readUIntBE=function(e,r,t){e|=0,r|=0,t||Fb(e,r,this.length);for(var $=this[e+--r],n=1;r>0&&(n*=256);)$+=this[e+--r]*n;return $},bb.prototype.readUInt8=function(e,r){return r||Fb(e,1,this.length),this[e]},bb.prototype.readUInt16LE=function(e,r){return r||Fb(e,2,this.length),this[e]|this[e+1]<<8},bb.prototype.readUInt16BE=function(e,r){return r||Fb(e,2,this.length),this[e]<<8|this[e+1]},bb.prototype.readUInt32LE=function(e,r){return r||Fb(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},bb.prototype.readUInt32BE=function(e,r){return r||Fb(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},bb.prototype.readIntLE=function(e,r,t){e|=0,r|=0,t||Fb(e,r,this.length);for(var $=this[e],n=1,f=0;++f<r&&(n*=256);)$+=this[e+f]*n;return $>=(n*=128)&&($-=Math.pow(2,8*r)),$},bb.prototype.readIntBE=function(e,r,t){e|=0,r|=0,t||Fb(e,r,this.length);for(var $=r,n=1,f=this[e+--$];$>0&&(n*=256);)f+=this[e+--$]*n;return f>=(n*=128)&&(f-=Math.pow(2,8*r)),f},bb.prototype.readInt8=function(e,r){return r||Fb(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},bb.prototype.readInt16LE=function(e,r){r||Fb(e,2,this.length);var t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},bb.prototype.readInt16BE=function(e,r){r||Fb(e,2,this.length);var t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},bb.prototype.readInt32LE=function(e,r){return r||Fb(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},bb.prototype.readInt32BE=function(e,r){return r||Fb(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},bb.prototype.readFloatLE=function(e,r){return r||Fb(e,4,this.length),pf.read(this,e,!0,23,4)},bb.prototype.readFloatBE=function(e,r){return r||Fb(e,4,this.length),pf.read(this,e,!1,23,4)},bb.prototype.readDoubleLE=function(e,r){return r||Fb(e,8,this.length),pf.read(this,e,!0,52,8)},bb.prototype.readDoubleBE=function(e,r){return r||Fb(e,8,this.length),pf.read(this,e,!1,52,8)},bb.prototype.writeUIntLE=function(e,r,t,$){(e=+e,r|=0,t|=0,$)||Pb(this,e,r,t,Math.pow(2,8*t)-1,0);var n=1,f=0;for(this[r]=255&e;++f<t&&(n*=256);)this[r+f]=e/n&255;return r+t},bb.prototype.writeUIntBE=function(e,r,t,$){(e=+e,r|=0,t|=0,$)||Pb(this,e,r,t,Math.pow(2,8*t)-1,0);var n=t-1,f=1;for(this[r+n]=255&e;--n>=0&&(f*=256);)this[r+n]=e/f&255;return r+t},bb.prototype.writeUInt8=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,1,255,0),bb.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[r]=255&e,r+1},bb.prototype.writeUInt16LE=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,2,65535,0),bb.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):Gg(this,e,r,!0),r+2},bb.prototype.writeUInt16BE=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,2,65535,0),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):Gg(this,e,r,!1),r+2},bb.prototype.writeUInt32LE=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,4,4294967295,0),bb.TYPED_ARRAY_SUPPORT?(this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e):Hg(this,e,r,!0),r+4},bb.prototype.writeUInt32BE=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,4,4294967295,0),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):Hg(this,e,r,!1),r+4},bb.prototype.writeIntLE=function(e,r,t,$){if(e=+e,r|=0,!$){var n=Math.pow(2,8*t-1);Pb(this,e,r,t,n-1,-n)}var f=0,a=1,i=0;for(this[r]=255&e;++f<t&&(a*=256);)e<0&&0===i&&0!==this[r+f-1]&&(i=1),this[r+f]=(e/a>>0)-i&255;return r+t},bb.prototype.writeIntBE=function(e,r,t,$){if(e=+e,r|=0,!$){var n=Math.pow(2,8*t-1);Pb(this,e,r,t,n-1,-n)}var f=t-1,a=1,i=0;for(this[r+f]=255&e;--f>=0&&(a*=256);)e<0&&0===i&&0!==this[r+f+1]&&(i=1),this[r+f]=(e/a>>0)-i&255;return r+t},bb.prototype.writeInt8=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,1,127,-128),bb.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[r]=255&e,r+1},bb.prototype.writeInt16LE=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,2,32767,-32768),bb.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):Gg(this,e,r,!0),r+2},bb.prototype.writeInt16BE=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,2,32767,-32768),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):Gg(this,e,r,!1),r+2},bb.prototype.writeInt32LE=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,4,2147483647,-2147483648),bb.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24):Hg(this,e,r,!0),r+4},bb.prototype.writeInt32BE=function(e,r,t){return e=+e,r|=0,t||Pb(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):Hg(this,e,r,!1),r+4},bb.prototype.writeFloatLE=function(e,r,t){return Xm(this,e,r,!0,t)},bb.prototype.writeFloatBE=function(e,r,t){return Xm(this,e,r,!1,t)},bb.prototype.writeDoubleLE=function(e,r,t){return Ym(this,e,r,!0,t)},bb.prototype.writeDoubleBE=function(e,r,t){return Ym(this,e,r,!1,t)},bb.prototype.copy=function(e,r,t,$){if(t||(t=0),$||0===$||($=this.length),r>=e.length&&(r=e.length),r||(r=0),$>0&&$<t&&($=t),$===t)return 0;if(0===e.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if($<0)throw new RangeError("sourceEnd out of bounds");$>this.length&&($=this.length),e.length-r<$-t&&($=e.length-r+t);var n,f=$-t;if(this===e&&t<r&&r<$)for(n=f-1;n>=0;--n)e[n+r]=this[n+t];else if(f<1e3||!bb.TYPED_ARRAY_SUPPORT)for(n=0;n<f;++n)e[n+r]=this[n+t];else Uint8Array.prototype.set.call(e,this.subarray(t,t+f),r);return f},bb.prototype.fill=function(e,r,t,$){if("string"==typeof e){if("string"==typeof r?($=r,r=0,t=this.length):"string"==typeof t&&($=t,t=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==$&&"string"!=typeof $)throw new TypeError("encoding must be a string");if("string"==typeof $&&!bb.isEncoding($))throw new TypeError("Unknown encoding: "+$)}else"number"==typeof e&&(e&=255);if(r<0||this.length<r||this.length<t)throw new RangeError("Out of range index");if(t<=r)return this;var f;if(r>>>=0,t=void 0===t?this.length:t>>>0,e||(e=0),"number"==typeof e)for(f=r;f<t;++f)this[f]=e;else{var a=bb.isBuffer(e)?e:Ig(new bb(e,$).toString()),i=a.length;for(f=0;f<t-r;++f)this[f+r]=a[f%i]}return this};$y=/[^+\/0-9A-Za-z-_]/g}var yz,Kg,Lg,dd,zz=false;function $m(r,$){for(var f in r)$[f]=r[f]}function Rd(r,$,f){return dd(r,$,f)}function _m(){if(zz)return;zz=true;Kg={};Lg=(Ad(),Vb);dd=Lg.Buffer;dd.from&&dd.alloc&&dd.allocUnsafe&&dd.allocUnsafeSlow?Kg=Lg:($m(Lg,Kg),yz=Rd,Kg.Buffer=yz),Rd.prototype=Object.create(dd.prototype),$m(dd,Rd),Rd.from=function(r,$,f){if("number"==typeof r)throw new TypeError("Argument must not be a number");return dd(r,$,f)},Rd.alloc=function(r,$,f){if("number"!=typeof r)throw new TypeError("Argument must be a number");var u=dd(r);return void 0!==$?"string"==typeof f?u.fill($,f):u.fill($):u.fill(0),u},Rd.allocUnsafe=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return dd(r)},Rd.allocUnsafeSlow=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return Lg.SlowBuffer(r)}}var ap={},Az=(zd(),yd),Pj=65536,Bz=4294967295;function Cz(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}var Dz=(_m(),Kg).Buffer,Mg=Rb.crypto||Rb.msCrypto;function Ez(r,$){if(r>Bz)throw new RangeError("requested too many random bytes");var e=Dz.allocUnsafe(r);if(r>0)if(r>Pj)for(var o=0;o<r;o+=Pj)Mg.getRandomValues(e.slice(o,o+Pj));else Mg.getRandomValues(e);return"function"==typeof $?Az.nextTick(function(){$(null,e)}):e}ap=Mg&&Mg.getRandomValues?Ez:Cz;var Fz,bp,qf,cp,dp,Gz,Hz=false;function Iz(e){console&&console.warn&&console.warn(e)}function qb(){qb.init.call(this)}function Ng(e){if("function"!=typeof e)throw new TypeError("The \"listener\" argument must be of type Function. Received type "+typeof e)}function ep(e){return void 0===e._maxListeners?qb.defaultMaxListeners:e._maxListeners}function fp(e,t,r,n){var s,o,i;if(Ng(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),i=o[t]),void 0===i)i=o[t]=r,++e._eventsCount;else if("function"==typeof i?i=o[t]=n?[r,i]:[i,r]:n?i.unshift(r):i.push(r),(s=ep(e))>0&&i.length>s&&!i.warned){i.warned=!0;var $=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");$.name="MaxListenersExceededWarning",$.emitter=e,$.type=t,$.count=i.length,Iz($)}return e}function Jz(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function gp(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=Jz.bind(n);return s.listener=r,n.wrapFn=s,s}function hp(e,t,r){var n=e._events;if(void 0===n)return[];var s=n[t];return void 0===s?[]:"function"==typeof s?r?[s.listener||s]:[s]:r?Lz(s):jp(s,s.length)}function ip(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function jp(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function Kz(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function Lz(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function kp(){if(Hz)return;Hz=true;bp={};qf="object"==typeof Reflect?Reflect:null;cp=qf&&"function"==typeof qf.apply?qf.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};Fz=qf&&"function"==typeof qf.ownKeys?qf.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};dp=Number.isNaN||function(e){return e!=e};bp=qb,qb.EventEmitter=qb,qb.prototype._events=void 0,qb.prototype._eventsCount=0,qb.prototype._maxListeners=void 0;Gz=10;Object.defineProperty(qb,"defaultMaxListeners",{enumerable:!0,get:function(){return Gz},set:function(e){if("number"!=typeof e||e<0||dp(e))throw new RangeError("The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received "+e+".");Gz=e}}),qb.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},qb.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||dp(e))throw new RangeError("The value of \"n\" is out of range. It must be a non-negative number. Received "+e+".");return this._maxListeners=e,this},qb.prototype.getMaxListeners=function(){return ep(this)},qb.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var i=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw i.context=o,i}var $=s[e];if(void 0===$)return!1;if("function"==typeof $)cp($,this,t);else{var v=$.length,a=jp($,v);for(r=0;r<v;++r)cp(a[r],this,t)}return!0},qb.prototype.addListener=function(e,t){return fp(this,e,t,!1)},qb.prototype.on=qb.prototype.addListener,qb.prototype.prependListener=function(e,t){return fp(this,e,t,!0)},qb.prototype.once=function(e,t){return Ng(t),this.on(e,gp(this,e,t)),this},qb.prototype.prependOnceListener=function(e,t){return Ng(t),this.prependListener(e,gp(this,e,t)),this},qb.prototype.removeListener=function(e,t){var r,n,s,o,i;if(Ng(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){i=r[o].listener,s=o;break}if(s<0)return this;0===s?r.shift():Kz(r,s),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,i||t)}return this},qb.prototype.off=qb.prototype.removeListener,qb.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var s,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(s=o[n])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},qb.prototype.listeners=function(e){return hp(this,e,!0)},qb.prototype.rawListeners=function(e){return hp(this,e,!1)},qb.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):ip.call(e,t)},qb.prototype.listenerCount=ip,qb.prototype.eventNames=function(){return this._eventsCount>0?Fz(this._events):[]}}var lp,Mz=false;function mp(){if(Mz)return;Mz=true;lp={};lp=(kp(),bp).EventEmitter}var Nz=false;function np(){if(Nz)return;Nz=true}var Oz,Pz,Og,Qz,Qj,Rz,Sz=false;function op(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Tz(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?op(Object(r),!0).forEach(function(t){Uz(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):op(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Uz(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Vz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pp(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Wz(e,t,r){return t&&pp(e.prototype,t),r&&pp(e,r),e}function Xz(e,t,r){Og.prototype.copy.call(e,t,r)}function Yz(){if(Sz)return;Sz=true;Oz={};Pz=(Ad(),Vb);Og=Pz.Buffer;Qz=(np(),{});Qj=Qz.inspect;Rz=Qj&&Qj.custom||"inspect";Oz=function(){function e(){Vz(this,e),this.head=null,this.tail=null,this.length=0}return Wz(e,[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return Og.alloc(0);for(var t=Og.allocUnsafe(e>>>0),r=this.head,a=0;r;)Xz(r.data,t,a),a+=r.data.length,r=r.next;return t}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,a=t.data;for(e-=a.length;t=t.next;){var n=t.data,i=e>n.length?n.length:e;if(i===n.length?a+=n:a+=n.slice(0,e),0===(e-=i)){i===n.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=n.slice(i));break}++r}return this.length-=r,a}},{key:"_getBuffer",value:function(e){var t=Og.allocUnsafe(e),r=this.head,a=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var n=r.data,i=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,i),0===(e-=i)){i===n.length?(++a,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=n.slice(i));break}++a}return this.length-=a,t}},{key:Rz,value:function(e,t){return Qj(this,Tz({},t,{depth:0,customInspect:!1}))}}]),e}()}var qp,Sd,Zz=false;function $z(t,e){var r=this,a=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return a||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Sd.nextTick(Rj,this,t)):Sd.nextTick(Rj,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?r._writableState?r._writableState.errorEmitted?Sd.nextTick(Pg,r):(r._writableState.errorEmitted=!0,Sd.nextTick(rp,r,t)):Sd.nextTick(rp,r,t):e?(Sd.nextTick(Pg,r),e(t)):Sd.nextTick(Pg,r)}),this)}function rp(t,e){Rj(t,e),Pg(t)}function Pg(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function _z(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Rj(t,e){t.emit("error",e)}function aA(t,e){var r=t._readableState,a=t._writableState;r&&r.autoDestroy||a&&a.autoDestroy?t.destroy(e):t.emit("error",e)}function sp(){if(Zz)return;Zz=true;qp={};Sd=(zd(),yd);qp={destroy:$z,undestroy:_z,errorOrDestroy:aA}}var Td,tp,bA=false;function cA(r){return(cA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function dA(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}function Wb(r,e,t){t||(t=Error);var o=function(r){function t(t,o,n){return r.call(this,function(r,t,o){return"string"==typeof e?e:e(r,t,o)}(t,o,n))||this}return dA(t,r),t}(t);o.prototype.name=t.name,o.prototype.code=r,tp[r]=o}function up(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(r){return String(r)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:2===t?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}return"of ".concat(e," ").concat(String(r))}function eA(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function fA(r,e,t){return(void 0===t||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function gA(r,e,t){return"number"!=typeof t&&(t=0),!(t+e.length>r.length)&&-1!==r.indexOf(e,t)}function rf(){if(bA)return;bA=true;Td={};tp={};Wb("ERR_INVALID_OPT_VALUE",function(r,e){return"The value \""+e+"\" is invalid for option \""+r+"\""},TypeError),Wb("ERR_INVALID_ARG_TYPE",function(r,e,t){var o,n;if("string"==typeof e&&eA(e,"not ")?(o="must not be",e=e.replace(/^not /,"")):o="must be",fA(r," argument"))n="The ".concat(r," ").concat(o," ").concat(up(e,"type"));else{var a=gA(r,".")?"property":"argument";n="The \"".concat(r,"\" ").concat(a," ").concat(o," ").concat(up(e,"type"))}return n+=". Received type ".concat(cA(t))},TypeError),Wb("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),Wb("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"}),Wb("ERR_STREAM_PREMATURE_CLOSE","Premature close"),Wb("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"}),Wb("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),Wb("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),Wb("ERR_STREAM_WRITE_AFTER_END","write after end"),Wb("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),Wb("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError),Wb("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Td.codes=tp}var vp,hA,iA=false;function jA(r,a,e){return null!=r.highWaterMark?r.highWaterMark:a?r[e]:null}function kA(r,a,e,$){var t=jA(a,$,e);if(null!=t){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new hA($?e:"highWaterMark",t);return Math.floor(t)}return r.objectMode?16:16384}function wp(){if(iA)return;iA=true;vp={};hA=(rf(),Td).codes.ERR_INVALID_OPT_VALUE;vp={getHighWaterMark:kA}}var Wf,lA=false;function Xf(){if(lA)return;lA=true;Wf={};Wf="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}}}var mA,nA=false;function oA(r,o){if(Sj("noDeprecation"))return r;var e=!1;return function(){if(!e){if(Sj("throwDeprecation"))throw new Error(o);Sj("traceDeprecation")?console.trace(o):console.warn(o),e=!0}return r.apply(this,arguments)}}function Sj(r){try{if(!Rb.localStorage)return!1}catch(e){return!1}var o=Rb.localStorage[r];return null!=o&&"true"===String(o).toLowerCase()}function pA(){if(nA)return;nA=true;mA={};mA=oA}var Tj,xp,Ud,qA,yp,Qg,rA,zp,Uj,sA,tA,Bd,uA,vA,wA,xA,yA,zA,AA,BA,sf,CA=false;function Ap(e){var r=this;this.next=null,this.entry=null,this.finish=function(){RA(r,e)}}function DA(e){return Qg.from(e)}function EA(e){return Qg.isBuffer(e)||e instanceof rA}function FA(){}function Yf(e,r,t){Tj=Tj||(uf(),tf),e=e||{},"boolean"!=typeof t&&(t=r instanceof Tj),this.objectMode=!!e.objectMode,t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=tA(this,e,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=!1===e.decodeStrings;this.decodeStrings=!$,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){MA(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new Ap(this)}function yb(e){var r=this instanceof(Tj=Tj||(uf(),tf));if(!r&&!zp.call(yb,this))return new yb(e);this._writableState=new Yf(e,this,r),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),yp.call(this)}function GA(e,r){var t=new AA;sf(e,t),Ud.nextTick(r,t)}function HA(e,r,t,$){var i;return null===t?i=new zA:"string"==typeof t||r.objectMode||(i=new uA("chunk",["string","Buffer"],t)),!i||(sf(e,i),Ud.nextTick($,i),!1)}function IA(e,r,t){return e.objectMode||!1===e.decodeStrings||"string"!=typeof r||(r=Qg.from(r,t)),r}function JA(e,r,t,$,i,a){if(!t){var n=IA(r,$,i);$!==n&&(t=!0,i="buffer",$=n)}var o=r.objectMode?1:$.length;r.length+=o;var s=r.length<r.highWaterMark;if(s||(r.needDrain=!0),r.writing||r.corked){var E=r.lastBufferedRequest;r.lastBufferedRequest={chunk:$,encoding:i,isBuf:t,callback:a,next:null},E?E.next=r.lastBufferedRequest:r.bufferedRequest=r.lastBufferedRequest,r.bufferedRequestCount+=1}else Vj(e,r,!1,o,$,i,a);return s}function Vj(e,r,t,$,i,a,n){r.writelen=$,r.writecb=n,r.writing=!0,r.sync=!0,r.destroyed?r.onwrite(new yA("write")):t?e._writev(i,r.onwrite):e._write(i,a,r.onwrite),r.sync=!1}function KA(e,r,t,$,i){--r.pendingcb,t?(Ud.nextTick(i,$),Ud.nextTick(Zf,e,r),e._writableState.errorEmitted=!0,sf(e,$)):(i($),e._writableState.errorEmitted=!0,sf(e,$),Zf(e,r))}function LA(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function MA(e,r){var t=e._writableState,$=t.sync,i=t.writecb;if("function"!=typeof i)throw new wA;if(LA(t),r)KA(e,t,$,r,i);else{var a=Dp(t)||e.destroyed;a||t.corked||t.bufferProcessing||!t.bufferedRequest||Cp(e,t),$?Ud.nextTick(Bp,e,t,a,i):Bp(e,t,a,i)}}function Bp(e,r,t,$){t||NA(e,r),r.pendingcb--,$(),Zf(e,r)}function NA(e,r){0===r.length&&r.needDrain&&(r.needDrain=!1,e.emit("drain"))}function Cp(e,r){r.bufferProcessing=!0;var t=r.bufferedRequest;if(e._writev&&t&&t.next){var $=r.bufferedRequestCount,i=new Array($),a=r.corkedRequestsFree;a.entry=t;for(var n=0,o=!0;t;)i[n]=t,t.isBuf||(o=!1),t=t.next,n+=1;i.allBuffers=o,Vj(e,r,!0,r.length,i,"",a.finish),r.pendingcb++,r.lastBufferedRequest=null,a.next?(r.corkedRequestsFree=a.next,a.next=null):r.corkedRequestsFree=new Ap(r),r.bufferedRequestCount=0}else{for(;t;){var s=t.chunk,E=t.encoding,w=t.callback;if(Vj(e,r,!1,r.objectMode?1:s.length,s,E,w),t=t.next,r.bufferedRequestCount--,r.writing)break}null===t&&(r.lastBufferedRequest=null)}r.bufferedRequest=t,r.bufferProcessing=!1}function Dp(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function OA(e,r){e._final(function(t){r.pendingcb--,t&&sf(e,t),r.prefinished=!0,e.emit("prefinish"),Zf(e,r)})}function PA(e,r){r.prefinished||r.finalCalled||("function"!=typeof e._final||r.destroyed?(r.prefinished=!0,e.emit("prefinish")):(r.pendingcb++,r.finalCalled=!0,Ud.nextTick(OA,e,r)))}function Zf(e,r){var t=Dp(r);if(t&&(PA(e,r),0===r.pendingcb&&(r.finished=!0,e.emit("finish"),r.autoDestroy))){var $=e._readableState;(!$||$.autoDestroy&&$.endEmitted)&&e.destroy()}return t}function QA(e,r,t){r.ending=!0,Zf(e,r),t&&(r.finished?Ud.nextTick(t):e.once("finish",t)),r.ended=!0,e.writable=!1}function RA(e,r,t){var $=e.entry;for(e.entry=null;$;){var i=$.callback;r.pendingcb--,i(t),$=$.next}r.corkedRequestsFree.next=e}function Ep(){if(CA)return;CA=true;xp={};Ud=(zd(),yd);xp=yb,yb.WritableState=Yf;qA={deprecate:(pA(),mA)};yp=(mp(),lp);Qg=(Ad(),Vb).Buffer;rA=Rb.Uint8Array||function(){};Uj=(sp(),qp);sA=(wp(),vp);tA=sA.getHighWaterMark;Bd=(rf(),Td).codes;uA=Bd.ERR_INVALID_ARG_TYPE;vA=Bd.ERR_METHOD_NOT_IMPLEMENTED;wA=Bd.ERR_MULTIPLE_CALLBACK;xA=Bd.ERR_STREAM_CANNOT_PIPE;yA=Bd.ERR_STREAM_DESTROYED;zA=Bd.ERR_STREAM_NULL_VALUES;AA=Bd.ERR_STREAM_WRITE_AFTER_END;BA=Bd.ERR_UNKNOWN_ENCODING;sf=Uj.errorOrDestroy;(Xf(),Wf)(yb,yp),Yf.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r},function(){try{Object.defineProperty(Yf.prototype,"buffer",{get:qA.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(zp=Function.prototype[Symbol.hasInstance],Object.defineProperty(yb,Symbol.hasInstance,{value:function(e){return!!zp.call(this,e)||this===yb&&e&&e._writableState instanceof Yf}})):zp=function(e){return e instanceof this},yb.prototype.pipe=function(){sf(this,new xA)},yb.prototype.write=function(e,r,t){var $=this._writableState,i=!1,a=!$.objectMode&&EA(e);return a&&!Qg.isBuffer(e)&&(e=DA(e)),"function"==typeof r&&(t=r,r=null),a?r="buffer":r||(r=$.defaultEncoding),"function"!=typeof t&&(t=FA),$.ending?GA(this,t):(a||HA(this,$,e,t))&&($.pendingcb++,i=JA(this,$,a,e,r,t)),i},yb.prototype.cork=function(){this._writableState.corked++},yb.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||Cp(this,e))},yb.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new BA(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(yb.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(yb.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),yb.prototype._write=function(e,r,t){t(new vA("_write()"))},yb.prototype._writev=null,yb.prototype.end=function(e,r,t){var $=this._writableState;return"function"==typeof e?(t=e,e=null,r=null):"function"==typeof r&&(t=r,r=null),null!=e&&this.write(e,r),$.corked&&($.corked=1,this.uncork()),$.ending||QA(this,$,t),this},Object.defineProperty(yb.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(yb.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),yb.prototype.destroy=Uj.destroy,yb.prototype._undestroy=Uj.undestroy,yb.prototype._destroy=function(e,r){r(e)}}var tf,SA,TA,Fp,Wj,UA=false;function ed(e){if(!(this instanceof ed))return new ed(e);Fp.call(this,e),Wj.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",VA)))}function VA(){this._writableState.ended||SA.nextTick(WA,this)}function WA(e){e.end()}function uf(){if(UA)return;UA=true;tf={};SA=(zd(),yd);TA=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};tf=ed;Fp=(Yp(),Mp);Wj=(Ep(),xp);(Xf(),Wf)(ed,Fp);for(var $YgPj$var$keys=TA(Wj.prototype),$YgPj$var$v=0;$YgPj$var$v<$YgPj$var$keys.length;$YgPj$var$v++){var $YgPj$var$method=$YgPj$var$keys[$YgPj$var$v];ed.prototype[$YgPj$var$method]||(ed.prototype[$YgPj$var$method]=Wj.prototype[$YgPj$var$method])}Object.defineProperty(ed.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(ed.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(ed.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(ed.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}var Xj,Yj,Gp,XA,YA=false;function ZA(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0;}}function $A(t){var e=ZA(t);if("string"!=typeof e&&(Yj.isEncoding===Gp||!Gp(t)))throw new Error("Unknown encoding: "+t);return e||t}function $f(t){var e;switch(this.encoding=$A(t),this.encoding){case"utf16le":this.text=eB,this.end=fB,e=4;break;case"utf8":this.fillLast=bB,e=4;break;case"base64":this.text=gB,this.end=hB,e=3;break;default:return this.write=iB,void(this.end=jB);}this.lastNeed=0,this.lastTotal=0,this.lastChar=Yj.allocUnsafe(e)}function Zj(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function _A(t,e,r){var a=e.length-1;if(a<r)return 0;var s=Zj(e[a]);return s>=0?(s>0&&(t.lastNeed=s-1),s):--a<r||-2===s?0:(s=Zj(e[a]))>=0?(s>0&&(t.lastNeed=s-2),s):--a<r||-2===s?0:(s=Zj(e[a]))>=0?(s>0&&(2===s?s=0:t.lastNeed=s-3),s):0}function aB(t,e,r){if(128!=(192&e[0]))return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"\uFFFD"}}function bB(t){var e=this.lastTotal-this.lastNeed,r=aB(this,t,e);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function cB(t,e){var r=_A(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var a=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,a),t.toString("utf8",e,a)}function dB(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function eB(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var a=r.charCodeAt(r.length-1);if(a>=55296&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function fB(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function gB(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function hB(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function iB(t){return t.toString(this.encoding)}function jB(t){return t&&t.length?this.write(t):""}function Hp(){if(YA)return;YA=true;Xj={};Yj=(_m(),Kg).Buffer;Gp=Yj.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1;}};XA=$f;Xj.StringDecoder=XA,$f.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},$f.prototype.end=dB,$f.prototype.text=cB,$f.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}}var $j,Ip,kB=false;function lB(e){var r=!1;return function(){if(!r){r=!0;for(var n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];e.apply(this,t)}}}function mB(){}function nB(e){return e.setHeader&&"function"==typeof e.abort}function Jp(e,r,n){if("function"==typeof r)return Jp(e,null,r);r||(r={}),n=lB(n||mB);var t=r.readable||!1!==r.readable&&e.readable,o=r.writable||!1!==r.writable&&e.writable,a=function(){e.writable||$()},i=e._writableState&&e._writableState.finished,$=function(){o=!1,i=!0,t||n.call(e)},l=e._readableState&&e._readableState.endEmitted,R=function(){t=!1,l=!0,o||n.call(e)},s=function(r){n.call(e,r)},c=function(){var r;return t&&!l?(e._readableState&&e._readableState.ended||(r=new Ip),n.call(e,r)):o&&!i?(e._writableState&&e._writableState.ended||(r=new Ip),n.call(e,r)):void 0},v=function(){e.req.on("finish",$)};return nB(e)?(e.on("complete",$),e.on("abort",c),e.req?v():e.on("request",v)):o&&!e._writableState&&(e.on("end",a),e.on("close",a)),e.on("end",R),e.on("finish",$),!1!==r.error&&e.on("error",s),e.on("close",c),function(){e.removeListener("complete",$),e.removeListener("abort",c),e.removeListener("request",v),e.req&&e.req.removeListener("finish",$),e.removeListener("end",a),e.removeListener("close",a),e.removeListener("finish",$),e.removeListener("end",R),e.removeListener("error",s),e.removeListener("close",c)}}function _j(){if(kB)return;kB=true;$j={};Ip=(rf(),Td).codes.ERR_STREAM_PREMATURE_CLOSE;$j=Jp}var Kp,oB,Lp,pB,Cd,Vd,_f,Rg,Wd,ak,Xd,qB,rB,sB,tB=false;function Dd(e,r,$){return r in e?Object.defineProperty(e,r,{value:$,enumerable:!0,configurable:!0,writable:!0}):e[r]=$,e}function Ed(e,r){return{value:e,done:r}}function uB(e){var r=e[Cd];if(null!==r){var $=e[Xd].read();null!==$&&(e[Wd]=null,e[Cd]=null,e[Vd]=null,r(Ed($,!1)))}}function vB(e){Lp.nextTick(uB,e)}function wB(e,r){return function($,a){e.then(function(){r[Rg]?$(Ed(void 0,!0)):r[ak]($,a)},a)}}function xB(){if(tB)return;tB=true;oB={};Lp=(zd(),yd);pB=(_j(),$j);Cd=Symbol("lastResolve");Vd=Symbol("lastReject");_f=Symbol("error");Rg=Symbol("ended");Wd=Symbol("lastPromise");ak=Symbol("handlePromise");Xd=Symbol("stream");qB=Object.getPrototypeOf(function(){});rB=Object.setPrototypeOf((Dd(Kp={get stream(){return this[Xd]},next:function(){var e=this,r=this[_f];if(null!==r)return Promise.reject(r);if(this[Rg])return Promise.resolve(Ed(void 0,!0));if(this[Xd].destroyed)return new Promise(function(r,$){Lp.nextTick(function(){e[_f]?$(e[_f]):r(Ed(void 0,!0))})});var $,a=this[Wd];if(a)$=new Promise(wB(a,this));else{var t=this[Xd].read();if(null!==t)return Promise.resolve(Ed(t,!1));$=new Promise(this[ak])}return this[Wd]=$,$}},Symbol.asyncIterator,function(){return this}),Dd(Kp,"return",function(){var e=this;return new Promise(function(r,$){e[Xd].destroy(null,function(e){e?$(e):r(Ed(void 0,!0))})})}),Kp),qB);sB=function(e){var r,$=Object.create(rB,(Dd(r={},Xd,{value:e,writable:!0}),Dd(r,Cd,{value:null,writable:!0}),Dd(r,Vd,{value:null,writable:!0}),Dd(r,_f,{value:null,writable:!0}),Dd(r,Rg,{value:e._readableState.endEmitted,writable:!0}),Dd(r,ak,{value:function(e,r){var a=$[Xd].read();a?($[Wd]=null,$[Cd]=null,$[Vd]=null,e(Ed(a,!1))):($[Cd]=e,$[Vd]=r)},writable:!0}),r));return $[Wd]=null,pB(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var r=$[Vd];return null!==r&&($[Wd]=null,$[Cd]=null,$[Vd]=null,r(e)),void($[_f]=e)}var a=$[Cd];null!==a&&($[Wd]=null,$[Cd]=null,$[Vd]=null,a(Ed(void 0,!0))),$[Rg]=!0}),e.on("readable",vB.bind(null,$)),$};oB=sB}var yB,zB=false;function AB(){if(zB)return;zB=true;yB={};yB=function(){throw new Error("Readable.from is not available in the browser")}}var Sg,Mp,fd,b,Np,ag,Tg,BB,kb,bk,Ug,Op,Pp,CB,ck,DB,EB,Vg,FB,GB,HB,IB,bg,dk,Qp,JB=false;function KB(e){return Tg.from(e)}function LB(e){return Tg.isBuffer(e)||e instanceof BB}function MB(e,r,a){if("function"==typeof e.prependListener)return e.prependListener(r,a);e._events&&e._events[r]?Array.isArray(e._events[r])?e._events[r].unshift(a):e._events[r]=[a,e._events[r]]:e.on(r,a)}function Rp(e,r,a){Sg=Sg||(uf(),tf),e=e||{},"boolean"!=typeof a&&(a=r instanceof Sg),this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=EB(this,e,"readableHighWaterMark",a),this.buffer=new CB,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(Ug||(Ug=(Hp(),Xj).StringDecoder),this.decoder=new Ug(e.encoding),this.encoding=e.encoding)}function ob(e){if(Sg=Sg||(uf(),tf),!(this instanceof ob))return new ob(e);var r=this instanceof Sg;this._readableState=new Rp(e,this,r),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),ag.call(this)}function Sp(e,r,a,t,$){kb("readableAddChunk",r);var n,i=e._readableState;if(null===r)i.reading=!1,PB(e,i);else if($||(n=NB(i,r)),n)bg(e,n);else if(i.objectMode||r&&r.length>0){if("string"==typeof r||i.objectMode||Object.getPrototypeOf(r)===Tg.prototype||(r=KB(r)),t)i.endEmitted?bg(e,new IB):ek(e,i,r,!0);else if(i.ended)bg(e,new GB);else{if(i.destroyed)return!1;i.reading=!1,i.decoder&&!a?(r=i.decoder.write(r),i.objectMode||0!==r.length?ek(e,i,r,!1):fk(e,i)):ek(e,i,r,!1)}}else t||(i.reading=!1,fk(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function ek(e,r,a,t){r.flowing&&0===r.length&&!r.sync?(r.awaitDrain=0,e.emit("data",a)):(r.length+=r.objectMode?1:a.length,t?r.buffer.unshift(a):r.buffer.push(a),r.needReadable&&Wg(e)),fk(e,r)}function NB(e,r){var a;return LB(r)||"string"==typeof r||void 0===r||e.objectMode||(a=new FB("chunk",["string","Buffer","Uint8Array"],r)),a}function OB(e){return e>=Qp?e=Qp:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function Tp(e,r){return e<=0||0===r.length&&r.ended?0:r.objectMode?1:e!=e?r.flowing&&r.length?r.buffer.head.data.length:r.length:(e>r.highWaterMark&&(r.highWaterMark=OB(e)),e<=r.length?e:r.ended?r.length:(r.needReadable=!0,0))}function PB(e,r){if(kb("onEofChunk"),!r.ended){if(r.decoder){var a=r.decoder.end();a&&a.length&&(r.buffer.push(a),r.length+=r.objectMode?1:a.length)}r.ended=!0,r.sync?Wg(e):(r.needReadable=!1,r.emittedReadable||(r.emittedReadable=!0,Up(e)))}}function Wg(e){var r=e._readableState;kb("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(kb("emitReadable",r.flowing),r.emittedReadable=!0,fd.nextTick(Up,e))}function Up(e){var r=e._readableState;kb("emitReadable_",r.destroyed,r.length,r.ended),r.destroyed||!r.length&&!r.ended||(e.emit("readable"),r.emittedReadable=!1),r.needReadable=!r.flowing&&!r.ended&&r.length<=r.highWaterMark,gk(e)}function fk(e,r){r.readingMore||(r.readingMore=!0,fd.nextTick(QB,e,r))}function QB(e,r){for(;!r.reading&&!r.ended&&(r.length<r.highWaterMark||r.flowing&&0===r.length);){var a=r.length;if(kb("maybeReadMore read 0"),e.read(0),a===r.length)break}r.readingMore=!1}function RB(e){return function(){var r=e._readableState;kb("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,0===r.awaitDrain&&Np(e,"data")&&(r.flowing=!0,gk(e))}}function Vp(e){var r=e._readableState;r.readableListening=e.listenerCount("readable")>0,r.resumeScheduled&&!r.paused?r.flowing=!0:e.listenerCount("data")>0&&e.resume()}function SB(e){kb("readable nexttick read 0"),e.read(0)}function TB(e,r){r.resumeScheduled||(r.resumeScheduled=!0,fd.nextTick(UB,e,r))}function UB(e,r){kb("resume",r.reading),r.reading||e.read(0),r.resumeScheduled=!1,e.emit("resume"),gk(e),r.flowing&&!r.reading&&e.read(0)}function gk(e){var r=e._readableState;for(kb("flow",r.flowing);r.flowing&&null!==e.read(););}function Wp(e,r){return 0===r.length?null:(r.objectMode?a=r.buffer.shift():!e||e>=r.length?(a=r.decoder?r.buffer.join(""):1===r.buffer.length?r.buffer.first():r.buffer.concat(r.length),r.buffer.clear()):a=r.buffer.consume(e,r.decoder),a);var a}function hk(e){var r=e._readableState;kb("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,fd.nextTick(VB,r,e))}function VB(e,r){if(kb("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,r.readable=!1,r.emit("end"),e.autoDestroy)){var a=r._writableState;(!a||a.autoDestroy&&a.finished)&&r.destroy()}}function Xp(e,r){for(var a=0,t=e.length;a<t;a++)if(e[a]===r)return a;return-1}function Yp(){if(JB)return;JB=true;Mp={};fd=(zd(),yd);Mp=ob,ob.ReadableState=Rp;b=(kp(),bp).EventEmitter;Np=function(e,r){return e.listeners(r).length};ag=(mp(),lp);Tg=(Ad(),Vb).Buffer;BB=Rb.Uint8Array||function(){};bk=(np(),{});kb=bk&&bk.debuglog?bk.debuglog("stream"):function(){};CB=(Yz(),Oz);ck=(sp(),qp);DB=(wp(),vp);EB=DB.getHighWaterMark;Vg=(rf(),Td).codes;FB=Vg.ERR_INVALID_ARG_TYPE;GB=Vg.ERR_STREAM_PUSH_AFTER_EOF;HB=Vg.ERR_METHOD_NOT_IMPLEMENTED;IB=Vg.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;(Xf(),Wf)(ob,ag);bg=ck.errorOrDestroy;dk=["error","close","destroy","pause","resume"];Object.defineProperty(ob.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),ob.prototype.destroy=ck.destroy,ob.prototype._undestroy=ck.undestroy,ob.prototype._destroy=function(e,r){r(e)},ob.prototype.push=function(e,r){var a,t=this._readableState;return t.objectMode?a=!0:"string"==typeof e&&((r=r||t.defaultEncoding)!==t.encoding&&(e=Tg.from(e,r),r=""),a=!0),Sp(this,e,r,!1,a)},ob.prototype.unshift=function(e){return Sp(this,e,null,!0,!1)},ob.prototype.isPaused=function(){return!1===this._readableState.flowing},ob.prototype.setEncoding=function(e){Ug||(Ug=(Hp(),Xj).StringDecoder);var r=new Ug(e);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var a=this._readableState.buffer.head,t="";null!==a;)t+=r.write(a.data),a=a.next;return this._readableState.buffer.clear(),""!==t&&this._readableState.buffer.push(t),this._readableState.length=t.length,this};Qp=1073741824;ob.prototype.read=function(e){kb("read",e),e=parseInt(e,10);var r=this._readableState,a=e;if(0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&((0!==r.highWaterMark?r.length>=r.highWaterMark:r.length>0)||r.ended))return kb("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?hk(this):Wg(this),null;if(0===(e=Tp(e,r))&&r.ended)return 0===r.length&&hk(this),null;var t,$=r.needReadable;return kb("need readable",$),(0===r.length||r.length-e<r.highWaterMark)&&kb("length less than watermark",$=!0),r.ended||r.reading?kb("reading or ended",$=!1):$&&(kb("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=Tp(a,r))),null===(t=e>0?Wp(e,r):null)?(r.needReadable=r.length<=r.highWaterMark,e=0):(r.length-=e,r.awaitDrain=0),0===r.length&&(r.ended||(r.needReadable=!0),a!==e&&r.ended&&hk(this)),null!==t&&this.emit("data",t),t},ob.prototype._read=function(e){bg(this,new HB("_read()"))},ob.prototype.pipe=function(e,r){var a=this,t=this._readableState;switch(t.pipesCount){case 0:t.pipes=e;break;case 1:t.pipes=[t.pipes,e];break;default:t.pipes.push(e);}t.pipesCount+=1,kb("pipe count=%d opts=%j",t.pipesCount,r);var $=(!r||!1!==r.end)&&e!==fd.stdout&&e!==fd.stderr?i:u;function n(r,$){kb("onunpipe"),r===a&&$&&!1===$.hasUnpiped&&($.hasUnpiped=!0,kb("cleanup"),e.removeListener("close",s),e.removeListener("finish",l),e.removeListener("drain",d),e.removeListener("error",o),e.removeListener("unpipe",n),a.removeListener("end",i),a.removeListener("end",u),a.removeListener("data",h),U=!0,!t.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function i(){kb("onend"),e.end()}t.endEmitted?fd.nextTick($):a.once("end",$),e.on("unpipe",n);var d=RB(a);e.on("drain",d);var U=!1;function h(r){kb("ondata");var $=e.write(r);kb("dest.write",$),!1===$&&((1===t.pipesCount&&t.pipes===e||t.pipesCount>1&&-1!==Xp(t.pipes,e))&&!U&&(kb("false write response, pause",t.awaitDrain),t.awaitDrain++),a.pause())}function o(r){kb("onerror",r),u(),e.removeListener("error",o),0===Np(e,"error")&&bg(e,r)}function s(){e.removeListener("finish",l),u()}function l(){kb("onfinish"),e.removeListener("close",s),u()}function u(){kb("unpipe"),a.unpipe(e)}return a.on("data",h),MB(e,"error",o),e.once("close",s),e.once("finish",l),e.emit("pipe",a),t.flowing||(kb("pipe resume"),a.resume()),e},ob.prototype.unpipe=function(e){var r=this._readableState,a={hasUnpiped:!1};if(0===r.pipesCount)return this;if(1===r.pipesCount)return e&&e!==r.pipes?this:(e||(e=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,e&&e.emit("unpipe",this,a),this);if(!e){var t=r.pipes,$=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var n=0;n<$;n++)t[n].emit("unpipe",this,{hasUnpiped:!1});return this}var i=Xp(r.pipes,e);return-1===i?this:(r.pipes.splice(i,1),r.pipesCount-=1,1===r.pipesCount&&(r.pipes=r.pipes[0]),e.emit("unpipe",this,a),this)},ob.prototype.on=function(e,r){var a=ag.prototype.on.call(this,e,r),t=this._readableState;return"data"===e?(t.readableListening=this.listenerCount("readable")>0,!1!==t.flowing&&this.resume()):"readable"===e&&(t.endEmitted||t.readableListening||(t.readableListening=t.needReadable=!0,t.flowing=!1,t.emittedReadable=!1,kb("on readable",t.length,t.reading),t.length?Wg(this):t.reading||fd.nextTick(SB,this))),a},ob.prototype.addListener=ob.prototype.on,ob.prototype.removeListener=function(e,r){var a=ag.prototype.removeListener.call(this,e,r);return"readable"===e&&fd.nextTick(Vp,this),a},ob.prototype.removeAllListeners=function(e){var r=ag.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||fd.nextTick(Vp,this),r},ob.prototype.resume=function(){var e=this._readableState;return e.flowing||(kb("resume"),e.flowing=!e.readableListening,TB(this,e)),e.paused=!1,this},ob.prototype.pause=function(){return kb("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(kb("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},ob.prototype.wrap=function(e){var r=this,a=this._readableState,t=!1;for(var $ in e.on("end",function(){if(kb("wrapped end"),a.decoder&&!a.ended){var e=a.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function($){(kb("wrapped data"),a.decoder&&($=a.decoder.write($)),a.objectMode&&null==$)||(a.objectMode||$&&$.length)&&(r.push($)||(t=!0,e.pause()))}),e)void 0===this[$]&&"function"==typeof e[$]&&(this[$]=function(r){return function(){return e[r].apply(e,arguments)}}($));for(var n=0;n<dk.length;n++)e.on(dk[n],this.emit.bind(this,dk[n]));return this._read=function(r){kb("wrapped _read",r),t&&(t=!1,e.resume())},this},"function"==typeof Symbol&&(ob.prototype[Symbol.asyncIterator]=function(){return void 0===Op&&(Op=(xB(),oB)),Op(this)}),Object.defineProperty(ob.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(ob.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(ob.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),ob._fromList=Wp,Object.defineProperty(ob.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(ob.from=function(e,r){return void 0===Pp&&(Pp=(AB(),yB)),Pp(ob,e,r)})}var ik={};ik=ld;var Xg=(rf(),Td).codes,WB=Xg.ERR_METHOD_NOT_IMPLEMENTED,XB=Xg.ERR_MULTIPLE_CALLBACK,YB=Xg.ERR_TRANSFORM_ALREADY_TRANSFORMING,ZB=Xg.ERR_TRANSFORM_WITH_LENGTH_0,Yg=(uf(),tf);function $B(r,e){var t=this._transformState;t.transforming=!1;var a=t.writecb;if(null===a)return this.emit("error",new XB);t.writechunk=null,t.writecb=null,null!=e&&this.push(e),a(r);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function ld(r){if(!(this instanceof ld))return new ld(r);Yg.call(this,r),this._transformState={afterTransform:$B.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",_B)}function _B(){var r=this;"function"!=typeof this._flush||this._readableState.destroyed?Zp(this,null,null):this._flush(function(e,t){Zp(r,e,t)})}function Zp(r,e,t){if(e)return r.emit("error",e);if(null!=t&&r.push(t),r._writableState.length)throw new ZB;if(r._transformState.transforming)throw new YB;return r.push(null)}(Xf(),Wf)(ld,Yg),ld.prototype.push=function(r,e){return this._transformState.needTransform=!1,Yg.prototype.push.call(this,r,e)},ld.prototype._transform=function(r,e,t){t(new WB("_transform()"))},ld.prototype._write=function(r,e,t){var a=this._transformState;if(a.writecb=t,a.writechunk=r,a.writeencoding=e,!a.transforming){var o=this._readableState;(a.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},ld.prototype._read=function(r){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},ld.prototype._destroy=function(r,e){Yg.prototype._destroy.call(this,r,function(r){e(r)})};var aC={};aC=cg;function cg(r){if(!(this instanceof cg))return new cg(r);ik.call(this,r)}(Xf(),Wf)(cg,ik),cg.prototype._transform=function(r,$,a){a(null,r)};var $p,bC={};function cC(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var _p=(rf(),Td).codes,dC=_p.ERR_MISSING_ARGS,eC=_p.ERR_STREAM_DESTROYED;function aq(r){if(r)throw r}function fC(r){return r.setHeader&&"function"==typeof r.abort}function gC(r,e,$,a){a=cC(a);var n=!1;r.on("close",function(){n=!0}),void 0===$p&&($p=(_j(),$j)),$p(r,{readable:e,writable:$},function(r){if(r)return a(r);n=!0,a()});var o=!1;return function(e){if(!n&&!o)return o=!0,fC(r)?r.abort():"function"==typeof r.destroy?r.destroy():void a(e||new eC("pipe"))}}function bq(r){r()}function hC(r,e){return r.pipe(e)}function iC(r){return r.length?"function"!=typeof r[r.length-1]?aq:r.pop():aq}function jC(){for(var r=arguments.length,e=new Array(r),$=0;$<r;$++)e[$]=arguments[$];var a,n=iC(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new dC("streams");var o=e.map(function(r,$){var t=$<e.length-1;return gC(r,t,$>0,function(r){a||(a=r),r&&o.forEach(bq),t||(o.forEach(bq),n(a))})});return e.reduce(hC)}bC=jC;var md={},kC=md=md=(Yp(),Mp);md.Stream=kC;md.Readable=md;var lC=(Ep(),xp);md.Writable=lC;var cq=(uf(),tf);md.Duplex=cq;md.Transform=ik;md.PassThrough=aC;var mC=(_j(),$j);md.finished=mC;md.pipeline=bC;var jk={};let nC;jk="function"==typeof queueMicrotask?queueMicrotask:e=>(nC||(nC=Promise.resolve())).then(e).catch(e=>setTimeout(()=>{throw e},0));var dq={},oC=(Ad(),Vb).Buffer,pC=Zb("simple-peer"),kk=65536,qC=5e3,rC=5e3;function eq(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}function ub(e,t){return"string"==typeof e&&(e=new Error(e)),e.error instanceof Error&&(e=e.error),e.code=t,e}function sC(e){console.warn(e)}class vf extends cq{constructor(e){if(super(e=Object.assign({allowHalfOpen:!1},e)),this._id=ap(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||ap(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||vf.channelConfig,this.negotiated=this.channelConfig.negotiated,this.config=Object.assign({},vf.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(e=>e),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=void 0===e.trickle||e.trickle,this.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,this.iceCompleteTimeout=e.iceCompleteTimeout||qC,this.destroyed=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:Km(),!this._wrtc)throw"undefined"==typeof window?ub("No WebRTC support: Specify `opts.wrtc` option in this environment","ERR_WEBRTC_SUPPORT"):ub("No WebRTC support: Not a supported browser","ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!this.negotiated&&!this.initiator,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._firstStable=!0,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){return void jk(()=>this.destroy(ub(t,"ERR_PC_CONSTRUCTOR")))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=e=>{this._onIceCandidate(e)},this.initiator||this.negotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=e=>{this._setupData(e)},this.streams&&this.streams.forEach(e=>{this.addStream(e)}),this._pc.ontrack=e=>{this._onTrack(e)},this.initiator&&this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw ub("cannot signal after peer is destroyed","ERR_SIGNALING");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(e=>{this._addIceCandidate(e)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(e=>{this.destroy(ub(e,"ERR_SET_REMOTE_DESCRIPTION"))}),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||this.destroy(ub("signal() called with invalid signal data","ERR_SIGNALING"))}_addIceCandidate(e){var t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(e=>{!t.address||t.address.endsWith(".local")?sC("Ignoring unsupported ICE candidate."):this.destroy(ub(e,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(i){this.destroy(ub(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:t}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}addTrack(e,t){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,s=i.get(t);if(s)throw s.removed?ub("Track has been removed. You should enable/disable tracks that you want to re-add.","ERR_SENDER_REMOVED"):ub("Track has already been added to that stream.","ERR_SENDER_ALREADY_ADDED");s=this._pc.addTrack(e,t),i.set(t,s),this._senderMap.set(e,i),this._needsNegotiation()}replaceTrack(e,t,i){this._debug("replaceTrack()");var s=this._senderMap.get(e),r=s?s.get(i):null;if(!r)throw ub("Cannot replace track that was never added.","ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,s),null!=r.replaceTrack?r.replaceTrack(t):this.destroy(ub("replaceTrack is not supported in this browser","ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){this._debug("removeSender()");var i=this._senderMap.get(e),s=i?i.get(t):null;if(!s)throw ub("Cannot remove track that was never added.","ERR_TRACK_NOT_ADDED");try{s.removed=!0,this._pc.removeTrack(s)}catch(r){"NS_ERROR_UNEXPECTED"===r.name?this._sendersAwaitingStable.push(s):this.destroy(ub(r,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,jk(()=>{this._batchedNegotiation=!1,this._debug("starting batched negotiation"),this.negotiate()}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}destroy(e){this._destroy(e,()=>{})}_destroy(e,t){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.destroyed=!0,this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()}}_setupData(e){if(!e.channel)return this.destroy(ub("Data channel event is missing `channel` property","ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=kk),this.channelName=this._channel.label,this._channel.onmessage=e=>{this._onChannelMessage(e)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=e=>{this.destroy(ub(e,"ERR_DATA_CHANNEL"))};var t=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(t&&this._onChannelClose(),t=!0):t=!1},rC)}_read(){}_write(e,t,i){if(this.destroyed)return i(ub("cannot write after peer is destroyed","ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(s){return this.destroy(ub(s,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>kk?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=eq(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(!this.destroyed){var t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp})}};this._pc.setLocalDescription(e).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(e=>{this.destroy(ub(e,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.destroy(ub(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{e.mid||!e.sender.track||e.requested||(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=eq(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(!this.destroyed){var t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(e).then(()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(e=>{this.destroy(ub(e,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.destroy(ub(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(ub("Connection failed.","ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),"connected"!==e&&"completed"!==e||(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(ub("Ice connection failed.","ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(ub("Ice connection closed.","ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){const t=e=>("[object Array]"===Object.prototype.toString.call(e.values)&&e.values.forEach(t=>{Object.assign(e,t)}),e);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var s=[];i.forEach(e=>{s.push(t(e))}),e(null,s)},t=>e(t)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var s=[];i.result().forEach(e=>{var i={};e.names().forEach(t=>{i[t]=e.stat(t)}),i.id=e.id,i.type=e.type,i.timestamp=e.timestamp,s.push(t(i))}),e(null,s)}},t=>e(t)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((t,i)=>{if(this.destroyed)return;t&&(i=[]);var s={},r={},a={},n=!1;i.forEach(e=>{"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(s[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(r[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(a[e.id]=e)});const o=e=>{n=!0;var t=r[e.localCandidateId];t&&(t.ip||t.address)?(this.localAddress=t.ip||t.address,this.localPort=Number(t.port)):t&&t.ipAddress?(this.localAddress=t.ipAddress,this.localPort=Number(t.portNumber)):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),this.localAddress=t[0],this.localPort=Number(t[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var i=s[e.remoteCandidateId];i&&(i.ip||i.address)?(this.remoteAddress=i.ip||i.address,this.remotePort=Number(i.port)):i&&i.ipAddress?(this.remoteAddress=i.ipAddress,this.remotePort=Number(i.portNumber)):"string"==typeof e.googRemoteAddress&&(i=e.googRemoteAddress.split(":"),this.remoteAddress=i[0],this.remotePort=Number(i[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(e=>{"transport"===e.type&&e.selectedCandidatePairId&&o(a[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&o(e)}),n||Object.keys(a).length&&!Object.keys(r).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(t){return this.destroy(ub(t,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug("sent chunk from \"write before connect\"");var h=this._cb;this._cb=null,h(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(e,100)})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>kk||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"!==this._pc.signalingState||this._firstStable||(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation&&(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()),this._debug("negotiate"),this.emit("negotiate")),this._firstStable=!1,this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=oC.from(t)),this.push(t)}}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),this._remoteStreams.some(e=>e.id===t.id)||(this._remoteStreams.push(t),jk(()=>{this.emit("stream",t)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],pC.apply(null,e)}}vf.WEBRTC_SUPPORT=!!Km(),vf.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}],sdpSemantics:"unified-plan"},vf.channelConfig={},dq=vf;var tC={};tC=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then};var lk={},uC={}.toString;lk=Array.isArray||function(r){return"[object Array]"==uC.call(r)};var Qb={};function vC(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===r.foo()}catch(e){return!1}}lb.TYPED_ARRAY_SUPPORT=vC();var fq=lb.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function lb(r,e,t){return lb.TYPED_ARRAY_SUPPORT||this instanceof lb?"number"==typeof r?gq(this,r):CC(this,r,e,t):new lb(r,e,t)}function mk(r){if(r>=fq)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+fq.toString(16)+" bytes");return 0|r}function wC(r){return r!=r}function wf(r,e){var t;return lb.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=lb.prototype:(null===(t=r)&&(t=new lb(e)),t.length=e),t}function gq(r,e){var t=wf(r,e<0?0:0|mk(e));if(!lb.TYPED_ARRAY_SUPPORT)for(var a=0;a<e;++a)t[a]=0;return t}function xC(r,e){var t=0|iq(e),a=wf(r,t),f=a.write(e);return f!==t&&(a=a.slice(0,f)),a}function nk(r,e){for(var t=e.length<0?0:0|mk(e.length),a=wf(r,t),f=0;f<t;f+=1)a[f]=255&e[f];return a}function yC(r,e,t,a){if(t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+(a||0))throw new RangeError("'length' is out of bounds");var f;return f=void 0===t&&void 0===a?new Uint8Array(e):void 0===a?new Uint8Array(e,t):new Uint8Array(e,t,a),lb.TYPED_ARRAY_SUPPORT?f.__proto__=lb.prototype:f=nk(r,f),f}function zC(r,e){if(lb.isBuffer(e)){var t=0|mk(e.length),a=wf(r,t);return 0===a.length?a:(e.copy(a,0,0,t),a)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||wC(e.length)?wf(r,0):nk(r,e);if("Buffer"===e.type&&Array.isArray(e.data))return nk(r,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function hq(r,e){var t;e=e||1/0;for(var a=r.length,f=null,$=[],n=0;n<a;++n){if((t=r.charCodeAt(n))>55295&&t<57344){if(!f){if(t>56319){(e-=3)>-1&&$.push(239,191,189);continue}if(n+1===a){(e-=3)>-1&&$.push(239,191,189);continue}f=t;continue}if(t<56320){(e-=3)>-1&&$.push(239,191,189),f=t;continue}t=65536+(f-55296<<10|t-56320)}else f&&(e-=3)>-1&&$.push(239,191,189);if(f=null,t<128){if((e-=1)<0)break;$.push(t)}else if(t<2048){if((e-=2)<0)break;$.push(t>>6|192,63&t|128)}else if(t<65536){if((e-=3)<0)break;$.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;$.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return $}function iq(r){return lb.isBuffer(r)?r.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer)?r.byteLength:("string"!=typeof r&&(r=""+r),0===r.length?0:hq(r).length)}function AC(r,e,t,a){for(var f=0;f<a&&!(f+t>=e.length||f>=r.length);++f)e[f+t]=r[f];return f}function BC(r,e,t,a){return AC(hq(e,r.length-t),r,t,a)}function CC(r,e,t,a){if("number"==typeof e)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?yC(r,e,t,a):"string"==typeof e?xC(r,e,t):zC(r,e)}lb.TYPED_ARRAY_SUPPORT&&(lb.prototype.__proto__=Uint8Array.prototype,lb.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&lb[Symbol.species]===lb&&Object.defineProperty(lb,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),lb.prototype.write=function(r,e,t){void 0===e?(t=this.length,e=0):void 0===t&&"string"==typeof e?(t=this.length,e=0):isFinite(e)&&(e|=0,isFinite(t)?t|=0:t=void 0);var a=this.length-e;if((void 0===t||t>a)&&(t=a),r.length>0&&(t<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return BC(this,r,e,t)},lb.prototype.slice=function(r,e){var t,a=this.length;if((r=~~r)<0?(r+=a)<0&&(r=0):r>a&&(r=a),(e=void 0===e?a:~~e)<0?(e+=a)<0&&(e=0):e>a&&(e=a),e<r&&(e=r),lb.TYPED_ARRAY_SUPPORT)(t=this.subarray(r,e)).__proto__=lb.prototype;else{var f=e-r;t=new lb(f,void 0);for(var $=0;$<f;++$)t[$]=this[$+r]}return t},lb.prototype.copy=function(r,e,t,a){if(t||(t=0),a||0===a||(a=this.length),e>=r.length&&(e=r.length),e||(e=0),a>0&&a<t&&(a=t),a===t)return 0;if(0===r.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),r.length-e<a-t&&(a=r.length-e+t);var f,$=a-t;if(this===r&&t<e&&e<a)for(f=$-1;f>=0;--f)r[f+e]=this[f+t];else if($<1e3||!lb.TYPED_ARRAY_SUPPORT)for(f=0;f<$;++f)r[f+e]=this[f+t];else Uint8Array.prototype.set.call(r,this.subarray(t,t+$),e);return $},lb.prototype.fill=function(r,e,t){if("string"==typeof r){if("string"==typeof e?(e=0,t=this.length):"string"==typeof t&&(t=this.length),1===r.length){var a=r.charCodeAt(0);a<256&&(r=a)}}else"number"==typeof r&&(r&=255);if(e<0||this.length<e||this.length<t)throw new RangeError("Out of range index");if(t<=e)return this;var f;if(e>>>=0,t=void 0===t?this.length:t>>>0,r||(r=0),"number"==typeof r)for(f=e;f<t;++f)this[f]=r;else{var $=lb.isBuffer(r)?r:new lb(r),n=$.length;for(f=0;f<t-e;++f)this[f+e]=$[f%n]}return this},lb.concat=function(r,e){if(!lk(r))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===r.length)return wf(null,0);var t;if(void 0===e)for(e=0,t=0;t<r.length;++t)e+=r[t].length;var a=gq(null,e),f=0;for(t=0;t<r.length;++t){var $=r[t];if(!lb.isBuffer($))throw new TypeError("\"list\" argument must be an Array of Buffers");$.copy(a,f),f+=$.length}return a},lb.byteLength=iq,lb.prototype._isBuffer=!0,lb.isBuffer=function(r){return!(null==r||!r._isBuffer)},Qb.alloc=function(r){var e=new lb(r);return e.fill(0),e},Qb.from=function(r){return new lb(r)};var jq,DC=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],ok=function(o){if(!o)throw new Error("\"version\" cannot be null or undefined");if(o<1||o>40)throw new Error("\"version\" should be in range from 1 to 40");return 4*o+17};var pk=function(o){return DC[o]};var xf=function(o){for(var t=0;0!==o;)t++,o>>>=1;return t};var EC=function(o){if("function"!=typeof o)throw new Error("\"toSJISFunc\" is not a valid function.");jq=o};var Zg=function(){return void 0!==jq};var FC=function(o){return jq(o)};var qk={bit:1};var yf={bit:0};var rk={bit:3};var sk={bit:2};function GC(r){if("string"!=typeof r)throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return qk;case"m":case"medium":return yf;case"q":case"quartile":return rk;case"h":case"high":return sk;default:throw new Error("Unknown EC Level: "+r);}}var HC=function(r){return r&&void 0!==r.bit&&r.bit>=0&&r.bit<4};var kq=function(r,$){if(HC(r))return r;try{return GC(r)}catch(t){return $}};var IC={};function lq(){this.buffer=[],this.length=0}lq.prototype={get:function(t){var r=Math.floor(t/8);return 1==(this.buffer[r]>>>7-t%8&1)},put:function(t,r){for(var f=0;f<r;f++)this.putBit(1==(t>>>r-f-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}},IC=lq;var JC={};function dg(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=Qb.alloc(t*t),this.reservedBit=Qb.alloc(t*t)}dg.prototype.set=function(t,r,i,e){var $=t*this.size+r;this.data[$]=i,e&&(this.reservedBit[$]=!0)},dg.prototype.get=function(t,r){return this.data[t*this.size+r]},dg.prototype.xor=function(t,r,i){this.data[t*this.size+r]^=i},dg.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]},JC=dg;var KC=ok,LC=function(e){if(1===e)return[];for(var o=Math.floor(e/7)+2,r=KC(e),t=145===r?26:2*Math.ceil((r-13)/(2*o-2)),$=[r-7],s=1;s<o-1;s++)$[s]=$[s-1]-t;return $.push(6),$.reverse()};var MC=function(e){for(var o=[],r=LC(e),t=r.length,$=0;$<t;$++)for(var s=0;s<t;s++)0===$&&0===s||0===$&&s===t-1||$===t-1&&0===s||o.push([r[$],r[s]]);return o};var NC=ok,mq=7,OC=function($){var o=NC($);return[[0,0],[o-mq,0],[0,o-mq]]};var nd={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var Yd={N1:3,N2:3,N3:40,N4:10},PC=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7};var QC=function(t){return PC(t)?parseInt(t,10):void 0};var RC=function(t){for(var e=t.size,r=0,$=0,n=0,a=null,N=null,s=0;s<e;s++){$=n=0,a=N=null;for(var o=0;o<e;o++){var p=t.get(s,o);p===a?$++:($>=5&&(r+=Yd.N1+($-5)),a=p,$=1),(p=t.get(o,s))===N?n++:(n>=5&&(r+=Yd.N1+(n-5)),N=p,n=1)}$>=5&&(r+=Yd.N1+($-5)),n>=5&&(r+=Yd.N1+(n-5))}return r};var SC=function(t){for(var e=t.size,r=0,$=0;$<e-1;$++)for(var n=0;n<e-1;n++){var a=t.get($,n)+t.get($,n+1)+t.get($+1,n)+t.get($+1,n+1);4!==a&&0!==a||r++}return r*Yd.N2};var TC=function(t){for(var e=t.size,r=0,$=0,n=0,a=0;a<e;a++){$=n=0;for(var N=0;N<e;N++)$=$<<1&2047|t.get(a,N),N>=10&&(1488===$||93===$)&&r++,n=n<<1&2047|t.get(N,a),N>=10&&(1488===n||93===n)&&r++}return r*Yd.N3};var UC=function(t){for(var e=0,r=t.data.length,$=0;$<r;$++)e+=t.data[$];return Math.abs(Math.ceil(100*e/r/5)-10)*Yd.N4};function VC(t,e,r){switch(t){case nd.PATTERN000:return(e+r)%2==0;case nd.PATTERN001:return e%2==0;case nd.PATTERN010:return r%3==0;case nd.PATTERN011:return(e+r)%3==0;case nd.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case nd.PATTERN101:return e*r%2+e*r%3==0;case nd.PATTERN110:return(e*r%2+e*r%3)%2==0;case nd.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t);}}var tk=function(t,e){for(var r=e.size,$=0;$<r;$++)for(var n=0;n<r;n++)e.isReserved(n,$)||e.xor(n,$,VC(t,n,$))};var WC=function(t,e){for(var r=Object.keys(nd).length,$=0,n=1/0,a=0;a<r;a++){e(a),tk(a,t);var N=RC(t)+SC(t)+TC(t)+UC(t);tk(a,t),N<n&&(n=N,$=a)}return $};var $g=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],_g=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],XC=function(e,$){switch($){case qk:return $g[4*(e-1)+0];case yf:return $g[4*(e-1)+1];case rk:return $g[4*(e-1)+2];case sk:return $g[4*(e-1)+3];default:return;}};var uk=function(e,$){switch($){case qk:return _g[4*(e-1)+0];case yf:return _g[4*(e-1)+1];case rk:return _g[4*(e-1)+2];case sk:return _g[4*(e-1)+3];default:return;}};var eg=Qb.alloc(512),vk=Qb.alloc(256);!function(){for(var $=1,r=0;r<255;r++)eg[r]=$,vk[$]=r,256&($<<=1)&&($^=285);for(r=255;r<512;r++)eg[r]=eg[r-255]}();var YC=function($){return eg[$]};var nq=function($,r){return 0===$||0===r?0:eg[vk[$]+vk[r]]};var ZC=function(r,$){for(var e=Qb.alloc(r.length+$.length-1),J=0;J<r.length;J++)for(var o=0;o<$.length;o++)e[J+o]^=nq(r[J],$[o]);return e};var $C=function(r,$){for(var e=Qb.from(r);e.length-$.length>=0;){for(var J=e[0],o=0;o<$.length;o++)e[o]^=nq($[o],J);for(var t=0;t<e.length&&0===e[t];)t++;e=e.slice(t)}return e};var _C=function(r){for(var $=Qb.from([1]),e=0;e<r;e++)$=ZC($,[1,YC(e)]);return $};var aD={},bD=(Ad(),Vb).Buffer;function wk(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}wk.prototype.initialize=function(e){this.degree=e,this.genPoly=_C(this.degree)},wk.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");var r=Qb.alloc(this.degree),o=bD.concat([e,r],e.length+this.degree),$=$C(o,this.genPoly),i=this.degree-$.length;if(i>0){var t=Qb.alloc(this.degree);return $.copy(t,i),t}return $},aD=wk;var aj=function($){return!isNaN($)&&$>=1&&$<=40};var oq="[0-9]+",cD="[A-Z $%*+\\-./:]+",xk="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",dD="(?:(?![A-Z0-9 $%*+\\-./:]|"+(xk=xk.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+",eD=new RegExp(xk,"g");var fD=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");var gD=new RegExp(dD,"g");var hD=new RegExp(oq,"g");var iD=new RegExp(cD,"g");var jD=new RegExp("^"+xk+"$"),kD=new RegExp("^"+oq+"$"),lD=new RegExp("^[A-Z0-9 $%*+\\-./:]+$"),mD=function($){return jD.test($)};var nD=function($){return kD.test($)};var oD=function($){return lD.test($)};var Fd={id:"Numeric",bit:1,ccBits:[10,12,14]};var od={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};var Jb={id:"Byte",bit:4,ccBits:[8,16,16]};var pd={id:"Kanji",bit:8,ccBits:[8,10,12]};var pq={bit:-1};var yk=function(r,$){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!aj($))throw new Error("Invalid version: "+$);return $>=1&&$<10?r.ccBits[0]:$<27?r.ccBits[1]:r.ccBits[2]};var pD=function(r){return nD(r)?Fd:oD(r)?od:mD(r)?pd:Jb};var qq=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")};var qD=function(r){return r&&r.bit&&r.ccBits};function rD(r){if("string"!=typeof r)throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return Fd;case"alphanumeric":return od;case"kanji":return pd;case"byte":return Jb;default:throw new Error("Unknown mode: "+r);}}var sD=function(r,$){if(qD(r))return r;try{return rD(r)}catch(t){return $}};var rq=7973,sq=xf(rq);function tD(r,o,$){for(var e=1;e<=40;e++)if(o<=uq(e,$,r))return e}function tq(r,o){return yk(r,o)+4}function uD(r,o){var $=0;return r.forEach(function(r){var e=tq(r.mode,o);$+=e+r.getBitsLength()}),$}function vD(r,o){for(var $=1;$<=40;$++){if(uD(r,$)<=uq($,o,pq))return $}}var wD=function(r,o){return aj(r)?parseInt(r,10):o};var uq=function(r,o,$){if(!aj(r))throw new Error("Invalid QR Code version");void 0===$&&($=Jb);var e=8*(pk(r)-uk(r,o));if($===pq)return e;var t=e-tq($,r);switch($){case Fd:return Math.floor(t/10*3);case od:return Math.floor(t/11*2);case pd:return Math.floor(t/13);case Jb:default:return Math.floor(t/8);}};var vq=function(r,o){var $,e=kq(o,yf);if(lk(r)){if(r.length>1)return vD(r,e);if(0===r.length)return 1;$=r[0]}else $=r;return tD($.mode,$.getLength(),e)};var xD=function(r){if(!aj(r)||r<7)throw new Error("Invalid QR Code version");for(var o=r<<12;xf(o)-sq>=0;)o^=rq<<xf(o)-sq;return r<<12|o};var wq=1335,yD=21522,xq=xf(wq),zD=function($,a){for(var r=$.bit<<3|a,t=r<<10;xf(t)-xq>=0;)t^=wq<<xf(t)-xq;return(r<<10|t)^yD};var yq={};function zf(t){this.mode=Fd,this.data=t.toString()}zf.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},zf.prototype.getLength=function(){return this.data.length},zf.prototype.getBitsLength=function(){return zf.getBitsLength(this.data.length)},zf.prototype.write=function(t){var a,r,e;for(a=0;a+3<=this.data.length;a+=3)r=this.data.substr(a,3),e=parseInt(r,10),t.put(e,10);var $=this.data.length-a;$>0&&(r=this.data.substr(a),e=parseInt(r,10),t.put(e,3*$+1))},yq=zf;var zq={},zk=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Af(a){this.mode=od,this.data=a}Af.getBitsLength=function(a){return 11*Math.floor(a/2)+a%2*6},Af.prototype.getLength=function(){return this.data.length},Af.prototype.getBitsLength=function(){return Af.getBitsLength(this.data.length)},Af.prototype.write=function(a){var t;for(t=0;t+2<=this.data.length;t+=2){var $=45*zk.indexOf(this.data[t]);$+=zk.indexOf(this.data[t+1]),a.put($,11)}this.data.length%2&&a.put(zk.indexOf(this.data[t]),6)},zq=Af;var Aq={};function Bf(t){this.mode=Jb,this.data=Qb.from(t)}Bf.getBitsLength=function(t){return 8*t},Bf.prototype.getLength=function(){return this.data.length},Bf.prototype.getBitsLength=function(){return Bf.getBitsLength(this.data.length)},Bf.prototype.write=function(t){for(var $=0,e=this.data.length;$<e;$++)t.put(this.data[$],8)},Aq=Bf;var Bq={};function Cf(t){this.mode=pd,this.data=t}Cf.getBitsLength=function(t){return 13*t},Cf.prototype.getLength=function(){return this.data.length},Cf.prototype.getBitsLength=function(){return Cf.getBitsLength(this.data.length)},Cf.prototype.write=function(t){var a;for(a=0;a<this.data.length;a++){var r=FC(this.data[a]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[a]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13)}},Bq=Cf;var AD={},fg={single_source_shortest_paths:function(r,t,e){var s={},o={};o[t]=0;var u,i,a,n,h,p,$,f=fg.PriorityQueue.make();for(f.push(t,0);!f.empty();)for(a in i=(u=f.pop()).value,n=u.cost,h=r[i]||{})h.hasOwnProperty(a)&&(p=n+h[a],$=o[a],(void 0===o[a]||$>p)&&(o[a]=p,f.push(a,p),s[a]=i));if(void 0!==e&&void 0===o[e]){var v=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(v)}return s},extract_shortest_path_from_predecessor_list:function(r,t){for(var e=[],s=t;s;)e.push(s),r[s],s=r[s];return e.reverse(),e},find_path:function(r,t,e){var s=fg.single_source_shortest_paths(r,t,e);return fg.extract_shortest_path_from_predecessor_list(s,e)},PriorityQueue:{make:function(r){var t,e=fg.PriorityQueue,s={};for(t in r=r||{},e)e.hasOwnProperty(t)&&(s[t]=e[t]);return s.queue=[],s.sorter=r.sorter||e.default_sorter,s},default_sorter:function(r,t){return r.cost-t.cost},push:function(r,t){var e={value:r,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};AD=fg;function Cq(e){return unescape(encodeURIComponent(e)).length}function gg(e,$,r){for(var a,t=[];null!==(a=e.exec(r));)t.push({data:a[0],index:a.index,mode:$,length:a[0].length});return t}function Dq(e){var $,r,a=gg(hD,Fd,e),t=gg(iD,od,e);return Zg()?($=gg(gD,Jb,e),r=gg(eD,pd,e)):($=gg(fD,Jb,e),r=[]),a.concat(t,$,r).sort(function(e,$){return e.index-$.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function Ak(e,$){switch($){case Fd:return yq.getBitsLength(e);case od:return zq.getBitsLength(e);case pd:return Bq.getBitsLength(e);case Jb:return Aq.getBitsLength(e);}}function BD(e){return e.reduce(function(e,$){var r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===$.mode?(e[e.length-1].data+=$.data,e):(e.push($),e)},[])}function CD(e){for(var $=[],r=0;r<e.length;r++){var a=e[r];switch(a.mode){case Fd:$.push([a,{data:a.data,mode:od,length:a.length},{data:a.data,mode:Jb,length:a.length}]);break;case od:$.push([a,{data:a.data,mode:Jb,length:a.length}]);break;case pd:$.push([a,{data:a.data,mode:Jb,length:Cq(a.data)}]);break;case Jb:$.push([{data:a.data,mode:Jb,length:Cq(a.data)}]);}}return $}function DD(e,$){for(var r={},a={start:{}},t=["start"],n=0;n<e.length;n++){for(var c=e[n],o=[],d=0;d<c.length;d++){var g=c[d],Q=""+n+d;o.push(Q),r[Q]={node:g,lastCount:0},a[Q]={};for(var V=0;V<t.length;V++){var i=t[V];r[i]&&r[i].node.mode===g.mode?(a[i][Q]=Ak(r[i].lastCount+g.length,g.mode)-Ak(r[i].lastCount,g.mode),r[i].lastCount+=g.length):(r[i]&&(r[i].lastCount=g.length),a[i][Q]=Ak(g.length,g.mode)+4+yk(g.mode,$))}}t=o}for(V=0;V<t.length;V++)a[t[V]].end=0;return{map:a,table:r}}function Eq(e,$){var r,a=pD(e);if((r=sD($,a))!==Jb&&r.bit<a.bit)throw new Error("\""+e+"\" cannot be encoded with mode "+qq(r)+".\n Suggested mode is: "+qq(a));switch(r!==pd||Zg()||(r=Jb),r){case Fd:return new yq(e);case od:return new zq(e);case pd:return new Bq(e);case Jb:return new Aq(e);}}var Bk=function(e){return e.reduce(function(e,$){return"string"==typeof $?e.push(Eq($,null)):$.data&&e.push(Eq($.data,$.mode)),e},[])};var ED=function(e,$){for(var r=DD(CD(Dq(e,Zg())),$),a=AD.find_path(r.map,"start","end"),t=[],n=1;n<a.length-1;n++)t.push(r.table[a[n]].node);return Bk(BD(t))};var FD=function(e){return Bk(Dq(e,Zg()))};function GD(r,e){for(var $=r.size,t=OC(e),i=0;i<t.length;i++)for(var a=t[i][0],o=t[i][1],n=-1;n<=7;n++)if(!(a+n<=-1||$<=a+n))for(var s=-1;s<=7;s++)o+s<=-1||$<=o+s||(n>=0&&n<=6&&(0===s||6===s)||s>=0&&s<=6&&(0===n||6===n)||n>=2&&n<=4&&s>=2&&s<=4?r.set(a+n,o+s,!0,!0):r.set(a+n,o+s,!1,!0))}function HD(r){for(var e=r.size,$=8;$<e-8;$++){var t=$%2==0;r.set($,6,t,!0),r.set(6,$,t,!0)}}function ID(r,e){for(var $=MC(e),t=0;t<$.length;t++)for(var i=$[t][0],a=$[t][1],o=-2;o<=2;o++)for(var n=-2;n<=2;n++)-2===o||2===o||-2===n||2===n||0===o&&0===n?r.set(i+o,a+n,!0,!0):r.set(i+o,a+n,!1,!0)}function JD(r,e){for(var $,t,i,a=r.size,o=xD(e),n=0;n<18;n++)$=Math.floor(n/3),t=n%3+a-8-3,i=1==(o>>n&1),r.set($,t,i,!0),r.set(t,$,i,!0)}function Ck(r,e,$){var t,i,a=r.size,o=zD(e,$);for(t=0;t<15;t++)i=1==(o>>t&1),t<6?r.set(t,8,i,!0):t<8?r.set(t+1,8,i,!0):r.set(a-15+t,8,i,!0),t<8?r.set(8,a-t-1,i,!0):t<9?r.set(8,15-t-1+1,i,!0):r.set(8,15-t-1,i,!0);r.set(a-8,8,1,!0)}function KD(r,e){for(var $=r.size,t=-1,i=$-1,a=7,o=0,n=$-1;n>0;n-=2)for(6===n&&n--;;){for(var s=0;s<2;s++)if(!r.isReserved(i,n-s)){var v=!1;o<e.length&&(v=1==(e[o]>>>a&1)),r.set(i,n-s,v),-1===--a&&(o++,a=7)}if((i+=t)<0||$<=i){i-=t,t=-t;break}}}function LD(r,e,$){var t=new IC;$.forEach(function(e){t.put(e.mode.bit,4),t.put(e.getLength(),yk(e.mode,r)),e.write(t)});var i=8*(pk(r)-uk(r,e));for(t.getLengthInBits()+4<=i&&t.put(0,4);t.getLengthInBits()%8!=0;)t.putBit(0);for(var a=(i-t.getLengthInBits())/8,o=0;o<a;o++)t.put(o%2?17:236,8);return MD(t,r,e)}function MD(r,e,$){for(var t=pk(e),i=t-uk(e,$),a=XC(e,$),o=a-t%a,n=Math.floor(t/a),s=Math.floor(i/a),v=s+1,b=n-s,y=new aD(b),X=0,f=new Array(a),u=new Array(a),l=0,c=Qb.from(r.buffer),d=0;d<a;d++){var m=d<o?s:v;f[d]=c.slice(X,X+m),u[d]=y.encode(f[d]),X+=m,l=Math.max(l,m)}var p,g,C=Qb.alloc(t),h=0;for(p=0;p<l;p++)for(g=0;g<a;g++)p<f[g].length&&(C[h++]=f[g][p]);for(p=0;p<b;p++)for(g=0;g<a;g++)C[h++]=u[g][p];return C}function ND(r,e,$,t){var i;if(lk(r))i=Bk(r);else{if("string"!=typeof r)throw new Error("Invalid data");var a=e;if(!a){var o=FD(r);a=vq(o,$)}i=ED(r,a||40)}var n=vq(i,$);if(!n)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<n)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+n+".\n")}else e=n;var s=LD(e,$,i),v=ok(e),b=new JC(v);return GD(b,e),HD(b),ID(b,e),Ck(b,$,0),e>=7&&JD(b,e),KD(b,s),isNaN(t)&&(t=WC(b,Ck.bind(null,b,$))),tk(t,b),Ck(b,$,t),{modules:b,version:e,errorCorrectionLevel:$,maskPattern:t,segments:i}}var Fq=function(r,e){if(void 0===r||""===r)throw new Error("No input text");var $,t,i=yf;return void 0!==e&&(i=kq(e.errorCorrectionLevel,yf),$=wD(e.version),t=QC(e.maskPattern),e.toSJISFunc&&EC(e.toSJISFunc)),ND(r,$,i,t)};function Gq(r){if("number"==typeof r&&(r=r.toString()),"string"!=typeof r)throw new Error("Color should be defined as hex string");var t=r.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+r);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map(function(r){return[r,r]}))),6===t.length&&t.push("F","F");var e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:255&e,hex:"#"+t.slice(0,6).join("")}}var Hq=function(r){r||(r={}),r.color||(r.color={});var t=void 0===r.margin||null===r.margin||r.margin<0?4:r.margin,e=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:e,scale:e?4:o,margin:t,color:{dark:Gq(r.color.dark||"#000000ff"),light:Gq(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}};var Iq=function(r,t){return t.width&&t.width>=r+2*t.margin?t.width/(r+2*t.margin):t.scale};var OD=function(r,t){var e=Iq(r,t);return Math.floor((r+2*t.margin)*e)};var PD=function(r,t,e){for(var o=t.modules.size,a=t.modules.data,n=Iq(o,e),i=Math.floor((o+2*e.margin)*n),$=e.margin*n,g=[e.color.light,e.color.dark],l=0;l<i;l++)for(var h=0;h<i;h++){var p=4*(l*i+h),c=e.color.light;if(l>=$&&h>=$&&l<i-$&&h<i-$)c=g[a[Math.floor((l-$)/n)*o+Math.floor((h-$)/n)]?1:0];r[p++]=c.r,r[p++]=c.g,r[p++]=c.b,r[p]=c.a}};function QD(e,t,r){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=r,t.width=r,t.style.height=r+"px",t.style.width=r+"px"}function RD(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}var Jq=function(e,t,r){var a=r,o=t;void 0!==a||t&&t.getContext||(a=t,t=void 0),t||(o=RD()),a=Hq(a);var $=OD(e.modules.size,a),n=o.getContext("2d"),i=n.createImageData($,$);return PD(i.data,e,a),QD(n,o,$),n.putImageData(i,0,0),o};var SD=function(e,t,r){var a=r;void 0!==a||t&&t.getContext||(a=t,t=void 0),a||(a={});var o=Jq(e,t,a),$=a.type||"image/png",n=a.rendererOpts||{};return o.toDataURL($,n.quality)};function Kq(r,t){var $=r.a/255,o=t+"=\""+r.hex+"\"";return $<1?o+" "+t+"-opacity=\""+$.toFixed(2).slice(1)+"\"":o}function Dk(r,t,$){var o=r+t;return void 0!==$&&(o+=" "+$),o}function TD(r,t,$){for(var o="",e=0,a=!1,i=0,v=0;v<r.length;v++){var n=Math.floor(v%t),l=Math.floor(v/t);n||a||(a=!0),r[v]?(i++,v>0&&n>0&&r[v-1]||(o+=a?Dk("M",n+$,.5+l+$):Dk("m",e,0),e=0,a=!1),n+1<t&&r[v+1]||(o+=Dk("h",i),i=0)):e++}return o}var UD=function(r,t,$){var o=Hq(t),e=r.modules.size,a=r.modules.data,i=e+2*o.margin,v=o.color.light.a?"<path "+Kq(o.color.light,"fill")+" d=\"M0 0h"+i+"v"+i+"H0z\"/>":"",n="<path "+Kq(o.color.dark,"stroke")+" d=\""+TD(a,e,o.margin)+"\"/>",l="viewBox=\"0 0 "+i+" "+i+"\"",s="<svg xmlns=\"http://www.w3.org/2000/svg\" "+(o.width?"width=\""+o.width+"\" height=\""+o.width+"\" ":"")+l+" shape-rendering=\"crispEdges\">"+v+n+"</svg>\n";return"function"==typeof $&&$(null,s),s};function Ek(r,e,$,a,t){var n=[].slice.call(arguments,1),o=n.length,C="function"==typeof n[o-1];if(!C&&!tC())throw new Error("Callback required as last argument");if(!C){if(o<1)throw new Error("Too few arguments provided");return 1===o?($=e,e=a=void 0):2!==o||e.getContext||(a=$,$=e,e=void 0),new Promise(function(t,n){try{var o=Fq($,a);t(r(o,e,a))}catch(C){n(C)}})}if(o<2)throw new Error("Too few arguments provided");2===o?(t=$,$=e,e=a=void 0):3===o&&(e.getContext&&void 0===t?(t=a,a=void 0):(t=a,a=$,$=e,e=void 0));try{var x=Fq($,a);t(null,r(x,e,a))}catch(v){t(v)}}var VD=Ek.bind(null,Jq);var c=Ek.bind(null,SD);var d=Ek.bind(null,function(r,e,$){return UD(r,$)});var bj={};var WD=function(t,e){return(WD=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function $b(t,e){function r(){this.constructor=t}WD(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Zd=function(){return Zd=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},Zd.apply(this,arguments)};function Lq(t,e,r,o){return new(r||(r=Promise))(function(n,a){function $(t){try{x(o.next(t))}catch(e){a(e)}}function i(t){try{x(o.throw(t))}catch(e){a(e)}}function x(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then($,i)}x((o=o.apply(t,e||[])).next())})}function Mq(t,e){var r,o,n,a,$={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;$;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return $.label++,{value:a[1],done:!1};case 5:$.label++,o=a[1],a=[0];continue;case 7:a=$.ops.pop(),$.trys.pop();continue;default:if(!(n=(n=$.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){$=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){$.label=a[1];break}if(6===a[0]&&$.label<n[1]){$.label=n[1],n=a;break}if(n&&$.label<n[2]){$.label=n[2],$.ops.push(a);break}n[2]&&$.ops.pop(),$.trys.pop();continue;}a=e.call(t,$)}catch(i){a=[6,i],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}function Kb(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function hg(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,a=r.call(t),$=[];try{for(;(void 0===e||e-->0)&&!(o=a.next()).done;)$.push(o.value)}catch(i){n={error:i}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return $}function Df(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(hg(arguments[e]));return t}function Nq(t){return this instanceof Nq?(this.v=t,this):new Nq(t)}var gb={};Object.defineProperty(gb,"__esModule",{value:!0});var cj={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Oq=function(r,e){if(!r)throw Pq(e)},Pq=function(r){return new Error("Firebase Database ("+cj.SDK_VERSION+") INTERNAL ASSERT FAILED: "+r)},Qq=function(r){for(var e=[],t=0,$=0;$<r.length;$++){var o=r.charCodeAt($);o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=63&o|128):55296==(64512&o)&&$+1<r.length&&56320==(64512&r.charCodeAt($+1))?(o=65536+((1023&o)<<10)+(1023&r.charCodeAt(++$)),e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=63&o|128):(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=63&o|128)}return e},XD=function(r){for(var e=[],t=0,$=0;t<r.length;){var o=r[t++];if(o<128)e[$++]=String.fromCharCode(o);else if(o>191&&o<224){var a=r[t++];e[$++]=String.fromCharCode((31&o)<<6|63&a)}else if(o>239&&o<365){var i=((7&o)<<18|(63&(a=r[t++]))<<12|(63&(n=r[t++]))<<6|63&r[t++])-65536;e[$++]=String.fromCharCode(55296+(i>>10)),e[$++]=String.fromCharCode(56320+(1023&i))}else{a=r[t++];var n=r[t++];e[$++]=String.fromCharCode((15&o)<<12|(63&a)<<6|63&n)}}return e.join("")},Fk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,$=[],o=0;o<r.length;o+=3){var a=r[o],i=o+1<r.length,n=i?r[o+1]:0,s=o+2<r.length,u=s?r[o+2]:0,x=a>>2,c=(3&a)<<4|n>>4,A=(15&n)<<2|u>>6,v=63&u;s||(v=64,i||(A=64)),$.push(t[x],t[c],t[A],t[v])}return $.join("")},encodeString:function(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(Qq(r),e)},decodeString:function(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):XD(this.decodeStringToByteArray(r,e))},decodeStringToByteArray:function(r,e){this.init_();for(var t=e?this.charToByteMapWebSafe_:this.charToByteMap_,$=[],o=0;o<r.length;){var a=t[r.charAt(o++)],i=o<r.length?t[r.charAt(o)]:0,n=++o<r.length?t[r.charAt(o)]:64,s=++o<r.length?t[r.charAt(o)]:64;if(++o,null==a||null==i||null==n||null==s)throw Error();var u=a<<2|i>>4;if($.push(u),64!==n){var x=i<<4&240|n>>2;if($.push(x),64!==s){var c=n<<6&192|s;$.push(c)}}}return $},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}},YD=function(r){var e=Qq(r);return Fk.encodeByteArray(e,!0)},Gk=function(r){try{return Fk.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function ZD(r){return Hk(void 0,r)}function Hk(r,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===r&&(r={});break;case Array:r=[];break;default:return e;}for(var t in e)e.hasOwnProperty(t)&&(r[t]=Hk(r[t],e[t]));return r}var $D=function(){function r(){var r=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(e,t){r.resolve=e,r.reject=t})}return r.prototype.wrapCallback=function(r){var e=this;return function(t,$){t?e.reject(t):e.resolve($),"function"==typeof r&&(e.promise.catch(function(){}),1===r.length?r(t):r(t,$))}},r}();function ig(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function _D(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ig())}function Rq(){try{return"[object process]"===Object.prototype.toString.call(Rb.process)}catch(r){return!1}}function aE(){return"object"==typeof self&&self.self===self}function bE(){var r="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof r&&void 0!==r.id}function cE(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function dE(){return ig().indexOf("Electron/")>=0}function eE(){var r=ig();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function fE(){return ig().indexOf("MSAppHost/")>=0}function gE(){return!0===cj.NODE_CLIENT||!0===cj.NODE_ADMIN}function hE(){return!Rq()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}var iE="FirebaseError",Sq=function(r){function e(t,$){var o=r.call(this,$)||this;return o.code=t,o.name=iE,Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,Tq.prototype.create),o}return $b(e,r),e}(Error),Tq=function(){function r(r,e,t){this.service=r,this.serviceName=e,this.errors=t}return r.prototype.create=function(r){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];for(var $=e[0]||{},o=this.service+"/"+r,a=this.errors[r],i=a?jE(a,$):"Error",n=this.serviceName+": "+i+" ("+o+").",s=new Sq(o,n),u=0,x=Object.keys($);u<x.length;u++){var c=x[u];"_"!==c.slice(-1)&&(c in s&&console.warn("Overwriting FirebaseError base field \""+c+"\" can cause unexpected behavior."),s[c]=$[c])}return s},r}();function jE(r,e){return r.replace(kE,function(r,t){var $=e[t];return null!=$?$.toString():"<"+t+"?>"})}var kE=/\{\$([^}]+)}/g;function Ik(r){return JSON.parse(r)}function lE(r){return JSON.stringify(r)}var jg=function(r){var e={},t={},$={},o="";try{var a=r.split(".");e=Ik(Gk(a[0])||""),t=Ik(Gk(a[1])||""),o=a[2],$=t.d||{},delete t.d}catch(i){}return{header:e,claims:t,data:$,signature:o}},mE=function(r){var e=jg(r).claims,t=Math.floor(new Date().getTime()/1e3),$=0,o=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?$=e.nbf:e.hasOwnProperty("iat")&&($=e.iat),o=e.hasOwnProperty("exp")?e.exp:$+86400),!!t&&!!$&&!!o&&t>=$&&t<=o},nE=function(r){var e=jg(r).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},oE=function(r){var e=jg(r).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},pE=function(r){var e=jg(r).claims;return"object"==typeof e&&!0===e.admin};function qE(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function rE(r,e){return Object.prototype.hasOwnProperty.call(r,e)?r[e]:void 0}function sE(r){for(var e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function tE(r,e,t){var $={};for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&($[o]=e.call(t,r[o],o,r));return $}function uE(r){for(var e=[],t=function(r,t){Array.isArray(t)?t.forEach(function(t){e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))},$=0,o=Object.entries(r);$<o.length;$++){var a=o[$];t(a[0],a[1])}return e.length?"&"+e.join("&"):""}function vE(r){var e={};return r.replace(/^\?/,"").split("&").forEach(function(r){if(r){var t=r.split("=");e[t[0]]=t[1]}}),e}var wE=function(){function r(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var r=1;r<this.blockSize;++r)this.pad_[r]=0;this.reset()}return r.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},r.prototype.compress_=function(r,e){e||(e=0);var t=this.W_;if("string"==typeof r)for(var $=0;$<16;$++)t[$]=r.charCodeAt(e)<<24|r.charCodeAt(e+1)<<16|r.charCodeAt(e+2)<<8|r.charCodeAt(e+3),e+=4;else for($=0;$<16;$++)t[$]=r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3],e+=4;for($=16;$<80;$++){var o=t[$-3]^t[$-8]^t[$-14]^t[$-16];t[$]=4294967295&(o<<1|o>>>31)}var a,i,n=this.chain_[0],s=this.chain_[1],u=this.chain_[2],x=this.chain_[3],c=this.chain_[4];for($=0;$<80;$++){$<40?$<20?(a=x^s&(u^x),i=1518500249):(a=s^u^x,i=1859775393):$<60?(a=s&u|x&(s|u),i=2400959708):(a=s^u^x,i=3395469782);o=(n<<5|n>>>27)+a+c+i+t[$]&4294967295;c=x,x=u,u=4294967295&(s<<30|s>>>2),s=n,n=o}this.chain_[0]=this.chain_[0]+n&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+x&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},r.prototype.update=function(r,e){if(null!=r){void 0===e&&(e=r.length);for(var t=e-this.blockSize,$=0,o=this.buf_,a=this.inbuf_;$<e;){if(0===a)for(;$<=t;)this.compress_(r,$),$+=this.blockSize;if("string"==typeof r){for(;$<e;)if(o[a]=r.charCodeAt($),++$,++a===this.blockSize){this.compress_(o),a=0;break}}else for(;$<e;)if(o[a]=r[$],++$,++a===this.blockSize){this.compress_(o),a=0;break}}this.inbuf_=a,this.total_+=e}},r.prototype.digest=function(){var r=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var t=this.blockSize-1;t>=56;t--)this.buf_[t]=255&e,e/=256;this.compress_(this.buf_);var $=0;for(t=0;t<5;t++)for(var o=24;o>=0;o-=8)r[$]=this.chain_[t]>>o&255,++$;return r},r}();function xE(r,e){var t=new yE(r,e);return t.subscribe.bind(t)}var yE=function(){function r(r,e){var t=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){r(t)}).catch(function(r){t.error(r)})}return r.prototype.next=function(r){this.forEachObserver(function(e){e.next(r)})},r.prototype.error=function(r){this.forEachObserver(function(e){e.error(r)}),this.close(r)},r.prototype.complete=function(){this.forEachObserver(function(r){r.complete()}),this.close()},r.prototype.subscribe=function(r,e,t){var $,o=this;if(void 0===r&&void 0===e&&void 0===t)throw new Error("Missing Observer.");void 0===($=AE(r,["next","error","complete"])?r:{next:r,error:e,complete:t}).next&&($.next=Jk),void 0===$.error&&($.error=Jk),void 0===$.complete&&($.complete=Jk);var a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?$.error(o.finalError):$.complete()}catch(r){}}),this.observers.push($),a},r.prototype.unsubscribeOne=function(r){void 0!==this.observers&&void 0!==this.observers[r]&&(delete this.observers[r],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},r.prototype.forEachObserver=function(r){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,r)},r.prototype.sendOne=function(r,e){var t=this;this.task.then(function(){if(void 0!==t.observers&&void 0!==t.observers[r])try{e(t.observers[r])}catch($){"undefined"!=typeof console&&console.error&&console.error($)}})},r.prototype.close=function(r){var e=this;this.finalized||(this.finalized=!0,void 0!==r&&(this.finalError=r),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},r}();function zE(r,e){return function(){for(var t=[],$=0;$<arguments.length;$++)t[$]=arguments[$];Promise.resolve(!0).then(function(){r.apply(void 0,t)}).catch(function(r){e&&e(r)})}}function AE(r,e){if("object"!=typeof r||null===r)return!1;for(var t=0,$=e;t<$.length;t++){var o=$[t];if(o in r&&"function"==typeof r[o])return!0}return!1}function Jk(){}var BE=function(r,e,t,$){var o;if($<e?o="at least "+e:$>t&&(o=0===t?"none":"no more than "+t),o)throw new Error(r+" failed: Was called with "+$+(1===$?" argument.":" arguments.")+" Expects "+o+".")};function dj(r,e,t){var $="";switch(e){case 1:$=t?"first":"First";break;case 2:$=t?"second":"Second";break;case 3:$=t?"third":"Third";break;case 4:$=t?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?");}var o=r+" failed: ";return o+=$+" argument "}function CE(r,e,t,$){if((!$||t)&&"string"!=typeof t)throw new Error(dj(r,e,$)+"must be a valid firebase namespace.")}function DE(r,e,t,$){if((!$||t)&&"function"!=typeof t)throw new Error(dj(r,e,$)+"must be a valid function.")}function EE(r,e,t,$){if((!$||t)&&("object"!=typeof t||null===t))throw new Error(dj(r,e,$)+"must be a valid context object.")}var FE=function(r){for(var e=[],t=0,$=0;$<r.length;$++){var o=r.charCodeAt($);if(o>=55296&&o<=56319){var a=o-55296;Oq(++$<r.length,"Surrogate pair missing trail surrogate."),o=65536+(a<<10)+(r.charCodeAt($)-56320)}o<128?e[t++]=o:o<2048?(e[t++]=o>>6|192,e[t++]=63&o|128):o<65536?(e[t++]=o>>12|224,e[t++]=o>>6&63|128,e[t++]=63&o|128):(e[t++]=o>>18|240,e[t++]=o>>12&63|128,e[t++]=o>>6&63|128,e[t++]=63&o|128)}return e},GE=function(r){for(var e=0,t=0;t<r.length;t++){var $=r.charCodeAt(t);$<128?e++:$<2048?e+=2:$>=55296&&$<=56319?(e+=4,t++):e+=3}return e},kg=cj;gb.CONSTANTS=kg;var Sb=$D;gb.Deferred=Sb;var Kk=Tq;gb.ErrorFactory=Kk;var HE=Sq;gb.FirebaseError=HE;var Uq=wE;gb.Sha1=Uq;var cb=Oq;gb.assert=cb;var Ef=Pq;gb.assertionError=Ef;var IE=zE;gb.async=IE;var Vq=Fk;gb.base64=Vq;var JE=Gk;gb.base64Decode=JE;var Wq=YD;gb.base64Encode=Wq;var Nb=qE;gb.contains=Nb;var Xq=xE;gb.createSubscribe=Xq;var KE=jg;gb.decode=KE;var Lk=ZD;gb.deepCopy=Lk;var ej=Hk;gb.deepExtend=ej;var _b=dj;gb.errorPrefix=_b;var LE=ig;gb.getUA=LE;var Yq=pE;gb.isAdmin=Yq;var Zq=aE;gb.isBrowser=Zq;var ME=bE;gb.isBrowserExtension=ME;var NE=dE;gb.isElectron=NE;var fj=sE;gb.isEmpty=fj;var OE=eE;gb.isIE=OE;var Mk=_D;gb.isMobileCordova=Mk;var $q=Rq;gb.isNode=$q;var gd=gE;gb.isNodeSdk=gd;var _q=cE;gb.isReactNative=_q;var PE=hE;gb.isSafari=PE;var QE=fE;gb.isUWP=QE;var av=oE;gb.isValidFormat=av;var RE=mE;gb.isValidTimestamp=RE;var SE=nE;gb.issuedAtTime=SE;var gj=Ik;gb.jsonEval=gj;var lg=tE;gb.map=lg;var bv=uE;gb.querystring=bv;var TE=vE;gb.querystringDecode=TE;var Xb=rE;gb.safeGet=Xb;var mg=GE;gb.stringLength=mg;var cv=FE;gb.stringToByteArray=cv;var Bb=lE;gb.stringify=Bb;var fb=BE;gb.validateArgCount=fb;var Cb=DE;gb.validateCallback=Cb;var Nk=EE;gb.validateContextObject=Nk;var UE=CE;gb.validateNamespace=UE;var hj={};Object.defineProperty(hj,"__esModule",{value:!0});var VE=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),Ff="[DEFAULT]",dv=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=Ff);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Sb;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=Zd({identifier:Ff,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(s){if(r)return null;throw s}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,XE(t))try{this.getOrInitializeService(Ff)}catch(c){}try{for(var r=Kb(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=hg(i.value,2),s=o[0],a=o[1],$=this.normalizeInstanceIdentifier(s);try{var p=this.getOrInitializeService($);a.resolve(p)}catch(c){}}}catch(v){e={error:v}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=Ff),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Lq(this,void 0,void 0,function(){var t;return Mq(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))];case 1:return e.sent(),[2];}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,WE(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:Ff:t},t}();function WE(t){return t===Ff?void 0:t}function XE(t){return"EAGER"===t.instantiationMode}var YE=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new dv(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}(),ng=VE;hj.Component=ng;var ev=YE;hj.ComponentContainer=ev;var ZE=dv;hj.Provider=ZE;var $E,og;function ad(){for(var e=0,r=0,o=arguments.length;r<o;r++)e+=arguments[r].length;var t=Array(e),$=0;for(r=0;r<o;r++)for(var p=arguments[r],l=0,n=p.length;l<n;l++,$++)t[$]=p[l];return t}var vb,Ok=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(vb||($E=vb={},$E));var fv={debug:vb.DEBUG,verbose:vb.VERBOSE,info:vb.INFO,warn:vb.WARN,error:vb.ERROR,silent:vb.SILENT},_E=vb.INFO,aF=((og={})[vb.DEBUG]="log",og[vb.VERBOSE]="log",og[vb.INFO]="info",og[vb.WARN]="warn",og[vb.ERROR]="error",og),bF=function(e,r){for(var o=[],t=2;t<arguments.length;t++)o[t-2]=arguments[t];if(!(r<e.logLevel)){var $=new Date().toISOString(),p=aF[r];if(!p)throw new Error("Attempted to log a message with an invalid logType (value: "+r+")");console[p].apply(console,ad(["["+$+"]  "+e.name+":"],o))}},gv=function(){function e(e){this.name=e,this._logLevel=_E,this._logHandler=bF,this._userLogHandler=null,Ok.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in vb))throw new TypeError("Invalid value \""+e+"\" assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?fv[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,ad([this,vb.DEBUG],e)),this._logHandler.apply(this,ad([this,vb.DEBUG],e))},e.prototype.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,ad([this,vb.VERBOSE],e)),this._logHandler.apply(this,ad([this,vb.VERBOSE],e))},e.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,ad([this,vb.INFO],e)),this._logHandler.apply(this,ad([this,vb.INFO],e))},e.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,ad([this,vb.WARN],e)),this._logHandler.apply(this,ad([this,vb.WARN],e))},e.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,ad([this,vb.ERROR],e)),this._logHandler.apply(this,ad([this,vb.ERROR],e))},e}();function cF(e){Ok.forEach(function(r){r.setLogLevel(e)})}function dF(e,r){for(var o=function(o){var t=null;r&&r.level&&(t=fv[r.level]),o.userLogHandler=null===e?null:function(r,o){for(var $=[],p=2;p<arguments.length;p++)$[p-2]=arguments[p];var l=$.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(function(e){return e}).join(" ");o>=(null!=t?t:r.logLevel)&&e({level:vb[o].toLowerCase(),message:l,args:$,type:r.name})}},t=0,$=Ok;t<$.length;t++){o($[t])}}var pg={};Object.defineProperty(pg,"__esModule",{value:!0});var Gf,hv,eF=((Gf={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Gf["bad-app-name"]="Illegal App name: '{$appName}",Gf["duplicate-app"]="Firebase App named '{$appName}' already exists",Gf["app-deleted"]="Firebase App named '{$appName}' already deleted",Gf["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Gf["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Gf),Hf=new Kk("app","Firebase",eF),iv="@firebase/app",fF="0.6.6",ij="[DEFAULT]",gF=((hv={})[iv]="fire-core",hv["fire-js"]="fire-js",hv),If=new gv("@firebase/app"),jj=function(){function e(e,r,a){var $,n,t=this;this.firebase_=a,this.isDeleted_=!1,this.name_=r.name,this.automaticDataCollectionEnabled_=r.automaticDataCollectionEnabled||!1,this.options_=Lk(e),this.container=new ev(r.name),this._addComponent(new ng("app",function(){return t},"PUBLIC"));try{for(var i=Kb(this.firebase_.INTERNAL.components.values()),o=i.next();!o.done;o=i.next()){var d=o.value;this._addComponent(d)}}catch(s){$={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if($)throw $.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(r){e.checkDestroyed_(),r()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,r){return void 0===r&&(r=ij),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:r})},e.prototype._removeServiceInstance=function(e,r){void 0===r&&(r=ij),this.container.getProvider(e).clearInstance(r)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(r){If.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,r)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Hf.create("app-deleted",{appName:this.name_})},e}();jj.prototype.name&&jj.prototype.options||jj.prototype.delete||console.log("dc");var hF="7.15.2";function iF(e){var r={},a=new Map,$={__esModule:!0,initializeApp:function(a,n){void 0===n&&(n={});if("object"!=typeof n||null===n){var t=n;n={name:t}}var i=n;void 0===i.name&&(i.name=ij);var o=i.name;if("string"!=typeof o||!o)throw Hf.create("bad-app-name",{appName:String(o)});if(Nb(r,o))throw Hf.create("duplicate-app",{appName:o});var d=new e(a,i,$);return r[o]=d,d},app:n,registerVersion:function(e,r,a){var $,n=null!==($=gF[e])&&void 0!==$?$:e;a&&(n+="-"+a);var i=n.match(/\s|\//),o=r.match(/\s|\//);if(i||o){var d=["Unable to register library \""+n+"\" with version \""+r+"\":"];return i&&d.push("library name \""+n+"\" contains illegal characters (whitespace or \"/\")"),i&&o&&d.push("and"),o&&d.push("version name \""+r+"\" contains illegal characters (whitespace or \"/\")"),void If.warn(d.join(" "))}t(new ng(n+"-version",function(){return{library:n,version:r}},"VERSION"))},setLogLevel:cF,onLog:function(e,r){if(null!==e&&"function"!=typeof e)throw Hf.create("invalid-log-argument",{appName:name});dF(e,r)},apps:null,SDK_VERSION:hF,INTERNAL:{registerComponent:t,removeApp:function(e){delete r[e]},components:a,useAsService:function(e,r){if("serverAuth"===r)return null;return r}}};function n(e){if(e=e||ij,!Nb(r,e))throw Hf.create("no-app",{appName:e});return r[e]}function t(t){var i,o,d=t.name;if(a.has(d))return If.debug("There were multiple attempts to register component "+d+"."),"PUBLIC"===t.type?$[d]:null;if(a.set(d,t),"PUBLIC"===t.type){var s=function(e){if(void 0===e&&(e=n()),"function"!=typeof e[d])throw Hf.create("invalid-app-argument",{appName:d});return e[d]()};void 0!==t.serviceProps&&ej(s,t.serviceProps),$[d]=s,e.prototype[d]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this._getService.bind(this,d).apply(this,t.multipleInstances?e:[])}}try{for(var p=Kb(Object.keys(r)),v=p.next();!v.done;v=p.next()){var l=v.value;r[l]._addComponent(t)}}catch(c){i={error:c}}finally{try{v&&!v.done&&(o=p.return)&&o.call(p)}finally{if(i)throw i.error}}return"PUBLIC"===t.type?$[d]:null}return $.default=$,Object.defineProperty($,"apps",{get:function(){return Object.keys(r).map(function(e){return r[e]})}}),n.App=e,$}function jv(){var e=iF(jj);return e.INTERNAL=Zd(Zd({},e.INTERNAL),{createFirebaseNamespace:jv,extendNamespace:function(r){ej(e,r)},createSubscribe:Xq,ErrorFactory:Kk,deepExtend:ej}),e}var Pk=jv(),jF=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(kF(e)){var r=e.getImmediate();return r.library+"/"+r.version}return null}).filter(function(e){return e}).join(" ")},e}();function kF(e){var r=e.getComponent();return"VERSION"===(null==r?void 0:r.type)}function lF(e,r){e.INTERNAL.registerComponent(new ng("platform-logger",function(e){return new jF(e)},"PRIVATE")),e.registerVersion(iv,fF,r),e.registerVersion("fire-js","")}if(Zq()&&void 0!==self.firebase){If.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var kv=self.firebase.SDK_VERSION;kv&&kv.indexOf("LITE")>=0&&If.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var mF=Pk.initializeApp;Pk.initializeApp=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return $q()&&If.warn("\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the \"main\" field in package.json.\n      \n      If you are using Webpack, you can specify \"main\" as the first item in\n      \"resolve.mainFields\":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify \"main\"\n      as the first item in \"mainFields\", e.g. ['main', 'module'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      "),mF.apply(void 0,e)};var Qk=Pk;lF(Qk);var ib=Qk;pg.default=ib;var nF=Qk;pg.firebase=nF;var lv={};function oF($){return $&&"object"==typeof $&&"default"in $?$.default:$}var mv=oF(pg),pF="firebase",qF="7.15.4";mv.registerVersion(pF,qF,"app"),lv=mv;(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var n=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Rb&&Rb,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function i(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function r(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:i(t)}}!function(t,i){if(i){var r=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(i=i(o=r[t=t[t.length-1]]))!=o&&null!=i&&e(r,t,{configurable:!0,writable:!0,value:i})}}("Promise",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function i(){this.a=null}function o(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;i.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var a=n.setTimeout;i.prototype.c=function(t){a(t,0)},i.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(i){this.f(i)}}}this.a=null},i.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(i){n||(n=!0,t.call(e,i))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1;}n?this.u(t):this.h(t)}},e.prototype.u=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.w(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new i;return e.prototype.s=function(t){var e=this.f();t.Oa(e.resolve,e.reject)},e.prototype.w=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(i){n.reject(i)}},e.prototype.then=function(t,n){function i(t,e){return"function"==typeof t?function(e){try{r(t(e))}catch(n){o(n)}}:e}var r,o,a=new e(function(t,e){r=t,o=e});return this.Oa(i(t,r),i(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Oa=function(t,e){function n(){switch(i.b){case 1:t(i.c);break;case 2:e(i.c);break;default:throw Error("Unexpected state: "+i.b);}}var i=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=o,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=r(t),a=i.next();!a.done;a=i.next())o(a.value).Oa(e,n)})},e.all=function(t){var n=r(t),i=n.next();return i.done?o([]):new e(function(t,e){function r(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,o(i.value).Oa(r(a.length-1),e),i=n.next()}while(!i.done)})},e});var o=o||{},a=this||self,s=/^[\w+/_-]+[=]{0,2}$/,u=null;function c(){}function h(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function l(t){var e=h(t);return"array"==e||"object"==e&&"number"==typeof t.length}function f(t){return"function"==h(t)}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function p(t){return Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++m)}var v="closure_uid_"+(1e9*Math.random()>>>0),m=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function b(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function y(t,e,n){return(y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:b).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var I=Date.now||function(){return+new Date};function T(t,e){function n(){}n.prototype=e.prototype,t.Za=e.prototype,t.prototype=new n,t.prototype.constructor=t}function E(t,e,n){this.code=S+t,this.message=e||N[t]||"",this.a=n||null}function k(t){var e=t&&t.code;return e?new E(e.substring(S.length),t.message,t.serverResponse):null}T(E,Error),E.prototype.v=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},E.prototype.toJSON=function(){return this.v()};var A,S="auth/",N={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":"This operation is not supported in the environment this application is running on. \"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.","popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},_={hd:{Ra:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Xa:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},pd:{Ra:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Xa:"https://securetoken.googleapis.com/v1/token",Ua:"https://identitytoolkit.googleapis.com/v2/",id:"p"},rd:{Ra:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Xa:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},sd:{Ra:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Xa:"https://test-securetoken.sandbox.googleapis.com/v1/token",Ua:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function O(t){for(var e in _)if(_[e].id===t)return{firebaseEndpoint:(t=_[e]).Ra,secureTokenEndpoint:t.Xa,identityPlatformEndpoint:t.Ua};return null}function R(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function P(t){if(Error.captureStackTrace)Error.captureStackTrace(this,P);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function C(t,e){for(var n="",i=(t=t.split("%s")).length-1,r=0;r<i;r++)n+=t[r]+(r<e.length?e[r]:"%s");P.call(this,n+t[i])}function D(t,e){throw new C("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function L(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function M(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function x(){this.b=this.a=null}A=O("__EID__")?"__EID__":void 0,T(P,Error),P.prototype.name="CustomError",T(C,P),C.prototype.name="AssertionError",L.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var F=new L(function(){return new U},function(t){t.reset()});function j(){var t=me,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function U(){this.next=this.b=this.a=null}x.prototype.add=function(t,e){var n=F.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},U.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},U.prototype.reset=function(){this.next=this.b=this.a=null};var V=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},$=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};var q=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=[],r=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(i[r++]=s)}return i},K=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=Array(n),r="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in r&&(i[o]=e.call(void 0,r[o],o,t));return i},H=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t))return!0;return!1};function G(t,e){return 0<=V(t,e)}function B(t,e){var n;return(n=0<=(e=V(t,e)))&&Array.prototype.splice.call(t,e,1),n}function W(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,i=t.length-1;0<=i;--i)i in n&&e.call(void 0,n[i],i,t)}(t,function(n,i){e.call(void 0,n,i,t)&&1==Array.prototype.splice.call(t,i,1).length&&0})}function X(t){return Array.prototype.concat.apply([],arguments)}function J(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}var Y,z=String.prototype.trim?function(t){return t.trim()}:function(t){return /^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},Z=/&/g,Q=/</g,tt=/>/g,et=/"/g,nt=/'/g,it=/\x00/g,rt=/[\x00&<>"']/;function ot(t,e){return-1!=t.indexOf(e)}function at(t,e){return t<e?-1:t>e?1:0}t:{var st=a.navigator;if(st){var ut=st.userAgent;if(ut){Y=ut;break t}}Y=""}function ct(t){return ot(Y,t)}function ht(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function lt(t){for(var e in t)return!1;return!0}function ft(t){var e,n={};for(e in t)n[e]=t[e];return n}var dt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<dt.length;o++)n=dt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function vt(t,e){t:{try{var n=t&&t.ownerDocument,i=n&&(n.defaultView||n.parentWindow);if((i=i||a).Element&&i.Location){var r=i;break t}}catch(s){}r=null}if(r&&void 0!==r[e]&&(!t||!(t instanceof r[e])&&(t instanceof r.Location||t instanceof r.Element))){if(d(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(s){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;D("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function mt(t,e){this.a=t===yt&&e||"",this.b=bt}function gt(t){return t instanceof mt&&t.constructor===mt&&t.b===bt?t.a:(D("expected object of type Const, got '"+t+"'"),"type_error:Const")}mt.prototype.ra=!0,mt.prototype.qa=function(){return this.a},mt.prototype.toString=function(){return"Const{"+this.a+"}"};var bt={},yt={},wt=new mt(yt,"");function It(t,e){this.a=t===Nt&&e||"",this.b=St}function Tt(t){return t instanceof It&&t.constructor===It&&t.b===St?t.a:(D("expected object of type TrustedResourceUrl, got '"+t+"' of type "+h(t)),"type_error:TrustedResourceUrl")}function Et(t,e){var n=gt(t);if(!At.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(kt,function(t,i){if(!Object.prototype.hasOwnProperty.call(e,i))throw Error("Found marker, \""+i+"\", in format string, \""+n+"\", but no valid label mapping found in args: "+JSON.stringify(e));return(t=e[i])instanceof mt?gt(t):encodeURIComponent(String(t))}),new It(Nt,t)}It.prototype.ra=!0,It.prototype.qa=function(){return this.a.toString()},It.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var kt=/%{(\w+)}/g,At=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,St={},Nt={};function _t(t,e){this.a=t===Dt&&e||"",this.b=Ct}function Ot(t){return t instanceof _t&&t.constructor===_t&&t.b===Ct?t.a:(D("expected object of type SafeUrl, got '"+t+"' of type "+h(t)),"type_error:SafeUrl")}_t.prototype.ra=!0,_t.prototype.qa=function(){return this.a.toString()},_t.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Rt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Pt(t){return t instanceof _t?t:(t="object"==typeof t&&t.ra?t.qa():String(t),Rt.test(t)||(t="about:invalid#zClosurez"),new _t(Dt,t))}var Ct={},Dt={};function Lt(){this.a="",this.b=xt}function Mt(t){return t instanceof Lt&&t.constructor===Lt&&t.b===xt?t.a:(D("expected object of type SafeHtml, got '"+t+"' of type "+h(t)),"type_error:SafeHtml")}Lt.prototype.ra=!0,Lt.prototype.qa=function(){return this.a.toString()},Lt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var xt={};function Ft(t){var e=new Lt;return e.a=t,e}Ft("<!DOCTYPE html>");var jt=Ft("");function Ut(t,e){for(var n=t.split("%s"),i="",r=Array.prototype.slice.call(arguments,1);r.length&&1<n.length;)i+=n.shift()+r.shift();return i+n.join("%s")}function Vt(t){return rt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(Z,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Q,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(tt,"&gt;")),-1!=t.indexOf("\"")&&(t=t.replace(et,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(nt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(it,"&#0;"))),t}function $t(t){return $t[" "](t),t}Ft("<br>"),$t[" "]=c;var qt,Kt,Ht=ct("Opera"),Gt=ct("Trident")||ct("MSIE"),Bt=ct("Edge"),Wt=Bt||Gt,Xt=ct("Gecko")&&!(ot(Y.toLowerCase(),"webkit")&&!ct("Edge"))&&!(ct("Trident")||ct("MSIE"))&&!ct("Edge"),Jt=ot(Y.toLowerCase(),"webkit")&&!ct("Edge");function Yt(){var t=a.document;return t?t.documentMode:void 0}t:{var zt="",Zt=(Kt=Y,Xt?/rv:([^\);]+)(\)|;)/.exec(Kt):Bt?/Edge\/([\d\.]+)/.exec(Kt):Gt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Kt):Jt?/WebKit\/(\S+)/.exec(Kt):Ht?/(?:Version)[ \/]?(\S+)/.exec(Kt):void 0);if(Zt&&(zt=Zt?Zt[1]:""),Gt){var Qt=Yt();if(null!=Qt&&Qt>parseFloat(zt)){qt=String(Qt);break t}}qt=zt}var te,ee={};function ne(t){return function(t,e){var n=ee;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=z(String(qt)).split("."),i=z(String(t)).split("."),r=Math.max(n.length,i.length),o=0;0==e&&o<r;o++){var a=n[o]||"",s=i[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=at(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||at(0==a[2].length,0==s[2].length)||at(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}te=a.document&&Gt?Yt():void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Kt){}var ie=!Gt||9<=Number(te);function re(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function oe(t,e){ht(e,function(e,n){e&&"object"==typeof e&&e.ra&&(e=e.qa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ue.hasOwnProperty(n)?t.setAttribute(ue[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}var ae,se,ue={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ce(t,e,n){var i=arguments,r=document,o=String(i[0]),a=i[1];if(!ie&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(" name=\"",Vt(a.name),"\""),a.type){o.push(" type=\"",Vt(a.type),"\"");var s={};pt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=he(r,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):oe(o,a)),2<i.length&&function(t,e,n){function i(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var r=2;r<n.length;r++){var o=n[r];!l(o)||d(o)&&0<o.nodeType?i(o):$(le(o)?J(o):o,i)}}(r,o,i),o}function he(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function le(t){if(t&&"number"==typeof t.length){if(d(t))return"function"==typeof t.item||"string"==typeof t.item;if(f(t))return"function"==typeof t.item}return!1}function fe(t){a.setTimeout(function(){throw t},0)}function de(){var t=a.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ct("Presto")&&(t=function(){var t,e,n=he(document,"IFRAME");n.style.display="none",t=n,e=new It(Nt,gt(wt)),vt(t,"HTMLIFrameElement"),t.src=Tt(e).toString(),document.documentElement.appendChild(n);var i=n.contentWindow;(n=i.document).open(),n.write(Mt(jt)),n.close();var r="callImmediate"+Math.random(),o="file:"==i.location.protocol?"*":i.location.protocol+"//"+i.location.host;n=y(function(t){"*"!=o&&t.origin!=o||t.data!=r||this.port1.onmessage()},this),i.addEventListener("message",n,!1),this.port1={},this.port2={postMessage:function(){i.postMessage(r,o)}}}),void 0!==t&&!ct("Trident")&&!ct("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Db;n.Db=null,t()}},function(t){i.next={Db:t},i=i.next,e.port2.postMessage(0)}}return function(t){a.setTimeout(t,0)}}function pe(t,e){se||function(){if(a.Promise&&a.Promise.resolve){var t=a.Promise.resolve(void 0);se=function(){t.then(ge)}}else se=function(){var t=ge;!f(a.setImmediate)||a.Window&&a.Window.prototype&&!ct("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(ae||(ae=de()),ae(t)):a.setImmediate(t)}}(),ve||(se(),ve=!0),me.add(t,e)}var ve=!1,me=new x;function ge(){for(var t;t=j();){try{t.a.call(t.b)}catch(e){fe(e)}M(F,t)}ve=!1}function be(t,e){if(this.a=ye,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=c)try{var n=this;t.call(e,function(t){Pe(n,we,t)},function(t){if(!(t instanceof je))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}Pe(n,Ie,t)})}catch(i){Pe(this,Ie,i)}}var ye=0,we=2,Ie=3;function Te(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Te.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ee=new L(function(){return new Te},function(t){t.reset()});function ke(t,e,n){var i=Ee.get();return i.g=t,i.b=e,i.f=n,i}function Ae(t){if(t instanceof be)return t;var e=new be(c);return Pe(e,we,t),e}function Se(t){return new be(function(e,n){n(t)})}function Ne(t,e,n){Ce(t,e,n,null)||pe(w(e,t))}function _e(t){return new be(function(e){var n=t.length,i=[];if(n)for(var r=function(t,r,o){n--,i[t]=r?{Mb:!0,value:o}:{Mb:!1,reason:o},0==n&&e(i)},o=0;o<t.length;o++)Ne(t[o],w(r,o,!0),w(r,o,!1));else e(i)})}function Oe(t,e){t.b||t.a!=we&&t.a!=Ie||De(t),t.f?t.f.next=e:t.b=e,t.f=e}function Re(t,e,n,i){var r=ke(null,null,null);return r.a=new be(function(t,o){r.g=e?function(n){try{var r=e.call(i,n);t(r)}catch(a){o(a)}}:t,r.b=n?function(e){try{var r=n.call(i,e);void 0===r&&e instanceof je?o(e):t(r)}catch(a){o(a)}}:o}),r.a.c=t,Oe(t,r),r.a}function Pe(t,e,n){t.a==ye&&(t===n&&(e=Ie,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Ce(n,t.Yc,t.Zc,t)||(t.i=n,t.a=e,t.c=null,De(t),e!=Ie||n instanceof je||function(t,e){t.g=!0,pe(function(){t.g&&Fe.call(null,e)})}(t,n)))}function Ce(t,e,n,i){if(t instanceof be)return Oe(t,ke(e||c,n||null,i)),!0;if(R(t))return t.then(e,n,i),!0;if(d(t))try{var r=t.then;if(f(r))return function(t,e,n,i,r){function o(t){a||(a=!0,i.call(r,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(r,t))},o)}catch(s){o(s)}}(t,r,e,n,i),!0}catch(o){return n.call(i,o),!0}return!1}function De(t){t.h||(t.h=!0,pe(t.ec,t))}function Le(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Me(t,e,n,i){if(n==Ie&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,xe(e,n,i);else try{e.c?e.g.call(e.f):xe(e,n,i)}catch(r){Fe.call(null,r)}M(Ee,e)}function xe(t,e,n){e==we?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}be.prototype.then=function(t,e,n){return Re(this,f(t)?t:null,f(e)?e:null,n)},be.prototype.$goog_Thenable=!0,(t=be.prototype).ma=function(t,e){return(t=ke(t,t,e)).c=!0,Oe(this,t),this},t.o=function(t,e){return Re(this,null,t,e)},t.cancel=function(t){if(this.a==ye){var e=new je(t);pe(function(){!function t(e,n){if(e.a==ye)if(e.c){var i=e.c;if(i.b){for(var r=0,o=null,a=null,s=i.b;s&&(s.c||(r++,s.a==e&&(o=s),!(o&&1<r)));s=s.next)o||(a=s);o&&(i.a==ye&&1==r?t(i,n):(a?((r=a).next==i.f&&(i.f=r),r.next=r.next.next):Le(i),Me(i,o,Ie,n)))}e.c=null}else Pe(e,Ie,n)}(this,e)},this)}},t.Yc=function(t){this.a=ye,Pe(this,we,t)},t.Zc=function(t){this.a=ye,Pe(this,Ie,t)},t.ec=function(){for(var t;t=Le(this);)Me(this,t,this.a,this.i);this.h=!1};var Fe=fe;function je(t){P.call(this,t)}function Ue(){0!=Ve&&($e[p(this)]=this),this.wa=this.wa,this.na=this.na}T(je,P),je.prototype.name="cancel";var Ve=0,$e={};function qe(t){if(!t.wa&&(t.wa=!0,t.Ba(),0!=Ve)){var e=p(t);if(0!=Ve&&t.na&&0<t.na.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete $e[e]}}Ue.prototype.wa=!1,Ue.prototype.Ba=function(){if(this.na)for(;this.na.length;)this.na.shift()()};var Ke=Object.freeze||function(t){return t},He=!Gt||9<=Number(te),Ge=Gt&&!ne("9"),Be=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",c,e),a.removeEventListener("test",c,e)}catch(n){}return t}();function We(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Xe(t,e){if(We.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Xt){t:{try{$t(e.nodeName);var r=!0;break t}catch(o){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Je[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}We.prototype.preventDefault=function(){this.defaultPrevented=!0},T(Xe,We);var Je=Ke({2:"touch",3:"pen",4:"mouse"});Xe.prototype.preventDefault=function(){Xe.Za.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ge)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},Xe.prototype.f=function(){return this.a};var Ye="closure_listenable_"+(1e6*Math.random()|0),ze=0;function Ze(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.Ta=r,this.key=++ze,this.ua=this.Na=!1}function Qe(t){t.ua=!0,t.listener=null,t.proxy=null,t.src=null,t.Ta=null}function tn(t){this.src=t,this.a={},this.b=0}function en(t,e){var n=e.type;n in t.a&&B(t.a[n],e)&&(Qe(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function nn(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.ua&&o.listener==e&&o.capture==!!n&&o.Ta==i)return r}return-1}tn.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=nn(t,e,i,r);return-1<a?(e=t[a],n||(e.Na=!1)):((e=new Ze(e,this.src,o,!!i,r)).Na=n,t.push(e)),e};var rn="closure_lm_"+(1e6*Math.random()|0),on={};function an(t,e,n,i,r){if(i&&i.once)un(t,e,n,i,r);else if(Array.isArray(e))for(var o=0;o<e.length;o++)an(t,e[o],n,i,r);else n=gn(n),t&&t[Ye]?yn(t,e,n,d(i)?!!i.capture:!!i,r):sn(t,e,n,!1,i,r)}function sn(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var a=d(r)?!!r.capture:!!r,s=vn(t);if(s||(t[rn]=s=new tn(t)),!(n=s.add(e,n,i,a,o)).proxy){if(i=function(){var t=pn,e=He?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Be||(r=a),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(ln(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}0}}function un(t,e,n,i,r){if(Array.isArray(e))for(var o=0;o<e.length;o++)un(t,e[o],n,i,r);else n=gn(n),t&&t[Ye]?wn(t,e,n,d(i)?!!i.capture:!!i,r):sn(t,e,n,!0,i,r)}function cn(t,e,n,i,r){if(Array.isArray(e))for(var o=0;o<e.length;o++)cn(t,e[o],n,i,r);else i=d(i)?!!i.capture:!!i,n=gn(n),t&&t[Ye]?(t=t.u,(e=String(e).toString())in t.a&&-1<(n=nn(o=t.a[e],n,i,r))&&(Qe(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=vn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=nn(e,n,i,r)),(n=-1<t?e[t]:null)&&hn(n))}function hn(t){if("number"!=typeof t&&t&&!t.ua){var e=t.src;if(e&&e[Ye])en(e.u,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(ln(n),i):e.addListener&&e.removeListener&&e.removeListener(i),0,(n=vn(e))?(en(n,t),0==n.b&&(n.src=null,e[rn]=null)):Qe(t)}}}function ln(t){return t in on?on[t]:on[t]="on"+t}function fn(t,e,n,i){var r=!0;if((t=vn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ua&&(o=dn(o,i),r=r&&!1!==o)}return r}function dn(t,e){var n=t.listener,i=t.Ta||t.src;return t.Na&&hn(t),n.call(i,e)}function pn(t,e){if(t.ua)return!0;if(!He){if(!e)t:{e=["window","event"];for(var n=a,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}if(e=new Xe(i=e,this),n=!0,!(0>i.keyCode||null!=i.returnValue)){t:{var r=!1;if(0==i.keyCode)try{i.keyCode=-1;break t}catch(s){r=!0}(r||null==i.returnValue)&&(i.returnValue=!0)}for(i=[],r=e.b;r;r=r.parentNode)i.push(r);for(t=t.type,r=i.length-1;0<=r;r--){e.b=i[r];var o=fn(i[r],t,!0,e);n=n&&o}for(r=0;r<i.length;r++)e.b=i[r],o=fn(i[r],t,!1,e),n=n&&o}return n}return dn(t,new Xe(e,this))}function vn(t){return(t=t[rn])instanceof tn?t:null}var mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function gn(t){return f(t)?t:(t[mn]||(t[mn]=function(e){return t.handleEvent(e)}),t[mn])}function bn(){Ue.call(this),this.u=new tn(this),this.Yb=this,this.eb=null}function yn(t,e,n,i,r){t.u.add(String(e),n,!1,i,r)}function wn(t,e,n,i,r){t.u.add(String(e),n,!0,i,r)}function In(t,e,n,i){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ua&&a.capture==n){var s=a.listener,u=a.Ta||a.src;a.Na&&en(t.u,a),r=!1!==s.call(u,i)&&r}}return r&&!i.defaultPrevented}function Tn(t,e,n){if(f(t))n&&(t=y(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=y(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function En(t){var e=null;return new be(function(n,i){-1==(e=Tn(function(){n(void 0)},t))&&i(Error("Failed to schedule timer."))}).o(function(t){throw a.clearTimeout(e),t})}function kn(t){if(t.V&&"function"==typeof t.V)return t.V();if("string"==typeof t)return t.split("");if(l(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}function An(t){if(t.X&&"function"==typeof t.X)return t.X();if(!t.V||"function"!=typeof t.V){if(l(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var i in e=[],n=0,t)e[n++]=i;return e}}function Sn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Sn)for(n=t.X(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Nn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];_n(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)_n(r,i=t.a[e])||(t.a[n++]=i,r[i]=1),e++;t.a.length=n}}function _n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}T(bn,Ue),bn.prototype[Ye]=!0,bn.prototype.addEventListener=function(t,e,n,i){an(this,t,e,n,i)},bn.prototype.removeEventListener=function(t,e,n,i){cn(this,t,e,n,i)},bn.prototype.dispatchEvent=function(t){var e,n=this.eb;if(n)for(e=[];n;n=n.eb)e.push(n);n=this.Yb;var i=t.type||t;if("string"==typeof t)t=new We(t,n);else if(t instanceof We)t.target=t.target||n;else{var r=t;pt(t=new We(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];r=In(a,i,!0,t)&&r}if(r=In(a=t.b=n,i,!0,t)&&r,r=In(a,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=In(a=t.b=e[o],i,!1,t)&&r;return r},bn.prototype.Ba=function(){if(bn.Za.Ba.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)0,Qe(n[i]);delete e.a[t],e.b--}}this.eb=null},(t=Sn.prototype).V=function(){Nn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.X=function(){return Nn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return _n(this.b,t)?this.b[t]:e},t.set=function(t,e){_n(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.X(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var On=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/\\#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Rn(t,e){var n;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,t instanceof Rn?(this.h=void 0!==e?e:t.h,Pn(this,t.f),this.i=t.i,this.b=t.b,Cn(this,t.l),this.c=t.c,Dn(this,Zn(t.a)),this.g=t.g):t&&(n=String(t).match(On))?(this.h=!!e,Pn(this,n[1]||"",!0),this.i=jn(n[2]||""),this.b=jn(n[3]||"",!0),Cn(this,n[4]),this.c=jn(n[5]||"",!0),Dn(this,n[6]||"",!0),this.g=jn(n[7]||"")):(this.h=!!e,this.a=new Bn(null,this.h))}function Pn(t,e,n){t.f=n?jn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Cn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.l=e}else t.l=null}function Dn(t,e,n){e instanceof Bn?(t.a=e,function(t,e){e&&!t.f&&(Wn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Jn(this,e),zn(this,n,t))},t)),t.f=e}(t.a,t.h)):(n||(e=Un(e,Hn)),t.a=new Bn(e,t.h))}function Ln(t,e,n){t.a.set(e,n)}function Mn(t,e){return t.a.get(e)}function xn(t){return t instanceof Rn?new Rn(t):new Rn(t,void 0)}function Fn(t,e){var n=new Rn(null,void 0);return Pn(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function jn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Vn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Vn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Rn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Un(e,$n,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.i)&&t.push(Un(e,$n,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.l)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Un(n,"/"==n.charAt(0)?Kn:qn,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",Un(n,Gn)),t.join("")},Rn.prototype.resolve=function(t){var e=new Rn(this),n=!!t.f;n?Pn(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.l;var i=t.c;if(n)Cn(e,t.l);else if(n=!!t.c){if("/"!=i.charAt(0))if(this.b&&!this.c)i="/"+i;else{var r=e.c.lastIndexOf("/");-1!=r&&(i=e.c.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(ot(r,"./")||ot(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],a=0;a<r.length;){var s=r[a++];"."==s?i&&a==r.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==r.length&&o.push("")):(o.push(s),i=!0)}i=o.join("/")}else i=r}return n?e.c=i:n=""!==t.a.toString(),n?Dn(e,Zn(t.a)):n=!!t.g,n&&(e.g=t.g),e};var $n=/[#\/\?@]/g,qn=/[#\?:]/g,Kn=/[#\?]/g,Hn=/[#\?@]/g,Gn=/#/g;function Bn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Wn(t){t.a||(t.a=new Sn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Xn(t){var e=An(t);if(void 0===e)throw Error("Keys are undefined");var n=new Bn(null,void 0);t=kn(t);for(var i=0;i<e.length;i++){var r=e[i],o=t[i];Array.isArray(o)?zn(n,r,o):n.add(r,o)}return n}function Jn(t,e){Wn(t),e=Qn(t,e),_n(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,_n((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Nn(t)))}function Yn(t,e){return Wn(t),e=Qn(t,e),_n(t.a.b,e)}function zn(t,e,n){Jn(t,e),0<n.length&&(t.c=null,t.a.set(Qn(t,e),J(n)),t.b+=n.length)}function Zn(t){var e=new Bn;return e.c=t.c,t.a&&(e.a=new Sn(t.a),e.b=t.b),e}function Qn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function ti(t){var e=[];return function t(e,n,i){if(null==n)i.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var r=n;n=r.length,i.push("[");for(var o="",a=0;a<n;a++)i.push(o),t(e,r[a],i),o=",";return void i.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(r in i.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,r)&&"function"!=typeof(a=n[r])&&(i.push(o),ri(r,i),i.push(":"),t(e,a,i),o=",");return void i.push("}")}n=n.valueOf()}switch(typeof n){case"string":ri(n,i);break;case"number":i.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":i.push(String(n));break;case"function":i.push("null");break;default:throw Error("Unknown type: "+typeof n);}}}(new ei,t,e),e.join("")}function ei(){}(t=Bn.prototype).add=function(t,e){Wn(this),this.c=null,t=Qn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Wn(this),this.a.forEach(function(n,i){$(n,function(n){t.call(e,n,i,this)},this)},this)},t.X=function(){Wn(this);for(var t=this.a.V(),e=this.a.X(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},t.V=function(t){Wn(this);var e=[];if("string"==typeof t)Yn(this,t)&&(e=X(e,this.a.get(Qn(this,t))));else{t=this.a.V();for(var n=0;n<t.length;n++)e=X(e,t[n])}return e},t.set=function(t,e){return Wn(this),this.c=null,Yn(this,t=Qn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.X(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.V(i);for(var o=0;o<i.length;o++){var a=r;""!==i[o]&&(a+="="+encodeURIComponent(String(i[o]))),t.push(a)}}return this.c=t.join("&")};var ni={"\"":"\\\"","\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},ii=/\uffff/.test("\uFFFF")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function ri(t,e){e.push("\"",t.replace(ii,function(t){var e=ni[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ni[t]=e),e}),"\"")}function oi(){var t=ki();return Gt&&!!te&&11==te||/Edge\/\d+/.test(t)}function ai(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function si(t,e){e=e||a.window;var n="about:blank";t&&(n=Ot(Pt(t))),e.location.href=n}function ui(t){return!!((t=(t||ki()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ci(t){t=t||a.window;try{t.close()}catch(e){}}function hi(t,e,n){var i=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<r?r:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=ki().toLowerCase(),i&&(e.target=i,ot(n,"crios/")&&(e.target="_blank")),Ii(ki())==yi&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof _t?n:Pt(void 0!==n.href?n.href:String(n)),n=t.target||n.target,r=[],t)switch(a){case"width":case"height":case"top":case"left":r.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(a+"="+(t[a]?1:0));}var a=r.join(",");if((ct("iPhone")&&!ct("iPod")&&!ct("iPad")||ct("iPad")||ct("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(vt(a=he(document,"A"),"HTMLAnchorElement"),e instanceof _t||e instanceof _t||(e="object"==typeof e&&e.ra?e.qa():String(e),Rt.test(e)||(e="about:invalid#zClosurez"),e=new _t(Dt,e)),a.href=Ot(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,i,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=i.open("",n,a),t=Ot(e),a&&(Wt&&ot(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Ft("<meta name=\"referrer\" content=\"no-referrer\"><meta http-equiv=\"refresh\" content=\"0; url="+Vt(t)+"\">"),i=a.document)&&(i.write(Mt(t)),i.close())):(a=i.open(Ot(e),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var li=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fi=/^[^@]+@[^@]+$/;function di(){var t=null;return new be(function(e){"complete"==a.document.readyState?e():(t=function(){e()},un(window,"load",t))}).o(function(e){throw cn(window,"load",t),e})}function pi(t){return t=t||ki(),!("file:"!==Oi()&&"ionic:"!==Oi()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function vi(){var t=a.window;try{return!(!t||t==t.top)}catch(e){return!1}}function mi(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function gi(){return ib.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":ib.INTERNAL.hasOwnProperty("node")?"Node":mi()?"Worker":"Browser"}function bi(){var t=gi();return"ReactNative"===t||"Node"===t}var yi="Firefox",wi="Chrome";function Ii(t){var e=t.toLowerCase();return ot(e,"opera/")||ot(e,"opr/")||ot(e,"opios/")?"Opera":ot(e,"iemobile")?"IEMobile":ot(e,"msie")||ot(e,"trident/")?"IE":ot(e,"edge/")?"Edge":ot(e,"firefox/")?yi:ot(e,"silk/")?"Silk":ot(e,"blackberry")?"Blackberry":ot(e,"webos")?"Webos":!ot(e,"safari/")||ot(e,"chrome/")||ot(e,"crios/")||ot(e,"android")?!ot(e,"chrome/")&&!ot(e,"crios/")||ot(e,"edge/")?ot(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":wi:"Safari"}var Ti={jd:"FirebaseCore-web",ld:"FirebaseUI-web"};function Ei(t,e){e=e||[];var n,i=[],r={};for(n in Ti)r[Ti[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],i.push(e[n]));return i.sort(),(e=i).length||(e=["FirebaseCore-web"]),"Browser"===(i=gi())?i=Ii(r=ki()):"Worker"===i&&(i=Ii(r=ki())+"-"+i),i+"/JsCore/"+t+"/"+e.join(",")}function ki(){return a.navigator&&a.navigator.userAgent||""}function Ai(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Si(){try{var t=a.localStorage,e=Li();if(t)return t.setItem(e,"1"),t.removeItem(e),!oi()||!!a.indexedDB}catch(n){return mi()&&!!a.indexedDB}return!1}function Ni(){return(_i()||"chrome-extension:"===Oi()||pi())&&!bi()&&Si()&&!mi()}function _i(){return"http:"===Oi()||"https:"===Oi()}function Oi(){return a.location&&a.location.protocol||null}function Ri(t){return!ui(t=t||ki())&&Ii(t)!=yi}function Pi(t){return void 0===t?null:ti(t)}function Ci(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Di(t){if(null!==t)return JSON.parse(t)}function Li(t){return t||Math.floor(1e9*Math.random()).toString()}function Mi(t){return"Safari"!=Ii(t=t||ki())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function xi(){var t=a.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Fi(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=ki(),e=gi(),this.b=ui(t)||"ReactNative"===e}function ji(){var t=a.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Ui(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function Vi(){return!(!Ai("fireauth.oauthhelper",a)&&!Ai("fireauth.iframe",a))}Fi.prototype.get=function(){var t=a.navigator;return!t||"boolean"!=typeof t.onLine||!_i()&&"chrome-extension:"!==Oi()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var $i,qi={};function Ki(t){qi[t]||(qi[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Hi={};Object.defineProperty(Hi,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Hi,"abcd",{configurable:!0,enumerable:!0,value:2}),$i=2==Hi.abcd}catch(Kt){$i=!1}function Gi(t,e,n){$i?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Bi(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Gi(t,n,e[n])}function Wi(t){var e={};return Bi(e,t),e}function Xi(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Gi(e,n,Xi(t[n]));return e}function Ji(t){var e=t&&(t[tr]?"phone":null);if(!(e&&t&&t[Qi]))throw new E("internal-error","Internal assert: invalid MultiFactorInfo object");Gi(this,"uid",t[Qi]),Gi(this,"displayName",t[zi]||null);var n=null;t[Zi]&&(n=new Date(t[Zi]).toUTCString()),Gi(this,"enrollmentTime",n),Gi(this,"factorId",e)}function Yi(t){try{var e=new er(t)}catch(n){e=null}return e}Ji.prototype.v=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var zi="displayName",Zi="enrolledAt",Qi="mfaEnrollmentId",tr="phoneInfo";function er(t){Ji.call(this,t),Gi(this,"phoneNumber",t[tr])}function nr(t){var e={},n=t[ar],i=t[ur],r=t[cr];if(t=Yi(t[sr]),!r||r!=rr&&r!=or&&!n||r==or&&!i||r==ir&&!t)throw Error("Invalid checkActionCode response!");r==or?(e[lr]=n||null,e[dr]=n||null,e[hr]=i):(e[lr]=i||null,e[dr]=i||null,e[hr]=n||null),e[fr]=t||null,Gi(this,vr,r),Gi(this,pr,Xi(e))}T(er,Ji),er.prototype.v=function(){var t=er.Za.v.call(this);return t.phoneNumber=this.phoneNumber,t};var ir="REVERT_SECOND_FACTOR_ADDITION",rr="EMAIL_SIGNIN",or="VERIFY_AND_CHANGE_EMAIL",ar="email",sr="mfaInfo",ur="newEmail",cr="requestType",hr="email",lr="fromEmail",fr="multiFactorInfo",dr="previousEmail",pr="data",vr="operation";function mr(t){var e=Mn(t=xn(t),gr)||null,n=Mn(t,br)||null,i=Mn(t,Ir)||null;if(i=i&&Er[i]||null,!e||!n||!i)throw new E("argument-error",gr+", "+br+"and "+Ir+" are required in a valid action code URL.");Bi(this,{apiKey:e,operation:i,code:n,continueUrl:Mn(t,yr)||null,languageCode:Mn(t,wr)||null,tenantId:Mn(t,Tr)||null})}var gr="apiKey",br="oobCode",yr="continueUrl",wr="languageCode",Ir="mode",Tr="tenantId",Er={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:ir,signIn:rr,verifyAndChangeEmail:or,verifyEmail:"VERIFY_EMAIL"};function kr(t){try{return new mr(t)}catch(e){return null}}function Ar(t){var e=t[Rr];if(void 0===e)throw new E("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new E("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Sr];if(n&&"object"==typeof n){e=n[Dr];var i=n[Pr];if(n=n[Cr],"string"==typeof e&&e.length){if(this.a=e,void 0!==i&&"boolean"!=typeof i)throw new E("argument-error",Pr+" property must be a boolean when specified.");if(this.g=!!i,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new E("argument-error",Cr+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new E("argument-error",Dr+" property must be a non empty string when specified.");if(void 0!==i||void 0!==n)throw new E("missing-android-pkg-name")}}else if(void 0!==n)throw new E("argument-error",Sr+" property must be a non null object when specified.");if(this.f=null,(e=t[Or])&&"object"==typeof e){if("string"==typeof(e=e[Lr])&&e.length)this.f=e;else if(void 0!==e)throw new E("argument-error",Lr+" property must be a non empty string when specified.")}else if(void 0!==e)throw new E("argument-error",Or+" property must be a non null object when specified.");if(void 0!==(e=t[_r])&&"boolean"!=typeof e)throw new E("argument-error",_r+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Nr])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new E("argument-error",Nr+" property must be a non empty string when specified.");this.i=t||null}var Sr="android",Nr="dynamicLinkDomain",_r="handleCodeInApp",Or="iOS",Rr="url",Pr="installApp",Cr="minimumVersion",Dr="packageName",Lr="bundleId";function Mr(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var xr=null;function Fr(t){var e="";return function(t,e){function n(e){for(;i<t.length;){var n=t.charAt(i++),r=xr[n];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!xr){xr={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var i=t.concat(e[n].split("")),r=0;r<i.length;r++){var o=i[r];void 0===xr[o]&&(xr[o]=r)}}}();for(var i=0;;){var r=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===r)break;e(r<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}function jr(t){var e=Vr(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.g=t,this.c=e.exp,this.h=e.sub,I(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function Ur(t){try{return new jr(t)}catch(e){return null}}function Vr(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Fr(t))}catch(i){}return null}jr.prototype.S=function(){return this.f},jr.prototype.i=function(){return this.b},jr.prototype.toString=function(){return this.g};var $r="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),qr=["client_id","response_type","scope","redirect_uri","state"],Kr={kd:{Ha:"locale",ta:700,sa:600,ea:"facebook.com",Va:qr},md:{Ha:null,ta:500,sa:750,ea:"github.com",Va:qr},nd:{Ha:"hl",ta:515,sa:680,ea:"google.com",Va:qr},td:{Ha:"lang",ta:485,sa:705,ea:"twitter.com",Va:$r},gd:{Ha:"locale",ta:640,sa:600,ea:"apple.com",Va:[]}};function Hr(t){for(var e in Kr)if(Kr[e].ea==t)return Kr[e];return null}function Gr(t){var e={};e["facebook.com"]=Yr,e["google.com"]=Zr,e["github.com"]=zr,e["twitter.com"]=Qr;var n=t&&t[Wr];try{if(n)return e[n]?new e[n](t):new Jr(t);if(void 0!==t[Br])return new Xr(t)}catch(i){}return null}var Br="idToken",Wr="providerId";function Xr(t){var e=t[Wr];if(!e&&t[Br]){var n=Ur(t[Br]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Gi(this,"providerId",e),Gi(this,"isNewUser",n)}function Jr(t){Xr.call(this,t),Gi(this,"profile",Xi((t=Di(t.rawUserInfo||"{}"))||{}))}function Yr(t){if(Jr.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function zr(t){if(Jr.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Gi(this,"username",this.profile&&this.profile.login||null)}function Zr(t){if(Jr.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Qr(t){if(Jr.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Gi(this,"username",t.screenName||null)}function to(t){var e=xn(t),n=Mn(e,"link"),i=Mn(xn(n),"link");return e=Mn(e,"deep_link_id"),Mn(xn(e),"link")||e||i||n||t}function eo(t,e){if(!t&&!e)throw new E("internal-error","Internal assert: no raw session string available");if(t&&e)throw new E("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?no:io}T(Jr,Xr),T(Yr,Jr),T(zr,Jr),T(Zr,Jr),T(Qr,Jr);var no="enroll",io="signin";function ro(){}function oo(t,e){return t.then(function(t){if(t[Wa]){var n=Ur(t[Wa]);if(!n||e!=n.h)throw new E("user-mismatch");return t}throw new E("user-mismatch")}).o(function(t){throw t&&t.code&&t.code==S+"user-not-found"?new E("user-mismatch"):t})}function ao(t,e){if(!e)throw new E("internal-error","failed to construct a credential");this.a=e,Gi(this,"providerId",t),Gi(this,"signInMethod",t)}function so(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function uo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new ao(t.providerId,t.pendingToken)}catch(e){}return null}function co(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Gi(this,"idToken",e.idToken),e.accessToken&&Gi(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Gi(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new E("internal-error","failed to construct a credential");Gi(this,"accessToken",e.oauthToken),Gi(this,"secret",e.oauthTokenSecret)}Gi(this,"providerId",t),Gi(this,"signInMethod",n)}function ho(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Xn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function lo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new co(t.providerId,e,t.signInMethod)}catch(n){}}return null}function fo(t,e){this.Oc=e||[],Bi(this,{providerId:t,isOAuthProvider:!0}),this.Fb={},this.lb=(Hr(t)||{}).Ha||null,this.kb=null}function po(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new E("argument-error","SAML provider IDs must be prefixed with \"saml.\"");fo.call(this,t,[])}function vo(t){fo.call(this,t,qr),this.a=[]}function mo(){vo.call(this,"facebook.com")}function go(t){if(!t)throw new E("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),new mo().credential({accessToken:e})}function bo(){vo.call(this,"github.com")}function yo(t){if(!t)throw new E("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),new bo().credential({accessToken:e})}function wo(){vo.call(this,"google.com"),this.Aa("profile")}function Io(t,e){var n=t;return d(t)&&(n=t.idToken,e=t.accessToken),new wo().credential({idToken:n,accessToken:e})}function To(){fo.call(this,"twitter.com",$r)}function Eo(t,e){var n=t;if(d(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new E("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new co("twitter.com",n,"twitter.com")}function ko(t,e,n){this.a=t,this.f=e,Gi(this,"providerId","password"),Gi(this,"signInMethod",n===So.EMAIL_LINK_SIGN_IN_METHOD?So.EMAIL_LINK_SIGN_IN_METHOD:So.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Ao(t){return t&&t.email&&t.password?new ko(t.email,t.password,t.signInMethod):null}function So(){Bi(this,{providerId:"password",isOAuthProvider:!1})}function No(t,e){if(!(e=_o(e)))throw new E("argument-error","Invalid email link!");return new ko(t,e.code,So.EMAIL_LINK_SIGN_IN_METHOD)}function _o(t){return(t=kr(t=to(t)))&&t.operation===rr?t:null}function Oo(t){if(!(t.bb&&t.ab||t.Ja&&t.da))throw new E("internal-error");this.a=t,Gi(this,"providerId","phone"),this.ea="phone",Gi(this,"signInMethod","phone")}function Ro(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return $(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){t[n]&&(e[n]=t[n])}),new Oo(e)}return null}function Po(t){return t.a.Ja&&t.a.da?{temporaryProof:t.a.Ja,phoneNumber:t.a.da}:{sessionInfo:t.a.bb,code:t.a.ab}}function Co(t){try{this.a=t||ib.auth()}catch(e){throw new E("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Bi(this,{providerId:"phone",isOAuthProvider:!1})}function Do(t,e){if(!t)throw new E("missing-verification-id");if(!e)throw new E("missing-verification-code");return new Oo({bb:t,ab:e})}function Lo(t){if(t.temporaryProof&&t.phoneNumber)return new Oo({Ja:t.temporaryProof,da:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,i=t&&t.oauthTokenSecret,r=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Io(o,n);case"facebook.com":return go(n);case"github.com":return yo(n);case"twitter.com":return Eo(n,i);default:return n||i||o||a?a?0==e.indexOf("saml.")?new ao(e,a):new co(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new vo(e).credential({idToken:o,accessToken:n,rawNonce:r}):null;}}catch(s){return null}}function Mo(t){if(!t.isOAuthProvider)throw new E("invalid-oauth-provider")}function xo(t,e,n,i,r,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=i||null,this.i=o||null,this.h=a||null,this.a=r||null,!this.g&&!this.a)throw new E("invalid-auth-event");if(this.g&&this.a)throw new E("invalid-auth-event");if(this.g&&!this.f)throw new E("invalid-auth-event")}function Fo(t){return(t=t||{}).type?new xo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&k(t.error),t.postBody,t.tenantId):null}function jo(){this.b=null,this.a=[]}eo.prototype.Fa=function(){return this.a?Ae(this.a):Ae(this.b)},eo.prototype.v=function(){return this.type==no?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},ro.prototype.ia=function(){},ro.prototype.b=function(){},ro.prototype.c=function(){},ro.prototype.v=function(){},ao.prototype.ia=function(t){return ds(t,so(this))},ao.prototype.b=function(t,e){var n=so(this);return n.idToken=e,ps(t,n)},ao.prototype.c=function(t,e){return oo(vs(t,so(this)),e)},ao.prototype.v=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},co.prototype.ia=function(t){return ds(t,ho(this))},co.prototype.b=function(t,e){var n=ho(this);return n.idToken=e,ps(t,n)},co.prototype.c=function(t,e){return oo(vs(t,ho(this)),e)},co.prototype.v=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},fo.prototype.Ia=function(t){return this.Fb=ft(t),this},T(po,fo),T(vo,fo),vo.prototype.Aa=function(t){return G(this.a,t)||this.a.push(t),this},vo.prototype.Nb=function(){return J(this.a)},vo.prototype.credential=function(t,e){var n;if(!(n=d(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new E("argument-error","credential failed: must provide the ID token and/or the access token.");return new co(this.providerId,n,this.providerId)},T(mo,vo),Gi(mo,"PROVIDER_ID","facebook.com"),Gi(mo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),T(bo,vo),Gi(bo,"PROVIDER_ID","github.com"),Gi(bo,"GITHUB_SIGN_IN_METHOD","github.com"),T(wo,vo),Gi(wo,"PROVIDER_ID","google.com"),Gi(wo,"GOOGLE_SIGN_IN_METHOD","google.com"),T(To,fo),Gi(To,"PROVIDER_ID","twitter.com"),Gi(To,"TWITTER_SIGN_IN_METHOD","twitter.com"),ko.prototype.ia=function(t){return this.signInMethod==So.EMAIL_LINK_SIGN_IN_METHOD?Ys(t,Es,{email:this.a,oobCode:this.f}):Ys(t,Gs,{email:this.a,password:this.f})},ko.prototype.b=function(t,e){return this.signInMethod==So.EMAIL_LINK_SIGN_IN_METHOD?Ys(t,ks,{idToken:e,email:this.a,oobCode:this.f}):Ys(t,Fs,{idToken:e,email:this.a,password:this.f})},ko.prototype.c=function(t,e){return oo(this.ia(t),e)},ko.prototype.v=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Bi(So,{PROVIDER_ID:"password"}),Bi(So,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Bi(So,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Oo.prototype.ia=function(t){return t.cb(Po(this))},Oo.prototype.b=function(t,e){var n=Po(this);return n.idToken=e,Ys(t,Ws,n)},Oo.prototype.c=function(t,e){var n=Po(this);return n.operation="REAUTH",oo(t=Ys(t,Xs,n),e)},Oo.prototype.v=function(){var t={providerId:"phone"};return this.a.bb&&(t.verificationId=this.a.bb),this.a.ab&&(t.verificationCode=this.a.ab),this.a.Ja&&(t.temporaryProof=this.a.Ja),this.a.da&&(t.phoneNumber=this.a.da),t},Co.prototype.cb=function(t,e){var n=this.a.b;return Ae(e.verify()).then(function(i){if("string"!=typeof i)throw new E("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var r=d(t)?t.session:null,o=d(t)?t.phoneNumber:t;return(r&&r.type==no?r.Fa().then(function(t){return Ys(n,Us,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:i}}).then(function(t){return t.phoneSessionInfo.sessionInfo})}):r&&r.type==io?r.Fa().then(function(e){return function(t,e){return Ys(t,Vs,e).then(function(t){return t.phoneResponseInfo.sessionInfo})}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:i}})}):function(t,e){return Ys(t,Ms,e)}(n,{phoneNumber:o,recaptchaToken:i})).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new E("argument-error","Only firebase.auth.ApplicationVerifiers with type=\"recaptcha\" are currently supported.");}})},Bi(Co,{PROVIDER_ID:"phone"}),Bi(Co,{PHONE_SIGN_IN_METHOD:"phone"}),xo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},xo.prototype.S=function(){return this.h},xo.prototype.v=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.v()}};var Uo,Vo=null;function $o(t){var e="unauthorized-domain",n=void 0,i=xn(t);t=i.b,"chrome-extension"==(i=i.f)?n=Ut("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==i||"https"==i?n=Ut("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",E.call(this,e,n)}function qo(t,e,n){E.call(this,t,n),(t=e||{}).Gb&&Gi(this,"email",t.Gb),t.da&&Gi(this,"phoneNumber",t.da),t.credential&&Gi(this,"credential",t.credential),t.Wb&&Gi(this,"tenantId",t.Wb)}function Ko(t){if(t.code){var e=t.code||"";0==e.indexOf(S)&&(e=e.substring(S.length));var n={credential:Lo(t),Wb:t.tenantId};if(t.email)n.Gb=t.email;else if(t.phoneNumber)n.da=t.phoneNumber;else if(!n.credential)return new E(e,t.message||void 0);return new qo(e,n,t.message)}return null}function Ho(){}function Go(t){return t.c||(t.c=t.b())}function Bo(){}function Wo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var i=e[n];try{return new ActiveXObject(i),t.f=i}catch(r){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Xo(){}function Jo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=y(this.oc,this),this.a.onerror=y(this.Pb,this),this.a.onprogress=y(this.pc,this),this.a.ontimeout=y(this.tc,this)}function Yo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function zo(t,e,n){this.reset(t,e,n,void 0,void 0)}T($o,E),T(qo,E),qo.prototype.v=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.v();return e&&pt(t,e),t},qo.prototype.toJSON=function(){return this.v()},Ho.prototype.c=null,T(Bo,Ho),Bo.prototype.a=function(){var t=Wo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Bo.prototype.b=function(){var t={};return Wo(this)&&(t[0]=!0,t[1]=!0),t},Uo=new Bo,T(Xo,Ho),Xo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Jo;throw Error("Unsupported browser")},Xo.prototype.b=function(){return{}},(t=Jo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.oc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Yo(this,4)},t.Pb=function(){this.status=500,this.response=this.responseText="",Yo(this,4)},t.tc=function(){this.Pb()},t.pc=function(){this.status=200,Yo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},zo.prototype.a=null;function Zo(t){this.f=t,this.b=this.c=this.a=null}function Qo(t,e){this.name=t,this.value=e}zo.prototype.reset=function(t,e,n,i,r){"number"==typeof r||0,i||I(),delete this.a},Qo.prototype.toString=function(){return this.name};var ta=new Qo("SEVERE",1e3),ea=new Qo("WARNING",900),na=new Qo("CONFIG",700),ia=new Qo("FINE",500);Zo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(D("Root logger has no level set."),null)}(this).value)for(f(e)&&(e=e()),t=new zo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var ra={},oa=null;function aa(t){var e;if(oa||(oa=new Zo(""),ra[""]=oa,oa.c=na),!(e=ra[t])){e=new Zo(t);var n=t.lastIndexOf("."),i=t.substr(n+1);(n=aa(t.substr(0,n))).b||(n.b={}),n.b[i]=e,e.a=n,ra[t]=e}return e}function sa(t,e){t&&t.log(ia,e,void 0)}function ua(t){this.f=t}function ca(t){bn.call(this),this.s=t,this.readyState=ha,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=aa("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}T(ua,Ho),ua.prototype.a=function(){return new ca(this.f)},ua.prototype.b=function(t){return function(){return t}}({}),T(ca,bn);var ha=0;function la(t){t.c.read().then(t.nc.bind(t)).catch(t.Sa.bind(t))}function fa(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,da(t)}function da(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function pa(t){bn.call(this),this.headers=new Sn,this.D=t||null,this.c=!1,this.B=this.a=null,this.h=this.P=this.l="",this.f=this.O=this.i=this.N=!1,this.g=0,this.s=null,this.m=va,this.w=this.R=!1}(t=ca.prototype).open=function(t,e){if(this.readyState!=ha)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,da(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.s.fetch(new Request(this.g,e)).then(this.sc.bind(this),this.Sa.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,fa(this,!1)),this.readyState=ha},t.sc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,da(this)),this.a&&(this.readyState=3,da(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.qc.bind(this),this.Sa.bind(this)):void 0!==a.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,la(this)):t.text().then(this.rc.bind(this),this.Sa.bind(this)))))},t.nc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?fa(this,!0):da(this),3==this.readyState&&la(this)}},t.rc=function(t){this.a&&(this.response=this.responseText=t,fa(this,!0))},t.qc=function(t){this.a&&(this.response=t,fa(this,!0))},t.Sa=function(t){var e=this.h;e&&e.log(ea,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&fa(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(ea,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(ea,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},T(pa,bn);var va="";pa.prototype.b=aa("goog.net.XhrIo");var ma=/^https?$/i,ga=["POST","PUT"];function ba(t,e,n,i,r){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.N=!1,t.c=!0,t.a=t.D?t.D.a():Uo.a(),t.B=t.D?Go(t.D):Go(Uo),t.a.onreadystatechange=y(t.Sb,t);try{sa(t.b,Na(t,"Opening Xhr")),t.O=!0,t.a.open(n,String(e),!0),t.O=!1}catch(s){return sa(t.b,Na(t,"Error opening Xhr: "+s.message)),void wa(t,s)}e=i||"";var o=new Sn(t.headers);r&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(l(t)||"string"==typeof t)$(t,e,void 0);else for(var n=An(t),i=kn(t),r=i.length,o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=ya,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.X()),i=a.FormData&&e instanceof a.FormData,!G(ga,n)||r||i||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.R&&(t.a.withCredentials=t.R);try{ka(t),0<t.g&&(t.w=function(t){return Gt&&ne(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),sa(t.b,Na(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.w)),t.w?(t.a.timeout=t.g,t.a.ontimeout=y(t.Ka,t)):t.s=Tn(t.Ka,t.g,t)),sa(t.b,Na(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(s){sa(t.b,Na(t,"Send error: "+s.message)),wa(t,s)}}function ya(t){return"content-type"==t.toLowerCase()}function wa(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Ia(t),Ea(t)}function Ia(t){t.N||(t.N=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Ta(t){if(t.c&&void 0!==o)if(t.B[1]&&4==Aa(t)&&2==Sa(t))sa(t.b,Na(t,"Local request error detected and ignored"));else if(t.i&&4==Aa(t))Tn(t.Sb,0,t);else if(t.dispatchEvent("readystatechange"),4==Aa(t)){sa(t.b,Na(t,"Request complete")),t.c=!1;try{var e,n=Sa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1;}if(!(e=i)){var r;if(r=0===n){var s=String(t.l).match(On)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}r=!ma.test(s?s.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Aa(t)?t.a.statusText:""}catch(h){sa(t.b,"Can not get status: "+h.message),c=""}t.h=c+" ["+Sa(t)+"]",Ia(t)}}finally{Ea(t)}}}function Ea(t,e){if(t.a){ka(t);var n=t.a,i=t.B[0]?c:null;t.a=null,t.B=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(r){(t=t.b)&&t.log(ta,"Problem encountered resetting onreadystatechange: "+r.message,void 0)}}}function ka(t){t.a&&t.w&&(t.a.ontimeout=null),t.s&&(a.clearTimeout(t.s),t.s=null)}function Aa(t){return t.a?t.a.readyState:0}function Sa(t){try{return 2<Aa(t)?t.a.status:-1}catch(e){return-1}}function Na(t,e){return e+" ["+t.P+" "+t.l+" "+Sa(t)+"]"}function _a(t){var e=Ua;this.g=[],this.w=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.u=this.B=this.i=!1,this.h=0,this.b=null,this.l=0}function Oa(t,e,n){t.a=!0,t.c=n,t.f=!e,Da(t)}function Ra(t){if(t.a){if(!t.u)throw new La(t);t.u=!1}}function Pa(t,e,n,i){t.g.push([e,n,i]),t.a&&Da(t)}function Ca(t){return H(t.g,function(t){return f(t[1])})}function Da(t){if(t.h&&t.a&&Ca(t)){var e=t.h,n=Fa[e];n&&(a.clearTimeout(n.a),delete Fa[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var i=n=!1;t.g.length&&!t.i;){var r=t.g.shift(),o=r[0],s=r[1];if(r=r[2],o=t.f?s:o)try{var u=o.call(r||t.s,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(R(e)||"function"==typeof a.Promise&&e instanceof a.Promise)&&(i=!0,t.i=!0)}catch(c){e=c,t.f=!0,Ca(t)||(n=!0)}}t.c=e,i&&(u=y(t.m,t,!0),i=y(t.m,t,!1),e instanceof _a?(Pa(e,u,i),e.B=!0):e.then(u,i)),n&&(e=new xa(e),Fa[e.a]=e,t.h=e.a)}function La(){P.call(this)}function Ma(){P.call(this)}function xa(t){this.a=a.setTimeout(y(this.c,this),0),this.b=t}(t=pa.prototype).Ka=function(){void 0!==o&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",sa(this.b,Na(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(sa(this.b,Na(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ea(this))},t.Ba=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Ea(this,!0)),pa.Za.Ba.call(this)},t.Sb=function(){this.wa||(this.O||this.i||this.f?Ta(this):this.Hc())},t.Hc=function(){Ta(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case va:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer;}var t=this.b;return t&&t.log(ta,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return sa(this.b,"Can not get response: "+e.message),null}},_a.prototype.cancel=function(t){if(this.a)this.c instanceof _a&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.w?this.w.call(this.s,this):this.u=!0,this.a||(t=new Ma(this),Ra(this),Oa(this,!1,t))}},_a.prototype.m=function(t,e){this.i=!1,Oa(this,t,e)},_a.prototype.then=function(t,e,n){var i,r,o=new be(function(t,e){i=t,r=e});return Pa(this,i,function(t){t instanceof Ma?o.cancel():r(t)}),o.then(t,e,n)},_a.prototype.$goog_Thenable=!0,T(La,P),La.prototype.message="Deferred has already fired",La.prototype.name="AlreadyCalledError",T(Ma,P),Ma.prototype.message="Deferred was canceled",Ma.prototype.name="CanceledError",xa.prototype.c=function(){throw delete Fa[this.a],this.b};var Fa={};function ja(t){var e={},n=e.document||document,i=Tt(t).toString(),r=he(document,"SCRIPT"),o={Tb:r,Ka:void 0},c=new _a(o),h=null,l=null!=e.timeout?e.timeout:5e3;return 0<l&&(h=window.setTimeout(function(){Va(r,!0);var t=new Ka(qa,"Timeout reached for loading script "+i);Ra(c),Oa(c,!1,t)},l),o.Ka=h),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(Va(r,e.ud||!1,h),Ra(c),Oa(c,!0,null))},r.onerror=function(){Va(r,!0,h);var t=new Ka($a,"Error while loading script "+i);Ra(c),Oa(c,!1,t)},pt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),oe(r,o),function(t,e){vt(t,"HTMLScriptElement"),t.src=Tt(e),null===u&&(u=(e=(e=a.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&s.test(e)?e:""),(e=u)&&t.setAttribute("nonce",e)}(r,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(r),c}function Ua(){if(this&&this.Tb){var t=this.Tb;t&&"SCRIPT"==t.tagName&&Va(t,!0,this.Ka)}}function Va(t,e,n){null!=n&&a.clearTimeout(n),t.onload=c,t.onerror=c,t.onreadystatechange=c,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var $a=0,qa=1;function Ka(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),P.call(this,n),this.code=t}function Ha(t){this.f=t}function Ga(t,e,n){if(this.c=t,t=e||{},this.u=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||Xa,this.g=ft(t.secureTokenHeaders||Ja),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.l=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.i=t.firebaseTimeout||Ya,this.a=ft(t.firebaseHeaders||za),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==gi(),!(n=a.XMLHttpRequest||n&&ib.INTERNAL.node&&ib.INTERNAL.node.XMLHttpRequest)&&!mi())throw new E("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,mi()?this.f=new ua(self):bi()?this.f=new Ha(n):this.f=new Xo,this.b=null}T(Ka,P),T(Ha,Ho),Ha.prototype.a=function(){return new this.f},Ha.prototype.b=function(){return{}};var Ba,Wa="idToken",Xa=new Fi(3e4,6e4),Ja={"Content-Type":"application/x-www-form-urlencoded"},Ya=new Fi(3e4,6e4),za={"Content-Type":"application/json"};function Za(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Qa(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function ts(t,e,n,i,r,o,s){(function(){var t=ki();return!((t=Ii(t)!=wi?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Gt&&te&&!(9<te))})()||mi()?t=y(t.w,t):(Ba||(Ba=new be(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{a[ns]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=Et(es,{onload:ns});!function(t,e){Pa(t,null,e,void 0)}(ja(n),function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)})),t=y(t.s,t)),t(e,n,i,r,o,s)}Ga.prototype.S=function(){return this.b},Ga.prototype.w=function(t,e,n,i,r,o){if(mi()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new E("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new pa(this.f);if(o){s.g=Math.max(0,o);var u=setTimeout(function(){s.dispatchEvent("timeout")},o)}yn(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return sa(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)}),wn(s,"ready",function(){u&&clearTimeout(u),qe(this)}),wn(s,"timeout",function(){u&&clearTimeout(u),qe(this),e&&e(null)}),ba(s,t,n,i,r)};var es=new mt(yt,"https://apis.google.com/js/client.js?onload=%{onload}"),ns="__fcb"+Math.floor(1e6*Math.random()).toString();function is(t,e,n,i,r,o,a){var s=xn(e+n);Ln(s,"key",t.c),a&&Ln(s,"cb",I().toString());var u="GET"==i;if(u)for(var c in r)r.hasOwnProperty(c)&&Ln(s,c,r[c]);return new be(function(e,n){ts(t,s.toString(),function(t){t?t.error?n(Zs(t,o||{})):e(t):n(new E("network-request-failed"))},i,u?void 0:ti(Ci(r)),t.a,t.i.get())})}function rs(t){if("string"!=typeof(t=t.email)||!fi.test(t))throw new E("invalid-email")}function os(t){"email"in t&&rs(t)}function as(t){if(!t[Wa]){if(t.mfaPendingCredential)throw new E("multi-factor-auth-required",null,ft(t));throw new E("internal-error")}}function ss(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new E("internal-error")}else{if(!t.sessionInfo)throw new E("missing-verification-id");if(!t.code)throw new E("missing-verification-code")}}Ga.prototype.s=function(t,e,n,i,r){var o=this;Ba.then(function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:i,headers:r,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).o(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},Ga.prototype.vb=function(){return Ys(this,js,{})},Ga.prototype.xb=function(t,e){return Ys(this,xs,{idToken:t,email:e})},Ga.prototype.yb=function(t,e){return Ys(this,Fs,{idToken:t,password:e})};var us={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function cs(t){if(!t.phoneVerificationInfo)throw new E("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new E("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new E("missing-verification-code")}function hs(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new E("internal-error")}function ls(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&Yn(t=new Bn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function fs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Ko(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Ko(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Ko(t)):t.errorMessage&&(e=zs(t.errorMessage)),e)throw e;as(t)}function ds(t,e){return e.returnIdpCredential=!0,Ys(t,$s,e)}function ps(t,e){return e.returnIdpCredential=!0,Ys(t,Ks,e)}function vs(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Ys(t,qs,e)}function ms(t){if(!t.oobCode)throw new E("invalid-action-code")}(t=Ga.prototype).zb=function(t,e){var n={idToken:t},i=[];return ht(us,function(t,r){var o=e[r];null===o?i.push(t):r in e&&(n[r]=o)}),i.length&&(n.deleteAttribute=i),Ys(this,xs,n)},t.rb=function(t,e){return pt(t={requestType:"PASSWORD_RESET",email:t},e),Ys(this,Ps,t)},t.sb=function(t,e){return pt(t={requestType:"EMAIL_SIGNIN",email:t},e),Ys(this,_s,t)},t.qb=function(t,e){return pt(t={requestType:"VERIFY_EMAIL",idToken:t},e),Ys(this,Os,t)},t.Ab=function(t,e,n){return pt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),Ys(this,Rs,t)},t.cb=function(t){return Ys(this,Bs,t)},t.jb=function(t,e){return Ys(this,Ls,{oobCode:t,newPassword:e})},t.Pa=function(t){return Ys(this,bs,{oobCode:t})},t.fb=function(t){return Ys(this,gs,{oobCode:t})};var gs={endpoint:"setAccountInfo",A:ms,Y:"email",C:!0},bs={endpoint:"resetPassword",A:ms,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new E("internal-error")},C:!0},ys={endpoint:"signupNewUser",A:function(t){if(rs(t),!t.password)throw new E("weak-password")},G:as,U:!0,C:!0},ws={endpoint:"createAuthUri",C:!0},Is={endpoint:"deleteAccount",M:["idToken"]},Ts={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],A:function(t){if("array"!=h(t.deleteProvider))throw new E("internal-error")}},Es={endpoint:"emailLinkSignin",M:["email","oobCode"],A:rs,G:as,U:!0,C:!0},ks={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],A:rs,G:as,U:!0},As={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],A:cs,G:as,C:!0,La:!0},Ss={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],A:cs,G:as,C:!0,La:!0},Ns={endpoint:"getAccountInfo"},_s={endpoint:"getOobConfirmationCode",M:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new E("internal-error");rs(t)},Y:"email",C:!0},Os={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new E("internal-error")},Y:"email",C:!0},Rs={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new E("internal-error")},Y:"email",C:!0},Ps={endpoint:"getOobConfirmationCode",M:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new E("internal-error");rs(t)},Y:"email",C:!0},Cs={hb:!0,endpoint:"getProjectConfig",Rb:"GET"},Ds={hb:!0,endpoint:"getRecaptchaParam",Rb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new E("internal-error")}},Ls={endpoint:"resetPassword",A:ms,Y:"email",C:!0},Ms={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Y:"sessionInfo",C:!0},xs={endpoint:"setAccountInfo",M:["idToken"],A:os,U:!0},Fs={endpoint:"setAccountInfo",M:["idToken"],A:function(t){if(os(t),!t.password)throw new E("weak-password")},G:as,U:!0},js={endpoint:"signupNewUser",G:as,U:!0,C:!0},Us={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new E("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new E("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new E("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new E("internal-error")},C:!0,La:!0},Vs={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new E("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new E("internal-error")},C:!0,La:!0},$s={endpoint:"verifyAssertion",A:hs,Wa:ls,G:fs,U:!0,C:!0},qs={endpoint:"verifyAssertion",A:hs,Wa:ls,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new E("user-not-found");if(t.errorMessage)throw zs(t.errorMessage);as(t)},U:!0,C:!0},Ks={endpoint:"verifyAssertion",A:function(t){if(hs(t),!t.idToken)throw new E("internal-error")},Wa:ls,G:fs,U:!0},Hs={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new E("invalid-custom-token")},G:as,U:!0,C:!0},Gs={endpoint:"verifyPassword",A:function(t){if(rs(t),!t.password)throw new E("wrong-password")},G:as,U:!0,C:!0},Bs={endpoint:"verifyPhoneNumber",A:ss,G:as,C:!0},Ws={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new E("internal-error");ss(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Ko(t);as(t)}},Xs={Eb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ss,G:as,C:!0},Js={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[Wa]^!!t.refreshToken)throw new E("internal-error")},C:!0,La:!0};function Ys(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var i=t[e[n]];if(null==i||""===i)return!1}return!0}(n,e.M))return Se(new E("internal-error"));var i,r=!!e.La,o=e.Rb||"POST";return Ae(n).then(e.A).then(function(){return e.U&&(n.returnSecureToken=!0),e.C&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),is(t,r?t.l:t.h,e.endpoint,o,n,e.Eb,e.hb||!1)}).then(function(t){return i=t,e.Wa?e.Wa(n,i):i}).then(e.G).then(function(){if(!e.Y)return i;if(!(e.Y in i))throw new E("internal-error");return i[e.Y]})}function zs(t){return Zs({error:{errors:[{message:t}],code:400,message:t}})}function Zs(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=i[n]?new E(i[n]):null)return n;for(var r in n=t.error&&t.error.message||"",pt(i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,i)if(0===n.indexOf(r))return new E(i[r],e);return!e&&t&&(e=Pi(t)),new E("internal-error",e)}function Qs(t){this.b=t,this.a=null,this.nb=function(t){return(iu||(iu=new be(function(t,e){function n(){xi(),Ai("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){xi(),e(Error("Network Error"))},timeout:eu.get()})}if(Ai("gapi.iframes.Iframe"))t();else if(Ai("gapi.load"))n();else{var i="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[i]=function(){Ai("gapi.load")?n():e(Error("Network Error"))},Ae(ja(i=Et(tu,{onload:i}))).o(function(){e(Error("Network Error"))})}}).o(function(t){throw iu=null,t}))).then(function(){return new be(function(e,n){Ai("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Ai("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(i){function r(){clearTimeout(o),e()}t.a=i,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},nu.get());i.ping(r).then(r,function(){n(Error("Network Error"))})})})})}(this)}var tu=new mt(yt,"https://apis.google.com/js/api.js?onload=%{onload}"),eu=new Fi(3e4,6e4),nu=new Fi(5e3,15e3),iu=null;function ru(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Fn(this.i,"/__/auth/iframe"),Ln(this.a,"apiKey",this.g),Ln(this.a,"appName",this.h),this.b=null,this.c=[]}function ou(t,e,n,i,r){this.s=t,this.m=e,this.c=n,this.u=i,this.i=this.g=this.l=null,this.a=r,this.h=this.f=null}function au(t){try{return ib.app(t).auth().Ea()}catch(e){return[]}}function su(t,e,n,i,r){this.u=t,this.f=e,this.b=n,this.c=i||null,this.h=r||null,this.m=this.s=this.w=null,this.g=[],this.l=this.a=null}function uu(t){var e=ai();return function(t){return Ys(t,Cs,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=xn(e),i=n.f;n=n.b;for(var r=0;r<t.length;r++){var o=t[r],a=n,s=i;if(0==o.indexOf("chrome-extension://")?a=xn(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:li.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new $o(ai())})}function cu(t){return t.l?t.l:(t.l=di().then(function(){if(!t.s){var e=t.c,n=t.h,i=au(t.b),r=new ru(t.u,t.f,t.b);r.f=e,r.b=n,r.c=J(i||[]),t.s=r.toString()}t.i=new Qs(t.s),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.nb.then(function(){t.a.register("authEvent",e,Ai("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.i,function(e){var n={};if(e&&e.authEvent){var i=!1;for(e=Fo(e.authEvent),n=0;n<t.g.length;n++)i=t.g[n](e)||i;return(n={}).status=i?"ACK":"ERROR",Ae(n)}return n.status="ERROR",Ae(n)})}(t)}),t.l)}function hu(t){return t.m||(t.w=t.c?Ei(t.c,au(t.b)):null,t.m=new Ga(t.f,O(t.h),t.w)),t.m}function lu(t,e,n,i,r,o,a,s,u,c,h){return(t=new ou(t,e,n,i,r)).l=o,t.g=a,t.i=s,t.b=ft(u||null),t.f=c,t.ub(h).toString()}function fu(t){if(this.a=t||ib.INTERNAL.reactNative&&ib.INTERNAL.reactNative.AsyncStorage,!this.a)throw new E("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function du(t){this.b=t,this.a={},this.f=y(this.c,this)}ru.prototype.toString=function(){return this.f?Ln(this.a,"v",this.f):Jn(this.a.a,"v"),this.b?Ln(this.a,"eid",this.b):Jn(this.a.a,"eid"),this.c.length?Ln(this.a,"fw",this.c.join(",")):Jn(this.a.a,"fw"),this.a.toString()},ou.prototype.ub=function(t){return this.h=t,this},ou.prototype.toString=function(){var t=Fn(this.s,"/__/auth/handler");if(Ln(t,"apiKey",this.m),Ln(t,"appName",this.c),Ln(t,"authType",this.u),this.a.isOAuthProvider){var e=this.a;try{var n=ib.app(this.c).auth().ja()}catch(s){n=null}for(var i in e.kb=n,Ln(t,"providerId",this.a.providerId),n=Ci((e=this.a).Fb))n[i]=n[i].toString();i=e.Oc,n=ft(n);for(var r=0;r<i.length;r++){var o=i[r];o in n&&delete n[o]}e.lb&&e.kb&&!n[e.lb]&&(n[e.lb]=e.kb),lt(n)||Ln(t,"customParameters",Pi(n))}if("function"==typeof this.a.Nb&&(e=this.a.Nb()).length&&Ln(t,"scopes",e.join(",")),this.l?Ln(t,"redirectUrl",this.l):Jn(t.a,"redirectUrl"),this.g?Ln(t,"eventId",this.g):Jn(t.a,"eventId"),this.i?Ln(t,"v",this.i):Jn(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Mn(t,a)&&Ln(t,a,this.b[a]);return this.h?Ln(t,"tid",this.h):Jn(t.a,"tid"),this.f?Ln(t,"eid",this.f):Jn(t.a,"eid"),(a=au(this.c)).length&&Ln(t,"fw",a.join(",")),t.toString()},(t=su.prototype).Lb=function(t,e,n){var i=new E("popup-closed-by-user"),r=new E("web-storage-unsupported"),o=this,a=!1;return this.ka().then(function(){(function(t){var e={type:"webStorageSupport"};return cu(t).then(function(){return function(t,e){return t.nb.then(function(){return new be(function(n){t.a.send(e.type,e,n,Ai("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(t&&ci(t),e(r),a=!0)})}).o(function(){}).then(function(){if(!a)return function(t){return new be(function(e){return function n(){En(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!a)return En(n).then(function(){e(i)})})},t.Ub=function(){var t=ki();return!Ri(t)&&!Mi(t)},t.Qb=function(){return!1},t.Jb=function(t,e,n,i,r,o,a,s){if(!t)return Se(new E("popup-blocked"));if(a&&!Ri())return this.ka().o(function(e){ci(t),r(e)}),i(),Ae();this.a||(this.a=uu(hu(this)));var u=this;return this.a.then(function(){var e=u.ka().o(function(e){throw ci(t),r(e),e});return i(),e}).then(function(){(Mo(n),a)||si(lu(u.u,u.f,u.b,e,n,null,o,u.c,void 0,u.h,s),t)}).o(function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t})},t.Kb=function(t,e,n,i){this.a||(this.a=uu(hu(this)));var r=this;return this.a.then(function(){Mo(e),si(lu(r.u,r.f,r.b,t,e,ai(),n,r.c,void 0,r.h,i))}).o(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},t.ka=function(){var t=this;return cu(this).then(function(){return t.i.nb}).o(function(){throw t.a=null,new E("network-request-failed")})},t.Xb=function(){return!0},t.Ca=function(t){this.g.push(t)},t.Qa=function(t){W(this.g,function(e){return e==t})},(t=fu.prototype).get=function(t){return Ae(this.a.getItem(t)).then(function(t){return t&&Di(t)})},t.set=function(t,e){return Ae(this.a.setItem(t,Pi(e)))},t.T=function(t){return Ae(this.a.removeItem(t))},t.ba=function(){},t.ha=function(){};var pu,vu=[];function mu(t,e,n){lt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function gu(t){this.a=t}function bu(t){this.c=t,this.b=!1,this.a=[]}function yu(t,e,n,i){var r,o,a,s,u=n||{},c=null;if(t.b)return Se(Error("connection_unavailable"));var h=i?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new be(function(n,i){l?(r=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout(function(){i(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===r&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){i(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):i(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),i(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:r,data:u},[l.port2])):i(Error("connection_unavailable"))}).then(function(e){return wu(t,c),e}).o(function(e){throw wu(t,c),e})}function wu(t,e){if(e){var n=e.messageChannel,i=e.onMessage;n&&(n.port1.removeEventListener("message",i),n.port1.close()),W(t.a,function(t){return t==e})}}function Iu(){if(!ku())throw new E("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=a.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.s=!1,this.h=null;var t=this;mi()&&self?(this.l=function(){var t=mi()?self:null;if($(vu,function(n){n.b==t&&(e=n)}),!e){var e=new du(t);vu.push(e)}return e}(),mu(this.l,"keyChanged",function(e,n){return Ou(t).then(function(e){return 0<e.length&&$(t.a,function(t){t(e)}),{keyProcessed:G(e,n.key)}})}),mu(this.l,"ping",function(){return Ae(["keyChanged"])})):function(){var t=a.navigator;return t&&t.serviceWorker?Ae().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).o(function(){return null}):Ae(null)}().then(function(e){(t.h=e)&&(t.g=new bu(new gu(e)),yu(t.g,"ping",null,!0).then(function(e){e[0].fulfilled&&G(e[0].value,"keyChanged")&&(t.s=!0)}).o(function(){}))})}function Tu(t){return new be(function(e,n){var i=t.u.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(i):function(t){return new be(function(e,n){var i=t.u.deleteDatabase("firebaseLocalStorageDb");i.onsuccess=function(){e()},i.onerror=function(t){n(Error(t.target.error))}})}(t).then(function(){return Tu(t)}).then(function(t){e(t)}).o(function(t){n(t)})}})}function Eu(t){return t.m||(t.m=Tu(t)),t.m}function ku(){try{return!!a.indexedDB}catch(Kt){return!1}}function Au(t){return t.objectStore("firebaseLocalStorage")}function Su(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Nu(t){return new be(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function _u(t,e){return t.g&&t.h&&function(){var t=a.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?yu(t.g,"keyChanged",{key:e},t.s).then(function(){}).o(function(){}):Ae()}function Ou(t){return Eu(t).then(function(t){var e=Au(Su(t,!1));return e.getAll?Nu(e.getAll()):new be(function(t,n){var i=[],r=e.openCursor();r.onsuccess=function(e){(e=e.target.result)?(i.push(e.value),e.continue()):t(i)},r.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},i=[];if(0==t.b){for(i=0;i<e.length;i++)n[e[i].fbase_key]=e[i].value;i=function t(e,n){var i,r=[];for(i in e)i in n?typeof e[i]!=typeof n[i]?r.push(i):"object"==typeof e[i]&&null!=e[i]&&null!=n[i]?0<t(e[i],n[i]).length&&r.push(i):e[i]!==n[i]&&r.push(i):r.push(i);for(i in n)i in e||r.push(i);return r}(t.c,n),t.c=n}return i})}function Ru(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Pu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ae().then(function(){if(ku()){var t=Li(),i="__sak"+t;return pu||(pu=new Iu),(n=pu).set(i,t).then(function(){return n.get(i)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.T(i)}).then(function(){return n}).o(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.ba(function(t){$(e.a,function(e){e(t)})}),t})}function Cu(){this.a={},this.type="inMemory"}function Du(){if(!function(){var t="Node"==gi();if(!(t=Lu()||t&&ib.INTERNAL.node&&ib.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==gi())throw new E("internal-error","The LocalStorage compatibility library was not found.");throw new E("web-storage-unsupported")}this.a=Lu()||ib.INTERNAL.node.localStorage,this.type="localStorage"}function Lu(){try{var t=a.localStorage,e=Li();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Mu(){this.type="nullStorage"}function xu(){if(!function(){var t="Node"==gi();if(!(t=Fu()||t&&ib.INTERNAL.node&&ib.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==gi())throw new E("internal-error","The SessionStorage compatibility library was not found.");throw new E("web-storage-unsupported")}this.a=Fu()||ib.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Fu(){try{var t=a.sessionStorage,e=Li();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function ju(){var t={};t.Browser=$u,t.Node=qu,t.ReactNative=Ku,t.Worker=Hu,this.a=t[gi()]}du.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,i=this.a[e];if(i&&0<i.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var r=[];$(i,function(e){r.push(Ae().then(function(){return e(t.origin,t.data.data)}))}),_e(r).then(function(i){var r=[];$(i,function(t){r.push({fulfilled:t.Mb,value:t.value,reason:t.reason?t.reason.message:void 0})}),$(r,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:r})})}},gu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},bu.prototype.close=function(){for(;0<this.a.length;)wu(this,this.a[0]);this.b=!0},(t=Iu.prototype).set=function(t,e){var n,i=!1,r=this;return Eu(this).then(function(e){return Nu((e=Au(Su(n=e,!0))).get(t))}).then(function(o){var a=Au(Su(n,!0));return o?(o.value=e,Nu(a.put(o))):(r.b++,i=!0,(o={}).fbase_key=t,o.value=e,Nu(a.add(o)))}).then(function(){return r.c[t]=e,_u(r,t)}).ma(function(){i&&r.b--})},t.get=function(t){return Eu(this).then(function(e){return Nu(Au(Su(e,!1)).get(t))}).then(function(t){return t&&t.value})},t.T=function(t){var e=!1,n=this;return Eu(this).then(function(i){return e=!0,n.b++,Nu(Au(Su(i,!0)).delete(t))}).then(function(){return delete n.c[t],_u(n,t)}).ma(function(){e&&n.b--})},t.ba=function(t){0==this.a.length&&function(t){Ru(t),function e(){t.f=setTimeout(function(){t.i=Ou(t).then(function(e){0<e.length&&$(t.a,function(t){t(e)})}).then(function(){e()}).o(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()}(this),this.a.push(t)},t.ha=function(t){W(this.a,function(e){return e==t}),0==this.a.length&&Ru(this)},(t=Pu.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},t.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},t.T=function(t){return this.b.then(function(e){return e.T(t)})},t.ba=function(t){this.a.push(t)},t.ha=function(t){W(this.a,function(e){return e==t})},(t=Cu.prototype).get=function(t){return Ae(this.a[t])},t.set=function(t,e){return this.a[t]=e,Ae()},t.T=function(t){return delete this.a[t],Ae()},t.ba=function(){},t.ha=function(){},(t=Du.prototype).get=function(t){var e=this;return Ae().then(function(){return Di(e.a.getItem(t))})},t.set=function(t,e){var n=this;return Ae().then(function(){var i=Pi(e);null===i?n.T(t):n.a.setItem(t,i)})},t.T=function(t){var e=this;return Ae().then(function(){e.a.removeItem(t)})},t.ba=function(t){a.window&&an(a.window,"storage",t)},t.ha=function(t){a.window&&cn(a.window,"storage",t)},(t=Mu.prototype).get=function(){return Ae(null)},t.set=function(){return Ae()},t.T=function(){return Ae()},t.ba=function(){},t.ha=function(){},(t=xu.prototype).get=function(t){var e=this;return Ae().then(function(){return Di(e.a.getItem(t))})},t.set=function(t,e){var n=this;return Ae().then(function(){var i=Pi(e);null===i?n.T(t):n.a.setItem(t,i)})},t.T=function(t){var e=this;return Ae().then(function(){e.a.removeItem(t)})},t.ba=function(){},t.ha=function(){};var Uu,Vu,$u={F:Du,$a:xu},qu={F:Du,$a:xu},Ku={F:fu,$a:Mu},Hu={F:Du,$a:Mu},Gu={od:"local",NONE:"none",qd:"session"};function Bu(){var t=!(Mi(ki())||!vi()),e=Ri(),n=Si();this.m=t,this.h=e,this.l=n,this.a={},Uu||(Uu=new ju),t=Uu;try{this.g=!oi()&&Vi()||!a.indexedDB?new t.a.F:new Pu(mi()?new Cu:new t.a.F)}catch(i){this.g=new Cu,this.h=!0}try{this.i=new t.a.$a}catch(i){this.i=new Cu}this.u=new Cu,this.f=y(this.Vb,this),this.b={}}function Wu(){return Vu||(Vu=new Bu),Vu}function Xu(t,e){switch(e){case"session":return t.i;case"none":return t.u;default:return t.g;}}function Ju(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Yu(t,e,n){return n=Ju(e,n),"local"==e.F&&(t.b[n]=null),Xu(t,e.F).T(n)}function zu(t){t.c&&(clearInterval(t.c),t.c=null)}function Zu(t){this.a=t,this.b=Wu()}(t=Bu.prototype).get=function(t,e){return Xu(this,t.F).get(Ju(t,e))},t.set=function(t,e,n){var i=Ju(t,n),r=this,o=Xu(this,t.F);return o.set(i,e).then(function(){return o.get(i)}).then(function(e){"local"==t.F&&(r.b[i]=e)})},t.addListener=function(t,e,n){t=Ju(t,e),this.l&&(this.b[t]=a.localStorage.getItem(t)),lt(this.a)&&(Xu(this,"local").ba(this.f),this.h||(oi()||!Vi())&&a.indexedDB||!this.l||function(t){zu(t),t.c=setInterval(function(){for(var e in t.a){var n=a.localStorage.getItem(e),i=t.b[e];n!=i&&(t.b[e]=n,n=new Xe({type:"storage",key:e,target:window,oldValue:i,newValue:n,a:!0}),t.Vb(n))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=Ju(t,e),this.a[t]&&(W(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),lt(this.a)&&(Xu(this,"local").ha(this.f),zu(this))},t.Vb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var i=this.b[n];void 0===i&&(i=null);var r=a.localStorage.getItem(n);r!==i&&(this.b[n]=r,this.ib(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Xu(this,"local").ha(this.f):zu(this),this.m)if(n=a.localStorage.getItem(e),(i=t.a.newValue)!==n)null!==i?a.localStorage.setItem(e,i):a.localStorage.removeItem(e);else if(this.b[e]===i&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===a.localStorage.getItem(e)||(o.b[e]=a.localStorage.getItem(e),o.ib(e))},Gt&&te&&10==te&&a.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else $(t,y(this.ib,this))},t.ib=function(t){this.a[t]&&$(this.a[t],function(t){t()})};var Qu,tc={name:"authEvent",F:"local"};function ec(){this.a=Wu()}function nc(t,e){this.b=ic,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=a.Int32Array?new Int32Array(64):Array(64),void 0===Qu&&(Qu=a.Int32Array?new Int32Array(hc):hc),this.reset()}T(nc,function(){this.b=-1});for(var ic=64,rc=ic-1,oc=[],ac=0;ac<rc;ac++)oc[ac]=0;var sc=X(128,oc);function uc(t){for(var e=t.f,n=t.l,i=0,r=0;r<e.length;)n[i++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*i;for(e=16;64>e;e++){r=0|n[e-15],i=0|n[e-2];var o=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,a=(0|n[e-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;n[e]=o+a|0}i=0|t.a[0],r=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&s^r&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|Qu[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=r,r=i,i=a+f|0}t.a[0]=t.a[0]+i|0,t.a[1]=t.a[1]+r|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function cc(t,e,n){void 0===n&&(n=e.length);var i=0,r=t.c;if("string"==typeof e)for(;i<n;)t.f[r++]=e.charCodeAt(i++),r==t.b&&(uc(t),r=0);else{if(!l(e))throw Error("message must be string or array");for(;i<n;){var o=e[i++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[r++]=o,r==t.b&&(uc(t),r=0)}}t.c=r,t.g+=n}nc.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):J(this.h)};var hc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function lc(){nc.call(this,8,fc)}T(lc,nc);var fc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function dc(t,e,n,i,r){this.u=t,this.i=e,this.l=n,this.m=i||null,this.s=r||null,this.h=e+":"+n,this.w=new ec,this.g=new Zu(this.h),this.f=null,this.b=[],this.a=this.c=null}function pc(t){return new E("invalid-cordova-configuration",t)}function vc(t){var e=new lc;cc(e,t),t=[];var n=8*e.g;56>e.c?cc(e,sc,56-e.c):cc(e,sc,e.b-(e.c-56));for(var i=63;56<=i;i--)e.f[i]=255&n,n/=256;for(uc(e),i=n=0;i<e.i;i++)for(var r=24;0<=r;r-=8)t[n++]=e.a[i]>>r&255;return function(t){return K(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function mc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(i){}}function gc(t){return t.f||(t.f=t.ka().then(function(){return new be(function(e){t.Ca(function n(i){return e(i),t.Qa(n),!1}),function(t){function e(e){i=!0,r&&r.cancel(),bc(t).then(function(i){var r=n;if(i&&e&&e.url){var o=null;-1!=(r=to(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Di(Mn(o=xn(r),"firebaseError")||null))?k(o):null)?new xo(i.c,i.b,null,null,o,null,i.S()):new xo(i.c,i.b,r,i.f,null,null,i.S())),r=o||n}mc(t,r)})}var n=new xo("unknown",null,null,null,new E("no-auth-event")),i=!1,r=En(500).then(function(){return bc(t).then(function(){i||mc(t,n)})}),o=a.handleOpenURL;a.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Ai("BuildInfo.packageName",a).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(n){console.error(n)}},Vo||(Vo=new jo),function(t){var e=Vo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Ai("universalLinks.subscribe",a))&&t(null,e.b))}(e)}(t)})})),t.f}function bc(t){var e=null;return function(t){return t.b.get(tc,t.a).then(function(t){return Fo(t)})}(t.g).then(function(n){return e=n,Yu((n=t.g).b,tc,n.a)}).then(function(){return e})}function yc(t){this.a=t,this.b=Wu()}(t=dc.prototype).ka=function(){return this.Ga?this.Ga:this.Ga=(pi(void 0)?di().then(function(){return new be(function(t,e){var n=a.document,i=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(i),t()},!1)})}):Se(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof Ai("universalLinks.subscribe",a))throw pc("cordova-universal-links-plugin-fix is not installed");if(void 0===Ai("BuildInfo.packageName",a))throw pc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Ai("cordova.plugins.browsertab.openUrl",a))throw pc("cordova-plugin-browsertab is not installed");if("function"!=typeof Ai("cordova.InAppBrowser.open",a))throw pc("cordova-plugin-inappbrowser is not installed")},function(){throw new E("cordova-not-ready")})},t.Lb=function(t,e){return e(new E("operation-not-supported-in-this-environment")),Ae()},t.Jb=function(){return Se(new E("operation-not-supported-in-this-environment"))},t.Xb=function(){return!1},t.Ub=function(){return!0},t.Qb=function(){return!0},t.Kb=function(t,e,n,i){if(this.c)return Se(new E("redirect-operation-pending"));var r=this,o=a.document,s=null,u=null,c=null,h=null;return this.c=Ae().then(function(){return Mo(e),gc(r)}).then(function(){return function(t,e,n,i,r){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new xo(e,i,null,o,new E("no-auth-event"),null,r),u=Ai("BuildInfo.packageName",a);if("string"!=typeof u)throw new E("invalid-cordova-configuration");var c=Ai("BuildInfo.displayName",a),h={};if(ki().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=u;else{if(!ki().toLowerCase().match(/android/))return Se(new E("operation-not-supported-in-this-environment"));h.apn=u}c&&(h.appDisplayName=c),o=vc(o),h.sessionId=o;var l=lu(t.u,t.i,t.l,e,n,null,i,t.m,h,t.s,r);return t.ka().then(function(){var e=t.h;return t.w.a.set(tc,s.v(),e)}).then(function(){var e=Ai("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof e)throw new E("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=Ai("cordova.plugins.browsertab.openUrl",a)))throw new E("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=Ai("cordova.InAppBrowser.open",a)))throw new E("invalid-cordova-configuration");e=ki(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(r,t,e,n,i)}).then(function(){return new be(function(t,e){u=function(){var e=Ai("cordova.plugins.browsertab.close",a);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.Ca(u),c=function(){s||(s=En(2e3).then(function(){e(new E("redirect-cancelled-by-user"))}))},h=function(){ji()&&c()},o.addEventListener("resume",c,!1),ki().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)}).o(function(t){return bc(r).then(function(){throw t})})}).ma(function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),s&&s.cancel(),u&&r.Qa(u),r.c=null})},t.Ca=function(t){this.b.push(t),gc(this).o(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new xo("unknown",null,null,null,new E("no-auth-event")),t(e))})},t.Qa=function(t){W(this.b,function(e){return e==t})};var wc={name:"pendingRedirect",F:"session"};function Ic(t){return Yu(t.b,wc,t.a)}function Tc(t,e,n){this.i={},this.w=0,this.D=t,this.u=e,this.m=n,this.h=[],this.f=!1,this.l=y(this.s,this),this.b=new xc,this.B=new $c,this.g=new yc(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.B,this.c.linkViaPopup=this.B,this.c.reauthViaPopup=this.B,this.a=Ec(this.D,this.u,this.m,A)}function Ec(t,e,n,i){var r=ib.SDK_VERSION||null;return pi()?new dc(t,e,n,r,i):new su(t,e,n,r,i)}function kc(t){t.f||(t.f=!0,t.a.Ca(t.l));var e=t.a;return t.a.ka().o(function(n){throw t.a==e&&t.reset(),n})}function Ac(t){t.a.Ub()&&kc(t).o(function(e){var n=new xo("unknown",null,null,null,new E("operation-not-supported-in-this-environment"));Pc(e)&&t.s(n)}),t.a.Qb()||Fc(t.b)}function Sc(t,e){G(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(wc,t.a).then(function(t){return"pending"==t})}(t.g).then(function(e){e?Ic(t.g).then(function(){kc(t).o(function(e){var n=new xo("unknown",null,null,null,new E("operation-not-supported-in-this-environment"));Pc(e)&&t.s(n)})}):Ac(t)}).o(function(){Ac(t)})}function Nc(t,e){W(t.h,function(t){return t==e})}Tc.prototype.reset=function(){this.f=!1,this.a.Qa(this.l),this.a=Ec(this.D,this.u,this.m),this.i={}},Tc.prototype.s=function(t){if(!t)throw new E("invalid-auth-event");if(6e5<=I()-this.w&&(this.i={},this.w=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var i=this.h[n];if(i.Cb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,i),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.w=I())),e=!0;break}}return Fc(this.b),e};var _c=new Fi(2e3,1e4),Oc=new Fi(3e4,6e4);function Rc(t,e,n,i,r,o,a){return t.a.Jb(e,n,i,function(){t.f||(t.f=!0,t.a.Ca(t.l))},function(){t.reset()},r,o,a)}function Pc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Cc(t,e,n,i,r){var o;return function(t){return t.b.set(wc,"pending",t.a)}(t.g).then(function(){return t.a.Kb(e,n,i,r).o(function(e){if(Pc(e))throw new E("operation-not-supported-in-this-environment");return o=e,Ic(t.g).then(function(){throw o})}).then(function(){return t.a.Xb()?new be(function(){}):Ic(t.g).then(function(){return t.pa()}).then(function(){}).o(function(){})})})}function Dc(t,e,n,i,r){return t.a.Lb(i,function(t){e.la(n,null,t,r)},_c.get())}Tc.prototype.pa=function(){return this.b.pa()};var Lc={};function Mc(t,e,n){var i=e+":"+n;return Lc[i]||(Lc[i]=new Tc(t,e,n)),Lc[i]}function xc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Fc(t){t.g||(t.g=!0,Vc(t,!1,null,null))}function jc(t){t.g&&!t.i&&Vc(t,!1,null,null)}function Uc(t,e){if(t.b=function(){return Ae(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Vc(t,e,n,i){e?i?function(t,e){if(t.b=function(){return Se(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,i):Uc(t,n):Uc(t,{user:null}),t.f=[],t.c=[]}function $c(){}function qc(){this.Bb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.Bb},set:function(t){this.Bb=t},enumerable:!1})}function Kc(t,e){this.a=e,Gi(this,"verificationId",t)}function Hc(t,e,n,i){return new Co(t).cb(e,n).then(function(t){return new Kc(t,i)})}function Gc(t){var e=Vr(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new E("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Bi(this,{token:t,expirationTime:Ui(1e3*e.exp),authTime:Ui(1e3*e.auth_time),issuedAtTime:Ui(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function Bc(t,e,n){var i=e&&e[Xc];if(!i)throw new E("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=ft(e),this.g=n,this.c=new eo(null,i),this.b=[];var r=this;$(e[Wc]||[],function(t){(t=Yi(t))&&r.b.push(t)}),Gi(this,"auth",this.a),Gi(this,"session",this.c),Gi(this,"hints",this.b)}xc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},xc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,i=t.b,r=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!r&&!o),"unknown"!=n||r||o?t.a?(Vc(this,!0,null,t.a),Ae()):e.Da(n,i)?function(t,e,n){n=n.Da(e.c,e.b);var i=e.g,r=e.f,o=e.i,a=e.S(),s=!!e.c.match(/Redirect$/);n(i,r,a,o).then(function(e){Vc(t,s,e,null)}).o(function(e){Vc(t,s,null,e)})}(this,t,e):Se(new E("invalid-auth-event")):(Vc(this,!1,null,null),Ae())}else Se(new E("invalid-auth-event"))},xc.prototype.pa=function(){var t=this;return new be(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new E("timeout");t.a&&t.a.cancel(),t.a=En(Oc.get()).then(function(){t.b||(t.g=!0,Vc(t,!0,null,e))})}(t))})},$c.prototype.h=function(t,e){if(t){var n=t.c,i=t.b;t.a?(e.la(t.c,null,t.a,t.b),Ae()):e.Da(n,i)?function(t,e){var n=t.b,i=t.c;e.Da(i,n)(t.g,t.f,t.S(),t.i).then(function(t){e.la(i,t,null,n)}).o(function(t){e.la(i,null,t,n)})}(t,e):Se(new E("invalid-auth-event"))}else Se(new E("invalid-auth-event"))},Kc.prototype.confirm=function(t){return t=Do(this.verificationId,t),this.a(t)};var Wc="mfaInfo",Xc="mfaPendingCredential";function Jc(t,e,n,i){E.call(this,"multi-factor-auth-required",i,e),this.b=new Bc(t,e,n),Gi(this,"resolver",this.b)}function Yc(t,e,n){if(t&&d(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new Jc(e,t.serverResponse,n,t.message)}catch(i){}return null}function zc(){}function Zc(t){Gi(this,"factorId",t.ea),this.a=t}function Qc(t){if(Zc.call(this,t),this.a.ea!=Co.PROVIDER_ID)throw new E("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function th(t,e){for(var n in We.call(this,t),e)this[n]=e[n]}function eh(t,e){this.a=t,this.b=[],this.c=y(this.wc,this),an(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&$(e.multiFactor.enrolledFactors,function(t){var e=null,i={};if(t){t.uid&&(i[Qi]=t.uid),t.displayName&&(i[zi]=t.displayName),t.enrollmentTime&&(i[Zi]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(i[tr]=t.phoneNumber);try{e=new er(i)}catch(r){}t=e}else t=null;t&&n.push(t)}),nh(this,n)}function nh(t,e){t.b=e,Gi(t,"enrolledFactors",e)}function ih(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function rh(t){this.c=t,this.b=this.a=null}function oh(t){return t.b&&1e3*t.b.c||0}function ah(t,e){var n=e.refreshToken;t.b=Ur(e[Wa]||""),t.a=n}function sh(t,e){return function(t,e){return new be(function(n,i){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?ts(t,t.u+"?key="+encodeURIComponent(t.c),function(t){t?t.error?i(Zs(t)):t.access_token&&t.refresh_token?n(t):i(new E("internal-error")):i(new E("network-request-failed"))},"POST",Xn(e).toString(),t.g,t.m.get()):i(new E("internal-error"))})}(t.c,e).then(function(e){return t.b=Ur(e.access_token),t.a=e.refresh_token,{accessToken:t.b.toString(),refreshToken:t.a}}).o(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function uh(t,e){this.a=t||null,this.b=e||null,Bi(this,{lastSignInTime:Ui(e||null),creationTime:Ui(t||null)})}function ch(t,e,n,i,r,o){Bi(this,{uid:t,displayName:i||null,photoURL:r||null,email:n||null,phoneNumber:o||null,providerId:e})}function hh(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null,t=ib.SDK_VERSION?Ei(ib.SDK_VERSION):null,this.a=new Ga(this.l,O(A),t),this.b=new rh(this.a),gh(this,e[Wa]),ah(this.b,e),Gi(this,"refreshToken",this.b.a),wh(this,n||{}),bn.call(this),this.P=!1,this.s&&Ni()&&(this.i=Mc(this.s,this.l,this.m)),this.R=[],this.h=null,this.B=function(t){return new ih(function(){return t.I(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=oh(t.b)-I()-3e5;return 0<e?e:0})}(this),this.Z=y(this.Ma,this);var i=this;this.oa=null,this.za=function(t){i.va(t.g)},this.aa=null,this.W=[],this.ya=function(t){fh(i,t.c)},this.$=null,this.O=new eh(this,n),Gi(this,"multiFactor",this.O)}function lh(t,e){t.aa&&cn(t.aa,"languageCodeChanged",t.za),(t.aa=e)&&an(e,"languageCodeChanged",t.za)}function fh(t,e){t.W=e,Qa(t.a,ib.SDK_VERSION?Ei(ib.SDK_VERSION,t.W):null)}function dh(t,e){t.$&&cn(t.$,"frameworkChanged",t.ya),(t.$=e)&&an(e,"frameworkChanged",t.ya)}function ph(t){try{return ib.app(t.m).auth()}catch(e){throw new E("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function vh(t){t.D||t.B.b||(t.B.start(),cn(t,"tokenChanged",t.Z),an(t,"tokenChanged",t.Z))}function mh(t){cn(t,"tokenChanged",t.Z),t.B.stop()}function gh(t,e){t.xa=e,Gi(t,"_lat",e)}function bh(t){for(var e=[],n=0;n<t.R.length;n++)e.push(t.R[n](t));return _e(e).then(function(){return t})}function yh(t){t.i&&!t.P&&(t.P=!0,Sc(t.i,t))}function wh(t,e){Bi(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new uh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Ih(){}function Th(t){return Ae().then(function(){if(t.D)throw new E("app-deleted")})}function Eh(t){return K(t.providerData,function(t){return t.providerId})}function kh(t,e){e&&(Ah(t,e.providerId),t.providerData.push(e))}function Ah(t,e){W(t.providerData,function(t){return t.providerId==e})}function Sh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Gi(t,e,n)}function Nh(t,e){t!=e&&(Bi(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Gi(t,"metadata",function(t){return new uh(t.a,t.b)}(e.metadata)):Gi(t,"metadata",new uh),$(e.providerData,function(e){kh(t,e)}),function(t,e){t.b=e.b,t.a=e.a}(t.b,e.b),Gi(t,"refreshToken",t.b.a),nh(t.O,e.O.b))}function _h(t){return t.I().then(function(e){var n=t.isAnonymous;return function(t,e){return Ys(t.a,Ns,{idToken:e}).then(y(t.Ic,t))}(t,e).then(function(){return n||Sh(t,"isAnonymous",!1),e})})}function Oh(t,e){e[Wa]&&t.xa!=e[Wa]&&(ah(t.b,e),t.dispatchEvent(new th("tokenChanged")),gh(t,e[Wa]),Sh(t,"refreshToken",t.b.a))}function Rh(t,e){return _h(t).then(function(){if(G(Eh(t),e))return bh(t).then(function(){throw new E("provider-already-linked")})})}function Ph(t,e,n){return Wi({user:t,credential:Lo(e),additionalUserInfo:e=Gr(e),operationType:n})}function Ch(t,e){return Oh(t,e),t.reload().then(function(){return t})}function Dh(t,e,n,i,r){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));if(t.h&&!r)return Se(t.h);var o=Hr(n.providerId),a=Li(t.uid+":::"),s=null;(!Ri()||vi())&&t.s&&n.isOAuthProvider&&(s=lu(t.s,t.l,t.m,e,n,null,a,ib.SDK_VERSION||null,null,null,t.tenantId));var u=hi(s,o&&o.ta,o&&o.sa);return i=i().then(function(){if(Mh(t),!r)return t.I().then(function(){})}).then(function(){return Rc(t.i,u,e,n,a,!!s,t.tenantId)}).then(function(){return new be(function(n,i){t.la(e,null,new E("cancelled-popup-request"),t.g||null),t.f=n,t.w=i,t.g=a,t.c=Dc(t.i,t,e,u,a)})}).then(function(t){return u&&ci(u),t?Wi(t):null}).o(function(t){throw u&&ci(u),t}),xh(t,i,r)}function Lh(t,e,n,i,r){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));if(t.h&&!r)return Se(t.h);var o=null,a=Li(t.uid+":::");return i=i().then(function(){if(Mh(t),!r)return t.I().then(function(){})}).then(function(){return t.fa=a,bh(t)}).then(function(e){return t.ga&&(e=(e=t.ga).b.set(Uh,t.v(),e.a)),e}).then(function(){return Cc(t.i,e,n,a,t.tenantId)}).o(function(e){if(o=e,t.ga)return Vh(t.ga);throw o}).then(function(){if(o)throw o}),xh(t,i,r)}function Mh(t){if(!t.i||!t.P){if(t.i&&!t.P)throw new E("internal-error");throw new E("auth-domain-config-required")}}function xh(t,e,n){var i=function(t,e,n){return t.h&&!n?(e.cancel(),Se(t.h)):e.o(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new th("userInvalidated")),t.h=e),e})}(t,e,n);return t.N.push(i),i.ma(function(){B(t.N,i)}),i.o(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Yc(e.v(),ph(t),y(t.hc,t))),n||e})}function Fh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Wa]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var i=new hh(e,n,t);return t.providerData&&$(t.providerData,function(t){t&&kh(i,Wi(t))}),t.redirectEventId&&(i.fa=t.redirectEventId),i}function jh(t){this.a=t,this.b=Wu()}Bc.prototype.Pc=function(t){var e=this;return t.ob(this.a.b,this.c).then(function(t){var n=ft(e.f);return delete n[Wc],delete n[Xc],pt(n,t),e.g(n)})},T(Jc,E),zc.prototype.ob=function(t,e,n){return e.type==no?function(t,e,n,i){return n.Fa().then(function(n){return n={idToken:n},void 0!==i&&(n.displayName=i),pt(n,{phoneVerificationInfo:Po(t.a)}),Ys(e,As,n)})}(this,t,e,n):function(t,e,n){return n.Fa().then(function(n){return pt(n={mfaPendingCredential:n},{phoneVerificationInfo:Po(t.a)}),Ys(e,Ss,n)})}(this,t,e)},T(Zc,zc),T(Qc,Zc),T(th,We),(t=eh.prototype).wc=function(t){nh(this,function(t){var e=[];return $(t.mfaInfo||[],function(t){(t=Yi(t))&&e.push(t)}),e}(t.ed))},t.Ob=function(){return this.a.I().then(function(t){return new eo(t,null)})},t.dc=function(t,e){var n=this,i=this.a.a;return this.Ob().then(function(n){return t.ob(i,n,e)}).then(function(t){return Oh(n.a,t),n.a.reload()})},t.$c=function(t){var e=this,n="string"==typeof t?t:t.uid,i=this.a.a;return this.a.I().then(function(t){return Ys(i,Js,{idToken:t,mfaEnrollmentId:n})}).then(function(t){var i=q(e.b,function(t){return t.uid!=n});return nh(e,i),Oh(e.a,t),e.a.reload().o(function(t){if("auth/user-token-expired"!=t.code)throw t})})},t.v=function(){return{multiFactor:{enrolledFactors:K(this.b,function(t){return t.v()})}}},ih.prototype.start=function(){this.a=this.c,function t(e,n){e.stop();e.b=En(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then(function(){return t=a.document,e=null,ji()||!t?Ae():new be(function(n){e=function(){ji()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).o(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).o(function(n){e.i(n)&&t(e,!1)})}(this,!0)},ih.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},rh.prototype.v=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:oh(this)}},rh.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Se(new E("user-token-expired")):t||!this.b||I()>oh(this)-3e4?this.a?sh(this,{grant_type:"refresh_token",refresh_token:this.a}):Ae(null):Ae({accessToken:this.b.toString(),refreshToken:this.a})},uh.prototype.v=function(){return{lastLoginAt:this.b,createdAt:this.a}},T(hh,bn),hh.prototype.va=function(t){this.oa=t,Za(this.a,t)},hh.prototype.ja=function(){return this.oa},hh.prototype.Ea=function(){return J(this.W)},hh.prototype.Ma=function(){this.B.b&&(this.B.stop(),this.B.start())},Gi(hh.prototype,"providerId","firebase"),(t=hh.prototype).reload=function(){var t=this;return xh(this,Th(this).then(function(){return _h(t).then(function(){return bh(t)}).then(Ih)}))},t.mc=function(t){return this.I(t).then(function(t){return new Gc(t)})},t.I=function(t){var e=this;return xh(this,Th(this).then(function(){return e.b.getToken(t)}).then(function(t){if(!t)throw new E("internal-error");return t.accessToken!=e.xa&&(gh(e,t.accessToken),e.dispatchEvent(new th("tokenChanged"))),Sh(e,"refreshToken",t.refreshToken),t.accessToken}))},t.Ic=function(t){if(!(t=t.users)||!t.length)throw new E("internal-error");wh(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?K(t,function(t){return new ch(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)kh(this,e[n]);Sh(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new th("userReloaded",{ed:t}))},t.Jc=function(t){return Ki("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.pb(t)},t.pb=function(t){var e=this,n=null;return xh(this,t.c(this.a,this.uid).then(function(t){return Oh(e,t),n=Ph(e,t,"reauthenticate"),e.h=null,e.reload()}).then(function(){return n}),!0)},t.Ac=function(t){return Ki("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.mb(t)},t.mb=function(t){var e=this,n=null;return xh(this,Rh(this,t.providerId).then(function(){return e.I()}).then(function(n){return t.b(e.a,n)}).then(function(t){return n=Ph(e,t,"link"),Ch(e,t)}).then(function(){return n}))},t.Bc=function(t,e){var n=this;return xh(this,Rh(this,"phone").then(function(){return Hc(ph(n),t,e,y(n.mb,n))}))},t.Kc=function(t,e){var n=this;return xh(this,Ae().then(function(){return Hc(ph(n),t,e,y(n.pb,n))}),!0)},t.xb=function(t){var e=this;return xh(this,this.I().then(function(n){return e.a.xb(n,t)}).then(function(t){return Oh(e,t),e.reload()}))},t.cd=function(t){var e=this;return xh(this,this.I().then(function(n){return t.b(e.a,n)}).then(function(t){return Oh(e,t),e.reload()}))},t.yb=function(t){var e=this;return xh(this,this.I().then(function(n){return e.a.yb(n,t)}).then(function(t){return Oh(e,t),e.reload()}))},t.zb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Th(this);var e=this;return xh(this,this.I().then(function(n){return e.a.zb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Oh(e,t),Sh(e,"displayName",t.displayName||null),Sh(e,"photoURL",t.photoUrl||null),$(e.providerData,function(t){"password"===t.providerId&&(Gi(t,"displayName",e.displayName),Gi(t,"photoURL",e.photoURL))}),bh(e)}).then(Ih))},t.ad=function(t){var e=this;return xh(this,_h(this).then(function(n){return G(Eh(e),t)?function(t,e,n){return Ys(t,Ts,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then(function(t){var n={};return $(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),$(Eh(e),function(t){n[t]||Ah(e,t)}),n[Co.PROVIDER_ID]||Gi(e,"phoneNumber",null),bh(e)}):bh(e).then(function(){throw new E("no-such-provider")})}))},t.delete=function(){var t=this;return xh(this,this.I().then(function(e){return Ys(t.a,Is,{idToken:e})}).then(function(){t.dispatchEvent(new th("userDeleted"))})).then(function(){for(var e=0;e<t.N.length;e++)t.N[e].cancel("app-deleted");lh(t,null),dh(t,null),t.N=[],t.D=!0,mh(t),Gi(t,"refreshToken",null),t.i&&Nc(t.i,t)})},t.Cb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.fa||null)==e||"reauthViaRedirect"==t&&(this.fa||null)==e)},t.la=function(t,e,n,i){"linkViaPopup"!=t&&"reauthViaPopup"!=t||i!=(this.g||null)||(n&&this.w?this.w(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.w)},t.Da=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?y(this.Hb,this):"reauthViaPopup"==t&&e==(this.g||null)?y(this.Ib,this):"linkViaRedirect"==t&&(this.fa||null)==e?y(this.Hb,this):"reauthViaRedirect"==t&&(this.fa||null)==e?y(this.Ib,this):null},t.Cc=function(t){var e=this;return Dh(this,"linkViaPopup",t,function(){return Rh(e,t.providerId).then(function(){return bh(e)})},!1)},t.Lc=function(t){return Dh(this,"reauthViaPopup",t,function(){return Ae()},!0)},t.Dc=function(t){var e=this;return Lh(this,"linkViaRedirect",t,function(){return Rh(e,t.providerId)},!1)},t.Mc=function(t){return Lh(this,"reauthViaRedirect",t,function(){return Ae()},!0)},t.Hb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return xh(this,this.I().then(function(n){return ps(r.a,{requestUri:t,postBody:i,sessionId:e,idToken:n})}).then(function(t){return o=Ph(r,t,"link"),Ch(r,t)}).then(function(){return o}))},t.Ib=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return xh(this,Ae().then(function(){return oo(vs(r.a,{requestUri:t,sessionId:e,postBody:i,tenantId:n}),r.uid)}).then(function(t){return o=Ph(r,t,"reauthenticate"),Oh(r,t),r.h=null,r.reload()}).then(function(){return o}),!0)},t.qb=function(t){var e=this,n=null;return xh(this,this.I().then(function(e){return n=e,void 0===t||lt(t)?{}:Mr(new Ar(t))}).then(function(t){return e.a.qb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},t.Ab=function(t,e){var n=this,i=null;return xh(this,this.I().then(function(t){return i=t,void 0===e||lt(e)?{}:Mr(new Ar(e))}).then(function(e){return n.a.Ab(i,t,e)}).then(function(t){if(n.email!=t)return n.reload()}).then(function(){}))},t.hc=function(t){var e=null,n=this;return xh(this,t=oo(Ae(t),n.uid).then(function(t){return e=Ph(n,t,"reauthenticate"),Oh(n,t),n.h=null,n.reload()}).then(function(){return e}),!0)},t.toJSON=function(){return this.v()},t.v=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.v(),redirectEventId:this.fa||null};return this.metadata&&pt(t,this.metadata.v()),$(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),pt(t,this.O.v()),t};var Uh={name:"redirectUser",F:"session"};function Vh(t){return Yu(t.b,Uh,t.a)}function $h(t){this.a=t,this.b=Wu(),this.c=null,this.f=function(t){var e=Hh("local"),n=Hh("session"),i=Hh("none");return function(t,e,n){var i=Ju(e,n),r=Xu(t,e.F);return t.get(e,n).then(function(o){var s=null;try{s=Di(a.localStorage.getItem(i))}catch(u){}if(s&&!o)return a.localStorage.removeItem(i),t.set(e,s,n);s&&o&&"localStorage"!=r.type&&a.localStorage.removeItem(i)})}(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(r){return r?n:t.b.get(i,t.a).then(function(n){return n?i:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(Kh,t.a).then(function(t){return t?Hh(t):e})})})}).then(function(e){return t.c=e,qh(t,e.F)}).o(function(){t.c||(t.c=e)})}(this),this.b.addListener(Hh("local"),this.a,y(this.g,this))}function qh(t,e){var n,i=[];for(n in Gu)Gu[n]!==e&&i.push(Yu(t.b,Hh(Gu[n]),t.a));return i.push(Yu(t.b,Kh,t.a)),function(t){return new be(function(e,n){var i=t.length,r=[];if(i)for(var o=function(t,n){i--,r[t]=n,0==i&&e(r)},a=function(t){n(t)},s=0;s<t.length;s++)Ne(t[s],w(o,s),a);else e(r)})}(i)}$h.prototype.g=function(){var t=this,e=Hh("local");Xh(this,function(){return Ae().then(function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null}).then(function(n){if(n)return qh(t,"local").then(function(){t.c=e})})})};var Kh={name:"persistence",F:"session"};function Hh(t){return{name:"authUser",F:t}}function Gh(t,e){return Xh(t,function(){return t.b.set(t.c,e.v(),t.a)})}function Bh(t){return Xh(t,function(){return Yu(t.b,t.c,t.a)})}function Wh(t,e){return Xh(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),Fh(t||{})})})}function Xh(t,e){return t.f=t.f.then(e,e),t.f}function Jh(t){if(this.l=!1,Gi(this,"settings",new qc),Gi(this,"app",t),!il(this).options||!il(this).options.apiKey)throw new E("invalid-api-key");t=ib.SDK_VERSION?Ei(ib.SDK_VERSION):null,this.b=new Ga(il(this).options&&il(this).options.apiKey,O(A),t),this.P=[],this.m=[],this.O=[],this.$b=ib.INTERNAL.createSubscribe(y(this.xc,this)),this.W=void 0,this.ac=ib.INTERNAL.createSubscribe(y(this.yc,this)),el(this,null),this.i=new $h(il(this).options.apiKey+":"+il(this).name),this.B=new jh(il(this).options.apiKey+":"+il(this).name),this.Z=sl(this,function(t){var e=il(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Uh,t.a).then(function(t){return t&&e&&(t.authDomain=e),Fh(t||{})})}(t.B,il(t).options.authDomain).then(function(e){return(t.D=e)&&(e.ga=t.B),Vh(t.B)});return sl(t,e)}(t).then(function(){return Wh(t.i,e)}).then(function(e){return e?(e.ga=t.B,t.D&&(t.D.fa||null)==(e.fa||null)?e:e.reload().then(function(){return Gh(t.i,e).then(function(){return e})}).o(function(n){return"auth/network-request-failed"==n.code?e:Bh(t.i)})):null}).then(function(e){el(t,e||null)});return sl(t,n)}(this)),this.h=sl(this,function(t){return t.Z.then(function(){return Qh(t)}).o(function(){}).then(function(){if(!t.l)return t.oa()}).o(function(){}).then(function(){if(!t.l){t.aa=!0;var e=t.i;e.b.addListener(Hh("local"),e.a,t.oa)}})}(this)),this.aa=!1,this.oa=y(this.Xc,this),this.Ma=y(this.ca,this),this.xa=y(this.jc,this),this.ya=y(this.uc,this),this.za=y(this.vc,this),this.a=null,function(t){var e=il(t).options.authDomain,n=il(t).options.apiKey;e&&Ni()&&(t.Zb=t.Z.then(function(){if(!t.l){if(t.a=Mc(e,n,il(t).name),Sc(t.a,t),rl(t)&&yh(rl(t)),t.D){yh(t.D);var i=t.D;i.va(t.ja()),lh(i,t),fh(i=t.D,t.N),dh(i,t),t.D=null}return t.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=y(this.delete,this),this.INTERNAL.logFramework=y(this.Ec,this),this.s=0,bn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ja()},set:function(t){this.va(t)},enumerable:!1}),t.$=null,Object.defineProperty(t,"ti",{get:function(){return this.S()},set:function(t){this.ub(t)},enumerable:!1}),t.R=null}(this),this.N=[]}function Yh(t){We.call(this,"languageCodeChanged"),this.g=t}function zh(t){We.call(this,"frameworkChanged"),this.c=t}function Zh(t){return t.Zb||Se(new E("auth-domain-config-required"))}function Qh(t){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));var e=Zh(t).then(function(){return t.a.pa()}).then(function(t){return t?Wi(t):null});return sl(t,e)}function tl(t,e){var n={};return n.apiKey=il(t).options.apiKey,n.authDomain=il(t).options.authDomain,n.appName=il(t).name,t.Z.then(function(){return function(t,e,n,i){var r=new hh(t,e);return n&&(r.ga=n),i&&fh(r,i),r.reload().then(function(){return r})}(n,e,t.B,t.Ea())}).then(function(e){return rl(t)&&e.uid==rl(t).uid?(Nh(rl(t),e),t.ca(e)):(el(t,e),yh(e),t.ca(e))}).then(function(){al(t)})}function el(t,e){rl(t)&&(function(t,e){W(t.R,function(t){return t==e})}(rl(t),t.Ma),cn(rl(t),"tokenChanged",t.xa),cn(rl(t),"userDeleted",t.ya),cn(rl(t),"userInvalidated",t.za),mh(rl(t))),e&&(e.R.push(t.Ma),an(e,"tokenChanged",t.xa),an(e,"userDeleted",t.ya),an(e,"userInvalidated",t.za),0<t.s&&vh(e)),Gi(t,"currentUser",e),e&&(e.va(t.ja()),lh(e,t),fh(e,t.N),dh(e,t))}function nl(t,e){var n=null,i=null;return sl(t,e.then(function(e){return n=Lo(e),i=Gr(e),tl(t,e)},function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=Yc(e.v(),t,y(t.ic,t))),n||e}).then(function(){return Wi({user:rl(t),credential:n,additionalUserInfo:i,operationType:"signIn"})}))}function il(t){return t.app}function rl(t){return t.currentUser}function ol(t){return rl(t)&&rl(t)._lat||null}function al(t){if(t.aa){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](ol(t));if(t.W!==t.getUid()&&t.O.length)for(t.W=t.getUid(),e=0;e<t.O.length;e++)t.O[e]&&t.O[e](ol(t))}}function sl(t,e){return t.P.push(e),e.ma(function(){B(t.P,e)}),e}function ul(){}function cl(){this.a={},this.b=1e12}$h.prototype.tb=function(t){var e=null,n=this;return function(t){var e=new E("invalid-persistence-type"),n=new E("unsupported-persistence-type");t:{for(i in Gu)if(Gu[i]==t){var i=!0;break t}i=!1}if(!i||"string"!=typeof t)throw e;switch(gi()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!ku()&&"none"!==t)throw n;break;default:if(!Si()&&"none"!==t)throw n;}}(t),Xh(this,function(){return t!=n.c.F?n.b.get(n.c,n.a).then(function(i){return e=i,qh(n,t)}).then(function(){if(n.c=Hh(t),e)return n.b.set(n.c,e,n.a)}):Ae()})},T(Jh,bn),T(Yh,We),T(zh,We),(t=Jh.prototype).tb=function(t){return sl(this,t=this.i.tb(t))},t.va=function(t){this.$===t||this.l||(this.$=t,Za(this.b,this.$),this.dispatchEvent(new Yh(this.ja())))},t.ja=function(){return this.$},t.dd=function(){var t=a.navigator;this.va(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.Ec=function(t){this.N.push(t),Qa(this.b,ib.SDK_VERSION?Ei(ib.SDK_VERSION,this.N):null),this.dispatchEvent(new zh(this.N))},t.Ea=function(){return J(this.N)},t.ub=function(t){this.R===t||this.l||(this.R=t,this.b.b=this.R)},t.S=function(){return this.R},t.toJSON=function(){return{apiKey:il(this).options.apiKey,authDomain:il(this).options.authDomain,appName:il(this).name,currentUser:rl(this)&&rl(this).v()}},t.Cb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1;}},t.la=function(t,e,n,i){"signInViaPopup"==t&&this.g==i&&(n&&this.w?this.w(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.w)},t.Da=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?y(this.gc,this):null},t.gc=function(t,e,n,i){var r=this,o={requestUri:t,postBody:i,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),r.Z.then(function(){return nl(r,ds(r.b,o))})},t.Vc=function(t){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));var e=this,n=Hr(t.providerId),i=Li(),r=null;(!Ri()||vi())&&il(this).options.authDomain&&t.isOAuthProvider&&(r=lu(il(this).options.authDomain,il(this).options.apiKey,il(this).name,"signInViaPopup",t,null,i,ib.SDK_VERSION||null,null,null,this.S()));var o=hi(r,n&&n.ta,n&&n.sa);return sl(this,n=Zh(this).then(function(n){return Rc(n,o,"signInViaPopup",t,i,!!r,e.S())}).then(function(){return new be(function(t,n){e.la("signInViaPopup",null,new E("cancelled-popup-request"),e.g),e.f=t,e.w=n,e.g=i,e.c=Dc(e.a,e,"signInViaPopup",o,i)})}).then(function(t){return o&&ci(o),t?Wi(t):null}).o(function(t){throw o&&ci(o),t}))},t.Wc=function(t){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));var e=this;return sl(this,Zh(this).then(function(){return Xh(t=e.i,function(){return t.b.set(Kh,t.c.F,t.a)});var t}).then(function(){return Cc(e.a,"signInViaRedirect",t,void 0,e.S())}))},t.pa=function(){var t=this;return Qh(this).then(function(e){return t.a&&jc(t.a.b),e}).o(function(e){throw t.a&&jc(t.a.b),e})},t.bd=function(t){if(!t)return Se(new E("null-user"));if(this.R!=t.tenantId)return Se(new E("tenant-id-mismatch"));var e=this,n={};n.apiKey=il(this).options.apiKey,n.authDomain=il(this).options.authDomain,n.appName=il(this).name;var i=function(t,e,n,i){var r=t.b,o={};return o[Wa]=r.b&&r.b.toString(),o.refreshToken=r.a,e=new hh(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ga=n),i&&fh(e,i),Nh(e,t),e}(t,n,e.B,e.Ea());return sl(this,this.h.then(function(){if(il(e).options.apiKey!=t.l)return i.reload()}).then(function(){return rl(e)&&t.uid==rl(e).uid?(Nh(rl(e),t),e.ca(t)):(el(e,i),yh(i),e.ca(i))}).then(function(){al(e)}))},t.wb=function(){var t=this;return sl(this,this.h.then(function(){return t.a&&jc(t.a.b),rl(t)?(el(t,null),Bh(t.i).then(function(){al(t)})):Ae()}))},t.Xc=function(){var t=this;return Wh(this.i,il(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=rl(t)&&e){n=rl(t).uid;var i=e.uid;n=null!=n&&""!==n&&null!=i&&""!==i&&n==i}if(n)return Nh(rl(t),e),rl(t).I();(rl(t)||e)&&(el(t,e),e&&(yh(e),e.ga=t.B),t.a&&Sc(t.a,t),al(t))}})},t.ca=function(t){return Gh(this.i,t)},t.jc=function(){al(this),this.ca(rl(this))},t.uc=function(){this.wb()},t.vc=function(){this.wb()},t.ic=function(t){var e=this;return this.h.then(function(){return nl(e,Ae(t))})},t.xc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(rl(e))})},t.yc=function(t){var e=this;!function(t,e){t.O.push(e),sl(t,t.h.then(function(){!t.l&&G(t.O,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(ol(t)))}))}(this,function(){t.next(rl(e))})},t.Gc=function(t,e,n){var i=this;return this.aa&&Promise.resolve().then(function(){f(t)?t(rl(i)):f(t.next)&&t.next(rl(i))}),this.$b(t,e,n)},t.Fc=function(t,e,n){var i=this;return this.aa&&Promise.resolve().then(function(){i.W=i.getUid(),f(t)?t(rl(i)):f(t.next)&&t.next(rl(i))}),this.ac(t,e,n)},t.kc=function(t){var e=this;return sl(this,this.h.then(function(){return rl(e)?rl(e).I(t).then(function(t){return{accessToken:t}}):null}))},t.Rc=function(t){var e=this;return this.h.then(function(){return nl(e,Ys(e.b,Hs,{token:t}))}).then(function(t){var n=t.user;return Sh(n,"isAnonymous",!1),e.ca(n),t})},t.Sc=function(t,e){var n=this;return this.h.then(function(){return nl(n,Ys(n.b,Gs,{email:t,password:e}))})},t.cc=function(t,e){var n=this;return this.h.then(function(){return nl(n,Ys(n.b,ys,{email:t,password:e}))})},t.Ya=function(t){var e=this;return this.h.then(function(){return nl(e,t.ia(e.b))})},t.Qc=function(t){return Ki("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Ya(t)},t.vb=function(){var t=this;return this.h.then(function(){var e=rl(t);if(e&&e.isAnonymous){var n=Wi({providerId:null,isNewUser:!1});return Wi({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return nl(t,t.b.vb()).then(function(e){var n=e.user;return Sh(n,"isAnonymous",!0),t.ca(n),e})})},t.getUid=function(){return rl(this)&&rl(this).uid||null},t.bc=function(t){this.addAuthTokenListener(t),this.s++,0<this.s&&rl(this)&&vh(rl(this))},t.Nc=function(t){var e=this;$(this.m,function(n){n==t&&e.s--}),0>this.s&&(this.s=0),0==this.s&&rl(this)&&mh(rl(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.m.push(t),sl(this,this.h.then(function(){e.l||G(e.m,t)&&t(ol(e))}))},t.removeAuthTokenListener=function(t){W(this.m,function(e){return e==t})},t.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i).b.removeListener(Hh("local"),t.a,this.oa),this.a&&(Nc(this.a,this),jc(this.a.b)),Promise.resolve()},t.fc=function(t){return sl(this,function(t,e){return Ys(t,ws,{identifier:e,continueUri:_i()?ai():"http://localhost"}).then(function(t){return t.signinMethods||[]})}(this.b,t))},t.zc=function(t){return!!_o(t)},t.sb=function(t,e){var n=this;return sl(this,Ae().then(function(){var t=new Ar(e);if(!t.c)throw new E("argument-error",_r+" must be true when sending sign in link to email");return Mr(t)}).then(function(e){return n.b.sb(t,e)}).then(function(){}))},t.fd=function(t){return this.Pa(t).then(function(t){return t.data.email})},t.jb=function(t,e){return sl(this,this.b.jb(t,e).then(function(){}))},t.Pa=function(t){return sl(this,this.b.Pa(t).then(function(t){return new nr(t)}))},t.fb=function(t){return sl(this,this.b.fb(t).then(function(){}))},t.rb=function(t,e){var n=this;return sl(this,Ae().then(function(){return void 0===e||lt(e)?{}:Mr(new Ar(e))}).then(function(e){return n.b.rb(t,e)}).then(function(){}))},t.Uc=function(t,e){return sl(this,Hc(this,t,e,y(this.Ya,this)))},t.Tc=function(t,e){var n=this;return sl(this,Ae().then(function(){var i=e||ai(),r=No(t,i);if(!(i=_o(i)))throw new E("argument-error","Invalid email link!");if(i.tenantId!==n.S())throw new E("tenant-id-mismatch");return n.Ya(r)}))},ul.prototype.render=function(){},ul.prototype.reset=function(){},ul.prototype.getResponse=function(){},ul.prototype.execute=function(){};var hl=null;function ll(t,e){return(e=fl(e))&&t.a[e]||null}function fl(t){return(t=void 0===t?1e12:t)?t.toString():null}function dl(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=re(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():an(this.f,"click",this.i)}function pl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function vl(){}function ml(){}cl.prototype.render=function(t,e){return this.a[this.b.toString()]=new dl(t,e),this.b++},cl.prototype.reset=function(t){var e=ll(this,t);t=fl(t),e&&t&&(e.delete(),delete this.a[t])},cl.prototype.getResponse=function(t){return(t=ll(this,t))?t.getResponse():null},cl.prototype.execute=function(t){(t=ll(this,t))&&t.execute()},dl.prototype.getResponse=function(){return pl(this),this.b},dl.prototype.execute=function(){pl(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(i){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(i){}t.h&&t.execute()},6e4)},500))},dl.prototype.delete=function(){pl(this),this.g=!0,clearTimeout(this.a),this.a=null,cn(this.f,"click",this.i)},Gi(vl,"FACTOR_ID","phone"),ml.prototype.g=function(){return hl||(hl=new cl),Ae(hl)},ml.prototype.c=function(){};var gl=null;function bl(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var yl=new mt(yt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),wl=new Fi(3e4,6e4);bl.prototype.g=function(t){var e=this;return new be(function(n,i){var r=setTimeout(function(){i(new E("network-request-failed"))},wl.get());!a.grecaptcha||t!==e.f&&!e.b?(a[e.a]=function(){if(a.grecaptcha){e.f=t;var o=a.grecaptcha.render;a.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(r),n(a.grecaptcha)}else clearTimeout(r),i(new E("internal-error"));delete a[e.a]},Ae(ja(Et(yl,{onload:e.a,hl:t||""}))).o(function(){clearTimeout(r),i(new E("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(r),n(a.grecaptcha))})},bl.prototype.c=function(){this.b--};var Il=null;function Tl(t,e,n,i,r,o,s){if(Gi(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.u=e,this.g=null,s?(gl||(gl=new ml),s=gl):(Il||(Il=new bl),s=Il),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Al])throw new E("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Sl],!a.document)throw new E("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!re(e)||!this.i&&re(e).hasChildNodes())throw new E("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Ga(t,o||null,r||null),this.w=i||function(){return null};var u=this;this.l=[];var c=this.a[El];this.a[El]=function(t){if(Nl(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Ai(c,a);"function"==typeof e&&e(t)}};var h=this.a[kl];this.a[kl]=function(){if(Nl(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=Ai(h,a);"function"==typeof t&&t()}}}var El="callback",kl="expired-callback",Al="sitekey",Sl="size";function Nl(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(i){}}function _l(t,e){return t.h.push(e),e.ma(function(){B(t.h,e)}),e}function Ol(t){if(t.D)throw new E("internal-error","RecaptchaVerifier instance has been destroyed.")}function Rl(t,e,n){var i=!1;try{this.b=n||ib.app()}catch(a){throw new E("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new E("invalid-api-key");n=this.b.options.apiKey;var r=this,o=null;try{o=this.b.auth().Ea()}catch(a){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(a){}o=ib.SDK_VERSION?Ei(ib.SDK_VERSION,o):null,Tl.call(this,n,t,e,function(){try{var t=r.b.auth().ja()}catch(e){t=null}return t},o,O(A),i)}function Pl(t,e,n,i){t:{n=Array.prototype.slice.call(n);for(var r=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new E("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(o=e.length,n.length<r||o<n.length)i="Expected "+(r==o?1==r?"1 argument":r+" arguments":r+"-"+o+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(o=e[r].optional&&void 0===n[r],!e[r].K(n[r])&&!o){if(e=e[r],0>r||r>=Cl.length)throw new E("internal-error","Argument validator received an unsupported number of arguments.");n=Cl[r],i=(i?"":n+" argument ")+(e.name?"\""+e.name+"\" ":"")+"must be "+e.J+".";break t}i=null}}if(i)throw new E("argument-error",t+" failed: "+i)}(t=Tl.prototype).Ga=function(){var t=this;return this.f?this.f:this.f=_l(this,Ae().then(function(){if(_i()&&!mi())return di();throw new E("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.m.g(t.w())}).then(function(e){return t.g=e,Ys(t.s,Ds,{})}).then(function(e){t.a[Al]=e.recaptchaSiteKey}).o(function(e){throw t.f=null,e}))},t.render=function(){Ol(this);var t=this;return _l(this,this.Ga().then(function(){if(null===t.c){var e=t.u;if(!t.i){var n=re(e);e=ce("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},t.verify=function(){Ol(this);var t=this;return _l(this,this.render().then(function(e){return new be(function(n){var i=t.g.getResponse(e);if(i)n(i);else{var r=function(e){e&&(function(t,e){W(t.l,function(t){return t==e})}(t,r),n(e))};t.l.push(r),t.i&&t.g.execute(t.c)}})}))},t.reset=function(){Ol(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Ol(this),this.D=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=re(this.u);for(var e;e=t.firstChild;)t.removeChild(e)}},T(Rl,Tl);var Cl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Dl(t,e){return{name:t||"",J:"a valid string",optional:!!e,K:function(t){return"string"==typeof t}}}function Ll(t,e){return{name:t||"",J:"a boolean",optional:!!e,K:function(t){return"boolean"==typeof t}}}function Ml(t,e){return{name:t||"",J:"a valid object",optional:!!e,K:d}}function xl(t,e){return{name:t||"",J:"a function",optional:!!e,K:f}}function Fl(t,e){return{name:t||"",J:"null",optional:!!e,K:function(t){return null===t}}}function jl(t){return{name:t?t+"Credential":"credential",J:t?"a valid "+t+" credential":"a valid credential",optional:!1,K:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ia||!n)}}}function Ul(t,e){return d(t)&&"string"==typeof t.type&&t.type===e&&f(t.Fa)}function Vl(t){return d(t)&&"string"==typeof t.uid}function $l(){return{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||!f(t.verify))}}}function ql(t,e,n,i){return{name:n||"",J:t.J+" or "+e.J,optional:!!i,K:function(n){return t.K(n)||e.K(n)}}}function Kl(t,e){for(var n in e){var i=e[n].name;t[i]=Bl(i,t[n],e[n].j)}}function Hl(t,e){for(var n in e){var i=e[n].name;i!==n&&Object.defineProperty(t,i,{get:w(function(t){return this[t]},n),set:w(function(t,e,n,i){Pl(t,[n],[i],!0),this[e]=i},i,n,e[n].gb),enumerable:!0})}}function Gl(t,e,n,i){t[e]=Bl(e,n,i)}function Bl(t,e,n){function i(){var t=Array.prototype.slice.call(arguments);return Pl(o,n,t),e.apply(this,t)}if(!n)return e;var r,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(r in e)i[r]=e[r];for(r in e.prototype)i.prototype[r]=e.prototype[r];return i}Kl(Jh.prototype,{fb:{name:"applyActionCode",j:[Dl("code")]},Pa:{name:"checkActionCode",j:[Dl("code")]},jb:{name:"confirmPasswordReset",j:[Dl("code"),Dl("newPassword")]},cc:{name:"createUserWithEmailAndPassword",j:[Dl("email"),Dl("password")]},fc:{name:"fetchSignInMethodsForEmail",j:[Dl("email")]},pa:{name:"getRedirectResult",j:[]},zc:{name:"isSignInWithEmailLink",j:[Dl("emailLink")]},Fc:{name:"onAuthStateChanged",j:[ql(Ml(),xl(),"nextOrObserver"),xl("opt_error",!0),xl("opt_completed",!0)]},Gc:{name:"onIdTokenChanged",j:[ql(Ml(),xl(),"nextOrObserver"),xl("opt_error",!0),xl("opt_completed",!0)]},rb:{name:"sendPasswordResetEmail",j:[Dl("email"),ql(Ml("opt_actionCodeSettings",!0),Fl(null,!0),"opt_actionCodeSettings",!0)]},sb:{name:"sendSignInLinkToEmail",j:[Dl("email"),Ml("actionCodeSettings")]},tb:{name:"setPersistence",j:[Dl("persistence")]},Qc:{name:"signInAndRetrieveDataWithCredential",j:[jl()]},vb:{name:"signInAnonymously",j:[]},Ya:{name:"signInWithCredential",j:[jl()]},Rc:{name:"signInWithCustomToken",j:[Dl("token")]},Sc:{name:"signInWithEmailAndPassword",j:[Dl("email"),Dl("password")]},Tc:{name:"signInWithEmailLink",j:[Dl("email"),Dl("emailLink",!0)]},Uc:{name:"signInWithPhoneNumber",j:[Dl("phoneNumber"),$l()]},Vc:{name:"signInWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Wc:{name:"signInWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},bd:{name:"updateCurrentUser",j:[ql({name:"user",J:"an instance of Firebase User",optional:!1,K:function(t){return!!(t&&t instanceof hh)}},Fl(),"user")]},wb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Dl(null,!0)]},dd:{name:"useDeviceLanguage",j:[]},fd:{name:"verifyPasswordResetCode",j:[Dl("code")]}}),Hl(Jh.prototype,{lc:{name:"languageCode",gb:ql(Dl(),Fl(),"languageCode")},ti:{name:"tenantId",gb:ql(Dl(),Fl(),"tenantId")}}),Jh.Persistence=Gu,Jh.Persistence.LOCAL="local",Jh.Persistence.SESSION="session",Jh.Persistence.NONE="none",Kl(hh.prototype,{delete:{name:"delete",j:[]},mc:{name:"getIdTokenResult",j:[Ll("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Ll("opt_forceRefresh",!0)]},Ac:{name:"linkAndRetrieveDataWithCredential",j:[jl()]},mb:{name:"linkWithCredential",j:[jl()]},Bc:{name:"linkWithPhoneNumber",j:[Dl("phoneNumber"),$l()]},Cc:{name:"linkWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Dc:{name:"linkWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Jc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[jl()]},pb:{name:"reauthenticateWithCredential",j:[jl()]},Kc:{name:"reauthenticateWithPhoneNumber",j:[Dl("phoneNumber"),$l()]},Lc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Mc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},qb:{name:"sendEmailVerification",j:[ql(Ml("opt_actionCodeSettings",!0),Fl(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Dl(null,!0)]},ad:{name:"unlink",j:[Dl("provider")]},xb:{name:"updateEmail",j:[Dl("email")]},yb:{name:"updatePassword",j:[Dl("password")]},cd:{name:"updatePhoneNumber",j:[jl("phone")]},zb:{name:"updateProfile",j:[Ml("profile")]},Ab:{name:"verifyBeforeUpdateEmail",j:[Dl("email"),ql(Ml("opt_actionCodeSettings",!0),Fl(null,!0),"opt_actionCodeSettings",!0)]}}),Kl(cl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Kl(ul.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Kl(be.prototype,{ma:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Hl(qc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",gb:Ll("appVerificationDisabledForTesting")}}),Kl(Kc.prototype,{confirm:{name:"confirm",j:[Dl("verificationCode")]}}),Gl(ro,"fromJSON",function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[lo,Ao,Ro,uo],i=0;i<n.length;i++)if(e=n[i](t))return e;return null},[ql(Dl(),Ml(),"json")]),Gl(So,"credential",function(t,e){return new ko(t,e)},[Dl("email"),Dl("password")]),Kl(ko.prototype,{v:{name:"toJSON",j:[Dl(null,!0)]}}),Kl(mo.prototype,{Aa:{name:"addScope",j:[Dl("scope")]},Ia:{name:"setCustomParameters",j:[Ml("customOAuthParameters")]}}),Gl(mo,"credential",go,[ql(Dl(),Ml(),"token")]),Gl(So,"credentialWithLink",No,[Dl("email"),Dl("emailLink")]),Kl(bo.prototype,{Aa:{name:"addScope",j:[Dl("scope")]},Ia:{name:"setCustomParameters",j:[Ml("customOAuthParameters")]}}),Gl(bo,"credential",yo,[ql(Dl(),Ml(),"token")]),Kl(wo.prototype,{Aa:{name:"addScope",j:[Dl("scope")]},Ia:{name:"setCustomParameters",j:[Ml("customOAuthParameters")]}}),Gl(wo,"credential",Io,[ql(Dl(),ql(Ml(),Fl()),"idToken"),ql(Dl(),Fl(),"accessToken",!0)]),Kl(To.prototype,{Ia:{name:"setCustomParameters",j:[Ml("customOAuthParameters")]}}),Gl(To,"credential",Eo,[ql(Dl(),Ml(),"token"),Dl("secret",!0)]),Kl(vo.prototype,{Aa:{name:"addScope",j:[Dl("scope")]},credential:{name:"credential",j:[ql(Dl(),ql(Ml(),Fl()),"optionsOrIdToken"),ql(Dl(),Fl(),"accessToken",!0)]},Ia:{name:"setCustomParameters",j:[Ml("customOAuthParameters")]}}),Kl(co.prototype,{v:{name:"toJSON",j:[Dl(null,!0)]}}),Kl(ao.prototype,{v:{name:"toJSON",j:[Dl(null,!0)]}}),Gl(Co,"credential",Do,[Dl("verificationId"),Dl("verificationCode")]),Kl(Co.prototype,{cb:{name:"verifyPhoneNumber",j:[ql(Dl(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(t){return!!t&&(t.session&&t.phoneNumber?Ul(t.session,no)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Ul(t.session,io)&&Vl(t.multiFactorHint):t.session&&t.multiFactorUid?Ul(t.session,io)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),$l()]}}),Kl(Oo.prototype,{v:{name:"toJSON",j:[Dl(null,!0)]}}),Kl(E.prototype,{toJSON:{name:"toJSON",j:[Dl(null,!0)]}}),Kl(qo.prototype,{toJSON:{name:"toJSON",j:[Dl(null,!0)]}}),Kl($o.prototype,{toJSON:{name:"toJSON",j:[Dl(null,!0)]}}),Kl(Jc.prototype,{toJSON:{name:"toJSON",j:[Dl(null,!0)]}}),Kl(Bc.prototype,{Pc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.ob}}]}}),Kl(eh.prototype,{Ob:{name:"getSession",j:[]},dc:{name:"enroll",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.ob}},Dl("displayName",!0)]},$c:{name:"unenroll",j:[ql({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Vl},Dl(),"multiFactorInfoIdentifier")]}}),Kl(Rl.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Gl(mr,"parseLink",kr,[Dl("link")]),Gl(vl,"assertion",function(t){return new Qc(t)},[jl("phone")]),function(){if("undefined"==typeof ib||!ib.INTERNAL||!ib.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:rr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:ir,VERIFY_AND_CHANGE_EMAIL:or,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:Jh,AuthCredential:ro,Error:E};Gl(t,"EmailAuthProvider",So,[]),Gl(t,"FacebookAuthProvider",mo,[]),Gl(t,"GithubAuthProvider",bo,[]),Gl(t,"GoogleAuthProvider",wo,[]),Gl(t,"TwitterAuthProvider",To,[]),Gl(t,"OAuthProvider",vo,[Dl("providerId")]),Gl(t,"SAMLAuthProvider",po,[Dl("providerId")]),Gl(t,"PhoneAuthProvider",Co,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(t){return!!(t&&t instanceof Jh)}}]),Gl(t,"RecaptchaVerifier",Rl,[ql(Dl(),{name:"",J:"an HTML element",optional:!1,K:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Ml("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(t){return!!(t&&t instanceof ib.app.App)}}]),Gl(t,"ActionCodeURL",mr,[]),Gl(t,"PhoneMultiFactorGenerator",vl,[]),ib.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new Jh(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),ib.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:y((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:y(t.kc,t),addAuthTokenListener:y(t.bc,t),removeAuthTokenListener:y(t.Nc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),ib.registerVersion("@firebase/auth","0.14.7"),ib.INTERNAL.extendNamespace({User:hh})}()}).apply("undefined"!=typeof Rb?Rb:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var qd={},kj=(zd(),yd);function rF(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(qd,"__esModule",{value:!0});var sF=rF(pg),tF=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Bb(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:gj(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),uF=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return Nb(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),nv=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new tF(t)}}catch(r){}return new uF},$d=nv("localStorage"),Rk=nv("sessionStorage"),Jf=new gv("@firebase/database"),ov=function(){var e=1;return function(){return e++}}(),pv=function(e){var t=cv(e),r=new Uq;r.update(t);var n=r.digest();return Vq.encodeByteArray(n)},qg=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r="",n=0;n<e.length;n++){var i=e[n];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?r+=qg.apply(null,i):r+="object"==typeof i?Bb(i):i,r+=" "}return r},lj=null,vF=!0,Sk=function(e,t){cb(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Jf.logLevel=vb.VERBOSE,lj=Jf.log.bind(Jf),t&&Rk.set("logging_enabled",!0)):"function"==typeof e?lj=e:(lj=null,Rk.remove("logging_enabled"))},Lb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===vF&&(vF=!1,null===lj&&!0===Rk.get("logging_enabled")&&Sk(!0)),lj){var r=qg.apply(null,e);lj(r)}},rg=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Lb.apply(void 0,Df([e],t))}},Tk=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE INTERNAL ERROR: "+qg.apply(void 0,Df(e));Jf.error(r)},rd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE FATAL ERROR: "+qg.apply(void 0,Df(e));throw Jf.error(r),new Error(r)},Mb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE WARNING: "+qg.apply(void 0,Df(e));Jf.warn(r)},wF=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Mb("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},mj=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},xF=function(e){if(gd()||"complete"===document.readyState)e();else{var t=!1,r=function(){document.body?t||(t=!0,e()):setTimeout(r,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&r()}),window.attachEvent("onload",r))}},_d="[MIN_NAME]",Gd="[MAX_NAME]",af=function(e,t){if(e===t)return 0;if(e===_d||t===Gd)return-1;if(t===_d||e===Gd)return 1;var r=sv(e),n=sv(t);return null!==r?null!==n?r-n==0?e.length-t.length:r-n:-1:null!==n?1:e<t?-1:1},yF=function(e,t){return e===t?0:e<t?-1:1},sg=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Bb(t))},Uk=function(e){if("object"!=typeof e||null===e)return Bb(e);var t=[];for(var r in e)t.push(r);t.sort();for(var n="{",i=0;i<t.length;i++)0!==i&&(n+=","),n+=Bb(t[i]),n+=":",n+=Uk(e[t[i]]);return n+="}"},qv=function(e,t){var r=e.length;if(r<=t)return[e];for(var n=[],i=0;i<r;i+=t)i+t>r?n.push(e.substring(i,r)):n.push(e.substring(i,i+t));return n};function Db(e,t){for(var r in e)e.hasOwnProperty(r)&&t(r,e[r])}var rv=function(e){cb(!mj(e),"Invalid JSON number");var t,r,n,i,a;0===e?(r=0,n=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(r=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,n=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(r=0,n=Math.round(e/Math.pow(2,-1074))));var o=[];for(a=52;a;a-=1)o.push(n%2?1:0),n=Math.floor(n/2);for(a=11;a;a-=1)o.push(r%2?1:0),r=Math.floor(r/2);o.push(t?1:0),o.reverse();var s=o.join(""),v="";for(a=0;a<64;a+=8){var l=parseInt(s.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),v+=l}return v.toLowerCase()},zF=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},AF=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},BF=function(e,t){var r="Unknown Error";"too_big"===e?r="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?r="Client doesn't have permission to access the desired data.":"unavailable"===e&&(r="The service is unavailable");var n=new Error(e+" at "+t.path.toString()+": "+r);return n.code=e.toUpperCase(),n},CF=new RegExp("^-?(0*)\\d{1,10}$"),sv=function(e){if(CF.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Kf=function(e){try{e()}catch(t){setTimeout(function(){var e=t.stack||"";throw Mb("Exception was thrown by user callback.",e),t},Math.floor(0))}},DF=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},tg=function(e,t){var r=setTimeout(e,t);return"object"==typeof r&&r.unref&&r.unref(),r},db=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var r=0,n=0;n<this.pieces_.length;n++)this.pieces_[n].length>0&&(this.pieces_[r]=this.pieces_[n],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:!0,configurable:!0}),e.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},e.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},e.prototype.popFront=function(){var t=this.pieceNum_;return t<this.pieces_.length&&t++,new e(this.pieces_,t)},e.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},e.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},e.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var t=[],r=this.pieceNum_;r<this.pieces_.length-1;r++)t.push(this.pieces_[r]);return new e(t,0)},e.prototype.child=function(t){for(var r=[],n=this.pieceNum_;n<this.pieces_.length;n++)r.push(this.pieces_[n]);if(t instanceof e)for(n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);else{var i=t.split("/");for(n=0;n<i.length;n++)i[n].length>0&&r.push(i[n])}return new e(r,0)},e.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},e.relativePath=function(t,r){var n=t.getFront(),i=r.getFront();if(null===n)return r;if(n===i)return e.relativePath(t.popFront(),r.popFront());throw new Error("INTERNAL ERROR: innerPath ("+r+") is not within outerPath ("+t+")")},e.comparePaths=function(e,t){for(var r=e.slice(),n=t.slice(),i=0;i<r.length&&i<n.length;i++){var a=af(r[i],n[i]);if(0!==a)return a}return r.length===n.length?0:r.length<n.length?-1:1},e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,r=e.pieceNum_;t<=this.pieces_.length;t++,r++)if(this.pieces_[t]!==e.pieces_[r])return!1;return!0},e.prototype.contains=function(e){var t=this.pieceNum_,r=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0},e}(),EF=function(){function e(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=mg(this.parts_[r]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=mg(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=mg(e),this.parts_.length>0&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}(),tv="5",uv="f",vv="firebaseio.com",wv="websocket",xv="long_polling",yv=function(){function e(e,t,r,n,i,a){void 0===i&&(i=""),void 0===a&&(a=!1),this.secure=t,this.namespace=r,this.webSocketOnly=n,this.persistenceKey=i,this.includeNamespaceInQueryParams=a,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=$d.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&$d.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){var r;if(cb("string"==typeof e,"typeof type must == string"),cb("object"==typeof t,"typeof params must == object"),e===wv)r=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==xv)throw new Error("Unknown connection type: "+e);r=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var n=[];return Db(t,function(e,t){n.push(e+"="+t)}),r+n.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}();function FF(e){for(var t="",r=e.split("/"),n=0;n<r.length;n++)if(r[n].length>0){var i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}function GF(e){var t,r,n={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=Kb(e.split("&")),a=i.next();!a.done;a=i.next()){var o=a.value;if(0!==o.length){var s=o.split("=");2===s.length?n[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Mb("Invalid query segment '"+o+"' in query '"+e+"'")}}}catch(v){t={error:v}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n}var Vk,zv,Wk=function(e){var t=HF(e),r=t.namespace;"firebase.com"===t.domain&&rd(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===t.domain||rd("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||wF();var n="ws"===t.scheme||"wss"===t.scheme;return{repoInfo:new yv(t.host,t.secure,r,n,"",r!==t.subdomain),path:new db(t.pathString)}},HF=function(e){var t="",r="",n="",i="",a="",o=!0,s="https",v=443;if("string"==typeof e){var l=e.indexOf("//");l>=0&&(s=e.substring(0,l-1),e=e.substring(l+2));var u=e.indexOf("/");-1===u&&(u=e.length);var $=e.indexOf("?");-1===$&&($=e.length),t=e.substring(0,Math.min(u,$)),u<$&&(i=FF(e.substring(u,$)));var h=GF(e.substring(Math.min(e.length,$)));(l=t.indexOf(":"))>=0?(o="https"===s||"wss"===s,v=parseInt(t.substring(l+1),10)):l=t.length;var c=t.slice(0,l);if("localhost"===c.toLowerCase())r="localhost";else if(c.split(".").length<=2)r=c;else{var p=t.indexOf(".");n=t.substring(0,p).toLowerCase(),r=t.substring(p+1),a=n}"ns"in h&&(a=h.ns)}return{host:t,port:v,domain:r,subdomain:n,secure:o,scheme:s,pathString:i,namespace:a}},IF=/[\[\].#$\/\u0000-\u001F\u007F]/,JF=/[\[\].#$\u0000-\u001F\u007F]/,Xk=10485760,nj=function(e){return"string"==typeof e&&0!==e.length&&!IF.test(e)},Av=function(e){return"string"==typeof e&&0!==e.length&&!JF.test(e)},KF=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Av(e)},ug=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!mj(e)||e&&"object"==typeof e&&Nb(e,".sv")},Hd=function(e,t,r,n,i){i&&void 0===r||vg(_b(e,t,i),r,n)},vg=function(e,t,r){var n=r instanceof db?new EF(r,e):r;if(void 0===t)throw new Error(e+"contains undefined "+n.toErrorString());if("function"==typeof t)throw new Error(e+"contains a function "+n.toErrorString()+" with contents = "+t.toString());if(mj(t))throw new Error(e+"contains "+t.toString()+" "+n.toErrorString());if("string"==typeof t&&t.length>Xk/3&&mg(t)>Xk)throw new Error(e+"contains a string greater than "+Xk+" utf8 bytes "+n.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,a=!1;if(Db(t,function(t,r){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(a=!0,!nj(t)))throw new Error(e+" contains an invalid key ("+t+") "+n.toErrorString()+".  Keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"");n.push(t),vg(e,r,n),n.pop()}),i&&a)throw new Error(e+" contains \".value\" child "+n.toErrorString()+" in addition to actual children.")}},LF=function(e,t){var r,n;for(r=0;r<t.length;r++)for(var i=(n=t[r]).slice(),a=0;a<i.length;a++)if(".priority"===i[a]&&a===i.length-1);else if(!nj(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+n.toString()+". Keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"");t.sort(db.comparePaths);var o=null;for(r=0;r<t.length;r++){if(n=t[r],null!==o&&o.contains(n))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+n.toString());o=n}},Bv=function(e,t,r,n,i){if(!i||void 0!==r){var a=_b(e,t,i);if(!r||"object"!=typeof r||Array.isArray(r))throw new Error(a+" must be an object containing the children to replace.");var o=[];Db(r,function(e,t){var r=new db(e);if(vg(a,t,n.child(r)),".priority"===r.getBack()&&!ug(t))throw new Error(a+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(r)}),LF(a,o)}},Yk=function(e,t,r,n){if(!n||void 0!==r){if(mj(r))throw new Error(_b(e,t,n)+"is "+r.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ug(r))throw new Error(_b(e,t,n)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Zk=function(e,t,r,n){if(!n||void 0!==r)switch(r){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(_b(e,t,n)+"must be a valid event type = \"value\", \"child_added\", \"child_removed\", \"child_changed\", or \"child_moved\".");}},$k=function(e,t,r,n){if(!(n&&void 0===r||nj(r)))throw new Error(_b(e,t,n)+"was an invalid key = \""+r+"\".  Firebase keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").")},wg=function(e,t,r,n){if(!(n&&void 0===r||Av(r)))throw new Error(_b(e,t,n)+"was an invalid path = \""+r+"\". Paths must be non-empty strings and can't contain \".\", \"#\", \"$\", \"[\", or \"]\"")},MF=function(e,t,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),wg(e,t,r,n)},Yb=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")},Cv=function(e,t,r){var n=r.path.toString();if("string"!=typeof r.repoInfo.host||0===r.repoInfo.host.length||!nj(r.repoInfo.namespace)&&"localhost"!==r.repoInfo.host.split(":")[0]||0!==n.length&&!KF(n))throw new Error(_b(e,t,!1)+"must be a valid firebase URL and the path can't contain \".\", \"#\", \"$\", \"[\", or \"]\".")},NF=function(e,t,r,n){if((!n||void 0!==r)&&"boolean"!=typeof r)throw new Error(_b(e,t,n)+"must be a boolean.")},Dv=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){fb("OnDisconnect.cancel",0,1,arguments.length),Cb("OnDisconnect.cancel",1,e,!0);var t=new Sb;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){fb("OnDisconnect.remove",0,1,arguments.length),Yb("OnDisconnect.remove",this.path_),Cb("OnDisconnect.remove",1,e,!0);var t=new Sb;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){fb("OnDisconnect.set",1,2,arguments.length),Yb("OnDisconnect.set",this.path_),Hd("OnDisconnect.set",1,e,this.path_,!1),Cb("OnDisconnect.set",2,t,!0);var r=new Sb;return this.repo_.onDisconnectSet(this.path_,e,r.wrapCallback(t)),r.promise},e.prototype.setWithPriority=function(e,t,r){fb("OnDisconnect.setWithPriority",2,3,arguments.length),Yb("OnDisconnect.setWithPriority",this.path_),Hd("OnDisconnect.setWithPriority",1,e,this.path_,!1),Yk("OnDisconnect.setWithPriority",2,t,!1),Cb("OnDisconnect.setWithPriority",3,r,!0);var n=new Sb;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,n.wrapCallback(r)),n.promise},e.prototype.update=function(e,t){if(fb("OnDisconnect.update",1,2,arguments.length),Yb("OnDisconnect.update",this.path_),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,Mb("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Bv("OnDisconnect.update",1,e,this.path_,!1),Cb("OnDisconnect.update",2,t,!0);var i=new Sb;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},e}(),OF=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return fb("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),PF=function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,r=[];return function(n){var i,a=n===t;t=n;var o=new Array(8);for(i=7;i>=0;i--)o[i]=e.charAt(n%64),n=Math.floor(n/64);cb(0===n,"Cannot push at time == 0");var s=o.join("");if(a){for(i=11;i>=0&&63===r[i];i--)r[i]=0;r[i]++}else for(i=0;i<12;i++)r[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)s+=e.charAt(r[i]);return cb(20===s.length,"nextPushId: Length should be 20."),s}}(),mb=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,r){return new e(t,r)},e}(),oj=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var r=new mb(_d,e),n=new mb(_d,t);return 0!==this.compare(r,n)},e.prototype.minPost=function(){return mb.MIN},e}(),Ev=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $b(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return Vk},set:function(e){Vk=e},enumerable:!0,configurable:!0}),t.prototype.compare=function(e,t){return af(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Ef("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return mb.MIN},t.prototype.maxPost=function(){return new mb(Gd,Vk)},t.prototype.makePost=function(e,t){return cb("string"==typeof e,"KeyIndex indexValue must always be a string."),new mb(e,Vk)},t.prototype.toString=function(){return".key"},t}(oj),Id=new Ev;function QF(e){zv=e}var RF,SF,TF,Fv=function(e){return"number"==typeof e?"number:"+rv(e):"string:"+e},Gv=function(e){if(e.isLeafNode()){var t=e.val();cb("string"==typeof t||"number"==typeof t||"object"==typeof t&&Nb(t,".sv"),"Priority must be a string or number.")}else cb(e===zv||e.isEmpty(),"priority of unexpected type.");cb(e===zv||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Lf=function(){function e(t,r){void 0===r&&(r=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=r,this.lazyHash_=null,cb(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Gv(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return RF},set:function(e){RF=e},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,r){var n=t.getFront();return null===n?r:r.isEmpty()&&".priority"!==n?this:(cb(".priority"!==n||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(n,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),r)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Fv(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?rv(this.value_):this.value_,this.lazyHash_=pv(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(cb(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var r=typeof t.value_,n=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(r),a=e.VALUE_TYPE_ORDER.indexOf(n);return cb(i>=0,"Unknown leaf type: "+r),cb(a>=0,"Unknown leaf type: "+n),i===a?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();function UF(e){SF=e}function VF(e){TF=e}var WF,pj,XF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $b(t,e),t.prototype.compare=function(e,t){var r=e.node.getPriority(),n=t.node.getPriority(),i=r.compareTo(n);return 0===i?af(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return mb.MIN},t.prototype.maxPost=function(){return new mb(Gd,new Lf("[PRIORITY-POST]",TF))},t.prototype.makePost=function(e,t){var r=SF(e);return new mb(t,new Lf("[PRIORITY-POST]",r))},t.prototype.toString=function(){return".priority"},t}(oj),rb=new XF,qj=function(){function e(e,t,r,n,i){void 0===i&&(i=null),this.isReverse_=n,this.resultGenerator_=i,this.nodeStack_=[];for(var a=1;!e.isEmpty();)if(e=e,a=t?r(e.key,t):1,n&&(a*=-1),a<0)e=this.isReverse_?e.left:e.right;else{if(0===a){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),bd=function(){function e(t,r,n,i,a){this.key=t,this.value=r,this.color=null!=n?n:e.RED,this.left=null!=i?i:sd.EMPTY_NODE,this.right=null!=a?a:sd.EMPTY_NODE}return e.prototype.copy=function(t,r,n,i,a){return new e(null!=t?t:this.key,null!=r?r:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=a?a:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,r){var n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return sd.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var r,n;if(t(e,(r=this).key)<0)r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()||(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),r.right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()||(r=r.moveRedRight_()),0===t(e,r.key)){if(r.right.isEmpty())return sd.EMPTY_NODE;n=r.right.min_(),r=r.copy(n.key,n.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),YF=function(){function e(){}return e.prototype.copy=function(e,t,r,n,i){return this},e.prototype.insert=function(e,t,r){return new bd(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),sd=function(){function e(t,r){void 0===r&&(r=e.EMPTY_NODE),this.comparator_=t,this.root_=r}return e.prototype.insert=function(t,r){return new e(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,bd.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,bd.BLACK,null,null))},e.prototype.get=function(e){for(var t,r=this.root_;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key)))return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,r=this.root_,n=null;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key))){if(r.left.isEmpty())return n?n.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(n=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new qj(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new qj(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new qj(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new qj(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new YF,e}(),ZF=Math.log(2),$F=function(){function e(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/ZF,10)),this.current_=this.count-1;var r,n=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=e+1&n}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),rj=function(e,t,r,n){e.sort(t);var i=function(t,n){var a,o,s=n-t;if(0===s)return null;if(1===s)return a=e[t],o=r?r(a):a,new bd(o,a.node,bd.BLACK,null,null);var v=parseInt(s/2,10)+t,l=i(t,v),u=i(v+1,n);return a=e[v],o=r?r(a):a,new bd(o,a.node,bd.BLACK,l,u)},a=function(t){for(var n=null,a=null,o=e.length,s=function(t,n){var a=o-t,s=o;o-=t;var l=i(a+1,s),u=e[a],$=r?r(u):u;v(new bd($,u.node,n,null,l))},v=function(e){n?(n.left=e,n=e):(a=e,n=e)},l=0;l<t.count;++l){var u=t.nextBitIsOne(),$=Math.pow(2,t.count-(l+1));u?s($,bd.BLACK):(s($,bd.BLACK),s($,bd.RED))}return a}(new $F(e.length));return new sd(n||t,a)},Mf={},sj=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return cb(Mf&&rb,"ChildrenNode.ts has not been loaded"),WF=WF||new e({".priority":Mf},{".priority":rb})},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var t=Xb(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof sd?t:null},e.prototype.hasIndex=function(e){return Nb(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,r){cb(t!==Id,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,i=[],a=!1,o=r.getIterator(mb.Wrap),s=o.getNext();s;)a=a||t.isDefinedOn(s.node),i.push(s),s=o.getNext();n=a?rj(i,t.getCompare()):Mf;var v=t.toString(),l=Zd({},this.indexSet_);l[v]=t;var u=Zd({},this.indexes_);return u[v]=n,new e(u,l)},e.prototype.addToIndexes=function(t,r){var n=this;return new e(lg(this.indexes_,function(e,i){var a=Xb(n.indexSet_,i);if(cb(a,"Missing index implementation for "+i),e===Mf){if(a.isDefinedOn(t.node)){for(var o=[],s=r.getIterator(mb.Wrap),v=s.getNext();v;)v.name!==t.name&&o.push(v),v=s.getNext();return o.push(t),rj(o,a.getCompare())}return Mf}var l=r.get(t.name),u=e;return l&&(u=u.remove(new mb(t.name,l))),u.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,r){return new e(lg(this.indexes_,function(e){if(e===Mf)return e;var n=r.get(t.name);return n?e.remove(new mb(t.name,n)):e}),this.indexSet_)},e}();function _F(e,t){return af(e.name,t.name)}function _k(e,t){return af(e,t)}var hb=function(){function e(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Gv(this.priorityNode_),this.children_.isEmpty()&&cb(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return pj||(pj=new e(new sd(_k),null,sj.Default))},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||pj},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?pj:t},e.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,r){if(cb(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);var n=new mb(t,r),i=void 0,a=void 0;r.isEmpty()?(i=this.children_.remove(t),a=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(t,r),a=this.indexMap_.addToIndexes(n,this.children_));var o=i.isEmpty()?pj:this.priorityNode_;return new e(i,o,a)},e.prototype.updateChild=function(e,t){var r=e.getFront();if(null===r)return t;cb(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var n=this.getImmediateChild(r).updateChild(e.popFront(),t);return this.updateImmediateChild(r,n)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var r={},n=0,i=0,a=!0;if(this.forEachChild(rb,function(o,s){r[o]=s.val(t),n++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1}),!t&&a&&i<2*n){var o=[];for(var s in r)o[s]=r[s];return o}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Fv(this.getPriority().val())+":"),this.forEachChild(rb,function(t,r){var n=r.hash();""!==n&&(e+=":"+t+":"+n)}),this.lazyHash_=""===e?"":pv(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,r){var n=this.resolveIndex_(r);if(n){var i=n.getPredecessorKey(new mb(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.minKey();return r&&r.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new mb(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.maxKey();return r&&r.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new mb(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var r=this.resolveIndex_(e);return r?r.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,function(e){return e});for(var n=this.children_.getIteratorFrom(e.name,mb.Wrap),i=n.peek();null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,function(e){return e});for(var n=this.children_.getReverseIteratorFrom(e.name,mb.Wrap),i=n.peek();null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===xg?-1:0},e.prototype.withIndex=function(t){if(t===Id||this.indexMap_.hasIndex(t))return this;var r=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,r)},e.prototype.isIndexed=function(e){return e===Id||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var r=this.getIterator(rb),n=t.getIterator(rb),i=r.getNext(),a=n.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=r.getNext(),a=n.getNext()}return null===i&&null===a}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===Id?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),aG=function(e){function t(){return e.call(this,new sd(_k),hb.EMPTY_NODE,sj.Default)||this}return $b(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return hb.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(hb),xg=new aG;Object.defineProperties(mb,{MIN:{value:new mb(_d,hb.EMPTY_NODE)},MAX:{value:new mb(Gd,xg)}}),Ev.__EMPTY_NODE=hb.EMPTY_NODE,Lf.__childrenNodeConstructor=hb,QF(xg),VF(xg);var bG=!0;function zb(e,t){if(void 0===t&&(t=null),null===e)return hb.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),cb(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Lf(e,zb(t));if(e instanceof Array||!bG){var r=hb.EMPTY_NODE;return Db(e,function(t,n){if(Nb(e,t)&&"."!==t.substring(0,1)){var i=zb(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(t,i))}}),r.updatePriority(zb(t))}var n=[],i=!1;if(Db(e,function(e,t){if("."!==e.substring(0,1)){var r=zb(t);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new mb(e,r)))}}),0===n.length)return hb.EMPTY_NODE;var a=rj(n,_F,function(e){return e.name},_k);if(i){var o=rj(n,rb.getCompare());return new hb(a,zb(t),new sj({".priority":o},{".priority":rb}))}return new hb(a,zb(t),sj.Default)}UF(zb);var Hv,cG=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return $b(t,e),t.prototype.compare=function(e,t){var r=e.node.compareTo(t.node);return 0===r?af(e.name,t.name):r},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return mb.MIN},t.prototype.maxPost=function(){return mb.MAX},t.prototype.makePost=function(e,t){var r=zb(e);return new mb(t,r)},t.prototype.toString=function(){return".value"},t}(oj),zl=new cG,Jl=function(e){function t(t){var r=e.call(this)||this;return r.indexPath_=t,cb(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),r}return $b(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var r=this.extractChild(e.node),n=this.extractChild(t.node),i=r.compareTo(n);return 0===i?af(e.name,t.name):i},t.prototype.makePost=function(e,t){var r=zb(e),n=hb.EMPTY_NODE.updateChild(this.indexPath_,r);return new mb(t,n)},t.prototype.maxPost=function(){var e=hb.EMPTY_NODE.updateChild(this.indexPath_,xg);return new mb(Gd,e)},t.prototype.toString=function(){return this.indexPath_.slice().join("/")},t}(oj),bf=function(){function e(e,t,r){this.node_=e,this.ref_=t,this.index_=r}return e.prototype.val=function(){return fb("DataSnapshot.val",0,0,arguments.length),this.node_.val()},e.prototype.exportVal=function(){return fb("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},e.prototype.toJSON=function(){return fb("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return fb("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},e.prototype.child=function(t){fb("DataSnapshot.child",0,1,arguments.length),t=String(t),wg("DataSnapshot.child",1,t,!1);var r=new db(t),n=this.ref_.child(r);return new e(this.node_.getChild(r),n,rb)},e.prototype.hasChild=function(e){fb("DataSnapshot.hasChild",1,1,arguments.length),wg("DataSnapshot.hasChild",1,e,!1);var t=new db(e);return!this.node_.getChild(t).isEmpty()},e.prototype.getPriority=function(){return fb("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},e.prototype.forEach=function(t){var r=this;return fb("DataSnapshot.forEach",1,1,arguments.length),Cb("DataSnapshot.forEach",1,t,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(n,i){return t(new e(i,r.ref_.child(n),rb))})},e.prototype.hasChildren=function(){return fb("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return fb("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},e.prototype.getRef=function(){return fb("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),Iv=function(){function e(e,t,r,n){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=n}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Bb(this.snapshot.exportVal())},e}(),Jv=function(){function e(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),Kv=function(){function e(e,t,r){this.callback_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var r=t.getQueryParams().getIndex();return new Iv("value",this,new bf(e.snapshotNode,t.getRef(),r))},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){cb(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callback_;return function(){n.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Jv(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}(),Lv=function(){function e(e,t,r){this.callbacks_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,Nb(this.callbacks_,t)},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Jv(this,e,t):null},e.prototype.createEvent=function(e,t){cb(null!=e.childName,"Child events should have a childName.");var r=t.getRef().child(e.childName),n=t.getQueryParams().getIndex();return new Iv(e.type,this,new bf(e.snapshotNode,r,n),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){cb(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callbacks_[e.eventType];return function(){n.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){var r=this;if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var n=Object.keys(t.callbacks_),i=Object.keys(this.callbacks_),a=n.length;if(a===i.length){if(1===a){var o=n[0],s=i[0];return!(s!==o||t.callbacks_[o]&&this.callbacks_[s]&&t.callbacks_[o]!==this.callbacks_[s])}return i.every(function(e){return t.callbacks_[e]===r.callbacks_[e]})}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks_},e}(),tj=function(){function e(e,t,r,n){this.repo=e,this.path=t,this.queryParams_=r,this.orderByCalled_=n}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return cb(Hv,"Reference.ts has not been loaded"),Hv},set:function(e){Hv=e},enumerable:!0,configurable:!0}),e.validateQueryEndpoints_=function(e){var t=null,r=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(r=e.getIndexEndValue()),e.getIndex()===Id){var n="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==_d)throw new Error(n);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==Gd)throw new Error(n);if("string"!=typeof r)throw new Error(i)}}else if(e.getIndex()===rb){if(null!=t&&!ug(t)||null!=r&&!ug(r))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(cb(e.getIndex()instanceof Jl||e.getIndex()===zl,"unknown index type."),null!=t&&"object"==typeof t||null!=r&&"object"==typeof r)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.queryParams_},e.prototype.getRef=function(){return fb("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,r,n,i){fb("Query.on",2,4,arguments.length),Zk("Query.on",1,t,!1),Cb("Query.on",2,r,!1);var a=e.getCancelAndContextArgs_("Query.on",n,i);if("value"===t)this.onValueEvent(r,a.cancel,a.context);else{var o={};o[t]=r,this.onChildEvent(o,a.cancel,a.context)}return r},e.prototype.onValueEvent=function(e,t,r){var n=new Kv(e,t||null,r||null);this.repo.addEventCallbackForQuery(this,n)},e.prototype.onChildEvent=function(e,t,r){var n=new Lv(e,t,r);this.repo.addEventCallbackForQuery(this,n)},e.prototype.off=function(e,t,r){fb("Query.off",0,3,arguments.length),Zk("Query.off",1,e,!0),Cb("Query.off",2,t,!0),Nk("Query.off",3,r,!0);var n=null,i=null;"value"===e?n=new Kv(t||null,null,r||null):e&&(t&&((i={})[e]=t),n=new Lv(i,null,r||null));this.repo.removeEventCallbackForQuery(this,n)},e.prototype.once=function(t,r,n,i){var a=this;fb("Query.once",1,4,arguments.length),Zk("Query.once",1,t,!1),Cb("Query.once",2,r,!0);var o=e.getCancelAndContextArgs_("Query.once",n,i),s=!0,v=new Sb;v.promise.catch(function(){});var l=function(e){s&&(s=!1,a.off(t,l),r&&r.bind(o.context)(e),v.resolve(e))};return this.on(t,l,function(e){a.off(t,l),o.cancel&&o.cancel.bind(o.context)(e),v.reject(e)}),v.promise},e.prototype.limitToFirst=function(t){if(fb("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},e.prototype.limitToLast=function(t){if(fb("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)},e.prototype.orderByChild=function(t){if(fb("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error("Query.orderByChild: \"$key\" is invalid.  Use Query.orderByKey() instead.");if("$priority"===t)throw new Error("Query.orderByChild: \"$priority\" is invalid.  Use Query.orderByPriority() instead.");if("$value"===t)throw new Error("Query.orderByChild: \"$value\" is invalid.  Use Query.orderByValue() instead.");wg("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var r=new db(t);if(r.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var n=new Jl(r),i=this.queryParams_.orderBy(n);return e.validateQueryEndpoints_(i),new e(this.repo,this.path,i,!0)},e.prototype.orderByKey=function(){fb("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(Id);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){fb("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(rb);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){fb("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(zl);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,r){void 0===t&&(t=null),fb("Query.startAt",0,2,arguments.length),Hd("Query.startAt",1,t,this.path,!0),$k("Query.startAt",2,r,!0);var n=this.queryParams_.startAt(t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,r=null),new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.endAt=function(t,r){void 0===t&&(t=null),fb("Query.endAt",0,2,arguments.length),Hd("Query.endAt",1,t,this.path,!0),$k("Query.endAt",2,r,!0);var n=this.queryParams_.endAt(t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.equalTo=function(e,t){if(fb("Query.equalTo",1,2,arguments.length),Hd("Query.equalTo",1,e,this.path,!1),$k("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return fb("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},e.prototype.toJSON=function(){return fb("Query.toJSON",0,1,arguments.length),this.toString()},e.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=Uk(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if(fb("Query.isEqual",1,1,arguments.length),!(t instanceof e)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var r=this.repo===t.repo,n=this.path.equals(t.path),i=this.queryIdentifier()===t.queryIdentifier();return r&&n&&i},e.getCancelAndContextArgs_=function(e,t,r){var n={cancel:null,context:null};if(t&&r)n.cancel=t,Cb(e,3,n.cancel,!0),n.context=r,Nk(e,4,n.context,!0);else if(t)if("object"==typeof t&&null!==t)n.context=t;else{if("function"!=typeof t)throw new Error(_b(e,3,!0)+" must either be a cancel callback or a context object.");n.cancel=t}return n},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),dG=function(){function e(e){this.node_=e}return e.prototype.getImmediateChild=function(t){return new e(this.node_.getImmediateChild(t))},e.prototype.node=function(){return this.node_},e}(),eG=function(){function e(e,t){this.syncTree_=e,this.path_=t}return e.prototype.getImmediateChild=function(t){var r=this.path_.child(t);return new e(this.syncTree_,r)},e.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},e}(),fG=function(e){return(e=e||{}).timestamp=e.timestamp||new Date().getTime(),e},Mv=function(e,t,r){return e&&"object"==typeof e?(cb(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?gG(e[".sv"],t,r):"object"==typeof e[".sv"]?hG(e[".sv"],t):void cb(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},gG=function(e,t,r){switch(e){case"timestamp":return r.timestamp;default:cb(!1,"Unexpected server value: "+e);}},hG=function(e,t,r){e.hasOwnProperty("increment")||cb(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var n=e.increment;"number"!=typeof n&&cb(!1,"Unexpected increment value: "+n);var i=t.node();if(cb(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;var a=i.getValue();return"number"!=typeof a?n:a+n},Nv=function(e,t,r,n){return Wl(t,new eG(r,e),n)},Ql=function(e,t,r){return Wl(e,new dG(t),r)};function Wl(e,t,r){var n,i=e.getPriority().val(),a=Mv(i,t.getImmediateChild(".priority"),r);if(e.isLeafNode()){var o=e,s=Mv(o.getValue(),t,r);return s!==o.getValue()||a!==o.getPriority().val()?new Lf(s,zb(a)):e}var v=e;return n=v,a!==v.getPriority().val()&&(n=n.updatePriority(new Lf(a))),v.forEachChild(rb,function(e,i){var a=Wl(i,t.getImmediateChild(e),r);a!==i&&(n=n.updateImmediateChild(e,a))}),n}var hd,Xl=function(){function e(){this.value=null,this.children=new Map}return e.prototype.find=function(e){if(null!=this.value)return this.value.getChild(e);if(!e.isEmpty()&&this.children.size>0){var t=e.getFront();return e=e.popFront(),this.children.has(t)?this.children.get(t).find(e):null}return null},e.prototype.remember=function(t,r){if(t.isEmpty())this.value=r,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(t,r);else{var n=t.getFront();this.children.has(n)||this.children.set(n,new e);var i=this.children.get(n);t=t.popFront(),i.remember(t,r)}},e.prototype.forget=function(e){if(e.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var t=this.value;this.value=null;var r=this;return t.forEachChild(rb,function(e,t){r.remember(new db(e),t)}),this.forget(e)}if(this.children.size>0){var n=e.getFront();if(e=e.popFront(),this.children.has(n))this.children.get(n).forget(e)&&this.children.delete(n);return 0===this.children.size}return!0},e.prototype.forEachTree=function(e,t){null!==this.value?t(e,this.value):this.forEachChild(function(r,n){var i=new db(e.toString()+"/"+r);n.forEachTree(i,t)})},e.prototype.forEachChild=function(e){this.children.forEach(function(t,r){e(r,t)})},e}();!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(hd||(hd={}));var Ov,Yl,td=function(){function e(e,t,r,n){this.fromUser=e,this.fromServer=t,this.queryId=r,this.tagged=n,cb(!n||t,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}(),iG=function(){function e(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=hd.ACK_USER_WRITE,this.source=td.User}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return cb(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var r=this.affectedTree.subtree(new db(t));return new e(db.Empty,r,this.revert)}return cb(this.path.getFront()===t,"operationForChild called for unrelated child."),new e(this.path.popFront(),this.affectedTree,this.revert)},e}(),jG=function(){return Ov||(Ov=new sd(yF)),Ov},Tb=function(){function e(e,t){void 0===t&&(t=jG()),this.value=e,this.children=t}return e.fromObject=function(t){var r=e.Empty;return Db(t,function(e,t){r=r.set(new db(e),t)}),r},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:db.Empty,value:this.value};if(e.isEmpty())return null;var r=e.getFront(),n=this.children.get(r);if(null!==n){var i=n.findRootMostMatchingPathAndValue(e.popFront(),t);return null!=i?{path:new db(r).child(i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(t.isEmpty())return this;var r=t.getFront(),n=this.children.get(r);return null!==n?n.subtree(t.popFront()):e.Empty},e.prototype.set=function(t,r){if(t.isEmpty())return new e(r,this.children);var n=t.getFront(),i=(this.children.get(n)||e.Empty).set(t.popFront(),r),a=this.children.insert(n,i);return new e(this.value,a)},e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var r=t.getFront(),n=this.children.get(r);if(n){var i=n.remove(t.popFront()),a=void 0;return a=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),null===this.value&&a.isEmpty()?e.Empty:new e(this.value,a)}return this},e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),r=this.children.get(t);return r?r.get(e.popFront()):null},e.prototype.setTree=function(t,r){if(t.isEmpty())return r;var n=t.getFront(),i=(this.children.get(n)||e.Empty).setTree(t.popFront(),r),a=void 0;return a=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new e(this.value,a)},e.prototype.fold=function(e){return this.fold_(db.Empty,e)},e.prototype.fold_=function(e,t){var r={};return this.children.inorderTraversal(function(n,i){r[n]=i.fold_(e.child(n),t)}),t(e,this.value,r)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,db.Empty,t)},e.prototype.findOnPath_=function(e,t,r){var n=!!this.value&&r(t,this.value);if(n)return n;if(e.isEmpty())return null;var i=e.getFront(),a=this.children.get(i);return a?a.findOnPath_(e.popFront(),t.child(i),r):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,db.Empty,t)},e.prototype.foreachOnPath_=function(t,r,n){if(t.isEmpty())return this;this.value&&n(r,this.value);var i=t.getFront(),a=this.children.get(i);return a?a.foreachOnPath_(t.popFront(),r.child(i),n):e.Empty},e.prototype.foreach=function(e){this.foreach_(db.Empty,e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(r,n){n.foreach_(e.child(r),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,r){r.value&&e(t,r.value)})},e.Empty=new e(null),e}(),Pv=function(){function e(e,t){this.source=e,this.path=t,this.type=hd.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,db.Empty):new e(this.source,this.path.popFront())},e}(),uj=function(){function e(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=hd.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,db.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}(),Zl=function(){function e(e,t,r){this.source=e,this.path=t,this.children=r,this.type=hd.MERGE}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var r=this.children.subtree(new db(t));return r.isEmpty()?null:r.value?new uj(this.source,db.Empty,r.value):new e(this.source,db.Empty,r)}return cb(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,this.path.popFront(),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),ud=function(){function e(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),Qv=function(){function e(e,t){this.eventCache_=e,this.serverCache_=t}return e.prototype.updateEventSnap=function(t,r,n){return new e(new ud(t,r,n),this.serverCache_)},e.prototype.updateServerSnap=function(t,r,n){return new e(this.eventCache_,new ud(t,r,n))},e.prototype.getEventCache=function(){return this.eventCache_},e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},e.prototype.getServerCache=function(){return this.serverCache_},e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},e.Empty=new e(new ud(hb.EMPTY_NODE,!1,!1),new ud(hb.EMPTY_NODE,!1,!1)),e}(),jb=function(){function e(e,t,r,n,i){this.type=e,this.snapshotNode=t,this.childName=r,this.oldSnap=n,this.prevName=i}return e.valueChange=function(t){return new e(e.VALUE,t)},e.childAddedChange=function(t,r){return new e(e.CHILD_ADDED,r,t)},e.childRemovedChange=function(t,r){return new e(e.CHILD_REMOVED,r,t)},e.childChangedChange=function(t,r,n){return new e(e.CHILD_CHANGED,r,t,n)},e.childMovedChange=function(t,r){return new e(e.CHILD_MOVED,r,t)},e.CHILD_ADDED="child_added",e.CHILD_REMOVED="child_removed",e.CHILD_CHANGED="child_changed",e.CHILD_MOVED="child_moved",e.VALUE="value",e}(),am=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,r,n,i,a){cb(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var o=e.getImmediateChild(t);return o.getChild(n).equals(r.getChild(n))&&o.isEmpty()===r.isEmpty()?e:(null!=a&&(r.isEmpty()?e.hasChild(t)?a.trackChildChange(jb.childRemovedChange(t,o)):cb(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(jb.childAddedChange(t,r)):a.trackChildChange(jb.childChangedChange(t,r,o))),e.isLeafNode()&&r.isEmpty()?e:e.updateImmediateChild(t,r).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(rb,function(e,n){t.hasChild(e)||r.trackChildChange(jb.childRemovedChange(e,n))}),t.isLeafNode()||t.forEachChild(rb,function(t,n){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(n)||r.trackChildChange(jb.childChangedChange(t,n,i))}else r.trackChildChange(jb.childAddedChange(t,n))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?hb.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),kG=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,r=e.childName;cb(t===jb.CHILD_ADDED||t===jb.CHILD_CHANGED||t===jb.CHILD_REMOVED,"Only child changes supported for tracking"),cb(".priority"!==r,"Only non-priority child changes can be tracked.");var n=this.changeMap.get(r);if(n){var i=n.type;if(t===jb.CHILD_ADDED&&i===jb.CHILD_REMOVED)this.changeMap.set(r,jb.childChangedChange(r,e.snapshotNode,n.snapshotNode));else if(t===jb.CHILD_REMOVED&&i===jb.CHILD_ADDED)this.changeMap.delete(r);else if(t===jb.CHILD_REMOVED&&i===jb.CHILD_CHANGED)this.changeMap.set(r,jb.childRemovedChange(r,n.oldSnap));else if(t===jb.CHILD_CHANGED&&i===jb.CHILD_ADDED)this.changeMap.set(r,jb.childAddedChange(r,e.snapshotNode));else{if(t!==jb.CHILD_CHANGED||i!==jb.CHILD_CHANGED)throw Ef("Illegal combination of changes: "+e+" occurred after "+n);this.changeMap.set(r,jb.childChangedChange(r,e.snapshotNode,n.oldSnap))}}else this.changeMap.set(r,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),lG=function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,r){return null},e}(),Rv=new lG,bm=function(){function e(e,t,r){void 0===r&&(r=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var r=null!=this.optCompleteServerCache_?new ud(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,r)},e.prototype.getChildAfterChild=function(e,t,r){var n=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(n,t,1,r,e);return 0===i.length?null:i[0]},e}(),mG=function(){return function(e,t){this.viewCache=e,this.changes=t}}(),nG=function(){function e(e){this.filter_=e}return e.prototype.assertIndexed=function(e){cb(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),cb(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,r,n,i){var a,o,s=new kG;if(r.type===hd.OVERWRITE){var v=r;v.source.fromUser?a=this.applyUserOverwrite_(t,v.path,v.snap,n,i,s):(cb(v.source.fromServer,"Unknown source."),o=v.source.tagged||t.getServerCache().isFiltered()&&!v.path.isEmpty(),a=this.applyServerOverwrite_(t,v.path,v.snap,n,i,o,s))}else if(r.type===hd.MERGE){var l=r;l.source.fromUser?a=this.applyUserMerge_(t,l.path,l.children,n,i,s):(cb(l.source.fromServer,"Unknown source."),o=l.source.tagged||t.getServerCache().isFiltered(),a=this.applyServerMerge_(t,l.path,l.children,n,i,o,s))}else if(r.type===hd.ACK_USER_WRITE){var u=r;a=u.revert?this.revertUserWrite_(t,u.path,n,i,s):this.ackUserWrite_(t,u.path,u.affectedTree,n,i,s)}else{if(r.type!==hd.LISTEN_COMPLETE)throw Ef("Unknown operation type: "+r.type);a=this.listenComplete_(t,r.path,n,s)}var $=s.getChanges();return e.maybeAddValueEvent_(t,a,$),new mG(a,$)},e.maybeAddValueEvent_=function(e,t,r){var n=t.getEventCache();if(n.isFullyInitialized()){var i=n.getNode().isLeafNode()||n.getNode().isEmpty(),a=e.getCompleteEventSnap();(r.length>0||!e.getEventCache().isFullyInitialized()||i&&!n.getNode().equals(a)||!n.getNode().getPriority().equals(a.getPriority()))&&r.push(jb.valueChange(t.getCompleteEventSnap()))}},e.prototype.generateEventCacheAfterServerEvent_=function(e,t,r,n,i){var a=e.getEventCache();if(null!=r.shadowingWrite(t))return e;var o=void 0,s=void 0;if(t.isEmpty()){if(cb(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var v=e.getCompleteServerSnap(),l=v instanceof hb?v:hb.EMPTY_NODE,u=r.calcCompleteEventChildren(l);o=this.filter_.updateFullNode(e.getEventCache().getNode(),u,i)}else{var $=r.calcCompleteEventCache(e.getCompleteServerSnap());o=this.filter_.updateFullNode(e.getEventCache().getNode(),$,i)}}else{var h=t.getFront();if(".priority"===h){cb(1===t.getLength(),"Can't have a priority with additional path components");var c=a.getNode();s=e.getServerCache().getNode();var p=r.calcEventCacheAfterServerOverwrite(t,c,s);o=null!=p?this.filter_.updatePriority(c,p):a.getNode()}else{var d=t.popFront(),m=void 0;if(a.isCompleteForChild(h)){s=e.getServerCache().getNode();var _=r.calcEventCacheAfterServerOverwrite(t,a.getNode(),s);m=null!=_?a.getNode().getImmediateChild(h).updateChild(d,_):a.getNode().getImmediateChild(h)}else m=r.calcCompleteChild(h,e.getServerCache());o=null!=m?this.filter_.updateChild(a.getNode(),h,m,d,n,i):a.getNode()}}return e.updateEventSnap(o,a.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},e.prototype.applyServerOverwrite_=function(e,t,r,n,i,a,o){var s,v=e.getServerCache(),l=a?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())s=l.updateFullNode(v.getNode(),r,null);else if(l.filtersNodes()&&!v.isFiltered()){var u=v.getNode().updateChild(t,r);s=l.updateFullNode(v.getNode(),u,null)}else{var $=t.getFront();if(!v.isCompleteForPath(t)&&t.getLength()>1)return e;var h=t.popFront(),c=v.getNode().getImmediateChild($).updateChild(h,r);s=".priority"===$?l.updatePriority(v.getNode(),c):l.updateChild(v.getNode(),$,c,h,Rv,null)}var p=e.updateServerSnap(s,v.isFullyInitialized()||t.isEmpty(),l.filtersNodes()),d=new bm(n,p,i);return this.generateEventCacheAfterServerEvent_(p,t,n,d,o)},e.prototype.applyUserOverwrite_=function(e,t,r,n,i,a){var o,s,v=e.getEventCache(),l=new bm(n,e,i);if(t.isEmpty())s=this.filter_.updateFullNode(e.getEventCache().getNode(),r,a),o=e.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var u=t.getFront();if(".priority"===u)s=this.filter_.updatePriority(e.getEventCache().getNode(),r),o=e.updateEventSnap(s,v.isFullyInitialized(),v.isFiltered());else{var $=t.popFront(),h=v.getNode().getImmediateChild(u),c=void 0;if($.isEmpty())c=r;else{var p=l.getCompleteChild(u);c=null!=p?".priority"===$.getBack()&&p.getChild($.parent()).isEmpty()?p:p.updateChild($,r):hb.EMPTY_NODE}if(h.equals(c))o=e;else{var d=this.filter_.updateChild(v.getNode(),u,c,$,l,a);o=e.updateEventSnap(d,v.isFullyInitialized(),this.filter_.filtersNodes())}}}return o},e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.applyUserMerge_=function(t,r,n,i,a,o){var s=this,v=t;return n.foreach(function(n,l){var u=r.child(n);e.cacheHasChild_(t,u.getFront())&&(v=s.applyUserOverwrite_(v,u,l,i,a,o))}),n.foreach(function(n,l){var u=r.child(n);e.cacheHasChild_(t,u.getFront())||(v=s.applyUserOverwrite_(v,u,l,i,a,o))}),v},e.prototype.applyMerge_=function(e,t){return t.foreach(function(t,r){e=e.updateChild(t,r)}),e},e.prototype.applyServerMerge_=function(e,t,r,n,i,a,o){var s=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var v,l=e;v=t.isEmpty()?r:Tb.Empty.setTree(t,r);var u=e.getServerCache().getNode();return v.children.inorderTraversal(function(t,r){if(u.hasChild(t)){var v=e.getServerCache().getNode().getImmediateChild(t),$=s.applyMerge_(v,r);l=s.applyServerOverwrite_(l,new db(t),$,n,i,a,o)}}),v.children.inorderTraversal(function(t,r){var v=!e.getServerCache().isCompleteForChild(t)&&null==r.value;if(!u.hasChild(t)&&!v){var $=e.getServerCache().getNode().getImmediateChild(t),h=s.applyMerge_($,r);l=s.applyServerOverwrite_(l,new db(t),h,n,i,a,o)}}),l},e.prototype.ackUserWrite_=function(e,t,r,n,i,a){if(null!=n.shadowingWrite(t))return e;var o=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=r.value){if(t.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,s.getNode().getChild(t),n,i,o,a);if(t.isEmpty()){var v=Tb.Empty;return s.getNode().forEachChild(Id,function(e,t){v=v.set(new db(e),t)}),this.applyServerMerge_(e,t,v,n,i,o,a)}return e}var l=Tb.Empty;return r.foreach(function(e,r){var n=t.child(e);s.isCompleteForPath(n)&&(l=l.set(e,s.getNode().getChild(n)))}),this.applyServerMerge_(e,t,l,n,i,o,a)},e.prototype.listenComplete_=function(e,t,r,n){var i=e.getServerCache(),a=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(a,t,r,Rv,n)},e.prototype.revertUserWrite_=function(e,t,r,n,i){var a;if(null!=r.shadowingWrite(t))return e;var o=new bm(r,e,n),s=e.getEventCache().getNode(),v=void 0;if(t.isEmpty()||".priority"===t.getFront()){var l=void 0;if(e.getServerCache().isFullyInitialized())l=r.calcCompleteEventCache(e.getCompleteServerSnap());else{var u=e.getServerCache().getNode();cb(u instanceof hb,"serverChildren would be complete if leaf node"),l=r.calcCompleteEventChildren(u)}l=l,v=this.filter_.updateFullNode(s,l,i)}else{var $=t.getFront(),h=r.calcCompleteChild($,e.getServerCache());null==h&&e.getServerCache().isCompleteForChild($)&&(h=s.getImmediateChild($)),(v=null!=h?this.filter_.updateChild(s,$,h,t.popFront(),o,i):e.getEventCache().getNode().hasChild($)?this.filter_.updateChild(s,$,hb.EMPTY_NODE,t.popFront(),o,i):s).isEmpty()&&e.getServerCache().isFullyInitialized()&&(a=r.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(v=this.filter_.updateFullNode(v,a,i))}return a=e.getServerCache().isFullyInitialized()||null!=r.shadowingWrite(db.Empty),e.updateEventSnap(v,a,this.filter_.filtersNodes())},e}(),oG=function(){function e(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,r){var n=this,i=[],a=[];return e.forEach(function(e){e.type===jb.CHILD_CHANGED&&n.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&a.push(jb.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(i,jb.CHILD_REMOVED,e,r,t),this.generateEventsForType_(i,jb.CHILD_ADDED,e,r,t),this.generateEventsForType_(i,jb.CHILD_MOVED,a,r,t),this.generateEventsForType_(i,jb.CHILD_CHANGED,e,r,t),this.generateEventsForType_(i,jb.VALUE,e,r,t),i},e.prototype.generateEventsForType_=function(e,t,r,n,i){var a=this,o=r.filter(function(e){return e.type===t});o.sort(this.compareChanges_.bind(this)),o.forEach(function(t){var r=a.materializeSingleChange_(t,i);n.forEach(function(n){n.respondsTo(t.type)&&e.push(n.createEvent(r,a.query_))})})},e.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type?e:(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_),e)},e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw Ef("Should only compare child_ events.");var r=new mb(e.childName,e.snapshotNode),n=new mb(t.childName,t.snapshotNode);return this.index_.compare(r,n)},e}(),pG=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var r=this.query_.getQueryParams(),n=new am(r.getIndex()),i=r.getNodeFilter();this.processor_=new nG(i);var a=t.getServerCache(),o=t.getEventCache(),s=n.updateFullNode(hb.EMPTY_NODE,a.getNode(),null),v=i.updateFullNode(hb.EMPTY_NODE,o.getNode(),null),l=new ud(s,a.isFullyInitialized(),n.filtersNodes()),u=new ud(v,o.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Qv(u,l),this.eventGenerator_=new oG(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,t){var r=[];if(t){cb(null==e,"A cancel should cancel all event registrations.");var n=this.query_.path;this.eventRegistrations_.forEach(function(e){t=t;var i=e.createCancelEvent(t,n);i&&r.push(i)})}if(e){for(var i=[],a=0;a<this.eventRegistrations_.length;++a){var o=this.eventRegistrations_[a];if(o.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(a+1));break}}else i.push(o)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return r},e.prototype.applyOperation=function(e,t,r){e.type===hd.MERGE&&null!==e.source.queryId&&(cb(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),cb(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var n=this.viewCache_,i=this.processor_.applyOperation(n,e,t,r);return this.processor_.assertIndexed(i.viewCache),cb(i.viewCache.getServerCache().isFullyInitialized()||!n.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),r=[];t.getNode().isLeafNode()||t.getNode().forEachChild(rb,function(e,t){r.push(jb.childAddedChange(e,t))});return t.isFullyInitialized()&&r.push(jb.valueChange(t.getNode())),this.generateEventsForChanges_(r,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,r){var n=r?[r]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,n)},e}(),Sv=function(){function e(){this.views=new Map}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return cb(Yl,"Reference.ts has not been loaded"),Yl},set:function(e){cb(!Yl,"__referenceConstructor has already been defined"),Yl=e},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.views.size},e.prototype.applyOperation=function(e,t,r){var n,i,a=e.source.queryId;if(null!==a){var o=this.views.get(a);return cb(null!=o,"SyncTree gave us an op for an invalid query."),o.applyOperation(e,t,r)}var s=[];try{for(var v=Kb(this.views.values()),l=v.next();!l.done;l=v.next()){o=l.value;s=s.concat(o.applyOperation(e,t,r))}}catch(u){n={error:u}}finally{try{l&&!l.done&&(i=v.return)&&i.call(v)}finally{if(n)throw n.error}}return s},e.prototype.addEventRegistration=function(e,t,r,n,i){var a=e.queryIdentifier(),o=this.views.get(a);if(!o){var s=r.calcCompleteEventCache(i?n:null),v=!1;s?v=!0:n instanceof hb?(s=r.calcCompleteEventChildren(n),v=!1):(s=hb.EMPTY_NODE,v=!1);var l=new Qv(new ud(s,v,!1),new ud(n,i,!1));o=new pG(e,l),this.views.set(a,o)}return o.addEventRegistration(t),o.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,r,n){var i,a,o=t.queryIdentifier(),s=[],v=[],l=this.hasCompleteView();if("default"===o)try{for(var u=Kb(this.views.entries()),$=u.next();!$.done;$=u.next()){var h=hg($.value,2),c=h[0],p=h[1];v=v.concat(p.removeEventRegistration(r,n)),p.isEmpty()&&(this.views.delete(c),p.getQuery().getQueryParams().loadsAllData()||s.push(p.getQuery()))}}catch(d){i={error:d}}finally{try{$&&!$.done&&(a=u.return)&&a.call(u)}finally{if(i)throw i.error}}else(p=this.views.get(o))&&(v=v.concat(p.removeEventRegistration(r,n)),p.isEmpty()&&(this.views.delete(o),p.getQuery().getQueryParams().loadsAllData()||s.push(p.getQuery())));return l&&!this.hasCompleteView()&&s.push(new e.__referenceConstructor(t.repo,t.path)),{removed:s,events:v}},e.prototype.getQueryViews=function(){var e,t,r=[];try{for(var n=Kb(this.views.values()),i=n.next();!i.done;i=n.next()){var a=i.value;a.getQuery().getQueryParams().loadsAllData()||r.push(a)}}catch(o){e={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype.getCompleteServerCache=function(e){var t,r,n=null;try{for(var i=Kb(this.views.values()),a=i.next();!a.done;a=i.next()){var o=a.value;n=n||o.getCompleteServerCache(e)}}catch(s){t={error:s}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return this.views.get(t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){var e,t;try{for(var r=Kb(this.views.values()),n=r.next();!n.done;n=r.next()){var i=n.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(a){e={error:a}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return null},e}(),Tv=function(){function e(e){this.writeTree_=e}return e.prototype.addWrite=function(t,r){if(t.isEmpty())return new e(new Tb(r));var n=this.writeTree_.findRootMostValueAndPath(t);if(null!=n){var i=n.path,a=n.value,o=db.relativePath(i,t);return a=a.updateChild(o,r),new e(this.writeTree_.set(i,a))}var s=new Tb(r);return new e(this.writeTree_.setTree(t,s))},e.prototype.addWrites=function(e,t){var r=this;return Db(t,function(t,n){r=r.addWrite(e.child(t),n)}),r},e.prototype.removeWrite=function(t){return t.isEmpty()?e.Empty:new e(this.writeTree_.setTree(t,Tb.Empty))},e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},e.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(db.relativePath(t.path,e)):null},e.prototype.getCompleteChildren=function(){var e=[],t=this.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(rb,function(t,r){e.push(new mb(t,r))}):this.writeTree_.children.inorderTraversal(function(t,r){null!=r.value&&e.push(new mb(t,r.value))}),e},e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var r=this.getCompleteNode(t);return new e(null!=r?new Tb(r):this.writeTree_.subtree(t))},e.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},e.prototype.apply=function(e){return Uv(db.Empty,this.writeTree_,e)},e.Empty=new e(new Tb(null)),e}();function Uv(e,t,r){if(null!=t.value)return r.updateChild(e,t.value);var n=null;return t.children.inorderTraversal(function(t,i){".priority"===t?(cb(null!==i.value,"Priority writes must always be leaf nodes"),n=i.value):r=Uv(e.child(t),i,r)}),r.getChild(e).isEmpty()||null===n||(r=r.updateChild(e.child(".priority"),n)),r}var qG=function(){function e(){this.visibleWrites_=Tv.Empty,this.allWrites_=[],this.lastWriteId_=-1}return e.prototype.childWrites=function(e){return new rG(e,this)},e.prototype.addOverwrite=function(e,t,r,n){cb(r>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===n&&(n=!0),this.allWrites_.push({path:e,snap:t,writeId:r,visible:n}),n&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=r},e.prototype.addMerge=function(e,t,r){cb(r>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:r,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=r},e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var r=this.allWrites_[t];if(r.writeId===e)return r}return null},e.prototype.removeWrite=function(e){var t=this,r=this.allWrites_.findIndex(function(t){return t.writeId===e});cb(r>=0,"removeWrite called with nonexistent writeId.");var n=this.allWrites_[r];this.allWrites_.splice(r,1);for(var i=n.visible,a=!1,o=this.allWrites_.length-1;i&&o>=0;){var s=this.allWrites_[o];s.visible&&(o>=r&&this.recordContainsPath_(s,n.path)?i=!1:n.path.contains(s.path)&&(a=!0)),o--}if(i){if(a)return this.resetTree_(),!0;n.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(n.path):Db(n.children,function(e){t.visibleWrites_=t.visibleWrites_.removeWrite(n.path.child(e))});return!0}return!1},e.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcCompleteEventCache=function(t,r,n,i){if(n||i){var a=this.visibleWrites_.childCompoundWrite(t);if(!i&&a.isEmpty())return r;if(i||null!=r||a.hasCompleteWrite(db.Empty)){var o=e.layerTree_(this.allWrites_,function(e){return(e.visible||i)&&(!n||!~n.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},t);l=r||hb.EMPTY_NODE;return o.apply(l)}return null}var s=this.visibleWrites_.getCompleteNode(t);if(null!=s)return s;var v=this.visibleWrites_.childCompoundWrite(t);if(v.isEmpty())return r;if(null!=r||v.hasCompleteWrite(db.Empty)){var l=r||hb.EMPTY_NODE;return v.apply(l)}return null},e.prototype.calcCompleteEventChildren=function(e,t){var r=hb.EMPTY_NODE,n=this.visibleWrites_.getCompleteNode(e);if(n)return n.isLeafNode()||n.forEachChild(rb,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(rb,function(e,t){var n=i.childCompoundWrite(new db(e)).apply(t);r=r.updateImmediateChild(e,n)}),i.getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r,n){cb(r||n,"Either existingEventSnap or existingServerSnap must exist");var i=e.child(t);if(this.visibleWrites_.hasCompleteWrite(i))return null;var a=this.visibleWrites_.childCompoundWrite(i);return a.isEmpty()?n.getChild(t):a.apply(n.getChild(t))},e.prototype.calcCompleteChild=function(e,t,r){var n=e.child(t),i=this.visibleWrites_.getCompleteNode(n);return null!=i?i:r.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(n).apply(r.getNode().getImmediateChild(t)):null},e.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcIndexedSlice=function(e,t,r,n,i,a){var o,s=this.visibleWrites_.childCompoundWrite(e),v=s.getCompleteNode(db.Empty);if(null!=v)o=v;else{if(null==t)return[];o=s.apply(t)}if((o=o.withIndex(a)).isEmpty()||o.isLeafNode())return[];for(var l=[],u=a.getCompare(),$=i?o.getReverseIteratorFrom(r,a):o.getIteratorFrom(r,a),h=$.getNext();h&&l.length<n;)0!==u(h,r)&&l.push(h),h=$.getNext();return l},e.prototype.recordContainsPath_=function(e,t){if(e.snap)return e.path.contains(t);for(var r in e.children)if(e.children.hasOwnProperty(r)&&e.path.child(r).contains(t))return!0;return!1},e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,db.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},e.DefaultFilter_=function(e){return e.visible},e.layerTree_=function(e,t,r){for(var n=Tv.Empty,i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,s=void 0;if(a.snap)r.contains(o)?(s=db.relativePath(r,o),n=n.addWrite(s,a.snap)):o.contains(r)&&(s=db.relativePath(o,r),n=n.addWrite(db.Empty,a.snap.getChild(s)));else{if(!a.children)throw Ef("WriteRecord should have .snap or .children");if(r.contains(o))s=db.relativePath(r,o),n=n.addWrites(s,a.children);else if(o.contains(r))if((s=db.relativePath(o,r)).isEmpty())n=n.addWrites(db.Empty,a.children);else{var v=Xb(a.children,s.getFront());if(v){var l=v.getChild(s.popFront());n=n.addWrite(db.Empty,l)}}}}}return n},e}(),rG=function(){function e(e,t){this.treePath_=e,this.writeTree_=t}return e.prototype.calcCompleteEventCache=function(e,t,r){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,r)},e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,r)},e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},e.prototype.calcIndexedSlice=function(e,t,r,n,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,r,n,i)},e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},e.prototype.child=function(t){return new e(this.treePath_.child(t),this.writeTree_)},e}(),Vv=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=Tb.Empty,this.pendingWriteTree_=new qG,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return e.prototype.applyUserOverwrite=function(e,t,r,n){return this.pendingWriteTree_.addOverwrite(e,t,r,n),n?this.applyOperationToSyncPoints_(new uj(td.User,e,t)):[]},e.prototype.applyUserMerge=function(e,t,r){this.pendingWriteTree_.addMerge(e,t,r);var n=Tb.fromObject(t);return this.applyOperationToSyncPoints_(new Zl(td.User,e,n))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var r=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var n=Tb.Empty;return null!=r.snap?n=n.set(db.Empty,!0):Db(r.children,function(e,t){n=n.set(new db(e),t)}),this.applyOperationToSyncPoints_(new iG(r.path,n,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new uj(td.Server,e,t))},e.prototype.applyServerMerge=function(e,t){var r=Tb.fromObject(t);return this.applyOperationToSyncPoints_(new Zl(td.Server,e,r))},e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new Pv(td.Server,e))},e.prototype.applyTaggedQueryOverwrite=function(t,r,n){var i=this.queryKeyForTag_(n);if(null!=i){var a=e.parseQueryKey_(i),o=a.path,s=a.queryId,v=db.relativePath(o,t),l=new uj(td.forServerTaggedQuery(s),v,r);return this.applyTaggedOperation_(o,l)}return[]},e.prototype.applyTaggedQueryMerge=function(t,r,n){var i=this.queryKeyForTag_(n);if(i){var a=e.parseQueryKey_(i),o=a.path,s=a.queryId,v=db.relativePath(o,t),l=Tb.fromObject(r),u=new Zl(td.forServerTaggedQuery(s),v,l);return this.applyTaggedOperation_(o,u)}return[]},e.prototype.applyTaggedListenComplete=function(t,r){var n=this.queryKeyForTag_(r);if(n){var i=e.parseQueryKey_(n),a=i.path,o=i.queryId,s=db.relativePath(a,t),v=new Pv(td.forServerTaggedQuery(o),s);return this.applyTaggedOperation_(a,v)}return[]},e.prototype.addEventRegistration=function(t,r){var n=t.path,i=null,a=!1;this.syncPointTree_.foreachOnPath(n,function(e,t){var r=db.relativePath(e,n);i=i||t.getCompleteServerCache(r),a=a||t.hasCompleteView()});var o,s=this.syncPointTree_.get(n);(s?(a=a||s.hasCompleteView(),i=i||s.getCompleteServerCache(db.Empty)):(s=new Sv,this.syncPointTree_=this.syncPointTree_.set(n,s)),null!=i)?o=!0:(o=!1,i=hb.EMPTY_NODE,this.syncPointTree_.subtree(n).foreachChild(function(e,t){var r=t.getCompleteServerCache(db.Empty);r&&(i=i.updateImmediateChild(e,r))}));var v=s.viewExistsForQuery(t);if(!v&&!t.getQueryParams().loadsAllData()){var l=e.makeQueryKey_(t);cb(!this.queryToTagMap.has(l),"View does not exist, but we have a tag");var u=e.getNextQueryTag_();this.queryToTagMap.set(l,u),this.tagToQueryMap.set(u,l)}var $=this.pendingWriteTree_.childWrites(n),h=s.addEventRegistration(t,r,$,i,o);if(!v&&!a){var c=s.viewForQuery(t);h=h.concat(this.setupListener_(t,c))}return h},e.prototype.removeEventRegistration=function(t,r,n){var i=this,a=t.path,o=this.syncPointTree_.get(a),s=[];if(o&&("default"===t.queryIdentifier()||o.viewExistsForQuery(t))){var v=o.removeEventRegistration(t,r,n);o.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(a));var l=v.removed;s=v.events;var u=-1!==l.findIndex(function(e){return e.getQueryParams().loadsAllData()}),$=this.syncPointTree_.findOnPath(a,function(e,t){return t.hasCompleteView()});if(u&&!$){var h=this.syncPointTree_.subtree(a);if(!h.isEmpty())for(var c=this.collectDistinctViewsForSubTree_(h),p=0;p<c.length;++p){var d=c[p],m=d.getQuery(),_=this.createListenerForView_(d);this.listenProvider_.startListening(e.queryForListening_(m),this.tagForQuery_(m),_.hashFn,_.onComplete)}}if(!$&&l.length>0&&!n)if(u){this.listenProvider_.stopListening(e.queryForListening_(t),null)}else l.forEach(function(t){var r=i.queryToTagMap.get(e.makeQueryKey_(t));i.listenProvider_.stopListening(e.queryForListening_(t),r)});this.removeTags_(l)}return s},e.prototype.calcCompleteEventCache=function(e,t){var r=this.pendingWriteTree_,n=this.syncPointTree_.findOnPath(e,function(t,r){var n=db.relativePath(t,e),i=r.getCompleteServerCache(n);if(i)return i});return r.calcCompleteEventCache(e,n,t,!0)},e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,r){if(t&&t.hasCompleteView())return[t.getCompleteView()];var n=[];return t&&(n=t.getQueryViews()),Db(r,function(e,t){n=n.concat(t)}),n})},e.prototype.removeTags_=function(t){for(var r=0;r<t.length;++r){var n=t[r];if(!n.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(n),a=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(a)}}},e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.setupListener_=function(t,r){var n=t.path,i=this.tagForQuery_(t),a=this.createListenerForView_(r),o=this.listenProvider_.startListening(e.queryForListening_(t),i,a.hashFn,a.onComplete),s=this.syncPointTree_.subtree(n);if(i)cb(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var v=s.fold(function(e,t,r){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var n=[];return t&&(n=n.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),Db(r,function(e,t){n=n.concat(t)}),n}),l=0;l<v.length;++l){var u=v[l];this.listenProvider_.stopListening(e.queryForListening_(u),this.tagForQuery_(u))}return o},e.prototype.createListenerForView_=function(e){var t=this,r=e.getQuery(),n=this.tagForQuery_(r);return{hashFn:function(){return(e.getServerCache()||hb.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return n?t.applyTaggedListenComplete(r.path,n):t.applyListenComplete(r.path);var i=BF(e,r);return t.removeEventRegistration(r,null,i)}}},e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},e.parseQueryKey_=function(e){var t=e.indexOf("$");return cb(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new db(e.substr(0,t))}},e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap.get(e)},e.prototype.tagForQuery_=function(t){var r=e.makeQueryKey_(t);return this.queryToTagMap.get(r)},e.getNextQueryTag_=function(){return e.nextQueryTag_++},e.prototype.applyTaggedOperation_=function(e,t){var r=this.syncPointTree_.get(e);cb(r,"Missing sync point for query tag that we're tracking");var n=this.pendingWriteTree_.childWrites(e);return r.applyOperation(t,n,null)},e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(db.Empty))},e.prototype.applyOperationHelper_=function(e,t,r,n){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,r,n);var i=t.get(db.Empty);null==r&&null!=i&&(r=i.getCompleteServerCache(db.Empty));var a=[],o=e.path.getFront(),s=e.operationForChild(o),v=t.children.get(o);if(v&&s){var l=r?r.getImmediateChild(o):null,u=n.child(o);a=a.concat(this.applyOperationHelper_(s,v,l,u))}return i&&(a=a.concat(i.applyOperation(e,n,r))),a},e.prototype.applyOperationDescendantsHelper_=function(e,t,r,n){var i=this,a=t.get(db.Empty);null==r&&null!=a&&(r=a.getCompleteServerCache(db.Empty));var o=[];return t.children.inorderTraversal(function(t,a){var s=r?r.getImmediateChild(t):null,v=n.child(t),l=e.operationForChild(t);l&&(o=o.concat(i.applyOperationDescendantsHelper_(l,a,s,v)))}),a&&(o=o.concat(a.applyOperation(e,n,r))),o},e.nextQueryTag_=1,e}(),sG=function(){function e(){this.rootNode_=hb.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}(),tG=function(){function e(e,t){var r=this;this.app_=e,this.authProvider_=t,this.auth_=null,this.auth_=t.getImmediate({optional:!0}),this.auth_||t.get().then(function(e){return r.auth_=e})}return e.prototype.getToken=function(e){return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(Lb("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):Promise.resolve(null)},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):(setTimeout(function(){return e(null)},0),this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)}))},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})},e.prototype.notifyForInvalidToken=function(){var e="Provided authentication credentials for the app named \""+this.app_.name+"\" are invalid. This usually indicates your app was not initialized correctly. ";"credential"in this.app_.options?e+="Make sure the \"credential\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.":"serviceAccount"in this.app_.options?e+="Make sure the \"serviceAccount\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.":e+="Make sure the \"apiKey\" and \"databaseURL\" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.",Mb(e)},e}(),uG=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),Nb(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return Lk(this.counters_)},e}(),vj=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new uG),this.collections_[t]},e.getOrCreateReporter=function(e,t){var r=e.toString();return this.reporters_[r]||(this.reporters_[r]=t()),this.reporters_[r]},e.collections_={},e.reporters_={},e}(),Wv=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=Zd({},e);return this.last_&&Db(this.last_,function(e,r){t[e]=t[e]-r}),this.last_=e,t},e}(),Xv=1e4,vG=3e4,wG=3e5,xG=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Wv(e);var r=Xv+(vG-Xv)*Math.random();tg(this.reportStats_.bind(this),Math.floor(r))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),r={},n=!1;Db(t,function(t,i){i>0&&Nb(e.statsToReport_,t)&&(r[t]=i,n=!0)}),n&&this.server_.reportStats(r),tg(this.reportStats_.bind(this),Math.floor(2*Math.random()*wG))},e}(),yG=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e.prototype.queueEvents=function(e){for(var t=null,r=0;r<e.length;r++){var n=e[r],i=n.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new zG(i)),t.add(n)}t&&this.eventLists_.push(t)},e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.equals(e)})},e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.contains(e)||e.contains(t)})},e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,r=0;r<this.eventLists_.length;r++){var n=this.eventLists_[r];if(n)e(n.getPath())?(this.eventLists_[r].raise(),this.eventLists_[r]=null):t=!1}t&&(this.eventLists_=[]),this.recursionDepth_--},e}(),zG=function(){function e(e){this.path_=e,this.events_=[]}return e.prototype.add=function(e){this.events_.push(e)},e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var r=t.getEventRunner();lj&&Lb("event: "+t.toString()),Kf(r)}}},e.prototype.getPath=function(){return this.path_},e}(),Yv=function(){function e(e){this.allowedEvents_=e,this.listeners_={},cb(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Array.isArray(this.listeners_[e]))for(var n=Df(this.listeners_[e]),i=0;i<n.length;i++)n[i].callback.apply(n[i].context,t)},e.prototype.on=function(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});var n=this.getInitialEvent(e);n&&t.apply(r,n)},e.prototype.off=function(e,t,r){this.validateEventType_(e);for(var n=this.listeners_[e]||[],i=0;i<n.length;i++)if(n[i].callback===t&&(!r||r===n[i].context))return void n.splice(i,1)},e.prototype.validateEventType_=function(e){cb(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}(),AG=function(e){function t(){var t,r,n=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(r="visibilitychange",t="hidden"):void 0!==document.mozHidden?(r="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(r="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(r="webkitvisibilitychange",t="webkitHidden")),n.visible_=!0,r&&document.addEventListener(r,function(){var e=!document[t];e!==n.visible_&&(n.visible_=e,n.trigger("visible",e))},!1),n}return $b(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return cb("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(Yv),Zv=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Mk()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return $b(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return cb("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(Yv),BG=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var r=this;this.pendingResponses[e]=t;for(var n=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&Kf(function(){r.onMessage_(e[t])})},n=0;n<e.length;++n)t(n);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===n())break}},e}(),$v="start",CG="close",DG="pLPCommand",EG="pRTLPCB",FG="seg",GG="ts",HG="d",_v=1870,aw=30,IG=_v-aw,JG=25e3,KG=3e4,cm=function(){function e(e,t,r,n,i){this.connId=e,this.repoInfo=t,this.applicationId=r,this.transportSessionId=n,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=rg(e),this.stats_=vj.getCollection(t),this.urlFn=function(e){return t.connectionURL(xv,e)}}return e.prototype.open=function(e,t){var r=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new BG(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){r.log_("Timed out trying to connect."),r.onClosed_(),r.connectTimeoutTimer_=null},Math.floor(KG)),xF(function(){if(!r.isClosed_){r.scriptTagHolder=new LG(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=hg(e,5),i=n[0],a=n[1],o=n[2];n[3],n[4];if(r.incrementIncomingBytes_(e),r.scriptTagHolder)if(r.connectTimeoutTimer_&&(clearTimeout(r.connectTimeoutTimer_),r.connectTimeoutTimer_=null),r.everConnected_=!0,i===$v)r.id=a,r.password=o;else{if(i!==CG)throw new Error("Unrecognized command received: "+i);a?(r.scriptTagHolder.sendNewPolls=!1,r.myPacketOrderer.closeAfter(a,function(){r.onClosed_()})):r.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=hg(e,2),i=n[0],a=n[1];r.incrementIncomingBytes_(e),r.myPacketOrderer.handleResponse(i,a)},function(){r.onClosed_()},r.urlFn);var e={};e[$v]="t",r.scriptTagHolder.uniqueCallbackIdentifier&&r.scriptTagHolder.uniqueCallbackIdentifier,r.transportSessionId&&r.transportSessionId,r.lastSessionId&&r.lastSessionId,r.applicationId&&r.applicationId,"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(vv)&&uv;var t=r.urlFn(e);r.log_("Connecting via long-poll to "+t),r.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!gd()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!zF()&&!AF())},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Bb(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var r=Wq(t),n=qv(r,IG),i=0;i<n.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!gd()){this.myDisconnFrame=document.createElement("iframe");var r={};this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=Bb(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),LG=function(){function e(t,r,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,gd())this.commandCB=t,this.onMessageCB=r;else{this.uniqueCallbackIdentifier=ov(),window[DG+this.uniqueCallbackIdentifier]=t,window[EG+this.uniqueCallbackIdentifier]=r,this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))a="<script>document.domain=\""+document.domain+"\";</script>";var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(s){Lb("frame writing exception"),s.stack&&Lb(s.stack),Lb(s)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Lb("No IE domain setting required")}catch(r){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};for(var t=this.urlFn(e),r="",n=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+aw+r.length<=_v))break;var i=this.pendingSegs.shift();r=r+"&"+FG+n+"="+i.seg+"&"+GG+n+"="+i.ts+"&"+HG+n+"="+i.d,n++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var r=this;this.outstandingRequests.add(t);var n=function(){r.outstandingRequests.delete(t),r.newRequest_()},i=setTimeout(n,Math.floor(JG));this.addTag(e,function(){clearTimeout(i),n()})},e.prototype.addTag=function(e,t){var r=this;gd()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!r.sendNewPolls)return;var n=r.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){var e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=function(){Lb("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(n)}catch(i){}},Math.floor(1))},e}(),bw="";function MG(e){bw=e}var NG=16384,OG=45e3,dm=null;"undefined"!=typeof MozWebSocket?dm=MozWebSocket:"undefined"!=typeof WebSocket&&(dm=WebSocket);var cf=function(){function e(t,r,n,i,a){this.connId=t,this.applicationId=n,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=rg(this.connId),this.stats_=vj.getCollection(r),this.connURL=e.connectionURL_(r,i,a)}return e.connectionURL_=function(e,t,r){var n={};return!gd()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(vv)&&uv,t&&t,r&&r,e.connectionURL(wv,n)},e.prototype.open=function(e,t){var r=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,$d.set("previous_websocket_failure",!0);try{if(gd()){var n=kg.NODE_ADMIN?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/"+tv+"/"+bw+"/"+kj.platform+"/"+n,"X-Firebase-GMPID":this.applicationId||""}},a=kj.env,o=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(i.proxy={origin:o}),this.mySock=new dm(this.connURL,[],i)}else{i={headers:{"X-Firebase-GMPID":this.applicationId||""}};this.mySock=new dm(this.connURL,[],i)}}catch(v){this.log_("Error instantiating WebSocket.");var s=v.message||v.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&r.log_(t),r.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==dm&&!e.forceDisallow_},e.previouslyFailed=function(){return $d.isInMemoryStorage||!0===$d.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){$d.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var r=gj(t);this.onMessage(r)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(cb(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var r=this.extractFrameCount_(t);null!==r&&this.appendFrame_(r)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=Bb(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var r=qv(t,NG);r.length>1&&this.sendString_(String(r.length));for(var n=0;n<r.length;n++)this.sendString_(r[n])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(OG))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),PG=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[cm,cf]},enumerable:!0,configurable:!0}),e.prototype.initTransports_=function(t){var r,n,i=cf&&cf.isAvailable(),a=i&&!cf.previouslyFailed();if(t.webSocketOnly&&(i||Mb("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),a=!0),a)this.transports_=[cf];else{var o=this.transports_=[];try{for(var s=Kb(e.ALL_TRANSPORTS),v=s.next();!v.done;v=s.next()){var l=v.value;l&&l.isAvailable()&&o.push(l)}}catch(u){r={error:u}}finally{try{v&&!v.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),QG=6e4,RG=5e3,SG=10240,TG=102400,em="t",cw="d",UG="s",dw="r",VG="e",ew="o",fw="a",gw="n",hw="p",WG="h",iw=function(){function e(e,t,r,n,i,a,o,s){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.onMessage_=n,this.onReady_=i,this.onDisconnect_=a,this.onKill_=o,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=rg("c:"+this.id+":"),this.transportManager_=new PG(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(r,n)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=tg(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>TG?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>SG?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(r){e===t.conn_?t.onConnectionLost_(r):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(r){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(r):e===t.secondaryConn_?t.onSecondaryMessageReceived_(r):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if(em in e){var t=e[em];t===fw?this.upgradeIfSecondaryHealthy_():t===dw?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):t===ew&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=sg("t",e),r=sg("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:hw,d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:fw,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:gw,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=sg("t",e),r=sg("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=sg(em,e);if(cw in e){var r=e[cw];if(t===WG)this.onHandshake_(r);else if(t===gw){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===UG?this.onConnectionShutdown_(r):t===dw?this.onReset_(r):t===VG?Tk("Server Error: "+r):t===ew?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Tk("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,r=e.v,n=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(n),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),tv!==r&&Mb("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),tg(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(QG))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var r=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):tg(function(){r.sendPingOnPrimaryIfNecessary_()},Math.floor(RG))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:hw,d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&($d.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),jw=function(){function e(){}return e.prototype.put=function(e,t,r,n){},e.prototype.merge=function(e,t,r,n){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,r){},e.prototype.onDisconnectMerge=function(e,t,r){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),yg=1e3,XG=3e5,kw=3e4,YG=1.3,ZG=3e4,$G="server_kill",_G=3,df=function(e){function t(r,n,i,a,o,s,v){var l=e.call(this)||this;if(l.repoInfo_=r,l.applicationId_=n,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=o,l.authTokenProvider_=s,l.authOverride_=v,l.id=t.nextPersistentConnectionId_++,l.log_=rg("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingPutCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=yg,l.maxReconnectDelay_=XG,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,v&&!gd())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return l.scheduleConnect_(0),AG.getInstance().on("visible",l.onVisible_,l),-1===r.host.indexOf("fblocal")&&Zv.getInstance().on("online",l.onOnline_,l),l}return $b(t,e),t.prototype.sendRequest=function(e,t,r){var n=++this.requestNumber_,i={r:n,a:e,b:t};this.log_(Bb(i)),cb(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[n]=r)},t.prototype.listen=function(e,t,r,n){var i=e.queryIdentifier(),a=e.path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),cb(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),cb(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var o={onComplete:n,hashFn:t,query:e,tag:r};this.listens.get(a).set(i,o),this.connected_&&this.sendListen_(o)},t.prototype.sendListen_=function(e){var r=this,n=e.query,i=n.path.toString(),a=n.queryIdentifier();this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=n.queryObject(),o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,function(o){var s=o.d,v=o.s;t.warnOnListenWarnings_(s,n),(r.listens.get(i)&&r.listens.get(i).get(a))===e&&(r.log_("listen response",o),"ok"!==v&&r.removeListen_(i,a),e.onComplete&&e.onComplete(v,s))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&Nb(e,"w")){var r=Xb(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){var n="\".indexOn\": \""+t.getQueryParams().getIndex().toString()+"\"",i=t.path.toString();Mb("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+n+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||Yq(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=kw)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,r=av(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(r,n,function(r){var n=r.s,i=r.d||"error";e.authToken_===t&&("ok"===n?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(n,i))})}},t.prototype.unlisten=function(e,t){var r=e.path.toString(),n=e.queryIdentifier();this.log_("Unlisten called for "+r+" "+n),cb(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,n)&&this.connected_&&this.sendUnlisten_(r,n,e.queryObject(),t)},t.prototype.sendUnlisten_=function(e,t,r,n){this.log_("Unlisten on "+e+" for "+t);var i={p:e};n&&(i.q=r,i.t=n),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,r){this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})},t.prototype.onDisconnectMerge=function(e,t,r){this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,r,n){var i={p:t,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){n&&setTimeout(function(){n(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,r,n){this.putInternal("p",e,t,r,n)},t.prototype.merge=function(e,t,r,n){this.putInternal("m",e,t,r,n)},t.prototype.putInternal=function(e,t,r,n,i){var a={p:t,d:r};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:n}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,r=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,n,function(n){t.log_(r+" response",n),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(n.s,n.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,function(e){if("ok"!==e.s){var r=e.d;t.log_("reportStats","Error sending stats: "+r)}})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Bb(e));var t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Tk("Unrecognized action received from server: "+Bb(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;cb(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=yg,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=yg,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){new Date().getTime()-this.lastConnectionEstablishedTime_>ZG&&(this.reconnectDelay_=yg),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime();var e=new Date().getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*YG)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,a=this,o=this.lastSessionId,s=!1,v=null,l=function(){v?v.close():(s=!0,n())};this.realtime_={close:l,sendRequest:function(e){cb(v,"sendRequest call when we're not connected not allowed."),v.sendRequest(e)}};var u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(u).then(function(t){s?Lb("getToken() completed but was canceled"):(Lb("getToken() completed. Creating connection."),a.authToken_=t&&t.accessToken,v=new iw(i,a.repoInfo_,a.applicationId_,e,r,n,function(e){Mb(e+" ("+a.repoInfo_.toString()+")"),a.interrupt($G)},o))}).then(null,function(e){a.log_("Failed to get token: "+e),s||(kg.NODE_ADMIN&&Mb(e),l())})}},t.prototype.interrupt=function(e){Lb("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){Lb("Resuming connection for reason: "+e),delete this.interruptReasons_[e],fj(this.interruptReasons_)&&(this.reconnectDelay_=yg,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var r;r=t?t.map(function(e){return Uk(e)}).join("$"):"default";var n=this.removeListen_(e,r);n&&n.onComplete&&n.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var r,n=new db(e).toString();if(this.listens.has(n)){var i=this.listens.get(n);r=i.get(t),i.delete(t),0===i.size&&this.listens.delete(n)}else r=void 0;return r},t.prototype.onAuthRevoked_=function(e,t){Lb("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=_G&&(this.reconnectDelay_=kw,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,r,n;this.tryAuth();try{for(var i=Kb(this.listens.values()),a=i.next();!a.done;a=i.next()){var o=a.value;try{for(var s=(r=void 0,Kb(o.values())),v=s.next();!v.done;v=s.next()){var l=v.value;this.sendListen_(l)}}catch(h){r={error:h}}finally{try{v&&!v.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}catch(c){e={error:c}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var u=0;u<this.outstandingPuts_.length;u++)this.outstandingPuts_[u]&&this.sendPut_(u);for(;this.onDisconnectRequestQueue_.length;){var $=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_($.action,$.pathString,$.data,$.onComplete)}},t.prototype.sendConnectStats_=function(){var e={},t="js";kg.NODE_ADMIN?t="admin_node":kg.NODE_CLIENT&&(t="node"),e["sdk."+t+"."+bw.replace(/\./g,"-")]=1,Mk()?e["framework.cordova"]=1:_q()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=Zv.getInstance().currentlyOnline();return fj(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(jw),aH=function(e){function t(t,r,n){var i=e.call(this)||this;return i.repoInfo_=t,i.onDataUpdate_=r,i.authTokenProvider_=n,i.log_=rg("p:rest:"),i.listens_={},i}return $b(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(cb(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},t.prototype.listen=function(e,r,n,i){var a=this,o=e.path.toString();this.log_("Listen called for "+o+" "+e.queryIdentifier());var s=t.getListenId_(e,n),v={};this.listens_[s]=v;var l=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(o+".json",l,function(e,t){var r=t;(404===e&&(r=null,e=null),null===e&&a.onDataUpdate_(o,r,!1,n),Xb(a.listens_,s)===v)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})},t.prototype.unlisten=function(e,r){var n=t.getListenId_(e,r);delete this.listens_[n]},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,r){var n=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var a=i&&i.accessToken;a&&(t.auth=a);var o=(n.repoInfo_.secure?"https://":"http://")+n.repoInfo_.host+e+"?ns="+n.repoInfo_.namespace+bv(t);n.log_("Sending REST request for "+o);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(r&&4===s.readyState){n.log_("REST Response for "+o+" received. status:",s.status,"response:",s.responseText);var e=null;if(s.status>=200&&s.status<300){try{e=gj(s.responseText)}catch(t){Mb("Failed to parse JSON response for "+o+": "+s.responseText)}r(null,e)}else 401!==s.status&&404!==s.status&&Mb("Got unsuccessful REST response for "+o+" Status: "+s.status),r(s.status);r=null}},s.open("GET",o,!0),s.send()})},t}(jw),lw="repo_interrupt",Gb=function(){function e(e,t,r,n){var i=this;this.repoInfo_=e,this.app=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new yG,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new Xl,this.persistentConnection_=null;var a=new tG(r,n);if(this.stats_=vj.getCollection(e),t||DF())this.server_=new aH(this.repoInfo_,this.onDataUpdate_.bind(this),a),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=r.options.databaseAuthVariableOverride;if(null!=o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Bb(o)}catch(s){throw new Error("Invalid authOverride provided: "+s)}}this.persistentConnection_=new df(this.repoInfo_,r.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),a,o),this.server_=this.persistentConnection_}a.addTokenChangeListener(function(e){i.server_.refreshAuthToken(e)}),this.statsReporter_=vj.getOrCreateReporter(e,function(){return new xG(i.stats_,i.server_)}),this.transactionsInit_(),this.infoData_=new sG,this.infoSyncTree_=new Vv({startListening:function(e,t,r,n){var a=[],o=i.infoData_.getNode(e.path);return o.isEmpty()||(a=i.infoSyncTree_.applyServerOverwrite(e.path,o),setTimeout(function(){n("ok")},0)),a},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new Vv({startListening:function(e,t,r,n){return i.server_.listen(e,r,t,function(t,r){var a=n(t,r);i.eventQueue_.raiseEventsForChangedPath(e.path,a)}),[]},stopListening:function(e,t){i.server_.unlisten(e,t)}})}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new db(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e},e.prototype.generateServerValues=function(){return fG({timestamp:this.serverTime()})},e.prototype.onDataUpdate_=function(e,t,r,n){this.dataUpdateCount++;var i=new db(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var a=[];if(n){if(r){var o=lg(t,function(e){return zb(e)});a=this.serverSyncTree_.applyTaggedQueryMerge(i,o,n)}else{var s=zb(t);a=this.serverSyncTree_.applyTaggedQueryOverwrite(i,s,n)}}else if(r){var v=lg(t,function(e){return zb(e)});a=this.serverSyncTree_.applyServerMerge(i,v)}else{var l=zb(t);a=this.serverSyncTree_.applyServerOverwrite(i,l)}var u=i;a.length>0&&(u=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(u,a)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var t=this;Db(e,function(e,r){t.updateInfo_(e,r)})},e.prototype.updateInfo_=function(e,t){var r=new db("/.info/"+e),n=zb(t);this.infoData_.updateSnapshot(r,n);var i=this.infoSyncTree_.applyServerOverwrite(r,n);this.eventQueue_.raiseEventsForChangedPath(r,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.setWithPriority=function(e,t,r,n){var i=this;this.log_("set",{path:e.toString(),value:t,priority:r});var a=this.generateServerValues(),o=zb(t,r),s=this.serverSyncTree_.calcCompleteEventCache(e),v=Ql(o,s,a),l=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserOverwrite(e,v,l,!0);this.eventQueue_.queueEvents(u),this.server_.put(e.toString(),o.val(!0),function(t,r){var a="ok"===t;a||Mb("set at "+e+" failed: "+t);var o=i.serverSyncTree_.ackUserWrite(l,!a);i.eventQueue_.raiseEventsForChangedPath(e,o),i.callOnCompleteCallback(n,t,r)});var $=this.abortTransactions_(e);this.rerunTransactions_($),this.eventQueue_.raiseEventsForChangedPath($,[])},e.prototype.update=function(e,t,r){var n=this;this.log_("update",{path:e.toString(),value:t});var i=!0,a=this.generateServerValues(),o={};if(Db(t,function(t,r){i=!1,o[t]=Nv(e.child(t),zb(r),n.serverSyncTree_,a)}),i)Lb("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(r,"ok");else{var s=this.getNextWriteId_(),v=this.serverSyncTree_.applyUserMerge(e,o,s);this.eventQueue_.queueEvents(v),this.server_.merge(e.toString(),t,function(t,i){var a="ok"===t;a||Mb("update at "+e+" failed: "+t);var o=n.serverSyncTree_.ackUserWrite(s,!a),v=o.length>0?n.rerunTransactions_(e):e;n.eventQueue_.raiseEventsForChangedPath(v,o),n.callOnCompleteCallback(r,t,i)}),Db(t,function(t){var r=n.abortTransactions_(e.child(t));n.rerunTransactions_(r)}),this.eventQueue_.raiseEventsForChangedPath(e,[])}},e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),r=new Xl;this.onDisconnect_.forEachTree(db.Empty,function(n,i){var a=Nv(n,i,e.serverSyncTree_,t);r.remember(n,a)});var n=[];r.forEachTree(db.Empty,function(t,r){n=n.concat(e.serverSyncTree_.applyServerOverwrite(t,r));var i=e.abortTransactions_(t);e.rerunTransactions_(i)}),this.onDisconnect_=new Xl,this.eventQueue_.raiseEventsForChangedPath(db.Empty,n)},e.prototype.onDisconnectCancel=function(e,t){var r=this;this.server_.onDisconnectCancel(e.toString(),function(n,i){"ok"===n&&r.onDisconnect_.forget(e),r.callOnCompleteCallback(t,n,i)})},e.prototype.onDisconnectSet=function(e,t,r){var n=this,i=zb(t);this.server_.onDisconnectPut(e.toString(),i.val(!0),function(t,a){"ok"===t&&n.onDisconnect_.remember(e,i),n.callOnCompleteCallback(r,t,a)})},e.prototype.onDisconnectSetWithPriority=function(e,t,r,n){var i=this,a=zb(t,r);this.server_.onDisconnectPut(e.toString(),a.val(!0),function(t,r){"ok"===t&&i.onDisconnect_.remember(e,a),i.callOnCompleteCallback(n,t,r)})},e.prototype.onDisconnectUpdate=function(e,t,r){var n=this;if(fj(t))return Lb("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(r,"ok");this.server_.onDisconnectMerge(e.toString(),t,function(i,a){"ok"===i&&Db(t,function(t,r){var i=zb(r);n.onDisconnect_.remember(e.child(t),i)}),n.callOnCompleteCallback(r,i,a)})},e.prototype.addEventCallbackForQuery=function(e,t){var r;r=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,r)},e.prototype.removeEventCallbackForQuery=function(e,t){var r;r=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,r)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(lw)},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(lw)},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new Wv(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var r=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);Db(t,function(e,t){for(var n=e,i=e.length;i<r+2;i++)n+=" ";console.log(n+t)})}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="";this.persistentConnection_&&(r=this.persistentConnection_.id+":"),Lb.apply(void 0,Df([r],e))},e.prototype.callOnCompleteCallback=function(e,t,r){e&&Kf(function(){if("ok"===t)e(null);else{var n=(t||"error").toUpperCase(),i=n;r&&(i+=": "+r);var a=new Error(i);a.code=n,e(a)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new wj(this))},enumerable:!0,configurable:!0}),e}(),mw=function(){function e(t){this.indexedFilter_=new am(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,r,n,i,a){return this.matches(new mb(t,r))||(r=hb.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,n,i,a)},e.prototype.updateFullNode=function(e,t,r){t.isLeafNode()&&(t=hb.EMPTY_NODE);var n=t.withIndex(this.index_);n=n.updatePriority(hb.EMPTY_NODE);var i=this;return t.forEachChild(rb,function(e,t){i.matches(new mb(e,t))||(n=n.updateImmediateChild(e,hb.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),bH=function(){function e(e){this.rangedFilter_=new mw(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,r,n,i,a){return this.rangedFilter_.matches(new mb(t,r))||(r=hb.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,n,i,a):this.fullLimitUpdateChild_(e,t,r,i,a)},e.prototype.updateFullNode=function(e,t,r){var n;if(t.isLeafNode()||t.isEmpty())n=hb.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){n=hb.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;i.hasNext()&&a<this.limit_;){var o=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),o)<=0:this.index_.compare(o,this.rangedFilter_.getEndPost())<=0))break;n=n.updateImmediateChild(o.name,o.node),a++}}else{n=(n=t.withIndex(this.index_)).updatePriority(hb.EMPTY_NODE);var s=void 0,v=void 0,l=void 0;i=void 0;if(this.reverse_){i=n.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),v=this.rangedFilter_.getStartPost();var u=this.index_.getCompare();l=function(e,t){return u(t,e)}}else i=n.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),v=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();a=0;for(var $=!1;i.hasNext();){o=i.getNext();!$&&l(s,o)<=0&&($=!0),$&&a<this.limit_&&l(o,v)<=0?a++:n=n.updateImmediateChild(o.name,hb.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,r,n,i){var a;if(this.reverse_){var o=this.index_.getCompare();a=function(e,t){return o(t,e)}}else a=this.index_.getCompare();var s=e;cb(s.numChildren()===this.limit_,"");var v=new mb(t,r),l=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),u=this.rangedFilter_.matches(v);if(s.hasChild(t)){for(var $=s.getImmediateChild(t),h=n.getChildAfterChild(this.index_,l,this.reverse_);null!=h&&(h.name===t||s.hasChild(h.name));)h=n.getChildAfterChild(this.index_,h,this.reverse_);var c=null==h?1:a(h,v);if(u&&!r.isEmpty()&&c>=0)return null!=i&&i.trackChildChange(jb.childChangedChange(t,r,$)),s.updateImmediateChild(t,r);null!=i&&i.trackChildChange(jb.childRemovedChange(t,$));var p=s.updateImmediateChild(t,hb.EMPTY_NODE);return null!=h&&this.rangedFilter_.matches(h)?(null!=i&&i.trackChildChange(jb.childAddedChange(h.name,h.node)),p.updateImmediateChild(h.name,h.node)):p}return r.isEmpty()?e:u&&a(l,v)>=0?(null!=i&&(i.trackChildChange(jb.childRemovedChange(l.name,l.node)),i.trackChildChange(jb.childAddedChange(t,r))),s.updateImmediateChild(t,r).updateImmediateChild(l.name,hb.EMPTY_NODE)):e},e}(),cH=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=rb}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},e.prototype.getIndexStartValue=function(){return cb(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return cb(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:_d},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return cb(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return cb(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Gd},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return cb(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.copy_=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},e.prototype.limitToFirst=function(t){var r=this.copy_();return r.limitSet_=!0,r.limit_=t,r.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,r},e.prototype.limitToLast=function(t){var r=this.copy_();return r.limitSet_=!0,r.limit_=t,r.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,r},e.prototype.startAt=function(e,t){var r=this.copy_();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r},e.prototype.endAt=function(e,t){var r=this.copy_();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r},e.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},e.prototype.getQueryObject=function(){var t=e.WIRE_PROTOCOL_CONSTANTS_,r={};if(this.startSet_&&(r[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(r[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(r[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(r[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){r[t.LIMIT]=this.limit_;var n=this.viewFrom_;""===n&&(n=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),r[t.VIEW_FROM]=n}return this.index_!==rb&&(r[t.INDEX]=this.index_.toString()),r},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===rb},e.prototype.getNodeFilter=function(){return this.loadsAllData()?new am(this.getIndex()):this.hasLimit()?new bH(this):new mw(this)},e.prototype.toRestQueryStringParameters=function(){var t,r=e.REST_QUERY_CONSTANTS_,n={};return this.isDefault()?n:(this.index_===rb?t=r.PRIORITY_INDEX:this.index_===zl?t=r.VALUE_INDEX:this.index_===Id?t=r.KEY_INDEX:(cb(this.index_ instanceof Jl,"Unrecognized index type!"),t=this.index_.toString()),n[r.ORDER_BY]=Bb(t),this.startSet_&&(n[r.START_AT]=Bb(this.indexStartValue_),this.startNameSet_&&(n[r.START_AT]+=","+Bb(this.indexStartName_))),this.endSet_&&(n[r.END_AT]=Bb(this.indexEndValue_),this.endNameSet_&&(n[r.END_AT]+=","+Bb(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[r.LIMIT_TO_FIRST]=this.limit_:n[r.LIMIT_TO_LAST]=this.limit_),n)},e.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},e.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},e.DEFAULT=new e,e}(),id=function(e){function t(t,r){if(!(t instanceof Gb))throw new Error("new Reference() no longer supported - use app.database().");return e.call(this,t,r,cH.DEFAULT,!1)||this}return $b(t,e),t.prototype.getKey=function(){return fb("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return fb("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof db||(null===this.path.getFront()?MF("Reference.child",1,e,!1):wg("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){fb("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){fb("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){fb("Reference.set",1,2,arguments.length),Yb("Reference.set",this.path),Hd("Reference.set",1,e,this.path,!1),Cb("Reference.set",2,t,!0);var r=new Sb;return this.repo.setWithPriority(this.path,e,null,r.wrapCallback(t)),r.promise},t.prototype.update=function(e,t){if(fb("Reference.update",1,2,arguments.length),Yb("Reference.update",this.path),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,Mb("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Bv("Reference.update",1,e,this.path,!1),Cb("Reference.update",2,t,!0);var i=new Sb;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,r){if(fb("Reference.setWithPriority",2,3,arguments.length),Yb("Reference.setWithPriority",this.path),Hd("Reference.setWithPriority",1,e,this.path,!1),Yk("Reference.setWithPriority",2,t,!1),Cb("Reference.setWithPriority",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var n=new Sb;return this.repo.setWithPriority(this.path,e,t,n.wrapCallback(r)),n.promise},t.prototype.remove=function(e){return fb("Reference.remove",0,1,arguments.length),Yb("Reference.remove",this.path),Cb("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,r){if(fb("Reference.transaction",1,3,arguments.length),Yb("Reference.transaction",this.path),Cb("Reference.transaction",1,e,!1),Cb("Reference.transaction",2,t,!0),NF("Reference.transaction",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===r&&(r=!0);var n=new Sb;"function"==typeof t&&n.promise.catch(function(){});return this.repo.startTransaction(this.path,e,function(e,r,i){e?n.reject(e):n.resolve(new OF(r,i)),"function"==typeof t&&t(e,r,i)},r),n.promise},t.prototype.setPriority=function(e,t){fb("Reference.setPriority",1,2,arguments.length),Yb("Reference.setPriority",this.path),Yk("Reference.setPriority",1,e,!1),Cb("Reference.setPriority",2,t,!0);var r=new Sb;return this.repo.setWithPriority(this.path.child(".priority"),e,null,r.wrapCallback(t)),r.promise},t.prototype.push=function(e,t){fb("Reference.push",0,2,arguments.length),Yb("Reference.push",this.path),Hd("Reference.push",1,e,this.path,!0),Cb("Reference.push",2,t,!0);var r,n=this.repo.serverTime(),i=PF(n),a=this.child(i),o=this.child(i);return r=null!=e?a.set(e,t).then(function(){return o}):Promise.resolve(o),a.then=r.then.bind(r),a.catch=r.then.bind(r,void 0),"function"==typeof t&&r.catch(function(){}),a},t.prototype.onDisconnect=function(){return Yb("Reference.onDisconnect",this.path),new Dv(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),t}(tj);tj.__referenceConstructor=id,Sv.__referenceConstructor=id;var Eb,nw=function(){return function(){this.children={},this.childCount=0,this.value=null}}(),dH=function(){function e(e,t,r){void 0===e&&(e=""),void 0===t&&(t=null),void 0===r&&(r=new nw),this.name_=e,this.parent_=t,this.node_=r}return e.prototype.subTree=function(t){for(var r=t instanceof db?t:new db(t),n=this,i=r.getFront();null!==i;){n=new e(i,n,Xb(n.node_.children,i)||new nw),i=(r=r.popFront()).getFront()}return n},e.prototype.getValue=function(){return this.node_.value},e.prototype.setValue=function(e){cb(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},e.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},e.prototype.hasChildren=function(){return this.node_.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var r=this;Db(this.node_.children,function(n,i){t(new e(n,r,i))})},e.prototype.forEachDescendant=function(e,t,r){t&&!r&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,r)}),t&&r&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var r=t?this:this.parent();null!==r;){if(e(r))return!0;r=r.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},e.prototype.path=function(){return new db(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},e.prototype.name=function(){return this.name_},e.prototype.parent=function(){return this.parent_},e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},e.prototype.updateChild_=function(e,t){var r=t.isEmpty(),n=Nb(this.node_.children,e);r&&n?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):r||n||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},e}();!function(e){e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT"}(Eb||(Eb={})),Gb.MAX_TRANSACTION_RETRIES_=25,Gb.prototype.transactionsInit_=function(){this.transactionQueueTree_=new dH},Gb.prototype.startTransaction=function(e,t,r,n){this.log_("transaction on "+e);var i=function(){},a=new id(this,e);a.on("value",i);var o={path:e,update:t,onComplete:r,status:null,order:ov(),applyLocally:n,retryCount:0,unwatcher:function(){a.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=this.getLatestState_(e);o.currentInputSnapshot=s;var v=o.update(s.val());if(void 0===v){if(o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete){var l=new bf(o.currentInputSnapshot,new id(this,o.path),rb);o.onComplete(null,!1,l)}}else{vg("transaction failed: Data returned ",v,o.path),o.status=Eb.RUN;var u=this.transactionQueueTree_.subTree(e),$=u.getValue()||[];$.push(o),u.setValue($);var h=void 0;if("object"==typeof v&&null!==v&&Nb(v,".priority"))h=Xb(v,".priority"),cb(ug(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else h=(this.serverSyncTree_.calcCompleteEventCache(e)||hb.EMPTY_NODE).getPriority().val();h=h;var c=this.generateServerValues(),p=zb(v,h),d=Ql(p,s,c);o.currentOutputSnapshotRaw=p,o.currentOutputSnapshotResolved=d,o.currentWriteId=this.getNextWriteId_();var m=this.serverSyncTree_.applyUserOverwrite(e,d,o.currentWriteId,o.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,m),this.sendReadyTransactions_()}},Gb.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||hb.EMPTY_NODE},Gb.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var r=this.buildTransactionQueue_(e);cb(r.length>0,"Sending zero length transaction queue"),r.every(function(e){return e.status===Eb.RUN})&&this.sendTransactionQueue_(e.path(),r)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})},Gb.prototype.sendTransactionQueue_=function(e,t){for(var r=this,n=t.map(function(e){return e.currentWriteId}),i=this.getLatestState_(e,n),a=i,o=i.hash(),s=0;s<t.length;s++){var v=t[s];cb(v.status===Eb.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),v.status=Eb.SENT,v.retryCount++;var l=db.relativePath(e,v.path);a=a.updateChild(l,v.currentOutputSnapshotRaw)}var u=a.val(!0),$=e;this.server_.put($.toString(),u,function(n){r.log_("transaction put response",{path:$.toString(),status:n});var i=[];if("ok"===n){for(var a=[],o=0;o<t.length;o++){if(t[o].status=Eb.COMPLETED,i=i.concat(r.serverSyncTree_.ackUserWrite(t[o].currentWriteId)),t[o].onComplete){var s=t[o].currentOutputSnapshotResolved,v=new id(r,t[o].path),l=new bf(s,v,rb);a.push(t[o].onComplete.bind(null,null,!0,l))}t[o].unwatcher()}r.pruneCompletedTransactionsBelowNode_(r.transactionQueueTree_.subTree(e)),r.sendReadyTransactions_(),r.eventQueue_.raiseEventsForChangedPath(e,i);for(o=0;o<a.length;o++)Kf(a[o])}else{if("datastale"===n)for(o=0;o<t.length;o++)t[o].status===Eb.SENT_NEEDS_ABORT?t[o].status=Eb.NEEDS_ABORT:t[o].status=Eb.RUN;else{Mb("transaction at "+$.toString()+" failed: "+n);for(o=0;o<t.length;o++)t[o].status=Eb.NEEDS_ABORT,t[o].abortReason=n}r.rerunTransactions_(e)}},o)},Gb.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),r=t.path(),n=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(n,r),r},Gb.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var r,n=[],i=[],a=e.filter(function(e){return e.status===Eb.RUN}).map(function(e){return e.currentWriteId}),o=0;o<e.length;o++){var s=e[o],v=db.relativePath(t,s.path),l=!1,u=void 0;if(cb(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===Eb.NEEDS_ABORT)l=!0,u=s.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===Eb.RUN)if(s.retryCount>=Gb.MAX_TRANSACTION_RETRIES_)l=!0,u="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var $=this.getLatestState_(s.path,a);s.currentInputSnapshot=$;var h=e[o].update($.val());if(void 0!==h){vg("transaction failed: Data returned ",h,s.path);var c=zb(h);"object"==typeof h&&null!=h&&Nb(h,".priority")||(c=c.updatePriority($.getPriority()));var p=s.currentWriteId,d=this.generateServerValues(),m=Ql(c,$,d);s.currentOutputSnapshotRaw=c,s.currentOutputSnapshotResolved=m,s.currentWriteId=this.getNextWriteId_(),a.splice(a.indexOf(p),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(s.path,m,s.currentWriteId,s.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(p,!0))}else l=!0,u="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(t,i),i=[],l&&(e[o].status=Eb.COMPLETED,r=e[o].unwatcher,setTimeout(r,Math.floor(0)),e[o].onComplete))if("nodata"===u){var _=new id(this,e[o].path),f=e[o].currentInputSnapshot,y=new bf(f,_,rb);n.push(e[o].onComplete.bind(null,null,!1,y))}else n.push(e[o].onComplete.bind(null,new Error(u),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(o=0;o<n.length;o++)Kf(n[o]);this.sendReadyTransactions_()}},Gb.prototype.getAncestorTransactionNode_=function(e){var t,r=this.transactionQueueTree_;for(t=e.getFront();null!==t&&null===r.getValue();)r=r.subTree(t),t=(e=e.popFront()).getFront();return r},Gb.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},Gb.prototype.aggregateTransactionQueuesForNode_=function(e,t){var r=this,n=e.getValue();if(null!==n)for(var i=0;i<n.length;i++)t.push(n[i]);e.forEachChild(function(e){r.aggregateTransactionQueuesForNode_(e,t)})},Gb.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,r=e.getValue();if(r){for(var n=0,i=0;i<r.length;i++)r[i].status!==Eb.COMPLETED&&(r[n]=r[i],n++);r.length=n,e.setValue(r.length>0?r:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},Gb.prototype.abortTransactions_=function(e){var t=this,r=this.getAncestorTransactionNode_(e).path(),n=this.transactionQueueTree_.subTree(e);return n.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(n),n.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),r},Gb.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var r=[],n=[],i=-1,a=0;a<t.length;a++)if(t[a].status===Eb.SENT_NEEDS_ABORT);else if(t[a].status===Eb.SENT)cb(i===a-1,"All SENT items should be at beginning of queue."),i=a,t[a].status=Eb.SENT_NEEDS_ABORT,t[a].abortReason="set";else if(cb(t[a].status===Eb.RUN,"Unexpected transaction status in abort"),t[a].unwatcher(),n=n.concat(this.serverSyncTree_.ackUserWrite(t[a].currentWriteId,!0)),t[a].onComplete){r.push(t[a].onComplete.bind(null,new Error("set"),!1,null))}-1===i?e.setValue(null):t.length=i+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),n);for(a=0;a<r.length;a++)Kf(r[a])}};var ow,pw="databaseURL",eH="FIREBASE_DATABASE_EMULATOR_HOST",fm=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return ow||(ow=new e),ow},e.prototype.interrupt=function(){var e,t,r,n;try{for(var i=Kb(Object.keys(this.repos_)),a=i.next();!a.done;a=i.next()){var o=a.value;try{for(var s=(r=void 0,Kb(Object.keys(this.repos_[o]))),v=s.next();!v.done;v=s.next()){var l=v.value;this.repos_[o][l].interrupt()}}catch(u){r={error:u}}finally{try{v&&!v.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}catch($){e={error:$}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.resume=function(){var e,t,r,n;try{for(var i=Kb(Object.keys(this.repos_)),a=i.next();!a.done;a=i.next()){var o=a.value;try{for(var s=(r=void 0,Kb(Object.keys(this.repos_[o]))),v=s.next();!v.done;v=s.next()){var l=v.value;this.repos_[o][l].resume()}}catch(u){r={error:u}}finally{try{v&&!v.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}catch($){e={error:$}}finally{try{a&&!a.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.databaseFromApp=function(e,t,r){var n=r||e.options[pw];void 0===n&&rd("Can't determine Firebase Database URL.  Be sure to include "+pw+" option when calling firebase.initializeApp().");var i=Wk(n),a=i.repoInfo,o=void 0;return void 0!==kj&&(o=kj.env[eH]),o&&(n="http://"+o+"?ns="+a.namespace,a=(i=Wk(n)).repoInfo),Cv("Invalid Firebase Database URL",1,i),i.path.isEmpty()||rd("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(a,e,t).database},e.prototype.deleteRepo=function(e){var t=Xb(this.repos_,e.app.name);t&&Xb(t,e.repoInfo_.toURLString())===e||rd("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.repoInfo_.toURLString()]},e.prototype.createRepo=function(e,t,r){var n=Xb(this.repos_,t.name);n||(n={},this.repos_[t.name]=n);var i=Xb(n,e.toURLString());return i&&rd("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Gb(e,this.useRestClient_,t,r),n[e.toURLString()]=i,i},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}(),wj=function(){function e(e){this.repo_=e,e instanceof Gb||rd("Don't call new Database() directly - please use firebase.database()."),this.root_=new id(e,db.Empty),this.INTERNAL=new fH(this)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),e.prototype.ref=function(e){return this.checkDeleted_("ref"),fb("database.ref",0,1,arguments.length),e instanceof id?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),fb(t,1,1,arguments.length);var r=Wk(e);Cv(t,1,r);var n=r.repoInfo;return n.host!==this.repo_.repoInfo_.host&&rd(t+": Host name does not match the current database: (found "+n.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(r.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repo_&&rd("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){fb("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){fb("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(e){return{".sv":{increment:e}}}},e}(),fH=function(){function e(e){this.database=e}return e.prototype.delete=function(){return Lq(this,void 0,void 0,function(){return Mq(this,function(e){return this.database.checkDeleted_("delete"),fm.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},e}(),gH=function(){cf.forceDisallow(),cm.forceAllow()},hH=function(){cm.forceDisallow()},iH=function(){return cf.isAvailable()},jH=function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},kH=function(e,t){e.repo.stats(t)},lH=function(e,t){e.repo.statsIncrementCounter(t)},mH=function(e){return e.repo.dataUpdateCount},nH=function(e,t){return e.repo.interceptServerData_(t)},oH=Object.freeze({__proto__:null,forceLongPolling:gH,forceWebSockets:hH,isWebSocketsAvailable:iH,setSecurityDebugCallback:jH,stats:kH,statsIncrementCounter:lH,dataUpdateCount:mH,interceptServerData:nH}),pH=df;df.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},df.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var qH=iw,rH=function(e){var t=df.prototype.put;return df.prototype.put=function(r,n,i,a){void 0!==a&&(a=e()),t.call(this,r,n,i,a)},function(){df.prototype.put=t}},sH=yv,tH=function(e){return e.queryIdentifier()},uH=function(e){fm.getInstance().forceRestClient(e)},vH=Object.freeze({__proto__:null,DataConnection:pH,RealTimeConnection:qH,hijackHash:rH,ConnectionTarget:sH,queryIdentifier:tH,forceRestClient:uH}),wH="@firebase/database",xH="0.6.5",qw=wj.ServerValue;function rw(e){MG(e.SDK_VERSION);var t=e.INTERNAL.registerComponent(new ng("database",function(e,t){var r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal");return fm.getInstance().databaseFromApp(r,n,t)},"PUBLIC").setServiceProps({Reference:id,Query:tj,Database:wj,DataSnapshot:bf,enableLogging:Sk,INTERNAL:oH,ServerValue:qw,TEST_ACCESS:vH}).setMultipleInstances(!0));e.registerVersion(wH,xH),gd()&&(qd=t)}rw(sF);var yH=bf;qd.DataSnapshot=yH;var zH=wj;qd.Database=zH;var AH=Dv;qd.OnDisconnect=AH;var BH=tj;qd.Query=BH;var CH=id;qd.Reference=CH;var DH=qw;qd.ServerValue=DH;var EH=Sk;qd.enableLogging=EH;var FH=rw;qd.registerDatabase=FH;var gm=Am(lv);gm.d.initializeApp({apiKey:"AIzaSyDMhnS2dJk0yTMERT0j4g6jEQ80_nikPHw",authDomain:"flickering-torch-6356.firebaseapp.com",databaseURL:"https://flickering-torch-6356.firebaseio.com",projectId:"flickering-torch-6356",storageBucket:"flickering-torch-6356.appspot.com",messagingSenderId:"60549942221"});var sw=gm.d.auth();bj.auth=sw;var tw=gm.d.database();bj.database=tw;function GH(r,t){return KH(r)||JH(r,t)||IH(r,t)||HH()}function HH(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function IH(r,t){if(r){if("string"==typeof r)return uw(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?uw(r,t):void 0}}function uw(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,a=new Array(t);e<t;e++)a[e]=r[e];return a}function JH(r,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var e=[],a=!0,n=!1,o=void 0;try{for(var $,i=r[Symbol.iterator]();!(a=($=i.next()).done)&&(e.push($.value),!t||e.length!==t);a=!0);}catch(l){n=!0,o=l}finally{try{a||null==i.return||i.return()}finally{if(n)throw o}}return e}}function KH(r){if(Array.isArray(r))return r}function vw(r){var t=GH(r,4),e=t[0],a=t[1],n=t[2],o=t[3],$=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=e+e,l=a+a,u=n+n,y=e*i,v=e*l,c=e*u,f=a*l,s=a*u,L=n*u,O=o*i,b=o*l,d=o*u;return $[0]=1-(f+L),$[1]=v+d,$[2]=c-b,$[4]=v-d,$[5]=1-(y+L),$[6]=s+O,$[8]=c+b,$[9]=s-O,$[10]=1-(y+f),$}function LH(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function ww(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function MH(t,i,e){return i&&ww(t.prototype,i),e&&ww(t,e),t}function Nf($){return Math.abs(parseInt("".concat($),10))}function Ib($,n){return $.x*n.x+$.y*n.y}function Of($,n){return $.x*n.y-$.y*n.x}function ef($){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new ab(n*$.y,-n*$.x)}function xj(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return new ab(-$*n.y,$*n.x)}function ff($,n){return new ab($.col1.x*n.x+$.col2.x*n.y,$.col1.y*n.x+$.col2.y*n.y)}function Jd($,n){return new ab(Ib(n,$.col1),Ib(n,$.col2))}function wb($,n){var o=ff($.R,n);return o.x+=$.position.x,o.y+=$.position.y,o}function NH($,n){var o=sb(n,$.position),t=o.x*$.R.col1.x+o.y*$.R.col1.y;return o.y=o.x*$.R.col2.x+o.y*$.R.col2.y,o.x=t,o}function yj($,n){return new ab($.x+n.x,$.y+n.y)}function sb($,n){return new ab($.x-n.x,$.y-n.y)}function xw(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return new ab($*n.x,$*n.y)}function hm(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return $>0?$:-$}function OH($){return new ab(hm($.x),hm($.y))}function PH(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $<n?$:n}function zg(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $>n?$:n}function vd(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $<n?n:$>o?o:$}function QH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yw(e,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function RH(e,t,o){return t&&yw(e.prototype,t),o&&yw(e,o),e}var Kd=function(){function e(){QH(this,e),this.col1=new ab,this.col2=new ab,this.SetIdentity()}return RH(e,[{key:"Set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Math.cos(e),o=Math.sin(e);this.col1.x=t,this.col2.x=-o,this.col1.y=o,this.col2.y=t}},{key:"SetVV",value:function(e,t){this.col1.SetV(e),this.col2.SetV(t)}},{key:"Copy",value:function(){var t=new e;return t.SetM(this),t}},{key:"SetM",value:function(e){this.col1.SetV(e.col1),this.col2.SetV(e.col2)}},{key:"AddM",value:function(e){this.col1.x+=e.col1.x,this.col1.y+=e.col1.y,this.col2.x+=e.col2.x,this.col2.y+=e.col2.y}},{key:"SetIdentity",value:function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1}},{key:"SetZero",value:function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0}},{key:"GetAngle",value:function(){return Math.atan2(this.col1.y,this.col1.x)}},{key:"GetInverse",value:function(e){var t=this.col1.x,o=this.col2.x,l=this.col1.y,c=this.col2.y,i=t*c-o*l;return 0!==i&&(i=1/i),e.col1.x=i*c,e.col2.x=-i*o,e.col1.y=-i*l,e.col2.y=i*t,e}},{key:"Solve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=this.col1.x,c=this.col2.x,i=this.col1.y,n=this.col2.y,r=l*n-c*i;return 0!==r&&(r=1/r),e.x=r*(n*t-c*o),e.y=r*(l*o-i*t),e}},{key:"Abs",value:function(){this.col1.Abs(),this.col2.Abs()}}],[{key:"FromAngle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=new e;return o.Set(t),o}},{key:"FromVV",value:function(t,o){var l=new e;return l.SetVV(t,o),l}}]),e}();var ab=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;LH(this,t),this.x=i,this.y=e}return MH(t,[{key:"SetZero",value:function(){this.x=0,this.y=0}},{key:"Set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=t,this.y=i}},{key:"SetV",value:function(t){this.x=t.x,this.y=t.y}},{key:"GetNegative",value:function(){return new t(-this.x,-this.y)}},{key:"NegativeSelf",value:function(){this.x=-this.x,this.y=-this.y}},{key:"Copy",value:function(){return new t(this.x,this.y)}},{key:"Add",value:function(t){this.x+=t.x,this.y+=t.y}},{key:"Subtract",value:function(t){this.x-=t.x,this.y-=t.y}},{key:"Multiply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.x*=t,this.y*=t}},{key:"MulM",value:function(t){var i=this.x;this.x=t.col1.x*i+t.col2.x*this.y,this.y=t.col1.y*i+t.col2.y*this.y}},{key:"MulTM",value:function(t){var i=Ib(this,t.col1);this.y=Ib(this,t.col2),this.x=i}},{key:"CrossVF",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.x;this.x=t*this.y,this.y=-t*i}},{key:"CrossFV",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.x;this.x=-t*this.y,this.y=t*i}},{key:"MinV",value:function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y}},{key:"MaxV",value:function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y}},{key:"Abs",value:function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)}},{key:"Length",value:function(){return Math.hypot(this.x,this.y)}},{key:"LengthSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"Normalize",value:function(){var t=this.Length();if(t<Number.MIN_VALUE)return 0;var i=1/t;return this.x*=i,this.y*=i,t}},{key:"IsValid",value:function(){return isFinite(this.x)&&isFinite(this.y)}}],[{key:"Make",value:function(){return new t(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}}]),t}();function SH(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function TH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zw(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function UH(t,e,i){return e&&zw(t.prototype,e),i&&zw(t,i),t}var im=Math.PI;var cd=2;var zj=.1;var Aw=2;var wd=.005;var Ag=8*wd;var VH=32;var WH=32;var XH=1;var YH=.2;var Pf=2;var Bw=Pf*Pf;var Qf=.5*im;var Cw=Qf*Qf;var jm=.2;var ZH=.5;var Dw=.01;var Ew=2/180*im;function $H(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.sqrt($*r)}function _H(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $>r?$:r}function xb($){if(!$)throw new Error("Assertion failed!")}function aI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fw(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function bI(t,e,i){return e&&Fw(t.prototype,e),i&&Fw(t,i),t}var gf=function(){function t(){aI(this,t),this.localCenter=new ab,this.c0=new ab,this.c=new ab,this.a0=0,this.a=0,this.t0=0}return bI(t,[{key:"Set",value:function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0}},{key:"Copy",value:function(){var e=new t;return e.Set(this),e}},{key:"GetTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var s=t.R;t.position.x-=s.col1.x*this.localCenter.x+s.col2.x*this.localCenter.y,t.position.y-=s.col1.y*this.localCenter.x+s.col2.y*this.localCenter.y}},{key:"Advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}}}]),t}();function cI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Gw(e,t){for(var a=0;a<t.length;a++){var c=t[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function dI(e,t,a){return t&&Gw(e.prototype,t),a&&Gw(e,a),e}var xd=function(){function e(t,a){cI(this,e),this.position=new ab,this.R=new Kd,t&&this.position.SetV(t),a&&this.R.SetM(a)}return dI(e,[{key:"Initialize",value:function(e,t){this.position.SetV(e),this.R.SetM(t)}},{key:"SetIdentity",value:function(){this.position.SetZero(),this.R.SetIdentity()}},{key:"Set",value:function(e){this.position.SetV(e.position),this.R.SetM(e.R)}},{key:"GetAngle",value:function(){return Math.atan2(this.R.col1.y,this.R.col1.x)}}]),e}();function eI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hw(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fI(t,e,r){return e&&Hw(t.prototype,e),r&&Hw(t,r),t}function gI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Iw(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function hI(t,e,r){return e&&Iw(t.prototype,e),r&&Iw(t,r),t}var Jw=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;gI(this,t),this._r=0,this._g=0,this._b=0,this.Set(e,r,n)}return hI(t,[{key:"Set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.r=t,this.g=e,this.b=r}},{key:"r",get:function(){return this._r},set:function(t){this._r=Nf(255*vd(t,0,1))}},{key:"g",get:function(){return this._g},set:function(t){this._g=Nf(255*vd(t,0,1))}},{key:"b",get:function(){return this._b},set:function(t){this._b=Nf(255*vd(t,0,1))}},{key:"color",get:function(){return this._r<<16|this._g<<8|this._b}}]),t}();function iI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kw(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function jI(t,e,i){return e&&Kw(t.prototype,e),i&&Kw(t,i),t}var Ob=function(){function t(){var e=this;iI(this,t),this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1,this.m_sprite={graphics:{clear:function(){if(e.m_ctx){var t=e.m_ctx.canvas,i=t.width,a=t.height;e.m_ctx.clearRect(0,0,i,a)}}}},this.m_drawFlags=0}return jI(t,[{key:"_color",value:function(t,e){return"rgba(".concat((16711680&t)>>16,",").concat((65280&t)>>8,",").concat(255&t,",").concat(e,")")}},{key:"SetFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags=t}},{key:"GetFlags",value:function(){return this.m_drawFlags}},{key:"AppendFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags|=t}},{key:"ClearFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags&=~t}},{key:"SetSprite",value:function(t){this.m_ctx=t}},{key:"GetSprite",value:function(){return this.m_ctx}},{key:"SetDrawScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawScale=t}},{key:"GetDrawScale",value:function(){return this.m_drawScale}},{key:"SetLineThickness",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_lineThickness=t,this.m_ctx&&(this.m_ctx.lineWidth=t)}},{key:"GetLineThickness",value:function(){return this.m_lineThickness}},{key:"SetAlpha",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_alpha=t}},{key:"GetAlpha",value:function(){return this.m_alpha}},{key:"SetFillAlpha",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_fillAlpha=t}},{key:"GetFillAlpha",value:function(){return this.m_fillAlpha}},{key:"SetXFormScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_xformScale=t}},{key:"GetXFormScale",value:function(){return this.m_xformScale}},{key:"DrawPolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.moveTo(t[0].x*l,t[0].y*l);for(var o=1;o<e;o++)a.lineTo(t[o].x*l,t[o].y*l);a.lineTo(t[0].x*l,t[0].y*l),a.closePath(),a.stroke()}}},{key:"DrawSolidPolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.fillStyle=this._color(i.color,this.m_fillAlpha),a.moveTo(t[0].x*l,t[0].y*l);for(var o=1;o<e;o++)a.lineTo(t[o].x*l,t[o].y*l);a.lineTo(t[0].x*l,t[0].y*l),a.closePath(),a.fill(),a.stroke()}}},{key:"DrawCircle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale,o=t.x*l,r=t.y*l;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.arc(o,r,e*l,0,2*Math.PI,!0),a.closePath(),a.stroke()}}},{key:"DrawSolidCircle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(this.m_ctx&&e){var l=this.m_ctx,o=this.m_drawScale,r=t.x*o,s=t.y*o;l.moveTo(0,0),l.beginPath(),l.strokeStyle=this._color(a.color,this.m_alpha),l.fillStyle=this._color(a.color,this.m_fillAlpha),l.arc(r,s,e*o,0,2*Math.PI,!0),l.moveTo(r,s),l.lineTo((t.x+i.x*e)*o,(t.y+i.y*e)*o),l.closePath(),l.fill(),l.stroke()}}},{key:"DrawSegment",value:function(t,e,i){if(this.m_ctx){var a=this.m_ctx,l=this.m_drawScale;a.strokeStyle=this._color(i.color,this.m_alpha),a.beginPath(),a.moveTo(t.x*l,t.y*l),a.lineTo(e.x*l,e.y*l),a.closePath(),a.stroke()}}},{key:"DrawTransform",value:function(t){if(this.m_ctx){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}}]),t}();Ob.e_shapeBit=1,Ob.e_jointBit=2,Ob.e_aabbBit=4,Ob.e_pairBit=8,Ob.e_centerOfMassBit=16,Ob.e_controllerBit=32;function kI(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Lw(t,r){for(var e=0;e<r.length;e++){var i=r[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function lI(t,r,e){return r&&Lw(t.prototype,r),e&&Lw(t,e),t}var km=function(){function t(){kI(this,t),this.dt=1/60,this.inv_dt=1/this.dt,this.positionIterations=10,this.velocityIterations=10,this.dtRatio=1,this.warmStarting=!0}return lI(t,[{key:"Set",value:function(t){var r=t.dt,e=t.inv_dt,i=t.positionIterations,a=t.velocityIterations,n=t.warmStarting;this.dt=r,this.inv_dt=e,this.positionIterations=i,this.velocityIterations=a,this.warmStarting=n}}]),t}();function mI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mw(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function nI(t,e,o){return e&&Mw(t.prototype,e),o&&Mw(t,o),t}function oI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Nw(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function pI(e,r,t){return r&&Nw(e.prototype,r),t&&Nw(e,t),e}function qI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ow(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function rI(t,e,i){return e&&Ow(t.prototype,e),i&&Ow(t,i),t}function sI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Pw(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function tI(e,r,t){return r&&Pw(e.prototype,r),t&&Pw(e,t),e}var Qw=function(){function e(){sI(this,e),this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return tI(e,[{key:"Copy",value:function(){var r=new e;return r.categoryBits=this.categoryBits,r.maskBits=this.maskBits,r.groupIndex=this.groupIndex,r}}]),e}();function uI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Rw(e,r){for(var n=0;n<r.length;n++){var u=r[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}function vI(e,r,n){return r&&Rw(e.prototype,r),n&&Rw(e,n),e}var Ld=function(){function e(){uI(this,e),this.lowerBound=new ab,this.upperBound=new ab}return vI(e,[{key:"IsValid",value:function(){var e=this.upperBound.x-this.lowerBound.x,r=this.upperBound.y-this.lowerBound.y;return e>=0&&r>=0&&this.lowerBound.IsValid()&&this.upperBound.IsValid()}},{key:"GetCenter",value:function(){return new ab((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)}},{key:"GetExtents",value:function(){return new ab((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)}},{key:"Contains",value:function(e){return this.lowerBound.x<=e.lowerBound.x&&this.lowerBound.y<=e.lowerBound.y&&e.upperBound.x<=this.upperBound.x&&e.upperBound.y<=this.upperBound.y}},{key:"RayCast",value:function(e,r){var n=-Number.MAX_VALUE,u=Number.MAX_VALUE,o=r.p1.x,t=r.p1.y,i=r.p2.x-r.p1.x,p=r.p2.y-r.p1.y,a=Math.abs(i),s=Math.abs(p),d=e.normal,l=0,B=0,h=0,$=0,y=0;if(a<Number.MIN_VALUE){if(o<this.lowerBound.x||this.upperBound.x<o)return!1}else if(l=1/i,y=-1,(B=(this.lowerBound.x-o)*l)>(h=(this.upperBound.x-o)*l)&&($=B,B=h,h=$,y=1),B>n&&(d.x=y,d.y=0,n=B),n>(u=Math.min(u,h)))return!1;if(s<Number.MIN_VALUE){if(t<this.lowerBound.y||this.upperBound.y<t)return!1}else if(l=1/p,y=-1,(B=(this.lowerBound.y-t)*l)>(h=(this.upperBound.y-t)*l)&&($=B,B=h,h=$,y=1),B>n&&(d.y=y,d.x=0,n=B),n>(u=Math.min(u,h)))return!1;return e.fraction=n,!0}},{key:"TestOverlap",value:function(e){var r=e.lowerBound.x-this.upperBound.x,n=e.lowerBound.y-this.upperBound.y,u=this.lowerBound.x-e.upperBound.x,o=this.lowerBound.y-e.upperBound.y;return r<0||n<0||u<0||o<0}},{key:"Combine",value:function(e,r){this.lowerBound.x=Math.min(e.lowerBound.x,r.lowerBound.x),this.lowerBound.y=Math.min(e.lowerBound.y,r.lowerBound.y),this.upperBound.x=Math.max(e.upperBound.x,r.upperBound.x),this.upperBound.y=Math.max(e.upperBound.y,r.upperBound.y)}}],[{key:"Combine",value:function(r,n){var u=new e;return u.Combine(r,n),u}}]),e}();function wI(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function Sw(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xI(e,n,t){return n&&Sw(e.prototype,n),t&&Sw(e,t),e}function yI(o,r){if(!(o instanceof r))throw new TypeError("Cannot call a class as a function")}function zI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tw(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function AI(e,t,r){return t&&Tw(e.prototype,t),r&&Tw(e,r),e}var Rf=function(){function e(){zI(this,e),this.m_vertices=[],this.m_count=0,this.m_radius=0}return AI(e,[{key:"Set",value:function(e){switch(e.GetType()){case nb.e_circleShape:var t=e;this.m_vertices=[t.m_p],this.m_count=1,this.m_radius=t.m_radius;break;case nb.e_polygonShape:var r=e;this.m_vertices=r.m_vertices,this.m_count=r.m_vertexCount,this.m_radius=r.m_radius;break;default:xb(!1);}}},{key:"GetSupport",value:function(e){for(var t=0,r=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y,i=1;i<this.m_count;++i){var s=this.m_vertices[i].x*e.x+this.m_vertices[i].y*e.y;s>r&&(t=i,r=s)}return t}},{key:"GetSupportVertex",value:function(e){for(var t=0,r=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y,i=1;i<this.m_count;++i){var s=this.m_vertices[i].x*e.x+this.m_vertices[i].y*e.y;s>r&&(t=i,r=s)}return this.m_vertices[t]}},{key:"GetVertexCount",value:function(){return this.m_count}},{key:"GetVertex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return xb(0<=e&&e<this.m_count),this.m_vertices[e]}}]),e}();var Uw=function o(){yI(this,o),this.proxyA=new Rf,this.proxyB=new Rf,this.transformA=new xd,this.transformB=new xd,this.sweepA=new gf,this.sweepB=new gf,this.useRadii=!1};function BI(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var Vw=function s(){BI(this,s),this.pointA=new ab,this.pointB=new ab,this.distance=0,this.iterations=0};function CI(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var Ww=function a(){CI(this,a),this.indexA=new Array(3).fill(0),this.indexB=new Array(3).fill(0),this.count=0,this.metric=0};function DI(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Xw(t,i){for(var e=0;e<i.length;e++){var r=i[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function EI(t,i,e){return i&&Xw(t.prototype,i),e&&Xw(t,e),t}function FI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yw(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function GI(e,t,r){return t&&Yw(e.prototype,t),r&&Yw(e,r),e}var lm=function(){function e(){FI(this,e),this.wA=new ab,this.wB=new ab,this.w=new ab,this.a=0,this.indexA=0,this.indexB=0}return GI(e,[{key:"Set",value:function(e){this.wA.SetV(e.wA),this.wB.SetV(e.wB),this.w.SetV(e.w),this.a=e.a,this.indexA=e.indexA,this.indexB=e.indexB}}]),e}();var HI=function(){function t(){DI(this,t),this.m_v1=new lm,this.m_v2=new lm,this.m_v3=new lm,this.m_vertices=new Array(3),this.m_count=0,this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3}return EI(t,[{key:"ReadCache",value:function(t,i,e,r,s){var m,$;xb(0<=t.count&&t.count<=3),this.m_count=t.count;for(var o,v=this.m_vertices,a=0;a<this.m_count;a++)(o=v[a]).indexA=t.indexA[a],o.indexB=t.indexB[a],m=i.GetVertex(o.indexA),$=r.GetVertex(o.indexB),o.wA=wb(e,m),o.wB=wb(s,$),o.w=sb(o.wB,o.wA),o.a=0;if(this.m_count>1){var h=t.metric,n=this.GetMetric();(n<.5*h||2*h<n||n<Number.MIN_VALUE)&&(this.m_count=0)}0===this.m_count&&((o=v[0]).indexA=0,o.indexB=0,m=i.GetVertex(0),$=r.GetVertex(0),o.wA=wb(e,m),o.wB=wb(s,$),o.w=sb(o.wB,o.wA),this.m_count=1)}},{key:"WriteCache",value:function(t){t.metric=this.GetMetric(),t.count=Nf(this.m_count);for(var i=this.m_vertices,e=0;e<this.m_count;e++)t.indexA[e]=Nf(i[e].indexA),t.indexB[e]=Nf(i[e].indexB)}},{key:"GetSearchDirection",value:function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=sb(this.m_v2.w,this.m_v1.w);return Of(t,this.m_v1.w.GetNegative())>0?xj(1,t):ef(t,1);default:return xb(!1),new ab;}}},{key:"GetClosestPoint",value:function(){switch(this.m_count){case 0:return xb(!1),new ab;case 1:return this.m_v1.w;case 2:return new ab(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return xb(!1),new ab;}}},{key:"GetWitnessPoints",value:function(t,i){switch(this.m_count){case 0:xb(!1);break;case 1:t.SetV(this.m_v1.wA),i.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,i.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,i.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:i.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,i.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:xb(!1);}}},{key:"GetMetric",value:function(){switch(this.m_count){case 0:return xb(!1),0;case 1:return 0;case 2:return sb(this.m_v1.w,this.m_v2.w).Length();case 3:return Of(sb(this.m_v2.w,this.m_v1.w),sb(this.m_v3.w,this.m_v1.w));default:return xb(!1),0;}}},{key:"Solve2",value:function(){var t=this.m_v1.w,i=this.m_v2.w,e=sb(i,t),r=-(t.x*e.x+t.y*e.y);if(r<=0)return this.m_v1.a=1,void(this.m_count=1);var s=i.x*e.x+i.y*e.y;if(s<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var m=1/(s+r);this.m_v1.a=s*m,this.m_v2.a=r*m,this.m_count=2}},{key:"Solve3",value:function(){var t=this.m_v1.w,i=this.m_v2.w,e=this.m_v3.w,r=sb(i,t),s=Ib(t,r),m=Ib(i,r),$=-s,o=sb(e,t),v=Ib(t,o),a=Ib(e,o),h=-v,n=sb(e,i),_=Ib(i,n),c=Ib(e,n),u=-_,A=Of(r,o),p=A*Of(i,e),P=A*Of(e,t),w=A*Of(t,i);if($<=0&&h<=0)return this.m_v1.a=1,void(this.m_count=1);if(m>0&&$>0&&w<=0){var J=1/(m+$);return this.m_v1.a=m*J,this.m_v2.a=$*J,void(this.m_count=2)}if(a>0&&h>0&&P<=0){var V=1/(a+h);return this.m_v1.a=a*V,this.m_v3.a=h*V,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(m<=0&&u<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(a<=0&&c<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(c>0&&u>0&&p<=0){var l=1/(c+u);return this.m_v2.a=c*l,this.m_v3.a=u*l,this.m_count=2,void this.m_v1.Set(this.m_v3)}var x=1/(p+P+w);this.m_v1.a=p*x,this.m_v2.a=P*x,this.m_v3.a=w*x,this.m_count=3}}]),t}();var II=new HI;var JI=new Array(3).fill(0);var KI=new Array(3).fill(0);var LI=0;var MI=0;var NI=0;function Zw(e,t,$){++LI;var r=$.proxyA,o=$.proxyB,s=$.transformA,i=$.transformB,a=II;a.ReadCache(t,r,s,o,i);for(var p,d=a.m_vertices,x=JI,n=KI,N=0,E=(a.GetClosestPoint().LengthSquared(),0);E<20;){N=a.m_count;for(var _=0;_<N;_++)x[_]=d[_].indexA,n[_]=d[_].indexB;switch(a.m_count){case 1:break;case 2:a.Solve2();break;case 3:a.Solve3();break;default:xb(!1);}if(3===a.m_count)break;(p=a.GetClosestPoint()).LengthSquared();var m=a.GetSearchDirection();if(m.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var l=d[a.m_count];l.indexA=r.GetSupport(Jd(s.R,m.GetNegative())),l.wA=wb(s,r.GetVertex(l.indexA)),l.indexB=o.GetSupport(Jd(i.R,m)),l.wB=wb(i,o.GetVertex(l.indexB)),l.w=sb(l.wB,l.wA),++E,++MI;for(var c=!1,b=0;b<N;b++)if(l.indexA===x[b]&&l.indexB===n[b]){c=!0;break}if(c)break;++a.m_count}if(NI=zg(NI,E),a.GetWitnessPoints(e.pointA,e.pointB),e.distance=sb(e.pointA,e.pointB).Length(),e.iterations=E,a.WriteCache(t),$.useRadii){var u=r.m_radius,v=o.m_radius;if(e.distance>u+v&&e.distance>Number.MIN_VALUE){e.distance-=u+v;var A=sb(e.pointB,e.pointA);A.Normalize(),e.pointA.x+=u*A.x,e.pointA.y+=u*A.y,e.pointB.x-=v*A.x,e.pointB.y-=v*A.y}else(p=new ab).x=.5*(e.pointA.x+e.pointB.x),p.y=.5*(e.pointA.y+e.pointB.y),e.pointA.x=e.pointB.x=p.x,e.pointA.y=e.pointB.y=p.y,e.distance=0}}var nb=function(){function e(){wI(this,e),this.m_type=e.e_unknownShape,this.m_radius=wd}return xI(e,[{key:"Set",value:function(e){this.m_radius=e.m_radius}},{key:"GetType",value:function(){return this.m_type}},{key:"TestPoint",value:function(e,n){return!1}},{key:"RayCast",value:function(e,n,t){return!1}},{key:"ComputeAABB",value:function(e,n){}},{key:"ComputeMass",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}],[{key:"TestOverlap",value:function(e,n,t,r){var u=new Uw;u.proxyA=new Rf,u.proxyA.Set(e),u.proxyB=new Rf,u.proxyB.Set(t),u.transformA=n,u.transformB=r,u.useRadii=!0;var a=new Ww;a.count=0;var $=new Vw;return Zw($,a,u),$.distance<10*Number.MIN_VALUE}}]),e}();nb.e_unknownShape=parseInt("-1",10),nb.e_circleShape=0,nb.e_polygonShape=1,nb.e_edgeShape=2,nb.e_shapeTypeCount=3,nb.e_hitCollide=1,nb.e_missCollide=0,nb.e_startsInsideCollide=parseInt("-1",10);function OI(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var $w=function a(){OI(this,a),this.mass=0,this.center=new ab(0,0),this.I=0};var Bg=function(){function t(){qI(this,t),this.m_filter=new Qw,this.m_aabb=new Ld,this.m_density=0,this.m_friction=0,this.m_restitution=0,this.m_isSensor=!1}return rI(t,[{key:"GetType",value:function(){return this.m_shape?this.m_shape.GetType():nb.e_unknownShape}},{key:"GetShape",value:function(){return this.m_shape}},{key:"SetSensor",value:function(t){if(this.m_isSensor!==t&&(this.m_isSensor=t,this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,s=i.GetFixtureA(),r=i.GetFixtureB();s!==this&&r!==this||i.SetSensor(s.IsSensor()||r.IsSensor()),e=e.next}}},{key:"IsSensor",value:function(){return this.m_isSensor}},{key:"SetFilterData",value:function(t){if(this.m_filter=t.Copy(),this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,s=i.GetFixtureA(),r=i.GetFixtureB();s!==this&&r!==this||i.FlagForFiltering(),e=e.next}}},{key:"GetFilterData",value:function(){return this.m_filter.Copy()}},{key:"GetBody",value:function(){return this.m_body}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(t){this.m_userData=t}},{key:"TestPoint",value:function(t){return!(!this.m_shape||!this.m_body)&&this.m_shape.TestPoint(this.m_body.GetTransform(),t)}},{key:"RayCast",value:function(t,e){return!(!this.m_shape||!this.m_body)&&this.m_shape.RayCast(t,e,this.m_body.GetTransform())}},{key:"GetMassData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new $w;return!(!this.m_shape||!this.m_body)&&(this.m_shape.ComputeMass(t,this.m_density),t)}},{key:"SetDensity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_density=t}},{key:"GetDensity",value:function(){return this.m_density}},{key:"GetFriction",value:function(){return this.m_friction}},{key:"SetFriction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_friction=t}},{key:"GetRestitution",value:function(){return this.m_restitution}},{key:"SetRestitution",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_restitution=t}},{key:"GetAABB",value:function(){return this.m_aabb}},{key:"Create",value:function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=void 0,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density}},{key:"Destroy",value:function(){this.m_shape=void 0}},{key:"CreateProxy",value:function(t,e){if(!this.m_shape||!this.m_body)return!1;this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)}},{key:"DestroyProxy",value:function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=void 0)}},{key:"Synchronize",value:function(t,e,i){if(this.m_proxy&&this.m_shape){var s=new Ld,r=new Ld;this.m_shape.ComputeAABB(s,e),this.m_shape.ComputeAABB(r,i),this.m_aabb.Combine(s,r);var n=sb(i.position,e.position);t.MoveProxy(this.m_proxy,this.m_aabb,n)}}}]),t}();var mm=function(){function e(){oI(this,e)}return pI(e,[{key:"ShouldCollide",value:function(e,r){var t=e.GetFilterData(),a=r.GetFilterData();return t.groupIndex===a.groupIndex&&0!==t.groupIndex?t.groupIndex>0:0!=(t.maskBits&a.categoryBits)&&0!=(t.categoryBits&a.maskBits)}},{key:"RayCollide",value:function(e,r){return!(e instanceof Bg)||this.ShouldCollide(e,r)}}]),e}();mm.b2_defaultFilter=new mm;function PI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _w(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function QI(e,t,a){return t&&_w(e.prototype,t),a&&_w(e,a),e}var nm=function(){function e(){PI(this,e)}return QI(e,[{key:"BeginContact",value:function(e){}},{key:"EndContact",value:function(e){}},{key:"PreSolve",value:function(e,t){}},{key:"PostSolve",value:function(e,t){}}]),e}();nm.b2_defaultListener=new nm;function RI(e,r){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=SI(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,u=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){u=!0,n=e},f:function(){try{i||null==t.return||t.return()}finally{if(u)throw n}}}}function SI(e,r){if(e){if("string"==typeof e)return ax(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ax(e,r):void 0}}function ax(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=new Array(r);t<r;t++)a[t]=e[t];return a}function TI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function bx(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function UI(e,r,t){return r&&bx(e.prototype,r),t&&bx(e,t),e}function VI(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function cx(e,a){for(var r=0;r<a.length;r++){var t=a[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function WI(e,a,r){return a&&cx(e.prototype,a),r&&cx(e,r),e}function XI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function dx(e,r){for(var a=0;a<r.length;a++){var $=r[a];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function YI(e,r,a){return r&&dx(e.prototype,r),a&&dx(e,a),e}var ZI=function(){function e(){XI(this,e),this.aabb=new Ld}return YI(e,[{key:"IsLeaf",value:function(){return null==this.child1}}]),e}();function $I(t,$){if(!(t instanceof $))throw new TypeError("Cannot call a class as a function")}var ex=function t(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ab,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ab,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;$I(this,t),this.p1=$,this.p2=a,this.maxFraction=e};var _I=function(){function e(){VI(this,e),this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0}return WI(e,[{key:"CreateProxy",value:function(e,a){var r=this.AllocateNode(),t=zj,o=zj;return r.aabb.lowerBound.x=e.lowerBound.x-t,r.aabb.lowerBound.y=e.lowerBound.y-o,r.aabb.upperBound.x=e.upperBound.x+t,r.aabb.upperBound.y=e.upperBound.y+o,r.userData=a,this.InsertLeaf(r),r}},{key:"DestroyProxy",value:function(e){this.RemoveLeaf(e),this.FreeNode(e)}},{key:"MoveProxy",value:function(e,a,r){if(xb(e.IsLeaf()),e.aabb.Contains(a))return!1;this.RemoveLeaf(e);var t=zj+Aw*(r.x>0?r.x:-r.x),o=zj+Aw*(r.y>0?r.y:-r.y);return e.aabb.lowerBound.x=a.lowerBound.x-t,e.aabb.lowerBound.y=a.lowerBound.y-o,e.aabb.upperBound.x=a.upperBound.x+t,e.aabb.upperBound.y=a.upperBound.y+o,this.InsertLeaf(e),!0}},{key:"Rebalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.m_root)for(var a=0;a<e;a++){for(var r=this.m_root,t=0;!r.IsLeaf();)r=this.m_path>>t&1?r.child2:r.child1,t=t+1&31;++this.m_path,this.RemoveLeaf(r),this.InsertLeaf(r)}}},{key:"GetFatAABB",value:function(e){return e.aabb}},{key:"GetUserData",value:function(e){return e.userData}},{key:"Query",value:function(e,a){if(this.m_root){var r=[],t=0;for(r[t++]=this.m_root;t>0;){var o=r[--t];if(o.aabb.TestOverlap(a))if(o.IsLeaf()){if(!e(o))return}else r[t++]=o.child1,r[t++]=o.child2}}}},{key:"RayCast",value:function(e,a){if(this.m_root){var r=a.p1,t=a.p2,o=sb(r,t);o.Normalize();var i=xj(1,o),n=OH(i),u=a.maxFraction,l=new Ld,b=0,s=0;b=r.x+u*(t.x-r.x),s=r.y+u*(t.y-r.y),l.lowerBound.x=Math.min(r.x,b),l.lowerBound.y=Math.min(r.y,s),l.upperBound.x=Math.max(r.x,b),l.upperBound.y=Math.max(r.y,s);var p=[],h=0;for(p[h++]=this.m_root;h>0;){var $=p[--h];if(!1!==$.aabb.TestOverlap(l)){var v=$.aabb.GetCenter(),d=$.aabb.GetExtents();if(!(Math.abs(i.x*(r.x-v.x)+i.y*(r.y-v.y))-n.x*d.x-n.y*d.y>0))if($.IsLeaf()){var c=new ex;if(c.p1=a.p1,c.p2=a.p2,c.maxFraction=a.maxFraction,0===(u=e(c,$)))return;u>0&&(b=r.x+u*(t.x-r.x),s=r.y+u*(t.y-r.y),l.lowerBound.x=Math.min(r.x,b),l.lowerBound.y=Math.min(r.y,s),l.upperBound.x=Math.max(r.x,b),l.upperBound.y=Math.max(r.y,s))}else p[h++]=$.child1,p[h++]=$.child2}}}}},{key:"AllocateNode",value:function(){if(this.m_freeList){var e=this.m_freeList;return this.m_freeList=e.parent,e.parent=null,e.child1=null,e.child2=null,e}return new ZI}},{key:"FreeNode",value:function(e){e.parent=this.m_freeList,this.m_freeList=e}},{key:"InsertLeaf",value:function(e){if(++this.m_insertionCount,null==this.m_root)return this.m_root=e,void(this.m_root.parent=null);var a=e.aabb.GetCenter(),r=this.m_root;if(!1===r.IsLeaf())do{var t=r.child1,o=r.child2;r=Math.abs((t.aabb.lowerBound.x+t.aabb.upperBound.x)/2-a.x)+Math.abs((t.aabb.lowerBound.y+t.aabb.upperBound.y)/2-a.y)<Math.abs((o.aabb.lowerBound.x+o.aabb.upperBound.x)/2-a.x)+Math.abs((o.aabb.lowerBound.y+o.aabb.upperBound.y)/2-a.y)?t:o}while(!r.IsLeaf());var i=r.parent,n=this.AllocateNode();if(n.parent=i,n.userData=null,n.aabb.Combine(e.aabb,r.aabb),i){r.parent.child1===r?i.child1=n:i.child2=n,n.child1=r,n.child2=e,r.parent=n,e.parent=n;do{if(i.aabb.Contains(n.aabb))break;i.aabb.Combine(i.child1.aabb,i.child2.aabb),n=i,i=i.parent}while(i)}else n.child1=r,n.child2=e,r.parent=n,e.parent=n,this.m_root=n}},{key:"RemoveLeaf",value:function(e){if(e!==this.m_root){var a,r=e.parent,t=r.parent;if(a=r.child1===e?r.child2:r.child1,t)for(t.child1===r?t.child1=a:t.child2=a,a.parent=t,this.FreeNode(r);t;){var o=t.aabb;if(t.aabb=Ld.Combine(t.child1.aabb,t.child2.aabb),o.Contains(t.aabb))break;t=t.parent}else this.m_root=a,a.parent=null,this.FreeNode(r)}else this.m_root=null}}]),e}();function aJ(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function")}var bJ=function a(){aJ(this,a)};var cJ=function(){function e(){TI(this,e),this.m_tree=new _I,this.m_moveBuffer=[],this.m_pairBuffer=[],this.m_pairCount=0,this.m_proxyCount=0}return UI(e,[{key:"CreateProxy",value:function(e,r){var t=this.m_tree.CreateProxy(e,r);return++this.m_proxyCount,this.BufferMove(t),t}},{key:"DestroyProxy",value:function(e){this.UnBufferMove(e),--this.m_proxyCount,this.m_tree.DestroyProxy(e)}},{key:"MoveProxy",value:function(e,r,t){this.m_tree.MoveProxy(e,r,t)&&this.BufferMove(e)}},{key:"TestOverlap",value:function(e,r){var t=this.m_tree.GetFatAABB(e),a=this.m_tree.GetFatAABB(r);return t.TestOverlap(a)}},{key:"GetUserData",value:function(e){return this.m_tree.GetUserData(e)}},{key:"GetFatAABB",value:function(e){return this.m_tree.GetFatAABB(e)}},{key:"GetProxyCount",value:function(){return this.m_proxyCount}},{key:"UpdatePairs",value:function(e){var r=this;this.m_pairCount=0;var t,a=RI(this.m_moveBuffer);try{var o=function(){var e=t.value,a=r.m_tree.GetFatAABB(e);r.m_tree.Query(function(t){if(t===e)return!0;r.m_pairCount===r.m_pairBuffer.length&&(r.m_pairBuffer[r.m_pairCount]=new bJ);var a=r.m_pairBuffer[r.m_pairCount];return a.proxyA=t<e?t:e,a.proxyB=t>=e?t:e,++r.m_pairCount,!0},a)};for(a.s();!(t=a.n()).done;)o()}catch(f){a.e(f)}finally{a.f()}this.m_moveBuffer.length=0;for(var n=0;n<this.m_pairCount;){var i=this.m_pairBuffer[n];for(e(this.m_tree.GetUserData(i.proxyA),this.m_tree.GetUserData(i.proxyB)),++n;n<this.m_pairCount;){var u=this.m_pairBuffer[n];if(u.proxyA!==i.proxyA||u.proxyB!==i.proxyB)break;++n}}}},{key:"Query",value:function(e,r){this.m_tree.Query(e,r)}},{key:"RayCast",value:function(e,r){this.m_tree.RayCast(e,r)}},{key:"Validate",value:function(){}},{key:"Rebalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_tree.Rebalance(e)}},{key:"BufferMove",value:function(e){this.m_moveBuffer[this.m_moveBuffer.length]=e}},{key:"UnBufferMove",value:function(e){var r=parseInt("".concat(this.m_moveBuffer.indexOf(e)),10);this.m_moveBuffer.splice(r,1)}},{key:"ComparePairs",value:function(e,r){return 0}}]),e}();function dJ(c,$){if(!(c instanceof $))throw new TypeError("Cannot call a class as a function")}function eJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fx(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function fJ(e,t,r){return t&&fx(e.prototype,t),r&&fx(e,r),e}function gJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function hJ(e,t,i){return t&&gx(e.prototype,t),i&&gx(e,i),e}var iJ=function(){function e(){gJ(this,e),this._referenceEdge=0,this._incidentEdge=0,this._incidentVertex=0,this._flip=0}return hJ(e,[{key:"referenceEdge",get:function(){return this._referenceEdge},set:function(e){this._referenceEdge!==e&&(this._referenceEdge=e,this.m_id.key=4294967040&this.m_id.key|255&this._referenceEdge)}},{key:"incidentEdge",get:function(){return this._incidentEdge},set:function(e){this._incidentEdge!==e&&(this._incidentEdge=e,this.m_id.key=4294902015&this.m_id.key|this._incidentEdge<<8&65280)}},{key:"incidentVertex",get:function(){return this._incidentVertex},set:function(e){this._incidentVertex!==e&&(this._incidentVertex=e,this.m_id.key=4278255615&this.m_id.key|this._incidentVertex<<16&16711680)}},{key:"flip",get:function(){return this._flip},set:function(e){this._flip!==e&&(this._flip=e,this.m_id.key=16777215&this.m_id.key|this._flip<<24&4278190080)}}]),e}();var om=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new iJ;eJ(this,e),this.features=t,this._key=0,this.features.m_id=this}return fJ(e,[{key:"Set",value:function(e){this.key=e.key}},{key:"Copy",value:function(){var t=new e;return t.key=this.key,t}},{key:"key",get:function(){return this._key},set:function(e){this._key!==e&&(this._key=e,this.features.referenceEdge=255&this._key,this.features.incidentEdge=(65280&this._key)>>8&255,this.features.incidentVertex=(16711680&this._key)>>16&255,this.features.flip=(4278190080&this._key)>>24&255)}}]),e}();var jJ=function c(){dJ(this,c),this.position=new ab,this.velocity=new ab,this.normal=new ab,this.id=new om};function kJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hx(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function lJ(e,t,r){return t&&hx(e.prototype,t),r&&hx(e,r),e}function mJ(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var nJ=function a(){mJ(this,a),this.poolCount=0};function oJ(t){return(oJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ix(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function qJ(t,e,r){return e&&ix(t.prototype,e),r&&ix(t,r),t}function rJ(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sJ(t,e)}function sJ(t,e){return(sJ=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tJ(t){var e=wJ();return function(){var r,o=jx(t);if(e){var n=jx(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return uJ(this,r)}}function uJ(t,e){return!e||"object"!==oJ(e)&&"function"!=typeof e?vJ(t):e}function vJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wJ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function jx(t){return(jx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yJ(e,t,i){return t&&kx(e.prototype,t),i&&kx(e,i),e}function zJ(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}var lx=function a(){zJ(this,a)};function AJ(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function mx(o,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,r.key,r)}}function BJ(o,t,e){return t&&mx(o.prototype,t),e&&mx(o,e),o}function CJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nx(t,e){for(var l=0;l<e.length;l++){var a=e[l];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function DJ(t,e,l){return e&&nx(t.prototype,e),l&&nx(t,l),t}var pm=function(){function t(){CJ(this,t),this.m_localPoint=new ab,this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id=new om,this.Reset()}return DJ(t,[{key:"Reset",value:function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0}},{key:"Set",value:function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)}}]),t}();var Hb=function(){function o(){AJ(this,o),this.m_pointCount=0,this.m_points=new Array(cd),this.m_localPlaneNormal=new ab,this.m_localPoint=new ab,this.m_type=0;for(var t=0;t<cd;t++)this.m_points[t]=new pm}return BJ(o,[{key:"Reset",value:function(){for(var o=0;o<cd;o++)(this.m_points[o]instanceof pm?this.m_points[o]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0}},{key:"Set",value:function(o){this.m_pointCount=o.m_pointCount;for(var t=0;t<cd;t++)(this.m_points[t]instanceof pm?this.m_points[t]:null).Set(o.m_points[t]);this.m_localPlaneNormal.SetV(o.m_localPlaneNormal),this.m_localPoint.SetV(o.m_localPoint),this.m_type=o.m_type}},{key:"Copy",value:function(){var t=new o;return t.Set(this),t}}]),o}();Hb.e_circles=1,Hb.e_faceA=2,Hb.e_faceB=4;function EJ(e,$){if(!(e instanceof $))throw new TypeError("Cannot call a class as a function")}var FJ=function e(){EJ(this,e),this.proxyA=new Rf,this.proxyB=new Rf,this.sweepA=new gf,this.sweepB=new gf,this.tolerance=1};function GJ(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function ox(t,i){for(var o=0;o<i.length;o++){var e=i[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function HJ(t,i,o){return i&&ox(t.prototype,i),o&&ox(t,o),t}var Aj=function(){function t(){GJ(this,t),this.m_localPoint=new ab,this.m_axis=new ab,this.m_type=t.e_points}return HJ(t,[{key:"Initialize",value:function(i,o,e,x,c){this.m_proxyA=o,this.m_proxyB=x;var r,s,n,$,l,y,a=parseInt("".concat(i.count),10);xb(0<a&&a<3);var m,p,_=0,h=0,B=0,u=0,I=0,V=0,f=0;if(1===a)this.m_type=t.e_points,r=this.m_proxyA.GetVertex(i.indexA[0]),$=this.m_proxyB.GetVertex(i.indexB[0]),p=r,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),this.m_axis.x=B-_,this.m_axis.y=u-h,this.m_axis.Normalize();else if(i.indexB[0]===i.indexB[1])this.m_type=t.e_faceA,s=this.m_proxyA.GetVertex(i.indexA[0]),n=this.m_proxyA.GetVertex(i.indexA[1]),$=this.m_proxyB.GetVertex(i.indexB[0]),this.m_localPoint.x=.5*(s.x+n.x),this.m_localPoint.y=.5*(s.y+n.y),this.m_axis=ef(sb(n,s),1),this.m_axis.Normalize(),p=this.m_axis,I=(m=e.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,(f=((B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y))-_)*I+((u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y))-h)*V)<0&&this.m_axis.NegativeSelf();else if(i.indexA[0]==i.indexA[0])this.m_type=t.e_faceB,l=this.m_proxyB.GetVertex(i.indexB[0]),y=this.m_proxyB.GetVertex(i.indexB[1]),r=this.m_proxyA.GetVertex(i.indexA[0]),this.m_localPoint.x=.5*(l.x+y.x),this.m_localPoint.y=.5*(l.y+y.y),this.m_axis=ef(sb(y,l),1),this.m_axis.Normalize(),p=this.m_axis,I=(m=c.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=r,m=e.R,(f=((_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y))-B)*I+((h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y))-u)*V)<0&&this.m_axis.NegativeSelf();else{s=this.m_proxyA.GetVertex(i.indexA[0]),n=this.m_proxyA.GetVertex(i.indexA[1]),l=this.m_proxyB.GetVertex(i.indexB[0]),y=this.m_proxyB.GetVertex(i.indexB[1]);var v=ff(e.R,sb(n,s)),d=ff(c.R,sb(y,l)),A=v.x*v.x+v.y*v.y,M=d.x*d.x+d.y*d.y,R=sb(d,v),G=v.x*R.x+v.y*R.y,P=d.x*R.x+d.y*R.y,S=v.x*d.x+v.y*d.y,b=A*M-S*S;f=0,0!==b&&(f=vd((S*P-G*M)/b,0,1));var C=(S*f+P)/M;C<0&&(C=0,f=vd((S-G)/A,0,1)),(r=new ab).x=s.x+f*(n.x-s.x),r.y=s.y+f*(n.y-s.y),($=new ab).x=l.x+f*(y.x-l.x),$.y=l.y+f*(y.y-l.y),0===f||1===f?(this.m_type=t.e_faceB,this.m_axis=ef(sb(y,l),1),this.m_axis.Normalize(),this.m_localPoint=$,p=this.m_axis,I=(m=c.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=r,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),f<0&&this.m_axis.NegativeSelf()):(this.m_type=t.e_faceA,this.m_axis=ef(sb(n,s),1),this.m_localPoint=r,p=this.m_axis,I=(m=e.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),f<0&&this.m_axis.NegativeSelf())}}},{key:"Evaluate",value:function(i,o){if(!this.m_proxyA||!this.m_proxyB)return 0;var e,x,c,r,s,n,$;switch(this.m_type){case t.e_points:return e=Jd(i.R,this.m_axis),x=Jd(o.R,this.m_axis.GetNegative()),c=this.m_proxyA.GetSupportVertex(e),r=this.m_proxyB.GetSupportVertex(x),s=wb(i,c),((n=wb(o,r)).x-s.x)*this.m_axis.x+(n.y-s.y)*this.m_axis.y;case t.e_faceA:return $=ff(i.R,this.m_axis),s=wb(i,this.m_localPoint),x=Jd(o.R,$.GetNegative()),r=this.m_proxyB.GetSupportVertex(x),((n=wb(o,r)).x-s.x)*$.x+(n.y-s.y)*$.y;case t.e_faceB:return $=ff(o.R,this.m_axis),n=wb(o,this.m_localPoint),e=Jd(i.R,$.GetNegative()),c=this.m_proxyA.GetSupportVertex(e),((s=wb(i,c)).x-n.x)*$.x+(s.y-n.y)*$.y;default:return xb(!1),0;}}}]),t}();Aj.e_points=1,Aj.e_faceA=2,Aj.e_faceB=4;var IJ=0;var JJ=0;var KJ=0;var LJ=0;var MJ=0;var qm=new Ww;var Sf=new Uw;var Md=new xd;var Nd=new xd;var Bj=new Aj;var px=new Vw;function NJ($){++IJ;var t=$.proxyA,a=$.proxyB,r=$.sweepA,e=$.sweepB;xb(r.t0===e.t0),xb(1-r.t0>Number.MIN_VALUE);var o=t.m_radius+a.m_radius,b=$.tolerance,s=0,p=0,x=0;for(qm.count=0,Sf.useRadii=!1;;){if(r.GetTransform(Md,s),e.GetTransform(Nd,s),Sf.proxyA=t,Sf.proxyB=a,Sf.transformA=Md,Sf.transformB=Nd,Zw(px,qm,Sf),px.distance<=0){s=1;break}Bj.Initialize(qm,t,Md,a,Nd);var R=Bj.Evaluate(Md,Nd);if(R<=0){s=1;break}if(0===p&&(x=R>o?zg(o-b,.75*o):zg(R-b,.02*o)),R-x<.5*b){if(0===p){s=1;break}break}var k=s,i=s,_=1,n=R;r.GetTransform(Md,_),e.GetTransform(Nd,_);var c=Bj.Evaluate(Md,Nd);if(c>=x){s=1;break}for(var f=0;;){var u=0;u=1&f?i+(x-n)*(_-i)/(c-n):.5*(i+_),r.GetTransform(Md,u),e.GetTransform(Nd,u);var m=Bj.Evaluate(Md,Nd);if(hm(m-x)<.025*b){k=u;break}if(m>x?(i=u,n=m):(_=u,c=m),++f,++LJ,50===f)break}if(MJ=zg(MJ,f),k<(1+100*Number.MIN_VALUE)*s)break;if(s=k,p++,++JJ,1e3===p)break}return KJ=zg(KJ,p),s}var tb=function(){function e(){xJ(this,e),this.m_nodeA=new lx,this.m_nodeB=new lx,this.m_manifold=new Hb,this.m_oldManifold=new Hb,this.m_flags=0,this.m_toi=1}return yJ(e,[{key:"GetManifold",value:function(){return this.m_manifold}},{key:"GetWorldManifold",value:function(e){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();t&&i&&n&&a&&e.Initialize(this.m_manifold,t.GetTransform(),n.m_radius,i.GetTransform(),a.m_radius)}}},{key:"IsTouching",value:function(){return(this.m_flags&e.e_touchingFlag)===e.e_touchingFlag}},{key:"IsContinuous",value:function(){return(this.m_flags&e.e_continuousFlag)===e.e_continuousFlag}},{key:"SetSensor",value:function(t){t?this.m_flags|=e.e_sensorFlag:this.m_flags&=~e.e_sensorFlag}},{key:"IsSensor",value:function(){return(this.m_flags&e.e_sensorFlag)===e.e_sensorFlag}},{key:"SetEnabled",value:function(t){t?this.m_flags|=e.e_enabledFlag:this.m_flags&=~e.e_enabledFlag}},{key:"IsEnabled",value:function(){return(this.m_flags&e.e_enabledFlag)===e.e_enabledFlag}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetFixtureA",value:function(){return this.m_fixtureA}},{key:"GetFixtureB",value:function(){return this.m_fixtureB}},{key:"FlagForFiltering",value:function(){this.m_flags|=e.e_filterFlag}},{key:"Reset",value:function(t,i){if(this.m_flags=e.e_enabledFlag,!t||!i)return this.m_fixtureA=void 0,void(this.m_fixtureB=void 0);(t.IsSensor()||i.IsSensor())&&(this.m_flags|=e.e_sensorFlag);var n=t.GetBody(),a=i.GetBody();n&&a&&((n.GetType()!==eb.b2_dynamicBody||n.IsBullet()||a.GetType()!==eb.b2_dynamicBody||a.IsBullet())&&(this.m_flags|=e.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=i,this.m_manifold.m_pointCount=0,this.m_prev=void 0,this.m_next=void 0,this.m_nodeA.contact=void 0,this.m_nodeA.prev=void 0,this.m_nodeA.next=void 0,this.m_nodeA.other=void 0,this.m_nodeB.contact=void 0,this.m_nodeB.prev=void 0,this.m_nodeB.next=void 0,this.m_nodeB.other=void 0)}},{key:"Update",value:function(t){var i=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=i,this.m_flags|=e.e_enabledFlag;var n=!1,a=(this.m_flags&e.e_touchingFlag)===e.e_touchingFlag;if(this.m_fixtureA&&this.m_fixtureB){var o=this.m_fixtureA.m_body,s=this.m_fixtureB.m_body;if(o&&s){var r=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&e.e_sensorFlag){if(r){var l=this.m_fixtureA.GetShape(),u=this.m_fixtureB.GetShape();if(!l||!u)return;var _=o.GetTransform(),m=s.GetTransform();n=nb.TestOverlap(l,_,u,m)}this.m_manifold.m_pointCount=0}else{if(o.GetType()!==eb.b2_dynamicBody||o.IsBullet()||s.GetType()!==eb.b2_dynamicBody||s.IsBullet()?this.m_flags|=e.e_continuousFlag:this.m_flags&=~e.e_continuousFlag,r){this.Evaluate(),n=this.m_manifold.m_pointCount>0;for(var h=0;h<this.m_manifold.m_pointCount;++h){var f=this.m_manifold.m_points[h];f.m_normalImpulse=0,f.m_tangentImpulse=0;for(var d=f.m_id,$=0;$<this.m_oldManifold.m_pointCount;++$){var p=this.m_oldManifold.m_points[$];if(p.m_id.key===d.key){f.m_normalImpulse=p.m_normalImpulse,f.m_tangentImpulse=p.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;n!==a&&(o.SetAwake(!0),s.SetAwake(!0))}n?this.m_flags|=e.e_touchingFlag:this.m_flags&=~e.e_touchingFlag,!1===a&&!0===n&&t.BeginContact(this),!0===a&&!1===n&&t.EndContact(this),0==(this.m_flags&e.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)}}}},{key:"Evaluate",value:function(){}},{key:"ComputeTOI",value:function(t,i){if(!this.m_fixtureA||!this.m_fixtureB)return 0;var n=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();return n&&a?(e.s_input.proxyA.Set(n),e.s_input.proxyB.Set(a),e.s_input.sweepA=t,e.s_input.sweepB=i,e.s_input.tolerance=wd,NJ(e.s_input)):0}}]),e}();tb.e_sensorFlag=1,tb.e_continuousFlag=2,tb.e_islandFlag=4,tb.e_toiFlag=8,tb.e_touchingFlag=16,tb.e_enabledFlag=32,tb.e_filterFlag=64,tb.s_input=new FJ;function OJ(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function qx(e,r){for(var t=0;t<r.length;t++){var $=r[t];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function PJ(e,r,t){return r&&qx(e.prototype,r),t&&qx(e,t),e}var rx=function(){function e(){OJ(this,e),this.v=new ab,this.id=new om}return PJ(e,[{key:"Set",value:function(e){this.v.SetV(e.v),this.id.Set(e.id)}}]),e}();var QJ=tm();var RJ=tm();var SJ=tm();var rm=new Array(1).fill(0);var sm=new Array(1).fill(0);var TJ=new ab;var UJ=new ab;var VJ=new ab;var WJ=new ab;var XJ=new ab;var YJ=new ab;var ZJ=new ab;var $J=new ab;var e=new ab;function sx(o,e,l){var t,$=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=0,n=(t=e[0]).v,i=(t=e[1]).v,x=l.x*n.x+l.y*n.y-$,a=l.x*i.x+l.y*i.y-$;if(x<=0&&o[r++].Set(e[0]),a<=0&&o[r++].Set(e[1]),x*a<0){var p,c=x/(x-a),s=(t=o[r]).v;s.x=n.x+c*(i.x-n.x),s.y=n.y+c*(i.y-n.y),t=o[r],x>0?(p=e[0],t.id=p.id):(p=e[1],t.id=p.id),++r}return r}function Cj(o,e){var l,t,$=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=o.m_vertices,x=o.m_normals,a=parseInt("".concat(r.m_vertexCount),10),p=r.m_vertices;l=e.R,t=x[$];for(var c=l.col1.x*t.x+l.col2.x*t.y,s=l.col1.y*t.x+l.col2.y*t.y,_=(l=n.R).col1.x*c+l.col1.y*s,y=l.col2.x*c+l.col2.y*s,m=0,E=Number.MAX_VALUE,d=0;d<a;++d){var v=(t=p[d]).x*_+t.y*y;v<E&&(E=v,m=d)}t=i[$],l=e.R;var g=e.position.x+(l.col1.x*t.x+l.col2.x*t.y),u=e.position.y+(l.col1.y*t.x+l.col2.y*t.y);t=p[m],l=n.R;var f=n.position.x+(l.col1.x*t.x+l.col2.x*t.y),P=n.position.y+(l.col1.y*t.x+l.col2.y*t.y);return(f-=g)*c+(P-=u)*s}function tx(){var o,e,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,$=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=parseInt("".concat(t.m_vertexCount),10),x=t.m_normals;e=n.R,o=r.m_centroid;var a=n.position.x+(e.col1.x*o.x+e.col2.x*o.y),p=n.position.y+(e.col1.y*o.x+e.col2.y*o.y);e=$.R,o=t.m_centroid,a-=$.position.x+(e.col1.x*o.x+e.col2.x*o.y),p-=$.position.y+(e.col1.y*o.x+e.col2.y*o.y);for(var c=a*$.R.col1.x+p*$.R.col1.y,s=a*$.R.col2.x+p*$.R.col2.y,_=0,y=-Number.MAX_VALUE,m=0;m<i;++m){var E=(o=x[m]).x*c+o.y*s;E>y&&(y=E,_=m)}var d=Cj(t,$,_,r,n),v=parseInt("".concat(_-1>=0?_-1:i-1),10),g=Cj(t,$,v,r,n),u=parseInt("".concat(_+1<i?_+1:0),10),f=Cj(t,$,u,r,n),P=0,C=0,V=0;if(g>d&&g>f)P=-1,C=v,V=g;else{if(!(f>d))return l[0]=_,d;P=1,C=u,V=f}for(;(d=Cj(t,$,_=-1===P?C-1>=0?C-1:i-1:C+1<i?C+1:0,r,n))>V;)C=_,V=d;return l[0]=C,V}function _J(o,e,l){var t,$,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,x=e.m_normals,a=parseInt("".concat(n.m_vertexCount),10),p=n.m_vertices,c=n.m_normals;t=l.R,$=x[r];var s=t.col1.x*$.x+t.col2.x*$.y,_=t.col1.y*$.x+t.col2.y*$.y,y=(t=i.R).col1.x*s+t.col1.y*_;_=t.col2.x*s+t.col2.y*_,s=y;for(var m,E=0,d=Number.MAX_VALUE,v=0;v<a;++v){var g=s*($=c[v]).x+_*$.y;g<d&&(d=g,E=v)}var u=parseInt("".concat(E),10),f=parseInt("".concat(u+1<a?u+1:0),10);m=o[0],$=p[u],t=i.R,m.v.x=i.position.x+(t.col1.x*$.x+t.col2.x*$.y),m.v.y=i.position.y+(t.col1.y*$.x+t.col2.y*$.y),m.id.features.referenceEdge=r,m.id.features.incidentEdge=u,m.id.features.incidentVertex=0,m=o[1],$=p[f],t=i.R,m.v.x=i.position.x+(t.col1.x*$.x+t.col2.x*$.y),m.v.y=i.position.y+(t.col1.y*$.x+t.col2.y*$.y),m.id.features.referenceEdge=r,m.id.features.incidentEdge=f,m.id.features.incidentVertex=1}function tm(){return[new rx,new rx]}function aK(o,e,l,t,$){var r;o.m_pointCount=0;var n=e.m_radius+t.m_radius,i=0;rm[0]=i;var x=tx(rm,e,l,t,$);if(i=rm[0],!(x>n)){var a=0;sm[0]=a;var p=tx(sm,t,$,e,l);if(a=sm[0],!(p>n)){var c,s,_,y,m,E=0,d=0;p>.98*x+.001?(c=t,s=e,_=$,y=l,E=a,o.m_type=Hb.e_faceB,d=1):(c=e,s=t,_=l,y=$,E=i,o.m_type=Hb.e_faceA,d=0);var v=QJ;_J(v,c,_,E,s,y);var g,u=parseInt("".concat(c.m_vertexCount),10),f=c.m_vertices,P=f[E];g=E+1<u?f[parseInt("".concat(E+1),10)]:f[0];var C=TJ;C.Set(g.x-P.x,g.y-P.y),C.Normalize();var V=UJ;V.x=C.y,V.y=-C.x;var S=VJ;S.Set(.5*(P.x+g.x),.5*(P.y+g.y));var N=XJ;m=_.R,N.x=m.col1.x*C.x+m.col2.x*C.y,N.y=m.col1.y*C.x+m.col2.y*C.y;var A=YJ;A.x=-N.x,A.y=-N.y;var M=WJ;M.x=N.y,M.y=-N.x;var R=ZJ,I=$J;R.x=_.position.x+(m.col1.x*P.x+m.col2.x*P.y),R.y=_.position.y+(m.col1.y*P.x+m.col2.y*P.y),I.x=_.position.x+(m.col1.x*g.x+m.col2.x*g.y),I.y=_.position.y+(m.col1.y*g.x+m.col2.y*g.y);var O=M.x*R.x+M.y*R.y,T=-N.x*R.x-N.y*R.y+n,h=N.x*I.x+N.y*I.y+n,w=RJ,b=SJ;if(!(sx(w,v,A,T)<2||sx(b,w,N,h)<2)){o.m_localPlaneNormal.SetV(V),o.m_localPoint.SetV(S);for(var F=0,k=0;k<cd;++k){if(r=b[k],M.x*r.v.x+M.y*r.v.y-O<=n){var L=o.m_points[F];m=y.R;var B=r.v.x-y.position.x,U=r.v.y-y.position.y;L.m_localPoint.x=B*m.col1.x+U*m.col1.y,L.m_localPoint.y=B*m.col2.x+U*m.col2.y,L.m_id.Set(r.id),L.m_id.features.flip=d,++F}}o.m_pointCount=F}}}}function bK(o,e,l,t,$){var r,n;o.m_pointCount=0,r=l.R,n=e.m_p;var i=l.position.x+(r.col1.x*n.x+r.col2.x*n.y),x=l.position.y+(r.col1.y*n.x+r.col2.y*n.y);r=$.R,n=t.m_p;var a=$.position.x+(r.col1.x*n.x+r.col2.x*n.y)-i,p=$.position.y+(r.col1.y*n.x+r.col2.y*n.y)-x,c=a*a+p*p,s=e.m_radius+t.m_radius;c>s*s||(o.m_type=Hb.e_circles,o.m_localPoint.SetV(e.m_p),o.m_localPlaneNormal.SetZero(),o.m_pointCount=1,o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0)}function cK(o,e,l,t,$){o.m_pointCount=0;var r,n,i=0,x=0;n=$.R,r=t.m_p;var a=$.position.x+(n.col1.x*r.x+n.col2.x*r.y),p=$.position.y+(n.col1.y*r.x+n.col2.y*r.y);i=a-l.position.x,x=p-l.position.y;for(var c=i*(n=l.R).col1.x+x*n.col1.y,s=i*n.col2.x+x*n.col2.y,_=0,y=-Number.MAX_VALUE,m=e.m_radius+t.m_radius,E=parseInt("".concat(e.m_vertexCount),10),d=e.m_vertices,v=e.m_normals,g=0;g<E;++g){i=c-(r=d[g]).x,x=s-r.y;var u=(r=v[g]).x*i+r.y*x;if(u>m)return;u>y&&(y=u,_=g)}var f=parseInt("".concat(_),10),P=parseInt("".concat(f+1<E?f+1:0),10),C=d[f],V=d[P];if(y<Number.MIN_VALUE)return o.m_pointCount=1,o.m_type=Hb.e_faceA,o.m_localPlaneNormal.SetV(v[_]),o.m_localPoint.x=.5*(C.x+V.x),o.m_localPoint.y=.5*(C.y+V.y),o.m_points[0].m_localPoint.SetV(t.m_p),void(o.m_points[0].m_id.key=0);var S=(c-C.x)*(V.x-C.x)+(s-C.y)*(V.y-C.y),N=(c-V.x)*(C.x-V.x)+(s-V.y)*(C.y-V.y);if(S<=0){if((c-C.x)*(c-C.x)+(s-C.y)*(s-C.y)>m*m)return;o.m_pointCount=1,o.m_type=Hb.e_faceA,o.m_localPlaneNormal.x=c-C.x,o.m_localPlaneNormal.y=s-C.y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.SetV(C),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}else if(N<=0){if((c-V.x)*(c-V.x)+(s-V.y)*(s-V.y)>m*m)return;o.m_pointCount=1,o.m_type=Hb.e_faceA,o.m_localPlaneNormal.x=c-V.x,o.m_localPlaneNormal.y=s-V.y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.SetV(V),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}else{var A=.5*(C.x+V.x),M=.5*(C.y+V.y);if((y=(c-A)*v[f].x+(s-M)*v[f].y)>m)return;o.m_pointCount=1,o.m_type=Hb.e_faceA,o.m_localPlaneNormal.x=v[f].x,o.m_localPlaneNormal.y=v[f].y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.Set(A,M),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}}function dK(t){return(dK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ux(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function fK(t,e,r){return e&&ux(t.prototype,e),r&&ux(t,r),t}function gK(t,e,r){return(gK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=hK(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function hK(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Dj(t)););return t}function iK(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jK(t,e)}function jK(t,e){return(jK=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function kK(t){var e=nK();return function(){var r,n=Dj(t);if(e){var o=Dj(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return lK(this,r)}}function lK(t,e){return!e||"object"!==dK(e)&&"function"!=typeof e?mK(t):e}function mK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function nK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Dj(t){return(Dj=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Tf=function(t){iK(r,nb);var e=kK(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return eK(this,r),(t=e.call(this)).m_radius=n,t.m_p=new ab,t.m_type=nb.e_circleShape,t}return fK(r,[{key:"Copy",value:function(){var t=new r;return t.Set(this),t}},{key:"Set",value:function(t){gK(Dj(r.prototype),"Set",this).call(this,t),t instanceof r&&this.m_p.SetV(t.m_p)}},{key:"TestPoint",value:function(t,e){var r=t.R,n=t.position.x+(r.col1.x*this.m_p.x+r.col2.x*this.m_p.y),o=t.position.y+(r.col1.y*this.m_p.x+r.col2.y*this.m_p.y);return(n=e.x-n)*n+(o=e.y-o)*o<=this.m_radius*this.m_radius}},{key:"RayCast",value:function(t,e,r){var n=r.R,o=r.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),i=r.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),a=e.p1.x-o,s=e.p1.y-i,u=a*a+s*s-this.m_radius*this.m_radius,$=e.p2.x-e.p1.x,c=e.p2.y-e.p1.y,p=a*$+s*c,l=$*$+c*c,f=p*p-l*u;if(f<0||l<Number.MIN_VALUE)return!1;var _=-(p+Math.sqrt(f));return 0<=_&&_<=e.maxFraction*l&&(_/=l,t.fraction=_,t.normal.x=a+_*$,t.normal.y=s+_*c,t.normal.Normalize(),!0)}},{key:"ComputeAABB",value:function(t,e){var r=e.R,n=e.position.x+(r.col1.x*this.m_p.x+r.col2.x*this.m_p.y),o=e.position.y+(r.col1.y*this.m_p.x+r.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,o-this.m_radius),t.upperBound.Set(n+this.m_radius,o+this.m_radius)}},{key:"ComputeMass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.mass=e*im*this.m_radius*this.m_radius,t.center.SetV(this.m_p),t.I=t.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))}},{key:"ComputeSubmergedArea",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=wb(r,this.m_p),i=-(Ib(t,o)-e);if(i<-this.m_radius+Number.MIN_VALUE)return 0;if(i>this.m_radius)return n.SetV(o),Math.PI*this.m_radius*this.m_radius;var a=this.m_radius*this.m_radius,s=i*i,u=a*(Math.asin(i/this.m_radius)+Math.PI/2)+i*Math.sqrt(a-s),$=-2/3*Math.pow(a-s,1.5)/u;return n.x=o.x+t.x*$,n.y=o.y+t.y*$,u}},{key:"GetLocalPosition",value:function(){return this.m_p}},{key:"SetLocalPosition",value:function(t){this.m_p.SetV(t)}},{key:"GetRadius",value:function(){return this.m_radius}},{key:"SetRadius",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_radius=t}}]),r}();var vx=function(t){rJ(r,tb);var e=tJ(r);function r(){return pJ(this,r),e.apply(this,arguments)}return qJ(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&e&&r instanceof Tf&&o instanceof Tf&&bK(this.m_manifold,r,t.m_xf,o,e.m_xf)}}}],[{key:"Create",value:function(t){return new r}},{key:"Destroy",value:function(t,e){}}]),r}();function oK(t){return(oK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wx(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function qK(t,e,r){return e&&wx(t.prototype,e),r&&wx(t,r),t}function rK(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sK(t,e)}function sK(t,e){return(sK=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tK(t){var e=wK();return function(){var r,o=xx(t);if(e){var n=xx(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return uK(this,r)}}function uK(t,e){return!e||"object"!==oK(e)&&"function"!=typeof e?vK(t):e}function vK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function xx(t){return(xx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function xK(t){return(xK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yx(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function zK(t,e,r){return e&&yx(t.prototype,e),r&&yx(t,r),t}function AK(t,e,r){return(AK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=BK(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function BK(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ej(t)););return t}function CK(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&DK(t,e)}function DK(t,e){return(DK=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function EK(t){var e=HK();return function(){var r,o=Ej(t);if(e){var i=Ej(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return FK(this,r)}}function FK(t,e){return!e||"object"!==xK(e)&&"function"!=typeof e?GK(t):e}function GK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Ej(t){return(Ej=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var hf=function(t){CK(r,nb);var e=EK(r);function r(){var t;return yK(this,r),(t=e.call(this)).m_centroid=new ab,t.m_vertexCount=0,t.m_vertices=[],t.m_normals=[],t.m_type=nb.e_polygonShape,t.m_centroid=new ab,t.m_vertices=[],t.m_normals=[],t}return zK(r,[{key:"Copy",value:function(){var t=new r;return t.Set(this),t}},{key:"Set",value:function(t){if(AK(Ej(r.prototype),"Set",this).call(this,t),t instanceof r){this.m_centroid.SetV(t.m_centroid),this.m_vertexCount=t.m_vertexCount,this.Reserve(this.m_vertexCount);for(var e=0;e<this.m_vertexCount;e++)this.m_vertices[e].SetV(t.m_vertices[e]),this.m_normals[e].SetV(t.m_normals[e])}}},{key:"SetAsArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.SetAsVector(t.slice(),e)}},{key:"SetAsVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===e&&(e=t.length),xb(2<=e),this.m_vertexCount=e,this.Reserve(e);for(var o=0;o<this.m_vertexCount;o++)this.m_vertices[o].SetV(t[o]);for(var i=0;i<this.m_vertexCount;++i){var n=parseInt("".concat(i),10),s=parseInt("".concat(i+1<this.m_vertexCount?i+1:0),10),a=sb(this.m_vertices[s],this.m_vertices[n]);xb(a.LengthSquared()>Number.MIN_VALUE),this.m_normals[i].SetV(ef(a,1)),this.m_normals[i].Normalize()}this.m_centroid=r.ComputeCentroid(this.m_vertices,this.m_vertexCount)}},{key:"SetAsBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()}},{key:"SetAsOrientedBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ab,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=r;var i=new xd;i.position=r,i.R.Set(o);for(var n=0;n<this.m_vertexCount;++n)this.m_vertices[n]=wb(i,this.m_vertices[n]),this.m_normals[n]=ff(i.R,this.m_normals[n])}},{key:"SetAsEdge",value:function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=ef(sb(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y}},{key:"TestPoint",value:function(t,e){for(var r,o=t.R,i=e.x-t.position.x,n=e.y-t.position.y,s=i*o.col1.x+n*o.col1.y,a=i*o.col2.x+n*o.col2.y,c=0;c<this.m_vertexCount;++c){if(i=s-(r=this.m_vertices[c]).x,n=a-r.y,(r=this.m_normals[c]).x*i+r.y*n>0)return!1}return!0}},{key:"RayCast",value:function(t,e,r){var o,i,n=0,s=e.maxFraction,a=0,c=0;a=e.p1.x-r.position.x,c=e.p1.y-r.position.y;var u=a*(o=r.R).col1.x+c*o.col1.y,v=a*o.col2.x+c*o.col2.y;a=e.p2.x-r.position.x,c=e.p2.y-r.position.y;for(var m=a*(o=r.R).col1.x+c*o.col1.y-u,$=a*o.col2.x+c*o.col2.y-v,l=parseInt("-1",10),h=0;h<this.m_vertexCount;++h){a=(i=this.m_vertices[h]).x-u,c=i.y-v;var _=(i=this.m_normals[h]).x*a+i.y*c,y=i.x*m+i.y*$;if(0===y){if(_<0)return!1}else y<0&&_<n*y?(n=_/y,l=h):y>0&&_<s*y&&(s=_/y);if(s<n-Number.MIN_VALUE)return!1}return l>=0&&(t.fraction=n,o=r.R,i=this.m_normals[l],t.normal.x=o.col1.x*i.x+o.col2.x*i.y,t.normal.y=o.col1.y*i.x+o.col2.y*i.y,!0)}},{key:"ComputeAABB",value:function(t,e){for(var r=e.R,o=this.m_vertices[0],i=e.position.x+(r.col1.x*o.x+r.col2.x*o.y),n=e.position.y+(r.col1.y*o.x+r.col2.y*o.y),s=i,a=n,c=1;c<this.m_vertexCount;++c){o=this.m_vertices[c];var u=e.position.x+(r.col1.x*o.x+r.col2.x*o.y),v=e.position.y+(r.col1.y*o.x+r.col2.y*o.y);i=i<u?i:u,n=n<v?n:v,s=s>u?s:u,a=a>v?a:v}t.lowerBound.x=i-this.m_radius,t.lowerBound.y=n-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius}},{key:"ComputeMass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(2===this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var r=0,o=0,i=0,n=0,s=0;s<this.m_vertexCount;++s){var a=this.m_vertices[s],c=s+1<this.m_vertexCount?this.m_vertices[parseInt("".concat(s+1),10)]:this.m_vertices[0],u=a.x-0,v=a.y-0,m=c.x-0,$=c.y-0,l=u*$-v*m,h=.5*l;i+=h,r+=h*(1/3)*(0+a.x+c.x),o+=h*(1/3)*(0+a.y+c.y);n+=l*(1/3*(.25*(u*u+m*u+m*m)+(0*u+0*m))+0+(1/3*(.25*(v*v+$*v+$*$)+(0*v+0*$))+0))}t.mass=e*i,r*=1/i,o*=1/i,t.center.Set(r,o),t.I=e*n}},{key:"ComputeSubmergedArea",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=Jd(r.R,t),n=e-Ib(t,r.position),s=[],a=0,c=parseInt("".concat(-1),10),u=parseInt("".concat(-1),10),v=!1,m=0;m<this.m_vertexCount;++m){s[m]=Ib(i,this.m_vertices[m])-n;var $=s[m]<-Number.MIN_VALUE;m>0&&($?v||(c=m-1,a++):v&&(u=m-1,a++)),v=$}switch(a){case 0:if(v){var l=new $w;return this.ComputeMass(l,1),o.SetV(wb(r,l.center)),l.mass}return 0;case 1:-1===c?c=this.m_vertexCount-1:u=this.m_vertexCount-1;}for(var h,_=parseInt("".concat((c+1)%this.m_vertexCount),10),y=parseInt("".concat((u+1)%this.m_vertexCount),10),p=(0-s[c])/(s[_]-s[c]),f=(0-s[u])/(s[y]-s[u]),x=new ab(this.m_vertices[c].x*(1-p)+this.m_vertices[_].x*p,this.m_vertices[c].y*(1-p)+this.m_vertices[_].y*p),M=new ab(this.m_vertices[u].x*(1-f)+this.m_vertices[y].x*f,this.m_vertices[u].y*(1-f)+this.m_vertices[y].y*f),E=0,j=new ab,X=this.m_vertices[_],d=_;d!==y;){h=(d=(d+1)%this.m_vertexCount)===y?M:this.m_vertices[d];var S=.5*((X.x-x.x)*(h.y-x.y)-(X.y-x.y)*(h.x-x.x));E+=S,j.x+=S*(x.x+X.x+h.x)/3,j.y+=S*(x.y+X.y+h.y)/3,X=h}return j.Multiply(1/E),o.SetV(wb(r,j)),E}},{key:"GetVertexCount",value:function(){return this.m_vertexCount}},{key:"GetVertices",value:function(){return this.m_vertices}},{key:"GetNormals",value:function(){return this.m_normals}},{key:"GetSupport",value:function(t){for(var e=0,r=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;o<this.m_vertexCount;++o){var i=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;i>r&&(e=o,r=i)}return e}},{key:"GetSupportVertex",value:function(t){for(var e=0,r=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;o<this.m_vertexCount;++o){var i=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;i>r&&(e=o,r=i)}return this.m_vertices[e]}},{key:"Validate",value:function(){return!1}},{key:"Reserve",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=parseInt("".concat(this.m_vertices.length),10);e<t;e++)this.m_vertices[e]=new ab,this.m_normals[e]=new ab}}],[{key:"ComputeCentroid",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new ab,o=0,i=0;i<e;++i){var n=t[i],s=i+1<e?t[parseInt("".concat(i+1),10)]:t[0],a=n.x-0,c=n.y-0,u=s.x-0,v=.5*(a*(s.y-0)-c*u);o+=v,r.x+=v*(1/3)*(0+n.x+s.x),r.y+=v*(1/3)*(0+n.y+s.y)}return r.x*=1/o,r.y*=1/o,r}},{key:"ComputeOBB",value:function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=new Array(r+1),i=0;i<r;++i)o[i]=e[i];o[r]=o[0];for(var n=Number.MAX_VALUE,s=1;s<=r;++s){for(var a=o[parseInt("".concat(s-1),10)],c=o[s].x-a.x,u=o[s].y-a.y,v=Math.sqrt(c*c+u*u),m=-(u/=v),$=c/=v,l=Number.MAX_VALUE,h=Number.MAX_VALUE,_=-Number.MAX_VALUE,y=-Number.MAX_VALUE,p=0;p<r;++p){var f=o[p].x-a.x,x=o[p].y-a.y,M=c*f+u*x,E=m*f+$*x;M<l&&(l=M),E<h&&(h=E),M>_&&(_=M),E>y&&(y=E)}var j=(_-l)*(y-h);if(j<.95*n){n=j,t.R.col1.x=c,t.R.col1.y=u,t.R.col2.x=m,t.R.col2.y=$;var X=.5*(l+_),d=.5*(h+y),S=t.R;t.center.x=a.x+(S.col1.x*X+S.col2.x*d),t.center.y=a.y+(S.col1.y*X+S.col2.y*d),t.extents.x=.5*(_-l),t.extents.y=.5*(y-h)}}}},{key:"AsArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new r;return o.SetAsArray(t,e),o}},{key:"AsVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new r;return o.SetAsVector(t,e),o}},{key:"AsBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new r;return o.SetAsBox(t,e),o}},{key:"AsOrientedBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ab,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=new r;return n.SetAsOrientedBox(t,e,o,i),n}},{key:"AsEdge",value:function(t,e){var o=new r;return o.SetAsEdge(t,e),o}}]),r}();hf.s_mat=new Kd;var zx=function(t){rK(r,tb);var e=tK(r);function r(){return pK(this,r),e.apply(this,arguments)}return qK(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&e&&r instanceof hf&&o instanceof Tf&&cK(this.m_manifold,r,t.m_xf,o,e.m_xf)}}}],[{key:"Create",value:function(t){return new r}},{key:"Destroy",value:function(t,e){}}]),r}();function IK(t){return(IK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function JK(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Ax(t,r){for(var e=0;e<r.length;e++){var o=r[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function KK(t,r,e){return r&&Ax(t.prototype,r),e&&Ax(t,e),t}function LK(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&MK(t,r)}function MK(t,r){return(MK=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function NK(t){var r=QK();return function(){var e,o=Bx(t);if(r){var n=Bx(this).constructor;e=Reflect.construct(o,arguments,n)}else e=o.apply(this,arguments);return OK(this,e)}}function OK(t,r){return!r||"object"!==IK(r)&&"function"!=typeof r?PK(t):r}function PK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function QK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Bx(t){return(Bx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Cx=function(t){LK(e,tb);var r=NK(e);function e(){return JK(this,e),r.apply(this,arguments)}return KK(e,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),r=this.m_fixtureB.GetBody(),e=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&r&&e instanceof hf&&o instanceof hf&&aK(this.m_manifold,e,t.m_xf,o,r.m_xf)}}}],[{key:"Create",value:function(t){return new e}},{key:"Destroy",value:function(t,r){}}]),e}();function RK(t){return(RK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function SK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dx(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function TK(t,e,r){return e&&Dx(t.prototype,e),r&&Dx(t,r),t}function UK(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&VK(t,e)}function VK(t,e){return(VK=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function WK(t){var e=ZK();return function(){var r,o=Ex(t);if(e){var n=Ex(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return XK(this,r)}}function XK(t,e){return!e||"object"!==RK(e)&&"function"!=typeof e?YK(t):e}function YK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Ex(t){return(Ex=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $K(e){return($K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _K(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function Fx(e,o){for(var t=0;t<o.length;t++){var r=o[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function aL(e,o,t){return o&&Fx(e.prototype,o),t&&Fx(e,t),e}function bL(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),o&&cL(e,o)}function cL(e,o){return(cL=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e})(e,o)}function dL(e){var o=gL();return function(){var t,r=Gx(e);if(o){var n=Gx(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return eL(this,t)}}function eL(e,o){return!o||"object"!==$K(o)&&"function"!=typeof o?fL(e):o}function fL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gL(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Gx(e){return(Gx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var um=function(e){bL(t,nb);var o=dL(t);function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ab,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ab;return _K(this,t),(e=o.call(this)).s_supportVec=new ab,e.m_v1=new ab,e.m_v2=new ab,e.m_coreV1=new ab,e.m_coreV2=new ab,e.m_normal=new ab,e.m_direction=new ab,e.m_cornerDir1=new ab,e.m_cornerDir2=new ab,e.m_length=0,e.m_cornerConvex1=!1,e.m_cornerConvex2=!1,e.m_type=nb.e_edgeShape,e.m_prevEdge=void 0,e.m_nextEdge=void 0,e.m_v1=r,e.m_v2=n,e.m_direction.Set(e.m_v2.x-e.m_v1.x,e.m_v2.y-e.m_v1.y),e.m_length=e.m_direction.Normalize(),e.m_normal.Set(e.m_direction.y,-e.m_direction.x),e.m_coreV1.Set(-Ag*(e.m_normal.x-e.m_direction.x)+e.m_v1.x,-Ag*(e.m_normal.y-e.m_direction.y)+e.m_v1.y),e.m_coreV2.Set(-Ag*(e.m_normal.x+e.m_direction.x)+e.m_v2.x,-Ag*(e.m_normal.y+e.m_direction.y)+e.m_v2.y),e.m_cornerDir1=e.m_normal,e.m_cornerDir2.Set(-e.m_normal.x,-e.m_normal.y),e}return aL(t,[{key:"RayCast",value:function(e,o,t){var r=t.R,n=o.p2.x-o.p1.x,i=o.p2.y-o.p1.y,c=t.position.x+(r.col1.x*this.m_v1.x+r.col2.x*this.m_v1.y),$=t.position.y+(r.col1.y*this.m_v1.x+r.col2.y*this.m_v1.y),u=t.position.y+(r.col1.y*this.m_v2.x+r.col2.y*this.m_v2.y)-$,m=-(t.position.x+(r.col1.x*this.m_v2.x+r.col2.x*this.m_v2.y)-c),s=100*Number.MIN_VALUE,a=-(n*u+i*m);if(a>s){var _=o.p1.x-c,l=o.p1.y-$,p=_*u+l*m;if(0<=p&&p<=o.maxFraction*a){var y=-n*l+i*_;if(-s*a<=y&&y<=a*(1+s)){p/=a,e.fraction=p;var v=Math.sqrt(u*u+m*m);return e.normal.x=u/v,e.normal.y=m/v,!0}}}return!1}},{key:"ComputeAABB",value:function(e,o){var t=o.R,r=o.position.x+(t.col1.x*this.m_v1.x+t.col2.x*this.m_v1.y),n=o.position.y+(t.col1.y*this.m_v1.x+t.col2.y*this.m_v1.y),i=o.position.x+(t.col1.x*this.m_v2.x+t.col2.x*this.m_v2.y),c=o.position.y+(t.col1.y*this.m_v2.x+t.col2.y*this.m_v2.y);r<i?(e.lowerBound.x=r,e.upperBound.x=i):(e.lowerBound.x=i,e.upperBound.x=r),n<c?(e.lowerBound.y=n,e.upperBound.y=c):(e.lowerBound.y=c,e.upperBound.y=n)}},{key:"ComputeMass",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.mass=0,e.center.SetV(this.m_v1),e.I=0}},{key:"ComputeSubmergedArea",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=new ab(e.x*o,e.y*o),i=wb(t,this.m_v1),c=wb(t,this.m_v2),$=Ib(e,i)-o,u=Ib(e,c)-o;if($>0){if(u>0)return 0;i.x=-u/($-u)*i.x+$/($-u)*c.x,i.y=-u/($-u)*i.y+$/($-u)*c.y}else u>0&&(c.x=-u/($-u)*i.x+$/($-u)*c.x,c.y=-u/($-u)*i.y+$/($-u)*c.y);return r.x=(n.x+i.x+c.x)/3,r.y=(n.y+i.y+c.y)/3,.5*((i.x-n.x)*(c.y-n.y)-(i.y-n.y)*(c.x-n.x))}},{key:"GetLength",value:function(){return this.m_length}},{key:"GetVertex1",value:function(){return this.m_v1}},{key:"GetVertex2",value:function(){return this.m_v2}},{key:"GetCoreVertex1",value:function(){return this.m_coreV1}},{key:"GetCoreVertex2",value:function(){return this.m_coreV2}},{key:"GetNormalVector",value:function(){return this.m_normal}},{key:"GetDirectionVector",value:function(){return this.m_direction}},{key:"GetCorner1Vector",value:function(){return this.m_cornerDir1}},{key:"GetCorner2Vector",value:function(){return this.m_cornerDir2}},{key:"Corner1IsConvex",value:function(){return this.m_cornerConvex1}},{key:"Corner2IsConvex",value:function(){return this.m_cornerConvex2}},{key:"GetFirstVertex",value:function(e){var o=e.R;return new ab(e.position.x+(o.col1.x*this.m_coreV1.x+o.col2.x*this.m_coreV1.y),e.position.y+(o.col1.y*this.m_coreV1.x+o.col2.y*this.m_coreV1.y))}},{key:"GetNextEdge",value:function(){return this.m_nextEdge}},{key:"GetPrevEdge",value:function(){return this.m_prevEdge}},{key:"Support",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.R,n=e.position.x+(r.col1.x*this.m_coreV1.x+r.col2.x*this.m_coreV1.y),i=e.position.y+(r.col1.y*this.m_coreV1.x+r.col2.y*this.m_coreV1.y),c=e.position.x+(r.col1.x*this.m_coreV2.x+r.col2.x*this.m_coreV2.y),$=e.position.y+(r.col1.y*this.m_coreV2.x+r.col2.y*this.m_coreV2.y);return n*o+i*t>c*o+$*t?(this.s_supportVec.x=n,this.s_supportVec.y=i):(this.s_supportVec.x=c,this.s_supportVec.y=$),this.s_supportVec}},{key:"SetPrevEdge",value:function(e,o,t,r){this.m_prevEdge=e,this.m_coreV1=o,this.m_cornerDir1=t,this.m_cornerConvex1=r}},{key:"SetNextEdge",value:function(e,o,t,r){this.m_nextEdge=e,this.m_coreV2=o,this.m_cornerDir2=t,this.m_cornerConvex2=r}}]),t}();var Hx=function(t){UK(r,tb);var e=WK(r);function r(){return SK(this,r),e.apply(this,arguments)}return TK(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&e&&r instanceof um&&o instanceof Tf&&this.CollideEdgeAndCircle(this.m_manifold,r,t.m_xf,o,e.m_xf)}}},{key:"CollideEdgeAndCircle",value:function(t,e,r,o,n){}}],[{key:"Create",value:function(t){return new r}},{key:"Destroy",value:function(t,e){}}]),r}();function hL(e){return(hL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ix(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function jL(e,t,r){return t&&Ix(e.prototype,t),r&&Ix(e,r),e}function kL(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lL(e,t)}function lL(e,t){return(lL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function mL(e){var t=pL();return function(){var r,o=Jx(e);if(t){var n=Jx(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return nL(this,r)}}function nL(e,t){return!t||"object"!==hL(t)&&"function"!=typeof t?oL(e):t}function oL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function pL(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function Jx(e){return(Jx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Kx=function(e){kL(r,tb);var t=mL(r);function r(){return iL(this,r),t.apply(this,arguments)}return jL(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var e=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();e&&t&&r instanceof hf&&o instanceof um&&this.CollidePolyAndEdge(this.m_manifold,r,e.m_xf,o,t.m_xf)}}},{key:"CollidePolyAndEdge",value:function(e,t,r,o,n){}}],[{key:"Create",value:function(e){return new r}},{key:"Destroy",value:function(e,t){}}]),r}();var qL=function(){function e(t){kJ(this,e),this.m_allocator=t,this.m_registers={},this.InitializeRegisters()}return lJ(e,[{key:"AddType",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.m_registers[r][o].createFn=e,this.m_registers[r][o].destroyFn=t,this.m_registers[r][o].primary=!0,r!==o&&(this.m_registers[o][r].createFn=e,this.m_registers[o][r].destroyFn=t,this.m_registers[o][r].primary=!1)}},{key:"InitializeRegisters",value:function(){this.m_registers=new Array(nb.e_shapeTypeCount);for(var e=0;e<nb.e_shapeTypeCount;e++){this.m_registers[e]=new Array(nb.e_shapeTypeCount);for(var t=0;t<nb.e_shapeTypeCount;t++)this.m_registers[e][t]=new nJ}this.AddType(vx.Create,vx.Destroy,nb.e_circleShape,nb.e_circleShape),this.AddType(zx.Create,zx.Destroy,nb.e_polygonShape,nb.e_circleShape),this.AddType(Cx.Create,Cx.Destroy,nb.e_polygonShape,nb.e_polygonShape),this.AddType(Hx.Create,Hx.Destroy,nb.e_edgeShape,nb.e_circleShape),this.AddType(Kx.Create,Kx.Destroy,nb.e_polygonShape,nb.e_edgeShape)}},{key:"Create",value:function(e,t){var r,o=parseInt("".concat(e.GetType()),10),a=parseInt("".concat(t.GetType()),10),i=this.m_registers[o][a];if(i.pool)return r=i.pool,i.pool=r.m_next,i.poolCount--,r.Reset(e,t),r;var $=i.createFn;return $?i.primary?((r=$(this.m_allocator)).Reset(e,t),r):((r=$(this.m_allocator)).Reset(t,e),r):void 0}},{key:"Destroy",value:function(e){if(e.m_fixtureA&&e.m_fixtureB&&e.m_fixtureA.m_body&&e.m_fixtureB.m_body){e.m_manifold.m_pointCount>0&&(e.m_fixtureA.m_body.SetAwake(!0),e.m_fixtureB.m_body.SetAwake(!0));var t=parseInt("".concat(e.m_fixtureA.GetType()),10),r=parseInt("".concat(e.m_fixtureB.GetType()),10),o=this.m_registers[t][r];o.poolCount++,e.m_next=o.pool,o.pool=e;var a=o.destroyFn;a&&a(e,this.m_allocator)}}}]),e}();var Lx=function(){function t(){mI(this,t),this.m_contactCount=0,this.m_contactFilter=mm.b2_defaultFilter,this.m_contactListener=nm.b2_defaultListener,this.m_contactFactory=new qL(void 0),this.m_broadPhase=new cJ}return nI(t,[{key:"AddPair",value:function(t,e){var o=t.GetBody(),n=e.GetBody();if(this.m_world&&o&&n&&o!==n){for(var r=n.GetContactList();r;){if(r.other===o){var i=r.contact.GetFixtureA(),a=r.contact.GetFixtureB();if(i===t&&a===e)return;if(i===e&&a===t)return}r=r.next}if(!1!==n.ShouldCollide(o)&&!1!==this.m_contactFilter.ShouldCollide(t,e)){var c=this.m_contactFactory.Create(t,e);t=c.GetFixtureA(),e=c.GetFixtureB(),o=t.m_body,n=e.m_body,o&&n&&(c.m_prev=void 0,c.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=c),this.m_world.m_contactList=c,c.m_nodeA.contact=c,c.m_nodeA.other=n,c.m_nodeA.prev=void 0,c.m_nodeA.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=c.m_nodeA),o.m_contactList=c.m_nodeA,c.m_nodeB.contact=c,c.m_nodeB.other=o,c.m_nodeB.prev=void 0,c.m_nodeB.next=n.m_contactList,null!=n.m_contactList&&(n.m_contactList.prev=c.m_nodeB),n.m_contactList=c.m_nodeB,++this.m_world.m_contactCount)}}}},{key:"FindNewContacts",value:function(){var t=this;this.m_broadPhase.UpdatePairs(function(e,o){t.AddPair(e,o)})}},{key:"Destroy",value:function(t){if(this.m_world){var e=t.GetFixtureA(),o=t.GetFixtureB(),n=e.GetBody(),r=o.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA===n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB===r.m_contactList&&(r.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount}}},{key:"Collide",value:function(){if(this.m_world)for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),o=t.GetFixtureB();if(!e||!o)return;var n=e.GetBody(),r=o.GetBody();if(!n||!r)return;if(!1!==n.IsAwake()||!1!==r.IsAwake()){if(t.m_flags&tb.e_filterFlag){if(!1===r.ShouldCollide(n)){var i=t;t=i.GetNext(),this.Destroy(i);continue}if(!1===this.m_contactFilter.ShouldCollide(e,o)){var a=t;t=a.GetNext(),this.Destroy(a);continue}t.m_flags&=~tb.e_filterFlag}var c=e.m_proxy,_=o.m_proxy;if(!1!==this.m_broadPhase.TestOverlap(c,_))t.Update(this.m_contactListener),t=t.GetNext();else{var m=t;t=m.GetNext(),this.Destroy(m)}}else t=t.GetNext()}}}]),t}();Lx.s_evalCP=new jJ;function rL(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function Mx(r,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function sL(r,n,o){return n&&Mx(r.prototype,n),o&&Mx(r,o),r}function tL(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function Nx(o,i){for(var t=0;t<i.length;t++){var l=i[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,l.key,l)}}function uL(o,i,t){return i&&Nx(o.prototype,i),t&&Nx(o,t),o}var vL=function(){function o(){tL(this,o),this.m_normal=new ab,this.m_points=new Array(cd),this.m_points=this.m_points.fill(0).map(function(){return new ab})}return uL(o,[{key:"Initialize",value:function(o,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(0!==o.m_pointCount){var a,r,e=0,c=0,s=0,x=0,m=0,$=0;switch(o.m_type){case Hb.e_circles:r=i.R,a=o.m_localPoint;var y=i.position.x+r.col1.x*a.x+r.col2.x*a.y,_=i.position.y+r.col1.y*a.x+r.col2.y*a.y;r=l.R,a=o.m_points[0].m_localPoint;var p=l.position.x+r.col1.x*a.x+r.col2.x*a.y,J=l.position.y+r.col1.y*a.x+r.col2.y*a.y,h=p-y,f=J-_,u=h*h+f*f;if(u>Number.MIN_VALUE*Number.MIN_VALUE){var v=Math.sqrt(u);this.m_normal.x=h/v,this.m_normal.y=f/v}else this.m_normal.x=1,this.m_normal.y=0;var O=y+t*this.m_normal.x,d=_+t*this.m_normal.y,P=p-n*this.m_normal.x,b=J-n*this.m_normal.y;this.m_points[0].x=.5*(O+P),this.m_points[0].y=.5*(d+b);break;case Hb.e_faceA:r=i.R,a=o.m_localPlaneNormal,e=r.col1.x*a.x+r.col2.x*a.y,c=r.col1.y*a.x+r.col2.y*a.y,r=i.R,a=o.m_localPoint,s=i.position.x+r.col1.x*a.x+r.col2.x*a.y,x=i.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_normal.x=e,this.m_normal.y=c;for(var C=0;C<o.m_pointCount;C++)r=l.R,a=o.m_points[C].m_localPoint,m=l.position.x+r.col1.x*a.x+r.col2.x*a.y,$=l.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_points[C].x=m+.5*(t-(m-s)*e-($-x)*c-n)*e,this.m_points[C].y=$+.5*(t-(m-s)*e-($-x)*c-n)*c;break;case Hb.e_faceB:r=l.R,a=o.m_localPlaneNormal,e=r.col1.x*a.x+r.col2.x*a.y,c=r.col1.y*a.x+r.col2.y*a.y,r=l.R,a=o.m_localPoint,s=l.position.x+r.col1.x*a.x+r.col2.x*a.y,x=l.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_normal.x=-e,this.m_normal.y=-c;for(var R=0;R<o.m_pointCount;R++)r=i.R,a=o.m_points[R].m_localPoint,m=i.position.x+r.col1.x*a.x+r.col2.x*a.y,$=i.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_points[R].x=m+.5*(n-(m-s)*e-($-x)*c-t)*e,this.m_points[R].y=$+.5*(n-(m-s)*e-($-x)*c-t)*c;}}}}]),o}();function wL(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function Ox(o,i){for(var t=0;t<i.length;t++){var l=i[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,l.key,l)}}function xL(o,i,t){return i&&Ox(o.prototype,i),t&&Ox(o,t),o}var vm=function(){function o(){wL(this,o),this.m_normal=new ab,this.m_separations=new Array(cd).fill(0),this.m_points=new Array(cd).fill(0),this.m_points=this.m_points.map(function(){return new ab})}return xL(o,[{key:"Initialize",value:function(o){xb(o.pointCount>0);var i,t,l=0,n=0,r=0,a=0;switch(o.type){case Hb.e_circles:i=o.bodyA.m_xf.R,t=o.localPoint;var e=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),s=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y);i=o.bodyB.m_xf.R,t=o.points[0].localPoint;var m=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),c=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),x=m-e,y=c-s,$=x*x+y*y;if($>Number.MIN_VALUE*Number.MIN_VALUE){var _=Math.sqrt($);this.m_normal.x=x/_,this.m_normal.y=y/_}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(e+m),this.m_points[0].y=.5*(s+c),this.m_separations[0]=x*this.m_normal.x+y*this.m_normal.y-o.radius;break;case Hb.e_faceA:i=o.bodyA.m_xf.R,t=o.localPlaneNormal,this.m_normal.x=i.col1.x*t.x+i.col2.x*t.y,this.m_normal.y=i.col1.y*t.x+i.col2.y*t.y,i=o.bodyA.m_xf.R,t=o.localPoint,r=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),a=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),i=o.bodyB.m_xf.R;for(var p=0;p<o.pointCount;++p)t=o.points[p].localPoint,l=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),n=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),this.m_separations[p]=(l-r)*this.m_normal.x+(n-a)*this.m_normal.y-o.radius,this.m_points[p].x=l,this.m_points[p].y=n;break;case Hb.e_faceB:i=o.bodyB.m_xf.R,t=o.localPlaneNormal,this.m_normal.x=i.col1.x*t.x+i.col2.x*t.y,this.m_normal.y=i.col1.y*t.x+i.col2.y*t.y,i=o.bodyB.m_xf.R,t=o.localPoint,r=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),a=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),i=o.bodyA.m_xf.R;for(var f=0;f<o.pointCount;++f)t=o.points[f].localPoint,l=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),n=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),this.m_separations[f]=(l-r)*this.m_normal.x+(n-a)*this.m_normal.y-o.radius,this.m_points[f].Set(l,n);this.m_normal.x*=-1,this.m_normal.y*=-1;}}}]),o}();vm.circlePointA=new ab,vm.circlePointB=new ab;function yL(t,$){if(!(t instanceof $))throw new TypeError("Cannot call a class as a function")}function zL($,e){if(!($ instanceof e))throw new TypeError("Cannot call a class as a function")}var AL=function $(){zL(this,$),this.localPoint=new ab,this.rA=new ab,this.rB=new ab};var BL=function t(){yL(this,t),this.localPlaneNormal=new ab,this.localPoint=new ab,this.normal=new ab,this.normalMass=new Kd,this.K=new Kd,this.points=new Array(cd).fill(0),this.points=this.points.map(function(){return new AL})};var Fj=function(){function r(){rL(this,r),this.m_step=new km,this.m_constraints=new Array,this.m_constraintCount=0}return sL(r,[{key:"Initialize",value:function(n,o){var t,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;this.m_step.Set(n),this.m_allocator=i;var e=0;for(this.m_constraintCount=a;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new BL;for(e=0;e<a;++e){var s=(t=o[e]).m_fixtureA,l=t.m_fixtureB;if(s&&l){var m=s.m_shape,p=l.m_shape;if(m&&p){var _=m.m_radius,y=p.m_radius,c=s.m_body,u=l.m_body;if(c&&u){var x=t.GetManifold(),v=$H(s.GetFriction(),l.GetFriction()),$=_H(s.GetRestitution(),l.GetRestitution()),f=c.m_linearVelocity.x,d=c.m_linearVelocity.y,I=u.m_linearVelocity.x,B=u.m_linearVelocity.y,A=c.m_angularVelocity,G=u.m_angularVelocity;xb(x.m_pointCount>0),r.s_worldManifold.Initialize(x,c.m_xf,_,u.m_xf,y);var M=r.s_worldManifold.m_normal.x,h=r.s_worldManifold.m_normal.y,C=this.m_constraints[e];C.bodyA=c,C.bodyB=u,C.manifold=x,C.normal.x=M,C.normal.y=h,C.pointCount=x.m_pointCount,C.friction=v,C.restitution=$,C.localPlaneNormal.x=x.m_localPlaneNormal.x,C.localPlaneNormal.y=x.m_localPlaneNormal.y,C.localPoint.x=x.m_localPoint.x,C.localPoint.y=x.m_localPoint.y,C.radius=_+y,C.type=x.m_type;for(var w=0;w<C.pointCount;++w){var D=x.m_points[w],J=C.points[w];J.normalImpulse=D.m_normalImpulse,J.tangentImpulse=D.m_tangentImpulse,J.localPoint.SetV(D.m_localPoint);var g=J.rA.x=r.s_worldManifold.m_points[w].x-c.m_sweep.c.x,b=J.rA.y=r.s_worldManifold.m_points[w].y-c.m_sweep.c.y,V=J.rB.x=r.s_worldManifold.m_points[w].x-u.m_sweep.c.x,P=J.rB.y=r.s_worldManifold.m_points[w].y-u.m_sweep.c.y,k=g*h-b*M,S=V*h-P*M;k*=k,S*=S;var q=c.m_invMass+u.m_invMass+c.m_invI*k+u.m_invI*S;J.normalMass=1/q;var z=c.m_mass*c.m_invMass+u.m_mass*u.m_invMass;z+=c.m_mass*c.m_invI*k+u.m_mass*u.m_invI*S,J.equalizedMass=1/z;var K=-M,R=g*K-b*h,T=V*K-P*h;R*=R,T*=T;var F=c.m_invMass+u.m_invMass+c.m_invI*R+u.m_invI*T;J.tangentMass=1/F,J.velocityBias=0;var N=I+-G*P-f- -A*b,j=B+G*V-d-A*g,E=C.normal.x*N+C.normal.y*j;E<-XH&&(J.velocityBias+=-C.restitution*E)}if(2===C.pointCount){var L=C.points[0],O=C.points[1],W=c.m_invMass,H=c.m_invI,Q=u.m_invMass,U=u.m_invI,X=L.rA.x*h-L.rA.y*M,Y=L.rB.x*h-L.rB.y*M,Z=O.rA.x*h-O.rA.y*M,rr=O.rB.x*h-O.rB.y*M,nr=W+Q+H*X*X+U*Y*Y,or=W+Q+H*Z*Z+U*rr*rr,tr=W+Q+H*X*Z+U*Y*rr;nr*nr<100*(nr*or-tr*tr)?(C.K.col1.Set(nr,tr),C.K.col2.Set(tr,or),C.K.GetInverse(C.normalMass)):C.pointCount=1}}}}}}},{key:"InitVelocityConstraints",value:function(r){for(var n=0;n<this.m_constraintCount;++n){var o=this.m_constraints[n],t=o.bodyA,a=o.bodyB,i=t.m_invMass,e=t.m_invI,s=a.m_invMass,l=a.m_invI,m=o.normal.x,p=o.normal.y,_=p,y=-m,c=0;if(r.warmStarting){c=o.pointCount;for(var u=0;u<c;++u){var x=o.points[u];x.normalImpulse*=r.dtRatio,x.tangentImpulse*=r.dtRatio;var v=x.normalImpulse*m+x.tangentImpulse*_,$=x.normalImpulse*p+x.tangentImpulse*y;t.m_angularVelocity-=e*(x.rA.x*$-x.rA.y*v),t.m_linearVelocity.x-=i*v,t.m_linearVelocity.y-=i*$,a.m_angularVelocity+=l*(x.rB.x*$-x.rB.y*v),a.m_linearVelocity.x+=s*v,a.m_linearVelocity.y+=s*$}}else{c=o.pointCount;for(var f=0;f<c;++f){var d=o.points[f];d.normalImpulse=0,d.tangentImpulse=0}}}}},{key:"SolveVelocityConstraints",value:function(){for(var r,n,o=0,t=0,a=0,i=0,e=0,s=0,l=0,m=0,p=0,_=0,y=0,c=0,u=0,x=0;x<this.m_constraintCount;++x){for(var v=this.m_constraints[x],$=v.bodyA,f=v.bodyB,d=$.m_angularVelocity,I=f.m_angularVelocity,B=$.m_linearVelocity,A=f.m_linearVelocity,G=$.m_invMass,M=$.m_invI,h=f.m_invMass,C=f.m_invI,w=v.normal.x,D=v.normal.y,J=D,g=-w,b=v.friction,V=0;V<v.pointCount;V++)r=v.points[V],t=(A.x-I*r.rB.y-B.x+d*r.rA.y)*J+(A.y+I*r.rB.x-B.y-d*r.rA.x)*g,a=r.tangentMass*-t,i=b*r.normalImpulse,s=(a=(e=vd(r.tangentImpulse+a,-i,i))-r.tangentImpulse)*J,l=a*g,B.x-=G*s,B.y-=G*l,d-=M*(r.rA.x*l-r.rA.y*s),A.x+=h*s,A.y+=h*l,I+=C*(r.rB.x*l-r.rB.y*s),r.tangentImpulse=e;if(1===v.pointCount)r=v.points[0],o=(A.x+-I*r.rB.y-B.x- -d*r.rA.y)*w+(A.y+I*r.rB.x-B.y-d*r.rA.x)*D,a=-r.normalMass*(o-r.velocityBias),s=(a=(e=(e=r.normalImpulse+a)>0?e:0)-r.normalImpulse)*w,l=a*D,B.x-=G*s,B.y-=G*l,d-=M*(r.rA.x*l-r.rA.y*s),A.x+=h*s,A.y+=h*l,I+=C*(r.rB.x*l-r.rB.y*s),r.normalImpulse=e;else{var P=v.points[0],k=v.points[1],S=P.normalImpulse,q=k.normalImpulse,z=(A.x-I*P.rB.y-B.x+d*P.rA.y)*w+(A.y+I*P.rB.x-B.y-d*P.rA.x)*D,K=(A.x-I*k.rB.y-B.x+d*k.rA.y)*w+(A.y+I*k.rB.x-B.y-d*k.rA.x)*D,R=z-P.velocityBias,T=K-k.velocityBias;for(R-=(n=v.K).col1.x*S+n.col2.x*q,T-=n.col1.y*S+n.col2.y*q;;){var F=-((n=v.normalMass).col1.x*R+n.col2.x*T),N=-(n.col1.y*R+n.col2.y*T);if(F>=0&&N>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}if(F=-P.normalMass*R,N=0,z=0,K=v.K.col1.y*F+T,F>=0&&K>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}if(F=0,N=-k.normalMass*T,z=v.K.col2.x*N+R,K=0,N>=0&&z>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}if(F=0,N=0,K=T,(z=R)>=0&&K>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}break}}$.m_angularVelocity=d,f.m_angularVelocity=I}}},{key:"FinalizeVelocityConstraints",value:function(){for(var r=0;r<this.m_constraintCount;++r)for(var n=this.m_constraints[r],o=n.manifold,t=0;t<n.pointCount;++t){var a=o.m_points[t],i=n.points[t];a.m_normalImpulse=i.normalImpulse,a.m_tangentImpulse=i.tangentImpulse}}},{key:"SolvePositionConstraints",value:function(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=0,t=0;t<this.m_constraintCount;t++){var a=this.m_constraints[t],i=a.bodyA,e=a.bodyB,s=i.m_mass*i.m_invMass,l=i.m_mass*i.m_invI,m=e.m_mass*e.m_invMass,p=e.m_mass*e.m_invI;r.s_psm.Initialize(a);for(var _=r.s_psm.m_normal,y=0;y<a.pointCount;y++){var c=a.points[y],u=r.s_psm.m_points[y],x=r.s_psm.m_separations[y],v=u.x-i.m_sweep.c.x,$=u.y-i.m_sweep.c.y,f=u.x-e.m_sweep.c.x,d=u.y-e.m_sweep.c.y;o=o<x?o:x;var I=vd(n*(x+wd),-YH,0),B=-c.equalizedMass*I,A=B*_.x,G=B*_.y;i.m_sweep.c.x-=s*A,i.m_sweep.c.y-=s*G,i.m_sweep.a-=l*(v*G-$*A),i.SynchronizeTransform(),e.m_sweep.c.x+=m*A,e.m_sweep.c.y+=m*G,e.m_sweep.a+=p*(f*G-d*A),e.SynchronizeTransform()}}return o>-1.5*wd}}]),r}();Fj.s_worldManifold=new vL,Fj.s_psm=new vm;function CL(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Px(t,i){for(var o=0;o<i.length;o++){var e=i[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function DL(t,i,o){return i&&Px(t.prototype,i),o&&Px(t,o),t}function EL(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}var FL=function a(){EL(this,a),this.normalImpulses=new Array(cd),this.tangentImpulses=new Array(cd)};var Qx=function(){function t(){CL(this,t),this.m_bodies=new Array,this.m_contacts=new Array,this.m_joints=new Array,this.m_bodyCapacity=0,this.m_contactCapacity=0,this.m_jointCapacity=0,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=void 0,this.m_listener=void 0,this.m_contactSolver=new Fj}return DL(t,[{key:"Initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;this.m_bodyCapacity=t,this.m_contactCapacity=i,this.m_jointCapacity=o,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=e,this.m_listener=n,this.m_contactSolver=a;for(var r=this.m_bodies.length;r<t;r++)this.m_bodies[r]=null;for(var s=this.m_contacts.length;s<i;s++)this.m_contacts[s]=null;for(var m=this.m_joints.length;m<o;m++)this.m_joints[m]=null}},{key:"Clear",value:function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0}},{key:"Solve",value:function(t,i,o){var e,n=0,a=0;for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).GetType()===eb.b2_dynamicBody&&(e.m_linearVelocity.x+=t.dt*(i.x+e.m_invMass*e.m_force.x),e.m_linearVelocity.y+=t.dt*(i.y+e.m_invMass*e.m_force.y),e.m_angularVelocity+=t.dt*e.m_invI*e.m_torque,e.m_linearVelocity.Multiply(vd(1-t.dt*e.m_linearDamping,0,1)),e.m_angularVelocity*=vd(1-t.dt*e.m_angularDamping,0,1));this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var r=this.m_contactSolver;for(r.InitVelocityConstraints(t),n=0;n<this.m_jointCount;++n)this.m_joints[n].InitVelocityConstraints(t);for(n=0;n<t.velocityIterations;++n){for(a=0;a<this.m_jointCount;++a)this.m_joints[a].SolveVelocityConstraints(t);r.SolveVelocityConstraints()}for(n=0;n<this.m_jointCount;++n)this.m_joints[n].FinalizeVelocityConstraints();for(r.FinalizeVelocityConstraints(),n=0;n<this.m_bodyCount;++n)if((e=this.m_bodies[n]).GetType()!==eb.b2_staticBody){var s=t.dt*e.m_linearVelocity.x,m=t.dt*e.m_linearVelocity.y;s*s+m*m>Bw&&(e.m_linearVelocity.Normalize(),e.m_linearVelocity.x*=Pf*t.inv_dt,e.m_linearVelocity.y*=Pf*t.inv_dt);var l=t.dt*e.m_angularVelocity;l*l>Cw&&(e.m_angularVelocity<0?e.m_angularVelocity=-Qf*t.inv_dt:e.m_angularVelocity=Qf*t.inv_dt),e.m_sweep.c0.SetV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=t.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=t.dt*e.m_linearVelocity.y,e.m_sweep.a+=t.dt*e.m_angularVelocity,e.SynchronizeTransform()}for(n=0;n<t.positionIterations;++n){var _=r.SolvePositionConstraints(jm),c=!0;for(a=0;a<this.m_jointCount;++a){var $=this.m_joints[a].SolvePositionConstraints(jm);c=c&&$}if(_&&c)break}if(this.Report(r.m_constraints),o){var y=Number.MAX_VALUE,p=Dw*Dw,u=Ew*Ew;for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).GetType()!==eb.b2_staticBody&&(0==(e.m_flags&eb.e_allowSleepFlag)&&(e.m_sleepTime=0,y=0),0==(e.m_flags&eb.e_allowSleepFlag)||e.m_angularVelocity*e.m_angularVelocity>u||Ib(e.m_linearVelocity,e.m_linearVelocity)>p?(e.m_sleepTime=0,y=0):(e.m_sleepTime+=t.dt,y=PH(y,e.m_sleepTime)));if(y>=ZH)for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).SetAwake(!1)}}},{key:"SolveTOI",value:function(t){var i=0,o=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var e=this.m_contactSolver;for(i=0;i<this.m_jointCount;++i)this.m_joints[i].InitVelocityConstraints(t);for(i=0;i<t.velocityIterations;++i)for(e.SolveVelocityConstraints(),o=0;o<this.m_jointCount;++o)this.m_joints[o].SolveVelocityConstraints(t);for(i=0;i<this.m_bodyCount;++i){var n=this.m_bodies[i];if(n.GetType()!==eb.b2_staticBody){var a=t.dt*n.m_linearVelocity.x,r=t.dt*n.m_linearVelocity.y;a*a+r*r>Bw&&(n.m_linearVelocity.Normalize(),n.m_linearVelocity.x*=Pf*t.inv_dt,n.m_linearVelocity.y*=Pf*t.inv_dt);var s=t.dt*n.m_angularVelocity;s*s>Cw&&(n.m_angularVelocity<0?n.m_angularVelocity=-Qf*t.inv_dt:n.m_angularVelocity=Qf*t.inv_dt),n.m_sweep.c0.SetV(n.m_sweep.c),n.m_sweep.a0=n.m_sweep.a,n.m_sweep.c.x+=t.dt*n.m_linearVelocity.x,n.m_sweep.c.y+=t.dt*n.m_linearVelocity.y,n.m_sweep.a+=t.dt*n.m_angularVelocity,n.SynchronizeTransform()}}for(i=0;i<t.positionIterations;++i){var m=e.SolvePositionConstraints(.75),l=!0;for(o=0;o<this.m_jointCount;++o){var _=this.m_joints[o].SolvePositionConstraints(jm);l=l&&_}if(m&&l)break}this.Report(e.m_constraints)}},{key:"Report",value:function(i){if(this.m_listener)for(var o=0;o<this.m_contactCount;++o)for(var e=i[o],n=0;n<e.pointCount;++n)t.s_impulse.normalImpulses[n]=e.points[n].normalImpulse,t.s_impulse.tangentImpulses[n]=e.points[n].tangentImpulse}},{key:"AddBody",value:function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t}},{key:"AddContact",value:function(t){this.m_contacts[this.m_contactCount++]=t}},{key:"AddJoint",value:function(t){this.m_joints[this.m_jointCount++]=t}}]),t}();Qx.s_impulse=new FL;function GL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rx(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function HL(e,t,n){return t&&Rx(e.prototype,t),n&&Rx(e,n),e}function IL(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var Sx=function a(){IL(this,a)};var pb=function(){function e(t){GL(this,e),this.m_edgeA=new Sx,this.m_edgeB=new Sx,this.m_localCenterA=new ab,this.m_localCenterB=new ab,this.m_type=e.e_unknownJoint,this.m_collideConnected=!1,this.m_islandFlag=!1,xb(t.bodyA!==t.bodyB),this.m_type=t.type,this.m_prev=void 0,this.m_next=void 0,this.m_bodyA=t.bodyA,this.m_bodyB=t.bodyB,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData}return HL(e,[{key:"GetType",value:function(){return this.m_type}},{key:"GetAnchorA",value:function(){return new ab}},{key:"GetAnchorB",value:function(){return new ab}},{key:"GetReactionForce",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new ab}},{key:"GetReactionTorque",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0}},{key:"GetBodyA",value:function(){return this.m_bodyA}},{key:"GetBodyB",value:function(){return this.m_bodyB}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(e){this.m_userData=e}},{key:"IsActive",value:function(){return this.m_bodyA&&this.m_bodyA.IsActive()&&this.m_bodyB&&this.m_bodyB.IsActive()}},{key:"InitVelocityConstraints",value:function(e){}},{key:"SolveVelocityConstraints",value:function(e){}},{key:"FinalizeVelocityConstraints",value:function(){}},{key:"SolvePositionConstraints",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!1}}],[{key:"Destroy",value:function(e,t){}}]),e}();pb.e_unknownJoint=0,pb.e_revoluteJoint=1,pb.e_prismaticJoint=2,pb.e_distanceJoint=3,pb.e_pulleyJoint=4,pb.e_mouseJoint=5,pb.e_gearJoint=6,pb.e_lineJoint=7,pb.e_weldJoint=8,pb.e_frictionJoint=9,pb.e_inactiveLimit=0,pb.e_atLowerLimit=1,pb.e_atUpperLimit=2,pb.e_equalLimits=3;function JL(e,t){switch(e.type){case pb.e_distanceJoint:break;case pb.e_mouseJoint:return new SL(e);case pb.e_prismaticJoint:case pb.e_revoluteJoint:case pb.e_pulleyJoint:case pb.e_gearJoint:case pb.e_lineJoint:case pb.e_weldJoint:case pb.e_frictionJoint:}return new pb(e)}function KL(t){return(KL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function LL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tx(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function ML(t,e,o){return e&&Tx(t.prototype,e),o&&Tx(t,o),t}function NL(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&OL(t,e)}function OL(t,e){return(OL=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function PL(t){var e=RL();return function(){var o,r=Vx(t);if(e){var i=Vx(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return Ux(this,o)}}function Ux(t,e){return!e||"object"!==KL(e)&&"function"!=typeof e?QL(t):e}function QL(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RL(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Vx(t){return(Vx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var SL=function(t){NL(o,pb);var e=PL(o);function o(t){var r;if(LL(this,o),(r=e.call(this,t)).K=new Kd,r.K1=new Kd,r.K2=new Kd,r.m_localAnchor=new ab,r.m_target=new ab,r.m_impulse=new ab,r.m_mass=new Kd,r.m_C=new ab,r.m_maxForce=1/0,r.m_frequencyHz=0,r.m_dampingRatio=0,r.m_beta=0,r.m_gamma=0,r.m_target.SetV(t.target),!r.m_bodyB)return Ux(r);var i=r.m_target.x-r.m_bodyB.m_xf.position.x,n=r.m_target.y-r.m_bodyB.m_xf.position.y,a=r.m_bodyB.m_xf.R;return r.m_localAnchor.x=i*a.col1.x+n*a.col1.y,r.m_localAnchor.y=i*a.col2.x+n*a.col2.y,r.m_maxForce=t.maxForce,r.m_frequencyHz=t.frequencyHz,r.m_dampingRatio=t.dampingRatio,r}return ML(o,[{key:"GetAnchorA",value:function(){return this.m_target}},{key:"GetAnchorB",value:function(){return this.m_bodyB?this.m_bodyB.GetWorldPoint(this.m_localAnchor):new ab}},{key:"GetReactionForce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new ab(t*this.m_impulse.x,t*this.m_impulse.y)}},{key:"GetReactionTorque",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0}},{key:"GetTarget",value:function(){return this.m_target}},{key:"SetTarget",value:function(t){this.m_bodyB&&(!1===this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t)}},{key:"GetMaxForce",value:function(){return this.m_maxForce}},{key:"SetMaxForce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_maxForce=t}},{key:"GetFrequency",value:function(){return this.m_frequencyHz}},{key:"SetFrequency",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_frequencyHz=t}},{key:"GetDampingRatio",value:function(){return this.m_dampingRatio}},{key:"SetDampingRatio",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_dampingRatio=t}},{key:"InitVelocityConstraints",value:function(t){var e=this.m_bodyB,o=e.GetMass(),r=2*Math.PI*this.m_frequencyHz,i=2*o*this.m_dampingRatio*r,n=o*r*r;this.m_gamma=t.dt*(i+t.dt*n),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*n*this.m_gamma;var a=e.m_xf.R,m=this.m_localAnchor.x-e.m_sweep.localCenter.x,s=this.m_localAnchor.y-e.m_sweep.localCenter.y,c=a.col1.x*m+a.col2.x*s;s=a.col1.y*m+a.col2.y*s,m=c;var l=e.m_invMass,u=e.m_invI;this.K1.col1.x=l,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=l,this.K2.col1.x=u*s*s,this.K2.col2.x=-u*m*s,this.K2.col1.y=-u*m*s,this.K2.col2.y=u*m*m,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=e.m_sweep.c.x+m-this.m_target.x,this.m_C.y=e.m_sweep.c.y+s-this.m_target.y,e.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,e.m_linearVelocity.x+=l*this.m_impulse.x,e.m_linearVelocity.y+=l*this.m_impulse.y,e.m_angularVelocity+=u*(m*this.m_impulse.y-s*this.m_impulse.x)}},{key:"SolveVelocityConstraints",value:function(t){var e,o=this.m_bodyB,r=0,i=o.m_xf.R,n=this.m_localAnchor.x-o.m_sweep.localCenter.x,a=this.m_localAnchor.y-o.m_sweep.localCenter.y;r=i.col1.x*n+i.col2.x*a,a=i.col1.y*n+i.col2.y*a,n=r;var m=o.m_linearVelocity.x+-o.m_angularVelocity*a,s=o.m_linearVelocity.y+o.m_angularVelocity*n;i=this.m_mass,r=m+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,e=s+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var c=-(i.col1.x*r+i.col2.x*e),l=-(i.col1.y*r+i.col2.y*e),u=this.m_impulse.x,_=this.m_impulse.y;this.m_impulse.x+=c,this.m_impulse.y+=l;var $=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>$*$&&this.m_impulse.Multiply($/this.m_impulse.Length()),c=this.m_impulse.x-u,l=this.m_impulse.y-_,o.m_linearVelocity.x+=o.m_invMass*c,o.m_linearVelocity.y+=o.m_invMass*l,o.m_angularVelocity+=o.m_invI*(n*l-a*c)}},{key:"SolvePositionConstraints",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!0}}]),o}();function TL(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var UL=function a(){TL(this,a),this.normal=new ab,this.fraction=0};var Ub=function(){function t(e,r){eI(this,t),this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,this.m_allowSleep=!0,this.m_gravity=new ab,this.m_inv_dt0=0,this.m_flags=0,this.m_contactManager=new Lx,this.m_contactSolver=new Fj,this.m_island=new Qx,this.m_groundBody=this.CreateBody(new wm),this.s_stack=[],this.m_gravity=e,this.m_allowSleep=r,this.m_contactManager.m_world=this}return fI(t,[{key:"SetDestructionListener",value:function(t){this.m_destructionListener=t}},{key:"SetContactFilter",value:function(t){this.m_contactManager.m_contactFilter=t}},{key:"SetContactListener",value:function(t){this.m_contactManager.m_contactListener=t}},{key:"SetDebugDraw",value:function(t){this.m_debugDraw=t}},{key:"SetBroadPhase",value:function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var r=this.m_bodyList;r;r=r.m_next)for(var o=r.m_fixtureList;o;o=o.m_next)o.m_proxy=t.CreateProxy(e.GetFatAABB(o.m_proxy),o)}},{key:"Validate",value:function(){this.m_contactManager.m_broadPhase.Validate()}},{key:"GetProxyCount",value:function(){return this.m_contactManager.m_broadPhase.GetProxyCount()}},{key:"CreateBody",value:function(t){if(this.IsLocked())throw new Error("Cannot create bodies on a locked world.");var e=new eb(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e}},{key:"DestroyBody",value:function(t){if(!this.IsLocked()){for(var e=t.m_jointList;e;){var r=e;e=e.next,this.m_destructionListener&&(this.m_destructionListener.SayGoodbyeJoint(r.joint),this.DestroyJoint(r.joint))}for(var o=t.m_controllerList;o;){var i=o;o=o.nextController,i.controller.RemoveBody(t)}for(var n=t.m_contactList;n;){var a=n;n=n.next,this.m_contactManager.Destroy(a.contact)}t.m_contactList=null;for(var s=t.m_fixtureList;s;){var m=s;s=s.m_next,this.m_destructionListener&&(this.m_destructionListener.SayGoodbyeFixture(m),m.DestroyProxy(this.m_contactManager.m_broadPhase),m.Destroy())}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}}},{key:"CreateJoint",value:function(t){if(t.bodyA&&t.bodyB){var e=JL(t,null);if(e.m_bodyA&&e.m_bodyB){e.m_prev=void 0,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=void 0,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=void 0,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var r=t.bodyA,o=t.bodyB;if(!1===t.collideConnected)for(var i=o.GetContactList();i;)i.other===r&&i.contact.FlagForFiltering(),i=i.next;return e}}}},{key:"DestroyJoint",value:function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_jointList&&(this.m_jointList=t.m_next);var r=t.m_bodyA,o=t.m_bodyB;if(r&&o&&(r.SetAwake(!0),o.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA===r.m_jointList&&(r.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=void 0,t.m_edgeA.next=void 0,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB===o.m_jointList&&(o.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=void 0,t.m_edgeB.next=void 0,pb.Destroy(t,null),--this.m_jointCount,!1===e))for(var i=o.GetContactList();i;)i.other===r&&i.contact.FlagForFiltering(),i=i.next}},{key:"AddController",value:function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t}},{key:"RemoveController",value:function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList===t&&(this.m_controllerList=t.m_next),this.m_controllerCount--}},{key:"CreateController",value:function(t){if(t.m_world!==this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t}},{key:"DestroyController",value:function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t===this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount}},{key:"SetWarmStarting",value:function(e){t.m_warmStarting=e}},{key:"SetContinuousPhysics",value:function(e){t.m_continuousPhysics=e}},{key:"GetBodyCount",value:function(){return this.m_bodyCount}},{key:"GetJointCount",value:function(){return this.m_jointCount}},{key:"GetContactCount",value:function(){return this.m_contactCount}},{key:"SetGravity",value:function(t){this.m_gravity=t}},{key:"GetGravity",value:function(){return this.m_gravity}},{key:"GetGroundBody",value:function(){return this.m_groundBody}},{key:"Step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.m_flags&t.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~t.e_newFixture),this.m_flags|=t.e_locked;var i=t.s_timestep2;i.dt=e,i.velocityIterations=r,i.positionIterations=o,i.inv_dt=e>0?1/e:0,i.dtRatio=this.m_inv_dt0*e,i.warmStarting=t.m_warmStarting,this.m_contactManager.Collide(),i.dt>0&&this.Solve(i),t.m_continuousPhysics&&i.dt>0&&this.SolveTOI(i),i.dt>0&&(this.m_inv_dt0=i.inv_dt),this.m_flags&=~t.e_locked}},{key:"ClearForces",value:function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0}},{key:"DrawDebugData",value:function(){if(this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var e,r,o,i,n,a,s=this.m_debugDraw.GetFlags(),m=[new ab,new ab,new ab,new ab],_=new Jw(0,0,0);if(s&Ob.e_shapeBit)for(e=this.m_bodyList;e;e=e.m_next)for(a=e.m_xf,r=e.GetFixtureList();r;r=r.m_next)o=r.GetShape(),!1===e.IsActive()?(_.Set(.5,.5,.3),this.DrawShape(o,a,_)):e.GetType()===eb.b2_staticBody?(_.Set(.5,.9,.5),this.DrawShape(o,a,_)):e.GetType()===eb.b2_kinematicBody?(_.Set(.5,.5,.9),this.DrawShape(o,a,_)):!1===e.IsAwake()?(_.Set(.6,.6,.6),this.DrawShape(o,a,_)):(_.Set(.9,.7,.7),this.DrawShape(o,a,_));if(s&Ob.e_jointBit)for(i=this.m_jointList;i;i=i.m_next)this.DrawJoint(i);if(s&Ob.e_controllerBit)for(var $=this.m_controllerList;$;$=$.m_next)$.Draw(this.m_debugDraw);if(s&Ob.e_pairBit){_.Set(.3,.9,.9);for(var c=this.m_contactManager.m_contactList;c;c=c.GetNext()){var l=c.GetFixtureA(),d=c.GetFixtureB();if(l&&d){var u=l.GetAABB().GetCenter(),p=d.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(u,p,_)}}}if(s&Ob.e_aabbBit)for(n=this.m_contactManager.m_broadPhase,m=[new ab,new ab,new ab,new ab],e=this.m_bodyList;e;e=e.GetNext())if(e.IsActive())for(r=e.GetFixtureList();r;r=r.GetNext()){var x=n.GetFatAABB(r.m_proxy);m[0].Set(x.lowerBound.x,x.lowerBound.y),m[1].Set(x.upperBound.x,x.lowerBound.y),m[2].Set(x.upperBound.x,x.upperBound.y),m[3].Set(x.lowerBound.x,x.upperBound.y),this.m_debugDraw.DrawPolygon(m,4,_)}if(s&Ob.e_centerOfMassBit)for(e=this.m_bodyList;e;e=e.m_next)(a=t.s_xf).R=e.m_xf.R,a.position=e.GetWorldCenter(),this.m_debugDraw.DrawTransform(a)}}},{key:"QueryAABB",value:function(t,e){var r=this.m_contactManager.m_broadPhase;r.Query(function(e){return t(r.GetUserData(e))},e)}},{key:"QueryShape",value:function(t,e,r){r||(r=new xd).SetIdentity();var o=this.m_contactManager.m_broadPhase,i=new Ld;e.ComputeAABB(i,r),o.Query(function(i){var n=o.GetUserData(i)instanceof Bg?o.GetUserData(i):null;return!nb.TestOverlap(e,r,n.GetShape(),n.GetBody().GetTransform())||t(n)},i)}},{key:"QueryPoint",value:function(t,e){var r=this.m_contactManager.m_broadPhase,o=new Ld;o.lowerBound.Set(e.x-wd,e.y-wd),o.upperBound.Set(e.x+wd,e.y+wd),r.Query(function(o){var i=r.GetUserData(o)instanceof Bg?r.GetUserData(o):null;return!i.TestPoint(e)||t(i)},o)}},{key:"RayCast",value:function(t,e,r){var o=this.m_contactManager.m_broadPhase,i=new UL,n=new ex(e,r);o.RayCast(function(n,a){var s=o.GetUserData(a);if(!(s instanceof Bg))return n.maxFraction;if(s.RayCast(i,n)){var m=i.fraction,_=new ab((1-m)*e.x+m*r.x,(1-m)*e.y+m*r.y);return t(s,_,i.normal,m)}},n)}},{key:"RayCastOne",value:function(t,e){var r;return this.RayCast(function(t,e,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return r=t,i},t,e),r}},{key:"RayCastAll",value:function(t,e){var r=new Array;return this.RayCast(function(t,e,o){arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r[r.length]=t,1},t,e),r}},{key:"GetBodyList",value:function(){return this.m_bodyList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetContactList",value:function(){return this.m_contactList}},{key:"IsLocked",value:function(){return(this.m_flags&t.e_locked)>0}},{key:"Solve",value:function(t){for(var e,r=this.m_controllerList;r;r=r.m_next)r.Step(t);var o=this.m_island;for(o.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~eb.e_islandFlag;for(var i=this.m_contactList;i;i=i.m_next)i.m_flags&=~tb.e_islandFlag;for(var n=this.m_jointList;n;n=n.m_next)n.m_islandFlag=!1;for(var a=this.s_stack,s=this.m_bodyList;s;s=s.m_next)if(!(s.m_flags&eb.e_islandFlag)&&!1!==s.IsAwake()&&!1!==s.IsActive()&&s.GetType()!==eb.b2_staticBody){o.Clear();var m=0;for(a[m++]=s,s.m_flags|=eb.e_islandFlag;m>0;)if(e=a[--m],o.AddBody(e),!1===e.IsAwake()&&e.SetAwake(!0),e.GetType()!==eb.b2_staticBody){for(var _=void 0,$=e.m_contactList;$;$=$.next)$.contact.m_flags&tb.e_islandFlag||!0!==$.contact.IsSensor()&&!1!==$.contact.IsEnabled()&&!1!==$.contact.IsTouching()&&(o.AddContact($.contact),$.contact.m_flags|=tb.e_islandFlag,(_=$.other).m_flags&eb.e_islandFlag||(a[m++]=_,_.m_flags|=eb.e_islandFlag));for(var c=e.m_jointList;c;c=c.next)!0!==c.joint.m_islandFlag&&!1!==(_=c.other).IsActive()&&(o.AddJoint(c.joint),c.joint.m_islandFlag=!0,_.m_flags&eb.e_islandFlag||(a[m++]=_,_.m_flags|=eb.e_islandFlag))}o.Solve(t,this.m_gravity,this.m_allowSleep);for(var l=0;l<o.m_bodyCount;++l)(e=o.m_bodies[l]).GetType()===eb.b2_staticBody&&(e.m_flags&=~eb.e_islandFlag)}for(var d=0;d<a.length&&a[d];++d)a[d]=null;for(e=this.m_bodyList;e;e=e.m_next)!1!==e.IsAwake()&&!1!==e.IsActive()&&e.GetType()!==eb.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()}},{key:"SolveTOI",value:function(e){var r,o,i,n,a,s,m,_=this.m_island;_.Initialize(this.m_bodyCount,VH,WH,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var $,c=t.s_queue;for(r=this.m_bodyList;r;r=r.m_next)r.m_flags&=~eb.e_islandFlag,r.m_sweep.t0=0;for($=this.m_contactList;$;$=$.m_next)$.m_flags&=~(tb.e_toiFlag|tb.e_islandFlag);for(m=this.m_jointList;m;m=m.m_next)m.m_islandFlag=!1;for(;;){var l=null,d=1;for($=this.m_contactList;$;$=$.m_next)if(!0!==$.IsSensor()&&!1!==$.IsEnabled()&&!1!==$.IsContinuous()){var u=1;if($.m_flags&tb.e_toiFlag)u=$.m_toi;else{if(o=$.m_fixtureA,i=$.m_fixtureB,n=o.m_body,a=i.m_body,!(n.GetType()===eb.b2_dynamicBody&&!1!==n.IsAwake()||a.GetType()===eb.b2_dynamicBody&&!1!==a.IsAwake()))continue;var p=n.m_sweep.t0;n.m_sweep.t0<a.m_sweep.t0?(p=a.m_sweep.t0,n.m_sweep.Advance(p)):a.m_sweep.t0<n.m_sweep.t0&&(p=n.m_sweep.t0,a.m_sweep.Advance(p)),u=$.ComputeTOI(n.m_sweep,a.m_sweep),xb(0<=u&&u<=1),u>0&&u<1&&(u=(1-u)*p+u)>1&&(u=1),$.m_toi=u,$.m_flags|=tb.e_toiFlag}Number.MIN_VALUE<u&&u<d&&(l=$,d=u)}if(null===l||1-100*Number.MIN_VALUE<d)break;if(o=l.m_fixtureA,i=l.m_fixtureB,n=o.m_body,a=i.m_body,t.s_backupA.Set(n.m_sweep),t.s_backupB.Set(a.m_sweep),n.Advance(d),a.Advance(d),l.Update(this.m_contactManager.m_contactListener),l.m_flags&=~tb.e_toiFlag,!0!==l.IsSensor()&&!1!==l.IsEnabled()){if(!1!==l.IsTouching()){var x=n;x.GetType()!==eb.b2_dynamicBody&&(x=a),_.Clear();var y=0,h=0;for(c[y+h++]=x,x.m_flags|=eb.e_islandFlag;h>0;)if(r=c[y++],--h,_.AddBody(r),!1===r.IsAwake()&&r.SetAwake(!0),r.GetType()===eb.b2_dynamicBody){for(s=r.m_contactList;s&&_.m_contactCount!==_.m_contactCapacity;s=s.next)if(!(s.contact.m_flags&tb.e_islandFlag)&&!0!==s.contact.IsSensor()&&!1!==s.contact.IsEnabled()&&!1!==s.contact.IsTouching()){_.AddContact(s.contact),s.contact.m_flags|=tb.e_islandFlag;var f=s.other;f.m_flags&eb.e_islandFlag||(f.GetType()!==eb.b2_staticBody&&(f.Advance(d),f.SetAwake(!0)),c[y+h]=f,++h,f.m_flags|=eb.e_islandFlag)}for(var v=r.m_jointList;v;v=v.next)if(_.m_jointCount!==_.m_jointCapacity&&!0!==v.joint.m_islandFlag){var g=v.other;!1!==g.IsActive()&&(_.AddJoint(v.joint),v.joint.m_islandFlag=!0,g.m_flags&eb.e_islandFlag||(g.GetType()!==eb.b2_staticBody&&(g.Advance(d),g.SetAwake(!0)),c[y+h]=g,++h,g.m_flags|=eb.e_islandFlag))}}var z=t.s_timestep;z.warmStarting=!1,z.dt=(1-d)*e.dt,z.inv_dt=1/z.dt,z.dtRatio=0,z.velocityIterations=e.velocityIterations,z.positionIterations=e.positionIterations,_.SolveTOI(z);for(var Y=0;Y<_.m_bodyCount;++Y)if((r=_.m_bodies[Y]).m_flags&=~eb.e_islandFlag,!1!==r.IsAwake()&&r.GetType()===eb.b2_dynamicBody)for(r.SynchronizeFixtures(),s=r.m_contactList;s;s=s.next)s.contact.m_flags&=~tb.e_toiFlag;for(var w=0;w<_.m_contactCount;++w)($=_.m_contacts[w]).m_flags&=~(tb.e_toiFlag|tb.e_islandFlag);for(var b=0;b<_.m_jointCount;++b)(m=_.m_joints[b]).m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else n.m_sweep.Set(t.s_backupA),a.m_sweep.Set(t.s_backupB),n.SynchronizeTransform(),a.SynchronizeTransform()}}},{key:"DrawJoint",value:function(e){if(this.m_debugDraw){var r=e.GetBodyA(),o=e.GetBodyB();if(r&&o){var i=r.m_xf,n=o.m_xf,a=i.position,s=n.position,m=e.GetAnchorA(),_=e.GetAnchorB();if(m&&_){var $=t.s_jointColor;switch(e.m_type){case pb.e_distanceJoint:this.m_debugDraw.DrawSegment(m,_,$);break;case pb.e_pulleyJoint:break;case pb.e_mouseJoint:this.m_debugDraw.DrawSegment(m,_,$);break;default:r!==this.m_groundBody&&this.m_debugDraw.DrawSegment(a,m,$),this.m_debugDraw.DrawSegment(m,_,$),o!==this.m_groundBody&&this.m_debugDraw.DrawSegment(s,_,$);}}}}}},{key:"DrawShape",value:function(t,e,r){if(this.m_debugDraw)switch(t.m_type){case nb.e_circleShape:if(!(t instanceof Tf))return;var o=t,i=wb(e,o.m_p),n=o.m_radius,a=e.R.col1;this.m_debugDraw.DrawSolidCircle(i,n,a,r);break;case nb.e_polygonShape:if(!(t instanceof hf))return;for(var s=t,m=parseInt("".concat(s.GetVertexCount()),10),_=s.GetVertices(),$=new Array(m),c=0;c<m;++c)$[c]=wb(e,_[c]);this.m_debugDraw.DrawSolidPolygon($,m,r);break;case nb.e_edgeShape:if(!(t instanceof um))return;var l=t;this.m_debugDraw.DrawSegment(wb(e,l.GetVertex1()),wb(e,l.GetVertex2()),r);}}}]),t}();Ub.s_timestep2=new km,Ub.s_xf=new xd,Ub.s_backupA=new gf,Ub.s_backupB=new gf,Ub.s_timestep=new km,Ub.s_queue=new Array,Ub.s_jointColor=new Jw(.5,.8,.8),Ub.e_newFixture=1,Ub.e_locked=2,Ub.m_warmStarting=!0,Ub.m_continuousPhysics=!0;function VL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Wx=function t(){VL(this,t),this.filter=new Qw,this.shape=void 0,this.userData=void 0,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0};var eb=function(){function t(e,i){TH(this,t),this.m_world=i,this.m_xf=new xd,this.m_sweep=new gf,this.m_linearVelocity=new ab,this.m_angularVelocity=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_force=new ab,this.m_torque=0,this.m_flags=0,this.m_islandIndex=0,this.m_flags=0,e.bullet&&(this.m_flags|=t.e_bulletFlag),e.fixedRotation&&(this.m_flags|=t.e_fixedRotationFlag),e.allowSleep&&(this.m_flags|=t.e_allowSleepFlag),e.awake&&(this.m_flags|=t.e_awakeFlag),e.active&&(this.m_flags|=t.e_activeFlag),this.m_xf.position.SetV(e.position),this.m_xf.R.Set(e.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=e.angle;var s=this.m_xf.R,a=this.m_sweep.localCenter;this.m_sweep.c.x=s.col1.x*a.x+s.col2.x*a.y,this.m_sweep.c.y=s.col1.y*a.x+s.col2.y*a.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=e.type,this.m_type===t.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=e.inertiaScale,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0}return UH(t,[{key:"connectEdges",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=Math.atan2(e.GetDirectionVector().y,e.GetDirectionVector().x),a=Math.tan(.5*(s-i)),n=xw(a,e.GetDirectionVector());n=sb(n,e.GetNormalVector()),n=xw(Ag,n),n=yj(n,e.GetVertex1());var o=yj(t.GetDirectionVector(),e.GetDirectionVector());o.Normalize();var r=Ib(t.GetDirectionVector(),e.GetNormalVector())>0;return t.SetNextEdge(e,n,o,r),e.SetPrevEdge(t,n,o,r),s}},{key:"CreateFixture",value:function(e){if(this.m_world&&!this.m_world.IsLocked()){var i=new Bg;if(i.Create(this,this.m_xf,e),this.m_flags&t.e_activeFlag){var s=this.m_world.m_contactManager.m_broadPhase;i.CreateProxy(s,this.m_xf)}return i.m_next=this.m_fixtureList,this.m_fixtureList=i,++this.m_fixtureCount,i.m_body=this,i.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=Ub.e_newFixture,i}}},{key:"CreateFixture2",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=new Wx;return i.shape=t,i.density=e,this.CreateFixture(i)}},{key:"DestroyFixture",value:function(e){if(this.m_world&&!this.m_world.IsLocked()){for(var i=this.m_fixtureList,s=null;null!==i;){if(i===e){s?s.m_next=e.m_next:this.m_fixtureList=e.m_next;break}s=i,i=i.m_next}for(var a=this.m_contactList;a;){var n=a.contact;a=a.next;var o=n.GetFixtureA(),r=n.GetFixtureB();e!==o&&e!==r||this.m_world.m_contactManager.Destroy(n)}if(this.m_flags&t.e_activeFlag){var l=this.m_world.m_contactManager.m_broadPhase;e.DestroyProxy(l)}e.Destroy(),e.m_body=void 0,e.m_next=void 0,--this.m_fixtureCount,this.ResetMassData()}}},{key:"SetPositionAndAngle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.m_world&&!this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var i=this.m_xf.R,s=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*s.x+i.col2.x*s.y,this.m_sweep.c.y=i.col1.y*s.x+i.col2.y*s.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;for(var a=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(a,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}}},{key:"SetTransform",value:function(t){this.SetPositionAndAngle(t.position,t.GetAngle())}},{key:"GetTransform",value:function(){return this.m_xf}},{key:"GetPosition",value:function(){return this.m_xf.position}},{key:"SetPosition",value:function(t){this.SetPositionAndAngle(t,this.GetAngle())}},{key:"GetAngle",value:function(){return this.m_sweep.a}},{key:"SetAngle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.SetPositionAndAngle(this.GetPosition(),t)}},{key:"GetWorldCenter",value:function(){return this.m_sweep.c}},{key:"GetLocalCenter",value:function(){return this.m_sweep.localCenter}},{key:"SetLinearVelocity",value:function(e){this.m_type!==t.b2_staticBody&&this.m_linearVelocity.SetV(e)}},{key:"GetLinearVelocity",value:function(){return this.m_linearVelocity}},{key:"SetAngularVelocity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_type!==t.b2_staticBody&&(this.m_angularVelocity=e)}},{key:"GetAngularVelocity",value:function(){return this.m_angularVelocity}},{key:"GetDefinition",value:function(){var e=new wm;return e.type=this.GetType(),e.allowSleep=(this.m_flags&t.e_allowSleepFlag)===t.e_allowSleepFlag,e.angle=this.GetAngle(),e.angularDamping=this.m_angularDamping,e.angularVelocity=this.m_angularVelocity,e.fixedRotation=(this.m_flags&t.e_fixedRotationFlag)===t.e_fixedRotationFlag,e.bullet=(this.m_flags&t.e_bulletFlag)===t.e_bulletFlag,e.awake=(this.m_flags&t.e_awakeFlag)===t.e_awakeFlag,e.linearDamping=this.m_linearDamping,e.linearVelocity.SetV(this.GetLinearVelocity()),e.position=this.GetPosition(),e.userData=this.GetUserData(),e}},{key:"ApplyForce",value:function(e,i){this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=e.x,this.m_force.y+=e.y,this.m_torque+=(i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x)}},{key:"ApplyTorque",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_torque+=e)}},{key:"ApplyImpulse",value:function(e,i){this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y,this.m_angularVelocity+=this.m_invI*((i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x))}},{key:"Split",value:function(t){if(this.m_world&&!this.m_world.IsLocked()){var e=this.GetLinearVelocity().Copy(),i=this.GetAngularVelocity(),s=this.GetWorldCenter(),a=this.m_world.CreateBody(this.GetDefinition());if(a){for(var n,o=this.m_fixtureList;o;)if(t(o)){var r=o.m_next;n?n.m_next=r:this.m_fixtureList=r,this.m_fixtureCount--,o.m_next=a.m_fixtureList,a.m_fixtureList=o,a.m_fixtureCount++,o.m_body=a,o=r}else n=o,o=o.m_next;this.ResetMassData(),a.ResetMassData();var l=this.GetWorldCenter(),m=a.GetWorldCenter(),_=yj(e,xj(i,sb(l,s))),h=yj(e,xj(i,sb(m,s)));return this.SetLinearVelocity(_),a.SetLinearVelocity(h),this.SetAngularVelocity(i),a.SetAngularVelocity(i),this.SynchronizeFixtures(),a.SynchronizeFixtures(),a}}}},{key:"Merge",value:function(t){for(var e=t,i=t.m_fixtureList;i;){var s=i.m_next;t.m_fixtureCount--,i.m_next=this.m_fixtureList,this.m_fixtureList=i,this.m_fixtureCount++,i.m_body=e,i=s}this.m_fixtureCount=0,this.ResetMassData(),this.SynchronizeFixtures()}},{key:"GetMass",value:function(){return this.m_mass}},{key:"GetInertia",value:function(){return this.m_I}},{key:"GetMassData",value:function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)}},{key:"SetMassData",value:function(e){if(this.m_world&&!this.m_world.IsLocked()&&(xb(!1===this.m_world.IsLocked()),this.m_type===t.b2_dynamicBody)){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&t.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(wb(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}}},{key:"ResetMassData",value:function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!==t.b2_staticBody&&this.m_type!==t.b2_kinematicBody){for(var e=ab.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!==i.m_density){var s=i.GetMassData();this.m_mass+=s.mass,e.x+=s.center.x*s.mass,e.y+=s.center.y*s.mass,this.m_I+=s.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&t.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,xb(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var a=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(wb(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-a.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-a.x)}}},{key:"GetWorldPoint",value:function(t){var e=this.m_xf.R,i=new ab(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i}},{key:"GetWorldVector",value:function(t){return ff(this.m_xf.R,t)}},{key:"GetLocalPoint",value:function(t){return NH(this.m_xf,t)}},{key:"GetLocalVector",value:function(t){return Jd(this.m_xf.R,t)}},{key:"GetLinearVelocityFromWorldPoint",value:function(t){return new ab(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))}},{key:"GetLinearVelocityFromLocalPoint",value:function(t){var e=this.m_xf.R,i=new ab(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new ab(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))}},{key:"GetLinearDamping",value:function(){return this.m_linearDamping}},{key:"SetLinearDamping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_linearDamping=t}},{key:"GetAngularDamping",value:function(){return this.m_angularDamping}},{key:"SetAngularDamping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_angularDamping=t}},{key:"SetType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.m_type!==e){this.m_type=e,this.ResetMassData(),this.m_type===t.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var i=this.m_contactList;i;i=i.next)i.contact.FlagForFiltering()}}},{key:"GetType",value:function(){return this.m_type}},{key:"SetBullet",value:function(e){e?this.m_flags|=t.e_bulletFlag:this.m_flags&=~t.e_bulletFlag}},{key:"IsBullet",value:function(){return(this.m_flags&t.e_bulletFlag)===t.e_bulletFlag}},{key:"SetSleepingAllowed",value:function(e){e?this.m_flags|=t.e_allowSleepFlag:(this.m_flags&=~t.e_allowSleepFlag,this.SetAwake(!0))}},{key:"SetAwake",value:function(e){e?(this.m_flags|=t.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~t.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)}},{key:"IsAwake",value:function(){return(this.m_flags&t.e_awakeFlag)===t.e_awakeFlag}},{key:"SetFixedRotation",value:function(e){e?this.m_flags|=t.e_fixedRotationFlag:this.m_flags&=~t.e_fixedRotationFlag,this.ResetMassData()}},{key:"IsFixedRotation",value:function(){return(this.m_flags&t.e_fixedRotationFlag)===t.e_fixedRotationFlag}},{key:"SetActive",value:function(e){if(e!==this.IsActive()&&this.m_world&&!this.m_world.IsLocked()){var i=this.m_world.m_contactManager.m_broadPhase;if(e){this.m_flags|=t.e_activeFlag;for(var s=this.m_fixtureList;s;s=s.m_next)s.CreateProxy(i,this.m_xf)}else{this.m_flags&=~t.e_activeFlag;for(var a=this.m_fixtureList;a;a=a.m_next)a.DestroyProxy(i);for(var n=this.m_contactList;n;){var o=n;n=n.next,this.m_world.m_contactManager.Destroy(o.contact)}this.m_contactList=null}}}},{key:"IsActive",value:function(){return(this.m_flags&t.e_activeFlag)===t.e_activeFlag}},{key:"IsSleepingAllowed",value:function(){return(this.m_flags&t.e_allowSleepFlag)===t.e_allowSleepFlag}},{key:"GetFixtureList",value:function(){return this.m_fixtureList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetControllerList",value:function(){return this.m_controllerList}},{key:"GetContactList",value:function(){return this.m_contactList}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(t){this.m_userData=t}},{key:"GetWorld",value:function(){return this.m_world}},{key:"SynchronizeFixtures",value:function(){if(this.m_world&&!this.m_world.IsLocked()){var e=t.s_xf1;e.R.Set(this.m_sweep.a0);var i=e.R,s=this.m_sweep.localCenter;e.position.x=this.m_sweep.c0.x-(i.col1.x*s.x+i.col2.x*s.y),e.position.y=this.m_sweep.c0.y-(i.col1.y*s.x+i.col2.y*s.y);for(var a=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(a,e,this.m_xf)}}},{key:"SynchronizeTransform",value:function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)}},{key:"ShouldCollide",value:function(e){if(this.m_type!==t.b2_dynamicBody&&e.m_type!==t.b2_dynamicBody)return!1;for(var i=this.m_jointList;i;i=i.next)if(i.other===e&&!1===i.joint.m_collideConnected)return!1;return!0}},{key:"Advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()}}]),t}();eb.s_xf1=new xd,eb.e_islandFlag=1,eb.e_awakeFlag=2,eb.e_allowSleepFlag=4,eb.e_bulletFlag=8,eb.e_fixedRotationFlag=16,eb.e_activeFlag=32,eb.b2_staticBody=0,eb.b2_kinematicBody=1,eb.b2_dynamicBody=2;var wm=function t(){SH(this,t),this.position=new ab,this.linearVelocity=new ab,this.angle=0,this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=eb.b2_staticBody,this.active=!0,this.inertiaScale=1};var Gj=30;function WL(e){var r=e.canvas,t=new Ub(new ab(0,30),!1),$=new Wx;$.density=1,$.friction=.5,$.restitution=.2;var o=new wm;o.type=eb.b2_staticBody,$.shape=new hf;var i=r.width/Gj,s=r.height/Gj;$.shape.SetAsBox(i/2,1),o.position.Set(i/2,-1),t.CreateBody(o).CreateFixture($),o.position.Set(i/2,s+1),t.CreateBody(o).CreateFixture($),$.shape.SetAsBox(1,s/2),o.position.Set(-1,s/2),t.CreateBody(o).CreateFixture($),o.position.Set(i+1,s/2),t.CreateBody(o).CreateFixture($),o.type=eb.b2_dynamicBody,$.shape=new Tf(i/8),o.position.Set(i/2,s/2),t.CreateBody(o).CreateFixture($);var a=new Ob;a.SetDrawScale(Gj),a.SetSprite(e),a.SetFillAlpha(.5),a.SetLineThickness(1),a.SetFlags(Ob.e_shapeBit|Ob.e_jointBit),t.SetDebugDraw(a);return requestAnimationFrame(function e(r){requestAnimationFrame(e),t.Step(1/60,5,5),t.DrawDebugData(),t.ClearForces()}),t}var xm={},XL=(Ad(),Vb).Buffer;function Xx(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,r=new Uint8Array(e);return e>0&&crypto.getRandomValues(r),XL.from(r.buffer)}xm.default=Xx;var YL=document.querySelector("ul"),ym=document.querySelector("pre"),ZL=document.querySelector("canvas"),Uf=function(r){ym.textContent+=r,ym.scrollTo({top:ym.scrollHeight,behavior:"smooth"})},Yx=location,$L=Yx.origin,_L=Yx.pathname,aM="".concat($L).concat(_L).replace("/host","/player"),bM=Xx(),zm=bM.toString("hex").slice(0,7);location.hash="#".concat(zm);var cM={color:{light:"#ffffff66"}};VD(ZL,"".concat(aM,"#").concat(zm),cM,function(r){r&&Uf("qrcode error:\n".concat(r.message))});var jf={};var Zx=function(r){requestAnimationFrame(Zx),Object.entries(jf).forEach(function(r){var e=Dm(r,2),t=e[0],a=e[1].orientation,n=document.getElementById("connection-".concat(t));if(n){var o=n.querySelector("p");if(o){var $=vw(a);$[1]=-$[1],$[4]=-$[4];var c="matrix3d(".concat($.join(","),")");n.style.transform=c}}})};requestAnimationFrame(Zx);var $x=function(r){jf[r]&&(jf[r].host.destroy(),delete jf[r]);var e=document.getElementById("connection-".concat(r));e&&e.remove()};sw.signInAnonymously().then(function(r){if(r&&r.user){var e=r.user.uid,t=tw.ref("/rooms/".concat(zm)),a=t.child("/connections").ref;t.onDisconnect().set(null);a.on("child_added",function(r){if(r&&r.key){var $Jlv9$$interop$default=Am(dq);var t=r.key,a=r.child("offer").ref,n=r.child("answer").ref,o=new $Jlv9$$interop$default.d({initiator:!1,trickle:!1});jf[t]={orientation:[0,0,0,1],host:o};var $=document.createElement("li");$.id="connection-".concat(t);var c,i=document.createElement("canvas");$.append(i);var d=function(r){r?Uf("error:\n".concat(r.message,"\n\n")):jf[t]&&Uf("connection: ".concat(t," - disconnected\n")),$x(t)};o.on("signal",function(r){"answer"===r.type&&n.set(Cm(Cm({},r),{},{uid:e}))}).on("connect",function(){Uf("connection: ".concat(t," - connected\n")),YL.appendChild($);var r=new Date().toLocaleTimeString();o.send(JSON.stringify({host:t,time:r}))}).on("error",d).on("close",d).on("end",d).on("data",function(r){var e=JSON.parse(r),a=e.time,n=e.player,d=e.width,y=e.height,l=e.orientation;if(a){var v=new Date().toLocaleTimeString();Uf("\nplayer: ".concat(n," - added\nplayer time: ").concat(a,"\nhost time: ").concat(v,"\n\n")),$.style.width=i.style.width="".concat(d/2,"px"),$.style.height=i.style.height="".concat(y/2,"px"),i.width=d/2,i.height=y/2,c=WL(i.getContext("2d"));var s=document.createElement("p");$.append(s),s.innerText=n;var u=360*Math.random(),x=(u+120*(1+Math.round(Math.random())))%360,G=Math.round(Math.random())?"linear-gradient(hsl(".concat(u,", 80%, 50%), hsl(").concat(x,", 80%, 50%))"):"radial-gradient(circle at center, hsl(".concat(u,", 80%, 50%), hsl(").concat(x,", 80%, 50%))");return $.style.background=G,void o.send(JSON.stringify({bkgd:G}))}var p=Dm(vw(l),2),m=p[0],f=p[1],h=new ab(-f,m);h.Normalize(),h.Multiply(Gj),c.SetGravity(h),jf[t].orientation=l}),a.on("value",function(r){r&&r.val()&&o.signal(r.val())})}}),a.on("child_removed",function(r){if(r&&r.key){var e=r.key;$x(e),Uf("connection: ".concat(e," - removed\n"))}})}});bj.__esModule=true;xm.__esModule=true;return{"Jlv9":dq,"d2yc":bj,"ZUoI":lv,"Uuoh":{},"ela3":xm,"Gdyx":{}};});