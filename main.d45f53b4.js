parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function wy(a){return a&&a.__esModule?{d:a.default}:{d:a}}var Vb=this;var a=require("buffer").Buffer;function bp(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,a)}return t}function cp(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?bp(Object(t),!0).forEach(function(e){xy(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):bp(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function xy(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function dp(r,e){return By(r)||Ay(r,e)||zy(r,e)||yy()}function yy(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function zy(r,e){if(r){if("string"==typeof r)return ep(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ep(r,e):void 0}}function ep(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=r[t];return a}function Ay(r,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var t=[],a=!0,n=!1,o=void 0;try{for(var $,c=r[Symbol.iterator]();!(a=($=c.next()).done)&&(t.push($.value),!e||t.length!==e);a=!0);}catch(i){n=!0,o=i}finally{try{a||null==c.return||c.return()}finally{if(n)throw o}}return t}}function By(r){if(Array.isArray(r))return r}var sg,tg,Ud,Db,cj,Vd,Rk,fp,Cy=false;function Sk(){throw new Error("setTimeout has not been defined")}function Tk(){throw new Error("clearTimeout has not been defined")}function gp($){if(sg===setTimeout)return setTimeout($,0);if((sg===Sk||!sg)&&setTimeout)return sg=setTimeout,setTimeout($,0);try{return sg($,0)}catch(e){try{return sg.call(null,$,0)}catch(e){return sg.call(this,$,0)}}}function Dy($){if(tg===clearTimeout)return clearTimeout($);if((tg===Tk||!tg)&&clearTimeout)return tg=clearTimeout,clearTimeout($);try{return tg($)}catch(e){try{return tg.call(null,$)}catch(e){return tg.call(this,$)}}}function Ey(){Rk&&cj&&(Rk=!1,cj.length?Vd=cj.concat(Vd):fp=-1,Vd.length&&hp())}function hp(){if(!Rk){var $=gp(Ey);Rk=!0;for(var e=Vd.length;e;){for(cj=Vd,Vd=[];++fp<e;)cj&&cj[fp].run();fp=-1,e=Vd.length}cj=null,Rk=!1,Dy($)}}function ip($,e){this.fun=$,this.array=e}function rd(){}function Wd(){if(Cy)return;Cy=true;Ud={};Db=Ud={};!function(){try{sg="function"==typeof setTimeout?setTimeout:Sk}catch($){sg=Sk}try{tg="function"==typeof clearTimeout?clearTimeout:Tk}catch($){tg=Tk}}();Vd=[];Rk=!1;fp=-1;Db.nextTick=function($){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Vd.push(new ip($,e)),1!==Vd.length||Rk||gp(hp)},ip.prototype.run=function(){this.fun.apply(null,this.array)},Db.title="browser",Db.env={},Db.argv=[],Db.version="",Db.versions={},Db.on=rd,Db.addListener=rd,Db.once=rd,Db.off=rd,Db.removeListener=rd,Db.removeAllListeners=rd,Db.emit=rd,Db.prependListener=rd,Db.prependOnceListener=rd,Db.listeners=function($){return[]},Db.binding=function($){throw new Error("process.binding is not supported")},Db.cwd=function(){return"/"},Db.chdir=function($){throw new Error("process.chdir is not supported")},Db.umask=function(){return 0}}var bd={},jp=(Wd(),Ud),Fy=Zy;bd.formatArgs=Fy;var Gy=_y;bd.save=Gy;var Hy=az;bd.load=Hy;var Iy=Yy;bd.useColors=Iy;var Jy,ug,vg,wg,Xd,Ky,Ly,My=false;function Ny($){if(!(($=String($)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec($);if(r){var a=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*Ly;case"weeks":case"week":case"w":return a*Ky;case"days":case"day":case"d":return a*Xd;case"hours":case"hour":case"hrs":case"hr":case"h":return a*wg;case"minutes":case"minute":case"mins":case"min":case"m":return a*vg;case"seconds":case"second":case"secs":case"sec":case"s":return a*ug;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return;}}}}function Oy($){var r=Math.abs($);return r>=Xd?Math.round($/Xd)+"d":r>=wg?Math.round($/wg)+"h":r>=vg?Math.round($/vg)+"m":r>=ug?Math.round($/ug)+"s":$+"ms"}function Py($){var r=Math.abs($);return r>=Xd?Oj($,r,Xd,"day"):r>=wg?Oj($,r,wg,"hour"):r>=vg?Oj($,r,vg,"minute"):r>=ug?Oj($,r,ug,"second"):$+" ms"}function Oj($,r,a,s){var e=r>=1.5*a;return Math.round($/a)+" "+s+(e?"s":"")}function Qy(){if(My)return;My=true;Jy={};ug=1e3;vg=60*ug;wg=60*vg;Xd=24*wg;Ky=7*Xd;Ly=365.25*Xd;Jy=function($,r){r=r||{};var a=typeof $;if("string"===a&&$.length>0)return Ny($);if("number"===a&&isFinite($))return r.long?Py($):Oy($);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify($))}}var Ry={};function kp(r){return Vy(r)||Uy(r)||Ty(r)||Sy()}function Sy(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ty(r,e){if(r){if("string"==typeof r)return Uk(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Uk(r,e):void 0}}function Uy(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function Vy(r){if(Array.isArray(r))return Uk(r)}function Uk(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Wy(r){function e(r){var a;function o(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];if(o.enabled){var s=o,i=Number(new Date),u=i-(a||i);s.diff=u,s.prev=a,s.curr=i,a=i,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var l=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;l++;var a=e.formatters[n];if("function"==typeof a){var o=t[l];r=a.call(s,o),t.splice(l,1),l--}return r}),e.formatArgs.call(s,t),(s.log||e.log).apply(s,t)}}return o.namespace=r,o.enabled=e.enabled(r),o.useColors=e.useColors(),o.color=e.selectColor(r),o.destroy=t,o.extend=n,"function"==typeof e.init&&e.init(o),e.instances.push(o),o}function t(){var r=e.instances.indexOf(this);return-1!==r&&(e.instances.splice(r,1),!0)}function n(r,t){var n=e(this.namespace+(void 0===t?":":t)+r);return n.log=this.log,n}function a(r){return r.toString().substring(2,r.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(r){if(r instanceof Error)return r.stack||r.message;return r},e.disable=function(){var r=[].concat(kp(e.names.map(a)),kp(e.skips.map(a).map(function(r){return"-"+r}))).join(",");return e.enable(""),r},e.enable=function(r){var t;e.save(r),e.names=[],e.skips=[];var n=("string"==typeof r?r:"").split(/[\s,]+/),a=n.length;for(t=0;t<a;t++)n[t]&&("-"===(r=n[t].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+r.substr(1)+"$")):e.names.push(new RegExp("^"+r+"$")));for(t=0;t<e.instances.length;t++){var o=e.instances[t];o.enabled=e.enabled(o.namespace)}},e.enabled=function(r){if("*"===r[r.length-1])return!0;var t,n;for(t=0,n=e.skips.length;t<n;t++)if(e.skips[t].test(r))return!1;for(t=0,n=e.names.length;t<n;t++)if(e.names[t].test(r))return!0;return!1},e.humanize=(Qy(),Jy),Object.keys(r).forEach(function(t){e[t]=r[t]}),e.instances=[],e.names=[],e.skips=[],e.formatters={},e.selectColor=function(r){for(var t=0,n=0;n<r.length;n++)t=(t<<5)-t+r.charCodeAt(n),t|=0;return e.colors[Math.abs(t)%e.colors.length]},e.enable(e.load()),e}Ry=Wy;var Pj=bz();bd.storage=Pj;var Xy=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Yy(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function Zy(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+bd.humanize(this.diff),this.useColors){var o="color: "+this.color;e.splice(1,0,o,"color: inherit");var r=0,t=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(t=r))}),e.splice(t,0,o)}}bd.colors=Xy;var $y=console.debug||console.log||function(){};function _y(e){try{e?Pj.setItem("debug",e):Pj.removeItem("debug")}catch(o){}}function az(){var e;try{e=Pj.getItem("debug")}catch(o){}return!e&&void 0!==jp&&"env"in jp&&(e=void 0),e}function bz(){try{return localStorage}catch(e){}}bd.log=$y,bd=Ry(bd);var{formatters:cz}=bd;cz.j=function(e){try{return JSON.stringify(e)}catch(o){return"[UnexpectedJSONParseError]: "+o.message}};var lp={};lp=function(){if("undefined"==typeof window)return null;var n={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return n.RTCPeerConnection?n:null};var Qj,dz,ez,fz,gz=false;function mp($){var r=$.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=$.indexOf("=");return-1===p&&(p=r),[p,p===r?0:4-p%4]}function hz($){var r=mp($),p=r[0],o=r[1];return 3*(p+o)/4-o}function iz($,r,p){return 3*(r+p)/4-p}function jz($){var r,p,o=mp($),e=o[0],y=o[1],h=new $yh9p$var$Arr(iz($,e,y)),a=0,t=y>0?e-4:e;for(p=0;p<t;p+=4)r=$yh9p$var$revLookup[$.charCodeAt(p)]<<18|$yh9p$var$revLookup[$.charCodeAt(p+1)]<<12|$yh9p$var$revLookup[$.charCodeAt(p+2)]<<6|$yh9p$var$revLookup[$.charCodeAt(p+3)],h[a++]=r>>16&255,h[a++]=r>>8&255,h[a++]=255&r;return 2===y&&(r=$yh9p$var$revLookup[$.charCodeAt(p)]<<2|$yh9p$var$revLookup[$.charCodeAt(p+1)]>>4,h[a++]=255&r),1===y&&(r=$yh9p$var$revLookup[$.charCodeAt(p)]<<10|$yh9p$var$revLookup[$.charCodeAt(p+1)]<<4|$yh9p$var$revLookup[$.charCodeAt(p+2)]>>2,h[a++]=r>>8&255,h[a++]=255&r),h}function kz($){return $yh9p$var$lookup[$>>18&63]+$yh9p$var$lookup[$>>12&63]+$yh9p$var$lookup[$>>6&63]+$yh9p$var$lookup[63&$]}function lz($,r,p){for(var o,e=[],y=r;y<p;y+=3)o=($[y]<<16&16711680)+($[y+1]<<8&65280)+(255&$[y+2]),e.push(kz(o));return e.join("")}function mz($){for(var r,p=$.length,o=p%3,e=[],y=0,h=p-o;y<h;y+=16383)e.push(lz($,y,y+16383>h?h:y+16383));return 1===o?(r=$[p-1],e.push($yh9p$var$lookup[r>>2]+$yh9p$var$lookup[r<<4&63]+"==")):2===o&&(r=($[p-2]<<8)+$[p-1],e.push($yh9p$var$lookup[r>>10]+$yh9p$var$lookup[r>>4&63]+$yh9p$var$lookup[r<<2&63]+"=")),e.join("")}function nz(){if(gz)return;gz=true;Qj={};dz=hz;Qj.byteLength=dz;ez=jz;Qj.toByteArray=ez;fz=mz;Qj.fromByteArray=fz;for(var $yh9p$var$lookup=[],$yh9p$var$revLookup=[],$yh9p$var$Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,$yh9p$var$code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$yh9p$var$i=0,$yh9p$var$len=$yh9p$var$code.length;$yh9p$var$i<$yh9p$var$len;++$yh9p$var$i)$yh9p$var$lookup[$yh9p$var$i]=$yh9p$var$code[$yh9p$var$i],$yh9p$var$revLookup[$yh9p$var$code.charCodeAt($yh9p$var$i)]=$yh9p$var$i;$yh9p$var$revLookup["-".charCodeAt(0)]=62,$yh9p$var$revLookup["_".charCodeAt(0)]=63}var Vk,oz,pz,qz=false;function rz(){if(qz)return;qz=true;Vk={};oz=function(t,r,o,a,$){var e,p,J=8*$-a-1,N=(1<<J)-1,h=N>>1,M=-7,w=o?$-1:0,f=o?-1:1,i=t[r+w];for(w+=f,e=i&(1<<-M)-1,i>>=-M,M+=J;M>0;e=256*e+t[r+w],w+=f,M-=8);for(p=e&(1<<-M)-1,e>>=-M,M+=a;M>0;p=256*p+t[r+w],w+=f,M-=8);if(0===e)e=1-h;else{if(e===N)return p?NaN:1/0*(i?-1:1);p+=Math.pow(2,a),e-=h}return(i?-1:1)*p*Math.pow(2,e-a)};Vk.read=oz;pz=function(t,r,o,a,$,e){var p,J,N,h=8*e-$-1,M=(1<<h)-1,w=M>>1,f=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,i=a?0:e-1,g=a?1:-1,s=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(J=isNaN(r)?1:0,p=M):(p=Math.floor(Math.log(r)/Math.LN2),r*(N=Math.pow(2,-p))<1&&(p--,N*=2),(r+=p+w>=1?f/N:f*Math.pow(2,1-w))*N>=2&&(p++,N/=2),p+w>=M?(J=0,p=M):p+w>=1?(J=(r*N-1)*Math.pow(2,$),p+=w):(J=r*Math.pow(2,w-1)*Math.pow(2,$),p=0));$>=8;t[o+i]=255&J,i+=g,J/=256,$-=8);for(p=p<<$|J,h+=$;h>0;t[o+i]=255&p,i+=g,p/=256,h-=8);t[o+i-g]|=128*s};Vk.write=pz}var sz,tz,uz=false;function vz(){if(uz)return;uz=true;sz={};tz={}.toString;sz=Array.isArray||function(r){return"[object Array]"==tz.call(r)}}var cd,Wk,xg,np,wz,xz,op,yz,pp,zz,Az=false;function Bz(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(r){return!1}}function Rj(){return bb.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function sd(e,r){if(Rj()<r)throw new RangeError("Invalid typed array length");return bb.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(r)).__proto__=bb.prototype:(null===e&&(e=new bb(r)),e.length=r),e}function bb(e,r,t){if(!(bb.TYPED_ARRAY_SUPPORT||this instanceof bb))return new bb(e,r,t);if("number"==typeof e){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return Xk(this,e)}return qp(this,e,r,t)}function qp(e,r,t,$){if("number"==typeof r)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?Ez(e,r,t,$):"string"==typeof r?Dz(e,r,t):Fz(e,r)}function rp(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be a number");if(e<0)throw new RangeError("\"size\" argument must not be negative")}function Cz(e,r,t,$){return rp(r),r<=0?sd(e,r):void 0!==t?"string"==typeof $?sd(e,r).fill(t,$):sd(e,r).fill(t):sd(e,r)}function Xk(e,r){if(rp(r),e=sd(e,r<0?0:0|Zk(r)),!bb.TYPED_ARRAY_SUPPORT)for(var t=0;t<r;++t)e[t]=0;return e}function Dz(e,r,t){if("string"==typeof t&&""!==t||(t="utf8"),!bb.isEncoding(t))throw new TypeError("\"encoding\" must be a valid string encoding");var $=0|sp(r,t),n=(e=sd(e,$)).write(r,t);return n!==$&&(e=e.slice(0,n)),e}function Yk(e,r){var t=r.length<0?0:0|Zk(r.length);e=sd(e,t);for(var $=0;$<t;$+=1)e[$]=255&r[$];return e}function Ez(e,r,t,$){if(r.byteLength,t<0||r.byteLength<t)throw new RangeError("'offset' is out of bounds");if(r.byteLength<t+($||0))throw new RangeError("'length' is out of bounds");return r=void 0===t&&void 0===$?new Uint8Array(r):void 0===$?new Uint8Array(r,t):new Uint8Array(r,t,$),bb.TYPED_ARRAY_SUPPORT?(e=r).__proto__=bb.prototype:e=Yk(e,r),e}function Fz(e,r){if(bb.isBuffer(r)){var t=0|Zk(r.length);return 0===(e=sd(e,t)).length?e:(r.copy(e,0,0,t),e)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||Yz(r.length)?sd(e,0):Yk(e,r);if("Buffer"===r.type&&np(r.data))return Yk(e,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Zk(e){if(e>=Rj())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Rj().toString(16)+" bytes");return 0|e}function Gz(e){return+e!=e&&(e=0),bb.alloc(+e)}function sp(e,r){if(bb.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var t=e.length;if(0===t)return 0;for(var $=!1;;)switch(r){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":case void 0:return Uj(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t;case"hex":return t>>>1;case"base64":return Ap(e).length;default:if($)return Uj(e).length;r=(""+r).toLowerCase(),$=!0;}}function Hz(e,r,t){var $=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===t||t>this.length)&&(t=this.length),t<=0)return"";if((t>>>=0)<=(r>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Rz(this,r,t);case"utf8":case"utf-8":return wp(this,r,t);case"ascii":return Pz(this,r,t);case"latin1":case"binary":return Qz(this,r,t);case"base64":return Nz(this,r,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Sz(this,r,t);default:if($)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),$=!0;}}function Yd(e,r,t){var $=e[r];e[r]=e[t],e[t]=$}function tp(e,r,t,$,n){if(0===e.length)return-1;if("string"==typeof t?($=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,isNaN(t)&&(t=n?0:e.length-1),t<0&&(t=e.length+t),t>=e.length){if(n)return-1;t=e.length-1}else if(t<0){if(!n)return-1;t=0}if("string"==typeof r&&(r=bb.from(r,$)),bb.isBuffer(r))return 0===r.length?-1:up(e,r,t,$,n);if("number"==typeof r)return r&=255,bb.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,r,t):Uint8Array.prototype.lastIndexOf.call(e,r,t):up(e,[r],t,$,n);throw new TypeError("val must be string, number or Buffer")}function up(e,r,t,$,n){var f,a=1,i=e.length,o=r.length;if(void 0!==$&&("ucs2"===($=String($).toLowerCase())||"ucs-2"===$||"utf16le"===$||"utf-16le"===$)){if(e.length<2||r.length<2)return-1;a=2,i/=2,o/=2,t/=2}function u(e,r){return 1===a?e[r]:e.readUInt16BE(r*a)}if(n){var p=-1;for(f=t;f<i;f++)if(u(e,f)===u(r,-1===p?0:f-p)){if(-1===p&&(p=f),f-p+1===o)return p*a}else-1!==p&&(f-=f-p),p=-1}else for(t+o>i&&(t=i-o),f=t;f>=0;f--){for(var s=!0,h=0;h<o;h++)if(u(e,f+h)!==u(r,h)){s=!1;break}if(s)return f}return-1}function Iz(e,r,t,$){t=Number(t)||0;var n=e.length-t;$?($=Number($))>n&&($=n):$=n;var f=r.length;if(f%2!=0)throw new TypeError("Invalid hex string");$>f/2&&($=f/2);for(var a=0;a<$;++a){var i=parseInt(r.substr(2*a,2),16);if(isNaN(i))return a;e[t+a]=i}return a}function Jz(e,r,t,$){return Vj(Uj(r,e.length-t),e,t,$)}function vp(e,r,t,$){return Vj(Wz(r),e,t,$)}function Kz(e,r,t,$){return vp(e,r,t,$)}function Lz(e,r,t,$){return Vj(Ap(r),e,t,$)}function Mz(e,r,t,$){return Vj(Xz(r,e.length-t),e,t,$)}function Nz(e,r,t){return 0===r&&t===e.length?Wk.fromByteArray(e):Wk.fromByteArray(e.slice(r,t))}function wp(e,r,t){t=Math.min(e.length,t);for(var $=[],n=r;n<t;){var f,a,i,o,u=e[n],p=null,s=u>239?4:u>223?3:u>191?2:1;if(n+s<=t)switch(s){case 1:u<128&&(p=u);break;case 2:128==(192&(f=e[n+1]))&&(o=(31&u)<<6|63&f)>127&&(p=o);break;case 3:f=e[n+1],a=e[n+2],128==(192&f)&&128==(192&a)&&(o=(15&u)<<12|(63&f)<<6|63&a)>2047&&(o<55296||o>57343)&&(p=o);break;case 4:f=e[n+1],a=e[n+2],i=e[n+3],128==(192&f)&&128==(192&a)&&128==(192&i)&&(o=(15&u)<<18|(63&f)<<12|(63&a)<<6|63&i)>65535&&o<1114112&&(p=o);}null===p?(p=65533,s=1):p>65535&&(p-=65536,$.push(p>>>10&1023|55296),p=56320|1023&p),$.push(p),n+=s}return Oz($)}function Oz(e){var r=e.length;if(r<=pp)return String.fromCharCode.apply(String,e);for(var t="",$=0;$<r;)t+=String.fromCharCode.apply(String,e.slice($,$+=pp));return t}function Pz(e,r,t){var $="";t=Math.min(e.length,t);for(var n=r;n<t;++n)$+=String.fromCharCode(127&e[n]);return $}function Qz(e,r,t){var $="";t=Math.min(e.length,t);for(var n=r;n<t;++n)$+=String.fromCharCode(e[n]);return $}function Rz(e,r,t){var $=e.length;(!r||r<0)&&(r=0),(!t||t<0||t>$)&&(t=$);for(var n="",f=r;f<t;++f)n+=Vz(e[f]);return n}function Sz(e,r,t){for(var $=e.slice(r,t),n="",f=0;f<$.length;f+=2)n+=String.fromCharCode($[f]+256*$[f+1]);return n}function Hb(e,r,t){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+r>t)throw new RangeError("Trying to access beyond buffer length")}function Qb(e,r,t,$,n,f){if(!bb.isBuffer(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(r>n||r<f)throw new RangeError("\"value\" argument is out of bounds");if(t+$>e.length)throw new RangeError("Index out of range")}function Sj(e,r,t,$){r<0&&(r=65535+r+1);for(var n=0,f=Math.min(e.length-t,2);n<f;++n)e[t+n]=(r&255<<8*($?n:1-n))>>>8*($?n:1-n)}function Tj(e,r,t,$){r<0&&(r=4294967295+r+1);for(var n=0,f=Math.min(e.length-t,4);n<f;++n)e[t+n]=r>>>8*($?n:3-n)&255}function xp(e,r,t,$,n,f){if(t+$>e.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function yp(e,r,t,$,n){return n||xp(e,r,t,4,3.4028234663852886e38,-3.4028234663852886e38),xg.write(e,r,t,$,23,4),t+4}function zp(e,r,t,$,n){return n||xp(e,r,t,8,1.7976931348623157e308,-1.7976931348623157e308),xg.write(e,r,t,$,52,8),t+8}function Tz(e){if((e=Uz(e).replace(zz,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function Uz(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function Vz(e){return e<16?"0"+e.toString(16):e.toString(16)}function Uj(e,r){var t;r=r||1/0;for(var $=e.length,n=null,f=[],a=0;a<$;++a){if((t=e.charCodeAt(a))>55295&&t<57344){if(!n){if(t>56319){(r-=3)>-1&&f.push(239,191,189);continue}if(a+1===$){(r-=3)>-1&&f.push(239,191,189);continue}n=t;continue}if(t<56320){(r-=3)>-1&&f.push(239,191,189),n=t;continue}t=65536+(n-55296<<10|t-56320)}else n&&(r-=3)>-1&&f.push(239,191,189);if(n=null,t<128){if((r-=1)<0)break;f.push(t)}else if(t<2048){if((r-=2)<0)break;f.push(t>>6|192,63&t|128)}else if(t<65536){if((r-=3)<0)break;f.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;f.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return f}function Wz(e){for(var r=[],t=0;t<e.length;++t)r.push(255&e.charCodeAt(t));return r}function Xz(e,r){for(var t,$,n,f=[],a=0;a<e.length&&!((r-=2)<0);++a)$=(t=e.charCodeAt(a))>>8,n=t%256,f.push(n),f.push($);return f}function Ap(e){return Wk.toByteArray(Tz(e))}function Vj(e,r,t,$){for(var n=0;n<$&&!(n+t>=r.length||n>=e.length);++n)r[n+t]=e[n];return n}function Yz(e){return e!=e}function Zd(){if(Az)return;Az=true;cd={};Wk=(nz(),Qj);xg=(rz(),Vk);np=(vz(),sz);wz=bb;cd.Buffer=wz;xz=Gz;cd.SlowBuffer=xz;op=50;cd.INSPECT_MAX_BYTES=op,bb.TYPED_ARRAY_SUPPORT=void 0!==Vb.TYPED_ARRAY_SUPPORT?Vb.TYPED_ARRAY_SUPPORT:Bz();yz=Rj();cd.kMaxLength=yz,bb.poolSize=8192,bb._augment=function(e){return e.__proto__=bb.prototype,e},bb.from=function(e,r,t){return qp(null,e,r,t)},bb.TYPED_ARRAY_SUPPORT&&(bb.prototype.__proto__=Uint8Array.prototype,bb.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&bb[Symbol.species]===bb&&Object.defineProperty(bb,Symbol.species,{value:null,configurable:!0})),bb.alloc=function(e,r,t){return Cz(null,e,r,t)},bb.allocUnsafe=function(e){return Xk(null,e)},bb.allocUnsafeSlow=function(e){return Xk(null,e)},bb.isBuffer=function(e){return!(null==e||!e._isBuffer)},bb.compare=function(e,r){if(!bb.isBuffer(e)||!bb.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var t=e.length,$=r.length,n=0,f=Math.min(t,$);n<f;++n)if(e[n]!==r[n]){t=e[n],$=r[n];break}return t<$?-1:$<t?1:0},bb.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},bb.concat=function(e,r){if(!np(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return bb.alloc(0);var t;if(void 0===r)for(r=0,t=0;t<e.length;++t)r+=e[t].length;var $=bb.allocUnsafe(r),n=0;for(t=0;t<e.length;++t){var f=e[t];if(!bb.isBuffer(f))throw new TypeError("\"list\" argument must be an Array of Buffers");f.copy($,n),n+=f.length}return $},bb.byteLength=sp,bb.prototype._isBuffer=!0,bb.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)Yd(this,r,r+1);return this},bb.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)Yd(this,r,r+3),Yd(this,r+1,r+2);return this},bb.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)Yd(this,r,r+7),Yd(this,r+1,r+6),Yd(this,r+2,r+5),Yd(this,r+3,r+4);return this},bb.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?wp(this,0,e):Hz.apply(this,arguments)},bb.prototype.equals=function(e){if(!bb.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===bb.compare(this,e)},bb.prototype.inspect=function(){var e="",r=op;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},bb.prototype.compare=function(e,r,t,$,n){if(!bb.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===t&&(t=e?e.length:0),void 0===$&&($=0),void 0===n&&(n=this.length),r<0||t>e.length||$<0||n>this.length)throw new RangeError("out of range index");if($>=n&&r>=t)return 0;if($>=n)return-1;if(r>=t)return 1;if(this===e)return 0;for(var f=(n>>>=0)-($>>>=0),a=(t>>>=0)-(r>>>=0),i=Math.min(f,a),o=this.slice($,n),u=e.slice(r,t),p=0;p<i;++p)if(o[p]!==u[p]){f=o[p],a=u[p];break}return f<a?-1:a<f?1:0},bb.prototype.includes=function(e,r,t){return-1!==this.indexOf(e,r,t)},bb.prototype.indexOf=function(e,r,t){return tp(this,e,r,t,!0)},bb.prototype.lastIndexOf=function(e,r,t){return tp(this,e,r,t,!1)},bb.prototype.write=function(e,r,t,$){if(void 0===r)$="utf8",t=this.length,r=0;else if(void 0===t&&"string"==typeof r)$=r,t=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(t)?(t|=0,void 0===$&&($="utf8")):($=t,t=void 0)}var n=this.length-r;if((void 0===t||t>n)&&(t=n),e.length>0&&(t<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");$||($="utf8");for(var f=!1;;)switch($){case"hex":return Iz(this,e,r,t);case"utf8":case"utf-8":return Jz(this,e,r,t);case"ascii":return vp(this,e,r,t);case"latin1":case"binary":return Kz(this,e,r,t);case"base64":return Lz(this,e,r,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Mz(this,e,r,t);default:if(f)throw new TypeError("Unknown encoding: "+$);$=(""+$).toLowerCase(),f=!0;}},bb.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};pp=4096;bb.prototype.slice=function(e,r){var t,$=this.length;if((e=~~e)<0?(e+=$)<0&&(e=0):e>$&&(e=$),(r=void 0===r?$:~~r)<0?(r+=$)<0&&(r=0):r>$&&(r=$),r<e&&(r=e),bb.TYPED_ARRAY_SUPPORT)(t=this.subarray(e,r)).__proto__=bb.prototype;else{var n=r-e;t=new bb(n,void 0);for(var f=0;f<n;++f)t[f]=this[f+e]}return t},bb.prototype.readUIntLE=function(e,r,t){e|=0,r|=0,t||Hb(e,r,this.length);for(var $=this[e],n=1,f=0;++f<r&&(n*=256);)$+=this[e+f]*n;return $},bb.prototype.readUIntBE=function(e,r,t){e|=0,r|=0,t||Hb(e,r,this.length);for(var $=this[e+--r],n=1;r>0&&(n*=256);)$+=this[e+--r]*n;return $},bb.prototype.readUInt8=function(e,r){return r||Hb(e,1,this.length),this[e]},bb.prototype.readUInt16LE=function(e,r){return r||Hb(e,2,this.length),this[e]|this[e+1]<<8},bb.prototype.readUInt16BE=function(e,r){return r||Hb(e,2,this.length),this[e]<<8|this[e+1]},bb.prototype.readUInt32LE=function(e,r){return r||Hb(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},bb.prototype.readUInt32BE=function(e,r){return r||Hb(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},bb.prototype.readIntLE=function(e,r,t){e|=0,r|=0,t||Hb(e,r,this.length);for(var $=this[e],n=1,f=0;++f<r&&(n*=256);)$+=this[e+f]*n;return $>=(n*=128)&&($-=Math.pow(2,8*r)),$},bb.prototype.readIntBE=function(e,r,t){e|=0,r|=0,t||Hb(e,r,this.length);for(var $=r,n=1,f=this[e+--$];$>0&&(n*=256);)f+=this[e+--$]*n;return f>=(n*=128)&&(f-=Math.pow(2,8*r)),f},bb.prototype.readInt8=function(e,r){return r||Hb(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},bb.prototype.readInt16LE=function(e,r){r||Hb(e,2,this.length);var t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},bb.prototype.readInt16BE=function(e,r){r||Hb(e,2,this.length);var t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},bb.prototype.readInt32LE=function(e,r){return r||Hb(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},bb.prototype.readInt32BE=function(e,r){return r||Hb(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},bb.prototype.readFloatLE=function(e,r){return r||Hb(e,4,this.length),xg.read(this,e,!0,23,4)},bb.prototype.readFloatBE=function(e,r){return r||Hb(e,4,this.length),xg.read(this,e,!1,23,4)},bb.prototype.readDoubleLE=function(e,r){return r||Hb(e,8,this.length),xg.read(this,e,!0,52,8)},bb.prototype.readDoubleBE=function(e,r){return r||Hb(e,8,this.length),xg.read(this,e,!1,52,8)},bb.prototype.writeUIntLE=function(e,r,t,$){(e=+e,r|=0,t|=0,$)||Qb(this,e,r,t,Math.pow(2,8*t)-1,0);var n=1,f=0;for(this[r]=255&e;++f<t&&(n*=256);)this[r+f]=e/n&255;return r+t},bb.prototype.writeUIntBE=function(e,r,t,$){(e=+e,r|=0,t|=0,$)||Qb(this,e,r,t,Math.pow(2,8*t)-1,0);var n=t-1,f=1;for(this[r+n]=255&e;--n>=0&&(f*=256);)this[r+n]=e/f&255;return r+t},bb.prototype.writeUInt8=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,1,255,0),bb.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[r]=255&e,r+1},bb.prototype.writeUInt16LE=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,2,65535,0),bb.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):Sj(this,e,r,!0),r+2},bb.prototype.writeUInt16BE=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,2,65535,0),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):Sj(this,e,r,!1),r+2},bb.prototype.writeUInt32LE=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,4,4294967295,0),bb.TYPED_ARRAY_SUPPORT?(this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e):Tj(this,e,r,!0),r+4},bb.prototype.writeUInt32BE=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,4,4294967295,0),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):Tj(this,e,r,!1),r+4},bb.prototype.writeIntLE=function(e,r,t,$){if(e=+e,r|=0,!$){var n=Math.pow(2,8*t-1);Qb(this,e,r,t,n-1,-n)}var f=0,a=1,i=0;for(this[r]=255&e;++f<t&&(a*=256);)e<0&&0===i&&0!==this[r+f-1]&&(i=1),this[r+f]=(e/a>>0)-i&255;return r+t},bb.prototype.writeIntBE=function(e,r,t,$){if(e=+e,r|=0,!$){var n=Math.pow(2,8*t-1);Qb(this,e,r,t,n-1,-n)}var f=t-1,a=1,i=0;for(this[r+f]=255&e;--f>=0&&(a*=256);)e<0&&0===i&&0!==this[r+f+1]&&(i=1),this[r+f]=(e/a>>0)-i&255;return r+t},bb.prototype.writeInt8=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,1,127,-128),bb.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[r]=255&e,r+1},bb.prototype.writeInt16LE=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,2,32767,-32768),bb.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):Sj(this,e,r,!0),r+2},bb.prototype.writeInt16BE=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,2,32767,-32768),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):Sj(this,e,r,!1),r+2},bb.prototype.writeInt32LE=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,4,2147483647,-2147483648),bb.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24):Tj(this,e,r,!0),r+4},bb.prototype.writeInt32BE=function(e,r,t){return e=+e,r|=0,t||Qb(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):Tj(this,e,r,!1),r+4},bb.prototype.writeFloatLE=function(e,r,t){return yp(this,e,r,!0,t)},bb.prototype.writeFloatBE=function(e,r,t){return yp(this,e,r,!1,t)},bb.prototype.writeDoubleLE=function(e,r,t){return zp(this,e,r,!0,t)},bb.prototype.writeDoubleBE=function(e,r,t){return zp(this,e,r,!1,t)},bb.prototype.copy=function(e,r,t,$){if(t||(t=0),$||0===$||($=this.length),r>=e.length&&(r=e.length),r||(r=0),$>0&&$<t&&($=t),$===t)return 0;if(0===e.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if($<0)throw new RangeError("sourceEnd out of bounds");$>this.length&&($=this.length),e.length-r<$-t&&($=e.length-r+t);var n,f=$-t;if(this===e&&t<r&&r<$)for(n=f-1;n>=0;--n)e[n+r]=this[n+t];else if(f<1e3||!bb.TYPED_ARRAY_SUPPORT)for(n=0;n<f;++n)e[n+r]=this[n+t];else Uint8Array.prototype.set.call(e,this.subarray(t,t+f),r);return f},bb.prototype.fill=function(e,r,t,$){if("string"==typeof e){if("string"==typeof r?($=r,r=0,t=this.length):"string"==typeof t&&($=t,t=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==$&&"string"!=typeof $)throw new TypeError("encoding must be a string");if("string"==typeof $&&!bb.isEncoding($))throw new TypeError("Unknown encoding: "+$)}else"number"==typeof e&&(e&=255);if(r<0||this.length<r||this.length<t)throw new RangeError("Out of range index");if(t<=r)return this;var f;if(r>>>=0,t=void 0===t?this.length:t>>>0,e||(e=0),"number"==typeof e)for(f=r;f<t;++f)this[f]=e;else{var a=bb.isBuffer(e)?e:Uj(new bb(e,$).toString()),i=a.length;for(f=0;f<t-r;++f)this[f+r]=a[f%i]}return this};zz=/[^+\/0-9A-Za-z-_]/g}var Zz,Wj,Xj,id,$z=false;function Bp(r,$){for(var f in r)$[f]=r[f]}function $d(r,$,f){return id(r,$,f)}function Cp(){if($z)return;$z=true;Wj={};Xj=(Zd(),cd);id=Xj.Buffer;id.from&&id.alloc&&id.allocUnsafe&&id.allocUnsafeSlow?Wj=Xj:(Bp(Xj,Wj),Zz=$d,Wj.Buffer=Zz),$d.prototype=Object.create(id.prototype),Bp(id,$d),$d.from=function(r,$,f){if("number"==typeof r)throw new TypeError("Argument must not be a number");return id(r,$,f)},$d.alloc=function(r,$,f){if("number"!=typeof r)throw new TypeError("Argument must be a number");var u=id(r);return void 0!==$?"string"==typeof f?u.fill($,f):u.fill($):u.fill(0),u},$d.allocUnsafe=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return id(r)},$d.allocUnsafeSlow=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return Xj.SlowBuffer(r)}}var Dp={},_z=(Wd(),Ud),$k=65536,aA=4294967295;function bA(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}var cA=(Cp(),Wj).Buffer,Yj=Vb.crypto||Vb.msCrypto;function dA(r,$){if(r>aA)throw new RangeError("requested too many random bytes");var e=cA.allocUnsafe(r);if(r>0)if(r>$k)for(var o=0;o<r;o+=$k)Yj.getRandomValues(e.slice(o,o+$k));else Yj.getRandomValues(e);return"function"==typeof $?_z.nextTick(function(){$(null,e)}):e}Dp=Yj&&Yj.getRandomValues?dA:bA;var eA,Ep,yg,Fp,Gp,fA,gA=false;function hA(e){console&&console.warn&&console.warn(e)}function rb(){rb.init.call(this)}function Zj(e){if("function"!=typeof e)throw new TypeError("The \"listener\" argument must be of type Function. Received type "+typeof e)}function Hp(e){return void 0===e._maxListeners?rb.defaultMaxListeners:e._maxListeners}function Ip(e,t,r,n){var i,s,$;if(Zj(r),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),$=s[t]),void 0===$)$=s[t]=r,++e._eventsCount;else if("function"==typeof $?$=s[t]=n?[r,$]:[$,r]:n?$.unshift(r):$.push(r),(i=Hp(e))>0&&$.length>i&&!$.warned){$.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+$.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=e,o.type=t,o.count=$.length,hA(o)}return e}function iA(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Jp(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=iA.bind(n);return i.listener=r,n.wrapFn=i,i}function Kp(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?r?[i.listener||i]:[i]:r?kA(i):Mp(i,i.length)}function Lp(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function Mp(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function jA(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function kA(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function lA(e,t){return new Promise(function(r,n){function i(){void 0!==s&&e.removeListener("error",s),r([].slice.call(arguments))}var s;"error"!==t&&(s=function(r){e.removeListener(t,i),n(r)},e.once("error",s)),e.once(t,i)})}function Np(){if(gA)return;gA=true;Ep={};yg="object"==typeof Reflect?Reflect:null;Fp=yg&&"function"==typeof yg.apply?yg.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};eA=yg&&"function"==typeof yg.ownKeys?yg.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};Gp=Number.isNaN||function(e){return e!=e};(Ep=rb).once=lA,rb.EventEmitter=rb,rb.prototype._events=void 0,rb.prototype._eventsCount=0,rb.prototype._maxListeners=void 0;fA=10;Object.defineProperty(rb,"defaultMaxListeners",{enumerable:!0,get:function(){return fA},set:function(e){if("number"!=typeof e||e<0||Gp(e))throw new RangeError("The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received "+e+".");fA=e}}),rb.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},rb.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||Gp(e))throw new RangeError("The value of \"n\" is out of range. It must be a non-negative number. Received "+e+".");return this._maxListeners=e,this},rb.prototype.getMaxListeners=function(){return Hp(this)},rb.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var $=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw $.context=s,$}var o=i[e];if(void 0===o)return!1;if("function"==typeof o)Fp(o,this,t);else{var v=o.length,a=Mp(o,v);for(r=0;r<v;++r)Fp(a[r],this,t)}return!0},rb.prototype.addListener=function(e,t){return Ip(this,e,t,!1)},rb.prototype.on=rb.prototype.addListener,rb.prototype.prependListener=function(e,t){return Ip(this,e,t,!0)},rb.prototype.once=function(e,t){return Zj(t),this.on(e,Jp(this,e,t)),this},rb.prototype.prependOnceListener=function(e,t){return Zj(t),this.prependListener(e,Jp(this,e,t)),this},rb.prototype.removeListener=function(e,t){var r,n,i,s,$;if(Zj(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===t||r[s].listener===t){$=r[s].listener,i=s;break}if(i<0)return this;0===i?r.shift():jA(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,$||t)}return this},rb.prototype.off=rb.prototype.removeListener,rb.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,s=Object.keys(r);for(n=0;n<s.length;++n)"removeListener"!==(i=s[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},rb.prototype.listeners=function(e){return Kp(this,e,!0)},rb.prototype.rawListeners=function(e){return Kp(this,e,!1)},rb.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Lp.call(e,t)},rb.prototype.listenerCount=Lp,rb.prototype.eventNames=function(){return this._eventsCount>0?eA(this._events):[]}}var Op,mA=false;function Pp(){if(mA)return;mA=true;Op={};Op=(Np(),Ep).EventEmitter}var nA=false;function Qp(){if(nA)return;nA=true}var oA,pA,$j,qA,_k,rA,sA=false;function Rp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function tA(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rp(Object(r),!0).forEach(function(t){uA(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rp(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function uA(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sp(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function wA(e,t,r){return t&&Sp(e.prototype,t),r&&Sp(e,r),e}function xA(e,t,r){$j.prototype.copy.call(e,t,r)}function yA(){if(sA)return;sA=true;oA={};pA=(Zd(),cd);$j=pA.Buffer;qA=(Qp(),{});_k=qA.inspect;rA=_k&&_k.custom||"inspect";oA=function(){function e(){vA(this,e),this.head=null,this.tail=null,this.length=0}return wA(e,[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return $j.alloc(0);for(var t=$j.allocUnsafe(e>>>0),r=this.head,a=0;r;)xA(r.data,t,a),a+=r.data.length,r=r.next;return t}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,a=t.data;for(e-=a.length;t=t.next;){var n=t.data,i=e>n.length?n.length:e;if(i===n.length?a+=n:a+=n.slice(0,e),0===(e-=i)){i===n.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=n.slice(i));break}++r}return this.length-=r,a}},{key:"_getBuffer",value:function(e){var t=$j.allocUnsafe(e),r=this.head,a=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var n=r.data,i=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,i),0===(e-=i)){i===n.length?(++a,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=n.slice(i));break}++a}return this.length-=a,t}},{key:rA,value:function(e,t){return _k(this,tA({},t,{depth:0,customInspect:!1}))}}]),e}()}var Tp,_d,zA=false;function AA(t,e){var r=this,a=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return a||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,_d.nextTick(al,this,t)):_d.nextTick(al,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?r._writableState?r._writableState.errorEmitted?_d.nextTick(_j,r):(r._writableState.errorEmitted=!0,_d.nextTick(Up,r,t)):_d.nextTick(Up,r,t):e?(_d.nextTick(_j,r),e(t)):_d.nextTick(_j,r)}),this)}function Up(t,e){al(t,e),_j(t)}function _j(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function BA(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function al(t,e){t.emit("error",e)}function CA(t,e){var r=t._readableState,a=t._writableState;r&&r.autoDestroy||a&&a.autoDestroy?t.destroy(e):t.emit("error",e)}function Vp(){if(zA)return;zA=true;Tp={};_d=(Wd(),Ud);Tp={destroy:AA,undestroy:BA,errorOrDestroy:CA}}var ag,Wp,DA=false;function EA(r){return(EA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function FA(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}function Yb(r,e,t){t||(t=Error);var o=function(r){function t(t,o,n){return r.call(this,function(r,t,o){return"string"==typeof e?e:e(r,t,o)}(t,o,n))||this}return FA(t,r),t}(t);o.prototype.name=t.name,o.prototype.code=r,Wp[r]=o}function Xp(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(r){return String(r)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:2===t?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}return"of ".concat(e," ").concat(String(r))}function GA(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function HA(r,e,t){return(void 0===t||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function IA(r,e,t){return"number"!=typeof t&&(t=0),!(t+e.length>r.length)&&-1!==r.indexOf(e,t)}function zg(){if(DA)return;DA=true;ag={};Wp={};Yb("ERR_INVALID_OPT_VALUE",function(r,e){return"The value \""+e+"\" is invalid for option \""+r+"\""},TypeError),Yb("ERR_INVALID_ARG_TYPE",function(r,e,t){var o,n;if("string"==typeof e&&GA(e,"not ")?(o="must not be",e=e.replace(/^not /,"")):o="must be",HA(r," argument"))n="The ".concat(r," ").concat(o," ").concat(Xp(e,"type"));else{var a=IA(r,".")?"property":"argument";n="The \"".concat(r,"\" ").concat(a," ").concat(o," ").concat(Xp(e,"type"))}return n+=". Received type ".concat(EA(t))},TypeError),Yb("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),Yb("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"}),Yb("ERR_STREAM_PREMATURE_CLOSE","Premature close"),Yb("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"}),Yb("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),Yb("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),Yb("ERR_STREAM_WRITE_AFTER_END","write after end"),Yb("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),Yb("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError),Yb("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),ag.codes=Wp}var Yp,JA,KA=false;function LA(r,a,e){return null!=r.highWaterMark?r.highWaterMark:a?r[e]:null}function MA(r,a,e,$){var t=LA(a,$,e);if(null!=t){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new JA($?e:"highWaterMark",t);return Math.floor(t)}return r.objectMode?16:16384}function Zp(){if(KA)return;KA=true;Yp={};JA=(zg(),ag).codes.ERR_INVALID_OPT_VALUE;Yp={getHighWaterMark:MA}}var dj,NA=false;function ej(){if(NA)return;NA=true;dj={};dj="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}}}var OA,PA=false;function QA(r,o){if(bl("noDeprecation"))return r;var e=!1;return function(){if(!e){if(bl("throwDeprecation"))throw new Error(o);bl("traceDeprecation")?console.trace(o):console.warn(o),e=!0}return r.apply(this,arguments)}}function bl(r){try{if(!Vb.localStorage)return!1}catch(e){return!1}var o=Vb.localStorage[r];return null!=o&&"true"===String(o).toLowerCase()}function RA(){if(PA)return;PA=true;OA={};OA=QA}var cl,$p,bg,SA,_p,ak,TA,aq,dl,UA,VA,Ed,WA,XA,YA,ZA,$A,_A,aB,bB,Ag,cB=false;function bq(e){var r=this;this.next=null,this.entry=null,this.finish=function(){rB(r,e)}}function dB(e){return ak.from(e)}function eB(e){return ak.isBuffer(e)||e instanceof TA}function fB(){}function fj(e,r,t){cl=cl||(Cg(),Bg),e=e||{},"boolean"!=typeof t&&(t=r instanceof cl),this.objectMode=!!e.objectMode,t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=VA(this,e,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=!1===e.decodeStrings;this.decodeStrings=!$,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){mB(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new bq(this)}function Cb(e){var r=this instanceof(cl=cl||(Cg(),Bg));if(!r&&!aq.call(Cb,this))return new Cb(e);this._writableState=new fj(e,this,r),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),_p.call(this)}function gB(e,r){var t=new aB;Ag(e,t),bg.nextTick(r,t)}function hB(e,r,t,$){var i;return null===t?i=new _A:"string"==typeof t||r.objectMode||(i=new WA("chunk",["string","Buffer"],t)),!i||(Ag(e,i),bg.nextTick($,i),!1)}function iB(e,r,t){return e.objectMode||!1===e.decodeStrings||"string"!=typeof r||(r=ak.from(r,t)),r}function jB(e,r,t,$,i,a){if(!t){var n=iB(r,$,i);$!==n&&(t=!0,i="buffer",$=n)}var o=r.objectMode?1:$.length;r.length+=o;var s=r.length<r.highWaterMark;if(s||(r.needDrain=!0),r.writing||r.corked){var E=r.lastBufferedRequest;r.lastBufferedRequest={chunk:$,encoding:i,isBuf:t,callback:a,next:null},E?E.next=r.lastBufferedRequest:r.bufferedRequest=r.lastBufferedRequest,r.bufferedRequestCount+=1}else fl(e,r,!1,o,$,i,a);return s}function fl(e,r,t,$,i,a,n){r.writelen=$,r.writecb=n,r.writing=!0,r.sync=!0,r.destroyed?r.onwrite(new $A("write")):t?e._writev(i,r.onwrite):e._write(i,a,r.onwrite),r.sync=!1}function kB(e,r,t,$,i){--r.pendingcb,t?(bg.nextTick(i,$),bg.nextTick(gj,e,r),e._writableState.errorEmitted=!0,Ag(e,$)):(i($),e._writableState.errorEmitted=!0,Ag(e,$),gj(e,r))}function lB(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function mB(e,r){var t=e._writableState,$=t.sync,i=t.writecb;if("function"!=typeof i)throw new YA;if(lB(t),r)kB(e,t,$,r,i);else{var a=eq(t)||e.destroyed;a||t.corked||t.bufferProcessing||!t.bufferedRequest||dq(e,t),$?bg.nextTick(cq,e,t,a,i):cq(e,t,a,i)}}function cq(e,r,t,$){t||nB(e,r),r.pendingcb--,$(),gj(e,r)}function nB(e,r){0===r.length&&r.needDrain&&(r.needDrain=!1,e.emit("drain"))}function dq(e,r){r.bufferProcessing=!0;var t=r.bufferedRequest;if(e._writev&&t&&t.next){var $=r.bufferedRequestCount,i=new Array($),a=r.corkedRequestsFree;a.entry=t;for(var n=0,o=!0;t;)i[n]=t,t.isBuf||(o=!1),t=t.next,n+=1;i.allBuffers=o,fl(e,r,!0,r.length,i,"",a.finish),r.pendingcb++,r.lastBufferedRequest=null,a.next?(r.corkedRequestsFree=a.next,a.next=null):r.corkedRequestsFree=new bq(r),r.bufferedRequestCount=0}else{for(;t;){var s=t.chunk,E=t.encoding,w=t.callback;if(fl(e,r,!1,r.objectMode?1:s.length,s,E,w),t=t.next,r.bufferedRequestCount--,r.writing)break}null===t&&(r.lastBufferedRequest=null)}r.bufferedRequest=t,r.bufferProcessing=!1}function eq(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function oB(e,r){e._final(function(t){r.pendingcb--,t&&Ag(e,t),r.prefinished=!0,e.emit("prefinish"),gj(e,r)})}function pB(e,r){r.prefinished||r.finalCalled||("function"!=typeof e._final||r.destroyed?(r.prefinished=!0,e.emit("prefinish")):(r.pendingcb++,r.finalCalled=!0,bg.nextTick(oB,e,r)))}function gj(e,r){var t=eq(r);if(t&&(pB(e,r),0===r.pendingcb&&(r.finished=!0,e.emit("finish"),r.autoDestroy))){var $=e._readableState;(!$||$.autoDestroy&&$.endEmitted)&&e.destroy()}return t}function qB(e,r,t){r.ending=!0,gj(e,r),t&&(r.finished?bg.nextTick(t):e.once("finish",t)),r.ended=!0,e.writable=!1}function rB(e,r,t){var $=e.entry;for(e.entry=null;$;){var i=$.callback;r.pendingcb--,i(t),$=$.next}r.corkedRequestsFree.next=e}function fq(){if(cB)return;cB=true;$p={};bg=(Wd(),Ud);$p=Cb,Cb.WritableState=fj;SA={deprecate:(RA(),OA)};_p=(Pp(),Op);ak=(Zd(),cd).Buffer;TA=Vb.Uint8Array||function(){};dl=(Vp(),Tp);UA=(Zp(),Yp);VA=UA.getHighWaterMark;Ed=(zg(),ag).codes;WA=Ed.ERR_INVALID_ARG_TYPE;XA=Ed.ERR_METHOD_NOT_IMPLEMENTED;YA=Ed.ERR_MULTIPLE_CALLBACK;ZA=Ed.ERR_STREAM_CANNOT_PIPE;$A=Ed.ERR_STREAM_DESTROYED;_A=Ed.ERR_STREAM_NULL_VALUES;aB=Ed.ERR_STREAM_WRITE_AFTER_END;bB=Ed.ERR_UNKNOWN_ENCODING;Ag=dl.errorOrDestroy;(ej(),dj)(Cb,_p),fj.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r},function(){try{Object.defineProperty(fj.prototype,"buffer",{get:SA.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(aq=Function.prototype[Symbol.hasInstance],Object.defineProperty(Cb,Symbol.hasInstance,{value:function(e){return!!aq.call(this,e)||this===Cb&&e&&e._writableState instanceof fj}})):aq=function(e){return e instanceof this},Cb.prototype.pipe=function(){Ag(this,new ZA)},Cb.prototype.write=function(e,r,t){var $=this._writableState,i=!1,a=!$.objectMode&&eB(e);return a&&!ak.isBuffer(e)&&(e=dB(e)),"function"==typeof r&&(t=r,r=null),a?r="buffer":r||(r=$.defaultEncoding),"function"!=typeof t&&(t=fB),$.ending?gB(this,t):(a||hB(this,$,e,t))&&($.pendingcb++,i=jB(this,$,a,e,r,t)),i},Cb.prototype.cork=function(){this._writableState.corked++},Cb.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||dq(this,e))},Cb.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new bB(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(Cb.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(Cb.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Cb.prototype._write=function(e,r,t){t(new XA("_write()"))},Cb.prototype._writev=null,Cb.prototype.end=function(e,r,t){var $=this._writableState;return"function"==typeof e?(t=e,e=null,r=null):"function"==typeof r&&(t=r,r=null),null!=e&&this.write(e,r),$.corked&&($.corked=1,this.uncork()),$.ending||qB(this,$,t),this},Object.defineProperty(Cb.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(Cb.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),Cb.prototype.destroy=dl.destroy,Cb.prototype._undestroy=dl.undestroy,Cb.prototype._destroy=function(e,r){r(e)}}var Bg,sB,tB,gq,gl,uB=false;function jd(e){if(!(this instanceof jd))return new jd(e);gq.call(this,e),gl.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",vB)))}function vB(){this._writableState.ended||sB.nextTick(wB,this)}function wB(e){e.end()}function Cg(){if(uB)return;uB=true;Bg={};sB=(Wd(),Ud);tB=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};Bg=jd;gq=(zq(),nq);gl=(fq(),$p);(ej(),dj)(jd,gq);for(var $YgPj$var$keys=tB(gl.prototype),$YgPj$var$v=0;$YgPj$var$v<$YgPj$var$keys.length;$YgPj$var$v++){var $YgPj$var$method=$YgPj$var$keys[$YgPj$var$v];jd.prototype[$YgPj$var$method]||(jd.prototype[$YgPj$var$method]=gl.prototype[$YgPj$var$method])}Object.defineProperty(jd.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(jd.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(jd.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(jd.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}var hl,il,hq,xB,yB=false;function zB(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0;}}function AB(t){var e=zB(t);if("string"!=typeof e&&(il.isEncoding===hq||!hq(t)))throw new Error("Unknown encoding: "+t);return e||t}function hj(t){var e;switch(this.encoding=AB(t),this.encoding){case"utf16le":this.text=GB,this.end=HB,e=4;break;case"utf8":this.fillLast=DB,e=4;break;case"base64":this.text=IB,this.end=JB,e=3;break;default:return this.write=KB,void(this.end=LB);}this.lastNeed=0,this.lastTotal=0,this.lastChar=il.allocUnsafe(e)}function jl(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function BB(t,e,r){var a=e.length-1;if(a<r)return 0;var s=jl(e[a]);return s>=0?(s>0&&(t.lastNeed=s-1),s):--a<r||-2===s?0:(s=jl(e[a]))>=0?(s>0&&(t.lastNeed=s-2),s):--a<r||-2===s?0:(s=jl(e[a]))>=0?(s>0&&(2===s?s=0:t.lastNeed=s-3),s):0}function CB(t,e,r){if(128!=(192&e[0]))return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"\uFFFD"}}function DB(t){var e=this.lastTotal-this.lastNeed,r=CB(this,t,e);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function EB(t,e){var r=BB(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var a=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,a),t.toString("utf8",e,a)}function FB(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function GB(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var a=r.charCodeAt(r.length-1);if(a>=55296&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function HB(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function IB(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function JB(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function KB(t){return t.toString(this.encoding)}function LB(t){return t&&t.length?this.write(t):""}function iq(){if(yB)return;yB=true;hl={};il=(Cp(),Wj).Buffer;hq=il.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1;}};xB=hj;hl.StringDecoder=xB,hj.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},hj.prototype.end=FB,hj.prototype.text=EB,hj.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}}var kl,jq,MB=false;function NB(e){var r=!1;return function(){if(!r){r=!0;for(var n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];e.apply(this,t)}}}function OB(){}function PB(e){return e.setHeader&&"function"==typeof e.abort}function kq(e,r,n){if("function"==typeof r)return kq(e,null,r);r||(r={}),n=NB(n||OB);var t=r.readable||!1!==r.readable&&e.readable,o=r.writable||!1!==r.writable&&e.writable,a=function(){e.writable||$()},i=e._writableState&&e._writableState.finished,$=function(){o=!1,i=!0,t||n.call(e)},l=e._readableState&&e._readableState.endEmitted,R=function(){t=!1,l=!0,o||n.call(e)},s=function(r){n.call(e,r)},c=function(){var r;return t&&!l?(e._readableState&&e._readableState.ended||(r=new jq),n.call(e,r)):o&&!i?(e._writableState&&e._writableState.ended||(r=new jq),n.call(e,r)):void 0},v=function(){e.req.on("finish",$)};return PB(e)?(e.on("complete",$),e.on("abort",c),e.req?v():e.on("request",v)):o&&!e._writableState&&(e.on("end",a),e.on("close",a)),e.on("end",R),e.on("finish",$),!1!==r.error&&e.on("error",s),e.on("close",c),function(){e.removeListener("complete",$),e.removeListener("abort",c),e.removeListener("request",v),e.req&&e.req.removeListener("finish",$),e.removeListener("end",a),e.removeListener("close",a),e.removeListener("finish",$),e.removeListener("end",R),e.removeListener("error",s),e.removeListener("close",c)}}function ll(){if(MB)return;MB=true;kl={};jq=(zg(),ag).codes.ERR_STREAM_PREMATURE_CLOSE;kl=kq}var lq,QB,mq,RB,Fd,cg,ij,bk,dg,ml,eg,SB,TB,UB,VB=false;function Gd(e,r,$){return r in e?Object.defineProperty(e,r,{value:$,enumerable:!0,configurable:!0,writable:!0}):e[r]=$,e}function Hd(e,r){return{value:e,done:r}}function WB(e){var r=e[Fd];if(null!==r){var $=e[eg].read();null!==$&&(e[dg]=null,e[Fd]=null,e[cg]=null,r(Hd($,!1)))}}function XB(e){mq.nextTick(WB,e)}function YB(e,r){return function($,a){e.then(function(){r[bk]?$(Hd(void 0,!0)):r[ml]($,a)},a)}}function ZB(){if(VB)return;VB=true;QB={};mq=(Wd(),Ud);RB=(ll(),kl);Fd=Symbol("lastResolve");cg=Symbol("lastReject");ij=Symbol("error");bk=Symbol("ended");dg=Symbol("lastPromise");ml=Symbol("handlePromise");eg=Symbol("stream");SB=Object.getPrototypeOf(function(){});TB=Object.setPrototypeOf((Gd(lq={get stream(){return this[eg]},next:function(){var e=this,r=this[ij];if(null!==r)return Promise.reject(r);if(this[bk])return Promise.resolve(Hd(void 0,!0));if(this[eg].destroyed)return new Promise(function(r,$){mq.nextTick(function(){e[ij]?$(e[ij]):r(Hd(void 0,!0))})});var $,a=this[dg];if(a)$=new Promise(YB(a,this));else{var t=this[eg].read();if(null!==t)return Promise.resolve(Hd(t,!1));$=new Promise(this[ml])}return this[dg]=$,$}},Symbol.asyncIterator,function(){return this}),Gd(lq,"return",function(){var e=this;return new Promise(function(r,$){e[eg].destroy(null,function(e){e?$(e):r(Hd(void 0,!0))})})}),lq),SB);UB=function(e){var r,$=Object.create(TB,(Gd(r={},eg,{value:e,writable:!0}),Gd(r,Fd,{value:null,writable:!0}),Gd(r,cg,{value:null,writable:!0}),Gd(r,ij,{value:null,writable:!0}),Gd(r,bk,{value:e._readableState.endEmitted,writable:!0}),Gd(r,ml,{value:function(e,r){var a=$[eg].read();a?($[dg]=null,$[Fd]=null,$[cg]=null,e(Hd(a,!1))):($[Fd]=e,$[cg]=r)},writable:!0}),r));return $[dg]=null,RB(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var r=$[cg];return null!==r&&($[dg]=null,$[Fd]=null,$[cg]=null,r(e)),void($[ij]=e)}var a=$[Fd];null!==a&&($[dg]=null,$[Fd]=null,$[cg]=null,a(Hd(void 0,!0))),$[bk]=!0}),e.on("readable",XB.bind(null,$)),$};QB=UB}var $B,_B=false;function aC(){if(_B)return;_B=true;$B={};$B=function(){throw new Error("Readable.from is not available in the browser")}}var ck,nq,kd,b,oq,jj,dk,bC,jb,nl,ek,pq,qq,cC,ol,dC,eC,fk,fC,gC,hC,iC,kj,pl,rq,jC=false;function kC(e){return dk.from(e)}function lC(e){return dk.isBuffer(e)||e instanceof bC}function mC(e,r,a){if("function"==typeof e.prependListener)return e.prependListener(r,a);e._events&&e._events[r]?Array.isArray(e._events[r])?e._events[r].unshift(a):e._events[r]=[a,e._events[r]]:e.on(r,a)}function sq(e,r,a){ck=ck||(Cg(),Bg),e=e||{},"boolean"!=typeof a&&(a=r instanceof ck),this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=eC(this,e,"readableHighWaterMark",a),this.buffer=new cC,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(ek||(ek=(iq(),hl).StringDecoder),this.decoder=new ek(e.encoding),this.encoding=e.encoding)}function nb(e){if(ck=ck||(Cg(),Bg),!(this instanceof nb))return new nb(e);var r=this instanceof ck;this._readableState=new sq(e,this,r),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),jj.call(this)}function tq(e,r,a,t,$){jb("readableAddChunk",r);var n,i=e._readableState;if(null===r)i.reading=!1,pC(e,i);else if($||(n=nC(i,r)),n)kj(e,n);else if(i.objectMode||r&&r.length>0){if("string"==typeof r||i.objectMode||Object.getPrototypeOf(r)===dk.prototype||(r=kC(r)),t)i.endEmitted?kj(e,new iC):ql(e,i,r,!0);else if(i.ended)kj(e,new gC);else{if(i.destroyed)return!1;i.reading=!1,i.decoder&&!a?(r=i.decoder.write(r),i.objectMode||0!==r.length?ql(e,i,r,!1):rl(e,i)):ql(e,i,r,!1)}}else t||(i.reading=!1,rl(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function ql(e,r,a,t){r.flowing&&0===r.length&&!r.sync?(r.awaitDrain=0,e.emit("data",a)):(r.length+=r.objectMode?1:a.length,t?r.buffer.unshift(a):r.buffer.push(a),r.needReadable&&gk(e)),rl(e,r)}function nC(e,r){var a;return lC(r)||"string"==typeof r||void 0===r||e.objectMode||(a=new fC("chunk",["string","Buffer","Uint8Array"],r)),a}function oC(e){return e>=rq?e=rq:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function uq(e,r){return e<=0||0===r.length&&r.ended?0:r.objectMode?1:e!=e?r.flowing&&r.length?r.buffer.head.data.length:r.length:(e>r.highWaterMark&&(r.highWaterMark=oC(e)),e<=r.length?e:r.ended?r.length:(r.needReadable=!0,0))}function pC(e,r){if(jb("onEofChunk"),!r.ended){if(r.decoder){var a=r.decoder.end();a&&a.length&&(r.buffer.push(a),r.length+=r.objectMode?1:a.length)}r.ended=!0,r.sync?gk(e):(r.needReadable=!1,r.emittedReadable||(r.emittedReadable=!0,vq(e)))}}function gk(e){var r=e._readableState;jb("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(jb("emitReadable",r.flowing),r.emittedReadable=!0,kd.nextTick(vq,e))}function vq(e){var r=e._readableState;jb("emitReadable_",r.destroyed,r.length,r.ended),r.destroyed||!r.length&&!r.ended||(e.emit("readable"),r.emittedReadable=!1),r.needReadable=!r.flowing&&!r.ended&&r.length<=r.highWaterMark,sl(e)}function rl(e,r){r.readingMore||(r.readingMore=!0,kd.nextTick(qC,e,r))}function qC(e,r){for(;!r.reading&&!r.ended&&(r.length<r.highWaterMark||r.flowing&&0===r.length);){var a=r.length;if(jb("maybeReadMore read 0"),e.read(0),a===r.length)break}r.readingMore=!1}function rC(e){return function(){var r=e._readableState;jb("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,0===r.awaitDrain&&oq(e,"data")&&(r.flowing=!0,sl(e))}}function wq(e){var r=e._readableState;r.readableListening=e.listenerCount("readable")>0,r.resumeScheduled&&!r.paused?r.flowing=!0:e.listenerCount("data")>0&&e.resume()}function sC(e){jb("readable nexttick read 0"),e.read(0)}function tC(e,r){r.resumeScheduled||(r.resumeScheduled=!0,kd.nextTick(uC,e,r))}function uC(e,r){jb("resume",r.reading),r.reading||e.read(0),r.resumeScheduled=!1,e.emit("resume"),sl(e),r.flowing&&!r.reading&&e.read(0)}function sl(e){var r=e._readableState;for(jb("flow",r.flowing);r.flowing&&null!==e.read(););}function xq(e,r){return 0===r.length?null:(r.objectMode?a=r.buffer.shift():!e||e>=r.length?(a=r.decoder?r.buffer.join(""):1===r.buffer.length?r.buffer.first():r.buffer.concat(r.length),r.buffer.clear()):a=r.buffer.consume(e,r.decoder),a);var a}function ul(e){var r=e._readableState;jb("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,kd.nextTick(vC,r,e))}function vC(e,r){if(jb("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,r.readable=!1,r.emit("end"),e.autoDestroy)){var a=r._writableState;(!a||a.autoDestroy&&a.finished)&&r.destroy()}}function yq(e,r){for(var a=0,t=e.length;a<t;a++)if(e[a]===r)return a;return-1}function zq(){if(jC)return;jC=true;nq={};kd=(Wd(),Ud);nq=nb,nb.ReadableState=sq;b=(Np(),Ep).EventEmitter;oq=function(e,r){return e.listeners(r).length};jj=(Pp(),Op);dk=(Zd(),cd).Buffer;bC=Vb.Uint8Array||function(){};nl=(Qp(),{});jb=nl&&nl.debuglog?nl.debuglog("stream"):function(){};cC=(yA(),oA);ol=(Vp(),Tp);dC=(Zp(),Yp);eC=dC.getHighWaterMark;fk=(zg(),ag).codes;fC=fk.ERR_INVALID_ARG_TYPE;gC=fk.ERR_STREAM_PUSH_AFTER_EOF;hC=fk.ERR_METHOD_NOT_IMPLEMENTED;iC=fk.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;(ej(),dj)(nb,jj);kj=ol.errorOrDestroy;pl=["error","close","destroy","pause","resume"];Object.defineProperty(nb.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),nb.prototype.destroy=ol.destroy,nb.prototype._undestroy=ol.undestroy,nb.prototype._destroy=function(e,r){r(e)},nb.prototype.push=function(e,r){var a,t=this._readableState;return t.objectMode?a=!0:"string"==typeof e&&((r=r||t.defaultEncoding)!==t.encoding&&(e=dk.from(e,r),r=""),a=!0),tq(this,e,r,!1,a)},nb.prototype.unshift=function(e){return tq(this,e,null,!0,!1)},nb.prototype.isPaused=function(){return!1===this._readableState.flowing},nb.prototype.setEncoding=function(e){ek||(ek=(iq(),hl).StringDecoder);var r=new ek(e);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var a=this._readableState.buffer.head,t="";null!==a;)t+=r.write(a.data),a=a.next;return this._readableState.buffer.clear(),""!==t&&this._readableState.buffer.push(t),this._readableState.length=t.length,this};rq=1073741824;nb.prototype.read=function(e){jb("read",e),e=parseInt(e,10);var r=this._readableState,a=e;if(0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&((0!==r.highWaterMark?r.length>=r.highWaterMark:r.length>0)||r.ended))return jb("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?ul(this):gk(this),null;if(0===(e=uq(e,r))&&r.ended)return 0===r.length&&ul(this),null;var t,$=r.needReadable;return jb("need readable",$),(0===r.length||r.length-e<r.highWaterMark)&&jb("length less than watermark",$=!0),r.ended||r.reading?jb("reading or ended",$=!1):$&&(jb("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=uq(a,r))),null===(t=e>0?xq(e,r):null)?(r.needReadable=r.length<=r.highWaterMark,e=0):(r.length-=e,r.awaitDrain=0),0===r.length&&(r.ended||(r.needReadable=!0),a!==e&&r.ended&&ul(this)),null!==t&&this.emit("data",t),t},nb.prototype._read=function(e){kj(this,new hC("_read()"))},nb.prototype.pipe=function(e,r){var a=this,t=this._readableState;switch(t.pipesCount){case 0:t.pipes=e;break;case 1:t.pipes=[t.pipes,e];break;default:t.pipes.push(e);}t.pipesCount+=1,jb("pipe count=%d opts=%j",t.pipesCount,r);var $=(!r||!1!==r.end)&&e!==kd.stdout&&e!==kd.stderr?i:u;function n(r,$){jb("onunpipe"),r===a&&$&&!1===$.hasUnpiped&&($.hasUnpiped=!0,jb("cleanup"),e.removeListener("close",s),e.removeListener("finish",l),e.removeListener("drain",d),e.removeListener("error",o),e.removeListener("unpipe",n),a.removeListener("end",i),a.removeListener("end",u),a.removeListener("data",h),U=!0,!t.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function i(){jb("onend"),e.end()}t.endEmitted?kd.nextTick($):a.once("end",$),e.on("unpipe",n);var d=rC(a);e.on("drain",d);var U=!1;function h(r){jb("ondata");var $=e.write(r);jb("dest.write",$),!1===$&&((1===t.pipesCount&&t.pipes===e||t.pipesCount>1&&-1!==yq(t.pipes,e))&&!U&&(jb("false write response, pause",t.awaitDrain),t.awaitDrain++),a.pause())}function o(r){jb("onerror",r),u(),e.removeListener("error",o),0===oq(e,"error")&&kj(e,r)}function s(){e.removeListener("finish",l),u()}function l(){jb("onfinish"),e.removeListener("close",s),u()}function u(){jb("unpipe"),a.unpipe(e)}return a.on("data",h),mC(e,"error",o),e.once("close",s),e.once("finish",l),e.emit("pipe",a),t.flowing||(jb("pipe resume"),a.resume()),e},nb.prototype.unpipe=function(e){var r=this._readableState,a={hasUnpiped:!1};if(0===r.pipesCount)return this;if(1===r.pipesCount)return e&&e!==r.pipes?this:(e||(e=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,e&&e.emit("unpipe",this,a),this);if(!e){var t=r.pipes,$=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var n=0;n<$;n++)t[n].emit("unpipe",this,{hasUnpiped:!1});return this}var i=yq(r.pipes,e);return-1===i?this:(r.pipes.splice(i,1),r.pipesCount-=1,1===r.pipesCount&&(r.pipes=r.pipes[0]),e.emit("unpipe",this,a),this)},nb.prototype.on=function(e,r){var a=jj.prototype.on.call(this,e,r),t=this._readableState;return"data"===e?(t.readableListening=this.listenerCount("readable")>0,!1!==t.flowing&&this.resume()):"readable"===e&&(t.endEmitted||t.readableListening||(t.readableListening=t.needReadable=!0,t.flowing=!1,t.emittedReadable=!1,jb("on readable",t.length,t.reading),t.length?gk(this):t.reading||kd.nextTick(sC,this))),a},nb.prototype.addListener=nb.prototype.on,nb.prototype.removeListener=function(e,r){var a=jj.prototype.removeListener.call(this,e,r);return"readable"===e&&kd.nextTick(wq,this),a},nb.prototype.removeAllListeners=function(e){var r=jj.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||kd.nextTick(wq,this),r},nb.prototype.resume=function(){var e=this._readableState;return e.flowing||(jb("resume"),e.flowing=!e.readableListening,tC(this,e)),e.paused=!1,this},nb.prototype.pause=function(){return jb("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(jb("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},nb.prototype.wrap=function(e){var r=this,a=this._readableState,t=!1;for(var $ in e.on("end",function(){if(jb("wrapped end"),a.decoder&&!a.ended){var e=a.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function($){(jb("wrapped data"),a.decoder&&($=a.decoder.write($)),a.objectMode&&null==$)||(a.objectMode||$&&$.length)&&(r.push($)||(t=!0,e.pause()))}),e)void 0===this[$]&&"function"==typeof e[$]&&(this[$]=function(r){return function(){return e[r].apply(e,arguments)}}($));for(var n=0;n<pl.length;n++)e.on(pl[n],this.emit.bind(this,pl[n]));return this._read=function(r){jb("wrapped _read",r),t&&(t=!1,e.resume())},this},"function"==typeof Symbol&&(nb.prototype[Symbol.asyncIterator]=function(){return void 0===pq&&(pq=(ZB(),QB)),pq(this)}),Object.defineProperty(nb.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(nb.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(nb.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),nb._fromList=xq,Object.defineProperty(nb.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(nb.from=function(e,r){return void 0===qq&&(qq=(aC(),$B)),qq(nb,e,r)})}var vl={};vl=td;var hk=(zg(),ag).codes,wC=hk.ERR_METHOD_NOT_IMPLEMENTED,xC=hk.ERR_MULTIPLE_CALLBACK,yC=hk.ERR_TRANSFORM_ALREADY_TRANSFORMING,zC=hk.ERR_TRANSFORM_WITH_LENGTH_0,ik=(Cg(),Bg);function AC(r,e){var t=this._transformState;t.transforming=!1;var a=t.writecb;if(null===a)return this.emit("error",new xC);t.writechunk=null,t.writecb=null,null!=e&&this.push(e),a(r);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function td(r){if(!(this instanceof td))return new td(r);ik.call(this,r),this._transformState={afterTransform:AC.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",BC)}function BC(){var r=this;"function"!=typeof this._flush||this._readableState.destroyed?Aq(this,null,null):this._flush(function(e,t){Aq(r,e,t)})}function Aq(r,e,t){if(e)return r.emit("error",e);if(null!=t&&r.push(t),r._writableState.length)throw new zC;if(r._transformState.transforming)throw new yC;return r.push(null)}(ej(),dj)(td,ik),td.prototype.push=function(r,e){return this._transformState.needTransform=!1,ik.prototype.push.call(this,r,e)},td.prototype._transform=function(r,e,t){t(new wC("_transform()"))},td.prototype._write=function(r,e,t){var a=this._transformState;if(a.writecb=t,a.writechunk=r,a.writeencoding=e,!a.transforming){var o=this._readableState;(a.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},td.prototype._read=function(r){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},td.prototype._destroy=function(r,e){ik.prototype._destroy.call(this,r,function(r){e(r)})};var CC={};CC=lj;function lj(r){if(!(this instanceof lj))return new lj(r);vl.call(this,r)}(ej(),dj)(lj,vl),lj.prototype._transform=function(r,$,a){a(null,r)};var Bq,DC={};function EC(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var Cq=(zg(),ag).codes,FC=Cq.ERR_MISSING_ARGS,GC=Cq.ERR_STREAM_DESTROYED;function Dq(r){if(r)throw r}function HC(r){return r.setHeader&&"function"==typeof r.abort}function IC(r,e,$,a){a=EC(a);var n=!1;r.on("close",function(){n=!0}),void 0===Bq&&(Bq=(ll(),kl)),Bq(r,{readable:e,writable:$},function(r){if(r)return a(r);n=!0,a()});var o=!1;return function(e){if(!n&&!o)return o=!0,HC(r)?r.abort():"function"==typeof r.destroy?r.destroy():void a(e||new GC("pipe"))}}function Eq(r){r()}function JC(r,e){return r.pipe(e)}function KC(r){return r.length?"function"!=typeof r[r.length-1]?Dq:r.pop():Dq}function LC(){for(var r=arguments.length,e=new Array(r),$=0;$<r;$++)e[$]=arguments[$];var a,n=KC(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new FC("streams");var o=e.map(function(r,$){var t=$<e.length-1;return IC(r,t,$>0,function(r){a||(a=r),r&&o.forEach(Eq),t||(o.forEach(Eq),n(a))})});return e.reduce(JC)}DC=LC;var ud={},MC=ud=ud=(zq(),nq);ud.Stream=MC;ud.Readable=ud;var NC=(fq(),$p);ud.Writable=NC;var Fq=(Cg(),Bg);ud.Duplex=Fq;ud.Transform=vl;ud.PassThrough=CC;var OC=(ll(),kl);ud.finished=OC;ud.pipeline=DC;var jk={};let PC;jk="function"==typeof queueMicrotask?queueMicrotask.bind(globalThis):e=>(PC||(PC=Promise.resolve())).then(e).catch(e=>setTimeout(()=>{throw e},0));var wb={};function Gq(r,e){for(const t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function QC(r,e,t){if(!r||"string"==typeof r)throw new TypeError("Please pass an Error to err-code");t||(t={}),"object"==typeof e&&(t=e,e=void 0),null!=e&&(t.code=e);try{return Gq(r,t)}catch(o){t.message=r.message,t.stack=r.stack;const e=function(){};return e.prototype=Object.create(Object.getPrototypeOf(r)),Gq(new e,t)}}wb=QC;var Hq={};const RC=bd("simple-peer"),{Buffer:SC}=(Zd(),cd),wl=65536,TC=5e3,UC=5e3;function Iq(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}function VC(e){console.warn(e)}class Dg extends Fq{constructor(e){if(super(e=Object.assign({allowHalfOpen:!1},e)),this._id=Dp(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||Dp(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||Dg.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},Dg.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(e=>e),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=void 0===e.trickle||e.trickle,this.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,this.iceCompleteTimeout=e.iceCompleteTimeout||TC,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:lp(),!this._wrtc)throw"undefined"==typeof window?wb(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):wb(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){return void jk(()=>this.destroy(wb(t,"ERR_PC_CONSTRUCTOR")))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=e=>{this._onIceCandidate(e)},this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=e=>{this._setupData(e)},this.streams&&this.streams.forEach(e=>{this.addStream(e)}),this._pc.ontrack=e=>{this._onTrack(e)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw wb(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(e=>{this._addIceCandidate(e)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(e=>{this.destroy(wb(e,"ERR_SET_REMOTE_DESCRIPTION"))}),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||this.destroy(wb(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){const t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(e=>{!t.address||t.address.endsWith(".local")?VC("Ignoring unsupported ICE candidate."):this.destroy(wb(e,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(i){this.destroy(wb(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:e,init:t}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}addTrack(e,t){this._debug("addTrack()");const i=this._senderMap.get(e)||new Map;let s=i.get(t);if(s)throw s.removed?wb(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):wb(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");s=this._pc.addTrack(e,t),i.set(t,s),this._senderMap.set(e,i),this._needsNegotiation()}replaceTrack(e,t,i){this._debug("replaceTrack()");const s=this._senderMap.get(e),n=s?s.get(i):null;if(!n)throw wb(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,s),null!=n.replaceTrack?n.replaceTrack(t):this.destroy(wb(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){this._debug("removeSender()");const i=this._senderMap.get(e),s=i?i.get(t):null;if(!s)throw wb(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{s.removed=!0,this._pc.removeTrack(s)}catch(n){"NS_ERROR_UNEXPECTED"===n.name?this._sendersAwaitingStable.push(s):this.destroy(wb(n,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,jk(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}destroy(e){this._destroy(e,()=>{})}_destroy(e,t){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",e&&(e.message||e)),jk(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()}))}_setupData(e){if(!e.channel)return this.destroy(wb(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=wl),this.channelName=this._channel.label,this._channel.onmessage=e=>{this._onChannelMessage(e)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=e=>{this.destroy(wb(e,"ERR_DATA_CHANNEL"))};let t=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(t&&this._onChannelClose(),t=!0):t=!1},UC)}_read(){}_write(e,t,i){if(this.destroyed)return i(wb(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(s){return this.destroy(wb(s,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>wl?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=Iq(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp})};this._pc.setLocalDescription(e).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(e=>{this.destroy(wb(e,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.destroy(wb(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{e.mid||!e.sender.track||e.requested||(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=Iq(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(this.destroyed)return;const t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp}),this.initiator||this._requestMissingTransceivers()};this._pc.setLocalDescription(e).then(()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(e=>{this.destroy(wb(e,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.destroy(wb(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(wb(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),"connected"!==e&&"completed"!==e||(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(wb(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(wb(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(e){const t=e=>("[object Array]"===Object.prototype.toString.call(e.values)&&e.values.forEach(t=>{Object.assign(e,t)}),e);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{const s=[];i.forEach(e=>{s.push(t(e))}),e(null,s)},t=>e(t)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(this.destroyed)return;const s=[];i.result().forEach(e=>{const i={};e.names().forEach(t=>{i[t]=e.stat(t)}),i.id=e.id,i.type=e.type,i.timestamp=e.timestamp,s.push(t(i))}),e(null,s)},t=>e(t)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((t,i)=>{if(this.destroyed)return;t&&(i=[]);const s={},n={},r={};let a=!1;i.forEach(e=>{"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(s[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(n[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(r[e.id]=e)});const o=e=>{a=!0;let t=n[e.localCandidateId];t&&(t.ip||t.address)?(this.localAddress=t.ip||t.address,this.localPort=Number(t.port)):t&&t.ipAddress?(this.localAddress=t.ipAddress,this.localPort=Number(t.portNumber)):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),this.localAddress=t[0],this.localPort=Number(t[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let i=s[e.remoteCandidateId];i&&(i.ip||i.address)?(this.remoteAddress=i.ip||i.address,this.remotePort=Number(i.port)):i&&i.ipAddress?(this.remoteAddress=i.ipAddress,this.remotePort=Number(i.portNumber)):"string"==typeof e.googRemoteAddress&&(i=e.googRemoteAddress.split(":"),this.remoteAddress=i[0],this.remotePort=Number(i[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(e=>{"transport"===e.type&&e.selectedCandidatePairId&&o(r[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&o(e)}),a||Object.keys(r).length&&!Object.keys(n).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(t){return this.destroy(wb(t,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug("sent chunk from \"write before connect\"");const e=this._cb;this._cb=null,e(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(e,100)})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>wl||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(this.destroyed)return;let t=e.data;t instanceof ArrayBuffer&&(t=SC.from(t)),this.push(t)}_onChannelBufferedAmountLow(){if(this.destroyed||!this._cb)return;this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const e=this._cb;this._cb=null,e(null)}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),this._remoteStreams.some(e=>e.id===t.id)||(this._remoteStreams.push(t),jk(()=>{this._debug("on stream"),this.emit("stream",t)}))})}_debug(){const e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],RC.apply(null,e)}}Dg.WEBRTC_SUPPORT=!!lp(),Dg.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},Dg.channelConfig={},Hq=Dg;var WC={};WC=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then};var xl={},XC={}.toString;xl=Array.isArray||function(r){return"[object Array]"==XC.call(r)};var Rb={};function YC(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===r.foo()}catch(e){return!1}}kb.TYPED_ARRAY_SUPPORT=YC();var Jq=kb.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function kb(r,e,t){return kb.TYPED_ARRAY_SUPPORT||this instanceof kb?"number"==typeof r?Kq(this,r):dD(this,r,e,t):new kb(r,e,t)}function yl(r){if(r>=Jq)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Jq.toString(16)+" bytes");return 0|r}function ZC(r){return r!=r}function Eg(r,e){var t;return kb.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=kb.prototype:(null===(t=r)&&(t=new kb(e)),t.length=e),t}function Kq(r,e){var t=Eg(r,e<0?0:0|yl(e));if(!kb.TYPED_ARRAY_SUPPORT)for(var a=0;a<e;++a)t[a]=0;return t}function $C(r,e){var t=0|Mq(e),a=Eg(r,t),f=a.write(e);return f!==t&&(a=a.slice(0,f)),a}function zl(r,e){for(var t=e.length<0?0:0|yl(e.length),a=Eg(r,t),f=0;f<t;f+=1)a[f]=255&e[f];return a}function _C(r,e,t,a){if(t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+(a||0))throw new RangeError("'length' is out of bounds");var f;return f=void 0===t&&void 0===a?new Uint8Array(e):void 0===a?new Uint8Array(e,t):new Uint8Array(e,t,a),kb.TYPED_ARRAY_SUPPORT?f.__proto__=kb.prototype:f=zl(r,f),f}function aD(r,e){if(kb.isBuffer(e)){var t=0|yl(e.length),a=Eg(r,t);return 0===a.length?a:(e.copy(a,0,0,t),a)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||ZC(e.length)?Eg(r,0):zl(r,e);if("Buffer"===e.type&&Array.isArray(e.data))return zl(r,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Lq(r,e){var t;e=e||1/0;for(var a=r.length,f=null,$=[],n=0;n<a;++n){if((t=r.charCodeAt(n))>55295&&t<57344){if(!f){if(t>56319){(e-=3)>-1&&$.push(239,191,189);continue}if(n+1===a){(e-=3)>-1&&$.push(239,191,189);continue}f=t;continue}if(t<56320){(e-=3)>-1&&$.push(239,191,189),f=t;continue}t=65536+(f-55296<<10|t-56320)}else f&&(e-=3)>-1&&$.push(239,191,189);if(f=null,t<128){if((e-=1)<0)break;$.push(t)}else if(t<2048){if((e-=2)<0)break;$.push(t>>6|192,63&t|128)}else if(t<65536){if((e-=3)<0)break;$.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;$.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return $}function Mq(r){return kb.isBuffer(r)?r.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer)?r.byteLength:("string"!=typeof r&&(r=""+r),0===r.length?0:Lq(r).length)}function bD(r,e,t,a){for(var f=0;f<a&&!(f+t>=e.length||f>=r.length);++f)e[f+t]=r[f];return f}function cD(r,e,t,a){return bD(Lq(e,r.length-t),r,t,a)}function dD(r,e,t,a){if("number"==typeof e)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?_C(r,e,t,a):"string"==typeof e?$C(r,e,t):aD(r,e)}kb.TYPED_ARRAY_SUPPORT&&(kb.prototype.__proto__=Uint8Array.prototype,kb.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&kb[Symbol.species]===kb&&Object.defineProperty(kb,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),kb.prototype.write=function(r,e,t){void 0===e?(t=this.length,e=0):void 0===t&&"string"==typeof e?(t=this.length,e=0):isFinite(e)&&(e|=0,isFinite(t)?t|=0:t=void 0);var a=this.length-e;if((void 0===t||t>a)&&(t=a),r.length>0&&(t<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return cD(this,r,e,t)},kb.prototype.slice=function(r,e){var t,a=this.length;if((r=~~r)<0?(r+=a)<0&&(r=0):r>a&&(r=a),(e=void 0===e?a:~~e)<0?(e+=a)<0&&(e=0):e>a&&(e=a),e<r&&(e=r),kb.TYPED_ARRAY_SUPPORT)(t=this.subarray(r,e)).__proto__=kb.prototype;else{var f=e-r;t=new kb(f,void 0);for(var $=0;$<f;++$)t[$]=this[$+r]}return t},kb.prototype.copy=function(r,e,t,a){if(t||(t=0),a||0===a||(a=this.length),e>=r.length&&(e=r.length),e||(e=0),a>0&&a<t&&(a=t),a===t)return 0;if(0===r.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),r.length-e<a-t&&(a=r.length-e+t);var f,$=a-t;if(this===r&&t<e&&e<a)for(f=$-1;f>=0;--f)r[f+e]=this[f+t];else if($<1e3||!kb.TYPED_ARRAY_SUPPORT)for(f=0;f<$;++f)r[f+e]=this[f+t];else Uint8Array.prototype.set.call(r,this.subarray(t,t+$),e);return $},kb.prototype.fill=function(r,e,t){if("string"==typeof r){if("string"==typeof e?(e=0,t=this.length):"string"==typeof t&&(t=this.length),1===r.length){var a=r.charCodeAt(0);a<256&&(r=a)}}else"number"==typeof r&&(r&=255);if(e<0||this.length<e||this.length<t)throw new RangeError("Out of range index");if(t<=e)return this;var f;if(e>>>=0,t=void 0===t?this.length:t>>>0,r||(r=0),"number"==typeof r)for(f=e;f<t;++f)this[f]=r;else{var $=kb.isBuffer(r)?r:new kb(r),n=$.length;for(f=0;f<t-e;++f)this[f+e]=$[f%n]}return this},kb.concat=function(r,e){if(!xl(r))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===r.length)return Eg(null,0);var t;if(void 0===e)for(e=0,t=0;t<r.length;++t)e+=r[t].length;var a=Kq(null,e),f=0;for(t=0;t<r.length;++t){var $=r[t];if(!kb.isBuffer($))throw new TypeError("\"list\" argument must be an Array of Buffers");$.copy(a,f),f+=$.length}return a},kb.byteLength=Mq,kb.prototype._isBuffer=!0,kb.isBuffer=function(r){return!(null==r||!r._isBuffer)},Rb.alloc=function(r){var e=new kb(r);return e.fill(0),e},Rb.from=function(r){return new kb(r)};var Nq,eD=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],Al=function(o){if(!o)throw new Error("\"version\" cannot be null or undefined");if(o<1||o>40)throw new Error("\"version\" should be in range from 1 to 40");return 4*o+17};var Bl=function(o){return eD[o]};var Fg=function(o){for(var t=0;0!==o;)t++,o>>>=1;return t};var fD=function(o){if("function"!=typeof o)throw new Error("\"toSJISFunc\" is not a valid function.");Nq=o};var kk=function(){return void 0!==Nq};var gD=function(o){return Nq(o)};var Cl={bit:1};var Gg={bit:0};var Dl={bit:3};var El={bit:2};function hD(r){if("string"!=typeof r)throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return Cl;case"m":case"medium":return Gg;case"q":case"quartile":return Dl;case"h":case"high":return El;default:throw new Error("Unknown EC Level: "+r);}}var iD=function(r){return r&&void 0!==r.bit&&r.bit>=0&&r.bit<4};var Oq=function(r,$){if(iD(r))return r;try{return hD(r)}catch(t){return $}};var jD={};function Pq(){this.buffer=[],this.length=0}Pq.prototype={get:function(t){var r=Math.floor(t/8);return 1==(this.buffer[r]>>>7-t%8&1)},put:function(t,r){for(var f=0;f<r;f++)this.putBit(1==(t>>>r-f-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}},jD=Pq;var kD={};function mj(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=Rb.alloc(t*t),this.reservedBit=Rb.alloc(t*t)}mj.prototype.set=function(t,r,i,e){var $=t*this.size+r;this.data[$]=i,e&&(this.reservedBit[$]=!0)},mj.prototype.get=function(t,r){return this.data[t*this.size+r]},mj.prototype.xor=function(t,r,i){this.data[t*this.size+r]^=i},mj.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]},kD=mj;var lD=Al,mD=function(e){if(1===e)return[];for(var o=Math.floor(e/7)+2,r=lD(e),t=145===r?26:2*Math.ceil((r-13)/(2*o-2)),$=[r-7],s=1;s<o-1;s++)$[s]=$[s-1]-t;return $.push(6),$.reverse()};var nD=function(e){for(var o=[],r=mD(e),t=r.length,$=0;$<t;$++)for(var s=0;s<t;s++)0===$&&0===s||0===$&&s===t-1||$===t-1&&0===s||o.push([r[$],r[s]]);return o};var oD=Al,Qq=7,pD=function($){var o=oD($);return[[0,0],[o-Qq,0],[0,o-Qq]]};var vd={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var fg={N1:3,N2:3,N3:40,N4:10},qD=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7};var rD=function(t){return qD(t)?parseInt(t,10):void 0};var sD=function(t){for(var e=t.size,r=0,$=0,n=0,a=null,N=null,s=0;s<e;s++){$=n=0,a=N=null;for(var o=0;o<e;o++){var p=t.get(s,o);p===a?$++:($>=5&&(r+=fg.N1+($-5)),a=p,$=1),(p=t.get(o,s))===N?n++:(n>=5&&(r+=fg.N1+(n-5)),N=p,n=1)}$>=5&&(r+=fg.N1+($-5)),n>=5&&(r+=fg.N1+(n-5))}return r};var tD=function(t){for(var e=t.size,r=0,$=0;$<e-1;$++)for(var n=0;n<e-1;n++){var a=t.get($,n)+t.get($,n+1)+t.get($+1,n)+t.get($+1,n+1);4!==a&&0!==a||r++}return r*fg.N2};var uD=function(t){for(var e=t.size,r=0,$=0,n=0,a=0;a<e;a++){$=n=0;for(var N=0;N<e;N++)$=$<<1&2047|t.get(a,N),N>=10&&(1488===$||93===$)&&r++,n=n<<1&2047|t.get(N,a),N>=10&&(1488===n||93===n)&&r++}return r*fg.N3};var vD=function(t){for(var e=0,r=t.data.length,$=0;$<r;$++)e+=t.data[$];return Math.abs(Math.ceil(100*e/r/5)-10)*fg.N4};function wD(t,e,r){switch(t){case vd.PATTERN000:return(e+r)%2==0;case vd.PATTERN001:return e%2==0;case vd.PATTERN010:return r%3==0;case vd.PATTERN011:return(e+r)%3==0;case vd.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case vd.PATTERN101:return e*r%2+e*r%3==0;case vd.PATTERN110:return(e*r%2+e*r%3)%2==0;case vd.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t);}}var Fl=function(t,e){for(var r=e.size,$=0;$<r;$++)for(var n=0;n<r;n++)e.isReserved(n,$)||e.xor(n,$,wD(t,n,$))};var xD=function(t,e){for(var r=Object.keys(vd).length,$=0,n=1/0,a=0;a<r;a++){e(a),Fl(a,t);var N=sD(t)+tD(t)+uD(t)+vD(t);Fl(a,t),N<n&&(n=N,$=a)}return $};var lk=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],mk=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],yD=function(e,$){switch($){case Cl:return lk[4*(e-1)+0];case Gg:return lk[4*(e-1)+1];case Dl:return lk[4*(e-1)+2];case El:return lk[4*(e-1)+3];default:return;}};var Gl=function(e,$){switch($){case Cl:return mk[4*(e-1)+0];case Gg:return mk[4*(e-1)+1];case Dl:return mk[4*(e-1)+2];case El:return mk[4*(e-1)+3];default:return;}};var nj=Rb.alloc(512),Hl=Rb.alloc(256);!function(){for(var $=1,r=0;r<255;r++)nj[r]=$,Hl[$]=r,256&($<<=1)&&($^=285);for(r=255;r<512;r++)nj[r]=nj[r-255]}();var zD=function($){return nj[$]};var Rq=function($,r){return 0===$||0===r?0:nj[Hl[$]+Hl[r]]};var AD=function(r,$){for(var e=Rb.alloc(r.length+$.length-1),J=0;J<r.length;J++)for(var o=0;o<$.length;o++)e[J+o]^=Rq(r[J],$[o]);return e};var BD=function(r,$){for(var e=Rb.from(r);e.length-$.length>=0;){for(var J=e[0],o=0;o<$.length;o++)e[o]^=Rq($[o],J);for(var t=0;t<e.length&&0===e[t];)t++;e=e.slice(t)}return e};var CD=function(r){for(var $=Rb.from([1]),e=0;e<r;e++)$=AD($,[1,zD(e)]);return $};var DD={},ED=(Zd(),cd).Buffer;function Il(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}Il.prototype.initialize=function(e){this.degree=e,this.genPoly=CD(this.degree)},Il.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");var r=Rb.alloc(this.degree),o=ED.concat([e,r],e.length+this.degree),$=BD(o,this.genPoly),i=this.degree-$.length;if(i>0){var t=Rb.alloc(this.degree);return $.copy(t,i),t}return $},DD=Il;var nk=function($){return!isNaN($)&&$>=1&&$<=40};var Sq="[0-9]+",FD="[A-Z $%*+\\-./:]+",Jl="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",GD="(?:(?![A-Z0-9 $%*+\\-./:]|"+(Jl=Jl.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+",HD=new RegExp(Jl,"g");var ID=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");var JD=new RegExp(GD,"g");var KD=new RegExp(Sq,"g");var LD=new RegExp(FD,"g");var MD=new RegExp("^"+Jl+"$"),ND=new RegExp("^"+Sq+"$"),OD=new RegExp("^[A-Z0-9 $%*+\\-./:]+$"),PD=function($){return MD.test($)};var QD=function($){return ND.test($)};var RD=function($){return OD.test($)};var Id={id:"Numeric",bit:1,ccBits:[10,12,14]};var wd={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};var Mb={id:"Byte",bit:4,ccBits:[8,16,16]};var xd={id:"Kanji",bit:8,ccBits:[8,10,12]};var Tq={bit:-1};var Kl=function(r,$){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!nk($))throw new Error("Invalid version: "+$);return $>=1&&$<10?r.ccBits[0]:$<27?r.ccBits[1]:r.ccBits[2]};var SD=function(r){return QD(r)?Id:RD(r)?wd:PD(r)?xd:Mb};var Uq=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")};var TD=function(r){return r&&r.bit&&r.ccBits};function UD(r){if("string"!=typeof r)throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return Id;case"alphanumeric":return wd;case"kanji":return xd;case"byte":return Mb;default:throw new Error("Unknown mode: "+r);}}var VD=function(r,$){if(TD(r))return r;try{return UD(r)}catch(t){return $}};var Vq=7973,Wq=Fg(Vq);function WD(r,o,$){for(var e=1;e<=40;e++)if(o<=Yq(e,$,r))return e}function Xq(r,o){return Kl(r,o)+4}function XD(r,o){var $=0;return r.forEach(function(r){var e=Xq(r.mode,o);$+=e+r.getBitsLength()}),$}function YD(r,o){for(var $=1;$<=40;$++){if(XD(r,$)<=Yq($,o,Tq))return $}}var ZD=function(r,o){return nk(r)?parseInt(r,10):o};var Yq=function(r,o,$){if(!nk(r))throw new Error("Invalid QR Code version");void 0===$&&($=Mb);var e=8*(Bl(r)-Gl(r,o));if($===Tq)return e;var t=e-Xq($,r);switch($){case Id:return Math.floor(t/10*3);case wd:return Math.floor(t/11*2);case xd:return Math.floor(t/13);case Mb:default:return Math.floor(t/8);}};var Zq=function(r,o){var $,e=Oq(o,Gg);if(xl(r)){if(r.length>1)return YD(r,e);if(0===r.length)return 1;$=r[0]}else $=r;return WD($.mode,$.getLength(),e)};var $D=function(r){if(!nk(r)||r<7)throw new Error("Invalid QR Code version");for(var o=r<<12;Fg(o)-Wq>=0;)o^=Vq<<Fg(o)-Wq;return r<<12|o};var $q=1335,_D=21522,_q=Fg($q),aE=function($,a){for(var r=$.bit<<3|a,t=r<<10;Fg(t)-_q>=0;)t^=$q<<Fg(t)-_q;return(r<<10|t)^_D};var av={};function Hg(t){this.mode=Id,this.data=t.toString()}Hg.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},Hg.prototype.getLength=function(){return this.data.length},Hg.prototype.getBitsLength=function(){return Hg.getBitsLength(this.data.length)},Hg.prototype.write=function(t){var a,r,e;for(a=0;a+3<=this.data.length;a+=3)r=this.data.substr(a,3),e=parseInt(r,10),t.put(e,10);var $=this.data.length-a;$>0&&(r=this.data.substr(a),e=parseInt(r,10),t.put(e,3*$+1))},av=Hg;var bv={},Ll=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Ig(a){this.mode=wd,this.data=a}Ig.getBitsLength=function(a){return 11*Math.floor(a/2)+a%2*6},Ig.prototype.getLength=function(){return this.data.length},Ig.prototype.getBitsLength=function(){return Ig.getBitsLength(this.data.length)},Ig.prototype.write=function(a){var t;for(t=0;t+2<=this.data.length;t+=2){var $=45*Ll.indexOf(this.data[t]);$+=Ll.indexOf(this.data[t+1]),a.put($,11)}this.data.length%2&&a.put(Ll.indexOf(this.data[t]),6)},bv=Ig;var cv={};function Jg(t){this.mode=Mb,this.data=Rb.from(t)}Jg.getBitsLength=function(t){return 8*t},Jg.prototype.getLength=function(){return this.data.length},Jg.prototype.getBitsLength=function(){return Jg.getBitsLength(this.data.length)},Jg.prototype.write=function(t){for(var $=0,e=this.data.length;$<e;$++)t.put(this.data[$],8)},cv=Jg;var dv={};function Kg(t){this.mode=xd,this.data=t}Kg.getBitsLength=function(t){return 13*t},Kg.prototype.getLength=function(){return this.data.length},Kg.prototype.getBitsLength=function(){return Kg.getBitsLength(this.data.length)},Kg.prototype.write=function(t){var a;for(a=0;a<this.data.length;a++){var r=gD(this.data[a]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[a]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13)}},dv=Kg;var bE={},oj={single_source_shortest_paths:function(r,t,e){var s={},o={};o[t]=0;var u,i,a,n,h,p,$,f=oj.PriorityQueue.make();for(f.push(t,0);!f.empty();)for(a in i=(u=f.pop()).value,n=u.cost,h=r[i]||{})h.hasOwnProperty(a)&&(p=n+h[a],$=o[a],(void 0===o[a]||$>p)&&(o[a]=p,f.push(a,p),s[a]=i));if(void 0!==e&&void 0===o[e]){var v=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(v)}return s},extract_shortest_path_from_predecessor_list:function(r,t){for(var e=[],s=t;s;)e.push(s),r[s],s=r[s];return e.reverse(),e},find_path:function(r,t,e){var s=oj.single_source_shortest_paths(r,t,e);return oj.extract_shortest_path_from_predecessor_list(s,e)},PriorityQueue:{make:function(r){var t,e=oj.PriorityQueue,s={};for(t in r=r||{},e)e.hasOwnProperty(t)&&(s[t]=e[t]);return s.queue=[],s.sorter=r.sorter||e.default_sorter,s},default_sorter:function(r,t){return r.cost-t.cost},push:function(r,t){var e={value:r,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};bE=oj;function ev(e){return unescape(encodeURIComponent(e)).length}function pj(e,$,r){for(var a,t=[];null!==(a=e.exec(r));)t.push({data:a[0],index:a.index,mode:$,length:a[0].length});return t}function fv(e){var $,r,a=pj(KD,Id,e),t=pj(LD,wd,e);return kk()?($=pj(JD,Mb,e),r=pj(HD,xd,e)):($=pj(ID,Mb,e),r=[]),a.concat(t,$,r).sort(function(e,$){return e.index-$.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function Ml(e,$){switch($){case Id:return av.getBitsLength(e);case wd:return bv.getBitsLength(e);case xd:return dv.getBitsLength(e);case Mb:return cv.getBitsLength(e);}}function cE(e){return e.reduce(function(e,$){var r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===$.mode?(e[e.length-1].data+=$.data,e):(e.push($),e)},[])}function dE(e){for(var $=[],r=0;r<e.length;r++){var a=e[r];switch(a.mode){case Id:$.push([a,{data:a.data,mode:wd,length:a.length},{data:a.data,mode:Mb,length:a.length}]);break;case wd:$.push([a,{data:a.data,mode:Mb,length:a.length}]);break;case xd:$.push([a,{data:a.data,mode:Mb,length:ev(a.data)}]);break;case Mb:$.push([{data:a.data,mode:Mb,length:ev(a.data)}]);}}return $}function eE(e,$){for(var r={},a={start:{}},t=["start"],n=0;n<e.length;n++){for(var c=e[n],o=[],d=0;d<c.length;d++){var g=c[d],Q=""+n+d;o.push(Q),r[Q]={node:g,lastCount:0},a[Q]={};for(var V=0;V<t.length;V++){var i=t[V];r[i]&&r[i].node.mode===g.mode?(a[i][Q]=Ml(r[i].lastCount+g.length,g.mode)-Ml(r[i].lastCount,g.mode),r[i].lastCount+=g.length):(r[i]&&(r[i].lastCount=g.length),a[i][Q]=Ml(g.length,g.mode)+4+Kl(g.mode,$))}}t=o}for(V=0;V<t.length;V++)a[t[V]].end=0;return{map:a,table:r}}function gv(e,$){var r,a=SD(e);if((r=VD($,a))!==Mb&&r.bit<a.bit)throw new Error("\""+e+"\" cannot be encoded with mode "+Uq(r)+".\n Suggested mode is: "+Uq(a));switch(r!==xd||kk()||(r=Mb),r){case Id:return new av(e);case wd:return new bv(e);case xd:return new dv(e);case Mb:return new cv(e);}}var Nl=function(e){return e.reduce(function(e,$){return"string"==typeof $?e.push(gv($,null)):$.data&&e.push(gv($.data,$.mode)),e},[])};var fE=function(e,$){for(var r=eE(dE(fv(e,kk())),$),a=bE.find_path(r.map,"start","end"),t=[],n=1;n<a.length-1;n++)t.push(r.table[a[n]].node);return Nl(cE(t))};var gE=function(e){return Nl(fv(e,kk()))};function hE(r,e){for(var $=r.size,t=pD(e),i=0;i<t.length;i++)for(var a=t[i][0],o=t[i][1],n=-1;n<=7;n++)if(!(a+n<=-1||$<=a+n))for(var s=-1;s<=7;s++)o+s<=-1||$<=o+s||(n>=0&&n<=6&&(0===s||6===s)||s>=0&&s<=6&&(0===n||6===n)||n>=2&&n<=4&&s>=2&&s<=4?r.set(a+n,o+s,!0,!0):r.set(a+n,o+s,!1,!0))}function iE(r){for(var e=r.size,$=8;$<e-8;$++){var t=$%2==0;r.set($,6,t,!0),r.set(6,$,t,!0)}}function jE(r,e){for(var $=nD(e),t=0;t<$.length;t++)for(var i=$[t][0],a=$[t][1],o=-2;o<=2;o++)for(var n=-2;n<=2;n++)-2===o||2===o||-2===n||2===n||0===o&&0===n?r.set(i+o,a+n,!0,!0):r.set(i+o,a+n,!1,!0)}function kE(r,e){for(var $,t,i,a=r.size,o=$D(e),n=0;n<18;n++)$=Math.floor(n/3),t=n%3+a-8-3,i=1==(o>>n&1),r.set($,t,i,!0),r.set(t,$,i,!0)}function Ol(r,e,$){var t,i,a=r.size,o=aE(e,$);for(t=0;t<15;t++)i=1==(o>>t&1),t<6?r.set(t,8,i,!0):t<8?r.set(t+1,8,i,!0):r.set(a-15+t,8,i,!0),t<8?r.set(8,a-t-1,i,!0):t<9?r.set(8,15-t-1+1,i,!0):r.set(8,15-t-1,i,!0);r.set(a-8,8,1,!0)}function lE(r,e){for(var $=r.size,t=-1,i=$-1,a=7,o=0,n=$-1;n>0;n-=2)for(6===n&&n--;;){for(var s=0;s<2;s++)if(!r.isReserved(i,n-s)){var v=!1;o<e.length&&(v=1==(e[o]>>>a&1)),r.set(i,n-s,v),-1===--a&&(o++,a=7)}if((i+=t)<0||$<=i){i-=t,t=-t;break}}}function mE(r,e,$){var t=new jD;$.forEach(function(e){t.put(e.mode.bit,4),t.put(e.getLength(),Kl(e.mode,r)),e.write(t)});var i=8*(Bl(r)-Gl(r,e));for(t.getLengthInBits()+4<=i&&t.put(0,4);t.getLengthInBits()%8!=0;)t.putBit(0);for(var a=(i-t.getLengthInBits())/8,o=0;o<a;o++)t.put(o%2?17:236,8);return nE(t,r,e)}function nE(r,e,$){for(var t=Bl(e),i=t-Gl(e,$),a=yD(e,$),o=a-t%a,n=Math.floor(t/a),s=Math.floor(i/a),v=s+1,b=n-s,y=new DD(b),X=0,f=new Array(a),u=new Array(a),l=0,c=Rb.from(r.buffer),d=0;d<a;d++){var m=d<o?s:v;f[d]=c.slice(X,X+m),u[d]=y.encode(f[d]),X+=m,l=Math.max(l,m)}var p,g,C=Rb.alloc(t),h=0;for(p=0;p<l;p++)for(g=0;g<a;g++)p<f[g].length&&(C[h++]=f[g][p]);for(p=0;p<b;p++)for(g=0;g<a;g++)C[h++]=u[g][p];return C}function oE(r,e,$,t){var i;if(xl(r))i=Nl(r);else{if("string"!=typeof r)throw new Error("Invalid data");var a=e;if(!a){var o=gE(r);a=Zq(o,$)}i=fE(r,a||40)}var n=Zq(i,$);if(!n)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<n)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+n+".\n")}else e=n;var s=mE(e,$,i),v=Al(e),b=new kD(v);return hE(b,e),iE(b),jE(b,e),Ol(b,$,0),e>=7&&kE(b,e),lE(b,s),isNaN(t)&&(t=xD(b,Ol.bind(null,b,$))),Fl(t,b),Ol(b,$,t),{modules:b,version:e,errorCorrectionLevel:$,maskPattern:t,segments:i}}var hv=function(r,e){if(void 0===r||""===r)throw new Error("No input text");var $,t,i=Gg;return void 0!==e&&(i=Oq(e.errorCorrectionLevel,Gg),$=ZD(e.version),t=rD(e.maskPattern),e.toSJISFunc&&fD(e.toSJISFunc)),oE(r,$,i,t)};function iv(r){if("number"==typeof r&&(r=r.toString()),"string"!=typeof r)throw new Error("Color should be defined as hex string");var t=r.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+r);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map(function(r){return[r,r]}))),6===t.length&&t.push("F","F");var e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:255&e,hex:"#"+t.slice(0,6).join("")}}var jv=function(r){r||(r={}),r.color||(r.color={});var t=void 0===r.margin||null===r.margin||r.margin<0?4:r.margin,e=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:e,scale:e?4:o,margin:t,color:{dark:iv(r.color.dark||"#000000ff"),light:iv(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}};var kv=function(r,t){return t.width&&t.width>=r+2*t.margin?t.width/(r+2*t.margin):t.scale};var pE=function(r,t){var e=kv(r,t);return Math.floor((r+2*t.margin)*e)};var qE=function(r,t,e){for(var o=t.modules.size,a=t.modules.data,n=kv(o,e),i=Math.floor((o+2*e.margin)*n),$=e.margin*n,g=[e.color.light,e.color.dark],l=0;l<i;l++)for(var h=0;h<i;h++){var p=4*(l*i+h),c=e.color.light;if(l>=$&&h>=$&&l<i-$&&h<i-$)c=g[a[Math.floor((l-$)/n)*o+Math.floor((h-$)/n)]?1:0];r[p++]=c.r,r[p++]=c.g,r[p++]=c.b,r[p]=c.a}};function rE(e,t,r){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=r,t.width=r,t.style.height=r+"px",t.style.width=r+"px"}function sE(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}var lv=function(e,t,r){var a=r,o=t;void 0!==a||t&&t.getContext||(a=t,t=void 0),t||(o=sE()),a=jv(a);var $=pE(e.modules.size,a),n=o.getContext("2d"),i=n.createImageData($,$);return qE(i.data,e,a),rE(n,o,$),n.putImageData(i,0,0),o};var tE=function(e,t,r){var a=r;void 0!==a||t&&t.getContext||(a=t,t=void 0),a||(a={});var o=lv(e,t,a),$=a.type||"image/png",n=a.rendererOpts||{};return o.toDataURL($,n.quality)};function mv(r,t){var $=r.a/255,o=t+"=\""+r.hex+"\"";return $<1?o+" "+t+"-opacity=\""+$.toFixed(2).slice(1)+"\"":o}function Pl(r,t,$){var o=r+t;return void 0!==$&&(o+=" "+$),o}function uE(r,t,$){for(var o="",e=0,a=!1,i=0,v=0;v<r.length;v++){var n=Math.floor(v%t),l=Math.floor(v/t);n||a||(a=!0),r[v]?(i++,v>0&&n>0&&r[v-1]||(o+=a?Pl("M",n+$,.5+l+$):Pl("m",e,0),e=0,a=!1),n+1<t&&r[v+1]||(o+=Pl("h",i),i=0)):e++}return o}var vE=function(r,t,$){var o=jv(t),e=r.modules.size,a=r.modules.data,i=e+2*o.margin,v=o.color.light.a?"<path "+mv(o.color.light,"fill")+" d=\"M0 0h"+i+"v"+i+"H0z\"/>":"",n="<path "+mv(o.color.dark,"stroke")+" d=\""+uE(a,e,o.margin)+"\"/>",l="viewBox=\"0 0 "+i+" "+i+"\"",s="<svg xmlns=\"http://www.w3.org/2000/svg\" "+(o.width?"width=\""+o.width+"\" height=\""+o.width+"\" ":"")+l+" shape-rendering=\"crispEdges\">"+v+n+"</svg>\n";return"function"==typeof $&&$(null,s),s};function Ql(r,e,$,a,t){var n=[].slice.call(arguments,1),o=n.length,C="function"==typeof n[o-1];if(!C&&!WC())throw new Error("Callback required as last argument");if(!C){if(o<1)throw new Error("Too few arguments provided");return 1===o?($=e,e=a=void 0):2!==o||e.getContext||(a=$,$=e,e=void 0),new Promise(function(t,n){try{var o=hv($,a);t(r(o,e,a))}catch(C){n(C)}})}if(o<2)throw new Error("Too few arguments provided");2===o?(t=$,$=e,e=a=void 0):3===o&&(e.getContext&&void 0===t?(t=a,a=void 0):(t=a,a=$,$=e,e=void 0));try{var x=hv($,a);t(null,r(x,e,a))}catch(v){t(v)}}var wE=Ql.bind(null,lv);var c=Ql.bind(null,tE);var d=Ql.bind(null,function(r,e,$){return vE(r,$)});var ok={};var Rl={};var Lg;var xE=function(t,e){return(xE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function dd(t,e){function r(){this.constructor=t}xE(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var gg=function(){return gg=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},gg.apply(this,arguments)};function nv(t,e,r,o){return new(r||(r=Promise))(function(n,a){function $(t){try{x(o.next(t))}catch(e){a(e)}}function i(t){try{x(o.throw(t))}catch(e){a(e)}}function x(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then($,i)}x((o=o.apply(t,e||[])).next())})}function ov(t,e){var r,o,n,a,$={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;$;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return $.label++,{value:a[1],done:!1};case 5:$.label++,o=a[1],a=[0];continue;case 7:a=$.ops.pop(),$.trys.pop();continue;default:if(!(n=(n=$.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){$=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){$.label=a[1];break}if(6===a[0]&&$.label<n[1]){$.label=n[1],n=a;break}if(n&&$.label<n[2]){$.label=n[2],$.ops.push(a);break}n[2]&&$.ops.pop(),$.trys.pop();continue;}a=e.call(t,$)}catch(i){a=[6,i],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}function Sb(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function qj(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,a=r.call(t),$=[];try{for(;(void 0===e||e-->0)&&!(o=a.next()).done;)$.push(o.value)}catch(i){n={error:i}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return $}function hg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(qj(arguments[e]));return t}function pv(t){return this instanceof pv?(this.v=t,this):new pv(t)}var Sl={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},cb=function(e,r){if(!e)throw Mg(r)},Mg=function(e){return new Error("Firebase Database ("+Sl.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},qv=function(e){for(var r=[],t=0,o=0;o<e.length;o++){var i=e.charCodeAt(o);i<128?r[t++]=i:i<2048?(r[t++]=i>>6|192,r[t++]=63&i|128):55296==(64512&i)&&o+1<e.length&&56320==(64512&e.charCodeAt(o+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++o)),r[t++]=i>>18|240,r[t++]=i>>12&63|128,r[t++]=i>>6&63|128,r[t++]=63&i|128):(r[t++]=i>>12|224,r[t++]=i>>6&63|128,r[t++]=63&i|128)}return r},yE=function(e){for(var r=[],t=0,o=0;t<e.length;){var i=e[t++];if(i<128)r[o++]=String.fromCharCode(i);else if(i>191&&i<224){var n=e[t++];r[o++]=String.fromCharCode((31&i)<<6|63&n)}else if(i>239&&i<365){var $=((7&i)<<18|(63&(n=e[t++]))<<12|(63&(a=e[t++]))<<6|63&e[t++])-65536;r[o++]=String.fromCharCode(55296+($>>10)),r[o++]=String.fromCharCode(56320+(1023&$))}else{n=e[t++];var a=e[t++];r[o++]=String.fromCharCode((15&i)<<12|(63&n)<<6|63&a)}}return r.join("")},Tl={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,r){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var t=r?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[],i=0;i<e.length;i+=3){var n=e[i],$=i+1<e.length,a=$?e[i+1]:0,s=i+2<e.length,x=s?e[i+2]:0,p=n>>2,c=(3&n)<<4|a>>4,h=(15&a)<<2|x>>6,m=63&x;s||(m=64,$||(h=64)),o.push(t[p],t[c],t[h],t[m])}return o.join("")},encodeString:function(e,r){return this.HAS_NATIVE_SUPPORT&&!r?btoa(e):this.encodeByteArray(qv(e),r)},decodeString:function(e,r){return this.HAS_NATIVE_SUPPORT&&!r?atob(e):yE(this.decodeStringToByteArray(e,r))},decodeStringToByteArray:function(e,r){this.init_();for(var t=r?this.charToByteMapWebSafe_:this.charToByteMap_,o=[],i=0;i<e.length;){var n=t[e.charAt(i++)],$=i<e.length?t[e.charAt(i)]:0,a=++i<e.length?t[e.charAt(i)]:64,s=++i<e.length?t[e.charAt(i)]:64;if(++i,null==n||null==$||null==a||null==s)throw Error();var x=n<<2|$>>4;if(o.push(x),64!==a){var p=$<<4&240|a>>2;if(o.push(p),64!==s){var c=a<<6&192|s;o.push(c)}}}return o},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},zE=function(e){var r=qv(e);return Tl.encodeByteArray(r,!0)},rv=function(e){try{return Tl.decodeString(e,!0)}catch(r){console.error("base64Decode failed: ",r)}return null};function sv(e){return rj(void 0,e)}function rj(e,r){if(!(r instanceof Object))return r;switch(r.constructor){case Date:return new Date(r.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return r;}for(var t in r)r.hasOwnProperty(t)&&AE(t)&&(e[t]=rj(e[t],r[t]));return e}function AE(e){return"__proto__"!==e}var Tb=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(r,t){e.resolve=r,e.reject=t})}return e.prototype.wrapCallback=function(e){var r=this;return function(t,o){t?r.reject(t):r.resolve(o),"function"==typeof e&&(r.promise.catch(function(){}),1===e.length?e(t):e(t,o))}},e}();function BE(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function tv(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(BE())}function CE(){try{return"[object process]"===Object.prototype.toString.call(Vb.process)}catch(e){return!1}}function DE(){return"object"==typeof self&&self.self===self}function EE(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ld(){return!0===Sl.NODE_CLIENT||!0===Sl.NODE_ADMIN}var FE="FirebaseError",GE=function(e){function r(t,o,i){var n=e.call(this,o)||this;return n.code=t,n.customData=i,n.name=FE,Object.setPrototypeOf(n,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,Ul.prototype.create),n}return dd(r,e),r}(Error),Ul=function(){function e(e,r,t){this.service=e,this.serviceName=r,this.errors=t}return e.prototype.create=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var o=r[0]||{},i=this.service+"/"+e,n=this.errors[e],$=n?HE(n,o):"Error",a=this.serviceName+": "+$+" ("+i+").";return new GE(i,a,o)},e}();function HE(e,r){return e.replace(IE,function(e,t){var o=r[t];return null!=o?String(o):"<"+t+"?>"})}var IE=/\{\$([^}]+)}/g;function sj(e){return JSON.parse(e)}function Eb(e){return JSON.stringify(e)}var uv=function(e){var r={},t={},o={},i="";try{var n=e.split(".");r=sj(rv(n[0])||""),t=sj(rv(n[1])||""),i=n[2],o=t.d||{},delete t.d}catch($){}return{header:r,claims:t,data:o,signature:i}},JE=function(e){var r=uv(e).claims;return!!r&&"object"==typeof r&&r.hasOwnProperty("iat")},KE=function(e){var r=uv(e).claims;return"object"==typeof r&&!0===r.admin};function Ub(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function ed(e,r){return Object.prototype.hasOwnProperty.call(e,r)?e[r]:void 0}function Vl(e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function pk(e,r,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(o[i]=r.call(t,e[i],i,e));return o}function LE(e){for(var r=[],t=function(e,t){Array.isArray(t)?t.forEach(function(t){r.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}):r.push(encodeURIComponent(e)+"="+encodeURIComponent(t))},o=0,i=Object.entries(e);o<i.length;o++){var n=i[o];t(n[0],n[1])}return r.length?"&"+r.join("&"):""}var ME=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,r){r||(r=0);var t=this.W_;if("string"==typeof e)for(var o=0;o<16;o++)t[o]=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),r+=4;else for(o=0;o<16;o++)t[o]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r+=4;for(o=16;o<80;o++){var i=t[o-3]^t[o-8]^t[o-14]^t[o-16];t[o]=4294967295&(i<<1|i>>>31)}var n,$,a=this.chain_[0],s=this.chain_[1],x=this.chain_[2],p=this.chain_[3],c=this.chain_[4];for(o=0;o<80;o++){o<40?o<20?(n=p^s&(x^p),$=1518500249):(n=s^x^p,$=1859775393):o<60?(n=s&x|p&(s|x),$=2400959708):(n=s^x^p,$=3395469782);i=(a<<5|a>>>27)+n+c+$+t[o]&4294967295;c=p,p=x,x=4294967295&(s<<30|s>>>2),s=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+x&4294967295,this.chain_[3]=this.chain_[3]+p&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},e.prototype.update=function(e,r){if(null!=e){void 0===r&&(r=e.length);for(var t=r-this.blockSize,o=0,i=this.buf_,n=this.inbuf_;o<r;){if(0===n)for(;o<=t;)this.compress_(e,o),o+=this.blockSize;if("string"==typeof e){for(;o<r;)if(i[n]=e.charCodeAt(o),++o,++n===this.blockSize){this.compress_(i),n=0;break}}else for(;o<r;)if(i[n]=e[o],++o,++n===this.blockSize){this.compress_(i),n=0;break}}this.inbuf_=n,this.total_+=r}},e.prototype.digest=function(){var e=[],r=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var t=this.blockSize-1;t>=56;t--)this.buf_[t]=255&r,r/=256;this.compress_(this.buf_);var o=0;for(t=0;t<5;t++)for(var i=24;i>=0;i-=8)e[o]=this.chain_[t]>>i&255,++o;return e},e}();function NE(e,r){var t=new OE(e,r);return t.subscribe.bind(t)}var OE=function(){function e(e,r){var t=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(function(){e(t)}).catch(function(e){t.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(r){r.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(r){r.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,r,t){var o,i=this;if(void 0===e&&void 0===r&&void 0===t)throw new Error("Missing Observer.");void 0===(o=PE(e,["next","error","complete"])?e:{next:e,error:r,complete:t}).next&&(o.next=Wl),void 0===o.error&&(o.error=Wl),void 0===o.complete&&(o.complete=Wl);var n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?o.error(i.finalError):o.complete()}catch(e){}}),this.observers.push(o),n},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var r=0;r<this.observers.length;r++)this.sendOne(r,e)},e.prototype.sendOne=function(e,r){var t=this;this.task.then(function(){if(void 0!==t.observers&&void 0!==t.observers[e])try{r(t.observers[e])}catch(o){"undefined"!=typeof console&&console.error&&console.error(o)}})},e.prototype.close=function(e){var r=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){r.observers=void 0,r.onNoObservers=void 0}))},e}();function PE(e,r){if("object"!=typeof e||null===e)return!1;for(var t=0,o=r;t<o.length;t++){var i=o[t];if(i in e&&"function"==typeof e[i])return!0}return!1}function Wl(){}var eb=function(e,r,t,o){var i;if(o<r?i="at least "+r:o>t&&(i=0===t?"none":"no more than "+t),i)throw new Error(e+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+i+".")};function Zb(e,r,t){var o="";switch(r){case 1:o=t?"first":"First";break;case 2:o=t?"second":"Second";break;case 3:o=t?"third":"Third";break;case 4:o=t?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?");}var i=e+" failed: ";return i+=o+" argument "}function Ib(e,r,t,o){if((!o||t)&&"function"!=typeof t)throw new Error(Zb(e,r,o)+"must be a valid function.")}function vv(e,r,t,o){if((!o||t)&&("object"!=typeof t||null===t))throw new Error(Zb(e,r,o)+"must be a valid context object.")}var QE=function(e){for(var r=[],t=0,o=0;o<e.length;o++){var i=e.charCodeAt(o);if(i>=55296&&i<=56319){var n=i-55296;cb(++o<e.length,"Surrogate pair missing trail surrogate."),i=65536+(n<<10)+(e.charCodeAt(o)-56320)}i<128?r[t++]=i:i<2048?(r[t++]=i>>6|192,r[t++]=63&i|128):i<65536?(r[t++]=i>>12|224,r[t++]=i>>6&63|128,r[t++]=63&i|128):(r[t++]=i>>18|240,r[t++]=i>>12&63|128,r[t++]=i>>6&63|128,r[t++]=63&i|128)}return r},qk=function(e){for(var r=0,t=0;t<e.length;t++){var o=e.charCodeAt(t);o<128?r++:o<2048?r+=2:o>=55296&&o<=56319?(r+=4,t++):r+=3}return r};var tj=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),ig="[DEFAULT]",wv=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=ig);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Tb;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=gg({identifier:ig,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(s){if(r)return null;throw s}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,SE(t))try{this.getOrInitializeService(ig)}catch(c){}try{for(var r=Sb(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=qj(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var p=this.getOrInitializeService(u);a.resolve(p)}catch(c){}}}catch($){e={error:$}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=ig),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return nv(this,void 0,void 0,function(){var t;return ov(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(hg(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}),t.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()})))];case 1:return e.sent(),[2];}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=ig),this.instances.has(t)},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,RE(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:ig:t},t}();function RE(t){return t===ig?void 0:t}function SE(t){return"EAGER"===t.instantiationMode}var xv=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new wv(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();var TE,uj;function fd(){for(var e=0,r=0,o=arguments.length;r<o;r++)e+=arguments[r].length;var t=Array(e),$=0;for(r=0;r<o;r++)for(var p=arguments[r],l=0,n=p.length;l<n;l++,$++)t[$]=p[l];return t}var xb,Xl=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(xb||(TE=xb={},TE));var yv={debug:xb.DEBUG,verbose:xb.VERBOSE,info:xb.INFO,warn:xb.WARN,error:xb.ERROR,silent:xb.SILENT},UE=xb.INFO,VE=((uj={})[xb.DEBUG]="log",uj[xb.VERBOSE]="log",uj[xb.INFO]="info",uj[xb.WARN]="warn",uj[xb.ERROR]="error",uj),WE=function(e,r){for(var o=[],t=2;t<arguments.length;t++)o[t-2]=arguments[t];if(!(r<e.logLevel)){var $=new Date().toISOString(),p=VE[r];if(!p)throw new Error("Attempted to log a message with an invalid logType (value: "+r+")");console[p].apply(console,fd(["["+$+"]  "+e.name+":"],o))}},zv=function(){function e(e){this.name=e,this._logLevel=UE,this._logHandler=WE,this._userLogHandler=null,Xl.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in xb))throw new TypeError("Invalid value \""+e+"\" assigned to `logLevel`");this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?yv[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,fd([this,xb.DEBUG],e)),this._logHandler.apply(this,fd([this,xb.DEBUG],e))},e.prototype.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,fd([this,xb.VERBOSE],e)),this._logHandler.apply(this,fd([this,xb.VERBOSE],e))},e.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,fd([this,xb.INFO],e)),this._logHandler.apply(this,fd([this,xb.INFO],e))},e.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,fd([this,xb.WARN],e)),this._logHandler.apply(this,fd([this,xb.WARN],e))},e.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,fd([this,xb.ERROR],e)),this._logHandler.apply(this,fd([this,xb.ERROR],e))},e}();function XE(e){Xl.forEach(function(r){r.setLogLevel(e)})}function YE(e,r){for(var o=function(o){var t=null;r&&r.level&&(t=yv[r.level]),o.userLogHandler=null===e?null:function(r,o){for(var $=[],p=2;p<arguments.length;p++)$[p-2]=arguments[p];var l=$.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(function(e){return e}).join(" ");o>=(null!=t?t:r.logLevel)&&e({level:xb[o].toLowerCase(),message:l,args:$,type:r.name})}},t=0,$=Xl;t<$.length;t++){o($[t])}}var Av,ZE=((Lg={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Lg["bad-app-name"]="Illegal App name: '{$appName}",Lg["duplicate-app"]="Firebase App named '{$appName}' already exists",Lg["app-deleted"]="Firebase App named '{$appName}' already deleted",Lg["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Lg["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Lg),Ng=new Ul("app","Firebase",ZE),Bv="@firebase/app",$E="0.6.15",rk="[DEFAULT]",_E=((Av={})[Bv]="fire-core",Av["fire-js"]="fire-js",Av),Og=new zv("@firebase/app"),sk=function(){function e(e,r,a){var n=this;this.firebase_=a,this.isDeleted_=!1,this.name_=r.name,this.automaticDataCollectionEnabled_=r.automaticDataCollectionEnabled||!1,this.options_=sv(e),this.container=new xv(r.name),this._addComponent(new tj("app",function(){return n},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(e){return n._addComponent(e)})}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(r){e.checkDestroyed_(),r()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,r){return void 0===r&&(r=rk),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:r})},e.prototype._removeServiceInstance=function(e,r){void 0===r&&(r=rk),this.container.getProvider(e).clearInstance(r)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(r){Og.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,r)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Ng.create("app-deleted",{appName:this.name_})},e}();sk.prototype.name&&sk.prototype.options||sk.prototype.delete||console.log("dc");var aF="8.2.9";function bF(e){var r={},a=new Map,n={__esModule:!0,initializeApp:function(a,t){void 0===t&&(t={});if("object"!=typeof t||null===t){var $=t;t={name:$}}var i=t;void 0===i.name&&(i.name=rk);var o=i.name;if("string"!=typeof o||!o)throw Ng.create("bad-app-name",{appName:String(o)});if(Ub(r,o))throw Ng.create("duplicate-app",{appName:o});var s=new e(a,i,n);return r[o]=s,s},app:t,registerVersion:function(e,r,a){var n,t=null!==(n=_E[e])&&void 0!==n?n:e;a&&(t+="-"+a);var i=t.match(/\s|\//),o=r.match(/\s|\//);if(i||o){var s=["Unable to register library \""+t+"\" with version \""+r+"\":"];return i&&s.push("library name \""+t+"\" contains illegal characters (whitespace or \"/\")"),i&&o&&s.push("and"),o&&s.push("version name \""+r+"\" contains illegal characters (whitespace or \"/\")"),void Og.warn(s.join(" "))}$(new tj(t+"-version",function(){return{library:t,version:r}},"VERSION"))},setLogLevel:XE,onLog:function(e,r){if(null!==e&&"function"!=typeof e)throw Ng.create("invalid-log-argument");YE(e,r)},apps:null,SDK_VERSION:aF,INTERNAL:{registerComponent:$,removeApp:function(e){delete r[e]},components:a,useAsService:function(e,r){if("serverAuth"===r)return null;return r}}};function t(e){if(e=e||rk,!Ub(r,e))throw Ng.create("no-app",{appName:e});return r[e]}function $($){var i=$.name;if(a.has(i))return Og.debug("There were multiple attempts to register component "+i+"."),"PUBLIC"===$.type?n[i]:null;if(a.set(i,$),"PUBLIC"===$.type){var o=function(e){if(void 0===e&&(e=t()),"function"!=typeof e[i])throw Ng.create("invalid-app-argument",{appName:i});return e[i]()};void 0!==$.serviceProps&&rj(o,$.serviceProps),n[i]=o,e.prototype[i]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this._getService.bind(this,i).apply(this,$.multipleInstances?e:[])}}for(var s=0,p=Object.keys(r);s<p.length;s++){var c=p[s];r[c]._addComponent($)}return"PUBLIC"===$.type?n[i]:null}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(r).map(function(e){return r[e]})}}),t.App=e,n}function Cv(){var e=bF(sk);return e.INTERNAL=gg(gg({},e.INTERNAL),{createFirebaseNamespace:Cv,extendNamespace:function(r){rj(e,r)},createSubscribe:NE,ErrorFactory:Ul,deepExtend:rj}),e}var Yl=Cv(),cF=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(dF(e)){var r=e.getImmediate();return r.library+"/"+r.version}return null}).filter(function(e){return e}).join(" ")},e}();function dF(e){var r=e.getComponent();return"VERSION"===(null==r?void 0:r.type)}function eF(e,r){e.INTERNAL.registerComponent(new tj("platform-logger",function(e){return new cF(e)},"PRIVATE")),e.registerVersion(Bv,$E,r),e.registerVersion("fire-js","")}if(DE()&&void 0!==self.firebase){Og.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Dv=self.firebase.SDK_VERSION;Dv&&Dv.indexOf("LITE")>=0&&Og.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var fF=Yl.initializeApp;Yl.initializeApp=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return CE()&&Og.warn("\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the \"main\" field in package.json.\n      \n      If you are using Webpack, you can specify \"main\" as the first item in\n      \"resolve.mainFields\":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify \"main\"\n      as the first item in \"mainFields\", e.g. ['main', 'module'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      "),fF.apply(void 0,e)};var fb=Yl;eF(fb);Rl.default=fb;var gF="firebase",hF="8.2.9";fb.registerVersion(gF,hF,"app");(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var n=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Vb&&Vb,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function i(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function r(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:i(t)}}!function(t,i){if(i){var r=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(i=i(o=r[t=t[t.length-1]]))!=o&&null!=i&&e(r,t,{configurable:!0,writable:!0,value:i})}}("Promise",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function i(){this.a=null}function o(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;i.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var a=n.setTimeout;i.prototype.c=function(t){a(t,0)},i.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(i){this.f(i)}}}this.a=null},i.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(i){n||(n=!0,t.call(e,i))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1;}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new i;return e.prototype.s=function(t){var e=this.f();t.Qa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(i){n.reject(i)}},e.prototype.then=function(t,n){function i(t,e){return"function"==typeof t?function(e){try{r(t(e))}catch(n){o(n)}}:e}var r,o,a=new e(function(t,e){r=t,o=e});return this.Qa(i(t,r),i(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Qa=function(t,e){function n(){switch(i.b){case 1:t(i.c);break;case 2:e(i.c);break;default:throw Error("Unexpected state: "+i.b);}}var i=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=o,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=r(t),a=i.next();!a.done;a=i.next())o(a.value).Qa(e,n)})},e.all=function(t){var n=r(t),i=n.next();return i.done?o([]):new e(function(t,e){function r(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,o(i.value).Qa(r(a.length-1),e),i=n.next()}while(!i.done)})},e});var o=o||{},a=this||self,s=/^[\w+/_-]+[=]{0,2}$/,u=null;function c(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&s.test(t)?t:""}function h(){}function f(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function l(t){var e=f(t);return"array"==e||"object"==e&&"number"==typeof t.length}function d(t){return"function"==f(t)}function p(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function v(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++g)}var m="closure_uid_"+(1e9*Math.random()>>>0),g=0;function b(t,e,n){return t.call.apply(t.bind,arguments)}function y(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function w(t,e,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:y).apply(null,arguments)}function I(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var T=Date.now;function k(t,e){function n(){}n.prototype=e.prototype,t.ab=e.prototype,t.prototype=new n,t.prototype.constructor=t}function E(t){return t}function A(t,e,n){this.code=_+t,this.message=e||O[t]||"",this.a=n||null}function S(t){var e=t&&t.code;return e?new A(e.substring(_.length),t.message,t.serverResponse):null}k(A,Error),A.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},A.prototype.toJSON=function(){return this.w()};var N,_="auth/",O={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":"This operation is not supported in the environment this application is running on. \"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.","popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},C={ld:{Ta:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ta:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://securetoken.googleapis.com/v1/token",Wa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ta:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ta:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Za:"https://test-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function R(t){for(var e in C)if(C[e].id===t)return{firebaseEndpoint:(t=C[e]).Ta,secureTokenEndpoint:t.Za,identityPlatformEndpoint:t.Wa};return null}function P(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function D(t){if(Error.captureStackTrace)Error.captureStackTrace(this,D);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function L(t,e){for(var n="",i=(t=t.split("%s")).length-1,r=0;r<i;r++)n+=t[r]+(r<e.length?e[r]:"%s");D.call(this,n+t[i])}function x(t,e){throw new L("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function M(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function j(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function F(){this.b=this.a=null}N=R("__EID__")?"__EID__":void 0,k(D,Error),D.prototype.name="CustomError",k(L,D),L.prototype.name="AssertionError",M.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var U=new M(function(){return new $},function(t){t.reset()});function V(){var t=ye,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function $(){this.next=this.b=this.a=null}F.prototype.add=function(t,e){var n=U.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},$.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},$.prototype.reset=function(){this.next=this.b=this.a=null};var q=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},K=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};var H=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=[],r=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(i[r++]=s)}return i},G=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=Array(n),r="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in r&&(i[o]=e.call(void 0,r[o],o,t));return i},B=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t))return!0;return!1};function W(t,e){return 0<=q(t,e)}function X(t,e){var n;return(n=0<=(e=q(t,e)))&&Array.prototype.splice.call(t,e,1),n}function J(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,i=t.length-1;0<=i;--i)i in n&&e.call(void 0,n[i],i,t)}(t,function(n,i){e.call(void 0,n,i,t)&&1==Array.prototype.splice.call(t,i,1).length&&0})}function Y(t){return Array.prototype.concat.apply([],arguments)}function z(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}var Z,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return /^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},tt=/&/g,et=/</g,nt=/>/g,it=/"/g,rt=/'/g,ot=/\x00/g,at=/[\x00&<>"']/;function st(t,e){return-1!=t.indexOf(e)}function ut(t,e){return t<e?-1:t>e?1:0}t:{var ct=a.navigator;if(ct){var ht=ct.userAgent;if(ht){Z=ht;break t}}Z=""}function ft(t){return st(Z,t)}function lt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function dt(t){for(var e in t)return!1;return!0}function pt(t){var e,n={};for(e in t)n[e]=t[e];return n}var vt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<vt.length;o++)n=vt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function gt(t,e){t:{try{var n=t&&t.ownerDocument,i=n&&(n.defaultView||n.parentWindow);if((i=i||a).Element&&i.Location){var r=i;break t}}catch(s){}r=null}if(r&&void 0!==r[e]&&(!t||!(t instanceof r[e])&&(t instanceof r.Location||t instanceof r.Element))){if(p(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(s){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;x("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function bt(t,e){this.a=t===Tt&&e||"",this.b=It}function yt(t){return t instanceof bt&&t.constructor===bt&&t.b===It?t.a:(x("expected object of type Const, got '"+t+"'"),"type_error:Const")}bt.prototype.sa=!0,bt.prototype.ra=function(){return this.a},bt.prototype.toString=function(){return"Const{"+this.a+"}"};var wt,It={},Tt={};function kt(){if(void 0===wt){var t=null,e=a.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:E,createScript:E,createScriptURL:E})}catch(n){a.console&&a.console.error(n.message)}wt=t}else wt=t}return wt}function Et(t,e){this.a=e===Ot?t:""}function At(t){return t instanceof Et&&t.constructor===Et?t.a:(x("expected object of type TrustedResourceUrl, got '"+t+"' of type "+f(t)),"type_error:TrustedResourceUrl")}function St(t,e){var n=yt(t);if(!_t.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=kt();return new Et(t=e?e.createScriptURL(t):t,Ot)}(t=n.replace(Nt,function(t,i){if(!Object.prototype.hasOwnProperty.call(e,i))throw Error("Found marker, \""+i+"\", in format string, \""+n+"\", but no valid label mapping found in args: "+JSON.stringify(e));return(t=e[i])instanceof bt?yt(t):encodeURIComponent(String(t))}))}Et.prototype.sa=!0,Et.prototype.ra=function(){return this.a.toString()},Et.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Nt=/%{(\w+)}/g,_t=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Ot={};function Ct(t,e){this.a=e===jt?t:""}function Rt(t){return t instanceof Ct&&t.constructor===Ct?t.a:(x("expected object of type SafeUrl, got '"+t+"' of type "+f(t)),"type_error:SafeUrl")}Ct.prototype.sa=!0,Ct.prototype.ra=function(){return this.a.toString()},Ct.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Pt=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Dt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Lt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function xt(t){if(t instanceof Ct)return t;if(t="object"==typeof t&&t.sa?t.ra():String(t),Lt.test(t))t=new Ct(t,jt);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(Dt);t=e&&Pt.test(e[1])?new Ct(t,jt):null}return t}function Mt(t){return t instanceof Ct?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Lt.test(t)||(t="about:invalid#zClosurez"),new Ct(t,jt))}var jt={},Ft=new Ct("about:invalid#zClosurez",jt);function Ut(t,e,n){this.a=n===Vt?t:""}Ut.prototype.sa=!0,Ut.prototype.ra=function(){return this.a.toString()},Ut.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Vt={};function $t(t,e,n,i){return t=t instanceof Ct?t:Mt(t),e=e||a,n=n instanceof bt?yt(n):n||"",e.open(Rt(t),n,i,void 0)}function qt(t,e){for(var n=t.split("%s"),i="",r=Array.prototype.slice.call(arguments,1);r.length&&1<n.length;)i+=n.shift()+r.shift();return i+n.join("%s")}function Kt(t){return at.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(tt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(et,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(nt,"&gt;")),-1!=t.indexOf("\"")&&(t=t.replace(it,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(rt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(ot,"&#0;"))),t}function Ht(t){return Ht[" "](t),t}Ht[" "]=h;var Gt,Bt,Wt=ft("Opera"),Xt=ft("Trident")||ft("MSIE"),Jt=ft("Edge"),Yt=Jt||Xt,zt=ft("Gecko")&&!(st(Z.toLowerCase(),"webkit")&&!ft("Edge"))&&!(ft("Trident")||ft("MSIE"))&&!ft("Edge"),Zt=st(Z.toLowerCase(),"webkit")&&!ft("Edge");function Qt(){var t=a.document;return t?t.documentMode:void 0}t:{var te="",ee=(Bt=Z,zt?/rv:([^\);]+)(\)|;)/.exec(Bt):Jt?/Edge\/([\d\.]+)/.exec(Bt):Xt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Bt):Zt?/WebKit\/(\S+)/.exec(Bt):Wt?/(?:Version)[ \/]?(\S+)/.exec(Bt):void 0);if(ee&&(te=ee?ee[1]:""),Xt){var ne=Qt();if(null!=ne&&ne>parseFloat(te)){Gt=String(ne);break t}}Gt=te}var ie,re={};function oe(t){return function(t,e){var n=re;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=Q(String(Gt)).split("."),i=Q(String(t)).split("."),r=Math.max(n.length,i.length),o=0;0==e&&o<r;o++){var a=n[o]||"",s=i[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=ut(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||ut(0==a[2].length,0==s[2].length)||ut(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}if(a.document&&Xt){var ae=Qt();ie=ae||parseInt(Gt,10)||void 0}else ie=void 0;var se=ie;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Bt){}var ue=!Xt||9<=Number(se);function ce(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function he(t,e){lt(e,function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:de.hasOwnProperty(n)?t.setAttribute(de[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}var fe,le,de={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function pe(t,e,n){var i=arguments,r=document,o=String(i[0]),a=i[1];if(!ue&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(" name=\"",Kt(a.name),"\""),a.type){o.push(" type=\"",Kt(a.type),"\"");var s={};mt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=ve(r,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):he(o,a)),2<i.length&&function(t,e,n){function i(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var r=2;r<n.length;r++){var o=n[r];if(!l(o)||p(o)&&0<o.nodeType)i(o);else{t:{if(o&&"number"==typeof o.length){if(p(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(d(o)){a="function"==typeof o.item;break t}}a=!1}K(a?z(o):o,i)}}}(r,o,i),o}function ve(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function me(t){a.setTimeout(function(){throw t},0)}function ge(t,e){le||function(){if(a.Promise&&a.Promise.resolve){var t=a.Promise.resolve(void 0);le=function(){t.then(we)}}else le=function(){var t=we;!d(a.setImmediate)||a.Window&&a.Window.prototype&&!ft("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(fe||(fe=function(){var t=a.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ft("Presto")&&(t=function(){var t=ve(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=w(function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),void 0!==t&&!ft("Trident")&&!ft("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Gb;n.Gb=null,t()}},function(t){i.next={Gb:t},i=i.next,e.port2.postMessage(0)}}return function(t){a.setTimeout(t,0)}}()),fe(t)):a.setImmediate(t)}}(),be||(le(),be=!0),ye.add(t,e)}var be=!1,ye=new F;function we(){for(var t;t=V();){try{t.a.call(t.b)}catch(e){me(e)}j(U,t)}be=!1}function Ie(t,e){if(this.a=Te,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=h)try{var n=this;t.call(e,function(t){Le(n,ke,t)},function(t){if(!(t instanceof $e))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}Le(n,Ee,t)})}catch(i){Le(this,Ee,i)}}var Te=0,ke=2,Ee=3;function Ae(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Ae.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Se=new M(function(){return new Ae},function(t){t.reset()});function Ne(t,e,n){var i=Se.get();return i.g=t,i.b=e,i.f=n,i}function _e(t){if(t instanceof Ie)return t;var e=new Ie(h);return Le(e,ke,t),e}function Oe(t){return new Ie(function(e,n){n(t)})}function Ce(t,e,n){xe(t,e,n,null)||ge(I(e,t))}function Re(t){return new Ie(function(e){var n=t.length,i=[];if(n)for(var r=function(t,r,o){n--,i[t]=r?{Pb:!0,value:o}:{Pb:!1,reason:o},0==n&&e(i)},o=0;o<t.length;o++)Ce(t[o],I(r,o,!0),I(r,o,!1));else e(i)})}function Pe(t,e){t.b||t.a!=ke&&t.a!=Ee||Me(t),t.f?t.f.next=e:t.b=e,t.f=e}function De(t,e,n,i){var r=Ne(null,null,null);return r.a=new Ie(function(t,o){r.g=e?function(n){try{var r=e.call(i,n);t(r)}catch(a){o(a)}}:t,r.b=n?function(e){try{var r=n.call(i,e);void 0===r&&e instanceof $e?o(e):t(r)}catch(a){o(a)}}:o}),r.a.c=t,Pe(t,r),r.a}function Le(t,e,n){t.a==Te&&(t===n&&(e=Ee,n=new TypeError("Promise cannot resolve to itself")),t.a=1,xe(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,Me(t),e!=Ee||n instanceof $e||function(t,e){t.g=!0,ge(function(){t.g&&Ve.call(null,e)})}(t,n)))}function xe(t,e,n,i){if(t instanceof Ie)return Pe(t,Ne(e||h,n||null,i)),!0;if(P(t))return t.then(e,n,i),!0;if(p(t))try{var r=t.then;if(d(r))return function(t,e,n,i,r){function o(t){a||(a=!0,i.call(r,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(r,t))},o)}catch(s){o(s)}}(t,r,e,n,i),!0}catch(o){return n.call(i,o),!0}return!1}function Me(t){t.h||(t.h=!0,ge(t.gc,t))}function je(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Fe(t,e,n,i){if(n==Ee&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Ue(e,n,i);else try{e.c?e.g.call(e.f):Ue(e,n,i)}catch(r){Ve.call(null,r)}j(Se,e)}function Ue(t,e,n){e==ke?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Ie.prototype.then=function(t,e,n){return De(this,d(t)?t:null,d(e)?e:null,n)},Ie.prototype.$goog_Thenable=!0,(t=Ie.prototype).oa=function(t,e){return(t=Ne(t,t,e)).c=!0,Pe(this,t),this},t.o=function(t,e){return De(this,null,t,e)},t.cancel=function(t){if(this.a==Te){var e=new $e(t);ge(function(){!function t(e,n){if(e.a==Te)if(e.c){var i=e.c;if(i.b){for(var r=0,o=null,a=null,s=i.b;s&&(s.c||(r++,s.a==e&&(o=s),!(o&&1<r)));s=s.next)o||(a=s);o&&(i.a==Te&&1==r?t(i,n):(a?((r=a).next==i.f&&(i.f=r),r.next=r.next.next):je(i),Fe(i,o,Ee,n)))}e.c=null}else Le(e,Ee,n)}(this,e)},this)}},t.$c=function(t){this.a=Te,Le(this,ke,t)},t.ad=function(t){this.a=Te,Le(this,Ee,t)},t.gc=function(){for(var t;t=je(this);)Fe(this,t,this.a,this.i);this.h=!1};var Ve=me;function $e(t){D.call(this,t)}function qe(){0!=Ke&&(He[v(this)]=this),this.xa=this.xa,this.pa=this.pa}k($e,D),$e.prototype.name="cancel";var Ke=0,He={};function Ge(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=Ke)){var e=v(t);if(0!=Ke&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete He[e]}}qe.prototype.xa=!1,qe.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Be=Object.freeze||function(t){return t},We=!Xt||9<=Number(se),Xe=Xt&&!oe("9"),Je=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",h,e),a.removeEventListener("test",h,e)}catch(n){}return t}();function Ye(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function ze(t,e){if(Ye.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(zt){t:{try{Ht(e.nodeName);var r=!0;break t}catch(o){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Ze[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ye.prototype.preventDefault=function(){this.defaultPrevented=!0},k(ze,Ye);var Ze=Be({2:"touch",3:"pen",4:"mouse"});ze.prototype.preventDefault=function(){ze.ab.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Xe)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},ze.prototype.g=function(){return this.a};var Qe="closure_listenable_"+(1e6*Math.random()|0),tn=0;function en(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.Va=r,this.key=++tn,this.va=this.Pa=!1}function nn(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Va=null}function rn(t){this.src=t,this.a={},this.b=0}function on(t,e){var n=e.type;n in t.a&&X(t.a[n],e)&&(nn(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function an(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Va==i)return r}return-1}rn.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=an(t,e,i,r);return-1<a?(e=t[a],n||(e.Pa=!1)):((e=new en(e,this.src,o,!!i,r)).Pa=n,t.push(e)),e};var sn="closure_lm_"+(1e6*Math.random()|0),un={};function cn(t,e,n,i,r){if(i&&i.once)fn(t,e,n,i,r);else if(Array.isArray(e))for(var o=0;o<e.length;o++)cn(t,e[o],n,i,r);else n=wn(n),t&&t[Qe]?Tn(t,e,n,p(i)?!!i.capture:!!i,r):hn(t,e,n,!1,i,r)}function hn(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var a=p(r)?!!r.capture:!!r,s=bn(t);if(s||(t[sn]=s=new rn(t)),!(n=s.add(e,n,i,a,o)).proxy){if(i=function(){var t=gn,e=We?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Je||(r=a),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(pn(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}0}}function fn(t,e,n,i,r){if(Array.isArray(e))for(var o=0;o<e.length;o++)fn(t,e[o],n,i,r);else n=wn(n),t&&t[Qe]?kn(t,e,n,p(i)?!!i.capture:!!i,r):hn(t,e,n,!0,i,r)}function ln(t,e,n,i,r){if(Array.isArray(e))for(var o=0;o<e.length;o++)ln(t,e[o],n,i,r);else i=p(i)?!!i.capture:!!i,n=wn(n),t&&t[Qe]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=an(o=t.a[e],n,i,r))&&(nn(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=bn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=an(e,n,i,r)),(n=-1<t?e[t]:null)&&dn(n))}function dn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[Qe])on(e.v,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(pn(n),i):e.addListener&&e.removeListener&&e.removeListener(i),0,(n=bn(e))?(on(n,t),0==n.b&&(n.src=null,e[sn]=null)):nn(t)}}}function pn(t){return t in un?un[t]:un[t]="on"+t}function vn(t,e,n,i){var r=!0;if((t=bn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=mn(o,i),r=r&&!1!==o)}return r}function mn(t,e){var n=t.listener,i=t.Va||t.src;return t.Pa&&dn(t),n.call(i,e)}function gn(t,e){if(t.va)return!0;if(!We){if(!e)t:{e=["window","event"];for(var n=a,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}if(e=new ze(i=e,this),n=!0,!(0>i.keyCode||null!=i.returnValue)){t:{var r=!1;if(0==i.keyCode)try{i.keyCode=-1;break t}catch(s){r=!0}(r||null==i.returnValue)&&(i.returnValue=!0)}for(i=[],r=e.b;r;r=r.parentNode)i.push(r);for(t=t.type,r=i.length-1;0<=r;r--){e.b=i[r];var o=vn(i[r],t,!0,e);n=n&&o}for(r=0;r<i.length;r++)e.b=i[r],o=vn(i[r],t,!1,e),n=n&&o}return n}return mn(t,new ze(e,this))}function bn(t){return(t=t[sn])instanceof rn?t:null}var yn="__closure_events_fn_"+(1e9*Math.random()>>>0);function wn(t){return d(t)?t:(t[yn]||(t[yn]=function(e){return t.handleEvent(e)}),t[yn])}function In(){qe.call(this),this.v=new rn(this),this.ac=this,this.gb=null}function Tn(t,e,n,i,r){t.v.add(String(e),n,!1,i,r)}function kn(t,e,n,i,r){t.v.add(String(e),n,!0,i,r)}function En(t,e,n,i){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.va&&a.capture==n){var s=a.listener,u=a.Va||a.src;a.Pa&&on(t.v,a),r=!1!==s.call(u,i)&&r}}return r&&!i.defaultPrevented}function An(t,e,n){if(d(t))n&&(t=w(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=w(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function Sn(t){var e=null;return new Ie(function(n,i){-1==(e=An(function(){n(void 0)},t))&&i(Error("Failed to schedule timer."))}).o(function(t){throw a.clearTimeout(e),t})}function Nn(t){if(t.W&&"function"==typeof t.W)return t.W();if("string"==typeof t)return t.split("");if(l(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}function _n(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.W||"function"!=typeof t.W){if(l(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var i in e=[],n=0,t)e[n++]=i;return e}}function On(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof On)for(n=t.Y(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Cn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Rn(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Rn(r,i=t.a[e])||(t.a[n++]=i,r[i]=1),e++;t.a.length=n}}function Rn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}k(In,qe),In.prototype[Qe]=!0,In.prototype.addEventListener=function(t,e,n,i){cn(this,t,e,n,i)},In.prototype.removeEventListener=function(t,e,n,i){ln(this,t,e,n,i)},In.prototype.dispatchEvent=function(t){var e,n=this.gb;if(n)for(e=[];n;n=n.gb)e.push(n);n=this.ac;var i=t.type||t;if("string"==typeof t)t=new Ye(t,n);else if(t instanceof Ye)t.target=t.target||n;else{var r=t;mt(t=new Ye(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];r=En(a,i,!0,t)&&r}if(r=En(a=t.b=n,i,!0,t)&&r,r=En(a,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=En(a=t.b=e[o],i,!1,t)&&r;return r},In.prototype.Da=function(){if(In.ab.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)0,nn(n[i]);delete e.a[t],e.b--}}this.gb=null},(t=On.prototype).W=function(){Cn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return Cn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Rn(this.b,t)?this.b[t]:e},t.set=function(t,e){Rn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Pn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Dn(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Dn?(this.i=void 0!==e?e:t.i,Ln(this,t.c),this.l=t.l,this.a=t.a,xn(this,t.g),this.f=t.f,Mn(this,ei(t.b)),this.h=t.h):t&&(n=String(t).match(Pn))?(this.i=!!e,Ln(this,n[1]||"",!0),this.l=$n(n[2]||""),this.a=$n(n[3]||"",!0),xn(this,n[4]),this.f=$n(n[5]||"",!0),Mn(this,n[6]||"",!0),this.h=$n(n[7]||"")):(this.i=!!e,this.b=new Jn(null,this.i))}function Ln(t,e,n){t.c=n?$n(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function xn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Mn(t,e,n){e instanceof Jn?(t.b=e,function(t,e){e&&!t.f&&(Yn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Zn(this,e),ti(this,n,t))},t)),t.f=e}(t.b,t.i)):(n||(e=qn(e,Wn)),t.b=new Jn(e,t.i))}function jn(t,e,n){t.b.set(e,n)}function Fn(t,e){return t.b.get(e)}function Un(t){return t instanceof Dn?new Dn(t):new Dn(t,void 0)}function Vn(t,e,n,i){var r=new Dn(null,void 0);return t&&Ln(r,t),e&&(r.a=e),n&&xn(r,n),i&&(r.f=i),r}function $n(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function qn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Kn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Kn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Dn.prototype.toString=function(){var t=[],e=this.c;e&&t.push(qn(e,Hn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(qn(e,Hn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(qn(n,"/"==n.charAt(0)?Bn:Gn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",qn(n,Xn)),t.join("")},Dn.prototype.resolve=function(t){var e=new Dn(this),n=!!t.c;n?Ln(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var i=t.f;if(n)xn(e,t.g);else if(n=!!t.f){if("/"!=i.charAt(0))if(this.a&&!this.f)i="/"+i;else{var r=e.f.lastIndexOf("/");-1!=r&&(i=e.f.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(st(r,"./")||st(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],a=0;a<r.length;){var s=r[a++];"."==s?i&&a==r.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==r.length&&o.push("")):(o.push(s),i=!0)}i=o.join("/")}else i=r}return n?e.f=i:n=""!==t.b.toString(),n?Mn(e,ei(t.b)):n=!!t.h,n&&(e.h=t.h),e};var Hn=/[#\/\?@]/g,Gn=/[#\?:]/g,Bn=/[#\?]/g,Wn=/[#\?@]/g,Xn=/#/g;function Jn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Yn(t){t.a||(t.a=new On,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function zn(t){var e=_n(t);if(void 0===e)throw Error("Keys are undefined");var n=new Jn(null,void 0);t=Nn(t);for(var i=0;i<e.length;i++){var r=e[i],o=t[i];Array.isArray(o)?ti(n,r,o):n.add(r,o)}return n}function Zn(t,e){Yn(t),e=ni(t,e),Rn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Rn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Cn(t)))}function Qn(t,e){return Yn(t),e=ni(t,e),Rn(t.a.b,e)}function ti(t,e,n){Zn(t,e),0<n.length&&(t.c=null,t.a.set(ni(t,e),z(n)),t.b+=n.length)}function ei(t){var e=new Jn;return e.c=t.c,t.a&&(e.a=new On(t.a),e.b=t.b),e}function ni(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function ii(t){var e=[];return function t(e,n,i){if(null==n)i.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var r=n;n=r.length,i.push("[");for(var o="",a=0;a<n;a++)i.push(o),t(e,r[a],i),o=",";return void i.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(r in i.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,r)&&"function"!=typeof(a=n[r])&&(i.push(o),si(r,i),i.push(":"),t(e,a,i),o=",");return void i.push("}")}n=n.valueOf()}switch(typeof n){case"string":si(n,i);break;case"number":i.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":i.push(String(n));break;case"function":i.push("null");break;default:throw Error("Unknown type: "+typeof n);}}}(new ri,t,e),e.join("")}function ri(){}(t=Jn.prototype).add=function(t,e){Yn(this),this.c=null,t=ni(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Yn(this),this.a.forEach(function(n,i){K(n,function(n){t.call(e,n,i,this)},this)},this)},t.Y=function(){Yn(this);for(var t=this.a.W(),e=this.a.Y(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},t.W=function(t){Yn(this);var e=[];if("string"==typeof t)Qn(this,t)&&(e=Y(e,this.a.get(ni(this,t))));else{t=this.a.W();for(var n=0;n<t.length;n++)e=Y(e,t[n])}return e},t.set=function(t,e){return Yn(this),this.c=null,Qn(this,t=ni(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.W(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.W(i);for(var o=0;o<i.length;o++){var a=r;""!==i[o]&&(a+="="+encodeURIComponent(String(i[o]))),t.push(a)}}return this.c=t.join("&")};var oi={"\"":"\\\"","\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},ai=/\uffff/.test("\uFFFF")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function si(t,e){e.push("\"",t.replace(ai,function(t){var e=oi[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),oi[t]=e),e}),"\"")}function ui(){var t=Ni();return Xt&&!!se&&11==se||/Edge\/\d+/.test(t)}function ci(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function hi(t,e){e=e||a.window;var n="about:blank";t&&(n=Rt(xt(t)||Ft)),e.location.href=n}function fi(t){return!!((t=(t||Ni()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function li(t){t=t||a.window;try{t.close()}catch(e){}}function di(t,e,n){var i=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<r?r:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Ni().toLowerCase(),i&&(e.target=i,st(n,"crios/")&&(e.target="_blank")),Ei(Ni())==Ti&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof Ct?n:xt(void 0!==n.href?n.href:String(n))||Ft,n=t.target||n.target,r=[],t)switch(a){case"width":case"height":case"top":case"left":r.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(a+"="+(t[a]?1:0));}var a=r.join(",");if((ft("iPhone")&&!ft("iPod")&&!ft("iPad")||ft("iPad")||ft("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(gt(a=ve(document,"A"),"HTMLAnchorElement"),e=e instanceof Ct?e:Mt(e),a.href=Rt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,i,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=$t("",i,n,a),t=Rt(e),a&&(Yt&&st(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t="<meta name=\"referrer\" content=\"no-referrer\"><meta http-equiv=\"refresh\" content=\"0; url="+Kt(t)+"\">",t=new Ut(t=(i=kt())?i.createHTML(t):t,null,Vt),i=a.document)&&(i.write(function(t){return t instanceof Ut&&t.constructor===Ut?t.a:(x("expected object of type SafeHtml, got '"+t+"' of type "+f(t)),"type_error:SafeHtml")}(t)),i.close())):(a=$t(e,i,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var pi=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,vi=/^[^@]+@[^@]+$/;function mi(){var t=null;return new Ie(function(e){"complete"==a.document.readyState?e():(t=function(){e()},fn(window,"load",t))}).o(function(e){throw ln(window,"load",t),e})}function gi(t){return t=t||Ni(),!("file:"!==Pi()&&"ionic:"!==Pi()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function bi(){var t=a.window;try{return!(!t||t==t.top)}catch(e){return!1}}function yi(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function wi(){return fb.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":fb.INTERNAL.hasOwnProperty("node")?"Node":yi()?"Worker":"Browser"}function Ii(){var t=wi();return"ReactNative"===t||"Node"===t}var Ti="Firefox",ki="Chrome";function Ei(t){var e=t.toLowerCase();return st(e,"opera/")||st(e,"opr/")||st(e,"opios/")?"Opera":st(e,"iemobile")?"IEMobile":st(e,"msie")||st(e,"trident/")?"IE":st(e,"edge/")?"Edge":st(e,"firefox/")?Ti:st(e,"silk/")?"Silk":st(e,"blackberry")?"Blackberry":st(e,"webos")?"Webos":!st(e,"safari/")||st(e,"chrome/")||st(e,"crios/")||st(e,"android")?!st(e,"chrome/")&&!st(e,"crios/")||st(e,"edge/")?st(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":ki:"Safari"}var Ai={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Si(t,e){e=e||[];var n,i=[],r={};for(n in Ai)r[Ai[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],i.push(e[n]));return i.sort(),(e=i).length||(e=["FirebaseCore-web"]),"Browser"===(i=wi())?i=Ei(r=Ni()):"Worker"===i&&(i=Ei(r=Ni())+"-"+i),i+"/JsCore/"+t+"/"+e.join(",")}function Ni(){return a.navigator&&a.navigator.userAgent||""}function _i(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Oi(){try{var t=a.localStorage,e=ji();if(t)return t.setItem(e,"1"),t.removeItem(e),!ui()||!!a.indexedDB}catch(n){return yi()&&!!a.indexedDB}return!1}function Ci(){return(Ri()||"chrome-extension:"===Pi()||gi())&&!Ii()&&Oi()&&!yi()}function Ri(){return"http:"===Pi()||"https:"===Pi()}function Pi(){return a.location&&a.location.protocol||null}function Di(t){return!fi(t=t||Ni())&&Ei(t)!=Ti}function Li(t){return void 0===t?null:ii(t)}function xi(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Mi(t){if(null!==t)return JSON.parse(t)}function ji(t){return t||Math.floor(1e9*Math.random()).toString()}function Fi(t){return"Safari"!=Ei(t=t||Ni())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Ui(){var t=a.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Vi(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Ni(),e=wi(),this.b=fi(t)||"ReactNative"===e}function $i(){var t=a.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function qi(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function Ki(){return!(!_i("fireauth.oauthhelper",a)&&!_i("fireauth.iframe",a))}Vi.prototype.get=function(){var t=a.navigator;return!t||"boolean"!=typeof t.onLine||!Ri()&&"chrome-extension:"!==Pi()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Hi,Gi={};function Bi(t){Gi[t]||(Gi[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Wi={};Object.defineProperty(Wi,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Wi,"abcd",{configurable:!0,enumerable:!0,value:2}),Hi=2==Wi.abcd}catch(Bt){Hi=!1}function Xi(t,e,n){Hi?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Ji(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Xi(t,n,e[n])}function Yi(t){var e={};return Ji(e,t),e}function zi(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Xi(e,n,zi(t[n]));return e}function Zi(t){var e=t&&(t[ir]?"phone":null);if(!(e&&t&&t[nr]))throw new A("internal-error","Internal assert: invalid MultiFactorInfo object");Xi(this,"uid",t[nr]),Xi(this,"displayName",t[tr]||null);var n=null;t[er]&&(n=new Date(t[er]).toUTCString()),Xi(this,"enrollmentTime",n),Xi(this,"factorId",e)}function Qi(t){try{var e=new rr(t)}catch(n){e=null}return e}Zi.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var tr="displayName",er="enrolledAt",nr="mfaEnrollmentId",ir="phoneInfo";function rr(t){Zi.call(this,t),Xi(this,"phoneNumber",t[ir])}function or(t){var e={},n=t[cr],i=t[fr],r=t[lr];if(t=Qi(t[hr]),!r||r!=sr&&r!=ur&&!n||r==ur&&!i||r==ar&&!t)throw Error("Invalid checkActionCode response!");r==ur?(e[pr]=n||null,e[mr]=n||null,e[dr]=i):(e[pr]=i||null,e[mr]=i||null,e[dr]=n||null),e[vr]=t||null,Xi(this,br,r),Xi(this,gr,zi(e))}k(rr,Zi),rr.prototype.w=function(){var t=rr.ab.w.call(this);return t.phoneNumber=this.phoneNumber,t};var ar="REVERT_SECOND_FACTOR_ADDITION",sr="EMAIL_SIGNIN",ur="VERIFY_AND_CHANGE_EMAIL",cr="email",hr="mfaInfo",fr="newEmail",lr="requestType",dr="email",pr="fromEmail",vr="multiFactorInfo",mr="previousEmail",gr="data",br="operation";function yr(t){var e=Fn(t=Un(t),wr)||null,n=Fn(t,Ir)||null,i=Fn(t,Er)||null;if(i=i&&Sr[i]||null,!e||!n||!i)throw new A("argument-error",wr+", "+Ir+"and "+Er+" are required in a valid action code URL.");Ji(this,{apiKey:e,operation:i,code:n,continueUrl:Fn(t,Tr)||null,languageCode:Fn(t,kr)||null,tenantId:Fn(t,Ar)||null})}var wr="apiKey",Ir="oobCode",Tr="continueUrl",kr="languageCode",Er="mode",Ar="tenantId",Sr={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:ar,signIn:sr,verifyAndChangeEmail:ur,verifyEmail:"VERIFY_EMAIL"};function Nr(t){try{return new yr(t)}catch(e){return null}}function _r(t){var e=t[Dr];if(void 0===e)throw new A("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new A("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Or];if(n&&"object"==typeof n){e=n[Mr];var i=n[Lr];if(n=n[xr],"string"==typeof e&&e.length){if(this.a=e,void 0!==i&&"boolean"!=typeof i)throw new A("argument-error",Lr+" property must be a boolean when specified.");if(this.g=!!i,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new A("argument-error",xr+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new A("argument-error",Mr+" property must be a non empty string when specified.");if(void 0!==i||void 0!==n)throw new A("missing-android-pkg-name")}}else if(void 0!==n)throw new A("argument-error",Or+" property must be a non null object when specified.");if(this.f=null,(e=t[Pr])&&"object"==typeof e){if("string"==typeof(e=e[jr])&&e.length)this.f=e;else if(void 0!==e)throw new A("argument-error",jr+" property must be a non empty string when specified.")}else if(void 0!==e)throw new A("argument-error",Pr+" property must be a non null object when specified.");if(void 0!==(e=t[Rr])&&"boolean"!=typeof e)throw new A("argument-error",Rr+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Cr])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new A("argument-error",Cr+" property must be a non empty string when specified.");this.i=t||null}var Or="android",Cr="dynamicLinkDomain",Rr="handleCodeInApp",Pr="iOS",Dr="url",Lr="installApp",xr="minimumVersion",Mr="packageName",jr="bundleId";function Fr(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Ur=null;function Vr(t){var e=[];return function(t,e){function n(e){for(;i<t.length;){var n=t.charAt(i++),r=Ur[n];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Ur){Ur={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var i=t.concat(e[n].split("")),r=0;r<i.length;r++){var o=i[r];void 0===Ur[o]&&(Ur[o]=r)}}}();for(var i=0;;){var r=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===r)break;e(r<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e.push(t)}),e}function $r(t){var e=Kr(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function qr(t){try{return new $r(t)}catch(e){return null}}function Kr(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var i=Vr(t);for(t=[],n=e=0;e<i.length;){var r=i[e++];if(128>r)t[n++]=String.fromCharCode(r);else if(191<r&&224>r){var o=i[e++];t[n++]=String.fromCharCode((31&r)<<6|63&o)}else if(239<r&&365>r){o=i[e++];var a=i[e++],s=((7&r)<<18|(63&o)<<12|(63&a)<<6|63&i[e++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else o=i[e++],a=i[e++],t[n++]=String.fromCharCode((15&r)<<12|(63&o)<<6|63&a)}return JSON.parse(t.join(""))}catch(u){}return null}$r.prototype.T=function(){return this.f},$r.prototype.l=function(){return this.c},$r.prototype.toString=function(){return this.h};var Hr="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Gr=["client_id","response_type","scope","redirect_uri","state"],Br={nd:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Xa:Gr},pd:{Ja:null,ua:500,ta:750,fa:"github.com",Xa:Gr},qd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Xa:Gr},wd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Xa:Hr},kd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Xa:[]}};function Wr(t){for(var e in Br)if(Br[e].fa==t)return Br[e];return null}function Xr(t){var e={};e["facebook.com"]=Qr,e["google.com"]=eo,e["github.com"]=to,e["twitter.com"]=no;var n=t&&t[Yr];try{if(n)return e[n]?new e[n](t):new Zr(t);if(void 0!==t[Jr])return new zr(t)}catch(i){}return null}var Jr="idToken",Yr="providerId";function zr(t){var e=t[Yr];if(!e&&t[Jr]){var n=qr(t[Jr]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Xi(this,"providerId",e),Xi(this,"isNewUser",n)}function Zr(t){zr.call(this,t),Xi(this,"profile",zi((t=Mi(t.rawUserInfo||"{}"))||{}))}function Qr(t){if(Zr.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function to(t){if(Zr.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Xi(this,"username",this.profile&&this.profile.login||null)}function eo(t){if(Zr.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function no(t){if(Zr.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Xi(this,"username",t.screenName||null)}function io(t){var e=Un(t),n=Fn(e,"link"),i=Fn(Un(n),"link");return e=Fn(e,"deep_link_id"),Fn(Un(e),"link")||e||i||n||t}function ro(t,e){if(!t&&!e)throw new A("internal-error","Internal assert: no raw session string available");if(t&&e)throw new A("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?oo:ao}k(Zr,zr),k(Qr,Zr),k(to,Zr),k(eo,Zr),k(no,Zr);var oo="enroll",ao="signin";function so(){}function uo(t,e){return t.then(function(t){if(t[Ya]){var n=qr(t[Ya]);if(!n||e!=n.i)throw new A("user-mismatch");return t}throw new A("user-mismatch")}).o(function(t){throw t&&t.code&&t.code==_+"user-not-found"?new A("user-mismatch"):t})}function co(t,e){if(!e)throw new A("internal-error","failed to construct a credential");this.a=e,Xi(this,"providerId",t),Xi(this,"signInMethod",t)}function ho(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function fo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new co(t.providerId,t.pendingToken)}catch(e){}return null}function lo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Xi(this,"idToken",e.idToken),e.accessToken&&Xi(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Xi(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new A("internal-error","failed to construct a credential");Xi(this,"accessToken",e.oauthToken),Xi(this,"secret",e.oauthTokenSecret)}Xi(this,"providerId",t),Xi(this,"signInMethod",n)}function po(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:zn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function vo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new lo(t.providerId,e,t.signInMethod)}catch(n){}}return null}function mo(t,e){this.Qc=e||[],Ji(this,{providerId:t,isOAuthProvider:!0}),this.Ib={},this.pb=(Wr(t)||{}).Ja||null,this.ob=null}function go(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new A("argument-error","SAML provider IDs must be prefixed with \"saml.\"");mo.call(this,t,[])}function bo(t){mo.call(this,t,Gr),this.a=[]}function yo(){bo.call(this,"facebook.com")}function wo(t){if(!t)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return p(t)&&(e=t.accessToken),new yo().credential({accessToken:e})}function Io(){bo.call(this,"github.com")}function To(t){if(!t)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return p(t)&&(e=t.accessToken),new Io().credential({accessToken:e})}function ko(){bo.call(this,"google.com"),this.Ca("profile")}function Eo(t,e){var n=t;return p(t)&&(n=t.idToken,e=t.accessToken),new ko().credential({idToken:n,accessToken:e})}function Ao(){mo.call(this,"twitter.com",Hr)}function So(t,e){var n=t;if(p(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new A("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new lo("twitter.com",n,"twitter.com")}function No(t,e,n){this.a=t,this.f=e,Xi(this,"providerId","password"),Xi(this,"signInMethod",n===Oo.EMAIL_LINK_SIGN_IN_METHOD?Oo.EMAIL_LINK_SIGN_IN_METHOD:Oo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function _o(t){return t&&t.email&&t.password?new No(t.email,t.password,t.signInMethod):null}function Oo(){Ji(this,{providerId:"password",isOAuthProvider:!1})}function Co(t,e){if(!(e=Ro(e)))throw new A("argument-error","Invalid email link!");return new No(t,e.code,Oo.EMAIL_LINK_SIGN_IN_METHOD)}function Ro(t){return(t=Nr(t=io(t)))&&t.operation===sr?t:null}function Po(t){if(!(t.eb&&t.cb||t.La&&t.ea))throw new A("internal-error");this.a=t,Xi(this,"providerId","phone"),this.fa="phone",Xi(this,"signInMethod","phone")}function Do(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return K(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){t[n]&&(e[n]=t[n])}),new Po(e)}return null}function Lo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.eb,code:t.a.cb}}function xo(t){try{this.a=t||fb.auth()}catch(e){throw new A("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Ji(this,{providerId:"phone",isOAuthProvider:!1})}function Mo(t,e){if(!t)throw new A("missing-verification-id");if(!e)throw new A("missing-verification-code");return new Po({eb:t,cb:e})}function jo(t){if(t.temporaryProof&&t.phoneNumber)return new Po({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,i=t&&t.oauthTokenSecret,r=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return Eo(o,n);case"facebook.com":return wo(n);case"github.com":return To(n);case"twitter.com":return So(n,i);default:return n||i||o||a?a?0==e.indexOf("saml.")?new co(e,a):new lo(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new bo(e).credential({idToken:o,accessToken:n,rawNonce:r}):null;}}catch(s){return null}}function Fo(t){if(!t.isOAuthProvider)throw new A("invalid-oauth-provider")}function Uo(t,e,n,i,r,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=i||null,this.i=o||null,this.h=a||null,this.a=r||null,!this.g&&!this.a)throw new A("invalid-auth-event");if(this.g&&this.a)throw new A("invalid-auth-event");if(this.g&&!this.f)throw new A("invalid-auth-event")}function Vo(t){return(t=t||{}).type?new Uo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&S(t.error),t.postBody,t.tenantId):null}function $o(){this.b=null,this.a=[]}ro.prototype.Ha=function(){return this.a?_e(this.a):_e(this.b)},ro.prototype.w=function(){return this.type==oo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},so.prototype.ka=function(){},so.prototype.b=function(){},so.prototype.c=function(){},so.prototype.w=function(){},co.prototype.ka=function(t){return bs(t,ho(this))},co.prototype.b=function(t,e){var n=ho(this);return n.idToken=e,ys(t,n)},co.prototype.c=function(t,e){return uo(ws(t,ho(this)),e)},co.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},lo.prototype.ka=function(t){return bs(t,po(this))},lo.prototype.b=function(t,e){var n=po(this);return n.idToken=e,ys(t,n)},lo.prototype.c=function(t,e){return uo(ws(t,po(this)),e)},lo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},mo.prototype.Ka=function(t){return this.Ib=pt(t),this},k(go,mo),k(bo,mo),bo.prototype.Ca=function(t){return W(this.a,t)||this.a.push(t),this},bo.prototype.Qb=function(){return z(this.a)},bo.prototype.credential=function(t,e){var n;if(!(n=p(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new A("argument-error","credential failed: must provide the ID token and/or the access token.");return new lo(this.providerId,n,this.providerId)},k(yo,bo),Xi(yo,"PROVIDER_ID","facebook.com"),Xi(yo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),k(Io,bo),Xi(Io,"PROVIDER_ID","github.com"),Xi(Io,"GITHUB_SIGN_IN_METHOD","github.com"),k(ko,bo),Xi(ko,"PROVIDER_ID","google.com"),Xi(ko,"GOOGLE_SIGN_IN_METHOD","google.com"),k(Ao,mo),Xi(Ao,"PROVIDER_ID","twitter.com"),Xi(Ao,"TWITTER_SIGN_IN_METHOD","twitter.com"),No.prototype.ka=function(t){return this.signInMethod==Oo.EMAIL_LINK_SIGN_IN_METHOD?eu(t,_s,{email:this.a,oobCode:this.f}):eu(t,Ys,{email:this.a,password:this.f})},No.prototype.b=function(t,e){return this.signInMethod==Oo.EMAIL_LINK_SIGN_IN_METHOD?eu(t,Os,{idToken:e,email:this.a,oobCode:this.f}):eu(t,qs,{idToken:e,email:this.a,password:this.f})},No.prototype.c=function(t,e){return uo(this.ka(t),e)},No.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Ji(Oo,{PROVIDER_ID:"password"}),Ji(Oo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Ji(Oo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Po.prototype.ka=function(t){return t.fb(Lo(this))},Po.prototype.b=function(t,e){var n=Lo(this);return n.idToken=e,eu(t,Zs,n)},Po.prototype.c=function(t,e){var n=Lo(this);return n.operation="REAUTH",uo(t=eu(t,Qs,n),e)},Po.prototype.w=function(){var t={providerId:"phone"};return this.a.eb&&(t.verificationId=this.a.eb),this.a.cb&&(t.verificationCode=this.a.cb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},xo.prototype.fb=function(t,e){var n=this.a.a;return _e(e.verify()).then(function(i){if("string"!=typeof i)throw new A("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var r=p(t)?t.session:null,o=p(t)?t.phoneNumber:t;return(r&&r.type==oo?r.Ha().then(function(t){return eu(n,Hs,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:i}}).then(function(t){return t.phoneSessionInfo.sessionInfo})}):r&&r.type==ao?r.Ha().then(function(e){return function(t,e){return eu(t,Gs,e).then(function(t){return t.phoneResponseInfo.sessionInfo})}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:i}})}):function(t,e){return eu(t,Vs,e)}(n,{phoneNumber:o,recaptchaToken:i})).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new A("argument-error","Only firebase.auth.ApplicationVerifiers with type=\"recaptcha\" are currently supported.");}})},Ji(xo,{PROVIDER_ID:"phone"}),Ji(xo,{PHONE_SIGN_IN_METHOD:"phone"}),Uo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Uo.prototype.T=function(){return this.h},Uo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var qo,Ko=null;function Ho(t){var e="unauthorized-domain",n=void 0,i=Un(t);t=i.a,"chrome-extension"==(i=i.c)?n=qt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==i||"https"==i?n=qt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",A.call(this,e,n)}function Go(t,e,n){A.call(this,t,n),(t=e||{}).Jb&&Xi(this,"email",t.Jb),t.ea&&Xi(this,"phoneNumber",t.ea),t.credential&&Xi(this,"credential",t.credential),t.Zb&&Xi(this,"tenantId",t.Zb)}function Bo(t){if(t.code){var e=t.code||"";0==e.indexOf(_)&&(e=e.substring(_.length));var n={credential:jo(t),Zb:t.tenantId};if(t.email)n.Jb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new A(e,t.message||void 0);return new Go(e,n,t.message)}return null}function Wo(){}function Xo(t){return t.c||(t.c=t.b())}function Jo(){}function Yo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var i=e[n];try{return new ActiveXObject(i),t.f=i}catch(r){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function zo(){}function Zo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=w(this.qc,this),this.a.onerror=w(this.Sb,this),this.a.onprogress=w(this.rc,this),this.a.ontimeout=w(this.vc,this)}function Qo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function ta(t,e,n){this.reset(t,e,n,void 0,void 0)}k(Ho,A),k(Go,A),Go.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&mt(t,e),t},Go.prototype.toJSON=function(){return this.w()},Wo.prototype.c=null,k(Jo,Wo),Jo.prototype.a=function(){var t=Yo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Jo.prototype.b=function(){var t={};return Yo(this)&&(t[0]=!0,t[1]=!0),t},qo=new Jo,k(zo,Wo),zo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Zo;throw Error("Unsupported browser")},zo.prototype.b=function(){return{}},(t=Zo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,Qo(this,4)},t.Sb=function(){this.status=500,this.response=this.responseText="",Qo(this,4)},t.vc=function(){this.Sb()},t.rc=function(){this.status=200,Qo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},ta.prototype.a=null;function ea(t){this.f=t,this.b=this.c=this.a=null}function na(t,e){this.name=t,this.value=e}ta.prototype.reset=function(t,e,n,i,r){"number"==typeof r||0,i||T(),delete this.a},na.prototype.toString=function(){return this.name};var ia=new na("SEVERE",1e3),ra=new na("WARNING",900),oa=new na("CONFIG",700),aa=new na("FINE",500);ea.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(x("Root logger has no level set."),null)}(this).value)for(d(e)&&(e=e()),t=new ta(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var sa={},ua=null;function ca(t){var e;if(ua||(ua=new ea(""),sa[""]=ua,ua.c=oa),!(e=sa[t])){e=new ea(t);var n=t.lastIndexOf("."),i=t.substr(n+1);(n=ca(t.substr(0,n))).b||(n.b={}),n.b[i]=e,e.a=n,sa[t]=e}return e}function ha(t,e){t&&t.log(aa,e,void 0)}function fa(t){this.f=t}function la(t){In.call(this),this.u=t,this.h=void 0,this.readyState=da,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=ca("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}k(fa,Wo),fa.prototype.a=function(){return new la(this.f)},fa.prototype.b=function(t){return function(){return t}}({}),k(la,In);var da=0;function pa(t){t.c.read().then(t.pc.bind(t)).catch(t.Ua.bind(t))}function va(t){t.readyState=4,t.g=null,t.c=null,t.m=null,ma(t)}function ma(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function ga(t){In.call(this),this.headers=new On,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.R=this.l="",this.f=this.O=this.i=this.J=!1,this.g=0,this.s=null,this.m=ba,this.u=this.S=!1}(t=la.prototype).open=function(t,e){if(this.readyState!=da)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,ma(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Ua.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,va(this)),this.readyState=da},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,ma(this)),this.a&&(this.readyState=3,ma(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Ua.bind(this)):void 0!==a.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,pa(this)):t.text().then(this.tc.bind(this),this.Ua.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?va(this):ma(this),3==this.readyState&&pa(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,va(this))},t.sc=function(t){this.a&&(this.response=t,va(this))},t.Ua=function(t){var e=this.i;e&&e.log(ra,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&va(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(ra,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(ra,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(la.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),k(ga,In);var ba="";ga.prototype.b=ca("goog.net.XhrIo");var ya=/^https?$/i,wa=["POST","PUT"];function Ia(t,e,n,i,r){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.R=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():qo.a(),t.C=t.D?Xo(t.D):Xo(qo),t.a.onreadystatechange=w(t.Vb,t);try{ha(t.b,Ca(t,"Opening Xhr")),t.O=!0,t.a.open(n,String(e),!0),t.O=!1}catch(s){return ha(t.b,Ca(t,"Error opening Xhr: "+s.message)),void ka(t,s)}e=i||"";var o=new On(t.headers);r&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(l(t)||"string"==typeof t)K(t,e,void 0);else for(var n=_n(t),i=Nn(t),r=i.length,o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Ta,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),i=a.FormData&&e instanceof a.FormData,!W(wa,n)||r||i||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Na(t),0<t.g&&(t.u=function(t){return Xt&&oe(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),ha(t.b,Ca(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=w(t.Ma,t)):t.s=An(t.Ma,t.g,t)),ha(t.b,Ca(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(s){ha(t.b,Ca(t,"Send error: "+s.message)),ka(t,s)}}function Ta(t){return"content-type"==t.toLowerCase()}function ka(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Ea(t),Sa(t)}function Ea(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Aa(t){if(t.c&&void 0!==o)if(t.C[1]&&4==_a(t)&&2==Oa(t))ha(t.b,Ca(t,"Local request error detected and ignored"));else if(t.i&&4==_a(t))An(t.Vb,0,t);else if(t.dispatchEvent("readystatechange"),4==_a(t)){ha(t.b,Ca(t,"Request complete")),t.c=!1;try{var e,n=Oa(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1;}if(!(e=i)){var r;if(r=0===n){var s=String(t.l).match(Pn)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}r=!ya.test(s?s.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<_a(t)?t.a.statusText:""}catch(h){ha(t.b,"Can not get status: "+h.message),c=""}t.h=c+" ["+Oa(t)+"]",Ea(t)}}finally{Sa(t)}}}function Sa(t,e){if(t.a){Na(t);var n=t.a,i=t.C[0]?h:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(r){(t=t.b)&&t.log(ia,"Problem encountered resetting onreadystatechange: "+r.message,void 0)}}}function Na(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(a.clearTimeout(t.s),t.s=null)}function _a(t){return t.a?t.a.readyState:0}function Oa(t){try{return 2<_a(t)?t.a.status:-1}catch(e){return-1}}function Ca(t,e){return e+" ["+t.R+" "+t.l+" "+Oa(t)+"]"}function Ra(t){var e=qa;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function Pa(t,e,n){t.a=!0,t.c=n,t.f=!e,Ma(t)}function Da(t){if(t.a){if(!t.v)throw new ja(t);t.v=!1}}function La(t,e,n,i){t.g.push([e,n,i]),t.a&&Ma(t)}function xa(t){return B(t.g,function(t){return d(t[1])})}function Ma(t){if(t.h&&t.a&&xa(t)){var e=t.h,n=Va[e];n&&(a.clearTimeout(n.a),delete Va[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var i=n=!1;t.g.length&&!t.i;){var r=t.g.shift(),o=r[0],s=r[1];if(r=r[2],o=t.f?s:o)try{var u=o.call(r||t.s,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(P(e)||"function"==typeof a.Promise&&e instanceof a.Promise)&&(i=!0,t.i=!0)}catch(c){e=c,t.f=!0,xa(t)||(n=!0)}}t.c=e,i&&(u=w(t.m,t,!0),i=w(t.m,t,!1),e instanceof Ra?(La(e,u,i),e.C=!0):e.then(u,i)),n&&(e=new Ua(e),Va[e.a]=e,t.h=e.a)}function ja(){D.call(this)}function Fa(){D.call(this)}function Ua(t){this.a=a.setTimeout(w(this.c,this),0),this.b=t}(t=ga.prototype).Ma=function(){void 0!==o&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ha(this.b,Ca(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ha(this.b,Ca(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Sa(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Sa(this,!0)),ga.ab.Da.call(this)},t.Vb=function(){this.xa||(this.O||this.i||this.f?Aa(this):this.Jc())},t.Jc=function(){Aa(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ba:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer;}var t=this.b;return t&&t.log(ia,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return ha(this.b,"Can not get response: "+e.message),null}},Ra.prototype.cancel=function(t){if(this.a)this.c instanceof Ra&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Fa(this),Da(this),Pa(this,!1,t))}},Ra.prototype.m=function(t,e){this.i=!1,Pa(this,t,e)},Ra.prototype.then=function(t,e,n){var i,r,o=new Ie(function(t,e){i=t,r=e});return La(this,i,function(t){t instanceof Fa?o.cancel():r(t)}),o.then(t,e,n)},Ra.prototype.$goog_Thenable=!0,k(ja,D),ja.prototype.message="Deferred has already fired",ja.prototype.name="AlreadyCalledError",k(Fa,D),Fa.prototype.message="Deferred was canceled",Fa.prototype.name="CanceledError",Ua.prototype.c=function(){throw delete Va[this.a],this.b};var Va={};function $a(t){var e={},n=e.document||document,i=At(t).toString(),r=ve(document,"SCRIPT"),o={Wb:r,Ma:void 0},s=new Ra(o),h=null,f=null!=e.timeout?e.timeout:5e3;return 0<f&&(h=window.setTimeout(function(){Ka(r,!0);var t=new Ba(Ga,"Timeout reached for loading script "+i);Da(s),Pa(s,!1,t)},f),o.Ma=h),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(Ka(r,e.xd||!1,h),Da(s),Pa(s,!0,null))},r.onerror=function(){Ka(r,!0,h);var t=new Ba(Ha,"Error while loading script "+i);Da(s),Pa(s,!1,t)},mt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),he(r,o),function(t,e){gt(t,"HTMLScriptElement"),t.src=At(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=a?e=c(e.document):(null===u&&(u=c(a.document)),e=u),e&&t.setAttribute("nonce",e)}(r,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(r),s}function qa(){if(this&&this.Wb){var t=this.Wb;t&&"SCRIPT"==t.tagName&&Ka(t,!0,this.Ma)}}function Ka(t,e,n){null!=n&&a.clearTimeout(n),t.onload=h,t.onerror=h,t.onreadystatechange=h,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var Ha=0,Ga=1;function Ba(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),D.call(this,n),this.code=t}function Wa(t){this.f=t}function Xa(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||za,this.g=pt(t.secureTokenHeaders||Za),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||Qa,this.a=pt(t.firebaseHeaders||ts),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==wi(),!(n=a.XMLHttpRequest||n&&fb.INTERNAL.node&&fb.INTERNAL.node.XMLHttpRequest)&&!yi())throw new A("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,yi()?this.f=new fa(self):Ii()?this.f=new Wa(n):this.f=new zo,this.b=null}k(Ba,D),k(Wa,Wo),Wa.prototype.a=function(){return new this.f},Wa.prototype.b=function(){return{}};var Ja,Ya="idToken",za=new Vi(3e4,6e4),Za={"Content-Type":"application/x-www-form-urlencoded"},Qa=new Vi(3e4,6e4),ts={"Content-Type":"application/json"};function es(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function ns(t,e){e&&(t.l=is("https://securetoken.googleapis.com/v1/token",e),t.h=is("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=is("https://identitytoolkit.googleapis.com/v2/",e))}function is(t,e){return t=Un(t),e=Un(e.url),t.f=t.a+t.f,Ln(t,e.c),t.a=e.a,xn(t,e.g),t.toString()}function rs(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function os(t,e,n,i,r,o,s){(function(){var t=Ni();return!((t=Ei(t)!=ki?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Xt&&se&&!(9<se))})()||yi()?t=w(t.u,t):(Ja||(Ja=new Ie(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{a[ss]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=St(as,{onload:ss});!function(t,e){La(t,null,e,void 0)}($a(n),function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)})),t=w(t.s,t)),t(e,n,i,r,o,s)}Xa.prototype.T=function(){return this.b},Xa.prototype.u=function(t,e,n,i,r,o){if(yi()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new A("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new ga(this.f);if(o){s.g=Math.max(0,o);var u=setTimeout(function(){s.dispatchEvent("timeout")},o)}Tn(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ha(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)}),kn(s,"ready",function(){u&&clearTimeout(u),Ge(this)}),kn(s,"timeout",function(){u&&clearTimeout(u),Ge(this),e&&e(null)}),Ia(s,t,n,i,r)};var as=new bt(Tt,"https://apis.google.com/js/client.js?onload=%{onload}"),ss="__fcb"+Math.floor(1e6*Math.random()).toString();function us(t,e,n,i,r,o,a){var s=Un(e+n);jn(s,"key",t.c),a&&jn(s,"cb",T().toString());var u="GET"==i;if(u)for(var c in r)r.hasOwnProperty(c)&&jn(s,c,r[c]);return new Ie(function(e,n){os(t,s.toString(),function(t){t?t.error?n(iu(t,o||{})):e(t):n(new A("network-request-failed"))},i,u?void 0:ii(xi(r)),t.a,t.v.get())})}function cs(t){if("string"!=typeof(t=t.email)||!vi.test(t))throw new A("invalid-email")}function hs(t){"email"in t&&cs(t)}function fs(t){if(!t[Ya]){if(t.mfaPendingCredential)throw new A("multi-factor-auth-required",null,pt(t));throw new A("internal-error")}}function ls(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new A("internal-error")}else{if(!t.sessionInfo)throw new A("missing-verification-id");if(!t.code)throw new A("missing-verification-code")}}Xa.prototype.s=function(t,e,n,i,r){var o=this;Ja.then(function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:i,headers:r,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).o(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},Xa.prototype.zb=function(){return eu(this,Ks,{})},Xa.prototype.Bb=function(t,e){return eu(this,$s,{idToken:t,email:e})},Xa.prototype.Cb=function(t,e){return eu(this,qs,{idToken:t,password:e})};var ds={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function ps(t){if(!t.phoneVerificationInfo)throw new A("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new A("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new A("missing-verification-code")}function vs(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new A("internal-error")}function ms(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&Qn(t=new Jn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function gs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Bo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Bo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Bo(t)):t.errorMessage&&(e=nu(t.errorMessage)),e)throw e;fs(t)}function bs(t,e){return e.returnIdpCredential=!0,eu(t,Bs,e)}function ys(t,e){return e.returnIdpCredential=!0,eu(t,Xs,e)}function ws(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,eu(t,Ws,e)}function Is(t){if(!t.oobCode)throw new A("invalid-action-code")}(t=Xa.prototype).Db=function(t,e){var n={idToken:t},i=[];return lt(ds,function(t,r){var o=e[r];null===o?i.push(t):r in e&&(n[r]=o)}),i.length&&(n.deleteAttribute=i),eu(this,$s,n)},t.vb=function(t,e){return mt(t={requestType:"PASSWORD_RESET",email:t},e),eu(this,Ms,t)},t.wb=function(t,e){return mt(t={requestType:"EMAIL_SIGNIN",email:t},e),eu(this,Ds,t)},t.ub=function(t,e){return mt(t={requestType:"VERIFY_EMAIL",idToken:t},e),eu(this,Ls,t)},t.Eb=function(t,e,n){return mt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),eu(this,xs,t)},t.fb=function(t){return eu(this,zs,t)},t.nb=function(t,e){return eu(this,Us,{oobCode:t,newPassword:e})},t.Ra=function(t){return eu(this,ks,{oobCode:t})},t.jb=function(t){return eu(this,Ts,{oobCode:t})};var Ts={endpoint:"setAccountInfo",A:Is,Z:"email",B:!0},ks={endpoint:"resetPassword",A:Is,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new A("internal-error")},B:!0},Es={endpoint:"signupNewUser",A:function(t){if(cs(t),!t.password)throw new A("weak-password")},G:fs,V:!0,B:!0},As={endpoint:"createAuthUri",B:!0},Ss={endpoint:"deleteAccount",N:["idToken"]},Ns={endpoint:"setAccountInfo",N:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new A("internal-error")}},_s={endpoint:"emailLinkSignin",N:["email","oobCode"],A:cs,G:fs,V:!0,B:!0},Os={endpoint:"emailLinkSignin",N:["idToken","email","oobCode"],A:cs,G:fs,V:!0},Cs={endpoint:"accounts/mfaEnrollment:finalize",N:["idToken","phoneVerificationInfo"],A:ps,G:fs,B:!0,Na:!0},Rs={endpoint:"accounts/mfaSignIn:finalize",N:["mfaPendingCredential","phoneVerificationInfo"],A:ps,G:fs,B:!0,Na:!0},Ps={endpoint:"getAccountInfo"},Ds={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new A("internal-error");cs(t)},Z:"email",B:!0},Ls={endpoint:"getOobConfirmationCode",N:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new A("internal-error")},Z:"email",B:!0},xs={endpoint:"getOobConfirmationCode",N:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new A("internal-error")},Z:"email",B:!0},Ms={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new A("internal-error");cs(t)},Z:"email",B:!0},js={lb:!0,endpoint:"getProjectConfig",Ub:"GET"},Fs={lb:!0,endpoint:"getRecaptchaParam",Ub:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new A("internal-error")}},Us={endpoint:"resetPassword",A:Is,Z:"email",B:!0},Vs={endpoint:"sendVerificationCode",N:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},$s={endpoint:"setAccountInfo",N:["idToken"],A:hs,V:!0},qs={endpoint:"setAccountInfo",N:["idToken"],A:function(t){if(hs(t),!t.password)throw new A("weak-password")},G:fs,V:!0},Ks={endpoint:"signupNewUser",G:fs,V:!0,B:!0},Hs={endpoint:"accounts/mfaEnrollment:start",N:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new A("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new A("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},Gs={endpoint:"accounts/mfaSignIn:start",N:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},Bs={endpoint:"verifyAssertion",A:vs,Ya:ms,G:gs,V:!0,B:!0},Ws={endpoint:"verifyAssertion",A:vs,Ya:ms,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new A("user-not-found");if(t.errorMessage)throw nu(t.errorMessage);fs(t)},V:!0,B:!0},Xs={endpoint:"verifyAssertion",A:function(t){if(vs(t),!t.idToken)throw new A("internal-error")},Ya:ms,G:gs,V:!0},Js={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new A("invalid-custom-token")},G:fs,V:!0,B:!0},Ys={endpoint:"verifyPassword",A:function(t){if(cs(t),!t.password)throw new A("wrong-password")},G:fs,V:!0,B:!0},zs={endpoint:"verifyPhoneNumber",A:ls,G:fs,B:!0},Zs={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new A("internal-error");ls(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Bo(t);fs(t)}},Qs={Hb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ls,G:fs,B:!0},tu={endpoint:"accounts/mfaEnrollment:withdraw",N:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[Ya]^!!t.refreshToken)throw new A("internal-error")},B:!0,Na:!0};function eu(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var i=t[e[n]];if(null==i||""===i)return!1}return!0}(n,e.N))return Oe(new A("internal-error"));var i,r=!!e.Na,o=e.Ub||"POST";return _e(n).then(e.A).then(function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),us(t,r?t.i:t.h,e.endpoint,o,n,e.Hb,e.lb||!1)}).then(function(t){return i=t,e.Ya?e.Ya(n,i):i}).then(e.G).then(function(){if(!e.Z)return i;if(!(e.Z in i))throw new A("internal-error");return i[e.Z]})}function nu(t){return iu({error:{errors:[{message:t}],code:400,message:t}})}function iu(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=i[n]?new A(i[n]):null)return n;for(var r in n=t.error&&t.error.message||"",mt(i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,i)if(0===n.indexOf(r))return new A(i[r],e);return!e&&t&&(e=Li(t)),new A("internal-error",e)}function ru(t){this.b=t,this.a=null,this.rb=function(t){return(uu||(uu=new Ie(function(t,e){function n(){Ui(),_i("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Ui(),e(Error("Network Error"))},timeout:au.get()})}if(_i("gapi.iframes.Iframe"))t();else if(_i("gapi.load"))n();else{var i="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[i]=function(){_i("gapi.load")?n():e(Error("Network Error"))},_e($a(i=St(ou,{onload:i}))).o(function(){e(Error("Network Error"))})}}).o(function(t){throw uu=null,t}))).then(function(){return new Ie(function(e,n){_i("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:_i("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(i){function r(){clearTimeout(o),e()}t.a=i,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},su.get());i.ping(r).then(r,function(){n(Error("Network Error"))})})})})}(this)}var ou=new bt(Tt,"https://apis.google.com/js/api.js?onload=%{onload}"),au=new Vi(3e4,6e4),su=new Vi(5e3,15e3),uu=null;function cu(t,e,n,i){this.l=t,this.h=e,this.i=n,this.g=i,this.f=null,this.g?t=Vn((t=Un(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):t=Vn("https",this.l,null,"/__/auth/iframe"),this.a=t,jn(this.a,"apiKey",this.h),jn(this.a,"appName",this.i),this.b=null,this.c=[]}function hu(t,e,n,i,r,o){this.u=t,this.s=e,this.c=n,this.m=i,this.v=o,this.i=this.g=this.l=null,this.a=r,this.h=this.f=null}function fu(t){try{return fb.app(t).auth().Ga()}catch(e){return[]}}function lu(t,e,n,i,r,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=i||null,this.i=r||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function du(t){var e=ci();return function(t){return eu(t,js,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=Un(e),i=n.c;n=n.a;for(var r=0;r<t.length;r++){var o=t[r],a=n,s=i;if(0==o.indexOf("chrome-extension://")?a=Un(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:pi.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Ho(ci())})}function pu(t){return t.m?t.m:(t.m=mi().then(function(){if(!t.u){var e=t.c,n=t.i,i=fu(t.b),r=new cu(t.s,t.g,t.b,t.f);r.f=e,r.b=n,r.c=z(i||[]),t.u=r.toString()}t.v=new ru(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.rb.then(function(){t.a.register("authEvent",e,_i("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.v,function(e){var n={};if(e&&e.authEvent){var i=!1;for(e=Vo(e.authEvent),n=0;n<t.h.length;n++)i=t.h[n](e)||i;return(n={}).status=i?"ACK":"ERROR",_e(n)}return n.status="ERROR",_e(n)})}(t)}),t.m)}function vu(t){return t.l||(t.C=t.c?Si(t.c,fu(t.b)):null,t.l=new Xa(t.g,R(t.i),t.C),t.f&&ns(t.l,t.f)),t.l}function mu(t,e,n,i,r,o,a,s,u,c,h,f){return(t=new hu(t,e,n,i,r,f)).l=o,t.g=a,t.i=s,t.b=pt(u||null),t.f=c,t.yb(h).toString()}function gu(t){if(this.a=t||fb.INTERNAL.reactNative&&fb.INTERNAL.reactNative.AsyncStorage,!this.a)throw new A("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function bu(t){this.b=t,this.a={},this.f=w(this.c,this)}cu.prototype.toString=function(){return this.f?jn(this.a,"v",this.f):Zn(this.a.b,"v"),this.b?jn(this.a,"eid",this.b):Zn(this.a.b,"eid"),this.c.length?jn(this.a,"fw",this.c.join(",")):Zn(this.a.b,"fw"),this.a.toString()},hu.prototype.yb=function(t){return this.h=t,this},hu.prototype.toString=function(){if(this.v){var t=Un(this.v.url);t=Vn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=Vn("https",this.u,null,"/__/auth/handler");if(jn(t,"apiKey",this.s),jn(t,"appName",this.c),jn(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=fb.app(this.c).auth().la()}catch(s){n=null}for(var i in e.ob=n,jn(t,"providerId",this.a.providerId),e=xi((n=this.a).Ib))e[i]=e[i].toString();i=n.Qc,e=pt(e);for(var r=0;r<i.length;r++){var o=i[r];o in e&&delete e[o]}n.pb&&n.ob&&!e[n.pb]&&(e[n.pb]=n.ob),dt(e)||jn(t,"customParameters",Li(e))}if("function"==typeof this.a.Qb&&(n=this.a.Qb()).length&&jn(t,"scopes",n.join(",")),this.l?jn(t,"redirectUrl",this.l):Zn(t.b,"redirectUrl"),this.g?jn(t,"eventId",this.g):Zn(t.b,"eventId"),this.i?jn(t,"v",this.i):Zn(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Fn(t,a)&&jn(t,a,this.b[a]);return this.h?jn(t,"tid",this.h):Zn(t.b,"tid"),this.f?jn(t,"eid",this.f):Zn(t.b,"eid"),(a=fu(this.c)).length&&jn(t,"fw",a.join(",")),t.toString()},(t=lu.prototype).Ob=function(t,e,n){var i=new A("popup-closed-by-user"),r=new A("web-storage-unsupported"),o=this,a=!1;return this.ma().then(function(){(function(t){var e={type:"webStorageSupport"};return pu(t).then(function(){return function(t,e){return t.rb.then(function(){return new Ie(function(n){t.a.send(e.type,e,n,_i("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.v,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(t&&li(t),e(r),a=!0)})}).o(function(){}).then(function(){if(!a)return function(t){return new Ie(function(e){return function n(){Sn(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!a)return Sn(n).then(function(){e(i)})})},t.Xb=function(){var t=Ni();return!Di(t)&&!Fi(t)},t.Tb=function(){return!1},t.Mb=function(t,e,n,i,r,o,a,s){if(!t)return Oe(new A("popup-blocked"));if(a&&!Di())return this.ma().o(function(e){li(t),r(e)}),i(),_e();this.a||(this.a=du(vu(this)));var u=this;return this.a.then(function(){var e=u.ma().o(function(e){throw li(t),r(e),e});return i(),e}).then(function(){(Fo(n),a)||hi(mu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)}).o(function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t})},t.Nb=function(t,e,n,i){this.a||(this.a=du(vu(this)));var r=this;return this.a.then(function(){Fo(e),hi(mu(r.s,r.g,r.b,t,e,ci(),n,r.c,void 0,r.i,i,r.f))}).o(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},t.ma=function(){var t=this;return pu(this).then(function(){return t.v.rb}).o(function(){throw t.a=null,new A("network-request-failed")})},t.$b=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Sa=function(t){J(this.h,function(e){return e==t})},(t=gu.prototype).get=function(t){return _e(this.a.getItem(t)).then(function(t){return t&&Mi(t)})},t.set=function(t,e){return _e(this.a.setItem(t,Li(e)))},t.U=function(t){return _e(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var yu,wu=[];function Iu(t,e,n){dt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Tu(t){this.a=t}function ku(t){this.c=t,this.b=!1,this.a=[]}function Eu(t,e,n,i){var r,o,a,s,u=n||{},c=null;if(t.b)return Oe(Error("connection_unavailable"));var h=i?800:50,f="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Ie(function(n,i){f?(r=Math.floor(Math.random()*Math.pow(10,20)).toString(),f.port1.start(),a=setTimeout(function(){i(Error("unsupported_event"))},h),c={messageChannel:f,onMessage:o=function(t){t.data.eventId===r&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){i(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):i(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),i(Error("invalid_response"))))}},t.a.push(c),f.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:r,data:u},[f.port2])):i(Error("connection_unavailable"))}).then(function(e){return Au(t,c),e}).o(function(e){throw Au(t,c),e})}function Au(t,e){if(e){var n=e.messageChannel,i=e.onMessage;n&&(n.port1.removeEventListener("message",i),n.port1.close()),J(t.a,function(t){return t==e})}}function Su(){if(!Cu())throw new A("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=a.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;yi()&&self?(this.v=function(){var t=yi()?self:null;if(K(wu,function(n){n.b==t&&(e=n)}),!e){var e=new bu(t);wu.push(e)}return e}(),Iu(this.v,"keyChanged",function(e,n){return xu(t).then(function(e){return 0<e.length&&K(t.a,function(t){t(e)}),{keyProcessed:W(e,n.key)}})}),Iu(this.v,"ping",function(){return _e(["keyChanged"])})):function(){var t=a.navigator;return t&&t.serviceWorker?_e().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).o(function(){return null}):_e(null)}().then(function(e){(t.h=e)&&(t.g=new ku(new Tu(e)),Eu(t.g,"ping",null,!0).then(function(e){e[0].fulfilled&&W(e[0].value,"keyChanged")&&(t.s=!0)}).o(function(){}))})}function Nu(t){return new Ie(function(e,n){var i=t.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(i):function(t){return new Ie(function(e,n){var i=t.m.deleteDatabase("firebaseLocalStorageDb");i.onsuccess=function(){e()},i.onerror=function(t){n(Error(t.target.error))}})}(t).then(function(){return Nu(t)}).then(function(t){e(t)}).o(function(t){n(t)})}})}function _u(t){return t.i||(t.i=Nu(t)),t.i}function Ou(t,e){var n=0;return new Ie(function i(r,o){_u(t).then(e).then(r).o(function(e){if(!(3<++n))return _u(t).then(function(e){return e.close(),t.i=void 0,i(r,o)}).o(function(t){o(t)});o(e)})})}function Cu(){try{return!!a.indexedDB}catch(Bt){return!1}}function Ru(t){return t.objectStore("firebaseLocalStorage")}function Pu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Du(t){return new Ie(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function Lu(t,e){return t.g&&t.h&&function(){var t=a.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Eu(t.g,"keyChanged",{key:e},t.s).then(function(){}).o(function(){}):_e()}function xu(t){return _u(t).then(function(t){var e=Ru(Pu(t,!1));return e.getAll?Du(e.getAll()):new Ie(function(t,n){var i=[],r=e.openCursor();r.onsuccess=function(e){(e=e.target.result)?(i.push(e.value),e.continue()):t(i)},r.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},i=[];if(0==t.b){for(i=0;i<e.length;i++)n[e[i].fbase_key]=e[i].value;i=function t(e,n){var i,r=[];for(i in e)i in n?typeof e[i]!=typeof n[i]?r.push(i):"object"==typeof e[i]&&null!=e[i]&&null!=n[i]?0<t(e[i],n[i]).length&&r.push(i):e[i]!==n[i]&&r.push(i):r.push(i);for(i in n)i in e||r.push(i);return r}(t.c,n),t.c=n}return i})}function Mu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function ju(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=_e().then(function(){if(Cu()){var t=ji(),i="__sak"+t;return yu||(yu=new Su),(n=yu).set(i,t).then(function(){return n.get(i)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(i)}).then(function(){return n}).o(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.ca(function(t){K(e.a,function(e){e(t)})}),t})}function Fu(){this.a={},this.type="inMemory"}function Uu(){if(!function(){var t="Node"==wi();if(!(t=Vu()||t&&fb.INTERNAL.node&&fb.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==wi())throw new A("internal-error","The LocalStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=Vu()||fb.INTERNAL.node.localStorage,this.type="localStorage"}function Vu(){try{var t=a.localStorage,e=ji();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function $u(){this.type="nullStorage"}function qu(){if(!function(){var t="Node"==wi();if(!(t=Ku()||t&&fb.INTERNAL.node&&fb.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==wi())throw new A("internal-error","The SessionStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=Ku()||fb.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Ku(){try{var t=a.sessionStorage,e=ji();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function Hu(){var t={};t.Browser=Wu,t.Node=Xu,t.ReactNative=Ju,t.Worker=Yu,this.a=t[wi()]}bu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,i=this.a[e];if(i&&0<i.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var r=[];K(i,function(e){r.push(_e().then(function(){return e(t.origin,t.data.data)}))}),Re(r).then(function(i){var r=[];K(i,function(t){r.push({fulfilled:t.Pb,value:t.value,reason:t.reason?t.reason.message:void 0})}),K(r,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:r})})}},Tu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},ku.prototype.close=function(){for(;0<this.a.length;)Au(this,this.a[0]);this.b=!0},(t=Su.prototype).set=function(t,e){var n=this,i=!1;return Ou(this,function(e){return Du((e=Ru(Pu(e,!0))).get(t))}).then(function(r){return Ou(n,function(o){if(o=Ru(Pu(o,!0)),r)return r.value=e,Du(o.put(r));n.b++,i=!0;var a={};return a.fbase_key=t,a.value=e,Du(o.add(a))})}).then(function(){return n.c[t]=e,Lu(n,t)}).oa(function(){i&&n.b--})},t.get=function(t){return Ou(this,function(e){return Du(Ru(Pu(e,!1)).get(t))}).then(function(t){return t&&t.value})},t.U=function(t){var e=this,n=!1;return Ou(this,function(i){return n=!0,e.b++,Du(Ru(Pu(i,!0)).delete(t))}).then(function(){return delete e.c[t],Lu(e,t)}).oa(function(){n&&e.b--})},t.ca=function(t){0==this.a.length&&function(t){Mu(t),function e(){t.f=setTimeout(function(){t.l=xu(t).then(function(e){0<e.length&&K(t.a,function(t){t(e)})}).then(function(){e()}).o(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()}(this),this.a.push(t)},t.ia=function(t){J(this.a,function(e){return e==t}),0==this.a.length&&Mu(this)},(t=ju.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},t.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},t.U=function(t){return this.b.then(function(e){return e.U(t)})},t.ca=function(t){this.a.push(t)},t.ia=function(t){J(this.a,function(e){return e==t})},(t=Fu.prototype).get=function(t){return _e(this.a[t])},t.set=function(t,e){return this.a[t]=e,_e()},t.U=function(t){return delete this.a[t],_e()},t.ca=function(){},t.ia=function(){},(t=Uu.prototype).get=function(t){var e=this;return _e().then(function(){return Mi(e.a.getItem(t))})},t.set=function(t,e){var n=this;return _e().then(function(){var i=Li(e);null===i?n.U(t):n.a.setItem(t,i)})},t.U=function(t){var e=this;return _e().then(function(){e.a.removeItem(t)})},t.ca=function(t){a.window&&cn(a.window,"storage",t)},t.ia=function(t){a.window&&ln(a.window,"storage",t)},(t=$u.prototype).get=function(){return _e(null)},t.set=function(){return _e()},t.U=function(){return _e()},t.ca=function(){},t.ia=function(){},(t=qu.prototype).get=function(t){var e=this;return _e().then(function(){return Mi(e.a.getItem(t))})},t.set=function(t,e){var n=this;return _e().then(function(){var i=Li(e);null===i?n.U(t):n.a.setItem(t,i)})},t.U=function(t){var e=this;return _e().then(function(){e.a.removeItem(t)})},t.ca=function(){},t.ia=function(){};var Gu,Bu,Wu={F:Uu,bb:qu},Xu={F:Uu,bb:qu},Ju={F:gu,bb:$u},Yu={F:Uu,bb:$u},zu={rd:"local",NONE:"none",td:"session"};function Zu(){var t=!(Fi(Ni())||!bi()),e=Di(),n=Oi();this.m=t,this.h=e,this.l=n,this.a={},Gu||(Gu=new Hu),t=Gu;try{this.g=!ui()&&Ki()||!a.indexedDB?new t.a.F:new ju(yi()?new Fu:new t.a.F)}catch(i){this.g=new Fu,this.h=!0}try{this.i=new t.a.bb}catch(i){this.i=new Fu}this.v=new Fu,this.f=w(this.Yb,this),this.b={}}function Qu(){return Bu||(Bu=new Zu),Bu}function tc(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g;}}function ec(t,e){return"firebase:"+t.name+(e?":"+e:"")}function nc(t,e,n){return n=ec(e,n),"local"==e.F&&(t.b[n]=null),tc(t,e.F).U(n)}function ic(t){t.c&&(clearInterval(t.c),t.c=null)}function rc(t){this.a=t,this.b=Qu()}(t=Zu.prototype).get=function(t,e){return tc(this,t.F).get(ec(t,e))},t.set=function(t,e,n){var i=ec(t,n),r=this,o=tc(this,t.F);return o.set(i,e).then(function(){return o.get(i)}).then(function(e){"local"==t.F&&(r.b[i]=e)})},t.addListener=function(t,e,n){t=ec(t,e),this.l&&(this.b[t]=a.localStorage.getItem(t)),dt(this.a)&&(tc(this,"local").ca(this.f),this.h||(ui()||!Ki())&&a.indexedDB||!this.l||function(t){ic(t),t.c=setInterval(function(){for(var e in t.a){var n=a.localStorage.getItem(e),i=t.b[e];n!=i&&(t.b[e]=n,n=new ze({type:"storage",key:e,target:window,oldValue:i,newValue:n,a:!0}),t.Yb(n))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=ec(t,e),this.a[t]&&(J(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),dt(this.a)&&(tc(this,"local").ia(this.f),ic(this))},t.Yb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var i=this.b[n];void 0===i&&(i=null);var r=a.localStorage.getItem(n);r!==i&&(this.b[n]=r,this.mb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?tc(this,"local").ia(this.f):ic(this),this.m)if(n=a.localStorage.getItem(e),(i=t.a.newValue)!==n)null!==i?a.localStorage.setItem(e,i):a.localStorage.removeItem(e);else if(this.b[e]===i&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===a.localStorage.getItem(e)||(o.b[e]=a.localStorage.getItem(e),o.mb(e))},Xt&&se&&10==se&&a.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else K(t,w(this.mb,this))},t.mb=function(t){this.a[t]&&K(this.a[t],function(t){t()})};var oc,ac={name:"authEvent",F:"local"};function sc(){this.a=Qu()}function uc(t,e){this.b=cc,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=a.Int32Array?new Int32Array(64):Array(64),void 0===oc&&(oc=a.Int32Array?new Int32Array(mc):mc),this.reset()}k(uc,function(){this.b=-1});for(var cc=64,hc=cc-1,fc=[],lc=0;lc<hc;lc++)fc[lc]=0;var dc=Y(128,fc);function pc(t){for(var e=t.f,n=t.l,i=0,r=0;r<e.length;)n[i++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*i;for(e=16;64>e;e++){r=0|n[e-15],i=0|n[e-2];var o=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,a=(0|n[e-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;n[e]=o+a|0}i=0|t.a[0],r=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],f=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var l=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&s^r&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&f)+(0|oc[e])|0)+(0|n[e])|0)|0,o=f,f=h,h=c,c=u+a|0,u=s,s=r,r=i,i=a+l|0}t.a[0]=t.a[0]+i|0,t.a[1]=t.a[1]+r|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+f|0,t.a[7]=t.a[7]+o|0}function vc(t,e,n){void 0===n&&(n=e.length);var i=0,r=t.c;if("string"==typeof e)for(;i<n;)t.f[r++]=e.charCodeAt(i++),r==t.b&&(pc(t),r=0);else{if(!l(e))throw Error("message must be string or array");for(;i<n;){var o=e[i++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[r++]=o,r==t.b&&(pc(t),r=0)}}t.c=r,t.g+=n}uc.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):z(this.h)};var mc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function gc(){uc.call(this,8,bc)}k(gc,uc);var bc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function yc(t,e,n,i,r,o){this.v=t,this.i=e,this.l=n,this.m=i||null,this.u=r||null,this.s=o,this.h=e+":"+n,this.C=new sc,this.g=new rc(this.h),this.f=null,this.b=[],this.a=this.c=null}function wc(t){return new A("invalid-cordova-configuration",t)}function Ic(t){var e=new gc;vc(e,t),t=[];var n=8*e.g;56>e.c?vc(e,dc,56-e.c):vc(e,dc,e.b-(e.c-56));for(var i=63;56<=i;i--)e.f[i]=255&n,n/=256;for(pc(e),i=n=0;i<e.i;i++)for(var r=24;0<=r;r-=8)t[n++]=e.a[i]>>r&255;return function(t){return G(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function Tc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(i){}}function kc(t){return t.f||(t.f=t.ma().then(function(){return new Ie(function(e){t.Ea(function n(i){return e(i),t.Sa(n),!1}),function(t){function e(e){i=!0,r&&r.cancel(),Ec(t).then(function(i){var r=n;if(i&&e&&e.url){var o=null;-1!=(r=io(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Mi(Fn(o=Un(r),"firebaseError")||null))?S(o):null)?new Uo(i.c,i.b,null,null,o,null,i.T()):new Uo(i.c,i.b,r,i.f,null,null,i.T())),r=o||n}Tc(t,r)})}var n=new Uo("unknown",null,null,null,new A("no-auth-event")),i=!1,r=Sn(500).then(function(){return Ec(t).then(function(){i||Tc(t,n)})}),o=a.handleOpenURL;a.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(_i("BuildInfo.packageName",a).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(n){console.error(n)}},Ko||(Ko=new $o),function(t){var e=Ko;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=_i("universalLinks.subscribe",a))&&t(null,e.b))}(e)}(t)})})),t.f}function Ec(t){var e=null;return function(t){return t.b.get(ac,t.a).then(function(t){return Vo(t)})}(t.g).then(function(n){return e=n,nc((n=t.g).b,ac,n.a)}).then(function(){return e})}function Ac(t){this.a=t,this.b=Qu()}(t=yc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(gi(void 0)?mi().then(function(){return new Ie(function(t,e){var n=a.document,i=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(i),t()},!1)})}):Oe(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof _i("universalLinks.subscribe",a))throw wc("cordova-universal-links-plugin-fix is not installed");if(void 0===_i("BuildInfo.packageName",a))throw wc("cordova-plugin-buildinfo is not installed");if("function"!=typeof _i("cordova.plugins.browsertab.openUrl",a))throw wc("cordova-plugin-browsertab is not installed");if("function"!=typeof _i("cordova.InAppBrowser.open",a))throw wc("cordova-plugin-inappbrowser is not installed")},function(){throw new A("cordova-not-ready")})},t.Ob=function(t,e){return e(new A("operation-not-supported-in-this-environment")),_e()},t.Mb=function(){return Oe(new A("operation-not-supported-in-this-environment"))},t.$b=function(){return!1},t.Xb=function(){return!0},t.Tb=function(){return!0},t.Nb=function(t,e,n,i){if(this.c)return Oe(new A("redirect-operation-pending"));var r=this,o=a.document,s=null,u=null,c=null,h=null;return this.c=_e().then(function(){return Fo(e),kc(r)}).then(function(){return function(t,e,n,i,r){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new Uo(e,i,null,o,new A("no-auth-event"),null,r),u=_i("BuildInfo.packageName",a);if("string"!=typeof u)throw new A("invalid-cordova-configuration");var c=_i("BuildInfo.displayName",a),h={};if(Ni().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=u;else{if(!Ni().toLowerCase().match(/android/))return Oe(new A("operation-not-supported-in-this-environment"));h.apn=u}c&&(h.appDisplayName=c),o=Ic(o),h.sessionId=o;var f=mu(t.v,t.i,t.l,e,n,null,i,t.m,h,t.u,r,t.s);return t.ma().then(function(){var e=t.h;return t.C.a.set(ac,s.w(),e)}).then(function(){var e=_i("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof e)throw new A("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=_i("cordova.plugins.browsertab.openUrl",a)))throw new A("invalid-cordova-configuration");n(f)}else{if("function"!=typeof(n=_i("cordova.InAppBrowser.open",a)))throw new A("invalid-cordova-configuration");e=Ni(),t.a=n(f,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(r,t,e,n,i)}).then(function(){return new Ie(function(t,e){u=function(){var e=_i("cordova.plugins.browsertab.close",a);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.Ea(u),c=function(){s||(s=Sn(2e3).then(function(){e(new A("redirect-cancelled-by-user"))}))},h=function(){$i()&&c()},o.addEventListener("resume",c,!1),Ni().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)}).o(function(t){return Ec(r).then(function(){throw t})})}).oa(function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),s&&s.cancel(),u&&r.Sa(u),r.c=null})},t.Ea=function(t){this.b.push(t),kc(this).o(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Uo("unknown",null,null,null,new A("no-auth-event")),t(e))})},t.Sa=function(t){J(this.b,function(e){return e==t})};var Sc={name:"pendingRedirect",F:"session"};function Nc(t){return nc(t.b,Sc,t.a)}function _c(t,e,n,i){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=i,this.h=[],this.f=!1,this.l=w(this.s,this),this.b=new Kc,this.C=new Xc,this.g=new Ac($c(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Oc(this.D,this.v,this.m,N,this.J)}function Oc(t,e,n,i,r){var o=fb.SDK_VERSION||null;return gi()?new yc(t,e,n,o,i,r):new lu(t,e,n,o,i,r)}function Cc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o(function(n){throw t.a==e&&t.reset(),n})}function Rc(t){t.a.Xb()&&Cc(t).o(function(e){var n=new Uo("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));jc(e)&&t.s(n)}),t.a.Tb()||Hc(t.b)}function Pc(t,e){W(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(Sc,t.a).then(function(t){return"pending"==t})}(t.g).then(function(e){e?Nc(t.g).then(function(){Cc(t).o(function(e){var n=new Uo("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));jc(e)&&t.s(n)})}):Rc(t)}).o(function(){Rc(t)})}function Dc(t,e){J(t.h,function(t){return t==e})}_c.prototype.reset=function(){this.f=!1,this.a.Sa(this.l),this.a=Oc(this.D,this.v,this.m,null,this.J),this.i={}},_c.prototype.s=function(t){if(!t)throw new A("invalid-auth-event");if(6e5<=T()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var i=this.h[n];if(i.Fb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,i),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=T())),e=!0;break}}return Hc(this.b),e};var Lc=new Vi(2e3,1e4),xc=new Vi(3e4,6e4);function Mc(t,e,n,i,r,o,a){return t.a.Mb(e,n,i,function(){t.f||(t.f=!0,t.a.Ea(t.l))},function(){t.reset()},r,o,a)}function jc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Fc(t,e,n,i,r){var o;return function(t){return t.b.set(Sc,"pending",t.a)}(t.g).then(function(){return t.a.Nb(e,n,i,r).o(function(e){if(jc(e))throw new A("operation-not-supported-in-this-environment");return o=e,Nc(t.g).then(function(){throw o})}).then(function(){return t.a.$b()?new Ie(function(){}):Nc(t.g).then(function(){return t.qa()}).then(function(){}).o(function(){})})})}function Uc(t,e,n,i,r){return t.a.Ob(i,function(t){e.na(n,null,t,r)},Lc.get())}_c.prototype.qa=function(){return this.b.qa()};var Vc={};function $c(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function qc(t,e,n,i){var r=$c(e,n,i);return Vc[r]||(Vc[r]=new _c(t,e,n,i)),Vc[r]}function Kc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Hc(t){t.g||(t.g=!0,Wc(t,!1,null,null))}function Gc(t){t.g&&!t.i&&Wc(t,!1,null,null)}function Bc(t,e){if(t.b=function(){return _e(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Wc(t,e,n,i){e?i?function(t,e){if(t.b=function(){return Oe(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,i):Bc(t,n):Bc(t,{user:null}),t.f=[],t.c=[]}function Xc(){}function Jc(){this.ib=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ib},set:function(t){this.ib=t},enumerable:!1})}function Yc(t,e){this.a=e,Xi(this,"verificationId",t)}function zc(t,e,n,i){return new xo(t).fb(e,n).then(function(t){return new Yc(t,i)})}function Zc(t){var e=Kr(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new A("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Ji(this,{token:t,expirationTime:qi(1e3*e.exp),authTime:qi(1e3*e.auth_time),issuedAtTime:qi(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function Qc(t,e,n){var i=e&&e[eh];if(!i)throw new A("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=pt(e),this.g=n,this.c=new ro(null,i),this.b=[];var r=this;K(e[th]||[],function(t){(t=Qi(t))&&r.b.push(t)}),Xi(this,"auth",this.a),Xi(this,"session",this.c),Xi(this,"hints",this.b)}Kc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Kc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,i=t.b,r=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!r&&!o),"unknown"!=n||r||o?t.a?(Wc(this,!0,null,t.a),_e()):e.Fa(n,i)?function(t,e,n){n=n.Fa(e.c,e.b);var i=e.g,r=e.f,o=e.i,a=e.T(),s=!!e.c.match(/Redirect$/);n(i,r,a,o).then(function(e){Wc(t,s,e,null)}).o(function(e){Wc(t,s,null,e)})}(this,t,e):Oe(new A("invalid-auth-event")):(Wc(this,!1,null,null),_e())}else Oe(new A("invalid-auth-event"))},Kc.prototype.qa=function(){var t=this;return new Ie(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new A("timeout");t.a&&t.a.cancel(),t.a=Sn(xc.get()).then(function(){t.b||(t.g=!0,Wc(t,!0,null,e))})}(t))})},Xc.prototype.h=function(t,e){if(t){var n=t.c,i=t.b;t.a?(e.na(t.c,null,t.a,t.b),_e()):e.Fa(n,i)?function(t,e){var n=t.b,i=t.c;e.Fa(i,n)(t.g,t.f,t.T(),t.i).then(function(t){e.na(i,t,null,n)}).o(function(t){e.na(i,null,t,n)})}(t,e):Oe(new A("invalid-auth-event"))}else Oe(new A("invalid-auth-event"))},Yc.prototype.confirm=function(t){return t=Mo(this.verificationId,t),this.a(t)};var th="mfaInfo",eh="mfaPendingCredential";function nh(t,e,n,i){A.call(this,"multi-factor-auth-required",i,e),this.b=new Qc(t,e,n),Xi(this,"resolver",this.b)}function ih(t,e,n){if(t&&p(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new nh(e,t.serverResponse,n,t.message)}catch(i){}return null}function rh(){}function oh(t){Xi(this,"factorId",t.fa),this.a=t}function ah(t){if(oh.call(this,t),this.a.fa!=xo.PROVIDER_ID)throw new A("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function sh(t,e){for(var n in Ye.call(this,t),e)this[n]=e[n]}function uh(t,e){this.a=t,this.b=[],this.c=w(this.yc,this),cn(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&K(e.multiFactor.enrolledFactors,function(t){var e=null,i={};if(t){t.uid&&(i[nr]=t.uid),t.displayName&&(i[tr]=t.displayName),t.enrollmentTime&&(i[er]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(i[ir]=t.phoneNumber);try{e=new rr(i)}catch(r){}t=e}else t=null;t&&n.push(t)}),ch(this,n)}function ch(t,e){t.b=e,Xi(t,"enrolledFactors",e)}function hh(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function fh(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function lh(t,e){void 0===e&&(t.b?e=(e=t.b).a-e.g:e=0),t.c=Date.now()+1e3*e}function dh(t,e){t.b=qr(e[Ya]||""),t.a=e.refreshToken,lh(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function ph(t,e){return function(t,e){return new Ie(function(n,i){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?os(t,t.l+"?key="+encodeURIComponent(t.c),function(t){t?t.error?i(iu(t)):t.access_token&&t.refresh_token?n(t):i(new A("internal-error")):i(new A("network-request-failed"))},"POST",zn(e).toString(),t.g,t.m.get()):i(new A("internal-error"))})}(t.f,e).then(function(e){return t.b=qr(e.access_token),t.a=e.refresh_token,lh(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}}).o(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function vh(t,e){this.a=t||null,this.b=e||null,Ji(this,{lastSignInTime:qi(e||null),creationTime:qi(t||null)})}function mh(t,e,n,i,r,o){Ji(this,{uid:t,displayName:i||null,photoURL:r||null,email:n||null,phoneNumber:o||null,providerId:e})}function gh(t,e,n){this.J=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var i=fb.SDK_VERSION?Si(fb.SDK_VERSION):null;this.a=new Xa(this.l,R(N),i),t.emulatorConfig&&ns(this.a,t.emulatorConfig),this.b=new fh(this.a),Ah(this,e[Ya]),dh(this.b,e),Xi(this,"refreshToken",this.b.a),_h(this,n||{}),In.call(this),this.R=!1,this.s&&Ci()&&(this.i=qc(this.s,this.l,this.m)),this.S=[],this.h=null,this.u=function(t){return new hh(function(){return t.I(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.b.c-Date.now()-3e5;return 0<e?e:0})}(this),this.aa=w(this.hb,this);var r=this;this.ya=null,this.Oa=function(t){r.wa(t.h)},this.ja=null,this.Aa=function(t){ns(r.a,t.c)},this.X=null,this.$=[],this.Ba=function(t){wh(r,t.f)},this.ba=null,this.O=new uh(this,n),Xi(this,"multiFactor",this.O)}function bh(t,e){t.ja&&ln(t.ja,"languageCodeChanged",t.Oa),(t.ja=e)&&cn(e,"languageCodeChanged",t.Oa)}function yh(t,e){t.X&&ln(t.X,"emulatorConfigChanged",t.Aa),(t.X=e)&&cn(e,"emulatorConfigChanged",t.Aa)}function wh(t,e){t.$=e,rs(t.a,fb.SDK_VERSION?Si(fb.SDK_VERSION,t.$):null)}function Ih(t,e){t.ba&&ln(t.ba,"frameworkChanged",t.Ba),(t.ba=e)&&cn(e,"frameworkChanged",t.Ba)}function Th(t){try{return fb.app(t.m).auth()}catch(e){throw new A("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function kh(t){t.D||t.u.b||(t.u.start(),ln(t,"tokenChanged",t.aa),cn(t,"tokenChanged",t.aa))}function Eh(t){ln(t,"tokenChanged",t.aa),t.u.stop()}function Ah(t,e){t.za=e,Xi(t,"_lat",e)}function Sh(t){for(var e=[],n=0;n<t.S.length;n++)e.push(t.S[n](t));return Re(e).then(function(){return t})}function Nh(t){t.i&&!t.R&&(t.R=!0,Pc(t.i,t))}function _h(t,e){Ji(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new vh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Oh(){}function Ch(t){return _e().then(function(){if(t.D)throw new A("app-deleted")})}function Rh(t){return G(t.providerData,function(t){return t.providerId})}function Ph(t,e){e&&(Dh(t,e.providerId),t.providerData.push(e))}function Dh(t,e){J(t.providerData,function(t){return t.providerId==e})}function Lh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Xi(t,e,n)}function xh(t,e){t!=e&&(Ji(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Xi(t,"metadata",function(t){return new vh(t.a,t.b)}(e.metadata)):Xi(t,"metadata",new vh),K(e.providerData,function(e){Ph(t,e)}),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.b,e.b),Xi(t,"refreshToken",t.b.a),ch(t.O,e.O.b))}function Mh(t){return t.I().then(function(e){var n=t.isAnonymous;return function(t,e){return eu(t.a,Ps,{idToken:e}).then(w(t.Kc,t))}(t,e).then(function(){return n||Lh(t,"isAnonymous",!1),e})})}function jh(t,e){e[Ya]&&t.za!=e[Ya]&&(dh(t.b,e),t.dispatchEvent(new sh("tokenChanged")),Ah(t,e[Ya]),Lh(t,"refreshToken",t.b.a))}function Fh(t,e){return Mh(t).then(function(){if(W(Rh(t),e))return Sh(t).then(function(){throw new A("provider-already-linked")})})}function Uh(t,e,n){return Yi({user:t,credential:jo(e),additionalUserInfo:e=Xr(e),operationType:n})}function Vh(t,e){return jh(t,e),t.reload().then(function(){return t})}function $h(t,e,n,i,r){if(!Ci())return Oe(new A("operation-not-supported-in-this-environment"));if(t.h&&!r)return Oe(t.h);var o=Wr(n.providerId),a=ji(t.uid+":::"),s=null;(!Di()||bi())&&t.s&&n.isOAuthProvider&&(s=mu(t.s,t.l,t.m,e,n,null,a,fb.SDK_VERSION||null,null,null,t.tenantId));var u=di(s,o&&o.ua,o&&o.ta);return i=i().then(function(){if(Kh(t),!r)return t.I().then(function(){})}).then(function(){return Mc(t.i,u,e,n,a,!!s,t.tenantId)}).then(function(){return new Ie(function(n,i){t.na(e,null,new A("cancelled-popup-request"),t.g||null),t.f=n,t.C=i,t.g=a,t.c=Uc(t.i,t,e,u,a)})}).then(function(t){return u&&li(u),t?Yi(t):null}).o(function(t){throw u&&li(u),t}),Hh(t,i,r)}function qh(t,e,n,i,r){if(!Ci())return Oe(new A("operation-not-supported-in-this-environment"));if(t.h&&!r)return Oe(t.h);var o=null,a=ji(t.uid+":::");return i=i().then(function(){if(Kh(t),!r)return t.I().then(function(){})}).then(function(){return t.ga=a,Sh(t)}).then(function(e){return t.ha&&(e=(e=t.ha).b.set(Wh,t.w(),e.a)),e}).then(function(){return Fc(t.i,e,n,a,t.tenantId)}).o(function(e){if(o=e,t.ha)return Xh(t.ha);throw o}).then(function(){if(o)throw o}),Hh(t,i,r)}function Kh(t){if(!t.i||!t.R){if(t.i&&!t.R)throw new A("internal-error");throw new A("auth-domain-config-required")}}function Hh(t,e,n){var i=function(t,e,n){return t.h&&!n?(e.cancel(),Oe(t.h)):e.o(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.h||t.dispatchEvent(new sh("userInvalidated")),t.h=e),e})}(t,e,n);return t.J.push(i),i.oa(function(){X(t.J,i)}),i.o(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=ih(e.w(),Th(t),w(t.jc,t))),n||e})}function Gh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Ya]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var i=t.stsTokenManager.expirationTime;i&&(n.expiresIn=(i-Date.now())/1e3);var r=new gh(e,n,t);return t.providerData&&K(t.providerData,function(t){t&&Ph(r,Yi(t))}),t.redirectEventId&&(r.ga=t.redirectEventId),r}function Bh(t){this.a=t,this.b=Qu()}Qc.prototype.Rc=function(t){var e=this;return t.sb(this.a.a,this.c).then(function(t){var n=pt(e.f);return delete n[th],delete n[eh],mt(n,t),e.g(n)})},k(nh,A),rh.prototype.sb=function(t,e,n){return e.type==oo?function(t,e,n,i){return n.Ha().then(function(n){return n={idToken:n},void 0!==i&&(n.displayName=i),mt(n,{phoneVerificationInfo:Lo(t.a)}),eu(e,Cs,n)})}(this,t,e,n):function(t,e,n){return n.Ha().then(function(n){return mt(n={mfaPendingCredential:n},{phoneVerificationInfo:Lo(t.a)}),eu(e,Rs,n)})}(this,t,e)},k(oh,rh),k(ah,oh),k(sh,Ye),(t=uh.prototype).yc=function(t){ch(this,function(t){var e=[];return K(t.mfaInfo||[],function(t){(t=Qi(t))&&e.push(t)}),e}(t.hd))},t.Rb=function(){return this.a.I().then(function(t){return new ro(t,null)})},t.fc=function(t,e){var n=this,i=this.a.a;return this.Rb().then(function(n){return t.sb(i,n,e)}).then(function(t){return jh(n.a,t),n.a.reload()})},t.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,i=this.a.a;return this.a.I().then(function(t){return eu(i,tu,{idToken:t,mfaEnrollmentId:n})}).then(function(t){var i=H(e.b,function(t){return t.uid!=n});return ch(e,i),jh(e.a,t),e.a.reload().o(function(t){if("auth/user-token-expired"!=t.code)throw t})})},t.w=function(){return{multiFactor:{enrolledFactors:G(this.b,function(t){return t.w()})}}},hh.prototype.start=function(){this.a=this.c,function t(e,n){e.stop();e.b=Sn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then(function(){return t=a.document,e=null,$i()||!t?_e():new Ie(function(n){e=function(){$i()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).o(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).o(function(n){e.i(n)&&t(e,!1)})}(this,!0)},hh.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},fh.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},fh.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Oe(new A("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?ph(this,{grant_type:"refresh_token",refresh_token:this.a}):_e(null):_e({accessToken:this.b.toString(),refreshToken:this.a})},vh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},k(gh,In),gh.prototype.wa=function(t){this.ya=t,es(this.a,t)},gh.prototype.la=function(){return this.ya},gh.prototype.Ga=function(){return z(this.$)},gh.prototype.hb=function(){this.u.b&&(this.u.stop(),this.u.start())},Xi(gh.prototype,"providerId","firebase"),(t=gh.prototype).reload=function(){var t=this;return Hh(this,Ch(this).then(function(){return Mh(t).then(function(){return Sh(t)}).then(Oh)}))},t.oc=function(t){return this.I(t).then(function(t){return new Zc(t)})},t.I=function(t){var e=this;return Hh(this,Ch(this).then(function(){return e.b.getToken(t)}).then(function(t){if(!t)throw new A("internal-error");return t.accessToken!=e.za&&(Ah(e,t.accessToken),e.dispatchEvent(new sh("tokenChanged"))),Lh(e,"refreshToken",t.refreshToken),t.accessToken}))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new A("internal-error");_h(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?G(t,function(t){return new mh(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)Ph(this,e[n]);Lh(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new sh("userReloaded",{hd:t}))},t.Lc=function(t){return Bi("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.tb(t)},t.tb=function(t){var e=this,n=null;return Hh(this,t.c(this.a,this.uid).then(function(t){return jh(e,t),n=Uh(e,t,"reauthenticate"),e.h=null,e.reload()}).then(function(){return n}),!0)},t.Cc=function(t){return Bi("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.qb(t)},t.qb=function(t){var e=this,n=null;return Hh(this,Fh(this,t.providerId).then(function(){return e.I()}).then(function(n){return t.b(e.a,n)}).then(function(t){return n=Uh(e,t,"link"),Vh(e,t)}).then(function(){return n}))},t.Dc=function(t,e){var n=this;return Hh(this,Fh(this,"phone").then(function(){return zc(Th(n),t,e,w(n.qb,n))}))},t.Mc=function(t,e){var n=this;return Hh(this,_e().then(function(){return zc(Th(n),t,e,w(n.tb,n))}),!0)},t.Bb=function(t){var e=this;return Hh(this,this.I().then(function(n){return e.a.Bb(n,t)}).then(function(t){return jh(e,t),e.reload()}))},t.ed=function(t){var e=this;return Hh(this,this.I().then(function(n){return t.b(e.a,n)}).then(function(t){return jh(e,t),e.reload()}))},t.Cb=function(t){var e=this;return Hh(this,this.I().then(function(n){return e.a.Cb(n,t)}).then(function(t){return jh(e,t),e.reload()}))},t.Db=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Ch(this);var e=this;return Hh(this,this.I().then(function(n){return e.a.Db(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return jh(e,t),Lh(e,"displayName",t.displayName||null),Lh(e,"photoURL",t.photoUrl||null),K(e.providerData,function(t){"password"===t.providerId&&(Xi(t,"displayName",e.displayName),Xi(t,"photoURL",e.photoURL))}),Sh(e)}).then(Oh))},t.cd=function(t){var e=this;return Hh(this,Mh(this).then(function(n){return W(Rh(e),t)?function(t,e,n){return eu(t,Ns,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then(function(t){var n={};return K(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),K(Rh(e),function(t){n[t]||Dh(e,t)}),n[xo.PROVIDER_ID]||Xi(e,"phoneNumber",null),Sh(e)}):Sh(e).then(function(){throw new A("no-such-provider")})}))},t.delete=function(){var t=this;return Hh(this,this.I().then(function(e){return eu(t.a,Ss,{idToken:e})}).then(function(){t.dispatchEvent(new sh("userDeleted"))})).then(function(){for(var e=0;e<t.J.length;e++)t.J[e].cancel("app-deleted");bh(t,null),yh(t,null),Ih(t,null),t.J=[],t.D=!0,Eh(t),Xi(t,"refreshToken",null),t.i&&Dc(t.i,t)})},t.Fb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,i){"linkViaPopup"!=t&&"reauthViaPopup"!=t||i!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?w(this.Kb,this):"reauthViaPopup"==t&&e==(this.g||null)?w(this.Lb,this):"linkViaRedirect"==t&&(this.ga||null)==e?w(this.Kb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?w(this.Lb,this):null},t.Ec=function(t){var e=this;return $h(this,"linkViaPopup",t,function(){return Fh(e,t.providerId).then(function(){return Sh(e)})},!1)},t.Nc=function(t){return $h(this,"reauthViaPopup",t,function(){return _e()},!0)},t.Fc=function(t){var e=this;return qh(this,"linkViaRedirect",t,function(){return Fh(e,t.providerId)},!1)},t.Oc=function(t){return qh(this,"reauthViaRedirect",t,function(){return _e()},!0)},t.Kb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Hh(this,this.I().then(function(n){return ys(r.a,{requestUri:t,postBody:i,sessionId:e,idToken:n})}).then(function(t){return o=Uh(r,t,"link"),Vh(r,t)}).then(function(){return o}))},t.Lb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Hh(this,_e().then(function(){return uo(ws(r.a,{requestUri:t,sessionId:e,postBody:i,tenantId:n}),r.uid)}).then(function(t){return o=Uh(r,t,"reauthenticate"),jh(r,t),r.h=null,r.reload()}).then(function(){return o}),!0)},t.ub=function(t){var e=this,n=null;return Hh(this,this.I().then(function(e){return n=e,void 0===t||dt(t)?{}:Fr(new _r(t))}).then(function(t){return e.a.ub(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},t.Eb=function(t,e){var n=this,i=null;return Hh(this,this.I().then(function(t){return i=t,void 0===e||dt(e)?{}:Fr(new _r(e))}).then(function(e){return n.a.Eb(i,t,e)}).then(function(t){if(n.email!=t)return n.reload()}).then(function(){}))},t.jc=function(t){var e=null,n=this;return Hh(this,t=uo(_e(t),n.uid).then(function(t){return e=Uh(n,t,"reauthenticate"),jh(n,t),n.h=null,n.reload()}).then(function(){return e}),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&mt(t,this.metadata.w()),K(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),mt(t,this.O.w()),t};var Wh={name:"redirectUser",F:"session"};function Xh(t){return nc(t.b,Wh,t.a)}function Jh(t){this.a=t,this.b=Qu(),this.c=null,this.f=function(t){var e=Zh("local"),n=Zh("session"),i=Zh("none");return function(t,e,n){var i=ec(e,n),r=tc(t,e.F);return t.get(e,n).then(function(o){var s=null;try{s=Mi(a.localStorage.getItem(i))}catch(u){}if(s&&!o)return a.localStorage.removeItem(i),t.set(e,s,n);s&&o&&"localStorage"!=r.type&&a.localStorage.removeItem(i)})}(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(r){return r?n:t.b.get(i,t.a).then(function(n){return n?i:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(zh,t.a).then(function(t){return t?Zh(t):e})})})}).then(function(e){return t.c=e,Yh(t,e.F)}).o(function(){t.c||(t.c=e)})}(this),this.b.addListener(Zh("local"),this.a,w(this.g,this))}function Yh(t,e){var n,i=[];for(n in zu)zu[n]!==e&&i.push(nc(t.b,Zh(zu[n]),t.a));return i.push(nc(t.b,zh,t.a)),function(t){return new Ie(function(e,n){var i=t.length,r=[];if(i)for(var o=function(t,n){i--,r[t]=n,0==i&&e(r)},a=function(t){n(t)},s=0;s<t.length;s++)Ce(t[s],I(o,s),a);else e(r)})}(i)}Jh.prototype.g=function(){var t=this,e=Zh("local");nf(this,function(){return _e().then(function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null}).then(function(n){if(n)return Yh(t,"local").then(function(){t.c=e})})})};var zh={name:"persistence",F:"session"};function Zh(t){return{name:"authUser",F:t}}function Qh(t,e){return nf(t,function(){return t.b.set(t.c,e.w(),t.a)})}function tf(t){return nf(t,function(){return nc(t.b,t.c,t.a)})}function ef(t,e,n){return nf(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Gh(t||{})})})}function nf(t,e){return t.f=t.f.then(e,e),t.f}function rf(t){if(this.l=!1,Xi(this,"settings",new Jc),Xi(this,"app",t),!df(this).options||!df(this).options.apiKey)throw new A("invalid-api-key");t=fb.SDK_VERSION?Si(fb.SDK_VERSION):null,this.a=new Xa(df(this).options&&df(this).options.apiKey,R(N),t),this.R=[],this.s=[],this.O=[],this.hb=fb.INTERNAL.createSubscribe(w(this.zc,this)),this.X=void 0,this.bc=fb.INTERNAL.createSubscribe(w(this.Ac,this)),ff(this,null),this.i=new Jh(df(this).options.apiKey+":"+df(this).name),this.D=new Bh(df(this).options.apiKey+":"+df(this).name),this.$=gf(this,function(t){var e=df(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Wh,t.a).then(function(t){return t&&e&&(t.authDomain=e),Gh(t||{})})}(t.D,df(t).options.authDomain).then(function(e){return(t.m=e)&&(e.ha=t.D),Xh(t.D)});return gf(t,e)}(t).then(function(){return ef(t.i,e,t.P)}).then(function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then(function(){return Qh(t.i,e).then(function(){return e})}).o(function(n){return"auth/network-request-failed"==n.code?e:tf(t.i)})):null}).then(function(e){ff(t,e||null)});return gf(t,n)}(this)),this.h=gf(this,function(t){return t.$.then(function(){return cf(t)}).o(function(){}).then(function(){if(!t.l)return t.ja()}).o(function(){}).then(function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener(Zh("local"),e.a,t.ja)}})}(this)),this.ba=!1,this.ja=w(this.Zc,this),this.Ba=w(this.da,this),this.ya=w(this.mc,this),this.za=w(this.wc,this),this.Aa=w(this.xc,this),this.b=null,function(t){var e=df(t).options.authDomain,n=df(t).options.apiKey;e&&Ci()&&(t.Oa=t.$.then(function(){if(!t.l){if(t.b=qc(e,n,df(t).name,t.P),Pc(t.b,t),pf(t)&&Nh(pf(t)),t.m){Nh(t.m);var i=t.m;i.wa(t.la()),bh(i,t),wh(i=t.m,t.J),Ih(i,t),ns((i=t.m).a,t.P),yh(i,t),t.m=null}return t.b}}))}(this),this.INTERNAL={},this.INTERNAL.delete=w(this.delete,this),this.INTERNAL.logFramework=w(this.Gc,this),this.u=0,In.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.yb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.P){var t=Un(this.P.url);t=Yi({protocol:t.c,host:t.a,port:t.g,options:Yi({disableWarnings:this.P.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.P=null}function of(t){Ye.call(this,"languageCodeChanged"),this.h=t}function af(t){Ye.call(this,"emulatorConfigChanged"),this.c=t}function sf(t){Ye.call(this,"frameworkChanged"),this.f=t}function uf(t){return t.Oa||Oe(new A("auth-domain-config-required"))}function cf(t){if(!Ci())return Oe(new A("operation-not-supported-in-this-environment"));var e=uf(t).then(function(){return t.b.qa()}).then(function(t){return t?Yi(t):null});return gf(t,e)}function hf(t,e){var n={};return n.apiKey=df(t).options.apiKey,n.authDomain=df(t).options.authDomain,n.appName=df(t).name,t.P&&(n.emulatorConfig=t.P),t.$.then(function(){return function(t,e,n,i){var r=new gh(t,e);return n&&(r.ha=n),i&&wh(r,i),r.reload().then(function(){return r})}(n,e,t.D,t.Ga())}).then(function(e){return pf(t)&&e.uid==pf(t).uid?(xh(pf(t),e),t.da(e)):(ff(t,e),Nh(e),t.da(e))}).then(function(){mf(t)})}function ff(t,e){pf(t)&&(function(t,e){J(t.S,function(t){return t==e})}(pf(t),t.Ba),ln(pf(t),"tokenChanged",t.ya),ln(pf(t),"userDeleted",t.za),ln(pf(t),"userInvalidated",t.Aa),Eh(pf(t))),e&&(e.S.push(t.Ba),cn(e,"tokenChanged",t.ya),cn(e,"userDeleted",t.za),cn(e,"userInvalidated",t.Aa),0<t.u&&kh(e)),Xi(t,"currentUser",e),e&&(e.wa(t.la()),bh(e,t),wh(e,t.J),Ih(e,t),ns(e.a,t.P),yh(e,t))}function lf(t,e){var n=null,i=null;return gf(t,e.then(function(e){return n=jo(e),i=Xr(e),hf(t,e)},function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=ih(e.w(),t,w(t.kc,t))),n||e}).then(function(){return Yi({user:pf(t),credential:n,additionalUserInfo:i,operationType:"signIn"})}))}function df(t){return t.app}function pf(t){return t.currentUser}function vf(t){return pf(t)&&pf(t)._lat||null}function mf(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](vf(t));if(t.X!==t.getUid()&&t.O.length)for(t.X=t.getUid(),e=0;e<t.O.length;e++)t.O[e]&&t.O[e](vf(t))}}function gf(t,e){return t.R.push(e),e.oa(function(){X(t.R,e)}),e}function bf(){}function yf(){this.a={},this.b=1e12}Jh.prototype.xb=function(t){var e=null,n=this;return function(t){var e=new A("invalid-persistence-type"),n=new A("unsupported-persistence-type");t:{for(i in zu)if(zu[i]==t){var i=!0;break t}i=!1}if(!i||"string"!=typeof t)throw e;switch(wi()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Cu()&&"none"!==t)throw n;break;default:if(!Oi()&&"none"!==t)throw n;}}(t),nf(this,function(){return t!=n.c.F?n.b.get(n.c,n.a).then(function(i){return e=i,Yh(n,t)}).then(function(){if(n.c=Zh(t),e)return n.b.set(n.c,e,n.a)}):_e()})},k(rf,In),k(of,Ye),k(af,Ye),k(sf,Ye),(t=rf.prototype).xb=function(t){return gf(this,t=this.i.xb(t))},t.wa=function(t){this.aa===t||this.l||(this.aa=t,es(this.a,this.aa),this.dispatchEvent(new of(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=a.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.P){if(!/^https?:\/\//.test(t))throw new A("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),a.document&&!t&&mi().then(function(){var t=a.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),a.document.body.appendChild(t)})})(e=!!e&&!!e.disableWarnings),this.P={url:t,ec:e},this.settings.ib=!0,ns(this.a,this.P),this.dispatchEvent(new af(this.P))}},t.Gc=function(t){this.J.push(t),rs(this.a,fb.SDK_VERSION?Si(fb.SDK_VERSION,this.J):null),this.dispatchEvent(new sf(this.J))},t.Ga=function(){return z(this.J)},t.yb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:df(this).options.apiKey,authDomain:df(this).options.authDomain,appName:df(this).name,currentUser:pf(this)&&pf(this).w()}},t.Fb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1;}},t.na=function(t,e,n,i){"signInViaPopup"==t&&this.g==i&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?w(this.ic,this):null},t.ic=function(t,e,n,i){var r=this,o={requestUri:t,postBody:i,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),r.$.then(function(){return lf(r,bs(r.a,o))})},t.Xc=function(t){if(!Ci())return Oe(new A("operation-not-supported-in-this-environment"));var e=this,n=Wr(t.providerId),i=ji(),r=null;(!Di()||bi())&&df(this).options.authDomain&&t.isOAuthProvider&&(r=mu(df(this).options.authDomain,df(this).options.apiKey,df(this).name,"signInViaPopup",t,null,i,fb.SDK_VERSION||null,null,null,this.T(),this.P));var o=di(r,n&&n.ua,n&&n.ta);return gf(this,n=uf(this).then(function(n){return Mc(n,o,"signInViaPopup",t,i,!!r,e.T())}).then(function(){return new Ie(function(t,n){e.na("signInViaPopup",null,new A("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=i,e.c=Uc(e.b,e,"signInViaPopup",o,i)})}).then(function(t){return o&&li(o),t?Yi(t):null}).o(function(t){throw o&&li(o),t}))},t.Yc=function(t){if(!Ci())return Oe(new A("operation-not-supported-in-this-environment"));var e=this;return gf(this,uf(this).then(function(){return nf(t=e.i,function(){return t.b.set(zh,t.c.F,t.a)});var t}).then(function(){return Fc(e.b,"signInViaRedirect",t,void 0,e.T())}))},t.qa=function(){var t=this;return cf(this).then(function(e){return t.b&&Gc(t.b.b),e}).o(function(e){throw t.b&&Gc(t.b.b),e})},t.dd=function(t){if(!t)return Oe(new A("null-user"));if(this.S!=t.tenantId)return Oe(new A("tenant-id-mismatch"));var e=this,n={};n.apiKey=df(this).options.apiKey,n.authDomain=df(this).options.authDomain,n.appName=df(this).name;var i=function(t,e,n,i){var r=t.b,o={};return o[Ya]=r.b&&r.b.toString(),o.refreshToken=r.a,e=new gh(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),i&&wh(e,i),xh(e,t),e}(t,n,e.D,e.Ga());return gf(this,this.h.then(function(){if(df(e).options.apiKey!=t.l)return i.reload()}).then(function(){return pf(e)&&t.uid==pf(e).uid?(xh(pf(e),t),e.da(t)):(ff(e,i),Nh(i),e.da(i))}).then(function(){mf(e)}))},t.Ab=function(){var t=this;return gf(this,this.h.then(function(){return t.b&&Gc(t.b.b),pf(t)?(ff(t,null),tf(t.i).then(function(){mf(t)})):_e()}))},t.Zc=function(){var t=this;return ef(this.i,df(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=pf(t)&&e){n=pf(t).uid;var i=e.uid;n=null!=n&&""!==n&&null!=i&&""!==i&&n==i}if(n)return xh(pf(t),e),pf(t).I();(pf(t)||e)&&(ff(t,e),e&&(Nh(e),e.ha=t.D),t.b&&Pc(t.b,t),mf(t))}})},t.da=function(t){return Qh(this.i,t)},t.mc=function(){mf(this),this.da(pf(this))},t.wc=function(){this.Ab()},t.xc=function(){this.Ab()},t.kc=function(t){var e=this;return this.h.then(function(){return lf(e,_e(t))})},t.zc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(pf(e))})},t.Ac=function(t){var e=this;!function(t,e){t.O.push(e),gf(t,t.h.then(function(){!t.l&&W(t.O,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(vf(t)))}))}(this,function(){t.next(pf(e))})},t.Ic=function(t,e,n){var i=this;return this.ba&&Promise.resolve().then(function(){"function"==typeof t?t(pf(i)):"function"==typeof t.next&&t.next(pf(i))}),this.hb(t,e,n)},t.Hc=function(t,e,n){var i=this;return this.ba&&Promise.resolve().then(function(){i.X=i.getUid(),"function"==typeof t?t(pf(i)):"function"==typeof t.next&&t.next(pf(i))}),this.bc(t,e,n)},t.nc=function(t){var e=this;return gf(this,this.h.then(function(){return pf(e)?pf(e).I(t).then(function(t){return{accessToken:t}}):null}))},t.Tc=function(t){var e=this;return this.h.then(function(){return lf(e,eu(e.a,Js,{token:t}))}).then(function(t){var n=t.user;return Lh(n,"isAnonymous",!1),e.da(n),t})},t.Uc=function(t,e){var n=this;return this.h.then(function(){return lf(n,eu(n.a,Ys,{email:t,password:e}))})},t.dc=function(t,e){var n=this;return this.h.then(function(){return lf(n,eu(n.a,Es,{email:t,password:e}))})},t.$a=function(t){var e=this;return this.h.then(function(){return lf(e,t.ka(e.a))})},t.Sc=function(t){return Bi("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.$a(t)},t.zb=function(){var t=this;return this.h.then(function(){var e=pf(t);if(e&&e.isAnonymous){var n=Yi({providerId:null,isNewUser:!1});return Yi({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return lf(t,t.a.zb()).then(function(e){var n=e.user;return Lh(n,"isAnonymous",!0),t.da(n),e})})},t.getUid=function(){return pf(this)&&pf(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&pf(this)&&kh(pf(this))},t.Pc=function(t){var e=this;K(this.s,function(n){n==t&&e.u--}),0>this.u&&(this.u=0),0==this.u&&pf(this)&&Eh(pf(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),gf(this,this.h.then(function(){e.l||W(e.s,t)&&t(vf(e))}))},t.removeAuthTokenListener=function(t){J(this.s,function(e){return e==t})},t.delete=function(){this.l=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.i&&(t=this.i).b.removeListener(Zh("local"),t.a,this.ja),this.b&&(Dc(this.b,this),Gc(this.b.b)),Promise.resolve()},t.hc=function(t){return gf(this,function(t,e){return eu(t,As,{identifier:e,continueUri:Ri()?ci():"http://localhost"}).then(function(t){return t.signinMethods||[]})}(this.a,t))},t.Bc=function(t){return!!Ro(t)},t.wb=function(t,e){var n=this;return gf(this,_e().then(function(){var t=new _r(e);if(!t.c)throw new A("argument-error",Rr+" must be true when sending sign in link to email");return Fr(t)}).then(function(e){return n.a.wb(t,e)}).then(function(){}))},t.jd=function(t){return this.Ra(t).then(function(t){return t.data.email})},t.nb=function(t,e){return gf(this,this.a.nb(t,e).then(function(){}))},t.Ra=function(t){return gf(this,this.a.Ra(t).then(function(t){return new or(t)}))},t.jb=function(t){return gf(this,this.a.jb(t).then(function(){}))},t.vb=function(t,e){var n=this;return gf(this,_e().then(function(){return void 0===e||dt(e)?{}:Fr(new _r(e))}).then(function(e){return n.a.vb(t,e)}).then(function(){}))},t.Wc=function(t,e){return gf(this,zc(this,t,e,w(this.$a,this)))},t.Vc=function(t,e){var n=this;return gf(this,_e().then(function(){var i=e||ci(),r=Co(t,i);if(!(i=Ro(i)))throw new A("argument-error","Invalid email link!");if(i.tenantId!==n.T())throw new A("tenant-id-mismatch");return n.$a(r)}))},bf.prototype.render=function(){},bf.prototype.reset=function(){},bf.prototype.getResponse=function(){},bf.prototype.execute=function(){};var wf=null;function If(t,e){return(e=Tf(e))&&t.a[e]||null}function Tf(t){return(t=void 0===t?1e12:t)?t.toString():null}function kf(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=ce(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():cn(this.f,"click",this.i)}function Ef(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Af(){}function Sf(){}yf.prototype.render=function(t,e){return this.a[this.b.toString()]=new kf(t,e),this.b++},yf.prototype.reset=function(t){var e=If(this,t);t=Tf(t),e&&t&&(e.delete(),delete this.a[t])},yf.prototype.getResponse=function(t){return(t=If(this,t))?t.getResponse():null},yf.prototype.execute=function(t){(t=If(this,t))&&t.execute()},kf.prototype.getResponse=function(){return Ef(this),this.b},kf.prototype.execute=function(){Ef(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(i){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(i){}t.h&&t.execute()},6e4)},500))},kf.prototype.delete=function(){Ef(this),this.g=!0,clearTimeout(this.a),this.a=null,ln(this.f,"click",this.i)},Xi(Af,"FACTOR_ID","phone"),Sf.prototype.g=function(){return wf||(wf=new yf),_e(wf)},Sf.prototype.c=function(){};var Nf=null;function _f(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Of=new bt(Tt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Cf=new Vi(3e4,6e4);_f.prototype.g=function(t){var e=this;return new Ie(function(n,i){var r=setTimeout(function(){i(new A("network-request-failed"))},Cf.get());!a.grecaptcha||t!==e.f&&!e.b?(a[e.a]=function(){if(a.grecaptcha){e.f=t;var o=a.grecaptcha.render;a.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(r),n(a.grecaptcha)}else clearTimeout(r),i(new A("internal-error"));delete a[e.a]},_e($a(St(Of,{onload:e.a,hl:t||""}))).o(function(){clearTimeout(r),i(new A("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(r),n(a.grecaptcha))})},_f.prototype.c=function(){this.b--};var Rf=null;function Pf(t,e,n,i,r,o,s){if(Xi(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.v=e,this.g=null,s?(Nf||(Nf=new Sf),s=Nf):(Rf||(Rf=new _f),s=Rf),this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[xf])throw new A("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Mf],!a.document)throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!ce(e)||!this.i&&ce(e).hasChildNodes())throw new A("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new Xa(t,o||null,r||null),this.u=i||function(){return null};var u=this;this.l=[];var c=this.a[Df];this.a[Df]=function(t){if(jf(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=_i(c,a);"function"==typeof e&&e(t)}};var h=this.a[Lf];this.a[Lf]=function(){if(jf(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=_i(h,a);"function"==typeof t&&t()}}}var Df="callback",Lf="expired-callback",xf="sitekey",Mf="size";function jf(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(i){}}function Ff(t,e){return t.h.push(e),e.oa(function(){X(t.h,e)}),e}function Uf(t){if(t.D)throw new A("internal-error","RecaptchaVerifier instance has been destroyed.")}function Vf(t,e,n){var i=!1;try{this.b=n||fb.app()}catch(a){throw new A("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new A("invalid-api-key");n=this.b.options.apiKey;var r=this,o=null;try{o=this.b.auth().Ga()}catch(a){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(a){}o=fb.SDK_VERSION?Si(fb.SDK_VERSION,o):null,Pf.call(this,n,t,e,function(){try{var t=r.b.auth().la()}catch(e){t=null}return t},o,R(N),i)}function $f(t,e,n,i){t:{n=Array.prototype.slice.call(n);for(var r=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new A("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(o=e.length,n.length<r||o<n.length)i="Expected "+(r==o?1==r?"1 argument":r+" arguments":r+"-"+o+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(o=e[r].optional&&void 0===n[r],!e[r].M(n[r])&&!o){if(e=e[r],0>r||r>=qf.length)throw new A("internal-error","Argument validator received an unsupported number of arguments.");n=qf[r],i=(i?"":n+" argument ")+(e.name?"\""+e.name+"\" ":"")+"must be "+e.K+".";break t}i=null}}if(i)throw new A("argument-error",t+" failed: "+i)}(t=Pf.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Ff(this,_e().then(function(){if(Ri()&&!yi())return mi();throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.m.g(t.u())}).then(function(e){return t.g=e,eu(t.s,Fs,{})}).then(function(e){t.a[xf]=e.recaptchaSiteKey}).o(function(e){throw t.f=null,e}))},t.render=function(){Uf(this);var t=this;return Ff(this,this.Ia().then(function(){if(null===t.c){var e=t.v;if(!t.i){var n=ce(e);e=pe("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},t.verify=function(){Uf(this);var t=this;return Ff(this,this.render().then(function(e){return new Ie(function(n){var i=t.g.getResponse(e);if(i)n(i);else{var r=function(e){e&&(function(t,e){J(t.l,function(t){return t==e})}(t,r),n(e))};t.l.push(r),t.i&&t.g.execute(t.c)}})}))},t.reset=function(){Uf(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Uf(this),this.D=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=ce(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},k(Vf,Pf);var qf="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Kf(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function Hf(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function Gf(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:p}}function Bf(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function Wf(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function Xf(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function Jf(t,e){return p(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Yf(t){return p(t)&&"string"==typeof t.uid}function zf(t,e,n,i){return{name:n||"",K:t.K+" or "+e.K,optional:!!i,M:function(n){return t.M(n)||e.M(n)}}}function Zf(t,e){for(var n in e){var i=e[n].name;t[i]=el(i,t[n],e[n].j)}}function Qf(t,e){for(var n in e){var i=e[n].name;i!==n&&Object.defineProperty(t,i,{get:I(function(t){return this[t]},n),set:I(function(t,e,n,i){$f(t,[n],[i],!0),this[e]=i},i,n,e[n].kb),enumerable:!0})}}function tl(t,e,n,i){t[e]=el(e,n,i)}function el(t,e,n){function i(){var t=Array.prototype.slice.call(arguments);return $f(o,n,t),e.apply(this,t)}if(!n)return e;var r,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(r in e)i[r]=e[r];for(r in e.prototype)i.prototype[r]=e.prototype[r];return i}Zf(rf.prototype,{jb:{name:"applyActionCode",j:[Kf("code")]},Ra:{name:"checkActionCode",j:[Kf("code")]},nb:{name:"confirmPasswordReset",j:[Kf("code"),Kf("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Kf("email"),Kf("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Kf("email")]},qa:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Kf("emailLink")]},Hc:{name:"onAuthStateChanged",j:[zf(Gf(),Bf(),"nextOrObserver"),Bf("opt_error",!0),Bf("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[zf(Gf(),Bf(),"nextOrObserver"),Bf("opt_error",!0),Bf("opt_completed",!0)]},vb:{name:"sendPasswordResetEmail",j:[Kf("email"),zf(Gf("opt_actionCodeSettings",!0),Wf(null,!0),"opt_actionCodeSettings",!0)]},wb:{name:"sendSignInLinkToEmail",j:[Kf("email"),Gf("actionCodeSettings")]},xb:{name:"setPersistence",j:[Kf("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Xf()]},zb:{name:"signInAnonymously",j:[]},$a:{name:"signInWithCredential",j:[Xf()]},Tc:{name:"signInWithCustomToken",j:[Kf("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Kf("email"),Kf("password")]},Vc:{name:"signInWithEmailLink",j:[Kf("email"),Kf("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Kf("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[zf({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof gh)}},Wf(),"user")]},Ab:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Kf(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Kf("url"),Gf("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Kf("code")]}}),Qf(rf.prototype,{lc:{name:"languageCode",kb:zf(Kf(),Wf(),"languageCode")},ti:{name:"tenantId",kb:zf(Kf(),Wf(),"tenantId")}}),rf.Persistence=zu,rf.Persistence.LOCAL="local",rf.Persistence.SESSION="session",rf.Persistence.NONE="none",Zf(gh.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Hf("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Hf("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Xf()]},qb:{name:"linkWithCredential",j:[Xf()]},Dc:{name:"linkWithPhoneNumber",j:[Kf("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Xf()]},tb:{name:"reauthenticateWithCredential",j:[Xf()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Kf("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},ub:{name:"sendEmailVerification",j:[zf(Gf("opt_actionCodeSettings",!0),Wf(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Kf(null,!0)]},cd:{name:"unlink",j:[Kf("provider")]},Bb:{name:"updateEmail",j:[Kf("email")]},Cb:{name:"updatePassword",j:[Kf("password")]},ed:{name:"updatePhoneNumber",j:[Xf("phone")]},Db:{name:"updateProfile",j:[Gf("profile")]},Eb:{name:"verifyBeforeUpdateEmail",j:[Kf("email"),zf(Gf("opt_actionCodeSettings",!0),Wf(null,!0),"opt_actionCodeSettings",!0)]}}),Zf(yf.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Zf(bf.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Zf(Ie.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),Qf(Jc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",kb:Hf("appVerificationDisabledForTesting")}}),Zf(Yc.prototype,{confirm:{name:"confirm",j:[Kf("verificationCode")]}}),tl(so,"fromJSON",function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[vo,_o,Do,fo],i=0;i<n.length;i++)if(e=n[i](t))return e;return null},[zf(Kf(),Gf(),"json")]),tl(Oo,"credential",function(t,e){return new No(t,e)},[Kf("email"),Kf("password")]),Zf(No.prototype,{w:{name:"toJSON",j:[Kf(null,!0)]}}),Zf(yo.prototype,{Ca:{name:"addScope",j:[Kf("scope")]},Ka:{name:"setCustomParameters",j:[Gf("customOAuthParameters")]}}),tl(yo,"credential",wo,[zf(Kf(),Gf(),"token")]),tl(Oo,"credentialWithLink",Co,[Kf("email"),Kf("emailLink")]),Zf(Io.prototype,{Ca:{name:"addScope",j:[Kf("scope")]},Ka:{name:"setCustomParameters",j:[Gf("customOAuthParameters")]}}),tl(Io,"credential",To,[zf(Kf(),Gf(),"token")]),Zf(ko.prototype,{Ca:{name:"addScope",j:[Kf("scope")]},Ka:{name:"setCustomParameters",j:[Gf("customOAuthParameters")]}}),tl(ko,"credential",Eo,[zf(Kf(),zf(Gf(),Wf()),"idToken"),zf(Kf(),Wf(),"accessToken",!0)]),Zf(Ao.prototype,{Ka:{name:"setCustomParameters",j:[Gf("customOAuthParameters")]}}),tl(Ao,"credential",So,[zf(Kf(),Gf(),"token"),Kf("secret",!0)]),Zf(bo.prototype,{Ca:{name:"addScope",j:[Kf("scope")]},credential:{name:"credential",j:[zf(Kf(),zf(Gf(),Wf()),"optionsOrIdToken"),zf(Kf(),Wf(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Gf("customOAuthParameters")]}}),Zf(lo.prototype,{w:{name:"toJSON",j:[Kf(null,!0)]}}),Zf(co.prototype,{w:{name:"toJSON",j:[Kf(null,!0)]}}),tl(xo,"credential",Mo,[Kf("verificationId"),Kf("verificationCode")]),Zf(xo.prototype,{fb:{name:"verifyPhoneNumber",j:[zf(Kf(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?Jf(t.session,oo)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Jf(t.session,ao)&&Yf(t.multiFactorHint):t.session&&t.multiFactorUid?Jf(t.session,ao)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Zf(Po.prototype,{w:{name:"toJSON",j:[Kf(null,!0)]}}),Zf(A.prototype,{toJSON:{name:"toJSON",j:[Kf(null,!0)]}}),Zf(Go.prototype,{toJSON:{name:"toJSON",j:[Kf(null,!0)]}}),Zf(Ho.prototype,{toJSON:{name:"toJSON",j:[Kf(null,!0)]}}),Zf(nh.prototype,{toJSON:{name:"toJSON",j:[Kf(null,!0)]}}),Zf(Qc.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}}]}}),Zf(uh.prototype,{Rb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.sb}},Kf("displayName",!0)]},bd:{name:"unenroll",j:[zf({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:Yf},Kf(),"multiFactorInfoIdentifier")]}}),Zf(Vf.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),tl(yr,"parseLink",Nr,[Kf("link")]),tl(Af,"assertion",function(t){return new ah(t)},[Xf("phone")]),function(){if("undefined"==typeof fb||!fb.INTERNAL||!fb.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:sr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:ar,VERIFY_AND_CHANGE_EMAIL:ur,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:rf,AuthCredential:so,Error:A};tl(t,"EmailAuthProvider",Oo,[]),tl(t,"FacebookAuthProvider",yo,[]),tl(t,"GithubAuthProvider",Io,[]),tl(t,"GoogleAuthProvider",ko,[]),tl(t,"TwitterAuthProvider",Ao,[]),tl(t,"OAuthProvider",bo,[Kf("providerId")]),tl(t,"SAMLAuthProvider",go,[Kf("providerId")]),tl(t,"PhoneAuthProvider",xo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof rf)}}]),tl(t,"RecaptchaVerifier",Vf,[zf(Kf(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Gf("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof fb.app.App)}}]),tl(t,"ActionCodeURL",yr,[]),tl(t,"PhoneMultiFactorGenerator",Af,[]),fb.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new rf(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),fb.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:w((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:w(t.nc,t),addAuthTokenListener:w(t.cc,t),removeAuthTokenListener:w(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),fb.registerVersion("@firebase/auth","0.16.4"),fb.INTERNAL.extendNamespace({User:gh})}()}).apply("undefined"!=typeof Vb?Vb:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var tk=require("process");var iF=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Eb(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:sj(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),jF=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return Ub(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),Ev=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new iF(t)}}catch(r){}return new jF},jg=Ev("localStorage"),Zl=Ev("sessionStorage"),Pg=new zv("@firebase/database"),Fv=function(){var e=1;return function(){return e++}}(),Gv=function(e){var t=QE(e),r=new ME;r.update(t);var n=r.digest();return Tl.encodeByteArray(n)},vj=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r="",n=0;n<e.length;n++){var i=e[n];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?r+=vj.apply(null,i):r+="object"==typeof i?Eb(i):i,r+=" "}return r},uk=null,kF=!0,Hv=function(e,t){cb(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Pg.logLevel=xb.VERBOSE,uk=Pg.log.bind(Pg),t&&Zl.set("logging_enabled",!0)):"function"==typeof e?uk=e:(uk=null,Zl.remove("logging_enabled"))},Kb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===kF&&(kF=!1,null===uk&&!0===Zl.get("logging_enabled")&&Hv(!0)),uk){var r=vj.apply(null,e);uk(r)}},wj=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Kb.apply(void 0,hg([e],t))}},$l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE INTERNAL ERROR: "+vj.apply(void 0,hg(e));Pg.error(r)},md=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE FATAL ERROR: "+vj.apply(void 0,hg(e));throw Pg.error(r),new Error(r)},Nb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE WARNING: "+vj.apply(void 0,hg(e));Pg.warn(r)},lF=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Nb("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},vk=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},mF=function(e){if(ld()||"complete"===document.readyState)e();else{var t=!1,r=function(){document.body?t||(t=!0,e()):setTimeout(r,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&r()}),window.attachEvent("onload",r))}},yd="[MIN_NAME]",nd="[MAX_NAME]",kg=function(e,t){if(e===t)return 0;if(e===yd||t===nd)return-1;if(t===yd||e===nd)return 1;var r=wk(e),n=wk(t);return null!==r?null!==n?r-n==0?e.length-t.length:r-n:-1:null!==n?1:e<t?-1:1},nF=function(e,t){return e===t?0:e<t?-1:1},xj=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Eb(t))},_l=function(e){if("object"!=typeof e||null===e)return Eb(e);var t=[];for(var r in e)t.push(r);t.sort();for(var n="{",i=0;i<t.length;i++)0!==i&&(n+=","),n+=Eb(t[i]),n+=":",n+=_l(e[t[i]]);return n+="}"},Iv=function(e,t){var r=e.length;if(r<=t)return[e];for(var n=[],i=0;i<r;i+=t)i+t>r?n.push(e.substring(i,r)):n.push(e.substring(i,i+t));return n};function Fb(e,t){for(var r in e)e.hasOwnProperty(r)&&t(r,e[r])}var Jv=function(e){cb(!vk(e),"Invalid JSON number");var t,r,n,i,o;0===e?(r=0,n=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(r=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,n=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(r=0,n=Math.round(e/Math.pow(2,-1074))));var a=[];for(o=52;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(t?1:0),a.reverse();var s=a.join(""),$="";for(o=0;o<64;o+=8){var l=parseInt(s.substr(o,8),2).toString(16);1===l.length&&(l="0"+l),$+=l}return $.toLowerCase()},oF=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},pF=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},qF=function(e,t){var r="Unknown Error";"too_big"===e?r="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?r="Client doesn't have permission to access the desired data.":"unavailable"===e&&(r="The service is unavailable");var n=new Error(e+" at "+t.path.toString()+": "+r);return n.code=e.toUpperCase(),n},rF=new RegExp("^-?(0*)\\d{1,10}$"),Kv=-2147483648,am=2147483647,wk=function(e){if(rF.test(e)){var t=Number(e);if(t>=Kv&&t<=am)return t}return null},Qg=function(e){try{e()}catch(t){setTimeout(function(){var e=t.stack||"";throw Nb("Exception was thrown by user callback.",e),t},Math.floor(0))}},sF=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},yj=function(e,t){var r=setTimeout(e,t);return"object"==typeof r&&r.unref&&r.unref(),r},pb=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var r=0,n=0;n<this.pieces_.length;n++)this.pieces_[n].length>0&&(this.pieces_[r]=this.pieces_[n],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e}();function ob(){return new pb("")}function hb(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function Jd(e){return e.pieces_.length-e.pieceNum_}function sb(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new pb(e.pieces_,t)}function bm(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function tF(e){for(var t="",r=e.pieceNum_;r<e.pieces_.length;r++)""!==e.pieces_[r]&&(t+="/"+encodeURIComponent(String(e.pieces_[r])));return t||"/"}function zj(e,t){return void 0===t&&(t=0),e.pieces_.slice(e.pieceNum_+t)}function Lv(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],r=e.pieceNum_;r<e.pieces_.length-1;r++)t.push(e.pieces_[r]);return new pb(t,0)}function yb(e,t){for(var r=[],n=e.pieceNum_;n<e.pieces_.length;n++)r.push(e.pieces_[n]);if(t instanceof pb)for(n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);else{var i=t.split("/");for(n=0;n<i.length;n++)i[n].length>0&&r.push(i[n])}return new pb(r,0)}function ib(e){return e.pieceNum_>=e.pieces_.length}function Ob(e,t){var r=hb(e),n=hb(t);if(null===r)return t;if(r===n)return Ob(sb(e),sb(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function uF(e,t){for(var r=zj(e,0),n=zj(t,0),i=0;i<r.length&&i<n.length;i++){var o=kg(r[i],n[i]);if(0!==o)return o}return r.length===n.length?0:r.length<n.length?-1:1}function cm(e,t){if(Jd(e)!==Jd(t))return!1;for(var r=e.pieceNum_,n=t.pieceNum_;r<=e.pieces_.length;r++,n++)if(e.pieces_[r]!==t.pieces_[n])return!1;return!0}function $b(e,t){var r=e.pieceNum_,n=t.pieceNum_;if(Jd(e)>Jd(t))return!1;for(;r<e.pieces_.length;){if(e.pieces_[r]!==t.pieces_[n])return!1;++r,++n}return!0}var vF=function(){function e(e,t){this.errorPrefix_=t,this.parts_=zj(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=qk(this.parts_[r]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=qk(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=qk(e),this.parts_.length>0&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}(),Mv="5",Nv="f",Ov=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Pv="websocket",Qv="long_polling",dm=function(){function e(e,t,r,n,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=t,this.namespace=r,this.webSocketOnly=n,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=jg.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&jg.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){var r;if(cb("string"==typeof e,"typeof type must == string"),cb("object"==typeof t,"typeof params must == object"),e===Pv)r=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==Qv)throw new Error("Unknown connection type: "+e);r=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var n=[];return Fb(t,function(e,t){n.push(e+"="+t)}),r+n.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+e+this.host+"/"+t},e}();function wF(e){for(var t="",r=e.split("/"),n=0;n<r.length;n++)if(r[n].length>0){var i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}t+="/"+i}return t}function xF(e){var t,r,n={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=Sb(e.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var s=a.split("=");2===s.length?n[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Nb("Invalid query segment '"+a+"' in query '"+e+"'")}}}catch($){t={error:$}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n}var em,Rv,fm=function(e,t){var r=yF(e),n=r.namespace;"firebase.com"===r.domain&&md(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!==n||"localhost"===r.domain||md("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||lF();var i="ws"===r.scheme||"wss"===r.scheme;return{repoInfo:new dm(r.host,r.secure,n,t,i,"",n!==r.subdomain),path:new pb(r.pathString)}},yF=function(e){var t="",r="",n="",i="",o="",a=!0,s="https",$=443;if("string"==typeof e){var l=e.indexOf("//");l>=0&&(s=e.substring(0,l-1),e=e.substring(l+2));var u=e.indexOf("/");-1===u&&(u=e.length);var h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(u,h)),u<h&&(i=wF(e.substring(u,h)));var p=xF(e.substring(Math.min(e.length,h)));(l=t.indexOf(":"))>=0?(a="https"===s||"wss"===s,$=parseInt(t.substring(l+1),10)):l=t.length;var c=t.slice(0,l);if("localhost"===c.toLowerCase())r="localhost";else if(c.split(".").length<=2)r=c;else{var d=t.indexOf(".");n=t.substring(0,d).toLowerCase(),r=t.substring(d+1),o=n}"ns"in p&&(o=p.ns)}return{host:t,port:$,domain:r,subdomain:n,secure:a,scheme:s,pathString:i,namespace:o}},zF=/[\[\].#$\/\u0000-\u001F\u007F]/,AF=/[\[\].#$\u0000-\u001F\u007F]/,gm=10485760,xk=function(e){return"string"==typeof e&&0!==e.length&&!zF.test(e)},Sv=function(e){return"string"==typeof e&&0!==e.length&&!AF.test(e)},BF=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Sv(e)},Aj=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!vk(e)||e&&"object"==typeof e&&Ub(e,".sv")},od=function(e,t,r,n,i){i&&void 0===r||Bj(Zb(e,t,i),r,n)},Bj=function(e,t,r){var n=r instanceof pb?new vF(r,e):r;if(void 0===t)throw new Error(e+"contains undefined "+n.toErrorString());if("function"==typeof t)throw new Error(e+"contains a function "+n.toErrorString()+" with contents = "+t.toString());if(vk(t))throw new Error(e+"contains "+t.toString()+" "+n.toErrorString());if("string"==typeof t&&t.length>gm/3&&qk(t)>gm)throw new Error(e+"contains a string greater than "+gm+" utf8 bytes "+n.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,o=!1;if(Fb(t,function(t,r){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!xk(t)))throw new Error(e+" contains an invalid key ("+t+") "+n.toErrorString()+".  Keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"");n.push(t),Bj(e,r,n),n.pop()}),i&&o)throw new Error(e+" contains \".value\" child "+n.toErrorString()+" in addition to actual children.")}},CF=function(e,t){var r,n;for(r=0;r<t.length;r++)for(var i=zj(n=t[r]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!xk(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+n.toString()+". Keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"");t.sort(uF);var a=null;for(r=0;r<t.length;r++){if(n=t[r],null!==a&&$b(a,n))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+n.toString());a=n}},Tv=function(e,t,r,n,i){if(!i||void 0!==r){var o=Zb(e,t,i);if(!r||"object"!=typeof r||Array.isArray(r))throw new Error(o+" must be an object containing the children to replace.");var a=[];Fb(r,function(e,t){var r=new pb(e);if(Bj(o,t,yb(n,r)),".priority"===bm(r)&&!Aj(t))throw new Error(o+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)}),CF(o,a)}},hm=function(e,t,r,n){if(!n||void 0!==r){if(vk(r))throw new Error(Zb(e,t,n)+"is "+r.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Aj(r))throw new Error(Zb(e,t,n)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},im=function(e,t,r,n){if(!n||void 0!==r)switch(r){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Zb(e,t,n)+"must be a valid event type = \"value\", \"child_added\", \"child_removed\", \"child_changed\", or \"child_moved\".");}},Cj=function(e,t,r,n){if(!(n&&void 0===r||xk(r)))throw new Error(Zb(e,t,n)+"was an invalid key = \""+r+"\".  Firebase keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").")},Dj=function(e,t,r,n){if(!(n&&void 0===r||Sv(r)))throw new Error(Zb(e,t,n)+"was an invalid path = \""+r+"\". Paths must be non-empty strings and can't contain \".\", \"#\", \"$\", \"[\", or \"]\"")},DF=function(e,t,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),Dj(e,t,r,n)},_b=function(e,t){if(".info"===hb(t))throw new Error(e+" failed = Can't modify data under /.info/")},Uv=function(e,t,r){var n=r.path.toString();if("string"!=typeof r.repoInfo.host||0===r.repoInfo.host.length||!xk(r.repoInfo.namespace)&&"localhost"!==r.repoInfo.host.split(":")[0]||0!==n.length&&!BF(n))throw new Error(Zb(e,t,!1)+"must be a valid firebase URL and the path can't contain \".\", \"#\", \"$\", \"[\", or \"]\".")},EF=function(e,t,r,n){if((!n||void 0!==r)&&"boolean"!=typeof r)throw new Error(Zb(e,t,n)+"must be a boolean.")},FF=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){eb("OnDisconnect.cancel",0,1,arguments.length),Ib("OnDisconnect.cancel",1,e,!0);var t=new Tb;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){eb("OnDisconnect.remove",0,1,arguments.length),_b("OnDisconnect.remove",this.path_),Ib("OnDisconnect.remove",1,e,!0);var t=new Tb;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){eb("OnDisconnect.set",1,2,arguments.length),_b("OnDisconnect.set",this.path_),od("OnDisconnect.set",1,e,this.path_,!1),Ib("OnDisconnect.set",2,t,!0);var r=new Tb;return this.repo_.onDisconnectSet(this.path_,e,r.wrapCallback(t)),r.promise},e.prototype.setWithPriority=function(e,t,r){eb("OnDisconnect.setWithPriority",2,3,arguments.length),_b("OnDisconnect.setWithPriority",this.path_),od("OnDisconnect.setWithPriority",1,e,this.path_,!1),hm("OnDisconnect.setWithPriority",2,t,!1),Ib("OnDisconnect.setWithPriority",3,r,!0);var n=new Tb;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,n.wrapCallback(r)),n.promise},e.prototype.update=function(e,t){if(eb("OnDisconnect.update",1,2,arguments.length),_b("OnDisconnect.update",this.path_),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,Nb("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Tv("OnDisconnect.update",1,e,this.path_,!1),Ib("OnDisconnect.update",2,t,!0);var i=new Tb;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},e}(),GF=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return eb("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),Rg="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",jm="-",Vv="z",Wv=786,HF=function(){var e=0,t=[];return function(r){var n,i=r===e;e=r;var o=new Array(8);for(n=7;n>=0;n--)o[n]=Rg.charAt(r%64),r=Math.floor(r/64);cb(0===r,"Cannot push at time == 0");var a=o.join("");if(i){for(n=11;n>=0&&63===t[n];n--)t[n]=0;t[n]++}else for(n=0;n<12;n++)t[n]=Math.floor(64*Math.random());for(n=0;n<12;n++)a+=Rg.charAt(t[n]);return cb(20===a.length,"nextPushId: Length should be 20."),a}}(),Xv=function(e){if(e===""+am)return jm;var t=wk(e);if(null!=t)return""+(t+1);for(var r=new Array(e.length),n=0;n<r.length;n++)r[n]=e.charAt(n);if(r.length<Wv)return r.push(jm),r.join("");for(var i=r.length-1;i>=0&&r[i]===Vv;)i--;if(-1===i)return nd;var o=r[i],a=Rg.charAt(Rg.indexOf(o)+1);return r[i]=a,r.slice(0,i+1).join("")},Yv=function(e){if(e===""+Kv)return yd;var t=wk(e);if(null!=t)return""+(t-1);for(var r=new Array(e.length),n=0;n<r.length;n++)r[n]=e.charAt(n);return r[r.length-1]===jm?1===r.length?""+am:(delete r[r.length-1],r.join("")):(r[r.length-1]=Rg.charAt(Rg.indexOf(r[r.length-1])-1),r.join("")+Vv.repeat(Wv-r.length))},lb=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,r){return new e(t,r)},e}(),yk=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var r=new lb(yd,e),n=new lb(yd,t);return 0!==this.compare(r,n)},e.prototype.minPost=function(){return lb.MIN},e}(),Zv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dd(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return em},set:function(e){em=e},enumerable:!1,configurable:!0}),t.prototype.compare=function(e,t){return kg(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Mg("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return lb.MIN},t.prototype.maxPost=function(){return new lb(nd,em)},t.prototype.makePost=function(e,t){return cb("string"==typeof e,"KeyIndex indexValue must always be a string."),new lb(e,em)},t.prototype.toString=function(){return".key"},t}(yk),pd=new Zv;function IF(e){Rv=e}var JF,KF,LF,$v=function(e){return"number"==typeof e?"number:"+Jv(e):"string:"+e},_v=function(e){if(e.isLeafNode()){var t=e.val();cb("string"==typeof t||"number"==typeof t||"object"==typeof t&&Ub(t,".sv"),"Priority must be a string or number.")}else cb(e===Rv||e.isEmpty(),"priority of unexpected type.");cb(e===Rv||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Sg=function(){function e(t,r){void 0===r&&(r=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=r,this.lazyHash_=null,cb(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),_v(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return JF},set:function(e){JF=e},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return ib(t)?this:".priority"===hb(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,r){var n=hb(t);return null===n?r:r.isEmpty()&&".priority"!==n?this:(cb(".priority"!==n||1===Jd(t),".priority must be the last token in a path"),this.updateImmediateChild(n,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(sb(t),r)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+$v(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?Jv(this.value_):this.value_,this.lazyHash_=Gv(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(cb(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var r=typeof t.value_,n=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(r),o=e.VALUE_TYPE_ORDER.indexOf(n);return cb(i>=0,"Unknown leaf type: "+r),cb(o>=0,"Unknown leaf type: "+n),i===o?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();function MF(e){KF=e}function NF(e){LF=e}var OF,zk,PF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dd(t,e),t.prototype.compare=function(e,t){var r=e.node.getPriority(),n=t.node.getPriority(),i=r.compareTo(n);return 0===i?kg(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return lb.MIN},t.prototype.maxPost=function(){return new lb(nd,new Sg("[PRIORITY-POST]",LF))},t.prototype.makePost=function(e,t){var r=KF(e);return new lb(t,new Sg("[PRIORITY-POST]",r))},t.prototype.toString=function(){return".priority"},t}(yk),tb=new PF,Ak=function(){function e(e,t,r,n,i){void 0===i&&(i=null),this.isReverse_=n,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,n&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),gd=function(){function e(t,r,n,i,o){this.key=t,this.value=r,this.color=null!=n?n:e.RED,this.left=null!=i?i:zd.EMPTY_NODE,this.right=null!=o?o:zd.EMPTY_NODE}return e.prototype.copy=function(t,r,n,i,o){return new e(null!=t?t:this.key,null!=r?r:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,r){var n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return zd.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var r,n;if(t(e,(r=this).key)<0)r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()||(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),r.right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()||(r=r.moveRedRight_()),0===t(e,r.key)){if(r.right.isEmpty())return zd.EMPTY_NODE;n=r.right.min_(),r=r.copy(n.key,n.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),QF=function(){function e(){}return e.prototype.copy=function(e,t,r,n,i){return this},e.prototype.insert=function(e,t,r){return new gd(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),zd=function(){function e(t,r){void 0===r&&(r=e.EMPTY_NODE),this.comparator_=t,this.root_=r}return e.prototype.insert=function(t,r){return new e(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,gd.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,gd.BLACK,null,null))},e.prototype.get=function(e){for(var t,r=this.root_;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key)))return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,r=this.root_,n=null;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key))){if(r.left.isEmpty())return n?n.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(n=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new Ak(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new Ak(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new Ak(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new Ak(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new QF,e}(),RF=Math.log(2),SF=function(){function e(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/RF,10)),this.current_=this.count-1;var r,n=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=e+1&n}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),Bk=function(e,t,r,n){e.sort(t);var i=function(t,n){var o,a,s=n-t;if(0===s)return null;if(1===s)return o=e[t],a=r?r(o):o,new gd(a,o.node,gd.BLACK,null,null);var $=parseInt(s/2,10)+t,l=i(t,$),u=i($+1,n);return o=e[$],a=r?r(o):o,new gd(a,o.node,gd.BLACK,l,u)},o=function(t){for(var n=null,o=null,a=e.length,s=function(t,n){var o=a-t,s=a;a-=t;var l=i(o+1,s),u=e[o],h=r?r(u):u;$(new gd(h,u.node,n,null,l))},$=function(e){n?(n.left=e,n=e):(o=e,n=e)},l=0;l<t.count;++l){var u=t.nextBitIsOne(),h=Math.pow(2,t.count-(l+1));u?s(h,gd.BLACK):(s(h,gd.BLACK),s(h,gd.RED))}return o}(new SF(e.length));return new zd(n||t,o)},Tg={},Ck=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return cb(Tg&&tb,"ChildrenNode.ts has not been loaded"),OF=OF||new e({".priority":Tg},{".priority":tb})},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=ed(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof zd?t:null},e.prototype.hasIndex=function(e){return Ub(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,r){cb(t!==pd,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,i=[],o=!1,a=r.getIterator(lb.Wrap),s=a.getNext();s;)o=o||t.isDefinedOn(s.node),i.push(s),s=a.getNext();n=o?Bk(i,t.getCompare()):Tg;var $=t.toString(),l=gg({},this.indexSet_);l[$]=t;var u=gg({},this.indexes_);return u[$]=n,new e(u,l)},e.prototype.addToIndexes=function(t,r){var n=this;return new e(pk(this.indexes_,function(e,i){var o=ed(n.indexSet_,i);if(cb(o,"Missing index implementation for "+i),e===Tg){if(o.isDefinedOn(t.node)){for(var a=[],s=r.getIterator(lb.Wrap),$=s.getNext();$;)$.name!==t.name&&a.push($),$=s.getNext();return a.push(t),Bk(a,o.getCompare())}return Tg}var l=r.get(t.name),u=e;return l&&(u=u.remove(new lb(t.name,l))),u.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,r){return new e(pk(this.indexes_,function(e){if(e===Tg)return e;var n=r.get(t.name);return n?e.remove(new lb(t.name,n)):e}),this.indexSet_)},e}();function TF(e,t){return kg(e.name,t.name)}function km(e,t){return kg(e,t)}var gb=function(){function e(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&_v(this.priorityNode_),this.children_.isEmpty()&&cb(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return zk||(zk=new e(new zd(km),null,Ck.Default))},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||zk},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?zk:t},e.prototype.getChild=function(e){var t=hb(e);return null===t?this:this.getImmediateChild(t).getChild(sb(e))},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,r){if(cb(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);var n=new lb(t,r),i=void 0,o=void 0;r.isEmpty()?(i=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(n,this.children_));var a=i.isEmpty()?zk:this.priorityNode_;return new e(i,a,o)},e.prototype.updateChild=function(e,t){var r=hb(e);if(null===r)return t;cb(".priority"!==hb(e)||1===Jd(e),".priority must be the last token in a path");var n=this.getImmediateChild(r).updateChild(sb(e),t);return this.updateImmediateChild(r,n)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var r={},n=0,i=0,o=!0;if(this.forEachChild(tb,function(a,s){r[a]=s.val(t),n++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!t&&o&&i<2*n){var a=[];for(var s in r)a[s]=r[s];return a}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+$v(this.getPriority().val())+":"),this.forEachChild(tb,function(t,r){var n=r.hash();""!==n&&(e+=":"+t+":"+n)}),this.lazyHash_=""===e?"":Gv(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,r){var n=this.resolveIndex_(r);if(n){var i=n.getPredecessorKey(new lb(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.minKey();return r&&r.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new lb(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.maxKey();return r&&r.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new lb(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var r=this.resolveIndex_(e);return r?r.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,function(e){return e});for(var n=this.children_.getIteratorFrom(e.name,lb.Wrap),i=n.peek();null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,function(e){return e});for(var n=this.children_.getReverseIteratorFrom(e.name,lb.Wrap),i=n.peek();null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Ej?-1:0},e.prototype.withIndex=function(t){if(t===pd||this.indexMap_.hasIndex(t))return this;var r=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,r)},e.prototype.isIndexed=function(e){return e===pd||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var r=this.getIterator(tb),n=t.getIterator(tb),i=r.getNext(),o=n.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=n.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===pd?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),UF=function(e){function t(){return e.call(this,new zd(km),gb.EMPTY_NODE,Ck.Default)||this}return dd(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return gb.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(gb),Ej=new UF;Object.defineProperties(lb,{MIN:{value:new lb(yd,gb.EMPTY_NODE)},MAX:{value:new lb(nd,Ej)}}),Zv.__EMPTY_NODE=gb.EMPTY_NODE,Sg.__childrenNodeConstructor=gb,IF(Ej),NF(Ej);var VF=!0;function Bb(e,t){if(void 0===t&&(t=null),null===e)return gb.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),cb(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Sg(e,Bb(t));if(e instanceof Array||!VF){var r=gb.EMPTY_NODE;return Fb(e,function(t,n){if(Ub(e,t)&&"."!==t.substring(0,1)){var i=Bb(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(t,i))}}),r.updatePriority(Bb(t))}var n=[],i=!1;if(Fb(e,function(e,t){if("."!==e.substring(0,1)){var r=Bb(t);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new lb(e,r)))}}),0===n.length)return gb.EMPTY_NODE;var o=Bk(n,TF,function(e){return e.name},km);if(i){var a=Bk(n,tb.getCompare());return new gb(o,Bb(t),new Ck({".priority":a},{".priority":tb}))}return new gb(o,Bb(t),Ck.Default)}MF(Bb);var WF=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return dd(t,e),t.prototype.compare=function(e,t){var r=e.node.compareTo(t.node);return 0===r?kg(e.name,t.name):r},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return lb.MIN},t.prototype.maxPost=function(){return lb.MAX},t.prototype.makePost=function(e,t){var r=Bb(e);return new lb(t,r)},t.prototype.toString=function(){return".value"},t}(yk),lm=new WF,mm=function(e){function t(t){var r=e.call(this)||this;return r.indexPath_=t,cb(!ib(t)&&".priority"!==hb(t),"Can't create PathIndex with empty path or .priority key"),r}return dd(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var r=this.extractChild(e.node),n=this.extractChild(t.node),i=r.compareTo(n);return 0===i?kg(e.name,t.name):i},t.prototype.makePost=function(e,t){var r=Bb(e),n=gb.EMPTY_NODE.updateChild(this.indexPath_,r);return new lb(t,n)},t.prototype.maxPost=function(){var e=gb.EMPTY_NODE.updateChild(this.indexPath_,Ej);return new lb(nd,e)},t.prototype.toString=function(){return zj(this.indexPath_,0).join("/")},t}(yk),Kd=function(){function e(e,t,r){this.node_=e,this.ref_=t,this.index_=r}return e.prototype.val=function(){return eb("DataSnapshot.val",0,0,arguments.length),this.node_.val()},e.prototype.exportVal=function(){return eb("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},e.prototype.toJSON=function(){return eb("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return eb("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},e.prototype.child=function(t){eb("DataSnapshot.child",0,1,arguments.length),t=String(t),Dj("DataSnapshot.child",1,t,!1);var r=new pb(t),n=this.ref_.child(r);return new e(this.node_.getChild(r),n,tb)},e.prototype.hasChild=function(e){eb("DataSnapshot.hasChild",1,1,arguments.length),Dj("DataSnapshot.hasChild",1,e,!1);var t=new pb(e);return!this.node_.getChild(t).isEmpty()},e.prototype.getPriority=function(){return eb("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},e.prototype.forEach=function(t){var r=this;return eb("DataSnapshot.forEach",1,1,arguments.length),Ib("DataSnapshot.forEach",1,t,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(n,i){return t(new e(i,r.ref_.child(n),tb))})},e.prototype.hasChildren=function(){return eb("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),e.prototype.numChildren=function(){return eb("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},e.prototype.getRef=function(){return eb("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),aw=function(){function e(e,t,r,n){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=n}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Eb(this.snapshot.exportVal())},e}(),bw=function(){function e(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),cw=function(){function e(e,t,r){this.callback_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var r=t.getQueryParams().getIndex();return new aw("value",this,new Kd(e.snapshotNode,t.getRef(),r))},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){cb(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callback_;return function(){n.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new bw(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}(),dw=function(){function e(e,t,r){this.callbacks_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,Ub(this.callbacks_,t)},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new bw(this,e,t):null},e.prototype.createEvent=function(e,t){cb(null!=e.childName,"Child events should have a childName.");var r=t.getRef().child(e.childName),n=t.getQueryParams().getIndex();return new aw(e.type,this,new Kd(e.snapshotNode,r,n),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){cb(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callbacks_[e.eventType];return function(){n.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){var r=this;if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var n=Object.keys(t.callbacks_),i=Object.keys(this.callbacks_),o=n.length;if(o===i.length){if(1===o){var a=n[0],s=i[0];return!(s!==a||t.callbacks_[a]&&this.callbacks_[s]&&t.callbacks_[a]!==this.callbacks_[s])}return i.every(function(e){return t.callbacks_[e]===r.callbacks_[e]})}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks_},e}();function ew(e){return{type:"value",snapshotNode:e}}function Ug(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function Fj(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function Gj(e,t,r){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:r}}function XF(e,t){return{type:"child_moved",snapshotNode:t,childName:e}}var fw,nm=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,r,n,i,o){cb(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(n).equals(r.getChild(n))&&a.isEmpty()===r.isEmpty()?e:(null!=o&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(Fj(t,a)):cb(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Ug(t,r)):o.trackChildChange(Gj(t,r,a))),e.isLeafNode()&&r.isEmpty()?e:e.updateImmediateChild(t,r).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(tb,function(e,n){t.hasChild(e)||r.trackChildChange(Fj(e,n))}),t.isLeafNode()||t.forEachChild(tb,function(t,n){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(n)||r.trackChildChange(Gj(t,n,i))}else r.trackChildChange(Ug(t,n))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?gb.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),gw=function(){function e(t){this.indexedFilter_=new nm(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,r,n,i,o){return this.matches(new lb(t,r))||(r=gb.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,n,i,o)},e.prototype.updateFullNode=function(e,t,r){t.isLeafNode()&&(t=gb.EMPTY_NODE);var n=t.withIndex(this.index_);n=n.updatePriority(gb.EMPTY_NODE);var i=this;return t.forEachChild(tb,function(e,t){i.matches(new lb(e,t))||(n=n.updateImmediateChild(e,gb.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),YF=function(){function e(e){this.rangedFilter_=new gw(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,r,n,i,o){return this.rangedFilter_.matches(new lb(t,r))||(r=gb.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,n,i,o):this.fullLimitUpdateChild_(e,t,r,i,o)},e.prototype.updateFullNode=function(e,t,r){var n;if(t.isLeafNode()||t.isEmpty())n=gb.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){n=gb.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;n=n.updateImmediateChild(a.name,a.node),o++}}else{n=(n=t.withIndex(this.index_)).updatePriority(gb.EMPTY_NODE);var s=void 0,$=void 0,l=void 0;i=void 0;if(this.reverse_){i=n.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),$=this.rangedFilter_.getStartPost();var u=this.index_.getCompare();l=function(e,t){return u(t,e)}}else i=n.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),$=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();){a=i.getNext();!h&&l(s,a)<=0&&(h=!0),h&&o<this.limit_&&l(a,$)<=0?o++:n=n.updateImmediateChild(a.name,gb.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,r,n,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(e,t){return a(t,e)}}else o=this.index_.getCompare();var s=e;cb(s.numChildren()===this.limit_,"");var $=new lb(t,r),l=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),u=this.rangedFilter_.matches($);if(s.hasChild(t)){for(var h=s.getImmediateChild(t),p=n.getChildAfterChild(this.index_,l,this.reverse_);null!=p&&(p.name===t||s.hasChild(p.name));)p=n.getChildAfterChild(this.index_,p,this.reverse_);var c=null==p?1:o(p,$);if(u&&!r.isEmpty()&&c>=0)return null!=i&&i.trackChildChange(Gj(t,r,h)),s.updateImmediateChild(t,r);null!=i&&i.trackChildChange(Fj(t,h));var d=s.updateImmediateChild(t,gb.EMPTY_NODE);return null!=p&&this.rangedFilter_.matches(p)?(null!=i&&i.trackChildChange(Ug(p.name,p.node)),d.updateImmediateChild(p.name,p.node)):d}return r.isEmpty()?e:u&&o(l,$)>=0?(null!=i&&(i.trackChildChange(Fj(l.name,l.node)),i.trackChildChange(Ug(t,r))),s.updateImmediateChild(t,r).updateImmediateChild(l.name,gb.EMPTY_NODE)):e},e}(),ZF=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=tb}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.hasStartAfter=function(){return this.startAfterSet_},e.prototype.hasEndBefore=function(){return this.endBeforeSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},e.prototype.getIndexStartValue=function(){return cb(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return cb(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:yd},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return cb(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return cb(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:nd},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return cb(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===tb},e.prototype.copy=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e}();function $F(e){return e.loadsAllData()?new nm(e.getIndex()):e.hasLimit()?new YF(e):new gw(e)}function _F(e,t){var r=e.copy();return r.limitSet_=!0,r.limit_=t,r.viewFrom_="l",r}function aG(e,t){var r=e.copy();return r.limitSet_=!0,r.limit_=t,r.viewFrom_="r",r}function om(e,t,r){var n=e.copy();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=r?(n.startNameSet_=!0,n.indexStartName_=r):(n.startNameSet_=!1,n.indexStartName_=""),n}function bG(e,t,r){var n;if(e.index_===pd)"string"==typeof t&&(t=Xv(t)),n=om(e,t,r);else{n=om(e,t,null==r?nd:Xv(r))}return n.startAfterSet_=!0,n}function pm(e,t,r){var n=e.copy();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==r?(n.endNameSet_=!0,n.indexEndName_=r):(n.endNameSet_=!1,n.indexEndName_=""),n}function cG(e,t,r){var n;return e.index_===pd?("string"==typeof t&&(t=Yv(t)),n=pm(e,t,r)):n=pm(e,t,null==r?yd:Yv(r)),n.endBeforeSet_=!0,n}function Dk(e,t){var r=e.copy();return r.index_=t,r}function hw(e){var t,r={};return e.isDefault()?r:(e.index_===tb?t="$priority":e.index_===lm?t="$value":e.index_===pd?t="$key":(cb(e.index_ instanceof mm,"Unrecognized index type!"),t=e.index_.toString()),r.orderBy=Eb(t),e.startSet_&&(r.startAt=Eb(e.indexStartValue_),e.startNameSet_&&(r.startAt+=","+Eb(e.indexStartName_))),e.endSet_&&(r.endAt=Eb(e.indexEndValue_),e.endNameSet_&&(r.endAt+=","+Eb(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?r.limitToFirst=e.limit_:r.limitToLast=e.limit_),r)}function dG(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var r=e.viewFrom_;""===r&&(r=e.isViewFromLeft()?"l":"r"),t.vf=r}return e.index_!==tb&&(t.i=e.index_.toString()),t}var qm=function(){function e(e,t,r,n){this.repo=e,this.path=t,this.queryParams_=r,this.orderByCalled_=n}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return cb(fw,"Reference.ts has not been loaded"),fw},set:function(e){fw=e},enumerable:!1,configurable:!0}),e.validateQueryEndpoints_=function(e){var t=null,r=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(r=e.getIndexEndValue()),e.getIndex()===pd){var n="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==yd)throw new Error(n);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==nd)throw new Error(n);if("string"!=typeof r)throw new Error(i)}}else if(e.getIndex()===tb){if(null!=t&&!Aj(t)||null!=r&&!Aj(r))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(cb(e.getIndex()instanceof mm||e.getIndex()===lm,"unknown index type."),null!=t&&"object"==typeof t||null!=r&&"object"==typeof r)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")},e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.queryParams_},e.prototype.getRef=function(){return eb("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,r,n,i){eb("Query.on",2,4,arguments.length),im("Query.on",1,t,!1),Ib("Query.on",2,r,!1);var o=e.getCancelAndContextArgs_("Query.on",n,i);if("value"===t)this.onValueEvent(r,o.cancel,o.context);else{var a={};a[t]=r,this.onChildEvent(a,o.cancel,o.context)}return r},e.prototype.onValueEvent=function(e,t,r){var n=new cw(e,t||null,r||null);this.repo.addEventCallbackForQuery(this,n)},e.prototype.onChildEvent=function(e,t,r){var n=new dw(e,t,r);this.repo.addEventCallbackForQuery(this,n)},e.prototype.off=function(e,t,r){eb("Query.off",0,3,arguments.length),im("Query.off",1,e,!0),Ib("Query.off",2,t,!0),vv("Query.off",3,r,!0);var n=null,i=null;"value"===e?n=new cw(t||null,null,r||null):e&&(t&&((i={})[e]=t),n=new dw(i,null,r||null));this.repo.removeEventCallbackForQuery(this,n)},e.prototype.get=function(){return this.repo.getValue(this)},e.prototype.once=function(t,r,n,i){var o=this;eb("Query.once",1,4,arguments.length),im("Query.once",1,t,!1),Ib("Query.once",2,r,!0);var a=e.getCancelAndContextArgs_("Query.once",n,i),s=!0,$=new Tb;$.promise.catch(function(){});var l=function(e){s&&(s=!1,o.off(t,l),r&&r.bind(a.context)(e),$.resolve(e))};return this.on(t,l,function(e){o.off(t,l),a.cancel&&a.cancel.bind(a.context)(e),$.reject(e)}),$.promise},e.prototype.limitToFirst=function(t){if(eb("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,_F(this.queryParams_,t),this.orderByCalled_)},e.prototype.limitToLast=function(t){if(eb("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,aG(this.queryParams_,t),this.orderByCalled_)},e.prototype.orderByChild=function(t){if(eb("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error("Query.orderByChild: \"$key\" is invalid.  Use Query.orderByKey() instead.");if("$priority"===t)throw new Error("Query.orderByChild: \"$priority\" is invalid.  Use Query.orderByPriority() instead.");if("$value"===t)throw new Error("Query.orderByChild: \"$value\" is invalid.  Use Query.orderByValue() instead.");Dj("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var r=new pb(t);if(ib(r))throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var n=new mm(r),i=Dk(this.queryParams_,n);return e.validateQueryEndpoints_(i),new e(this.repo,this.path,i,!0)},e.prototype.orderByKey=function(){eb("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=Dk(this.queryParams_,pd);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){eb("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=Dk(this.queryParams_,tb);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){eb("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=Dk(this.queryParams_,lm);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,r){void 0===t&&(t=null),eb("Query.startAt",0,2,arguments.length),od("Query.startAt",1,t,this.path,!0),Cj("Query.startAt",2,r,!0);var n=om(this.queryParams_,t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,r=null),new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.startAfter=function(t,r){void 0===t&&(t=null),eb("Query.startAfter",0,2,arguments.length),od("Query.startAfter",1,t,this.path,!1),Cj("Query.startAfter",2,r,!0);var n=bG(this.queryParams_,t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAfter: Starting point was already set (by another call to startAt, startAfter or equalTo).");return new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.endAt=function(t,r){void 0===t&&(t=null),eb("Query.endAt",0,2,arguments.length),od("Query.endAt",1,t,this.path,!0),Cj("Query.endAt",2,r,!0);var n=pm(this.queryParams_,t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt, endBefore, or equalTo).");return new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.endBefore=function(t,r){void 0===t&&(t=null),eb("Query.endBefore",0,2,arguments.length),od("Query.endBefore",1,t,this.path,!1),Cj("Query.endBefore",2,r,!0);var n=cG(this.queryParams_,t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasEnd())throw new Error("Query.endBefore: Ending point was already set (by another call to endAt, endBefore, or equalTo).");return new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.equalTo=function(e,t){if(eb("Query.equalTo",1,2,arguments.length),od("Query.equalTo",1,e,this.path,!1),Cj("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return eb("Query.toString",0,0,arguments.length),this.repo.toString()+tF(this.path)},e.prototype.toJSON=function(){return eb("Query.toJSON",0,1,arguments.length),this.toString()},e.prototype.queryObject=function(){return dG(this.queryParams_)},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=_l(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if(eb("Query.isEqual",1,1,arguments.length),!(t instanceof e)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var r=this.repo===t.repo,n=cm(this.path,t.path),i=this.queryIdentifier()===t.queryIdentifier();return r&&n&&i},e.getCancelAndContextArgs_=function(e,t,r){var n={cancel:null,context:null};if(t&&r)n.cancel=t,Ib(e,3,n.cancel,!0),n.context=r,vv(e,4,n.context,!0);else if(t)if("object"==typeof t&&null!==t)n.context=t;else{if("function"!=typeof t)throw new Error(Zb(e,3,!0)+" must either be a cancel callback or a context object.");n.cancel=t}return n},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),eG=function(){function e(e){this.node_=e}return e.prototype.getImmediateChild=function(t){return new e(this.node_.getImmediateChild(t))},e.prototype.node=function(){return this.node_},e}(),fG=function(){function e(e,t){this.syncTree_=e,this.path_=t}return e.prototype.getImmediateChild=function(t){var r=yb(this.path_,t);return new e(this.syncTree_,r)},e.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},e}(),gG=function(e){return(e=e||{}).timestamp=e.timestamp||new Date().getTime(),e},iw=function(e,t,r){return e&&"object"==typeof e?(cb(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?hG(e[".sv"],t,r):"object"==typeof e[".sv"]?iG(e[".sv"],t):void cb(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},hG=function(e,t,r){switch(e){case"timestamp":return r.timestamp;default:cb(!1,"Unexpected server value: "+e);}},iG=function(e,t,r){e.hasOwnProperty("increment")||cb(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var n=e.increment;"number"!=typeof n&&cb(!1,"Unexpected increment value: "+n);var i=t.node();if(cb(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;var o=i.getValue();return"number"!=typeof o?n:o+n},jw=function(e,t,r,n){return sm(t,new fG(r,e),n)},rm=function(e,t,r){return sm(e,new eG(t),r)};function sm(e,t,r){var n,i=e.getPriority().val(),o=iw(i,t.getImmediateChild(".priority"),r);if(e.isLeafNode()){var a=e,s=iw(a.getValue(),t,r);return s!==a.getValue()||o!==a.getPriority().val()?new Sg(s,Bb(o)):e}var $=e;return n=$,o!==$.getPriority().val()&&(n=n.updatePriority(new Sg(o))),$.forEachChild(tb,function(e,i){var o=sm(i,t.getImmediateChild(e),r);o!==i&&(n=n.updateImmediateChild(e,o))}),n}var qd,tm=function(){function e(){this.value=null,this.children=new Map}return e.prototype.find=function(e){if(null!=this.value)return this.value.getChild(e);if(!ib(e)&&this.children.size>0){var t=hb(e);return e=sb(e),this.children.has(t)?this.children.get(t).find(e):null}return null},e.prototype.remember=function(t,r){if(ib(t))this.value=r,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(t,r);else{var n=hb(t);this.children.has(n)||this.children.set(n,new e);var i=this.children.get(n);t=sb(t),i.remember(t,r)}},e.prototype.forget=function(e){if(ib(e))return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var t=this.value;this.value=null;var r=this;return t.forEachChild(tb,function(e,t){r.remember(new pb(e),t)}),this.forget(e)}if(this.children.size>0){var n=hb(e);if(e=sb(e),this.children.has(n))this.children.get(n).forget(e)&&this.children.delete(n);return 0===this.children.size}return!0},e.prototype.forEachTree=function(e,t){null!==this.value?t(e,this.value):this.forEachChild(function(r,n){var i=new pb(e.toString()+"/"+r);n.forEachTree(i,t)})},e.prototype.forEachChild=function(e){this.children.forEach(function(t,r){e(r,t)})},e}();function um(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function vm(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function wm(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(qd||(qd={}));var kw,jG=function(){function e(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=qd.ACK_USER_WRITE,this.source=um()}return e.prototype.operationForChild=function(t){if(ib(this.path)){if(null!=this.affectedTree.value)return cb(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var r=this.affectedTree.subtree(new pb(t));return new e(ob(),r,this.revert)}return cb(hb(this.path)===t,"operationForChild called for unrelated child."),new e(sb(this.path),this.affectedTree,this.revert)},e}(),kG=function(){return kw||(kw=new zd(nF)),kw},Wb=function(){function e(e,t){void 0===t&&(t=kG()),this.value=e,this.children=t}return e.fromObject=function(t){var r=new e(null);return Fb(t,function(e,t){r=r.set(new pb(e),t)}),r},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:ob(),value:this.value};if(ib(e))return null;var r=hb(e),n=this.children.get(r);if(null!==n){var i=n.findRootMostMatchingPathAndValue(sb(e),t);return null!=i?{path:yb(new pb(r),i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(ib(t))return this;var r=hb(t),n=this.children.get(r);return null!==n?n.subtree(sb(t)):new e(null)},e.prototype.set=function(t,r){if(ib(t))return new e(r,this.children);var n=hb(t),i=(this.children.get(n)||new e(null)).set(sb(t),r),o=this.children.insert(n,i);return new e(this.value,o)},e.prototype.remove=function(t){if(ib(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var r=hb(t),n=this.children.get(r);if(n){var i=n.remove(sb(t)),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),null===this.value&&o.isEmpty()?new e(null):new e(this.value,o)}return this},e.prototype.get=function(e){if(ib(e))return this.value;var t=hb(e),r=this.children.get(t);return r?r.get(sb(e)):null},e.prototype.setTree=function(t,r){if(ib(t))return r;var n=hb(t),i=(this.children.get(n)||new e(null)).setTree(sb(t),r),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new e(this.value,o)},e.prototype.fold=function(e){return this.fold_(ob(),e)},e.prototype.fold_=function(e,t){var r={};return this.children.inorderTraversal(function(n,i){r[n]=i.fold_(yb(e,n),t)}),t(e,this.value,r)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,ob(),t)},e.prototype.findOnPath_=function(e,t,r){var n=!!this.value&&r(t,this.value);if(n)return n;if(ib(e))return null;var i=hb(e),o=this.children.get(i);return o?o.findOnPath_(sb(e),yb(t,i),r):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,ob(),t)},e.prototype.foreachOnPath_=function(t,r,n){if(ib(t))return this;this.value&&n(r,this.value);var i=hb(t),o=this.children.get(i);return o?o.foreachOnPath_(sb(t),yb(r,i),n):new e(null)},e.prototype.foreach=function(e){this.foreach_(ob(),e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(r,n){n.foreach_(yb(e,r),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,r){r.value&&e(t,r.value)})},e}(),lw=function(){function e(e,t){this.source=e,this.path=t,this.type=qd.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return ib(this.path)?new e(this.source,ob()):new e(this.source,sb(this.path))},e}(),Ek=function(){function e(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=qd.OVERWRITE}return e.prototype.operationForChild=function(t){return ib(this.path)?new e(this.source,ob(),this.snap.getImmediateChild(t)):new e(this.source,sb(this.path),this.snap)},e}(),xm=function(){function e(e,t,r){this.source=e,this.path=t,this.children=r,this.type=qd.MERGE}return e.prototype.operationForChild=function(t){if(ib(this.path)){var r=this.children.subtree(new pb(t));return r.isEmpty()?null:r.value?new Ek(this.source,ob(),r.value):new e(this.source,ob(),r)}return cb(hb(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,sb(this.path),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),Ld=function(){function e(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(ib(e))return this.isFullyInitialized()&&!this.filtered_;var t=hb(e);return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),mw=function(){function e(e,t){this.eventCache_=e,this.serverCache_=t}return e.prototype.updateEventSnap=function(t,r,n){return new e(new Ld(t,r,n),this.serverCache_)},e.prototype.updateServerSnap=function(t,r,n){return new e(this.eventCache_,new Ld(t,r,n))},e.prototype.getEventCache=function(){return this.eventCache_},e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},e.prototype.getServerCache=function(){return this.serverCache_},e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},e}(),lG=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,r=e.childName;cb("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),cb(".priority"!==r,"Only non-priority child changes can be tracked.");var n=this.changeMap.get(r);if(n){var i=n.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(r,Gj(r,e.snapshotNode,n.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(r,Fj(r,n.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(r,Ug(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Mg("Illegal combination of changes: "+e+" occurred after "+n);this.changeMap.set(r,Gj(r,e.snapshotNode,n.oldSnap))}}else this.changeMap.set(r,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),mG=function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,r){return null},e}(),nw=new mG,ym=function(){function e(e,t,r){void 0===r&&(r=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var r=null!=this.optCompleteServerCache_?new Ld(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,r)},e.prototype.getChildAfterChild=function(e,t,r){var n=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(n,t,1,r,e);return 0===i.length?null:i[0]},e}(),nG=function(){return function(e,t){this.viewCache=e,this.changes=t}}(),oG=function(){function e(e){this.filter_=e}return e.prototype.assertIndexed=function(e){cb(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),cb(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,r,n,i){var o,a,s=new lG;if(r.type===qd.OVERWRITE){var $=r;$.source.fromUser?o=this.applyUserOverwrite_(t,$.path,$.snap,n,i,s):(cb($.source.fromServer,"Unknown source."),a=$.source.tagged||t.getServerCache().isFiltered()&&!ib($.path),o=this.applyServerOverwrite_(t,$.path,$.snap,n,i,a,s))}else if(r.type===qd.MERGE){var l=r;l.source.fromUser?o=this.applyUserMerge_(t,l.path,l.children,n,i,s):(cb(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.getServerCache().isFiltered(),o=this.applyServerMerge_(t,l.path,l.children,n,i,a,s))}else if(r.type===qd.ACK_USER_WRITE){var u=r;o=u.revert?this.revertUserWrite_(t,u.path,n,i,s):this.ackUserWrite_(t,u.path,u.affectedTree,n,i,s)}else{if(r.type!==qd.LISTEN_COMPLETE)throw Mg("Unknown operation type: "+r.type);o=this.listenComplete_(t,r.path,n,s)}var h=s.getChanges();return e.maybeAddValueEvent_(t,o,h),new nG(o,h)},e.maybeAddValueEvent_=function(e,t,r){var n=t.getEventCache();if(n.isFullyInitialized()){var i=n.getNode().isLeafNode()||n.getNode().isEmpty(),o=e.getCompleteEventSnap();(r.length>0||!e.getEventCache().isFullyInitialized()||i&&!n.getNode().equals(o)||!n.getNode().getPriority().equals(o.getPriority()))&&r.push(ew(t.getCompleteEventSnap()))}},e.prototype.generateEventCacheAfterServerEvent_=function(e,t,r,n,i){var o=e.getEventCache();if(null!=r.shadowingWrite(t))return e;var a=void 0,s=void 0;if(ib(t)){if(cb(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var $=e.getCompleteServerSnap(),l=$ instanceof gb?$:gb.EMPTY_NODE,u=r.calcCompleteEventChildren(l);a=this.filter_.updateFullNode(e.getEventCache().getNode(),u,i)}else{var h=r.calcCompleteEventCache(e.getCompleteServerSnap());a=this.filter_.updateFullNode(e.getEventCache().getNode(),h,i)}}else{var p=hb(t);if(".priority"===p){cb(1===Jd(t),"Can't have a priority with additional path components");var c=o.getNode();s=e.getServerCache().getNode();var d=r.calcEventCacheAfterServerOverwrite(t,c,s);a=null!=d?this.filter_.updatePriority(c,d):o.getNode()}else{var v=sb(t),E=void 0;if(o.isCompleteForChild(p)){s=e.getServerCache().getNode();var f=r.calcEventCacheAfterServerOverwrite(t,o.getNode(),s);E=null!=f?o.getNode().getImmediateChild(p).updateChild(v,f):o.getNode().getImmediateChild(p)}else E=r.calcCompleteChild(p,e.getServerCache());a=null!=E?this.filter_.updateChild(o.getNode(),p,E,v,n,i):o.getNode()}}return e.updateEventSnap(a,o.isFullyInitialized()||ib(t),this.filter_.filtersNodes())},e.prototype.applyServerOverwrite_=function(e,t,r,n,i,o,a){var s,$=e.getServerCache(),l=o?this.filter_:this.filter_.getIndexedFilter();if(ib(t))s=l.updateFullNode($.getNode(),r,null);else if(l.filtersNodes()&&!$.isFiltered()){var u=$.getNode().updateChild(t,r);s=l.updateFullNode($.getNode(),u,null)}else{var h=hb(t);if(!$.isCompleteForPath(t)&&Jd(t)>1)return e;var p=sb(t),c=$.getNode().getImmediateChild(h).updateChild(p,r);s=".priority"===h?l.updatePriority($.getNode(),c):l.updateChild($.getNode(),h,c,p,nw,null)}var d=e.updateServerSnap(s,$.isFullyInitialized()||ib(t),l.filtersNodes()),v=new ym(n,d,i);return this.generateEventCacheAfterServerEvent_(d,t,n,v,a)},e.prototype.applyUserOverwrite_=function(e,t,r,n,i,o){var a,s,$=e.getEventCache(),l=new ym(n,e,i);if(ib(t))s=this.filter_.updateFullNode(e.getEventCache().getNode(),r,o),a=e.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var u=hb(t);if(".priority"===u)s=this.filter_.updatePriority(e.getEventCache().getNode(),r),a=e.updateEventSnap(s,$.isFullyInitialized(),$.isFiltered());else{var h=sb(t),p=$.getNode().getImmediateChild(u),c=void 0;if(ib(h))c=r;else{var d=l.getCompleteChild(u);c=null!=d?".priority"===bm(h)&&d.getChild(Lv(h)).isEmpty()?d:d.updateChild(h,r):gb.EMPTY_NODE}if(p.equals(c))a=e;else{var v=this.filter_.updateChild($.getNode(),u,c,h,l,o);a=e.updateEventSnap(v,$.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.applyUserMerge_=function(t,r,n,i,o,a){var s=this,$=t;return n.foreach(function(n,l){var u=yb(r,n);e.cacheHasChild_(t,hb(u))&&($=s.applyUserOverwrite_($,u,l,i,o,a))}),n.foreach(function(n,l){var u=yb(r,n);e.cacheHasChild_(t,hb(u))||($=s.applyUserOverwrite_($,u,l,i,o,a))}),$},e.prototype.applyMerge_=function(e,t){return t.foreach(function(t,r){e=e.updateChild(t,r)}),e},e.prototype.applyServerMerge_=function(e,t,r,n,i,o,a){var s=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var $,l=e;$=ib(t)?r:new Wb(null).setTree(t,r);var u=e.getServerCache().getNode();return $.children.inorderTraversal(function(t,r){if(u.hasChild(t)){var $=e.getServerCache().getNode().getImmediateChild(t),h=s.applyMerge_($,r);l=s.applyServerOverwrite_(l,new pb(t),h,n,i,o,a)}}),$.children.inorderTraversal(function(t,r){var $=!e.getServerCache().isCompleteForChild(t)&&null==r.value;if(!u.hasChild(t)&&!$){var h=e.getServerCache().getNode().getImmediateChild(t),p=s.applyMerge_(h,r);l=s.applyServerOverwrite_(l,new pb(t),p,n,i,o,a)}}),l},e.prototype.ackUserWrite_=function(e,t,r,n,i,o){if(null!=n.shadowingWrite(t))return e;var a=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=r.value){if(ib(t)&&s.isFullyInitialized()||s.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,s.getNode().getChild(t),n,i,a,o);if(ib(t)){var $=new Wb(null);return s.getNode().forEachChild(pd,function(e,t){$=$.set(new pb(e),t)}),this.applyServerMerge_(e,t,$,n,i,a,o)}return e}var l=new Wb(null);return r.foreach(function(e,r){var n=yb(t,e);s.isCompleteForPath(n)&&(l=l.set(e,s.getNode().getChild(n)))}),this.applyServerMerge_(e,t,l,n,i,a,o)},e.prototype.listenComplete_=function(e,t,r,n){var i=e.getServerCache(),o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||ib(t),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,t,r,nw,n)},e.prototype.revertUserWrite_=function(e,t,r,n,i){var o;if(null!=r.shadowingWrite(t))return e;var a=new ym(r,e,n),s=e.getEventCache().getNode(),$=void 0;if(ib(t)||".priority"===hb(t)){var l=void 0;if(e.getServerCache().isFullyInitialized())l=r.calcCompleteEventCache(e.getCompleteServerSnap());else{var u=e.getServerCache().getNode();cb(u instanceof gb,"serverChildren would be complete if leaf node"),l=r.calcCompleteEventChildren(u)}l=l,$=this.filter_.updateFullNode(s,l,i)}else{var h=hb(t),p=r.calcCompleteChild(h,e.getServerCache());null==p&&e.getServerCache().isCompleteForChild(h)&&(p=s.getImmediateChild(h)),($=null!=p?this.filter_.updateChild(s,h,p,sb(t),a,i):e.getEventCache().getNode().hasChild(h)?this.filter_.updateChild(s,h,gb.EMPTY_NODE,sb(t),a,i):s).isEmpty()&&e.getServerCache().isFullyInitialized()&&(o=r.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&($=this.filter_.updateFullNode($,o,i))}return o=e.getServerCache().isFullyInitialized()||null!=r.shadowingWrite(ob()),e.updateEventSnap($,o,this.filter_.filtersNodes())},e}(),pG=function(){return function(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}}();function qG(e,t,r,n){var i=[],o=[];return t.forEach(function(t){"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(XF(t.childName,t.snapshotNode))}),Hj(e,i,"child_removed",t,n,r),Hj(e,i,"child_added",t,n,r),Hj(e,i,"child_moved",o,n,r),Hj(e,i,"child_changed",t,n,r),Hj(e,i,"value",t,n,r),i}function Hj(e,t,r,n,i,o){var a=n.filter(function(e){return e.type===r});a.sort(function(t,r){return sG(e,t,r)}),a.forEach(function(r){var n=rG(e,r,o);i.forEach(function(i){i.respondsTo(r.type)&&t.push(i.createEvent(n,e.query_))})})}function rG(e,t,r){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=r.getPredecessorChildName(t.childName,t.snapshotNode,e.index_),t)}function sG(e,t,r){if(null==t.childName||null==r.childName)throw Mg("Should only compare child_ events.");var n=new lb(t.childName,t.snapshotNode),i=new lb(r.childName,r.snapshotNode);return e.index_.compare(n,i)}var zm,tG=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var r=this.query_.getQueryParams(),n=new nm(r.getIndex()),i=$F(r);this.processor_=new oG(i);var o=t.getServerCache(),a=t.getEventCache(),s=n.updateFullNode(gb.EMPTY_NODE,o.getNode(),null),$=i.updateFullNode(gb.EMPTY_NODE,a.getNode(),null),l=new Ld(s,o.isFullyInitialized(),n.filtersNodes()),u=new Ld($,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new mw(u,l),this.eventGenerator_=new pG(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteNode=function(){return this.viewCache_.getCompleteEventSnap()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!ib(e)&&!t.getImmediateChild(hb(e)).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,t){var r=[];if(t){cb(null==e,"A cancel should cancel all event registrations.");var n=this.query_.path;this.eventRegistrations_.forEach(function(e){var i=e.createCancelEvent(t,n);i&&r.push(i)})}if(e){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return r},e.prototype.applyOperation=function(e,t,r){e.type===qd.MERGE&&null!==e.source.queryId&&(cb(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),cb(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var n=this.viewCache_,i=this.processor_.applyOperation(n,e,t,r);return this.processor_.assertIndexed(i.viewCache),cb(i.viewCache.getServerCache().isFullyInitialized()||!n.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),r=[];t.getNode().isLeafNode()||t.getNode().forEachChild(tb,function(e,t){r.push(Ug(e,t))});return t.isFullyInitialized()&&r.push(ew(t.getNode())),this.generateEventsForChanges_(r,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,r){var n=r?[r]:this.eventRegistrations_;return qG(this.eventGenerator_,e,t,n)},e}(),Am=function(){function e(){this.views=new Map}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return cb(zm,"Reference.ts has not been loaded"),zm},set:function(e){cb(!zm,"__referenceConstructor has already been defined"),zm=e},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.views.size},e.prototype.applyOperation=function(e,t,r){var n,i,o=e.source.queryId;if(null!==o){var a=this.views.get(o);return cb(null!=a,"SyncTree gave us an op for an invalid query."),a.applyOperation(e,t,r)}var s=[];try{for(var $=Sb(this.views.values()),l=$.next();!l.done;l=$.next()){a=l.value;s=s.concat(a.applyOperation(e,t,r))}}catch(u){n={error:u}}finally{try{l&&!l.done&&(i=$.return)&&i.call($)}finally{if(n)throw n.error}}return s},e.prototype.getView=function(e,t,r,n){var i=e.queryIdentifier(),o=this.views.get(i);if(!o){var a=t.calcCompleteEventCache(n?r:null),s=!1;a?s=!0:r instanceof gb?(a=t.calcCompleteEventChildren(r),s=!1):(a=gb.EMPTY_NODE,s=!1);var $=new mw(new Ld(a,s,!1),new Ld(r,n,!1));return new tG(e,$)}return o},e.prototype.addEventRegistration=function(e,t,r,n,i){var o=this.getView(e,r,n,i);return this.views.has(e.queryIdentifier())||this.views.set(e.queryIdentifier(),o),o.addEventRegistration(t),o.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,r,n){var i,o,a=t.queryIdentifier(),s=[],$=[],l=this.hasCompleteView();if("default"===a)try{for(var u=Sb(this.views.entries()),h=u.next();!h.done;h=u.next()){var p=qj(h.value,2),c=p[0],d=p[1];$=$.concat(d.removeEventRegistration(r,n)),d.isEmpty()&&(this.views.delete(c),d.getQuery().getQueryParams().loadsAllData()||s.push(d.getQuery()))}}catch(v){i={error:v}}finally{try{h&&!h.done&&(o=u.return)&&o.call(u)}finally{if(i)throw i.error}}else(d=this.views.get(a))&&($=$.concat(d.removeEventRegistration(r,n)),d.isEmpty()&&(this.views.delete(a),d.getQuery().getQueryParams().loadsAllData()||s.push(d.getQuery())));return l&&!this.hasCompleteView()&&s.push(new e.__referenceConstructor(t.repo,t.path)),{removed:s,events:$}},e.prototype.getQueryViews=function(){var e,t,r=[];try{for(var n=Sb(this.views.values()),i=n.next();!i.done;i=n.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||r.push(o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype.getCompleteServerCache=function(e){var t,r,n=null;try{for(var i=Sb(this.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;n=n||a.getCompleteServerCache(e)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return this.views.get(t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){var e,t;try{for(var r=Sb(this.views.values()),n=r.next();!n.done;n=r.next()){var i=n.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(o){e={error:o}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return null},e}(),Md=function(){function e(e){this.writeTree_=e}return e.empty=function(){return new e(new Wb(null))},e}();function Ij(e,t,r){if(ib(t))return new Md(new Wb(r));var n=e.writeTree_.findRootMostValueAndPath(t);if(null!=n){var i=n.path,o=n.value,a=Ob(i,t);return o=o.updateChild(a,r),new Md(e.writeTree_.set(i,o))}var s=new Wb(r),$=e.writeTree_.setTree(t,s);return new Md($)}function Bm(e,t,r){var n=e;return Fb(r,function(e,r){n=Ij(n,yb(t,e),r)}),n}function ow(e,t){if(ib(t))return Md.empty();var r=e.writeTree_.setTree(t,new Wb(null));return new Md(r)}function Cm(e,t){return null!=Nd(e,t)}function Nd(e,t){var r=e.writeTree_.findRootMostValueAndPath(t);return null!=r?e.writeTree_.get(r.path).getChild(Ob(r.path,t)):null}function pw(e){var t=[],r=e.writeTree_.value;return null!=r?r.isLeafNode()||r.forEachChild(tb,function(e,r){t.push(new lb(e,r))}):e.writeTree_.children.inorderTraversal(function(e,r){null!=r.value&&t.push(new lb(e,r.value))}),t}function Od(e,t){if(ib(t))return e;var r=Nd(e,t);return new Md(null!=r?new Wb(r):e.writeTree_.subtree(t))}function Dm(e){return e.writeTree_.isEmpty()}function Vg(e,t){return qw(ob(),e.writeTree_,t)}function qw(e,t,r){if(null!=t.value)return r.updateChild(e,t.value);var n=null;return t.children.inorderTraversal(function(t,i){".priority"===t?(cb(null!==i.value,"Priority writes must always be leaf nodes"),n=i.value):r=qw(yb(e,t),i,r)}),r.getChild(e).isEmpty()||null===n||(r=r.updateChild(yb(e,".priority"),n)),r}var uG=function(){function e(){this.visibleWrites_=Md.empty(),this.allWrites_=[],this.lastWriteId_=-1}return e.prototype.childWrites=function(e){return new vG(e,this)},e.prototype.addOverwrite=function(e,t,r,n){cb(r>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===n&&(n=!0),this.allWrites_.push({path:e,snap:t,writeId:r,visible:n}),n&&(this.visibleWrites_=Ij(this.visibleWrites_,e,t)),this.lastWriteId_=r},e.prototype.addMerge=function(e,t,r){cb(r>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:r,visible:!0}),this.visibleWrites_=Bm(this.visibleWrites_,e,t),this.lastWriteId_=r},e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var r=this.allWrites_[t];if(r.writeId===e)return r}return null},e.prototype.removeWrite=function(e){var t=this,r=this.allWrites_.findIndex(function(t){return t.writeId===e});cb(r>=0,"removeWrite called with nonexistent writeId.");var n=this.allWrites_[r];this.allWrites_.splice(r,1);for(var i=n.visible,o=!1,a=this.allWrites_.length-1;i&&a>=0;){var s=this.allWrites_[a];s.visible&&(a>=r&&this.recordContainsPath_(s,n.path)?i=!1:$b(n.path,s.path)&&(o=!0)),a--}if(i){if(o)return this.resetTree_(),!0;n.snap?this.visibleWrites_=ow(this.visibleWrites_,n.path):Fb(n.children,function(e){t.visibleWrites_=ow(t.visibleWrites_,yb(n.path,e))});return!0}return!1},e.prototype.getCompleteWriteData=function(e){return Nd(this.visibleWrites_,e)},e.prototype.calcCompleteEventCache=function(t,r,n,i){if(n||i){var o=Od(this.visibleWrites_,t);if(!i&&Dm(o))return r;if(i||null!=r||Cm(o,ob())){return Vg(e.layerTree_(this.allWrites_,function(e){return(e.visible||i)&&(!n||!~n.indexOf(e.writeId))&&($b(e.path,t)||$b(t,e.path))},t),r||gb.EMPTY_NODE)}return null}var a=Nd(this.visibleWrites_,t);if(null!=a)return a;var s=Od(this.visibleWrites_,t);return Dm(s)?r:null!=r||Cm(s,ob())?Vg(s,r||gb.EMPTY_NODE):null},e.prototype.calcCompleteEventChildren=function(e,t){var r=gb.EMPTY_NODE,n=Nd(this.visibleWrites_,e);if(n)return n.isLeafNode()||n.forEachChild(tb,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(t){var i=Od(this.visibleWrites_,e);return t.forEachChild(tb,function(e,t){var n=Vg(Od(i,new pb(e)),t);r=r.updateImmediateChild(e,n)}),pw(i).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return pw(Od(this.visibleWrites_,e)).forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r,n){cb(r||n,"Either existingEventSnap or existingServerSnap must exist");var i=yb(e,t);if(Cm(this.visibleWrites_,i))return null;var o=Od(this.visibleWrites_,i);return Dm(o)?n.getChild(t):Vg(o,n.getChild(t))},e.prototype.calcCompleteChild=function(e,t,r){var n=yb(e,t),i=Nd(this.visibleWrites_,n);return null!=i?i:r.isCompleteForChild(t)?Vg(Od(this.visibleWrites_,n),r.getNode().getImmediateChild(t)):null},e.prototype.shadowingWrite=function(e){return Nd(this.visibleWrites_,e)},e.prototype.calcIndexedSlice=function(e,t,r,n,i,o){var a,s=Od(this.visibleWrites_,e),$=Nd(s,ob());if(null!=$)a=$;else{if(null==t)return[];a=Vg(s,t)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var l=[],u=o.getCompare(),h=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),p=h.getNext();p&&l.length<n;)0!==u(p,r)&&l.push(p),p=h.getNext();return l},e.prototype.recordContainsPath_=function(e,t){if(e.snap)return $b(e.path,t);for(var r in e.children)if(e.children.hasOwnProperty(r)&&$b(yb(e.path,r),t))return!0;return!1},e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,ob()),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},e.DefaultFilter_=function(e){return e.visible},e.layerTree_=function(e,t,r){for(var n=Md.empty(),i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,s=void 0;if(o.snap)$b(r,a)?n=Ij(n,s=Ob(r,a),o.snap):$b(a,r)&&(s=Ob(a,r),n=Ij(n,ob(),o.snap.getChild(s)));else{if(!o.children)throw Mg("WriteRecord should have .snap or .children");if($b(r,a))n=Bm(n,s=Ob(r,a),o.children);else if($b(a,r))if(ib(s=Ob(a,r)))n=Bm(n,ob(),o.children);else{var $=ed(o.children,hb(s));if($){var l=$.getChild(sb(s));n=Ij(n,ob(),l)}}}}}return n},e}(),vG=function(){function e(e,t){this.treePath_=e,this.writeTree_=t}return e.prototype.calcCompleteEventCache=function(e,t,r){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,r)},e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,r)},e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(yb(this.treePath_,e))},e.prototype.calcIndexedSlice=function(e,t,r,n,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,r,n,i)},e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},e.prototype.child=function(t){return new e(yb(this.treePath_,t),this.writeTree_)},e}(),rw=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=new Wb(null),this.pendingWriteTree_=new uG,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return e.prototype.applyUserOverwrite=function(e,t,r,n){return this.pendingWriteTree_.addOverwrite(e,t,r,n),n?this.applyOperationToSyncPoints_(new Ek(um(),e,t)):[]},e.prototype.applyUserMerge=function(e,t,r){this.pendingWriteTree_.addMerge(e,t,r);var n=Wb.fromObject(t);return this.applyOperationToSyncPoints_(new xm(um(),e,n))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var r=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var n=new Wb(null);return null!=r.snap?n=n.set(ob(),!0):Fb(r.children,function(e){n=n.set(new pb(e),!0)}),this.applyOperationToSyncPoints_(new jG(r.path,n,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new Ek(vm(),e,t))},e.prototype.applyServerMerge=function(e,t){var r=Wb.fromObject(t);return this.applyOperationToSyncPoints_(new xm(vm(),e,r))},e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new lw(vm(),e))},e.prototype.applyTaggedQueryOverwrite=function(t,r,n){var i=this.queryKeyForTag_(n);if(null!=i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,$=Ob(a,t),l=new Ek(wm(s),$,r);return this.applyTaggedOperation_(a,l)}return[]},e.prototype.applyTaggedQueryMerge=function(t,r,n){var i=this.queryKeyForTag_(n);if(i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,$=Ob(a,t),l=Wb.fromObject(r),u=new xm(wm(s),$,l);return this.applyTaggedOperation_(a,u)}return[]},e.prototype.applyTaggedListenComplete=function(t,r){var n=this.queryKeyForTag_(r);if(n){var i=e.parseQueryKey_(n),o=i.path,a=i.queryId,s=Ob(o,t),$=new lw(wm(a),s);return this.applyTaggedOperation_(o,$)}return[]},e.prototype.addEventRegistration=function(t,r){var n=t.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(n,function(e,t){var r=Ob(e,n);i=i||t.getCompleteServerCache(r),o=o||t.hasCompleteView()});var a,s=this.syncPointTree_.get(n);(s?(o=o||s.hasCompleteView(),i=i||s.getCompleteServerCache(ob())):(s=new Am,this.syncPointTree_=this.syncPointTree_.set(n,s)),null!=i)?a=!0:(a=!1,i=gb.EMPTY_NODE,this.syncPointTree_.subtree(n).foreachChild(function(e,t){var r=t.getCompleteServerCache(ob());r&&(i=i.updateImmediateChild(e,r))}));var $=s.viewExistsForQuery(t);if(!$&&!t.getQueryParams().loadsAllData()){var l=e.makeQueryKey_(t);cb(!this.queryToTagMap.has(l),"View does not exist, but we have a tag");var u=e.getNextQueryTag_();this.queryToTagMap.set(l,u),this.tagToQueryMap.set(u,l)}var h=this.pendingWriteTree_.childWrites(n),p=s.addEventRegistration(t,r,h,i,a);if(!$&&!o){var c=s.viewForQuery(t);p=p.concat(this.setupListener_(t,c))}return p},e.prototype.removeEventRegistration=function(t,r,n){var i=this,o=t.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===t.queryIdentifier()||a.viewExistsForQuery(t))){var $=a.removeEventRegistration(t,r,n);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var l=$.removed;s=$.events;var u=-1!==l.findIndex(function(e){return e.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(o,function(e,t){return t.hasCompleteView()});if(u&&!h){var p=this.syncPointTree_.subtree(o);if(!p.isEmpty())for(var c=this.collectDistinctViewsForSubTree_(p),d=0;d<c.length;++d){var v=c[d],E=v.getQuery(),f=this.createListenerForView_(v);this.listenProvider_.startListening(e.queryForListening_(E),this.tagForQuery_(E),f.hashFn,f.onComplete)}}if(!h&&l.length>0&&!n)if(u){this.listenProvider_.stopListening(e.queryForListening_(t),null)}else l.forEach(function(t){var r=i.queryToTagMap.get(e.makeQueryKey_(t));i.listenProvider_.stopListening(e.queryForListening_(t),r)});this.removeTags_(l)}return s},e.prototype.calcCompleteEventCache=function(e,t){var r=this.pendingWriteTree_,n=this.syncPointTree_.findOnPath(e,function(t,r){var n=Ob(t,e),i=r.getCompleteServerCache(n);if(i)return i});return r.calcCompleteEventCache(e,n,t,!0)},e.prototype.getServerValue=function(e){var t=e.path,r=null;this.syncPointTree_.foreachOnPath(t,function(e,n){var i=Ob(e,t);r=r||n.getCompleteServerCache(i)});var n=this.syncPointTree_.get(t);n?r=r||n.getCompleteServerCache(ob()):(n=new Am,this.syncPointTree_=this.syncPointTree_.set(t,n));var i=null!=r,o=i?new Ld(r,!0,!1):null,a=this.pendingWriteTree_.childWrites(e.path);return n.getView(e,a,i?o.getNode():gb.EMPTY_NODE,i).getCompleteNode()},e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,r){if(t&&t.hasCompleteView())return[t.getCompleteView()];var n=[];return t&&(n=t.getQueryViews()),Fb(r,function(e,t){n=n.concat(t)}),n})},e.prototype.removeTags_=function(t){for(var r=0;r<t.length;++r){var n=t[r];if(!n.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(n),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.setupListener_=function(t,r){var n=t.path,i=this.tagForQuery_(t),o=this.createListenerForView_(r),a=this.listenProvider_.startListening(e.queryForListening_(t),i,o.hashFn,o.onComplete),s=this.syncPointTree_.subtree(n);if(i)cb(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var $=s.fold(function(e,t,r){if(!ib(e)&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var n=[];return t&&(n=n.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),Fb(r,function(e,t){n=n.concat(t)}),n}),l=0;l<$.length;++l){var u=$[l];this.listenProvider_.stopListening(e.queryForListening_(u),this.tagForQuery_(u))}return a},e.prototype.createListenerForView_=function(e){var t=this,r=e.getQuery(),n=this.tagForQuery_(r);return{hashFn:function(){return(e.getServerCache()||gb.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return n?t.applyTaggedListenComplete(r.path,n):t.applyListenComplete(r.path);var i=qF(e,r);return t.removeEventRegistration(r,null,i)}}},e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},e.parseQueryKey_=function(e){var t=e.indexOf("$");return cb(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new pb(e.substr(0,t))}},e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap.get(e)},e.prototype.tagForQuery_=function(t){var r=e.makeQueryKey_(t);return this.queryToTagMap.get(r)},e.getNextQueryTag_=function(){return e.nextQueryTag_++},e.prototype.applyTaggedOperation_=function(e,t){var r=this.syncPointTree_.get(e);cb(r,"Missing sync point for query tag that we're tracking");var n=this.pendingWriteTree_.childWrites(e);return r.applyOperation(t,n,null)},e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(ob()))},e.prototype.applyOperationHelper_=function(e,t,r,n){if(ib(e.path))return this.applyOperationDescendantsHelper_(e,t,r,n);var i=t.get(ob());null==r&&null!=i&&(r=i.getCompleteServerCache(ob()));var o=[],a=hb(e.path),s=e.operationForChild(a),$=t.children.get(a);if($&&s){var l=r?r.getImmediateChild(a):null,u=n.child(a);o=o.concat(this.applyOperationHelper_(s,$,l,u))}return i&&(o=o.concat(i.applyOperation(e,n,r))),o},e.prototype.applyOperationDescendantsHelper_=function(e,t,r,n){var i=this,o=t.get(ob());null==r&&null!=o&&(r=o.getCompleteServerCache(ob()));var a=[];return t.children.inorderTraversal(function(t,o){var s=r?r.getImmediateChild(t):null,$=n.child(t),l=e.operationForChild(t);l&&(a=a.concat(i.applyOperationDescendantsHelper_(l,o,s,$)))}),o&&(a=a.concat(o.applyOperation(e,n,r))),a},e.nextQueryTag_=1,e}(),wG=function(){function e(){this.rootNode_=gb.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}(),xG=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),Ub(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return sv(this.counters_)},e}(),Fk=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new xG),this.collections_[t]},e.getOrCreateReporter=function(e,t){var r=e.toString();return this.reporters_[r]||(this.reporters_[r]=t()),this.reporters_[r]},e.collections_={},e.reporters_={},e}(),sw=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=gg({},e);return this.last_&&Fb(this.last_,function(e,r){t[e]=t[e]-r}),this.last_=e,t},e}(),tw=1e4,yG=3e4,zG=3e5,AG=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new sw(e);var r=tw+(yG-tw)*Math.random();yj(this.reportStats_.bind(this),Math.floor(r))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),r={},n=!1;Fb(t,function(t,i){i>0&&Ub(e.statsToReport_,t)&&(r[t]=i,n=!0)}),n&&this.server_.reportStats(r),yj(this.reportStats_.bind(this),Math.floor(2*Math.random()*zG))},e}(),BG=function(){return function(){this.eventLists_=[],this.recursionDepth_=0}}();function Gk(e,t){for(var r=null,n=0;n<t.length;n++){var i=t[n],o=i.getPath();null===r||cm(o,r.path)||(e.eventLists_.push(r),r=null),null===r&&(r={events:[],path:o}),r.events.push(i)}r&&e.eventLists_.push(r)}function Em(e,t,r){Gk(e,r),uw(e,function(e){return cm(e,t)})}function ad(e,t,r){Gk(e,r),uw(e,function(e){return $b(e,t)||$b(t,e)})}function uw(e,t){e.recursionDepth_++;for(var r=!0,n=0;n<e.eventLists_.length;n++){var i=e.eventLists_[n];if(i)t(i.path)?(CG(e.eventLists_[n]),e.eventLists_[n]=null):r=!1}r&&(e.eventLists_=[]),e.recursionDepth_--}function CG(e){for(var t=0;t<e.events.length;t++){var r=e.events[t];if(null!==r){e.events[t]=null;var n=r.getEventRunner();uk&&Kb("event: "+r.toString()),Qg(n)}}}var vw=function(){function e(e){this.allowedEvents_=e,this.listeners_={},cb(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Array.isArray(this.listeners_[e]))for(var n=hg(this.listeners_[e]),i=0;i<n.length;i++)n[i].callback.apply(n[i].context,t)},e.prototype.on=function(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});var n=this.getInitialEvent(e);n&&t.apply(r,n)},e.prototype.off=function(e,t,r){this.validateEventType_(e);for(var n=this.listeners_[e]||[],i=0;i<n.length;i++)if(n[i].callback===t&&(!r||r===n[i].context))return void n.splice(i,1)},e.prototype.validateEventType_=function(e){cb(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}(),DG=function(e){function t(){var t,r,n=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(r="visibilitychange",t="hidden"):void 0!==document.mozHidden?(r="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(r="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(r="webkitvisibilitychange",t="webkitHidden")),n.visible_=!0,r&&document.addEventListener(r,function(){var e=!document[t];e!==n.visible_&&(n.visible_=e,n.trigger("visible",e))},!1),n}return dd(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return cb("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(vw),ww=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||tv()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return dd(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return cb("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(vw),EG=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var r=this;this.pendingResponses[e]=t;for(var n=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&Qg(function(){r.onMessage_(e[t])})},n=0;n<e.length;++n)t(n);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===n())break}},e}(),xw="start",FG="close",GG="pLPCommand",HG="pRTLPCB",IG="seg",JG="ts",KG="d",yw=1870,zw=30,LG=yw-zw,MG=25e3,NG=3e4,Fm=function(){function e(e,t,r,n,i){this.connId=e,this.repoInfo=t,this.applicationId=r,this.transportSessionId=n,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=wj(e),this.stats_=Fk.getCollection(t),this.urlFn=function(e){return t.connectionURL(Qv,e)}}return e.prototype.open=function(e,t){var r=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new EG(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){r.log_("Timed out trying to connect."),r.onClosed_(),r.connectTimeoutTimer_=null},Math.floor(NG)),mF(function(){if(!r.isClosed_){r.scriptTagHolder=new OG(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qj(e,5),i=n[0],o=n[1],a=n[2];n[3],n[4];if(r.incrementIncomingBytes_(e),r.scriptTagHolder)if(r.connectTimeoutTimer_&&(clearTimeout(r.connectTimeoutTimer_),r.connectTimeoutTimer_=null),r.everConnected_=!0,i===xw)r.id=o,r.password=a;else{if(i!==FG)throw new Error("Unrecognized command received: "+i);o?(r.scriptTagHolder.sendNewPolls=!1,r.myPacketOrderer.closeAfter(o,function(){r.onClosed_()})):r.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=qj(e,2),i=n[0],o=n[1];r.incrementIncomingBytes_(e),r.myPacketOrderer.handleResponse(i,o)},function(){r.onClosed_()},r.urlFn);var e={};e[xw]="t",r.scriptTagHolder.uniqueCallbackIdentifier&&r.scriptTagHolder.uniqueCallbackIdentifier,r.transportSessionId&&r.transportSessionId,r.lastSessionId&&r.lastSessionId,r.applicationId&&r.applicationId,"undefined"!=typeof location&&location.hostname&&Ov.test(location.hostname)&&Nv;var t=r.urlFn(e);r.log_("Connecting via long-poll to "+t),r.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!ld()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!oF()&&!pF())},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Eb(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var r=zE(t),n=Iv(r,LG),i=0;i<n.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!ld()){this.myDisconnFrame=document.createElement("iframe");var r={};this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=Eb(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),OG=function(){function e(t,r,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,ld())this.commandCB=t,this.onMessageCB=r;else{this.uniqueCallbackIdentifier=Fv(),window[GG+this.uniqueCallbackIdentifier]=t,window[HG+this.uniqueCallbackIdentifier]=r,this.myIFrame=e.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))o="<script>document.domain=\""+document.domain+"\";</script>";var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(s){Kb("frame writing exception"),s.stack&&Kb(s.stack),Kb(s)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Kb("No IE domain setting required")}catch(r){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};for(var t=this.urlFn(e),r="",n=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+zw+r.length<=yw))break;var i=this.pendingSegs.shift();r=r+"&"+IG+n+"="+i.seg+"&"+JG+n+"="+i.ts+"&"+KG+n+"="+i.d,n++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var r=this;this.outstandingRequests.add(t);var n=function(){r.outstandingRequests.delete(t),r.newRequest_()},i=setTimeout(n,Math.floor(MG));this.addTag(e,function(){clearTimeout(i),n()})},e.prototype.addTag=function(e,t){var r=this;ld()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!r.sendNewPolls)return;var n=r.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){var e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=function(){Kb("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(n)}catch(i){}},Math.floor(1))},e}(),Aw="";function Bw(e){Aw=e}var PG=16384,QG=45e3,Gm=null;"undefined"!=typeof MozWebSocket?Gm=MozWebSocket:"undefined"!=typeof WebSocket&&(Gm=WebSocket);var Gb,lg=function(){function e(t,r,n,i,o){this.connId=t,this.applicationId=n,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=wj(this.connId),this.stats_=Fk.getCollection(r),this.connURL=e.connectionURL_(r,i,o),this.nodeAdmin=r.nodeAdmin}return e.connectionURL_=function(e,t,r){var n={};return!ld()&&"undefined"!=typeof location&&location.hostname&&Ov.test(location.hostname)&&Nv,t&&t,r&&r,e.connectionURL(Pv,n)},e.prototype.open=function(e,t){var r=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,jg.set("previous_websocket_failure",!0);try{if(ld()){var n=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/"+Mv+"/"+Aw+"/"+tk.platform+"/"+n,"X-Firebase-GMPID":this.applicationId||""}},o=tk.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a}),this.mySock=new Gm(this.connURL,[],i)}else{i={headers:{"X-Firebase-GMPID":this.applicationId||""}};this.mySock=new Gm(this.connURL,[],i)}}catch($){this.log_("Error instantiating WebSocket.");var s=$.message||$.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&r.log_(t),r.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==Gm&&!e.forceDisallow_},e.previouslyFailed=function(){return jg.isInMemoryStorage||!0===jg.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){jg.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var r=sj(t);this.onMessage(r)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(cb(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var r=this.extractFrameCount_(t);null!==r&&this.appendFrame_(r)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=Eb(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var r=Iv(t,PG);r.length>1&&this.sendString_(String(r.length));for(var n=0;n<r.length;n++)this.sendString_(r[n])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(QG))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),RG=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[Fm,lg]},enumerable:!1,configurable:!0}),e.prototype.initTransports_=function(t){var r,n,i=lg&&lg.isAvailable(),o=i&&!lg.previouslyFailed();if(t.webSocketOnly&&(i||Nb("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[lg];else{var a=this.transports_=[];try{for(var s=Sb(e.ALL_TRANSPORTS),$=s.next();!$.done;$=s.next()){var l=$.value;l&&l.isAvailable()&&a.push(l)}}catch(u){r={error:u}}finally{try{$&&!$.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),SG=6e4,TG=5e3,UG=10240,VG=102400,Hm="t",Cw="d",WG="s",Dw="r",XG="e",Ew="o",Fw="a",Gw="n",Hw="p",YG="h",Iw=function(){function e(e,t,r,n,i,o,a,s){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.onMessage_=n,this.onReady_=i,this.onDisconnect_=o,this.onKill_=a,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=wj("c:"+this.id+":"),this.transportManager_=new RG(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(r,n)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=yj(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>VG?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>UG?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(r){e===t.conn_?t.onConnectionLost_(r):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(r){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(r):e===t.secondaryConn_?t.onSecondaryMessageReceived_(r):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if(Hm in e){var t=e[Hm];t===Fw?this.upgradeIfSecondaryHealthy_():t===Dw?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):t===Ew&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=xj("t",e),r=xj("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Hw,d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Fw,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Gw,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=xj("t",e),r=xj("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=xj(Hm,e);if(Cw in e){var r=e[Cw];if(t===YG)this.onHandshake_(r);else if(t===Gw){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===WG?this.onConnectionShutdown_(r):t===Dw?this.onReset_(r):t===XG?$l("Server Error: "+r):t===Ew?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):$l("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,r=e.v,n=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(n),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Mv!==r&&Nb("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),yj(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(SG))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var r=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):yj(function(){r.sendPingOnPrimaryIfNecessary_()},Math.floor(TG))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Hw,d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(jg.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),Jw=function(){function e(){}return e.prototype.put=function(e,t,r,n){},e.prototype.merge=function(e,t,r,n){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,r){},e.prototype.onDisconnectMerge=function(e,t,r){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),Jj=1e3,ZG=3e5,$G=3e3,Kw=3e4,_G=1.3,aH=3e4,bH="server_kill",cH=3,mg=function(e){function t(r,n,i,o,a,s,$){var l=e.call(this)||this;if(l.repoInfo_=r,l.applicationId_=n,l.onDataUpdate_=i,l.onConnectStatus_=o,l.onServerInfoUpdate_=a,l.authTokenProvider_=s,l.authOverride_=$,l.id=t.nextPersistentConnectionId_++,l.log_=wj("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=Jj,l.maxReconnectDelay_=ZG,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,$&&!ld())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return l.scheduleConnect_(0),DG.getInstance().on("visible",l.onVisible_,l),-1===r.host.indexOf("fblocal")&&ww.getInstance().on("online",l.onOnline_,l),l}return dd(t,e),t.prototype.sendRequest=function(e,t,r){var n=++this.requestNumber_,i={r:n,a:e,b:t};this.log_(Eb(i)),cb(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[n]=r)},t.prototype.get=function(e){var t=this,r=new Tb,n={p:e.path.toString(),q:e.queryObject()},i={action:"g",request:n,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(n.p,i,!1,null),r.resolve(i)):r.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var o=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var e=t.outstandingGets_[o];void 0!==e&&i===e&&(delete t.outstandingGets_[o],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+o+" timed out on connection"),r.reject(new Error("Client is offline.")))},$G),this.connected_&&this.sendGet_(o),r.promise},t.prototype.listen=function(e,t,r,n){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),cb(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),cb(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:n,hashFn:t,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},t.prototype.sendGet_=function(e){var t=this,r=this.outstandingGets_[e];this.sendRequest("g",r.request,function(n){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),r.onComplete&&r.onComplete(n)})},t.prototype.sendListen_=function(e){var r=this,n=e.query,i=n.path.toString(),o=n.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=n.queryObject(),a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,$=a.s;t.warnOnListenWarnings_(s,n),(r.listens.get(i)&&r.listens.get(i).get(o))===e&&(r.log_("listen response",a),"ok"!==$&&r.removeListen_(i,o),e.onComplete&&e.onComplete($,s))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&Ub(e,"w")){var r=ed(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){var n="\".indexOn\": \""+t.getQueryParams().getIndex().toString()+"\"",i=t.path.toString();Nb("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+n+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||KE(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Kw)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,r=JE(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(r,n,function(r){var n=r.s,i=r.d||"error";e.authToken_===t&&("ok"===n?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(n,i))})}},t.prototype.unlisten=function(e,t){var r=e.path.toString(),n=e.queryIdentifier();this.log_("Unlisten called for "+r+" "+n),cb(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,n)&&this.connected_&&this.sendUnlisten_(r,n,e.queryObject(),t)},t.prototype.sendUnlisten_=function(e,t,r,n){this.log_("Unlisten on "+e+" for "+t);var i={p:e};n&&(i.q=r,i.t=n),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,r){this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})},t.prototype.onDisconnectMerge=function(e,t,r){this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,r,n){var i={p:t,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){n&&setTimeout(function(){n(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,r,n){this.putInternal("p",e,t,r,n)},t.prototype.merge=function(e,t,r,n){this.putInternal("m",e,t,r,n)},t.prototype.putInternal=function(e,t,r,n,i){var o={p:t,d:r};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:n}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,r=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,n,function(n){t.log_(r+" response",n),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(n.s,n.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,function(e){if("ok"!==e.s){var r=e.d;t.log_("reportStats","Error sending stats: "+r)}})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Eb(e));var t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):$l("Unrecognized action received from server: "+Eb(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;cb(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Jj,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Jj,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){new Date().getTime()-this.lastConnectionEstablishedTime_>aH&&(this.reconnectDelay_=Jj),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime();var e=new Date().getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*_G)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){var e=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;var r=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+t.nextConnectionId_++,a=this,s=this.lastSessionId,$=!1,l=null,u=function(){l?l.close():($=!0,i())};this.realtime_={close:u,sendRequest:function(e){cb(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(e)}};var h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(h).then(function(e){$?Kb("getToken() completed but was canceled"):(Kb("getToken() completed. Creating connection."),a.authToken_=e&&e.accessToken,l=new Iw(o,a.repoInfo_,a.applicationId_,r,n,i,function(e){Nb(e+" ("+a.repoInfo_.toString()+")"),a.interrupt(bH)},s))}).then(null,function(t){a.log_("Failed to get token: "+t),$||(e.repoInfo_.nodeAdmin&&Nb(t),u())})}},t.prototype.interrupt=function(e){Kb("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){Kb("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Vl(this.interruptReasons_)&&(this.reconnectDelay_=Jj,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var r;r=t?t.map(function(e){return _l(e)}).join("$"):"default";var n=this.removeListen_(e,r);n&&n.onComplete&&n.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var r,n=new pb(e).toString();if(this.listens.has(n)){var i=this.listens.get(n);r=i.get(t),i.delete(t),0===i.size&&this.listens.delete(n)}else r=void 0;return r},t.prototype.onAuthRevoked_=function(e,t){Kb("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=cH&&(this.reconnectDelay_=Kw,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,r,n;this.tryAuth();try{for(var i=Sb(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(r=void 0,Sb(a.values())),$=s.next();!$.done;$=s.next()){var l=$.value;this.sendListen_(l)}}catch(p){r={error:p}}finally{try{$&&!$.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}catch(c){e={error:c}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var u=0;u<this.outstandingPuts_.length;u++)this.outstandingPuts_[u]&&this.sendPut_(u);for(;this.onDisconnectRequestQueue_.length;){var h=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(h.action,h.pathString,h.data,h.onComplete)}for(u=0;u<this.outstandingGets_.length;u++)this.outstandingGets_[u]&&this.sendGet_(u)},t.prototype.sendConnectStats_=function(){var e={},t="js";ld()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+Aw.replace(/\./g,"-")]=1,tv()?e["framework.cordova"]=1:EE()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=ww.getInstance().currentlyOnline();return Vl(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(Jw),dH=function(e){function t(t,r,n){var i=e.call(this)||this;return i.repoInfo_=t,i.onDataUpdate_=r,i.authTokenProvider_=n,i.log_=wj("p:rest:"),i.listens_={},i}return dd(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(cb(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},t.prototype.listen=function(e,r,n,i){var o=this,a=e.path.toString();this.log_("Listen called for "+a+" "+e.queryIdentifier());var s=t.getListenId_(e,n),$={};this.listens_[s]=$;var l=hw(e.getQueryParams());this.restRequest_(a+".json",l,function(e,t){var r=t;(404===e&&(r=null,e=null),null===e&&o.onDataUpdate_(a,r,!1,n),ed(o.listens_,s)===$)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})},t.prototype.unlisten=function(e,r){var n=t.getListenId_(e,r);delete this.listens_[n]},t.prototype.get=function(e){var t=this,r=hw(e.getQueryParams()),n=e.path.toString(),i=new Tb;return this.restRequest_(n+".json",r,function(e,r){var o=r;404===e&&(o=null,e=null),null===e?(t.onDataUpdate_(n,o,!1,null),i.resolve(o)):i.reject(new Error(o))}),i.promise},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,r){var n=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var o=i&&i.accessToken;o&&(t.auth=o);var a=(n.repoInfo_.secure?"https://":"http://")+n.repoInfo_.host+e+"?ns="+n.repoInfo_.namespace+LE(t);n.log_("Sending REST request for "+a);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(r&&4===s.readyState){n.log_("REST Response for "+a+" received. status:",s.status,"response:",s.responseText);var e=null;if(s.status>=200&&s.status<300){try{e=sj(s.responseText)}catch(t){Nb("Failed to parse JSON response for "+a+": "+s.responseText)}r(null,e)}else 401!==s.status&&404!==s.status&&Nb("Got unsuccessful REST response for "+a+" Status: "+s.status),r(s.status);r=null}},s.open("GET",a,!0),s.send()})},t}(Jw),Lw=function(){return function(){this.children={},this.childCount=0,this.value=null}}(),eH=function(){function e(e,t,r){void 0===e&&(e=""),void 0===t&&(t=null),void 0===r&&(r=new Lw),this.name_=e,this.parent_=t,this.node_=r}return e.prototype.subTree=function(t){for(var r=t instanceof pb?t:new pb(t),n=this,i=hb(r);null!==i;){n=new e(i,n,ed(n.node_.children,i)||new Lw),i=hb(r=sb(r))}return n},e.prototype.getValue=function(){return this.node_.value},e.prototype.setValue=function(e){cb(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},e.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},e.prototype.hasChildren=function(){return this.node_.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var r=this;Fb(this.node_.children,function(n,i){t(new e(n,r,i))})},e.prototype.forEachDescendant=function(e,t,r){t&&!r&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,r)}),t&&r&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var r=t?this:this.parent();null!==r;){if(e(r))return!0;r=r.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},e.prototype.path=function(){return new pb(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},e.prototype.name=function(){return this.name_},e.prototype.parent=function(){return this.parent_},e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},e.prototype.updateChild_=function(e,t){var r=t.isEmpty(),n=Ub(this.node_.children,e);r&&n?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):r||n||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},e}(),Mw="repo_interrupt",fH=25;!function(e){e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT"}(Gb||(Gb={}));var Im=function(){function e(e,t,r,n){this.repoInfo_=e,this.forceRestClient_=t,this.app=r,this.authTokenProvider_=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new BG,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new tm,this.transactionQueueTree_=new eH,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e.prototype.start=function(){var e=this;if(this.stats_=Fk.getCollection(this.repoInfo_),this.forceRestClient_||sF())this.server_=new dH(this.repoInfo_,this.onDataUpdate_.bind(this),this.authTokenProvider_),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var t=this.app.options.databaseAuthVariableOverride;if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Eb(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}this.persistentConnection_=new mg(this.repoInfo_,this.app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),this.authTokenProvider_,t),this.server_=this.persistentConnection_}this.authTokenProvider_.addTokenChangeListener(function(t){e.server_.refreshAuthToken(t)}),this.statsReporter_=Fk.getOrCreateReporter(this.repoInfo_,function(){return new AG(e.stats_,e.server_)}),this.infoData_=new wG,this.infoSyncTree_=new rw({startListening:function(t,r,n,i){var o=[],a=e.infoData_.getNode(t.path);return a.isEmpty()||(o=e.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new rw({startListening:function(t,r,n,i){return e.server_.listen(t,n,r,function(r,n){var o=i(r,n);ad(e.eventQueue_,t.path,o)}),[]},stopListening:function(t,r){e.server_.unlisten(t,r)}})},e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new pb(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e},e.prototype.generateServerValues=function(){return gG({timestamp:this.serverTime()})},e.prototype.onDataUpdate_=function(e,t,r,n){this.dataUpdateCount++;var i=new pb(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var o=[];if(n){if(r){var a=pk(t,function(e){return Bb(e)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,n)}else{var s=Bb(t);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,s,n)}}else if(r){var $=pk(t,function(e){return Bb(e)});o=this.serverSyncTree_.applyServerMerge(i,$)}else{var l=Bb(t);o=this.serverSyncTree_.applyServerOverwrite(i,l)}var u=i;o.length>0&&(u=this.rerunTransactions_(i)),ad(this.eventQueue_,u,o)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var t=this;Fb(e,function(e,r){t.updateInfo_(e,r)})},e.prototype.updateInfo_=function(e,t){var r=new pb("/.info/"+e),n=Bb(t);this.infoData_.updateSnapshot(r,n);var i=this.infoSyncTree_.applyServerOverwrite(r,n);ad(this.eventQueue_,r,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.getValue=function(e){var t=this,r=this.serverSyncTree_.getServerValue(e);return null!=r?Promise.resolve(new Kd(r,e.getRef(),e.getQueryParams().getIndex())):this.server_.get(e).then(function(r){var n=Bb(r),i=t.serverSyncTree_.applyServerOverwrite(e.path,n);return Em(t.eventQueue_,e.path,i),Promise.resolve(new Kd(n,e.getRef(),e.getQueryParams().getIndex()))},function(r){return t.log_("get for query "+Eb(e)+" failed: "+r),Promise.reject(new Error(r))})},e.prototype.setWithPriority=function(e,t,r,n){var i=this;this.log_("set",{path:e.toString(),value:t,priority:r});var o=this.generateServerValues(),a=Bb(t,r),s=this.serverSyncTree_.calcCompleteEventCache(e),$=rm(a,s,o),l=this.getNextWriteId_(),u=this.serverSyncTree_.applyUserOverwrite(e,$,l,!0);Gk(this.eventQueue_,u),this.server_.put(e.toString(),a.val(!0),function(t,r){var o="ok"===t;o||Nb("set at "+e+" failed: "+t);var a=i.serverSyncTree_.ackUserWrite(l,!o);ad(i.eventQueue_,e,a),i.callOnCompleteCallback(n,t,r)});var h=this.abortTransactions_(e);this.rerunTransactions_(h),ad(this.eventQueue_,h,[])},e.prototype.update=function(e,t,r){var n=this;this.log_("update",{path:e.toString(),value:t});var i=!0,o=this.generateServerValues(),a={};if(Fb(t,function(t,r){i=!1,a[t]=jw(yb(e,t),Bb(r),n.serverSyncTree_,o)}),i)Kb("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(r,"ok");else{var s=this.getNextWriteId_(),$=this.serverSyncTree_.applyUserMerge(e,a,s);Gk(this.eventQueue_,$),this.server_.merge(e.toString(),t,function(t,i){var o="ok"===t;o||Nb("update at "+e+" failed: "+t);var a=n.serverSyncTree_.ackUserWrite(s,!o),$=a.length>0?n.rerunTransactions_(e):e;ad(n.eventQueue_,$,a),n.callOnCompleteCallback(r,t,i)}),Fb(t,function(t){var r=n.abortTransactions_(yb(e,t));n.rerunTransactions_(r)}),ad(this.eventQueue_,e,[])}},e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),r=new tm;this.onDisconnect_.forEachTree(ob(),function(n,i){var o=jw(n,i,e.serverSyncTree_,t);r.remember(n,o)});var n=[];r.forEachTree(ob(),function(t,r){n=n.concat(e.serverSyncTree_.applyServerOverwrite(t,r));var i=e.abortTransactions_(t);e.rerunTransactions_(i)}),this.onDisconnect_=new tm,ad(this.eventQueue_,ob(),n)},e.prototype.onDisconnectCancel=function(e,t){var r=this;this.server_.onDisconnectCancel(e.toString(),function(n,i){"ok"===n&&r.onDisconnect_.forget(e),r.callOnCompleteCallback(t,n,i)})},e.prototype.onDisconnectSet=function(e,t,r){var n=this,i=Bb(t);this.server_.onDisconnectPut(e.toString(),i.val(!0),function(t,o){"ok"===t&&n.onDisconnect_.remember(e,i),n.callOnCompleteCallback(r,t,o)})},e.prototype.onDisconnectSetWithPriority=function(e,t,r,n){var i=this,o=Bb(t,r);this.server_.onDisconnectPut(e.toString(),o.val(!0),function(t,r){"ok"===t&&i.onDisconnect_.remember(e,o),i.callOnCompleteCallback(n,t,r)})},e.prototype.onDisconnectUpdate=function(e,t,r){var n=this;if(Vl(t))return Kb("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(r,"ok");this.server_.onDisconnectMerge(e.toString(),t,function(i,o){"ok"===i&&Fb(t,function(t,r){var i=Bb(r);n.onDisconnect_.remember(yb(e,t),i)}),n.callOnCompleteCallback(r,i,o)})},e.prototype.addEventCallbackForQuery=function(e,t){var r;r=".info"===hb(e.path)?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),Em(this.eventQueue_,e.path,r)},e.prototype.removeEventCallbackForQuery=function(e,t){var r;r=".info"===hb(e.path)?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),Em(this.eventQueue_,e.path,r)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(Mw)},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(Mw)},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new sw(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var r=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);Fb(t,function(e,t){for(var n=e,i=e.length;i<r+2;i++)n+=" ";console.log(n+t)})}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="";this.persistentConnection_&&(r=this.persistentConnection_.id+":"),Kb.apply(void 0,hg([r],e))},e.prototype.callOnCompleteCallback=function(e,t,r){e&&Qg(function(){if("ok"===t)e(null);else{var n=(t||"error").toUpperCase(),i=n;r&&(i+=": "+r);var o=new Error(i);o.code=n,e(o)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new Jm(this))},enumerable:!1,configurable:!0}),e.prototype.startTransaction=function(e,t,r,n){this.log_("transaction on "+e);var i=function(){},o=new Ad(this,e);o.on("value",i);var a={path:e,update:t,onComplete:r,status:null,order:Fv(),applyLocally:n,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=this.getLatestState_(e);a.currentInputSnapshot=s;var $=a.update(s.val());if(void 0===$){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var l=new Kd(a.currentInputSnapshot,new Ad(this,a.path),tb);a.onComplete(null,!1,l)}}else{Bj("transaction failed: Data returned ",$,a.path),a.status=Gb.RUN;var u=this.transactionQueueTree_.subTree(e),h=u.getValue()||[];h.push(a),u.setValue(h);var p=void 0;if("object"==typeof $&&null!==$&&Ub($,".priority"))p=ed($,".priority"),cb(Aj(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else p=(this.serverSyncTree_.calcCompleteEventCache(e)||gb.EMPTY_NODE).getPriority().val();var c=this.generateServerValues(),d=Bb($,p),v=rm(d,s,c);a.currentOutputSnapshotRaw=d,a.currentOutputSnapshotResolved=v,a.currentWriteId=this.getNextWriteId_();var E=this.serverSyncTree_.applyUserOverwrite(e,v,a.currentWriteId,a.applyLocally);ad(this.eventQueue_,e,E),this.sendReadyTransactions_()}},e.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||gb.EMPTY_NODE},e.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var r=this.buildTransactionQueue_(e);cb(r.length>0,"Sending zero length transaction queue"),r.every(function(e){return e.status===Gb.RUN})&&this.sendTransactionQueue_(e.path(),r)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})},e.prototype.sendTransactionQueue_=function(e,t){for(var r=this,n=t.map(function(e){return e.currentWriteId}),i=this.getLatestState_(e,n),o=i,a=i.hash(),s=0;s<t.length;s++){var $=t[s];cb($.status===Gb.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),$.status=Gb.SENT,$.retryCount++;var l=Ob(e,$.path);o=o.updateChild(l,$.currentOutputSnapshotRaw)}var u=o.val(!0),h=e;this.server_.put(h.toString(),u,function(n){r.log_("transaction put response",{path:h.toString(),status:n});var i=[];if("ok"===n){for(var o=[],a=0;a<t.length;a++){if(t[a].status=Gb.COMPLETED,i=i.concat(r.serverSyncTree_.ackUserWrite(t[a].currentWriteId)),t[a].onComplete){var s=t[a].currentOutputSnapshotResolved,$=new Ad(r,t[a].path),l=new Kd(s,$,tb);o.push(t[a].onComplete.bind(null,null,!0,l))}t[a].unwatcher()}r.pruneCompletedTransactionsBelowNode_(r.transactionQueueTree_.subTree(e)),r.sendReadyTransactions_(),ad(r.eventQueue_,e,i);for(a=0;a<o.length;a++)Qg(o[a])}else{if("datastale"===n)for(a=0;a<t.length;a++)t[a].status===Gb.SENT_NEEDS_ABORT?t[a].status=Gb.NEEDS_ABORT:t[a].status=Gb.RUN;else{Nb("transaction at "+h.toString()+" failed: "+n);for(a=0;a<t.length;a++)t[a].status=Gb.NEEDS_ABORT,t[a].abortReason=n}r.rerunTransactions_(e)}},a)},e.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),r=t.path(),n=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(n,r),r},e.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var r,n=[],i=[],o=e.filter(function(e){return e.status===Gb.RUN}).map(function(e){return e.currentWriteId}),a=0;a<e.length;a++){var s=e[a],$=Ob(t,s.path),l=!1,u=void 0;if(cb(null!==$,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===Gb.NEEDS_ABORT)l=!0,u=s.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===Gb.RUN)if(s.retryCount>=fH)l=!0,u="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var h=this.getLatestState_(s.path,o);s.currentInputSnapshot=h;var p=e[a].update(h.val());if(void 0!==p){Bj("transaction failed: Data returned ",p,s.path);var c=Bb(p);"object"==typeof p&&null!=p&&Ub(p,".priority")||(c=c.updatePriority(h.getPriority()));var d=s.currentWriteId,v=this.generateServerValues(),E=rm(c,h,v);s.currentOutputSnapshotRaw=c,s.currentOutputSnapshotResolved=E,s.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(d),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(s.path,E,s.currentWriteId,s.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(d,!0))}else l=!0,u="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(ad(this.eventQueue_,t,i),i=[],l&&(e[a].status=Gb.COMPLETED,r=e[a].unwatcher,setTimeout(r,Math.floor(0)),e[a].onComplete))if("nodata"===u){var f=new Ad(this,e[a].path),_=e[a].currentInputSnapshot,M=new Kd(_,f,tb);n.push(e[a].onComplete.bind(null,null,!1,M))}else n.push(e[a].onComplete.bind(null,new Error(u),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(a=0;a<n.length;a++)Qg(n[a]);this.sendReadyTransactions_()}},e.prototype.getAncestorTransactionNode_=function(e){var t,r=this.transactionQueueTree_;for(t=hb(e);null!==t&&null===r.getValue();)r=r.subTree(t),t=hb(e=sb(e));return r},e.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},e.prototype.aggregateTransactionQueuesForNode_=function(e,t){var r=this,n=e.getValue();if(null!==n)for(var i=0;i<n.length;i++)t.push(n[i]);e.forEachChild(function(e){r.aggregateTransactionQueuesForNode_(e,t)})},e.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,r=e.getValue();if(r){for(var n=0,i=0;i<r.length;i++)r[i].status!==Gb.COMPLETED&&(r[n]=r[i],n++);r.length=n,e.setValue(r.length>0?r:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},e.prototype.abortTransactions_=function(e){var t=this,r=this.getAncestorTransactionNode_(e).path(),n=this.transactionQueueTree_.subTree(e);return n.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(n),n.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),r},e.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var r=[],n=[],i=-1,o=0;o<t.length;o++)if(t[o].status===Gb.SENT_NEEDS_ABORT);else if(t[o].status===Gb.SENT)cb(i===o-1,"All SENT items should be at beginning of queue."),i=o,t[o].status=Gb.SENT_NEEDS_ABORT,t[o].abortReason="set";else if(cb(t[o].status===Gb.RUN,"Unexpected transaction status in abort"),t[o].unwatcher(),n=n.concat(this.serverSyncTree_.ackUserWrite(t[o].currentWriteId,!0)),t[o].onComplete){r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))}-1===i?e.setValue(null):t.length=i+1,ad(this.eventQueue_,e.path(),n);for(o=0;o<r.length;o++)Qg(r[o])}},e}(),Ad=function(e){function t(t,r){if(!(t instanceof Im))throw new Error("new Reference() no longer supported - use app.database().");return e.call(this,t,r,new ZF,!1)||this}return dd(t,e),t.prototype.getKey=function(){return eb("Reference.key",0,0,arguments.length),ib(this.path)?null:bm(this.path)},t.prototype.child=function(e){return eb("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof pb||(null===hb(this.path)?DF("Reference.child",1,e,!1):Dj("Reference.child",1,e,!1)),new t(this.repo,yb(this.path,e))},t.prototype.getParent=function(){eb("Reference.parent",0,0,arguments.length);var e=Lv(this.path);return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){eb("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){eb("Reference.set",1,2,arguments.length),_b("Reference.set",this.path),od("Reference.set",1,e,this.path,!1),Ib("Reference.set",2,t,!0);var r=new Tb;return this.repo.setWithPriority(this.path,e,null,r.wrapCallback(t)),r.promise},t.prototype.update=function(e,t){if(eb("Reference.update",1,2,arguments.length),_b("Reference.update",this.path),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,Nb("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Tv("Reference.update",1,e,this.path,!1),Ib("Reference.update",2,t,!0);var i=new Tb;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,r){if(eb("Reference.setWithPriority",2,3,arguments.length),_b("Reference.setWithPriority",this.path),od("Reference.setWithPriority",1,e,this.path,!1),hm("Reference.setWithPriority",2,t,!1),Ib("Reference.setWithPriority",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var n=new Tb;return this.repo.setWithPriority(this.path,e,t,n.wrapCallback(r)),n.promise},t.prototype.remove=function(e){return eb("Reference.remove",0,1,arguments.length),_b("Reference.remove",this.path),Ib("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,r){if(eb("Reference.transaction",1,3,arguments.length),_b("Reference.transaction",this.path),Ib("Reference.transaction",1,e,!1),Ib("Reference.transaction",2,t,!0),EF("Reference.transaction",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===r&&(r=!0);var n=new Tb;"function"==typeof t&&n.promise.catch(function(){});return this.repo.startTransaction(this.path,e,function(e,r,i){e?n.reject(e):n.resolve(new GF(r,i)),"function"==typeof t&&t(e,r,i)},r),n.promise},t.prototype.setPriority=function(e,t){eb("Reference.setPriority",1,2,arguments.length),_b("Reference.setPriority",this.path),hm("Reference.setPriority",1,e,!1),Ib("Reference.setPriority",2,t,!0);var r=new Tb;return this.repo.setWithPriority(yb(this.path,".priority"),e,null,r.wrapCallback(t)),r.promise},t.prototype.push=function(e,t){eb("Reference.push",0,2,arguments.length),_b("Reference.push",this.path),od("Reference.push",1,e,this.path,!0),Ib("Reference.push",2,t,!0);var r,n=this.repo.serverTime(),i=HF(n),o=this.child(i),a=this.child(i);return r=null!=e?o.set(e,t).then(function(){return a}):Promise.resolve(a),o.then=r.then.bind(r),o.catch=r.then.bind(r,void 0),"function"==typeof t&&r.catch(function(){}),o},t.prototype.onDisconnect=function(){return _b("Reference.onDisconnect",this.path),new FF(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),t}(qm);qm.__referenceConstructor=Ad,Am.__referenceConstructor=Ad;var Nw,gH=function(){function e(e,t){var r=this;this.app_=e,this.authProvider_=t,this.auth_=null,this.auth_=t.getImmediate({optional:!0}),this.auth_||t.get().then(function(e){return r.auth_=e})}return e.prototype.getToken=function(e){return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(Kb("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):Promise.resolve(null)},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):(setTimeout(function(){return e(null)},0),this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)}))},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})},e.prototype.notifyForInvalidToken=function(){var e="Provided authentication credentials for the app named \""+this.app_.name+"\" are invalid. This usually indicates your app was not initialized correctly. ";"credential"in this.app_.options?e+="Make sure the \"credential\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.":"serviceAccount"in this.app_.options?e+="Make sure the \"serviceAccount\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.":e+="Make sure the \"apiKey\" and \"databaseURL\" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.",Nb(e)},e}(),Ow=function(){function e(){}return e.prototype.getToken=function(t){return Promise.resolve({accessToken:e.EMULATOR_AUTH_TOKEN})},e.prototype.addTokenChangeListener=function(t){t(e.EMULATOR_AUTH_TOKEN)},e.prototype.removeTokenChangeListener=function(e){},e.prototype.notifyForInvalidToken=function(){},e.EMULATOR_AUTH_TOKEN="owner",e}(),hH="FIREBASE_DATABASE_EMULATOR_HOST",Kj=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return Nw||(Nw=new e),Nw},e.prototype.interrupt=function(){var e,t,r,n;try{for(var i=Sb(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(r=void 0,Sb(Object.keys(this.repos_[a]))),$=s.next();!$.done;$=s.next()){var l=$.value;this.repos_[a][l].interrupt()}}catch(u){r={error:u}}finally{try{$&&!$.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}catch(h){e={error:h}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.resume=function(){var e,t,r,n;try{for(var i=Sb(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(r=void 0,Sb(Object.keys(this.repos_[a]))),$=s.next();!$.done;$=s.next()){var l=$.value;this.repos_[a][l].resume()}}catch(u){r={error:u}}finally{try{$&&!$.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}catch(h){e={error:h}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.applyEmulatorSettings=function(e,t,r){e.repoInfo_=new dm(t+":"+r,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),e.repoInfo_.nodeAdmin&&(e.authTokenProvider_=new Ow)},e.prototype.databaseFromApp=function(e,t,r,n){var i=r||e.options.databaseURL;void 0===i&&(e.options.projectId||md("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Kb("Using default host for project ",e.options.projectId),i=e.options.projectId+"-default-rtdb.firebaseio.com");var o,a=fm(i,n),s=a.repoInfo,$=void 0;void 0!==tk&&($=tk.env[hH]),$?(o=!0,i="http://"+$+"?ns="+s.namespace,s=(a=fm(i,n)).repoInfo):o=!a.repoInfo.secure;var l=n&&o?new Ow:new gH(e,t);return Uv("Invalid Firebase Database URL",1,a),ib(a.path)||md("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(s,e,l).database},e.prototype.deleteRepo=function(e){var t=ed(this.repos_,e.app.name);t&&ed(t,e.key)===e||md("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.key]},e.prototype.createRepo=function(e,t,r){var n=ed(this.repos_,t.name);n||(n={},this.repos_[t.name]=n);var i=ed(n,e.toURLString());return i&&md("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Im(e,this.useRestClient_,t,r),n[e.toURLString()]=i,i},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}(),Jm=function(){function e(e){var t=this;this.repoInternal_=e,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return nv(t,void 0,void 0,function(){return ov(this,function(e){return this.checkDeleted_("delete"),Kj.getInstance().deleteRepo(this.repo_),this.repoInternal_=null,this.rootInternal_=null,[2]})})}},e instanceof Im||md("Don't call new Database() directly - please use firebase.database().")}return Object.defineProperty(e.prototype,"repo_",{get:function(){return this.instanceStarted_||(this.repoInternal_.start(),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new Ad(this.repo_,ob())),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),e.prototype.useEmulator=function(e,t){this.checkDeleted_("useEmulator"),this.instanceStarted_?md("Cannot call useEmulator() after instance has already been initialized."):Kj.getInstance().applyEmulatorSettings(this.repoInternal_,e,t)},e.prototype.ref=function(e){return this.checkDeleted_("ref"),eb("database.ref",0,1,arguments.length),e instanceof Ad?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),eb(t,1,1,arguments.length);var r=fm(e,this.repo_.repoInfo_.nodeAdmin);Uv(t,1,r);var n=r.repoInfo;return this.repo_.repoInfo_.isCustomHost()||n.host===this.repo_.repoInfo_.host||md(t+": Host name does not match the current database: (found "+n.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(r.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repoInternal_&&md("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){eb("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){eb("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(e){return{".sv":{increment:e}}}},e}(),iH=function(){lg.forceDisallow(),Fm.forceAllow()},jH=function(){Fm.forceDisallow()},kH=function(){return lg.isAvailable()},lH=function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},mH=function(e,t){e.repo.stats(t)},nH=function(e,t){e.repo.statsIncrementCounter(t)},oH=function(e){return e.repo.dataUpdateCount},pH=function(e,t){return e.repo.interceptServerData_(t)};function qH(e){var t=e.app,r=e.url,n=e.version,i=e.customAuthImpl,o=e.namespace,a=e.nodeAdmin,s=void 0!==a&&a;Bw(n);var $=new wv("auth-internal",new xv("database-standalone"));return $.setComponent(new tj("auth-internal",function(){return i},"PRIVATE")),{instance:Kj.getInstance().databaseFromApp(t,$,r,s),namespace:o}}var rH=Object.freeze({__proto__:null,forceLongPolling:iH,forceWebSockets:jH,isWebSocketsAvailable:kH,setSecurityDebugCallback:lH,stats:mH,statsIncrementCounter:nH,dataUpdateCount:oH,interceptServerData:pH,initStandalone:qH}),sH=mg;mg.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},mg.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var tH=Iw,uH=function(e){var t=mg.prototype.put;return mg.prototype.put=function(r,n,i,o){void 0!==o&&(o=e()),t.call(this,r,n,i,o)},function(){mg.prototype.put=t}},vH=dm,wH=function(e){return e.queryIdentifier()},xH=function(e){Kj.getInstance().forceRestClient(e)},yH=Object.freeze({__proto__:null,DataConnection:sH,RealTimeConnection:tH,hijackHash:uH,ConnectionTarget:vH,queryIdentifier:wH,forceRestClient:xH}),zH="@firebase/database",AH="0.9.4",BH=Jm.ServerValue;function CH(e){Bw(e.SDK_VERSION);var t=e.INTERNAL.registerComponent(new tj("database",function(e,t){var r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal");return Kj.getInstance().databaseFromApp(r,n,t)},"PUBLIC").setServiceProps({Reference:Ad,Query:qm,Database:Jm,DataSnapshot:Kd,enableLogging:Hv,INTERNAL:rH,ServerValue:BH,TEST_ACCESS:yH}).setMultipleInstances(!0));e.registerVersion(zH,AH),ld()&&t}CH(fb);fb.initializeApp({apiKey:"AIzaSyDMhnS2dJk0yTMERT0j4g6jEQ80_nikPHw",authDomain:"flickering-torch-6356.firebaseapp.com",databaseURL:"https://flickering-torch-6356.firebaseio.com",projectId:"flickering-torch-6356",storageBucket:"flickering-torch-6356.appspot.com",messagingSenderId:"60549942221"});var Pw=fb.auth();ok.auth=Pw;var Qw=fb.database();ok.database=Qw;function DH(r,t){return HH(r)||GH(r,t)||FH(r,t)||EH()}function EH(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function FH(r,t){if(r){if("string"==typeof r)return Rw(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Rw(r,t):void 0}}function Rw(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,a=new Array(t);e<t;e++)a[e]=r[e];return a}function GH(r,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var e=[],a=!0,n=!1,o=void 0;try{for(var $,i=r[Symbol.iterator]();!(a=($=i.next()).done)&&(e.push($.value),!t||e.length!==t);a=!0);}catch(l){n=!0,o=l}finally{try{a||null==i.return||i.return()}finally{if(n)throw o}}return e}}function HH(r){if(Array.isArray(r))return r}function Sw(r){var t=DH(r,4),e=t[0],a=t[1],n=t[2],o=t[3],$=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=e+e,l=a+a,u=n+n,y=e*i,v=e*l,c=e*u,f=a*l,s=a*u,L=n*u,O=o*i,b=o*l,d=o*u;return $[0]=1-(f+L),$[1]=v+d,$[2]=c-b,$[4]=v-d,$[5]=1-(y+L),$[6]=s+O,$[8]=c+b,$[9]=s-O,$[10]=1-(y+f),$}function IH(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Tw(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function JH(t,i,e){return i&&Tw(t.prototype,i),e&&Tw(t,e),t}function Wg($){return Math.abs(parseInt("".concat($),10))}function Lb($,n){return $.x*n.x+$.y*n.y}function Xg($,n){return $.x*n.y-$.y*n.x}function ng($){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new ab(n*$.y,-n*$.x)}function Hk(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return new ab(-$*n.y,$*n.x)}function og($,n){return new ab($.col1.x*n.x+$.col2.x*n.y,$.col1.y*n.x+$.col2.y*n.y)}function Pd($,n){return new ab(Lb(n,$.col1),Lb(n,$.col2))}function zb($,n){var o=og($.R,n);return o.x+=$.position.x,o.y+=$.position.y,o}function KH($,n){var o=ub(n,$.position),t=o.x*$.R.col1.x+o.y*$.R.col1.y;return o.y=o.x*$.R.col2.x+o.y*$.R.col2.y,o.x=t,o}function Ik($,n){return new ab($.x+n.x,$.y+n.y)}function ub($,n){return new ab($.x-n.x,$.y-n.y)}function Uw(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return new ab($*n.x,$*n.y)}function Km(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return $>0?$:-$}function LH($){return new ab(Km($.x),Km($.y))}function MH(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $<n?$:n}function Lj(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $>n?$:n}function Bd(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $<n?n:$>o?o:$}function NH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vw(e,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function OH(e,t,o){return t&&Vw(e.prototype,t),o&&Vw(e,o),e}var Qd=function(){function e(){NH(this,e),this.col1=new ab,this.col2=new ab,this.SetIdentity()}return OH(e,[{key:"Set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Math.cos(e),o=Math.sin(e);this.col1.x=t,this.col2.x=-o,this.col1.y=o,this.col2.y=t}},{key:"SetVV",value:function(e,t){this.col1.SetV(e),this.col2.SetV(t)}},{key:"Copy",value:function(){var t=new e;return t.SetM(this),t}},{key:"SetM",value:function(e){this.col1.SetV(e.col1),this.col2.SetV(e.col2)}},{key:"AddM",value:function(e){this.col1.x+=e.col1.x,this.col1.y+=e.col1.y,this.col2.x+=e.col2.x,this.col2.y+=e.col2.y}},{key:"SetIdentity",value:function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1}},{key:"SetZero",value:function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0}},{key:"GetAngle",value:function(){return Math.atan2(this.col1.y,this.col1.x)}},{key:"GetInverse",value:function(e){var t=this.col1.x,o=this.col2.x,l=this.col1.y,c=this.col2.y,i=t*c-o*l;return 0!==i&&(i=1/i),e.col1.x=i*c,e.col2.x=-i*o,e.col1.y=-i*l,e.col2.y=i*t,e}},{key:"Solve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=this.col1.x,c=this.col2.x,i=this.col1.y,n=this.col2.y,r=l*n-c*i;return 0!==r&&(r=1/r),e.x=r*(n*t-c*o),e.y=r*(l*o-i*t),e}},{key:"Abs",value:function(){this.col1.Abs(),this.col2.Abs()}}],[{key:"FromAngle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=new e;return o.Set(t),o}},{key:"FromVV",value:function(t,o){var l=new e;return l.SetVV(t,o),l}}]),e}();var ab=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;IH(this,t),this.x=i,this.y=e}return JH(t,[{key:"SetZero",value:function(){this.x=0,this.y=0}},{key:"Set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=t,this.y=i}},{key:"SetV",value:function(t){this.x=t.x,this.y=t.y}},{key:"GetNegative",value:function(){return new t(-this.x,-this.y)}},{key:"NegativeSelf",value:function(){this.x=-this.x,this.y=-this.y}},{key:"Copy",value:function(){return new t(this.x,this.y)}},{key:"Add",value:function(t){this.x+=t.x,this.y+=t.y}},{key:"Subtract",value:function(t){this.x-=t.x,this.y-=t.y}},{key:"Multiply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.x*=t,this.y*=t}},{key:"MulM",value:function(t){var i=this.x;this.x=t.col1.x*i+t.col2.x*this.y,this.y=t.col1.y*i+t.col2.y*this.y}},{key:"MulTM",value:function(t){var i=Lb(this,t.col1);this.y=Lb(this,t.col2),this.x=i}},{key:"CrossVF",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.x;this.x=t*this.y,this.y=-t*i}},{key:"CrossFV",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.x;this.x=-t*this.y,this.y=t*i}},{key:"MinV",value:function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y}},{key:"MaxV",value:function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y}},{key:"Abs",value:function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)}},{key:"Length",value:function(){return Math.hypot(this.x,this.y)}},{key:"LengthSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"Normalize",value:function(){var t=this.Length();if(t<Number.MIN_VALUE)return 0;var i=1/t;return this.x*=i,this.y*=i,t}},{key:"IsValid",value:function(){return isFinite(this.x)&&isFinite(this.y)}}],[{key:"Make",value:function(){return new t(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}}]),t}();function PH(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function QH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ww(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function RH(t,e,i){return e&&Ww(t.prototype,e),i&&Ww(t,i),t}var Lm=Math.PI;var hd=2;var Jk=.1;var Xw=2;var Cd=.005;var Mj=8*Cd;var SH=32;var TH=32;var UH=1;var VH=.2;var Yg=2;var Yw=Yg*Yg;var Zg=.5*Lm;var Zw=Zg*Zg;var Mm=.2;var WH=.5;var $w=.01;var _w=2/180*Lm;function XH(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.sqrt($*r)}function YH(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $>r?$:r}function Ab($){if(!$)throw new Error("Assertion failed!")}function ZH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ax(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function $H(t,e,i){return e&&ax(t.prototype,e),i&&ax(t,i),t}var pg=function(){function t(){ZH(this,t),this.localCenter=new ab,this.c0=new ab,this.c=new ab,this.a0=0,this.a=0,this.t0=0}return $H(t,[{key:"Set",value:function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0}},{key:"Copy",value:function(){var e=new t;return e.Set(this),e}},{key:"GetTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var s=t.R;t.position.x-=s.col1.x*this.localCenter.x+s.col2.x*this.localCenter.y,t.position.y-=s.col1.y*this.localCenter.x+s.col2.y*this.localCenter.y}},{key:"Advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}}}]),t}();function _H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bx(e,t){for(var a=0;a<t.length;a++){var c=t[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function aI(e,t,a){return t&&bx(e.prototype,t),a&&bx(e,a),e}var Dd=function(){function e(t,a){_H(this,e),this.position=new ab,this.R=new Qd,t&&this.position.SetV(t),a&&this.R.SetM(a)}return aI(e,[{key:"Initialize",value:function(e,t){this.position.SetV(e),this.R.SetM(t)}},{key:"SetIdentity",value:function(){this.position.SetZero(),this.R.SetIdentity()}},{key:"Set",value:function(e){this.position.SetV(e.position),this.R.SetM(e.R)}},{key:"GetAngle",value:function(){return Math.atan2(this.R.col1.y,this.R.col1.x)}}]),e}();function bI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cx(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function cI(t,e,r){return e&&cx(t.prototype,e),r&&cx(t,r),t}function dI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function eI(t,e,r){return e&&dx(t.prototype,e),r&&dx(t,r),t}var ex=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;dI(this,t),this._r=0,this._g=0,this._b=0,this.Set(e,r,n)}return eI(t,[{key:"r",get:function(){return this._r},set:function(t){this._r=Wg(255*Bd(t,0,1))}},{key:"g",get:function(){return this._g},set:function(t){this._g=Wg(255*Bd(t,0,1))}},{key:"b",get:function(){return this._b},set:function(t){this._b=Wg(255*Bd(t,0,1))}},{key:"color",get:function(){return this._r<<16|this._g<<8|this._b}},{key:"Set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.r=t,this.g=e,this.b=r}}]),t}();function fI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fx(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function gI(t,e,i){return e&&fx(t.prototype,e),i&&fx(t,i),t}var Pb=function(){function t(){var e=this;fI(this,t),this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1,this.m_sprite={graphics:{clear:function(){if(e.m_ctx){var t=e.m_ctx.canvas,i=t.width,a=t.height;e.m_ctx.clearRect(0,0,i,a)}}}},this.m_drawFlags=0}return gI(t,[{key:"_color",value:function(t,e){return"rgba(".concat((16711680&t)>>16,",").concat((65280&t)>>8,",").concat(255&t,",").concat(e,")")}},{key:"SetFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags=t}},{key:"GetFlags",value:function(){return this.m_drawFlags}},{key:"AppendFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags|=t}},{key:"ClearFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags&=~t}},{key:"SetSprite",value:function(t){this.m_ctx=t}},{key:"GetSprite",value:function(){return this.m_ctx}},{key:"SetDrawScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawScale=t}},{key:"GetDrawScale",value:function(){return this.m_drawScale}},{key:"SetLineThickness",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_lineThickness=t,this.m_ctx&&(this.m_ctx.lineWidth=t)}},{key:"GetLineThickness",value:function(){return this.m_lineThickness}},{key:"SetAlpha",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_alpha=t}},{key:"GetAlpha",value:function(){return this.m_alpha}},{key:"SetFillAlpha",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_fillAlpha=t}},{key:"GetFillAlpha",value:function(){return this.m_fillAlpha}},{key:"SetXFormScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_xformScale=t}},{key:"GetXFormScale",value:function(){return this.m_xformScale}},{key:"DrawPolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.moveTo(t[0].x*l,t[0].y*l);for(var o=1;o<e;o++)a.lineTo(t[o].x*l,t[o].y*l);a.lineTo(t[0].x*l,t[0].y*l),a.closePath(),a.stroke()}}},{key:"DrawSolidPolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.fillStyle=this._color(i.color,this.m_fillAlpha),a.moveTo(t[0].x*l,t[0].y*l);for(var o=1;o<e;o++)a.lineTo(t[o].x*l,t[o].y*l);a.lineTo(t[0].x*l,t[0].y*l),a.closePath(),a.fill(),a.stroke()}}},{key:"DrawCircle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale,o=t.x*l,r=t.y*l;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.arc(o,r,e*l,0,2*Math.PI,!0),a.closePath(),a.stroke()}}},{key:"DrawSolidCircle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(this.m_ctx&&e){var l=this.m_ctx,o=this.m_drawScale,r=t.x*o,s=t.y*o;l.moveTo(0,0),l.beginPath(),l.strokeStyle=this._color(a.color,this.m_alpha),l.fillStyle=this._color(a.color,this.m_fillAlpha),l.arc(r,s,e*o,0,2*Math.PI,!0),l.moveTo(r,s),l.lineTo((t.x+i.x*e)*o,(t.y+i.y*e)*o),l.closePath(),l.fill(),l.stroke()}}},{key:"DrawSegment",value:function(t,e,i){if(this.m_ctx){var a=this.m_ctx,l=this.m_drawScale;a.strokeStyle=this._color(i.color,this.m_alpha),a.beginPath(),a.moveTo(t.x*l,t.y*l),a.lineTo(e.x*l,e.y*l),a.closePath(),a.stroke()}}},{key:"DrawTransform",value:function(t){if(this.m_ctx){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}}]),t}();Pb.e_shapeBit=1,Pb.e_jointBit=2,Pb.e_aabbBit=4,Pb.e_pairBit=8,Pb.e_centerOfMassBit=16,Pb.e_controllerBit=32;function hI(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function gx(t,r){for(var e=0;e<r.length;e++){var i=r[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function iI(t,r,e){return r&&gx(t.prototype,r),e&&gx(t,e),t}var Nm=function(){function t(){hI(this,t),this.dt=1/60,this.inv_dt=1/this.dt,this.positionIterations=10,this.velocityIterations=10,this.dtRatio=1,this.warmStarting=!0}return iI(t,[{key:"Set",value:function(t){var r=t.dt,e=t.inv_dt,i=t.positionIterations,a=t.velocityIterations,n=t.warmStarting;this.dt=r,this.inv_dt=e,this.positionIterations=i,this.velocityIterations=a,this.warmStarting=n}}]),t}();function jI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function hx(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function kI(t,e,o){return e&&hx(t.prototype,e),o&&hx(t,o),t}function lI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ix(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function mI(e,r,t){return r&&ix(e.prototype,r),t&&ix(e,t),e}function nI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jx(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function oI(t,e,i){return e&&jx(t.prototype,e),i&&jx(t,i),t}function pI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function kx(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function qI(e,r,t){return r&&kx(e.prototype,r),t&&kx(e,t),e}var lx=function(){function e(){pI(this,e),this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return qI(e,[{key:"Copy",value:function(){var r=new e;return r.categoryBits=this.categoryBits,r.maskBits=this.maskBits,r.groupIndex=this.groupIndex,r}}]),e}();function rI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function mx(e,r){for(var n=0;n<r.length;n++){var u=r[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}function sI(e,r,n){return r&&mx(e.prototype,r),n&&mx(e,n),e}var Rd=function(){function e(){rI(this,e),this.lowerBound=new ab,this.upperBound=new ab}return sI(e,[{key:"IsValid",value:function(){var e=this.upperBound.x-this.lowerBound.x,r=this.upperBound.y-this.lowerBound.y;return e>=0&&r>=0&&this.lowerBound.IsValid()&&this.upperBound.IsValid()}},{key:"GetCenter",value:function(){return new ab((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)}},{key:"GetExtents",value:function(){return new ab((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)}},{key:"Contains",value:function(e){return this.lowerBound.x<=e.lowerBound.x&&this.lowerBound.y<=e.lowerBound.y&&e.upperBound.x<=this.upperBound.x&&e.upperBound.y<=this.upperBound.y}},{key:"RayCast",value:function(e,r){var n=-Number.MAX_VALUE,u=Number.MAX_VALUE,o=r.p1.x,t=r.p1.y,i=r.p2.x-r.p1.x,p=r.p2.y-r.p1.y,a=Math.abs(i),s=Math.abs(p),d=e.normal,l=0,B=0,h=0,$=0,y=0;if(a<Number.MIN_VALUE){if(o<this.lowerBound.x||this.upperBound.x<o)return!1}else if(l=1/i,y=-1,(B=(this.lowerBound.x-o)*l)>(h=(this.upperBound.x-o)*l)&&($=B,B=h,h=$,y=1),B>n&&(d.x=y,d.y=0,n=B),n>(u=Math.min(u,h)))return!1;if(s<Number.MIN_VALUE){if(t<this.lowerBound.y||this.upperBound.y<t)return!1}else if(l=1/p,y=-1,(B=(this.lowerBound.y-t)*l)>(h=(this.upperBound.y-t)*l)&&($=B,B=h,h=$,y=1),B>n&&(d.y=y,d.x=0,n=B),n>(u=Math.min(u,h)))return!1;return e.fraction=n,!0}},{key:"TestOverlap",value:function(e){var r=e.lowerBound.x-this.upperBound.x,n=e.lowerBound.y-this.upperBound.y,u=this.lowerBound.x-e.upperBound.x,o=this.lowerBound.y-e.upperBound.y;return r<0||n<0||u<0||o<0}},{key:"Combine",value:function(e,r){this.lowerBound.x=Math.min(e.lowerBound.x,r.lowerBound.x),this.lowerBound.y=Math.min(e.lowerBound.y,r.lowerBound.y),this.upperBound.x=Math.max(e.upperBound.x,r.upperBound.x),this.upperBound.y=Math.max(e.upperBound.y,r.upperBound.y)}}],[{key:"Combine",value:function(r,n){var u=new e;return u.Combine(r,n),u}}]),e}();function tI(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function nx(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uI(e,n,t){return n&&nx(e.prototype,n),t&&nx(e,t),e}function vI(o,r){if(!(o instanceof r))throw new TypeError("Cannot call a class as a function")}function wI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ox(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function xI(e,t,r){return t&&ox(e.prototype,t),r&&ox(e,r),e}var $g=function(){function e(){wI(this,e),this.m_vertices=[],this.m_count=0,this.m_radius=0}return xI(e,[{key:"Set",value:function(e){switch(e.GetType()){case mb.e_circleShape:var t=e;this.m_vertices=[t.m_p],this.m_count=1,this.m_radius=t.m_radius;break;case mb.e_polygonShape:var r=e;this.m_vertices=r.m_vertices,this.m_count=r.m_vertexCount,this.m_radius=r.m_radius;break;default:Ab(!1);}}},{key:"GetSupport",value:function(e){for(var t=0,r=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y,i=1;i<this.m_count;++i){var s=this.m_vertices[i].x*e.x+this.m_vertices[i].y*e.y;s>r&&(t=i,r=s)}return t}},{key:"GetSupportVertex",value:function(e){for(var t=0,r=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y,i=1;i<this.m_count;++i){var s=this.m_vertices[i].x*e.x+this.m_vertices[i].y*e.y;s>r&&(t=i,r=s)}return this.m_vertices[t]}},{key:"GetVertexCount",value:function(){return this.m_count}},{key:"GetVertex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Ab(0<=e&&e<this.m_count),this.m_vertices[e]}}]),e}();var px=function o(){vI(this,o),this.proxyA=new $g,this.proxyB=new $g,this.transformA=new Dd,this.transformB=new Dd,this.sweepA=new pg,this.sweepB=new pg,this.useRadii=!1};function yI(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var qx=function s(){yI(this,s),this.pointA=new ab,this.pointB=new ab,this.distance=0,this.iterations=0};function zI(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var rx=function a(){zI(this,a),this.indexA=new Array(3).fill(0),this.indexB=new Array(3).fill(0),this.count=0,this.metric=0};function AI(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function sx(t,i){for(var e=0;e<i.length;e++){var r=i[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function BI(t,i,e){return i&&sx(t.prototype,i),e&&sx(t,e),t}function CI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function tx(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function DI(e,t,r){return t&&tx(e.prototype,t),r&&tx(e,r),e}var Om=function(){function e(){CI(this,e),this.wA=new ab,this.wB=new ab,this.w=new ab,this.a=0,this.indexA=0,this.indexB=0}return DI(e,[{key:"Set",value:function(e){this.wA.SetV(e.wA),this.wB.SetV(e.wB),this.w.SetV(e.w),this.a=e.a,this.indexA=e.indexA,this.indexB=e.indexB}}]),e}();var EI=function(){function t(){AI(this,t),this.m_v1=new Om,this.m_v2=new Om,this.m_v3=new Om,this.m_vertices=new Array(3),this.m_count=0,this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3}return BI(t,[{key:"ReadCache",value:function(t,i,e,r,s){var m,$;Ab(0<=t.count&&t.count<=3),this.m_count=t.count;for(var o,v=this.m_vertices,a=0;a<this.m_count;a++)(o=v[a]).indexA=t.indexA[a],o.indexB=t.indexB[a],m=i.GetVertex(o.indexA),$=r.GetVertex(o.indexB),o.wA=zb(e,m),o.wB=zb(s,$),o.w=ub(o.wB,o.wA),o.a=0;if(this.m_count>1){var h=t.metric,n=this.GetMetric();(n<.5*h||2*h<n||n<Number.MIN_VALUE)&&(this.m_count=0)}0===this.m_count&&((o=v[0]).indexA=0,o.indexB=0,m=i.GetVertex(0),$=r.GetVertex(0),o.wA=zb(e,m),o.wB=zb(s,$),o.w=ub(o.wB,o.wA),this.m_count=1)}},{key:"WriteCache",value:function(t){t.metric=this.GetMetric(),t.count=Wg(this.m_count);for(var i=this.m_vertices,e=0;e<this.m_count;e++)t.indexA[e]=Wg(i[e].indexA),t.indexB[e]=Wg(i[e].indexB)}},{key:"GetSearchDirection",value:function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=ub(this.m_v2.w,this.m_v1.w);return Xg(t,this.m_v1.w.GetNegative())>0?Hk(1,t):ng(t,1);default:return Ab(!1),new ab;}}},{key:"GetClosestPoint",value:function(){switch(this.m_count){case 0:return Ab(!1),new ab;case 1:return this.m_v1.w;case 2:return new ab(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return Ab(!1),new ab;}}},{key:"GetWitnessPoints",value:function(t,i){switch(this.m_count){case 0:Ab(!1);break;case 1:t.SetV(this.m_v1.wA),i.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,i.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,i.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:i.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,i.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:Ab(!1);}}},{key:"GetMetric",value:function(){switch(this.m_count){case 0:return Ab(!1),0;case 1:return 0;case 2:return ub(this.m_v1.w,this.m_v2.w).Length();case 3:return Xg(ub(this.m_v2.w,this.m_v1.w),ub(this.m_v3.w,this.m_v1.w));default:return Ab(!1),0;}}},{key:"Solve2",value:function(){var t=this.m_v1.w,i=this.m_v2.w,e=ub(i,t),r=-(t.x*e.x+t.y*e.y);if(r<=0)return this.m_v1.a=1,void(this.m_count=1);var s=i.x*e.x+i.y*e.y;if(s<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var m=1/(s+r);this.m_v1.a=s*m,this.m_v2.a=r*m,this.m_count=2}},{key:"Solve3",value:function(){var t=this.m_v1.w,i=this.m_v2.w,e=this.m_v3.w,r=ub(i,t),s=Lb(t,r),m=Lb(i,r),$=-s,o=ub(e,t),v=Lb(t,o),a=Lb(e,o),h=-v,n=ub(e,i),_=Lb(i,n),c=Lb(e,n),u=-_,A=Xg(r,o),p=A*Xg(i,e),P=A*Xg(e,t),w=A*Xg(t,i);if($<=0&&h<=0)return this.m_v1.a=1,void(this.m_count=1);if(m>0&&$>0&&w<=0){var J=1/(m+$);return this.m_v1.a=m*J,this.m_v2.a=$*J,void(this.m_count=2)}if(a>0&&h>0&&P<=0){var V=1/(a+h);return this.m_v1.a=a*V,this.m_v3.a=h*V,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(m<=0&&u<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(a<=0&&c<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(c>0&&u>0&&p<=0){var l=1/(c+u);return this.m_v2.a=c*l,this.m_v3.a=u*l,this.m_count=2,void this.m_v1.Set(this.m_v3)}var x=1/(p+P+w);this.m_v1.a=p*x,this.m_v2.a=P*x,this.m_v3.a=w*x,this.m_count=3}}]),t}();var FI=new EI;var GI=new Array(3).fill(0);var HI=new Array(3).fill(0);var II=0;var JI=0;var KI=0;function ux(e,t,$){++II;var r=$.proxyA,o=$.proxyB,s=$.transformA,i=$.transformB,a=FI;a.ReadCache(t,r,s,o,i);for(var p,d=a.m_vertices,x=GI,n=HI,N=0,E=(a.GetClosestPoint().LengthSquared(),0);E<20;){N=a.m_count;for(var _=0;_<N;_++)x[_]=d[_].indexA,n[_]=d[_].indexB;switch(a.m_count){case 1:break;case 2:a.Solve2();break;case 3:a.Solve3();break;default:Ab(!1);}if(3===a.m_count)break;(p=a.GetClosestPoint()).LengthSquared();var m=a.GetSearchDirection();if(m.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var l=d[a.m_count];l.indexA=r.GetSupport(Pd(s.R,m.GetNegative())),l.wA=zb(s,r.GetVertex(l.indexA)),l.indexB=o.GetSupport(Pd(i.R,m)),l.wB=zb(i,o.GetVertex(l.indexB)),l.w=ub(l.wB,l.wA),++E,++JI;for(var c=!1,b=0;b<N;b++)if(l.indexA===x[b]&&l.indexB===n[b]){c=!0;break}if(c)break;++a.m_count}if(KI=Lj(KI,E),a.GetWitnessPoints(e.pointA,e.pointB),e.distance=ub(e.pointA,e.pointB).Length(),e.iterations=E,a.WriteCache(t),$.useRadii){var u=r.m_radius,v=o.m_radius;if(e.distance>u+v&&e.distance>Number.MIN_VALUE){e.distance-=u+v;var A=ub(e.pointB,e.pointA);A.Normalize(),e.pointA.x+=u*A.x,e.pointA.y+=u*A.y,e.pointB.x-=v*A.x,e.pointB.y-=v*A.y}else(p=new ab).x=.5*(e.pointA.x+e.pointB.x),p.y=.5*(e.pointA.y+e.pointB.y),e.pointA.x=e.pointB.x=p.x,e.pointA.y=e.pointB.y=p.y,e.distance=0}}var mb=function(){function e(){tI(this,e),this.m_type=e.e_unknownShape,this.m_radius=Cd}return uI(e,[{key:"Set",value:function(e){this.m_radius=e.m_radius}},{key:"GetType",value:function(){return this.m_type}},{key:"TestPoint",value:function(e,n){return!1}},{key:"RayCast",value:function(e,n,t){return!1}},{key:"ComputeAABB",value:function(e,n){}},{key:"ComputeMass",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}],[{key:"TestOverlap",value:function(e,n,t,r){var u=new px;u.proxyA=new $g,u.proxyA.Set(e),u.proxyB=new $g,u.proxyB.Set(t),u.transformA=n,u.transformB=r,u.useRadii=!0;var a=new rx;a.count=0;var $=new qx;return ux($,a,u),$.distance<10*Number.MIN_VALUE}}]),e}();mb.e_unknownShape=parseInt("-1",10),mb.e_circleShape=0,mb.e_polygonShape=1,mb.e_edgeShape=2,mb.e_shapeTypeCount=3,mb.e_hitCollide=1,mb.e_missCollide=0,mb.e_startsInsideCollide=parseInt("-1",10);function LI(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var vx=function a(){LI(this,a),this.mass=0,this.center=new ab(0,0),this.I=0};var Nj=function(){function t(){nI(this,t),this.m_filter=new lx,this.m_aabb=new Rd,this.m_density=0,this.m_friction=0,this.m_restitution=0,this.m_isSensor=!1}return oI(t,[{key:"GetType",value:function(){return this.m_shape?this.m_shape.GetType():mb.e_unknownShape}},{key:"GetShape",value:function(){return this.m_shape}},{key:"SetSensor",value:function(t){if(this.m_isSensor!==t&&(this.m_isSensor=t,this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,s=i.GetFixtureA(),r=i.GetFixtureB();s!==this&&r!==this||i.SetSensor(s.IsSensor()||r.IsSensor()),e=e.next}}},{key:"IsSensor",value:function(){return this.m_isSensor}},{key:"SetFilterData",value:function(t){if(this.m_filter=t.Copy(),this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,s=i.GetFixtureA(),r=i.GetFixtureB();s!==this&&r!==this||i.FlagForFiltering(),e=e.next}}},{key:"GetFilterData",value:function(){return this.m_filter.Copy()}},{key:"GetBody",value:function(){return this.m_body}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(t){this.m_userData=t}},{key:"TestPoint",value:function(t){return!(!this.m_shape||!this.m_body)&&this.m_shape.TestPoint(this.m_body.GetTransform(),t)}},{key:"RayCast",value:function(t,e){return!(!this.m_shape||!this.m_body)&&this.m_shape.RayCast(t,e,this.m_body.GetTransform())}},{key:"GetMassData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new vx;return!(!this.m_shape||!this.m_body)&&(this.m_shape.ComputeMass(t,this.m_density),t)}},{key:"SetDensity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_density=t}},{key:"GetDensity",value:function(){return this.m_density}},{key:"GetFriction",value:function(){return this.m_friction}},{key:"SetFriction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_friction=t}},{key:"GetRestitution",value:function(){return this.m_restitution}},{key:"SetRestitution",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_restitution=t}},{key:"GetAABB",value:function(){return this.m_aabb}},{key:"Create",value:function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=void 0,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density}},{key:"Destroy",value:function(){this.m_shape=void 0}},{key:"CreateProxy",value:function(t,e){if(!this.m_shape||!this.m_body)return!1;this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)}},{key:"DestroyProxy",value:function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=void 0)}},{key:"Synchronize",value:function(t,e,i){if(this.m_proxy&&this.m_shape){var s=new Rd,r=new Rd;this.m_shape.ComputeAABB(s,e),this.m_shape.ComputeAABB(r,i),this.m_aabb.Combine(s,r);var n=ub(i.position,e.position);t.MoveProxy(this.m_proxy,this.m_aabb,n)}}}]),t}();var Pm=function(){function e(){lI(this,e)}return mI(e,[{key:"ShouldCollide",value:function(e,r){var t=e.GetFilterData(),a=r.GetFilterData();return t.groupIndex===a.groupIndex&&0!==t.groupIndex?t.groupIndex>0:0!=(t.maskBits&a.categoryBits)&&0!=(t.categoryBits&a.maskBits)}},{key:"RayCollide",value:function(e,r){return!(e instanceof Nj)||this.ShouldCollide(e,r)}}]),e}();Pm.b2_defaultFilter=new Pm;function MI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wx(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function NI(e,t,a){return t&&wx(e.prototype,t),a&&wx(e,a),e}var Qm=function(){function e(){MI(this,e)}return NI(e,[{key:"BeginContact",value:function(e){}},{key:"EndContact",value:function(e){}},{key:"PreSolve",value:function(e,t){}},{key:"PostSolve",value:function(e,t){}}]),e}();Qm.b2_defaultListener=new Qm;function OI(e,r){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=PI(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,u=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){u=!0,n=e},f:function(){try{i||null==t.return||t.return()}finally{if(u)throw n}}}}function PI(e,r){if(e){if("string"==typeof e)return xx(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?xx(e,r):void 0}}function xx(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=new Array(r);t<r;t++)a[t]=e[t];return a}function QI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function yx(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function RI(e,r,t){return r&&yx(e.prototype,r),t&&yx(e,t),e}function SI(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function zx(e,a){for(var r=0;r<a.length;r++){var t=a[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function TI(e,a,r){return a&&zx(e.prototype,a),r&&zx(e,r),e}function UI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Ax(e,r){for(var a=0;a<r.length;a++){var $=r[a];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function VI(e,r,a){return r&&Ax(e.prototype,r),a&&Ax(e,a),e}var WI=function(){function e(){UI(this,e),this.aabb=new Rd}return VI(e,[{key:"IsLeaf",value:function(){return null==this.child1}}]),e}();function XI(t,$){if(!(t instanceof $))throw new TypeError("Cannot call a class as a function")}var Bx=function t(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ab,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ab,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;XI(this,t),this.p1=$,this.p2=a,this.maxFraction=e};var YI=function(){function e(){SI(this,e),this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0}return TI(e,[{key:"CreateProxy",value:function(e,a){var r=this.AllocateNode(),t=Jk,o=Jk;return r.aabb.lowerBound.x=e.lowerBound.x-t,r.aabb.lowerBound.y=e.lowerBound.y-o,r.aabb.upperBound.x=e.upperBound.x+t,r.aabb.upperBound.y=e.upperBound.y+o,r.userData=a,this.InsertLeaf(r),r}},{key:"DestroyProxy",value:function(e){this.RemoveLeaf(e),this.FreeNode(e)}},{key:"MoveProxy",value:function(e,a,r){if(Ab(e.IsLeaf()),e.aabb.Contains(a))return!1;this.RemoveLeaf(e);var t=Jk+Xw*(r.x>0?r.x:-r.x),o=Jk+Xw*(r.y>0?r.y:-r.y);return e.aabb.lowerBound.x=a.lowerBound.x-t,e.aabb.lowerBound.y=a.lowerBound.y-o,e.aabb.upperBound.x=a.upperBound.x+t,e.aabb.upperBound.y=a.upperBound.y+o,this.InsertLeaf(e),!0}},{key:"Rebalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.m_root)for(var a=0;a<e;a++){for(var r=this.m_root,t=0;!r.IsLeaf();)r=this.m_path>>t&1?r.child2:r.child1,t=t+1&31;++this.m_path,this.RemoveLeaf(r),this.InsertLeaf(r)}}},{key:"GetFatAABB",value:function(e){return e.aabb}},{key:"GetUserData",value:function(e){return e.userData}},{key:"Query",value:function(e,a){if(this.m_root){var r=[],t=0;for(r[t++]=this.m_root;t>0;){var o=r[--t];if(o.aabb.TestOverlap(a))if(o.IsLeaf()){if(!e(o))return}else r[t++]=o.child1,r[t++]=o.child2}}}},{key:"RayCast",value:function(e,a){if(this.m_root){var r=a.p1,t=a.p2,o=ub(r,t);o.Normalize();var i=Hk(1,o),n=LH(i),u=a.maxFraction,l=new Rd,b=0,s=0;b=r.x+u*(t.x-r.x),s=r.y+u*(t.y-r.y),l.lowerBound.x=Math.min(r.x,b),l.lowerBound.y=Math.min(r.y,s),l.upperBound.x=Math.max(r.x,b),l.upperBound.y=Math.max(r.y,s);var p=[],h=0;for(p[h++]=this.m_root;h>0;){var $=p[--h];if(!1!==$.aabb.TestOverlap(l)){var v=$.aabb.GetCenter(),d=$.aabb.GetExtents();if(!(Math.abs(i.x*(r.x-v.x)+i.y*(r.y-v.y))-n.x*d.x-n.y*d.y>0))if($.IsLeaf()){var c=new Bx;if(c.p1=a.p1,c.p2=a.p2,c.maxFraction=a.maxFraction,0===(u=e(c,$)))return;u>0&&(b=r.x+u*(t.x-r.x),s=r.y+u*(t.y-r.y),l.lowerBound.x=Math.min(r.x,b),l.lowerBound.y=Math.min(r.y,s),l.upperBound.x=Math.max(r.x,b),l.upperBound.y=Math.max(r.y,s))}else p[h++]=$.child1,p[h++]=$.child2}}}}},{key:"AllocateNode",value:function(){if(this.m_freeList){var e=this.m_freeList;return this.m_freeList=e.parent,e.parent=null,e.child1=null,e.child2=null,e}return new WI}},{key:"FreeNode",value:function(e){e.parent=this.m_freeList,this.m_freeList=e}},{key:"InsertLeaf",value:function(e){if(++this.m_insertionCount,null==this.m_root)return this.m_root=e,void(this.m_root.parent=null);var a=e.aabb.GetCenter(),r=this.m_root;if(!1===r.IsLeaf())do{var t=r.child1,o=r.child2;r=Math.abs((t.aabb.lowerBound.x+t.aabb.upperBound.x)/2-a.x)+Math.abs((t.aabb.lowerBound.y+t.aabb.upperBound.y)/2-a.y)<Math.abs((o.aabb.lowerBound.x+o.aabb.upperBound.x)/2-a.x)+Math.abs((o.aabb.lowerBound.y+o.aabb.upperBound.y)/2-a.y)?t:o}while(!r.IsLeaf());var i=r.parent,n=this.AllocateNode();if(n.parent=i,n.userData=null,n.aabb.Combine(e.aabb,r.aabb),i){r.parent.child1===r?i.child1=n:i.child2=n,n.child1=r,n.child2=e,r.parent=n,e.parent=n;do{if(i.aabb.Contains(n.aabb))break;i.aabb.Combine(i.child1.aabb,i.child2.aabb),n=i,i=i.parent}while(i)}else n.child1=r,n.child2=e,r.parent=n,e.parent=n,this.m_root=n}},{key:"RemoveLeaf",value:function(e){if(e!==this.m_root){var a,r=e.parent,t=r.parent;if(a=r.child1===e?r.child2:r.child1,t)for(t.child1===r?t.child1=a:t.child2=a,a.parent=t,this.FreeNode(r);t;){var o=t.aabb;if(t.aabb=Rd.Combine(t.child1.aabb,t.child2.aabb),o.Contains(t.aabb))break;t=t.parent}else this.m_root=a,a.parent=null,this.FreeNode(r)}else this.m_root=null}}]),e}();function ZI(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function")}var $I=function a(){ZI(this,a)};var _I=function(){function e(){QI(this,e),this.m_tree=new YI,this.m_moveBuffer=[],this.m_pairBuffer=[],this.m_pairCount=0,this.m_proxyCount=0}return RI(e,[{key:"CreateProxy",value:function(e,r){var t=this.m_tree.CreateProxy(e,r);return++this.m_proxyCount,this.BufferMove(t),t}},{key:"DestroyProxy",value:function(e){this.UnBufferMove(e),--this.m_proxyCount,this.m_tree.DestroyProxy(e)}},{key:"MoveProxy",value:function(e,r,t){this.m_tree.MoveProxy(e,r,t)&&this.BufferMove(e)}},{key:"TestOverlap",value:function(e,r){var t=this.m_tree.GetFatAABB(e),a=this.m_tree.GetFatAABB(r);return t.TestOverlap(a)}},{key:"GetUserData",value:function(e){return this.m_tree.GetUserData(e)}},{key:"GetFatAABB",value:function(e){return this.m_tree.GetFatAABB(e)}},{key:"GetProxyCount",value:function(){return this.m_proxyCount}},{key:"UpdatePairs",value:function(e){var r=this;this.m_pairCount=0;var t,a=OI(this.m_moveBuffer);try{var o=function(){var e=t.value,a=r.m_tree.GetFatAABB(e);r.m_tree.Query(function(t){if(t===e)return!0;r.m_pairCount===r.m_pairBuffer.length&&(r.m_pairBuffer[r.m_pairCount]=new $I);var a=r.m_pairBuffer[r.m_pairCount];return a.proxyA=t<e?t:e,a.proxyB=t>=e?t:e,++r.m_pairCount,!0},a)};for(a.s();!(t=a.n()).done;)o()}catch(f){a.e(f)}finally{a.f()}this.m_moveBuffer.length=0;for(var n=0;n<this.m_pairCount;){var i=this.m_pairBuffer[n];for(e(this.m_tree.GetUserData(i.proxyA),this.m_tree.GetUserData(i.proxyB)),++n;n<this.m_pairCount;){var u=this.m_pairBuffer[n];if(u.proxyA!==i.proxyA||u.proxyB!==i.proxyB)break;++n}}}},{key:"Query",value:function(e,r){this.m_tree.Query(e,r)}},{key:"RayCast",value:function(e,r){this.m_tree.RayCast(e,r)}},{key:"Validate",value:function(){}},{key:"Rebalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_tree.Rebalance(e)}},{key:"BufferMove",value:function(e){this.m_moveBuffer[this.m_moveBuffer.length]=e}},{key:"UnBufferMove",value:function(e){var r=parseInt("".concat(this.m_moveBuffer.indexOf(e)),10);this.m_moveBuffer.splice(r,1)}},{key:"ComparePairs",value:function(e,r){return 0}}]),e}();function aJ(c,$){if(!(c instanceof $))throw new TypeError("Cannot call a class as a function")}function bJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cx(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function cJ(e,t,r){return t&&Cx(e.prototype,t),r&&Cx(e,r),e}function dJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function eJ(e,t,i){return t&&Dx(e.prototype,t),i&&Dx(e,i),e}var fJ=function(){function e(){dJ(this,e),this._referenceEdge=0,this._incidentEdge=0,this._incidentVertex=0,this._flip=0}return eJ(e,[{key:"referenceEdge",get:function(){return this._referenceEdge},set:function(e){this._referenceEdge!==e&&(this._referenceEdge=e,this.m_id.key=4294967040&this.m_id.key|255&this._referenceEdge)}},{key:"incidentEdge",get:function(){return this._incidentEdge},set:function(e){this._incidentEdge!==e&&(this._incidentEdge=e,this.m_id.key=4294902015&this.m_id.key|this._incidentEdge<<8&65280)}},{key:"incidentVertex",get:function(){return this._incidentVertex},set:function(e){this._incidentVertex!==e&&(this._incidentVertex=e,this.m_id.key=4278255615&this.m_id.key|this._incidentVertex<<16&16711680)}},{key:"flip",get:function(){return this._flip},set:function(e){this._flip!==e&&(this._flip=e,this.m_id.key=16777215&this.m_id.key|this._flip<<24&4278190080)}}]),e}();var Rm=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fJ;bJ(this,e),this.features=t,this._key=0,this.features.m_id=this}return cJ(e,[{key:"key",get:function(){return this._key},set:function(e){this._key!==e&&(this._key=e,this.features.referenceEdge=255&this._key,this.features.incidentEdge=(65280&this._key)>>8&255,this.features.incidentVertex=(16711680&this._key)>>16&255,this.features.flip=(4278190080&this._key)>>24&255)}},{key:"Set",value:function(e){this.key=e.key}},{key:"Copy",value:function(){var t=new e;return t.key=this.key,t}}]),e}();var gJ=function c(){aJ(this,c),this.position=new ab,this.velocity=new ab,this.normal=new ab,this.id=new Rm};function hJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ex(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function iJ(e,t,r){return t&&Ex(e.prototype,t),r&&Ex(e,r),e}function jJ(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var kJ=function a(){jJ(this,a),this.poolCount=0};function lJ(t){return(lJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Fx(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function nJ(t,e,r){return e&&Fx(t.prototype,e),r&&Fx(t,r),t}function oJ(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pJ(t,e)}function pJ(t,e){return(pJ=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function qJ(t){var e=tJ();return function(){var r,o=Gx(t);if(e){var n=Gx(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return rJ(this,r)}}function rJ(t,e){return!e||"object"!==lJ(e)&&"function"!=typeof e?sJ(t):e}function sJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tJ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Gx(t){return(Gx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hx(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vJ(e,t,i){return t&&Hx(e.prototype,t),i&&Hx(e,i),e}function wJ(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}var Ix=function a(){wJ(this,a)};function xJ(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function Jx(o,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,r.key,r)}}function yJ(o,t,e){return t&&Jx(o.prototype,t),e&&Jx(o,e),o}function zJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kx(t,e){for(var l=0;l<e.length;l++){var a=e[l];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function AJ(t,e,l){return e&&Kx(t.prototype,e),l&&Kx(t,l),t}var Sm=function(){function t(){zJ(this,t),this.m_localPoint=new ab,this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id=new Rm,this.Reset()}return AJ(t,[{key:"Reset",value:function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0}},{key:"Set",value:function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)}}]),t}();var Jb=function(){function o(){xJ(this,o),this.m_pointCount=0,this.m_points=new Array(hd),this.m_localPlaneNormal=new ab,this.m_localPoint=new ab,this.m_type=0;for(var t=0;t<hd;t++)this.m_points[t]=new Sm}return yJ(o,[{key:"Reset",value:function(){for(var o=0;o<hd;o++)(this.m_points[o]instanceof Sm?this.m_points[o]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0}},{key:"Set",value:function(o){this.m_pointCount=o.m_pointCount;for(var t=0;t<hd;t++)(this.m_points[t]instanceof Sm?this.m_points[t]:null).Set(o.m_points[t]);this.m_localPlaneNormal.SetV(o.m_localPlaneNormal),this.m_localPoint.SetV(o.m_localPoint),this.m_type=o.m_type}},{key:"Copy",value:function(){var t=new o;return t.Set(this),t}}]),o}();Jb.e_circles=1,Jb.e_faceA=2,Jb.e_faceB=4;function BJ(e,$){if(!(e instanceof $))throw new TypeError("Cannot call a class as a function")}var CJ=function e(){BJ(this,e),this.proxyA=new $g,this.proxyB=new $g,this.sweepA=new pg,this.sweepB=new pg,this.tolerance=1};function DJ(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Lx(t,i){for(var o=0;o<i.length;o++){var e=i[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function EJ(t,i,o){return i&&Lx(t.prototype,i),o&&Lx(t,o),t}var Kk=function(){function t(){DJ(this,t),this.m_localPoint=new ab,this.m_axis=new ab,this.m_type=t.e_points}return EJ(t,[{key:"Initialize",value:function(i,o,e,x,c){this.m_proxyA=o,this.m_proxyB=x;var r,s,n,$,l,y,a=parseInt("".concat(i.count),10);Ab(0<a&&a<3);var m,p,_=0,h=0,B=0,u=0,I=0,V=0,f=0;if(1===a)this.m_type=t.e_points,r=this.m_proxyA.GetVertex(i.indexA[0]),$=this.m_proxyB.GetVertex(i.indexB[0]),p=r,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),this.m_axis.x=B-_,this.m_axis.y=u-h,this.m_axis.Normalize();else if(i.indexB[0]===i.indexB[1])this.m_type=t.e_faceA,s=this.m_proxyA.GetVertex(i.indexA[0]),n=this.m_proxyA.GetVertex(i.indexA[1]),$=this.m_proxyB.GetVertex(i.indexB[0]),this.m_localPoint.x=.5*(s.x+n.x),this.m_localPoint.y=.5*(s.y+n.y),this.m_axis=ng(ub(n,s),1),this.m_axis.Normalize(),p=this.m_axis,I=(m=e.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,(f=((B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y))-_)*I+((u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y))-h)*V)<0&&this.m_axis.NegativeSelf();else if(i.indexA[0]==i.indexA[0])this.m_type=t.e_faceB,l=this.m_proxyB.GetVertex(i.indexB[0]),y=this.m_proxyB.GetVertex(i.indexB[1]),r=this.m_proxyA.GetVertex(i.indexA[0]),this.m_localPoint.x=.5*(l.x+y.x),this.m_localPoint.y=.5*(l.y+y.y),this.m_axis=ng(ub(y,l),1),this.m_axis.Normalize(),p=this.m_axis,I=(m=c.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=r,m=e.R,(f=((_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y))-B)*I+((h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y))-u)*V)<0&&this.m_axis.NegativeSelf();else{s=this.m_proxyA.GetVertex(i.indexA[0]),n=this.m_proxyA.GetVertex(i.indexA[1]),l=this.m_proxyB.GetVertex(i.indexB[0]),y=this.m_proxyB.GetVertex(i.indexB[1]);var v=og(e.R,ub(n,s)),d=og(c.R,ub(y,l)),A=v.x*v.x+v.y*v.y,M=d.x*d.x+d.y*d.y,R=ub(d,v),G=v.x*R.x+v.y*R.y,P=d.x*R.x+d.y*R.y,S=v.x*d.x+v.y*d.y,b=A*M-S*S;f=0,0!==b&&(f=Bd((S*P-G*M)/b,0,1));var C=(S*f+P)/M;C<0&&(C=0,f=Bd((S-G)/A,0,1)),(r=new ab).x=s.x+f*(n.x-s.x),r.y=s.y+f*(n.y-s.y),($=new ab).x=l.x+f*(y.x-l.x),$.y=l.y+f*(y.y-l.y),0===f||1===f?(this.m_type=t.e_faceB,this.m_axis=ng(ub(y,l),1),this.m_axis.Normalize(),this.m_localPoint=$,p=this.m_axis,I=(m=c.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=r,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),f<0&&this.m_axis.NegativeSelf()):(this.m_type=t.e_faceA,this.m_axis=ng(ub(n,s),1),this.m_localPoint=r,p=this.m_axis,I=(m=e.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),f<0&&this.m_axis.NegativeSelf())}}},{key:"Evaluate",value:function(i,o){if(!this.m_proxyA||!this.m_proxyB)return 0;var e,x,c,r,s,n,$;switch(this.m_type){case t.e_points:return e=Pd(i.R,this.m_axis),x=Pd(o.R,this.m_axis.GetNegative()),c=this.m_proxyA.GetSupportVertex(e),r=this.m_proxyB.GetSupportVertex(x),s=zb(i,c),((n=zb(o,r)).x-s.x)*this.m_axis.x+(n.y-s.y)*this.m_axis.y;case t.e_faceA:return $=og(i.R,this.m_axis),s=zb(i,this.m_localPoint),x=Pd(o.R,$.GetNegative()),r=this.m_proxyB.GetSupportVertex(x),((n=zb(o,r)).x-s.x)*$.x+(n.y-s.y)*$.y;case t.e_faceB:return $=og(o.R,this.m_axis),n=zb(o,this.m_localPoint),e=Pd(i.R,$.GetNegative()),c=this.m_proxyA.GetSupportVertex(e),((s=zb(i,c)).x-n.x)*$.x+(s.y-n.y)*$.y;default:return Ab(!1),0;}}}]),t}();Kk.e_points=1,Kk.e_faceA=2,Kk.e_faceB=4;var FJ=0;var GJ=0;var HJ=0;var IJ=0;var JJ=0;var Tm=new rx;var _g=new px;var Sd=new Dd;var Td=new Dd;var Lk=new Kk;var Mx=new qx;function KJ($){++FJ;var t=$.proxyA,a=$.proxyB,r=$.sweepA,e=$.sweepB;Ab(r.t0===e.t0),Ab(1-r.t0>Number.MIN_VALUE);var o=t.m_radius+a.m_radius,b=$.tolerance,s=0,p=0,x=0;for(Tm.count=0,_g.useRadii=!1;;){if(r.GetTransform(Sd,s),e.GetTransform(Td,s),_g.proxyA=t,_g.proxyB=a,_g.transformA=Sd,_g.transformB=Td,ux(Mx,Tm,_g),Mx.distance<=0){s=1;break}Lk.Initialize(Tm,t,Sd,a,Td);var R=Lk.Evaluate(Sd,Td);if(R<=0){s=1;break}if(0===p&&(x=R>o?Lj(o-b,.75*o):Lj(R-b,.02*o)),R-x<.5*b){if(0===p){s=1;break}break}var k=s,i=s,_=1,n=R;r.GetTransform(Sd,_),e.GetTransform(Td,_);var c=Lk.Evaluate(Sd,Td);if(c>=x){s=1;break}for(var f=0;;){var u=0;u=1&f?i+(x-n)*(_-i)/(c-n):.5*(i+_),r.GetTransform(Sd,u),e.GetTransform(Td,u);var m=Lk.Evaluate(Sd,Td);if(Km(m-x)<.025*b){k=u;break}if(m>x?(i=u,n=m):(_=u,c=m),++f,++IJ,50===f)break}if(JJ=Lj(JJ,f),k<(1+100*Number.MIN_VALUE)*s)break;if(s=k,p++,++GJ,1e3===p)break}return HJ=Lj(HJ,p),s}var vb=function(){function e(){uJ(this,e),this.m_nodeA=new Ix,this.m_nodeB=new Ix,this.m_manifold=new Jb,this.m_oldManifold=new Jb,this.m_flags=0,this.m_toi=1}return vJ(e,[{key:"GetManifold",value:function(){return this.m_manifold}},{key:"GetWorldManifold",value:function(e){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();t&&i&&n&&a&&e.Initialize(this.m_manifold,t.GetTransform(),n.m_radius,i.GetTransform(),a.m_radius)}}},{key:"IsTouching",value:function(){return(this.m_flags&e.e_touchingFlag)===e.e_touchingFlag}},{key:"IsContinuous",value:function(){return(this.m_flags&e.e_continuousFlag)===e.e_continuousFlag}},{key:"SetSensor",value:function(t){t?this.m_flags|=e.e_sensorFlag:this.m_flags&=~e.e_sensorFlag}},{key:"IsSensor",value:function(){return(this.m_flags&e.e_sensorFlag)===e.e_sensorFlag}},{key:"SetEnabled",value:function(t){t?this.m_flags|=e.e_enabledFlag:this.m_flags&=~e.e_enabledFlag}},{key:"IsEnabled",value:function(){return(this.m_flags&e.e_enabledFlag)===e.e_enabledFlag}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetFixtureA",value:function(){return this.m_fixtureA}},{key:"GetFixtureB",value:function(){return this.m_fixtureB}},{key:"FlagForFiltering",value:function(){this.m_flags|=e.e_filterFlag}},{key:"Reset",value:function(t,i){if(this.m_flags=e.e_enabledFlag,!t||!i)return this.m_fixtureA=void 0,void(this.m_fixtureB=void 0);(t.IsSensor()||i.IsSensor())&&(this.m_flags|=e.e_sensorFlag);var n=t.GetBody(),a=i.GetBody();n&&a&&((n.GetType()!==db.b2_dynamicBody||n.IsBullet()||a.GetType()!==db.b2_dynamicBody||a.IsBullet())&&(this.m_flags|=e.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=i,this.m_manifold.m_pointCount=0,this.m_prev=void 0,this.m_next=void 0,this.m_nodeA.contact=void 0,this.m_nodeA.prev=void 0,this.m_nodeA.next=void 0,this.m_nodeA.other=void 0,this.m_nodeB.contact=void 0,this.m_nodeB.prev=void 0,this.m_nodeB.next=void 0,this.m_nodeB.other=void 0)}},{key:"Update",value:function(t){var i=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=i,this.m_flags|=e.e_enabledFlag;var n=!1,a=(this.m_flags&e.e_touchingFlag)===e.e_touchingFlag;if(this.m_fixtureA&&this.m_fixtureB){var o=this.m_fixtureA.m_body,s=this.m_fixtureB.m_body;if(o&&s){var r=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&e.e_sensorFlag){if(r){var l=this.m_fixtureA.GetShape(),u=this.m_fixtureB.GetShape();if(!l||!u)return;var _=o.GetTransform(),m=s.GetTransform();n=mb.TestOverlap(l,_,u,m)}this.m_manifold.m_pointCount=0}else{if(o.GetType()!==db.b2_dynamicBody||o.IsBullet()||s.GetType()!==db.b2_dynamicBody||s.IsBullet()?this.m_flags|=e.e_continuousFlag:this.m_flags&=~e.e_continuousFlag,r){this.Evaluate(),n=this.m_manifold.m_pointCount>0;for(var h=0;h<this.m_manifold.m_pointCount;++h){var f=this.m_manifold.m_points[h];f.m_normalImpulse=0,f.m_tangentImpulse=0;for(var d=f.m_id,$=0;$<this.m_oldManifold.m_pointCount;++$){var p=this.m_oldManifold.m_points[$];if(p.m_id.key===d.key){f.m_normalImpulse=p.m_normalImpulse,f.m_tangentImpulse=p.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;n!==a&&(o.SetAwake(!0),s.SetAwake(!0))}n?this.m_flags|=e.e_touchingFlag:this.m_flags&=~e.e_touchingFlag,!1===a&&!0===n&&t.BeginContact(this),!0===a&&!1===n&&t.EndContact(this),0==(this.m_flags&e.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)}}}},{key:"Evaluate",value:function(){}},{key:"ComputeTOI",value:function(t,i){if(!this.m_fixtureA||!this.m_fixtureB)return 0;var n=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();return n&&a?(e.s_input.proxyA.Set(n),e.s_input.proxyB.Set(a),e.s_input.sweepA=t,e.s_input.sweepB=i,e.s_input.tolerance=Cd,KJ(e.s_input)):0}}]),e}();vb.e_sensorFlag=1,vb.e_continuousFlag=2,vb.e_islandFlag=4,vb.e_toiFlag=8,vb.e_touchingFlag=16,vb.e_enabledFlag=32,vb.e_filterFlag=64,vb.s_input=new CJ;function LJ(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Nx(e,r){for(var t=0;t<r.length;t++){var $=r[t];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function MJ(e,r,t){return r&&Nx(e.prototype,r),t&&Nx(e,t),e}var Ox=function(){function e(){LJ(this,e),this.v=new ab,this.id=new Rm}return MJ(e,[{key:"Set",value:function(e){this.v.SetV(e.v),this.id.Set(e.id)}}]),e}();var NJ=Wm();var OJ=Wm();var PJ=Wm();var Um=new Array(1).fill(0);var Vm=new Array(1).fill(0);var QJ=new ab;var RJ=new ab;var SJ=new ab;var TJ=new ab;var UJ=new ab;var VJ=new ab;var WJ=new ab;var XJ=new ab;var e=new ab;function Px(o,e,l){var t,$=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=0,n=(t=e[0]).v,i=(t=e[1]).v,x=l.x*n.x+l.y*n.y-$,a=l.x*i.x+l.y*i.y-$;if(x<=0&&o[r++].Set(e[0]),a<=0&&o[r++].Set(e[1]),x*a<0){var p,c=x/(x-a),s=(t=o[r]).v;s.x=n.x+c*(i.x-n.x),s.y=n.y+c*(i.y-n.y),t=o[r],x>0?(p=e[0],t.id=p.id):(p=e[1],t.id=p.id),++r}return r}function Mk(o,e){var l,t,$=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=o.m_vertices,x=o.m_normals,a=parseInt("".concat(r.m_vertexCount),10),p=r.m_vertices;l=e.R,t=x[$];for(var c=l.col1.x*t.x+l.col2.x*t.y,s=l.col1.y*t.x+l.col2.y*t.y,_=(l=n.R).col1.x*c+l.col1.y*s,y=l.col2.x*c+l.col2.y*s,m=0,E=Number.MAX_VALUE,d=0;d<a;++d){var v=(t=p[d]).x*_+t.y*y;v<E&&(E=v,m=d)}t=i[$],l=e.R;var g=e.position.x+(l.col1.x*t.x+l.col2.x*t.y),u=e.position.y+(l.col1.y*t.x+l.col2.y*t.y);t=p[m],l=n.R;var f=n.position.x+(l.col1.x*t.x+l.col2.x*t.y),P=n.position.y+(l.col1.y*t.x+l.col2.y*t.y);return(f-=g)*c+(P-=u)*s}function Qx(){var o,e,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,$=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=parseInt("".concat(t.m_vertexCount),10),x=t.m_normals;e=n.R,o=r.m_centroid;var a=n.position.x+(e.col1.x*o.x+e.col2.x*o.y),p=n.position.y+(e.col1.y*o.x+e.col2.y*o.y);e=$.R,o=t.m_centroid,a-=$.position.x+(e.col1.x*o.x+e.col2.x*o.y),p-=$.position.y+(e.col1.y*o.x+e.col2.y*o.y);for(var c=a*$.R.col1.x+p*$.R.col1.y,s=a*$.R.col2.x+p*$.R.col2.y,_=0,y=-Number.MAX_VALUE,m=0;m<i;++m){var E=(o=x[m]).x*c+o.y*s;E>y&&(y=E,_=m)}var d=Mk(t,$,_,r,n),v=parseInt("".concat(_-1>=0?_-1:i-1),10),g=Mk(t,$,v,r,n),u=parseInt("".concat(_+1<i?_+1:0),10),f=Mk(t,$,u,r,n),P=0,C=0,V=0;if(g>d&&g>f)P=-1,C=v,V=g;else{if(!(f>d))return l[0]=_,d;P=1,C=u,V=f}for(;(d=Mk(t,$,_=-1===P?C-1>=0?C-1:i-1:C+1<i?C+1:0,r,n))>V;)C=_,V=d;return l[0]=C,V}function YJ(o,e,l){var t,$,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,x=e.m_normals,a=parseInt("".concat(n.m_vertexCount),10),p=n.m_vertices,c=n.m_normals;t=l.R,$=x[r];var s=t.col1.x*$.x+t.col2.x*$.y,_=t.col1.y*$.x+t.col2.y*$.y,y=(t=i.R).col1.x*s+t.col1.y*_;_=t.col2.x*s+t.col2.y*_,s=y;for(var m,E=0,d=Number.MAX_VALUE,v=0;v<a;++v){var g=s*($=c[v]).x+_*$.y;g<d&&(d=g,E=v)}var u=parseInt("".concat(E),10),f=parseInt("".concat(u+1<a?u+1:0),10);m=o[0],$=p[u],t=i.R,m.v.x=i.position.x+(t.col1.x*$.x+t.col2.x*$.y),m.v.y=i.position.y+(t.col1.y*$.x+t.col2.y*$.y),m.id.features.referenceEdge=r,m.id.features.incidentEdge=u,m.id.features.incidentVertex=0,m=o[1],$=p[f],t=i.R,m.v.x=i.position.x+(t.col1.x*$.x+t.col2.x*$.y),m.v.y=i.position.y+(t.col1.y*$.x+t.col2.y*$.y),m.id.features.referenceEdge=r,m.id.features.incidentEdge=f,m.id.features.incidentVertex=1}function Wm(){return[new Ox,new Ox]}function ZJ(o,e,l,t,$){var r;o.m_pointCount=0;var n=e.m_radius+t.m_radius,i=0;Um[0]=i;var x=Qx(Um,e,l,t,$);if(i=Um[0],!(x>n)){var a=0;Vm[0]=a;var p=Qx(Vm,t,$,e,l);if(a=Vm[0],!(p>n)){var c,s,_,y,m,E=0,d=0;p>.98*x+.001?(c=t,s=e,_=$,y=l,E=a,o.m_type=Jb.e_faceB,d=1):(c=e,s=t,_=l,y=$,E=i,o.m_type=Jb.e_faceA,d=0);var v=NJ;YJ(v,c,_,E,s,y);var g,u=parseInt("".concat(c.m_vertexCount),10),f=c.m_vertices,P=f[E];g=E+1<u?f[parseInt("".concat(E+1),10)]:f[0];var C=QJ;C.Set(g.x-P.x,g.y-P.y),C.Normalize();var V=RJ;V.x=C.y,V.y=-C.x;var S=SJ;S.Set(.5*(P.x+g.x),.5*(P.y+g.y));var N=UJ;m=_.R,N.x=m.col1.x*C.x+m.col2.x*C.y,N.y=m.col1.y*C.x+m.col2.y*C.y;var A=VJ;A.x=-N.x,A.y=-N.y;var M=TJ;M.x=N.y,M.y=-N.x;var R=WJ,I=XJ;R.x=_.position.x+(m.col1.x*P.x+m.col2.x*P.y),R.y=_.position.y+(m.col1.y*P.x+m.col2.y*P.y),I.x=_.position.x+(m.col1.x*g.x+m.col2.x*g.y),I.y=_.position.y+(m.col1.y*g.x+m.col2.y*g.y);var O=M.x*R.x+M.y*R.y,T=-N.x*R.x-N.y*R.y+n,h=N.x*I.x+N.y*I.y+n,w=OJ,b=PJ;if(!(Px(w,v,A,T)<2||Px(b,w,N,h)<2)){o.m_localPlaneNormal.SetV(V),o.m_localPoint.SetV(S);for(var F=0,k=0;k<hd;++k){if(r=b[k],M.x*r.v.x+M.y*r.v.y-O<=n){var L=o.m_points[F];m=y.R;var B=r.v.x-y.position.x,U=r.v.y-y.position.y;L.m_localPoint.x=B*m.col1.x+U*m.col1.y,L.m_localPoint.y=B*m.col2.x+U*m.col2.y,L.m_id.Set(r.id),L.m_id.features.flip=d,++F}}o.m_pointCount=F}}}}function $J(o,e,l,t,$){var r,n;o.m_pointCount=0,r=l.R,n=e.m_p;var i=l.position.x+(r.col1.x*n.x+r.col2.x*n.y),x=l.position.y+(r.col1.y*n.x+r.col2.y*n.y);r=$.R,n=t.m_p;var a=$.position.x+(r.col1.x*n.x+r.col2.x*n.y)-i,p=$.position.y+(r.col1.y*n.x+r.col2.y*n.y)-x,c=a*a+p*p,s=e.m_radius+t.m_radius;c>s*s||(o.m_type=Jb.e_circles,o.m_localPoint.SetV(e.m_p),o.m_localPlaneNormal.SetZero(),o.m_pointCount=1,o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0)}function _J(o,e,l,t,$){o.m_pointCount=0;var r,n,i=0,x=0;n=$.R,r=t.m_p;var a=$.position.x+(n.col1.x*r.x+n.col2.x*r.y),p=$.position.y+(n.col1.y*r.x+n.col2.y*r.y);i=a-l.position.x,x=p-l.position.y;for(var c=i*(n=l.R).col1.x+x*n.col1.y,s=i*n.col2.x+x*n.col2.y,_=0,y=-Number.MAX_VALUE,m=e.m_radius+t.m_radius,E=parseInt("".concat(e.m_vertexCount),10),d=e.m_vertices,v=e.m_normals,g=0;g<E;++g){i=c-(r=d[g]).x,x=s-r.y;var u=(r=v[g]).x*i+r.y*x;if(u>m)return;u>y&&(y=u,_=g)}var f=parseInt("".concat(_),10),P=parseInt("".concat(f+1<E?f+1:0),10),C=d[f],V=d[P];if(y<Number.MIN_VALUE)return o.m_pointCount=1,o.m_type=Jb.e_faceA,o.m_localPlaneNormal.SetV(v[_]),o.m_localPoint.x=.5*(C.x+V.x),o.m_localPoint.y=.5*(C.y+V.y),o.m_points[0].m_localPoint.SetV(t.m_p),void(o.m_points[0].m_id.key=0);var S=(c-C.x)*(V.x-C.x)+(s-C.y)*(V.y-C.y),N=(c-V.x)*(C.x-V.x)+(s-V.y)*(C.y-V.y);if(S<=0){if((c-C.x)*(c-C.x)+(s-C.y)*(s-C.y)>m*m)return;o.m_pointCount=1,o.m_type=Jb.e_faceA,o.m_localPlaneNormal.x=c-C.x,o.m_localPlaneNormal.y=s-C.y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.SetV(C),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}else if(N<=0){if((c-V.x)*(c-V.x)+(s-V.y)*(s-V.y)>m*m)return;o.m_pointCount=1,o.m_type=Jb.e_faceA,o.m_localPlaneNormal.x=c-V.x,o.m_localPlaneNormal.y=s-V.y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.SetV(V),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}else{var A=.5*(C.x+V.x),M=.5*(C.y+V.y);if((y=(c-A)*v[f].x+(s-M)*v[f].y)>m)return;o.m_pointCount=1,o.m_type=Jb.e_faceA,o.m_localPlaneNormal.x=v[f].x,o.m_localPlaneNormal.y=v[f].y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.Set(A,M),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}}function aK(t){return(aK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Rx(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cK(t,e,r){return e&&Rx(t.prototype,e),r&&Rx(t,r),t}function dK(t,e,r){return(dK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=eK(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function eK(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Nk(t)););return t}function fK(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&gK(t,e)}function gK(t,e){return(gK=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function hK(t){var e=kK();return function(){var r,n=Nk(t);if(e){var o=Nk(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return iK(this,r)}}function iK(t,e){return!e||"object"!==aK(e)&&"function"!=typeof e?jK(t):e}function jK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Nk(t){return(Nk=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var aj=function(t){fK(r,mb);var e=hK(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return bK(this,r),(t=e.call(this)).m_radius=n,t.m_p=new ab,t.m_type=mb.e_circleShape,t}return cK(r,[{key:"Copy",value:function(){var t=new r;return t.Set(this),t}},{key:"Set",value:function(t){dK(Nk(r.prototype),"Set",this).call(this,t),t instanceof r&&this.m_p.SetV(t.m_p)}},{key:"TestPoint",value:function(t,e){var r=t.R,n=t.position.x+(r.col1.x*this.m_p.x+r.col2.x*this.m_p.y),o=t.position.y+(r.col1.y*this.m_p.x+r.col2.y*this.m_p.y);return(n=e.x-n)*n+(o=e.y-o)*o<=this.m_radius*this.m_radius}},{key:"RayCast",value:function(t,e,r){var n=r.R,o=r.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),i=r.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),a=e.p1.x-o,s=e.p1.y-i,u=a*a+s*s-this.m_radius*this.m_radius,$=e.p2.x-e.p1.x,c=e.p2.y-e.p1.y,p=a*$+s*c,l=$*$+c*c,f=p*p-l*u;if(f<0||l<Number.MIN_VALUE)return!1;var _=-(p+Math.sqrt(f));return 0<=_&&_<=e.maxFraction*l&&(_/=l,t.fraction=_,t.normal.x=a+_*$,t.normal.y=s+_*c,t.normal.Normalize(),!0)}},{key:"ComputeAABB",value:function(t,e){var r=e.R,n=e.position.x+(r.col1.x*this.m_p.x+r.col2.x*this.m_p.y),o=e.position.y+(r.col1.y*this.m_p.x+r.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,o-this.m_radius),t.upperBound.Set(n+this.m_radius,o+this.m_radius)}},{key:"ComputeMass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.mass=e*Lm*this.m_radius*this.m_radius,t.center.SetV(this.m_p),t.I=t.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))}},{key:"ComputeSubmergedArea",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=zb(r,this.m_p),i=-(Lb(t,o)-e);if(i<-this.m_radius+Number.MIN_VALUE)return 0;if(i>this.m_radius)return n.SetV(o),Math.PI*this.m_radius*this.m_radius;var a=this.m_radius*this.m_radius,s=i*i,u=a*(Math.asin(i/this.m_radius)+Math.PI/2)+i*Math.sqrt(a-s),$=-2/3*Math.pow(a-s,1.5)/u;return n.x=o.x+t.x*$,n.y=o.y+t.y*$,u}},{key:"GetLocalPosition",value:function(){return this.m_p}},{key:"SetLocalPosition",value:function(t){this.m_p.SetV(t)}},{key:"GetRadius",value:function(){return this.m_radius}},{key:"SetRadius",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_radius=t}}]),r}();var Sx=function(t){oJ(r,vb);var e=qJ(r);function r(){return mJ(this,r),e.apply(this,arguments)}return nJ(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&e&&r instanceof aj&&o instanceof aj&&$J(this.m_manifold,r,t.m_xf,o,e.m_xf)}}}],[{key:"Create",value:function(t){return new r}},{key:"Destroy",value:function(t,e){}}]),r}();function lK(t){return(lK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function mK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tx(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function nK(t,e,r){return e&&Tx(t.prototype,e),r&&Tx(t,r),t}function oK(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&pK(t,e)}function pK(t,e){return(pK=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function qK(t){var e=tK();return function(){var r,o=Ux(t);if(e){var n=Ux(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return rK(this,r)}}function rK(t,e){return!e||"object"!==lK(e)&&"function"!=typeof e?sK(t):e}function sK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function tK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Ux(t){return(Ux=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function uK(t){return(uK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vx(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function wK(t,e,r){return e&&Vx(t.prototype,e),r&&Vx(t,r),t}function xK(t,e,r){return(xK="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=yK(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function yK(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Ok(t)););return t}function zK(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&AK(t,e)}function AK(t,e){return(AK=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function BK(t){var e=EK();return function(){var r,o=Ok(t);if(e){var i=Ok(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return CK(this,r)}}function CK(t,e){return!e||"object"!==uK(e)&&"function"!=typeof e?DK(t):e}function DK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function EK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Ok(t){return(Ok=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var qg=function(t){zK(r,mb);var e=BK(r);function r(){var t;return vK(this,r),(t=e.call(this)).m_centroid=new ab,t.m_vertexCount=0,t.m_vertices=[],t.m_normals=[],t.m_type=mb.e_polygonShape,t.m_centroid=new ab,t.m_vertices=[],t.m_normals=[],t}return wK(r,[{key:"Copy",value:function(){var t=new r;return t.Set(this),t}},{key:"Set",value:function(t){if(xK(Ok(r.prototype),"Set",this).call(this,t),t instanceof r){this.m_centroid.SetV(t.m_centroid),this.m_vertexCount=t.m_vertexCount,this.Reserve(this.m_vertexCount);for(var e=0;e<this.m_vertexCount;e++)this.m_vertices[e].SetV(t.m_vertices[e]),this.m_normals[e].SetV(t.m_normals[e])}}},{key:"SetAsArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.SetAsVector(t.slice(),e)}},{key:"SetAsVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===e&&(e=t.length),Ab(2<=e),this.m_vertexCount=e,this.Reserve(e);for(var o=0;o<this.m_vertexCount;o++)this.m_vertices[o].SetV(t[o]);for(var i=0;i<this.m_vertexCount;++i){var n=parseInt("".concat(i),10),s=parseInt("".concat(i+1<this.m_vertexCount?i+1:0),10),a=ub(this.m_vertices[s],this.m_vertices[n]);Ab(a.LengthSquared()>Number.MIN_VALUE),this.m_normals[i].SetV(ng(a,1)),this.m_normals[i].Normalize()}this.m_centroid=r.ComputeCentroid(this.m_vertices,this.m_vertexCount)}},{key:"SetAsBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()}},{key:"SetAsOrientedBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ab,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=r;var i=new Dd;i.position=r,i.R.Set(o);for(var n=0;n<this.m_vertexCount;++n)this.m_vertices[n]=zb(i,this.m_vertices[n]),this.m_normals[n]=og(i.R,this.m_normals[n])}},{key:"SetAsEdge",value:function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=ng(ub(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y}},{key:"TestPoint",value:function(t,e){for(var r,o=t.R,i=e.x-t.position.x,n=e.y-t.position.y,s=i*o.col1.x+n*o.col1.y,a=i*o.col2.x+n*o.col2.y,c=0;c<this.m_vertexCount;++c){if(i=s-(r=this.m_vertices[c]).x,n=a-r.y,(r=this.m_normals[c]).x*i+r.y*n>0)return!1}return!0}},{key:"RayCast",value:function(t,e,r){var o,i,n=0,s=e.maxFraction,a=0,c=0;a=e.p1.x-r.position.x,c=e.p1.y-r.position.y;var u=a*(o=r.R).col1.x+c*o.col1.y,v=a*o.col2.x+c*o.col2.y;a=e.p2.x-r.position.x,c=e.p2.y-r.position.y;for(var m=a*(o=r.R).col1.x+c*o.col1.y-u,$=a*o.col2.x+c*o.col2.y-v,l=parseInt("-1",10),h=0;h<this.m_vertexCount;++h){a=(i=this.m_vertices[h]).x-u,c=i.y-v;var _=(i=this.m_normals[h]).x*a+i.y*c,y=i.x*m+i.y*$;if(0===y){if(_<0)return!1}else y<0&&_<n*y?(n=_/y,l=h):y>0&&_<s*y&&(s=_/y);if(s<n-Number.MIN_VALUE)return!1}return l>=0&&(t.fraction=n,o=r.R,i=this.m_normals[l],t.normal.x=o.col1.x*i.x+o.col2.x*i.y,t.normal.y=o.col1.y*i.x+o.col2.y*i.y,!0)}},{key:"ComputeAABB",value:function(t,e){for(var r=e.R,o=this.m_vertices[0],i=e.position.x+(r.col1.x*o.x+r.col2.x*o.y),n=e.position.y+(r.col1.y*o.x+r.col2.y*o.y),s=i,a=n,c=1;c<this.m_vertexCount;++c){o=this.m_vertices[c];var u=e.position.x+(r.col1.x*o.x+r.col2.x*o.y),v=e.position.y+(r.col1.y*o.x+r.col2.y*o.y);i=i<u?i:u,n=n<v?n:v,s=s>u?s:u,a=a>v?a:v}t.lowerBound.x=i-this.m_radius,t.lowerBound.y=n-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius}},{key:"ComputeMass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(2===this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var r=0,o=0,i=0,n=0,s=0;s<this.m_vertexCount;++s){var a=this.m_vertices[s],c=s+1<this.m_vertexCount?this.m_vertices[parseInt("".concat(s+1),10)]:this.m_vertices[0],u=a.x-0,v=a.y-0,m=c.x-0,$=c.y-0,l=u*$-v*m,h=.5*l;i+=h,r+=h*(1/3)*(0+a.x+c.x),o+=h*(1/3)*(0+a.y+c.y);n+=l*(1/3*(.25*(u*u+m*u+m*m)+(0*u+0*m))+0+(1/3*(.25*(v*v+$*v+$*$)+(0*v+0*$))+0))}t.mass=e*i,r*=1/i,o*=1/i,t.center.Set(r,o),t.I=e*n}},{key:"ComputeSubmergedArea",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=Pd(r.R,t),n=e-Lb(t,r.position),s=[],a=0,c=parseInt("".concat(-1),10),u=parseInt("".concat(-1),10),v=!1,m=0;m<this.m_vertexCount;++m){s[m]=Lb(i,this.m_vertices[m])-n;var $=s[m]<-Number.MIN_VALUE;m>0&&($?v||(c=m-1,a++):v&&(u=m-1,a++)),v=$}switch(a){case 0:if(v){var l=new vx;return this.ComputeMass(l,1),o.SetV(zb(r,l.center)),l.mass}return 0;case 1:-1===c?c=this.m_vertexCount-1:u=this.m_vertexCount-1;}for(var h,_=parseInt("".concat((c+1)%this.m_vertexCount),10),y=parseInt("".concat((u+1)%this.m_vertexCount),10),p=(0-s[c])/(s[_]-s[c]),f=(0-s[u])/(s[y]-s[u]),x=new ab(this.m_vertices[c].x*(1-p)+this.m_vertices[_].x*p,this.m_vertices[c].y*(1-p)+this.m_vertices[_].y*p),M=new ab(this.m_vertices[u].x*(1-f)+this.m_vertices[y].x*f,this.m_vertices[u].y*(1-f)+this.m_vertices[y].y*f),E=0,j=new ab,X=this.m_vertices[_],d=_;d!==y;){h=(d=(d+1)%this.m_vertexCount)===y?M:this.m_vertices[d];var S=.5*((X.x-x.x)*(h.y-x.y)-(X.y-x.y)*(h.x-x.x));E+=S,j.x+=S*(x.x+X.x+h.x)/3,j.y+=S*(x.y+X.y+h.y)/3,X=h}return j.Multiply(1/E),o.SetV(zb(r,j)),E}},{key:"GetVertexCount",value:function(){return this.m_vertexCount}},{key:"GetVertices",value:function(){return this.m_vertices}},{key:"GetNormals",value:function(){return this.m_normals}},{key:"GetSupport",value:function(t){for(var e=0,r=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;o<this.m_vertexCount;++o){var i=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;i>r&&(e=o,r=i)}return e}},{key:"GetSupportVertex",value:function(t){for(var e=0,r=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;o<this.m_vertexCount;++o){var i=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;i>r&&(e=o,r=i)}return this.m_vertices[e]}},{key:"Validate",value:function(){return!1}},{key:"Reserve",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=parseInt("".concat(this.m_vertices.length),10);e<t;e++)this.m_vertices[e]=new ab,this.m_normals[e]=new ab}}],[{key:"ComputeCentroid",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new ab,o=0,i=0;i<e;++i){var n=t[i],s=i+1<e?t[parseInt("".concat(i+1),10)]:t[0],a=n.x-0,c=n.y-0,u=s.x-0,v=.5*(a*(s.y-0)-c*u);o+=v,r.x+=v*(1/3)*(0+n.x+s.x),r.y+=v*(1/3)*(0+n.y+s.y)}return r.x*=1/o,r.y*=1/o,r}},{key:"ComputeOBB",value:function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=new Array(r+1),i=0;i<r;++i)o[i]=e[i];o[r]=o[0];for(var n=Number.MAX_VALUE,s=1;s<=r;++s){for(var a=o[parseInt("".concat(s-1),10)],c=o[s].x-a.x,u=o[s].y-a.y,v=Math.sqrt(c*c+u*u),m=-(u/=v),$=c/=v,l=Number.MAX_VALUE,h=Number.MAX_VALUE,_=-Number.MAX_VALUE,y=-Number.MAX_VALUE,p=0;p<r;++p){var f=o[p].x-a.x,x=o[p].y-a.y,M=c*f+u*x,E=m*f+$*x;M<l&&(l=M),E<h&&(h=E),M>_&&(_=M),E>y&&(y=E)}var j=(_-l)*(y-h);if(j<.95*n){n=j,t.R.col1.x=c,t.R.col1.y=u,t.R.col2.x=m,t.R.col2.y=$;var X=.5*(l+_),d=.5*(h+y),S=t.R;t.center.x=a.x+(S.col1.x*X+S.col2.x*d),t.center.y=a.y+(S.col1.y*X+S.col2.y*d),t.extents.x=.5*(_-l),t.extents.y=.5*(y-h)}}}},{key:"AsArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new r;return o.SetAsArray(t,e),o}},{key:"AsVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new r;return o.SetAsVector(t,e),o}},{key:"AsBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new r;return o.SetAsBox(t,e),o}},{key:"AsOrientedBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ab,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=new r;return n.SetAsOrientedBox(t,e,o,i),n}},{key:"AsEdge",value:function(t,e){var o=new r;return o.SetAsEdge(t,e),o}}]),r}();qg.s_mat=new Qd;var Wx=function(t){oK(r,vb);var e=qK(r);function r(){return mK(this,r),e.apply(this,arguments)}return nK(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&e&&r instanceof qg&&o instanceof aj&&_J(this.m_manifold,r,t.m_xf,o,e.m_xf)}}}],[{key:"Create",value:function(t){return new r}},{key:"Destroy",value:function(t,e){}}]),r}();function FK(t){return(FK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function GK(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Xx(t,r){for(var e=0;e<r.length;e++){var o=r[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function HK(t,r,e){return r&&Xx(t.prototype,r),e&&Xx(t,e),t}function IK(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&JK(t,r)}function JK(t,r){return(JK=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function KK(t){var r=NK();return function(){var e,o=Yx(t);if(r){var n=Yx(this).constructor;e=Reflect.construct(o,arguments,n)}else e=o.apply(this,arguments);return LK(this,e)}}function LK(t,r){return!r||"object"!==FK(r)&&"function"!=typeof r?MK(t):r}function MK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function NK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Yx(t){return(Yx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Zx=function(t){IK(e,vb);var r=KK(e);function e(){return GK(this,e),r.apply(this,arguments)}return HK(e,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),r=this.m_fixtureB.GetBody(),e=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&r&&e instanceof qg&&o instanceof qg&&ZJ(this.m_manifold,e,t.m_xf,o,r.m_xf)}}}],[{key:"Create",value:function(t){return new e}},{key:"Destroy",value:function(t,r){}}]),e}();function OK(t){return(OK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function PK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $x(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function QK(t,e,r){return e&&$x(t.prototype,e),r&&$x(t,r),t}function RK(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&SK(t,e)}function SK(t,e){return(SK=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function TK(t){var e=WK();return function(){var r,o=_x(t);if(e){var n=_x(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return UK(this,r)}}function UK(t,e){return!e||"object"!==OK(e)&&"function"!=typeof e?VK(t):e}function VK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function WK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _x(t){return(_x=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function XK(e){return(XK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function YK(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function ay(e,o){for(var t=0;t<o.length;t++){var r=o[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ZK(e,o,t){return o&&ay(e.prototype,o),t&&ay(e,t),e}function $K(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),o&&_K(e,o)}function _K(e,o){return(_K=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e})(e,o)}function aL(e){var o=dL();return function(){var t,r=by(e);if(o){var n=by(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return bL(this,t)}}function bL(e,o){return!o||"object"!==XK(o)&&"function"!=typeof o?cL(e):o}function cL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dL(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function by(e){return(by=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Xm=function(e){$K(t,mb);var o=aL(t);function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ab,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ab;return YK(this,t),(e=o.call(this)).s_supportVec=new ab,e.m_v1=new ab,e.m_v2=new ab,e.m_coreV1=new ab,e.m_coreV2=new ab,e.m_normal=new ab,e.m_direction=new ab,e.m_cornerDir1=new ab,e.m_cornerDir2=new ab,e.m_length=0,e.m_cornerConvex1=!1,e.m_cornerConvex2=!1,e.m_type=mb.e_edgeShape,e.m_prevEdge=void 0,e.m_nextEdge=void 0,e.m_v1=r,e.m_v2=n,e.m_direction.Set(e.m_v2.x-e.m_v1.x,e.m_v2.y-e.m_v1.y),e.m_length=e.m_direction.Normalize(),e.m_normal.Set(e.m_direction.y,-e.m_direction.x),e.m_coreV1.Set(-Mj*(e.m_normal.x-e.m_direction.x)+e.m_v1.x,-Mj*(e.m_normal.y-e.m_direction.y)+e.m_v1.y),e.m_coreV2.Set(-Mj*(e.m_normal.x+e.m_direction.x)+e.m_v2.x,-Mj*(e.m_normal.y+e.m_direction.y)+e.m_v2.y),e.m_cornerDir1=e.m_normal,e.m_cornerDir2.Set(-e.m_normal.x,-e.m_normal.y),e}return ZK(t,[{key:"RayCast",value:function(e,o,t){var r=t.R,n=o.p2.x-o.p1.x,i=o.p2.y-o.p1.y,c=t.position.x+(r.col1.x*this.m_v1.x+r.col2.x*this.m_v1.y),$=t.position.y+(r.col1.y*this.m_v1.x+r.col2.y*this.m_v1.y),u=t.position.y+(r.col1.y*this.m_v2.x+r.col2.y*this.m_v2.y)-$,m=-(t.position.x+(r.col1.x*this.m_v2.x+r.col2.x*this.m_v2.y)-c),s=100*Number.MIN_VALUE,a=-(n*u+i*m);if(a>s){var _=o.p1.x-c,l=o.p1.y-$,p=_*u+l*m;if(0<=p&&p<=o.maxFraction*a){var y=-n*l+i*_;if(-s*a<=y&&y<=a*(1+s)){p/=a,e.fraction=p;var v=Math.sqrt(u*u+m*m);return e.normal.x=u/v,e.normal.y=m/v,!0}}}return!1}},{key:"ComputeAABB",value:function(e,o){var t=o.R,r=o.position.x+(t.col1.x*this.m_v1.x+t.col2.x*this.m_v1.y),n=o.position.y+(t.col1.y*this.m_v1.x+t.col2.y*this.m_v1.y),i=o.position.x+(t.col1.x*this.m_v2.x+t.col2.x*this.m_v2.y),c=o.position.y+(t.col1.y*this.m_v2.x+t.col2.y*this.m_v2.y);r<i?(e.lowerBound.x=r,e.upperBound.x=i):(e.lowerBound.x=i,e.upperBound.x=r),n<c?(e.lowerBound.y=n,e.upperBound.y=c):(e.lowerBound.y=c,e.upperBound.y=n)}},{key:"ComputeMass",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.mass=0,e.center.SetV(this.m_v1),e.I=0}},{key:"ComputeSubmergedArea",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=new ab(e.x*o,e.y*o),i=zb(t,this.m_v1),c=zb(t,this.m_v2),$=Lb(e,i)-o,u=Lb(e,c)-o;if($>0){if(u>0)return 0;i.x=-u/($-u)*i.x+$/($-u)*c.x,i.y=-u/($-u)*i.y+$/($-u)*c.y}else u>0&&(c.x=-u/($-u)*i.x+$/($-u)*c.x,c.y=-u/($-u)*i.y+$/($-u)*c.y);return r.x=(n.x+i.x+c.x)/3,r.y=(n.y+i.y+c.y)/3,.5*((i.x-n.x)*(c.y-n.y)-(i.y-n.y)*(c.x-n.x))}},{key:"GetLength",value:function(){return this.m_length}},{key:"GetVertex1",value:function(){return this.m_v1}},{key:"GetVertex2",value:function(){return this.m_v2}},{key:"GetCoreVertex1",value:function(){return this.m_coreV1}},{key:"GetCoreVertex2",value:function(){return this.m_coreV2}},{key:"GetNormalVector",value:function(){return this.m_normal}},{key:"GetDirectionVector",value:function(){return this.m_direction}},{key:"GetCorner1Vector",value:function(){return this.m_cornerDir1}},{key:"GetCorner2Vector",value:function(){return this.m_cornerDir2}},{key:"Corner1IsConvex",value:function(){return this.m_cornerConvex1}},{key:"Corner2IsConvex",value:function(){return this.m_cornerConvex2}},{key:"GetFirstVertex",value:function(e){var o=e.R;return new ab(e.position.x+(o.col1.x*this.m_coreV1.x+o.col2.x*this.m_coreV1.y),e.position.y+(o.col1.y*this.m_coreV1.x+o.col2.y*this.m_coreV1.y))}},{key:"GetNextEdge",value:function(){return this.m_nextEdge}},{key:"GetPrevEdge",value:function(){return this.m_prevEdge}},{key:"Support",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.R,n=e.position.x+(r.col1.x*this.m_coreV1.x+r.col2.x*this.m_coreV1.y),i=e.position.y+(r.col1.y*this.m_coreV1.x+r.col2.y*this.m_coreV1.y),c=e.position.x+(r.col1.x*this.m_coreV2.x+r.col2.x*this.m_coreV2.y),$=e.position.y+(r.col1.y*this.m_coreV2.x+r.col2.y*this.m_coreV2.y);return n*o+i*t>c*o+$*t?(this.s_supportVec.x=n,this.s_supportVec.y=i):(this.s_supportVec.x=c,this.s_supportVec.y=$),this.s_supportVec}},{key:"SetPrevEdge",value:function(e,o,t,r){this.m_prevEdge=e,this.m_coreV1=o,this.m_cornerDir1=t,this.m_cornerConvex1=r}},{key:"SetNextEdge",value:function(e,o,t,r){this.m_nextEdge=e,this.m_coreV2=o,this.m_cornerDir2=t,this.m_cornerConvex2=r}}]),t}();var cy=function(t){RK(r,vb);var e=TK(r);function r(){return PK(this,r),e.apply(this,arguments)}return QK(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&e&&r instanceof Xm&&o instanceof aj&&this.CollideEdgeAndCircle(this.m_manifold,r,t.m_xf,o,e.m_xf)}}},{key:"CollideEdgeAndCircle",value:function(t,e,r,o,n){}}],[{key:"Create",value:function(t){return new r}},{key:"Destroy",value:function(t,e){}}]),r}();function eL(e){return(eL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dy(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function gL(e,t,r){return t&&dy(e.prototype,t),r&&dy(e,r),e}function hL(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iL(e,t)}function iL(e,t){return(iL=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jL(e){var t=mL();return function(){var r,o=ey(e);if(t){var n=ey(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return kL(this,r)}}function kL(e,t){return!t||"object"!==eL(t)&&"function"!=typeof t?lL(e):t}function lL(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mL(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function ey(e){return(ey=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fy=function(e){hL(r,vb);var t=jL(r);function r(){return fL(this,r),t.apply(this,arguments)}return gL(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var e=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();e&&t&&r instanceof qg&&o instanceof Xm&&this.CollidePolyAndEdge(this.m_manifold,r,e.m_xf,o,t.m_xf)}}},{key:"CollidePolyAndEdge",value:function(e,t,r,o,n){}}],[{key:"Create",value:function(e){return new r}},{key:"Destroy",value:function(e,t){}}]),r}();var nL=function(){function e(t){hJ(this,e),this.m_allocator=t,this.m_registers={},this.InitializeRegisters()}return iJ(e,[{key:"AddType",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.m_registers[r][o].createFn=e,this.m_registers[r][o].destroyFn=t,this.m_registers[r][o].primary=!0,r!==o&&(this.m_registers[o][r].createFn=e,this.m_registers[o][r].destroyFn=t,this.m_registers[o][r].primary=!1)}},{key:"InitializeRegisters",value:function(){this.m_registers=new Array(mb.e_shapeTypeCount);for(var e=0;e<mb.e_shapeTypeCount;e++){this.m_registers[e]=new Array(mb.e_shapeTypeCount);for(var t=0;t<mb.e_shapeTypeCount;t++)this.m_registers[e][t]=new kJ}this.AddType(Sx.Create,Sx.Destroy,mb.e_circleShape,mb.e_circleShape),this.AddType(Wx.Create,Wx.Destroy,mb.e_polygonShape,mb.e_circleShape),this.AddType(Zx.Create,Zx.Destroy,mb.e_polygonShape,mb.e_polygonShape),this.AddType(cy.Create,cy.Destroy,mb.e_edgeShape,mb.e_circleShape),this.AddType(fy.Create,fy.Destroy,mb.e_polygonShape,mb.e_edgeShape)}},{key:"Create",value:function(e,t){var r,o=parseInt("".concat(e.GetType()),10),a=parseInt("".concat(t.GetType()),10),i=this.m_registers[o][a];if(i.pool)return r=i.pool,i.pool=r.m_next,i.poolCount--,r.Reset(e,t),r;var $=i.createFn;return $?i.primary?((r=$(this.m_allocator)).Reset(e,t),r):((r=$(this.m_allocator)).Reset(t,e),r):void 0}},{key:"Destroy",value:function(e){if(e.m_fixtureA&&e.m_fixtureB&&e.m_fixtureA.m_body&&e.m_fixtureB.m_body){e.m_manifold.m_pointCount>0&&(e.m_fixtureA.m_body.SetAwake(!0),e.m_fixtureB.m_body.SetAwake(!0));var t=parseInt("".concat(e.m_fixtureA.GetType()),10),r=parseInt("".concat(e.m_fixtureB.GetType()),10),o=this.m_registers[t][r];o.poolCount++,e.m_next=o.pool,o.pool=e;var a=o.destroyFn;a&&a(e,this.m_allocator)}}}]),e}();var gy=function(){function t(){jI(this,t),this.m_contactCount=0,this.m_contactFilter=Pm.b2_defaultFilter,this.m_contactListener=Qm.b2_defaultListener,this.m_contactFactory=new nL(void 0),this.m_broadPhase=new _I}return kI(t,[{key:"AddPair",value:function(t,e){var o=t.GetBody(),n=e.GetBody();if(this.m_world&&o&&n&&o!==n){for(var r=n.GetContactList();r;){if(r.other===o){var i=r.contact.GetFixtureA(),a=r.contact.GetFixtureB();if(i===t&&a===e)return;if(i===e&&a===t)return}r=r.next}if(!1!==n.ShouldCollide(o)&&!1!==this.m_contactFilter.ShouldCollide(t,e)){var c=this.m_contactFactory.Create(t,e);t=c.GetFixtureA(),e=c.GetFixtureB(),o=t.m_body,n=e.m_body,o&&n&&(c.m_prev=void 0,c.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=c),this.m_world.m_contactList=c,c.m_nodeA.contact=c,c.m_nodeA.other=n,c.m_nodeA.prev=void 0,c.m_nodeA.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=c.m_nodeA),o.m_contactList=c.m_nodeA,c.m_nodeB.contact=c,c.m_nodeB.other=o,c.m_nodeB.prev=void 0,c.m_nodeB.next=n.m_contactList,null!=n.m_contactList&&(n.m_contactList.prev=c.m_nodeB),n.m_contactList=c.m_nodeB,++this.m_world.m_contactCount)}}}},{key:"FindNewContacts",value:function(){var t=this;this.m_broadPhase.UpdatePairs(function(e,o){t.AddPair(e,o)})}},{key:"Destroy",value:function(t){if(this.m_world){var e=t.GetFixtureA(),o=t.GetFixtureB(),n=e.GetBody(),r=o.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA===n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB===r.m_contactList&&(r.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount}}},{key:"Collide",value:function(){if(this.m_world)for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),o=t.GetFixtureB();if(!e||!o)return;var n=e.GetBody(),r=o.GetBody();if(!n||!r)return;if(!1!==n.IsAwake()||!1!==r.IsAwake()){if(t.m_flags&vb.e_filterFlag){if(!1===r.ShouldCollide(n)){var i=t;t=i.GetNext(),this.Destroy(i);continue}if(!1===this.m_contactFilter.ShouldCollide(e,o)){var a=t;t=a.GetNext(),this.Destroy(a);continue}t.m_flags&=~vb.e_filterFlag}var c=e.m_proxy,_=o.m_proxy;if(!1!==this.m_broadPhase.TestOverlap(c,_))t.Update(this.m_contactListener),t=t.GetNext();else{var m=t;t=m.GetNext(),this.Destroy(m)}}else t=t.GetNext()}}}]),t}();gy.s_evalCP=new gJ;function oL(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function hy(r,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function pL(r,n,o){return n&&hy(r.prototype,n),o&&hy(r,o),r}function qL(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function iy(o,i){for(var t=0;t<i.length;t++){var l=i[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,l.key,l)}}function rL(o,i,t){return i&&iy(o.prototype,i),t&&iy(o,t),o}var sL=function(){function o(){qL(this,o),this.m_normal=new ab,this.m_points=new Array(hd),this.m_points=this.m_points.fill(0).map(function(){return new ab})}return rL(o,[{key:"Initialize",value:function(o,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(0!==o.m_pointCount){var a,r,e=0,c=0,s=0,x=0,m=0,$=0;switch(o.m_type){case Jb.e_circles:r=i.R,a=o.m_localPoint;var y=i.position.x+r.col1.x*a.x+r.col2.x*a.y,_=i.position.y+r.col1.y*a.x+r.col2.y*a.y;r=l.R,a=o.m_points[0].m_localPoint;var p=l.position.x+r.col1.x*a.x+r.col2.x*a.y,J=l.position.y+r.col1.y*a.x+r.col2.y*a.y,h=p-y,f=J-_,u=h*h+f*f;if(u>Number.MIN_VALUE*Number.MIN_VALUE){var v=Math.sqrt(u);this.m_normal.x=h/v,this.m_normal.y=f/v}else this.m_normal.x=1,this.m_normal.y=0;var O=y+t*this.m_normal.x,d=_+t*this.m_normal.y,P=p-n*this.m_normal.x,b=J-n*this.m_normal.y;this.m_points[0].x=.5*(O+P),this.m_points[0].y=.5*(d+b);break;case Jb.e_faceA:r=i.R,a=o.m_localPlaneNormal,e=r.col1.x*a.x+r.col2.x*a.y,c=r.col1.y*a.x+r.col2.y*a.y,r=i.R,a=o.m_localPoint,s=i.position.x+r.col1.x*a.x+r.col2.x*a.y,x=i.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_normal.x=e,this.m_normal.y=c;for(var C=0;C<o.m_pointCount;C++)r=l.R,a=o.m_points[C].m_localPoint,m=l.position.x+r.col1.x*a.x+r.col2.x*a.y,$=l.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_points[C].x=m+.5*(t-(m-s)*e-($-x)*c-n)*e,this.m_points[C].y=$+.5*(t-(m-s)*e-($-x)*c-n)*c;break;case Jb.e_faceB:r=l.R,a=o.m_localPlaneNormal,e=r.col1.x*a.x+r.col2.x*a.y,c=r.col1.y*a.x+r.col2.y*a.y,r=l.R,a=o.m_localPoint,s=l.position.x+r.col1.x*a.x+r.col2.x*a.y,x=l.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_normal.x=-e,this.m_normal.y=-c;for(var R=0;R<o.m_pointCount;R++)r=i.R,a=o.m_points[R].m_localPoint,m=i.position.x+r.col1.x*a.x+r.col2.x*a.y,$=i.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_points[R].x=m+.5*(n-(m-s)*e-($-x)*c-t)*e,this.m_points[R].y=$+.5*(n-(m-s)*e-($-x)*c-t)*c;}}}}]),o}();function tL(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function jy(o,i){for(var t=0;t<i.length;t++){var l=i[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,l.key,l)}}function uL(o,i,t){return i&&jy(o.prototype,i),t&&jy(o,t),o}var Ym=function(){function o(){tL(this,o),this.m_normal=new ab,this.m_separations=new Array(hd).fill(0),this.m_points=new Array(hd).fill(0),this.m_points=this.m_points.map(function(){return new ab})}return uL(o,[{key:"Initialize",value:function(o){Ab(o.pointCount>0);var i,t,l=0,n=0,r=0,a=0;switch(o.type){case Jb.e_circles:i=o.bodyA.m_xf.R,t=o.localPoint;var e=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),s=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y);i=o.bodyB.m_xf.R,t=o.points[0].localPoint;var m=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),c=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),x=m-e,y=c-s,$=x*x+y*y;if($>Number.MIN_VALUE*Number.MIN_VALUE){var _=Math.sqrt($);this.m_normal.x=x/_,this.m_normal.y=y/_}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(e+m),this.m_points[0].y=.5*(s+c),this.m_separations[0]=x*this.m_normal.x+y*this.m_normal.y-o.radius;break;case Jb.e_faceA:i=o.bodyA.m_xf.R,t=o.localPlaneNormal,this.m_normal.x=i.col1.x*t.x+i.col2.x*t.y,this.m_normal.y=i.col1.y*t.x+i.col2.y*t.y,i=o.bodyA.m_xf.R,t=o.localPoint,r=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),a=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),i=o.bodyB.m_xf.R;for(var p=0;p<o.pointCount;++p)t=o.points[p].localPoint,l=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),n=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),this.m_separations[p]=(l-r)*this.m_normal.x+(n-a)*this.m_normal.y-o.radius,this.m_points[p].x=l,this.m_points[p].y=n;break;case Jb.e_faceB:i=o.bodyB.m_xf.R,t=o.localPlaneNormal,this.m_normal.x=i.col1.x*t.x+i.col2.x*t.y,this.m_normal.y=i.col1.y*t.x+i.col2.y*t.y,i=o.bodyB.m_xf.R,t=o.localPoint,r=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),a=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),i=o.bodyA.m_xf.R;for(var f=0;f<o.pointCount;++f)t=o.points[f].localPoint,l=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),n=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),this.m_separations[f]=(l-r)*this.m_normal.x+(n-a)*this.m_normal.y-o.radius,this.m_points[f].Set(l,n);this.m_normal.x*=-1,this.m_normal.y*=-1;}}}]),o}();Ym.circlePointA=new ab,Ym.circlePointB=new ab;function vL(t,$){if(!(t instanceof $))throw new TypeError("Cannot call a class as a function")}function wL($,e){if(!($ instanceof e))throw new TypeError("Cannot call a class as a function")}var xL=function $(){wL(this,$),this.localPoint=new ab,this.rA=new ab,this.rB=new ab};var yL=function t(){vL(this,t),this.localPlaneNormal=new ab,this.localPoint=new ab,this.normal=new ab,this.normalMass=new Qd,this.K=new Qd,this.points=new Array(hd).fill(0),this.points=this.points.map(function(){return new xL})};var Pk=function(){function r(){oL(this,r),this.m_step=new Nm,this.m_constraints=new Array,this.m_constraintCount=0}return pL(r,[{key:"Initialize",value:function(n,o){var t,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;this.m_step.Set(n),this.m_allocator=i;var e=0;for(this.m_constraintCount=a;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new yL;for(e=0;e<a;++e){var s=(t=o[e]).m_fixtureA,l=t.m_fixtureB;if(s&&l){var m=s.m_shape,p=l.m_shape;if(m&&p){var _=m.m_radius,y=p.m_radius,c=s.m_body,u=l.m_body;if(c&&u){var x=t.GetManifold(),v=XH(s.GetFriction(),l.GetFriction()),$=YH(s.GetRestitution(),l.GetRestitution()),f=c.m_linearVelocity.x,d=c.m_linearVelocity.y,I=u.m_linearVelocity.x,B=u.m_linearVelocity.y,A=c.m_angularVelocity,G=u.m_angularVelocity;Ab(x.m_pointCount>0),r.s_worldManifold.Initialize(x,c.m_xf,_,u.m_xf,y);var M=r.s_worldManifold.m_normal.x,h=r.s_worldManifold.m_normal.y,C=this.m_constraints[e];C.bodyA=c,C.bodyB=u,C.manifold=x,C.normal.x=M,C.normal.y=h,C.pointCount=x.m_pointCount,C.friction=v,C.restitution=$,C.localPlaneNormal.x=x.m_localPlaneNormal.x,C.localPlaneNormal.y=x.m_localPlaneNormal.y,C.localPoint.x=x.m_localPoint.x,C.localPoint.y=x.m_localPoint.y,C.radius=_+y,C.type=x.m_type;for(var w=0;w<C.pointCount;++w){var D=x.m_points[w],J=C.points[w];J.normalImpulse=D.m_normalImpulse,J.tangentImpulse=D.m_tangentImpulse,J.localPoint.SetV(D.m_localPoint);var g=J.rA.x=r.s_worldManifold.m_points[w].x-c.m_sweep.c.x,b=J.rA.y=r.s_worldManifold.m_points[w].y-c.m_sweep.c.y,V=J.rB.x=r.s_worldManifold.m_points[w].x-u.m_sweep.c.x,P=J.rB.y=r.s_worldManifold.m_points[w].y-u.m_sweep.c.y,k=g*h-b*M,S=V*h-P*M;k*=k,S*=S;var q=c.m_invMass+u.m_invMass+c.m_invI*k+u.m_invI*S;J.normalMass=1/q;var z=c.m_mass*c.m_invMass+u.m_mass*u.m_invMass;z+=c.m_mass*c.m_invI*k+u.m_mass*u.m_invI*S,J.equalizedMass=1/z;var K=-M,R=g*K-b*h,T=V*K-P*h;R*=R,T*=T;var F=c.m_invMass+u.m_invMass+c.m_invI*R+u.m_invI*T;J.tangentMass=1/F,J.velocityBias=0;var N=I+-G*P-f- -A*b,j=B+G*V-d-A*g,E=C.normal.x*N+C.normal.y*j;E<-UH&&(J.velocityBias+=-C.restitution*E)}if(2===C.pointCount){var L=C.points[0],O=C.points[1],W=c.m_invMass,H=c.m_invI,Q=u.m_invMass,U=u.m_invI,X=L.rA.x*h-L.rA.y*M,Y=L.rB.x*h-L.rB.y*M,Z=O.rA.x*h-O.rA.y*M,rr=O.rB.x*h-O.rB.y*M,nr=W+Q+H*X*X+U*Y*Y,or=W+Q+H*Z*Z+U*rr*rr,tr=W+Q+H*X*Z+U*Y*rr;nr*nr<100*(nr*or-tr*tr)?(C.K.col1.Set(nr,tr),C.K.col2.Set(tr,or),C.K.GetInverse(C.normalMass)):C.pointCount=1}}}}}}},{key:"InitVelocityConstraints",value:function(r){for(var n=0;n<this.m_constraintCount;++n){var o=this.m_constraints[n],t=o.bodyA,a=o.bodyB,i=t.m_invMass,e=t.m_invI,s=a.m_invMass,l=a.m_invI,m=o.normal.x,p=o.normal.y,_=p,y=-m,c=0;if(r.warmStarting){c=o.pointCount;for(var u=0;u<c;++u){var x=o.points[u];x.normalImpulse*=r.dtRatio,x.tangentImpulse*=r.dtRatio;var v=x.normalImpulse*m+x.tangentImpulse*_,$=x.normalImpulse*p+x.tangentImpulse*y;t.m_angularVelocity-=e*(x.rA.x*$-x.rA.y*v),t.m_linearVelocity.x-=i*v,t.m_linearVelocity.y-=i*$,a.m_angularVelocity+=l*(x.rB.x*$-x.rB.y*v),a.m_linearVelocity.x+=s*v,a.m_linearVelocity.y+=s*$}}else{c=o.pointCount;for(var f=0;f<c;++f){var d=o.points[f];d.normalImpulse=0,d.tangentImpulse=0}}}}},{key:"SolveVelocityConstraints",value:function(){for(var r,n,o=0,t=0,a=0,i=0,e=0,s=0,l=0,m=0,p=0,_=0,y=0,c=0,u=0,x=0;x<this.m_constraintCount;++x){for(var v=this.m_constraints[x],$=v.bodyA,f=v.bodyB,d=$.m_angularVelocity,I=f.m_angularVelocity,B=$.m_linearVelocity,A=f.m_linearVelocity,G=$.m_invMass,M=$.m_invI,h=f.m_invMass,C=f.m_invI,w=v.normal.x,D=v.normal.y,J=D,g=-w,b=v.friction,V=0;V<v.pointCount;V++)r=v.points[V],t=(A.x-I*r.rB.y-B.x+d*r.rA.y)*J+(A.y+I*r.rB.x-B.y-d*r.rA.x)*g,a=r.tangentMass*-t,i=b*r.normalImpulse,s=(a=(e=Bd(r.tangentImpulse+a,-i,i))-r.tangentImpulse)*J,l=a*g,B.x-=G*s,B.y-=G*l,d-=M*(r.rA.x*l-r.rA.y*s),A.x+=h*s,A.y+=h*l,I+=C*(r.rB.x*l-r.rB.y*s),r.tangentImpulse=e;if(1===v.pointCount)r=v.points[0],o=(A.x+-I*r.rB.y-B.x- -d*r.rA.y)*w+(A.y+I*r.rB.x-B.y-d*r.rA.x)*D,a=-r.normalMass*(o-r.velocityBias),s=(a=(e=(e=r.normalImpulse+a)>0?e:0)-r.normalImpulse)*w,l=a*D,B.x-=G*s,B.y-=G*l,d-=M*(r.rA.x*l-r.rA.y*s),A.x+=h*s,A.y+=h*l,I+=C*(r.rB.x*l-r.rB.y*s),r.normalImpulse=e;else{var P=v.points[0],k=v.points[1],S=P.normalImpulse,q=k.normalImpulse,z=(A.x-I*P.rB.y-B.x+d*P.rA.y)*w+(A.y+I*P.rB.x-B.y-d*P.rA.x)*D,K=(A.x-I*k.rB.y-B.x+d*k.rA.y)*w+(A.y+I*k.rB.x-B.y-d*k.rA.x)*D,R=z-P.velocityBias,T=K-k.velocityBias;for(R-=(n=v.K).col1.x*S+n.col2.x*q,T-=n.col1.y*S+n.col2.y*q;;){var F=-((n=v.normalMass).col1.x*R+n.col2.x*T),N=-(n.col1.y*R+n.col2.y*T);if(F>=0&&N>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}if(F=-P.normalMass*R,N=0,z=0,K=v.K.col1.y*F+T,F>=0&&K>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}if(F=0,N=-k.normalMass*T,z=v.K.col2.x*N+R,K=0,N>=0&&z>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}if(F=0,N=0,K=T,(z=R)>=0&&K>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}break}}$.m_angularVelocity=d,f.m_angularVelocity=I}}},{key:"FinalizeVelocityConstraints",value:function(){for(var r=0;r<this.m_constraintCount;++r)for(var n=this.m_constraints[r],o=n.manifold,t=0;t<n.pointCount;++t){var a=o.m_points[t],i=n.points[t];a.m_normalImpulse=i.normalImpulse,a.m_tangentImpulse=i.tangentImpulse}}},{key:"SolvePositionConstraints",value:function(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=0,t=0;t<this.m_constraintCount;t++){var a=this.m_constraints[t],i=a.bodyA,e=a.bodyB,s=i.m_mass*i.m_invMass,l=i.m_mass*i.m_invI,m=e.m_mass*e.m_invMass,p=e.m_mass*e.m_invI;r.s_psm.Initialize(a);for(var _=r.s_psm.m_normal,y=0;y<a.pointCount;y++){var c=a.points[y],u=r.s_psm.m_points[y],x=r.s_psm.m_separations[y],v=u.x-i.m_sweep.c.x,$=u.y-i.m_sweep.c.y,f=u.x-e.m_sweep.c.x,d=u.y-e.m_sweep.c.y;o=o<x?o:x;var I=Bd(n*(x+Cd),-VH,0),B=-c.equalizedMass*I,A=B*_.x,G=B*_.y;i.m_sweep.c.x-=s*A,i.m_sweep.c.y-=s*G,i.m_sweep.a-=l*(v*G-$*A),i.SynchronizeTransform(),e.m_sweep.c.x+=m*A,e.m_sweep.c.y+=m*G,e.m_sweep.a+=p*(f*G-d*A),e.SynchronizeTransform()}}return o>-1.5*Cd}}]),r}();Pk.s_worldManifold=new sL,Pk.s_psm=new Ym;function zL(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function ky(t,i){for(var o=0;o<i.length;o++){var e=i[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function AL(t,i,o){return i&&ky(t.prototype,i),o&&ky(t,o),t}function BL(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}var CL=function a(){BL(this,a),this.normalImpulses=new Array(hd),this.tangentImpulses=new Array(hd)};var ly=function(){function t(){zL(this,t),this.m_bodies=new Array,this.m_contacts=new Array,this.m_joints=new Array,this.m_bodyCapacity=0,this.m_contactCapacity=0,this.m_jointCapacity=0,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=void 0,this.m_listener=void 0,this.m_contactSolver=new Pk}return AL(t,[{key:"Initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;this.m_bodyCapacity=t,this.m_contactCapacity=i,this.m_jointCapacity=o,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=e,this.m_listener=n,this.m_contactSolver=a;for(var r=this.m_bodies.length;r<t;r++)this.m_bodies[r]=null;for(var s=this.m_contacts.length;s<i;s++)this.m_contacts[s]=null;for(var m=this.m_joints.length;m<o;m++)this.m_joints[m]=null}},{key:"Clear",value:function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0}},{key:"Solve",value:function(t,i,o){var e,n=0,a=0;for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).GetType()===db.b2_dynamicBody&&(e.m_linearVelocity.x+=t.dt*(i.x+e.m_invMass*e.m_force.x),e.m_linearVelocity.y+=t.dt*(i.y+e.m_invMass*e.m_force.y),e.m_angularVelocity+=t.dt*e.m_invI*e.m_torque,e.m_linearVelocity.Multiply(Bd(1-t.dt*e.m_linearDamping,0,1)),e.m_angularVelocity*=Bd(1-t.dt*e.m_angularDamping,0,1));this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var r=this.m_contactSolver;for(r.InitVelocityConstraints(t),n=0;n<this.m_jointCount;++n)this.m_joints[n].InitVelocityConstraints(t);for(n=0;n<t.velocityIterations;++n){for(a=0;a<this.m_jointCount;++a)this.m_joints[a].SolveVelocityConstraints(t);r.SolveVelocityConstraints()}for(n=0;n<this.m_jointCount;++n)this.m_joints[n].FinalizeVelocityConstraints();for(r.FinalizeVelocityConstraints(),n=0;n<this.m_bodyCount;++n)if((e=this.m_bodies[n]).GetType()!==db.b2_staticBody){var s=t.dt*e.m_linearVelocity.x,m=t.dt*e.m_linearVelocity.y;s*s+m*m>Yw&&(e.m_linearVelocity.Normalize(),e.m_linearVelocity.x*=Yg*t.inv_dt,e.m_linearVelocity.y*=Yg*t.inv_dt);var l=t.dt*e.m_angularVelocity;l*l>Zw&&(e.m_angularVelocity<0?e.m_angularVelocity=-Zg*t.inv_dt:e.m_angularVelocity=Zg*t.inv_dt),e.m_sweep.c0.SetV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=t.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=t.dt*e.m_linearVelocity.y,e.m_sweep.a+=t.dt*e.m_angularVelocity,e.SynchronizeTransform()}for(n=0;n<t.positionIterations;++n){var _=r.SolvePositionConstraints(Mm),c=!0;for(a=0;a<this.m_jointCount;++a){var $=this.m_joints[a].SolvePositionConstraints(Mm);c=c&&$}if(_&&c)break}if(this.Report(r.m_constraints),o){var y=Number.MAX_VALUE,p=$w*$w,u=_w*_w;for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).GetType()!==db.b2_staticBody&&(0==(e.m_flags&db.e_allowSleepFlag)&&(e.m_sleepTime=0,y=0),0==(e.m_flags&db.e_allowSleepFlag)||e.m_angularVelocity*e.m_angularVelocity>u||Lb(e.m_linearVelocity,e.m_linearVelocity)>p?(e.m_sleepTime=0,y=0):(e.m_sleepTime+=t.dt,y=MH(y,e.m_sleepTime)));if(y>=WH)for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).SetAwake(!1)}}},{key:"SolveTOI",value:function(t){var i=0,o=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var e=this.m_contactSolver;for(i=0;i<this.m_jointCount;++i)this.m_joints[i].InitVelocityConstraints(t);for(i=0;i<t.velocityIterations;++i)for(e.SolveVelocityConstraints(),o=0;o<this.m_jointCount;++o)this.m_joints[o].SolveVelocityConstraints(t);for(i=0;i<this.m_bodyCount;++i){var n=this.m_bodies[i];if(n.GetType()!==db.b2_staticBody){var a=t.dt*n.m_linearVelocity.x,r=t.dt*n.m_linearVelocity.y;a*a+r*r>Yw&&(n.m_linearVelocity.Normalize(),n.m_linearVelocity.x*=Yg*t.inv_dt,n.m_linearVelocity.y*=Yg*t.inv_dt);var s=t.dt*n.m_angularVelocity;s*s>Zw&&(n.m_angularVelocity<0?n.m_angularVelocity=-Zg*t.inv_dt:n.m_angularVelocity=Zg*t.inv_dt),n.m_sweep.c0.SetV(n.m_sweep.c),n.m_sweep.a0=n.m_sweep.a,n.m_sweep.c.x+=t.dt*n.m_linearVelocity.x,n.m_sweep.c.y+=t.dt*n.m_linearVelocity.y,n.m_sweep.a+=t.dt*n.m_angularVelocity,n.SynchronizeTransform()}}for(i=0;i<t.positionIterations;++i){var m=e.SolvePositionConstraints(.75),l=!0;for(o=0;o<this.m_jointCount;++o){var _=this.m_joints[o].SolvePositionConstraints(Mm);l=l&&_}if(m&&l)break}this.Report(e.m_constraints)}},{key:"Report",value:function(i){if(this.m_listener)for(var o=0;o<this.m_contactCount;++o)for(var e=i[o],n=0;n<e.pointCount;++n)t.s_impulse.normalImpulses[n]=e.points[n].normalImpulse,t.s_impulse.tangentImpulses[n]=e.points[n].tangentImpulse}},{key:"AddBody",value:function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t}},{key:"AddContact",value:function(t){this.m_contacts[this.m_contactCount++]=t}},{key:"AddJoint",value:function(t){this.m_joints[this.m_jointCount++]=t}}]),t}();ly.s_impulse=new CL;function DL(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function my(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function EL(e,t,n){return t&&my(e.prototype,t),n&&my(e,n),e}function FL(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var ny=function a(){FL(this,a)};var qb=function(){function e(t){DL(this,e),this.m_edgeA=new ny,this.m_edgeB=new ny,this.m_localCenterA=new ab,this.m_localCenterB=new ab,this.m_type=e.e_unknownJoint,this.m_collideConnected=!1,this.m_islandFlag=!1,Ab(t.bodyA!==t.bodyB),this.m_type=t.type,this.m_prev=void 0,this.m_next=void 0,this.m_bodyA=t.bodyA,this.m_bodyB=t.bodyB,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData}return EL(e,[{key:"GetType",value:function(){return this.m_type}},{key:"GetAnchorA",value:function(){return new ab}},{key:"GetAnchorB",value:function(){return new ab}},{key:"GetReactionForce",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new ab}},{key:"GetReactionTorque",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0}},{key:"GetBodyA",value:function(){return this.m_bodyA}},{key:"GetBodyB",value:function(){return this.m_bodyB}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(e){this.m_userData=e}},{key:"IsActive",value:function(){return this.m_bodyA&&this.m_bodyA.IsActive()&&this.m_bodyB&&this.m_bodyB.IsActive()}},{key:"InitVelocityConstraints",value:function(e){}},{key:"SolveVelocityConstraints",value:function(e){}},{key:"FinalizeVelocityConstraints",value:function(){}},{key:"SolvePositionConstraints",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!1}}],[{key:"Destroy",value:function(e,t){}}]),e}();qb.e_unknownJoint=0,qb.e_revoluteJoint=1,qb.e_prismaticJoint=2,qb.e_distanceJoint=3,qb.e_pulleyJoint=4,qb.e_mouseJoint=5,qb.e_gearJoint=6,qb.e_lineJoint=7,qb.e_weldJoint=8,qb.e_frictionJoint=9,qb.e_inactiveLimit=0,qb.e_atLowerLimit=1,qb.e_atUpperLimit=2,qb.e_equalLimits=3;function GL(e,t){switch(e.type){case qb.e_distanceJoint:break;case qb.e_mouseJoint:return new PL(e);case qb.e_prismaticJoint:case qb.e_revoluteJoint:case qb.e_pulleyJoint:case qb.e_gearJoint:case qb.e_lineJoint:case qb.e_weldJoint:case qb.e_frictionJoint:}return new qb(e)}function HL(t){return(HL="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function IL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oy(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function JL(t,e,o){return e&&oy(t.prototype,e),o&&oy(t,o),t}function KL(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&LL(t,e)}function LL(t,e){return(LL=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function ML(t){var e=OL();return function(){var o,r=qy(t);if(e){var i=qy(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return py(this,o)}}function py(t,e){return!e||"object"!==HL(e)&&"function"!=typeof e?NL(t):e}function NL(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OL(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function qy(t){return(qy=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var PL=function(t){KL(o,qb);var e=ML(o);function o(t){var r;if(IL(this,o),(r=e.call(this,t)).K=new Qd,r.K1=new Qd,r.K2=new Qd,r.m_localAnchor=new ab,r.m_target=new ab,r.m_impulse=new ab,r.m_mass=new Qd,r.m_C=new ab,r.m_maxForce=1/0,r.m_frequencyHz=0,r.m_dampingRatio=0,r.m_beta=0,r.m_gamma=0,r.m_target.SetV(t.target),!r.m_bodyB)return py(r);var i=r.m_target.x-r.m_bodyB.m_xf.position.x,n=r.m_target.y-r.m_bodyB.m_xf.position.y,a=r.m_bodyB.m_xf.R;return r.m_localAnchor.x=i*a.col1.x+n*a.col1.y,r.m_localAnchor.y=i*a.col2.x+n*a.col2.y,r.m_maxForce=t.maxForce,r.m_frequencyHz=t.frequencyHz,r.m_dampingRatio=t.dampingRatio,r}return JL(o,[{key:"GetAnchorA",value:function(){return this.m_target}},{key:"GetAnchorB",value:function(){return this.m_bodyB?this.m_bodyB.GetWorldPoint(this.m_localAnchor):new ab}},{key:"GetReactionForce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new ab(t*this.m_impulse.x,t*this.m_impulse.y)}},{key:"GetReactionTorque",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0}},{key:"GetTarget",value:function(){return this.m_target}},{key:"SetTarget",value:function(t){this.m_bodyB&&(!1===this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t)}},{key:"GetMaxForce",value:function(){return this.m_maxForce}},{key:"SetMaxForce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_maxForce=t}},{key:"GetFrequency",value:function(){return this.m_frequencyHz}},{key:"SetFrequency",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_frequencyHz=t}},{key:"GetDampingRatio",value:function(){return this.m_dampingRatio}},{key:"SetDampingRatio",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_dampingRatio=t}},{key:"InitVelocityConstraints",value:function(t){var e=this.m_bodyB,o=e.GetMass(),r=2*Math.PI*this.m_frequencyHz,i=2*o*this.m_dampingRatio*r,n=o*r*r;this.m_gamma=t.dt*(i+t.dt*n),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*n*this.m_gamma;var a=e.m_xf.R,m=this.m_localAnchor.x-e.m_sweep.localCenter.x,s=this.m_localAnchor.y-e.m_sweep.localCenter.y,c=a.col1.x*m+a.col2.x*s;s=a.col1.y*m+a.col2.y*s,m=c;var l=e.m_invMass,u=e.m_invI;this.K1.col1.x=l,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=l,this.K2.col1.x=u*s*s,this.K2.col2.x=-u*m*s,this.K2.col1.y=-u*m*s,this.K2.col2.y=u*m*m,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=e.m_sweep.c.x+m-this.m_target.x,this.m_C.y=e.m_sweep.c.y+s-this.m_target.y,e.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,e.m_linearVelocity.x+=l*this.m_impulse.x,e.m_linearVelocity.y+=l*this.m_impulse.y,e.m_angularVelocity+=u*(m*this.m_impulse.y-s*this.m_impulse.x)}},{key:"SolveVelocityConstraints",value:function(t){var e,o=this.m_bodyB,r=0,i=o.m_xf.R,n=this.m_localAnchor.x-o.m_sweep.localCenter.x,a=this.m_localAnchor.y-o.m_sweep.localCenter.y;r=i.col1.x*n+i.col2.x*a,a=i.col1.y*n+i.col2.y*a,n=r;var m=o.m_linearVelocity.x+-o.m_angularVelocity*a,s=o.m_linearVelocity.y+o.m_angularVelocity*n;i=this.m_mass,r=m+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,e=s+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var c=-(i.col1.x*r+i.col2.x*e),l=-(i.col1.y*r+i.col2.y*e),u=this.m_impulse.x,_=this.m_impulse.y;this.m_impulse.x+=c,this.m_impulse.y+=l;var $=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>$*$&&this.m_impulse.Multiply($/this.m_impulse.Length()),c=this.m_impulse.x-u,l=this.m_impulse.y-_,o.m_linearVelocity.x+=o.m_invMass*c,o.m_linearVelocity.y+=o.m_invMass*l,o.m_angularVelocity+=o.m_invI*(n*l-a*c)}},{key:"SolvePositionConstraints",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!0}}]),o}();function QL(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var RL=function a(){QL(this,a),this.normal=new ab,this.fraction=0};var Xb=function(){function t(e,r){bI(this,t),this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,this.m_allowSleep=!0,this.m_gravity=new ab,this.m_inv_dt0=0,this.m_flags=0,this.m_contactManager=new gy,this.m_contactSolver=new Pk,this.m_island=new ly,this.m_groundBody=this.CreateBody(new Zm),this.s_stack=[],this.m_gravity=e,this.m_allowSleep=r,this.m_contactManager.m_world=this}return cI(t,[{key:"SetDestructionListener",value:function(t){this.m_destructionListener=t}},{key:"SetContactFilter",value:function(t){this.m_contactManager.m_contactFilter=t}},{key:"SetContactListener",value:function(t){this.m_contactManager.m_contactListener=t}},{key:"SetDebugDraw",value:function(t){this.m_debugDraw=t}},{key:"SetBroadPhase",value:function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var r=this.m_bodyList;r;r=r.m_next)for(var o=r.m_fixtureList;o;o=o.m_next)o.m_proxy=t.CreateProxy(e.GetFatAABB(o.m_proxy),o)}},{key:"Validate",value:function(){this.m_contactManager.m_broadPhase.Validate()}},{key:"GetProxyCount",value:function(){return this.m_contactManager.m_broadPhase.GetProxyCount()}},{key:"CreateBody",value:function(t){if(this.IsLocked())throw new Error("Cannot create bodies on a locked world.");var e=new db(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e}},{key:"DestroyBody",value:function(t){if(!this.IsLocked()){for(var e=t.m_jointList;e;){var r=e;e=e.next,this.m_destructionListener&&(this.m_destructionListener.SayGoodbyeJoint(r.joint),this.DestroyJoint(r.joint))}for(var o=t.m_controllerList;o;){var i=o;o=o.nextController,i.controller.RemoveBody(t)}for(var n=t.m_contactList;n;){var a=n;n=n.next,this.m_contactManager.Destroy(a.contact)}t.m_contactList=null;for(var s=t.m_fixtureList;s;){var m=s;s=s.m_next,this.m_destructionListener&&(this.m_destructionListener.SayGoodbyeFixture(m),m.DestroyProxy(this.m_contactManager.m_broadPhase),m.Destroy())}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}}},{key:"CreateJoint",value:function(t){if(t.bodyA&&t.bodyB){var e=GL(t,null);if(e.m_bodyA&&e.m_bodyB){e.m_prev=void 0,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=void 0,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=void 0,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var r=t.bodyA,o=t.bodyB;if(!1===t.collideConnected)for(var i=o.GetContactList();i;)i.other===r&&i.contact.FlagForFiltering(),i=i.next;return e}}}},{key:"DestroyJoint",value:function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_jointList&&(this.m_jointList=t.m_next);var r=t.m_bodyA,o=t.m_bodyB;if(r&&o&&(r.SetAwake(!0),o.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA===r.m_jointList&&(r.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=void 0,t.m_edgeA.next=void 0,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB===o.m_jointList&&(o.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=void 0,t.m_edgeB.next=void 0,qb.Destroy(t,null),--this.m_jointCount,!1===e))for(var i=o.GetContactList();i;)i.other===r&&i.contact.FlagForFiltering(),i=i.next}},{key:"AddController",value:function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t}},{key:"RemoveController",value:function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList===t&&(this.m_controllerList=t.m_next),this.m_controllerCount--}},{key:"CreateController",value:function(t){if(t.m_world!==this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t}},{key:"DestroyController",value:function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t===this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount}},{key:"SetWarmStarting",value:function(e){t.m_warmStarting=e}},{key:"SetContinuousPhysics",value:function(e){t.m_continuousPhysics=e}},{key:"GetBodyCount",value:function(){return this.m_bodyCount}},{key:"GetJointCount",value:function(){return this.m_jointCount}},{key:"GetContactCount",value:function(){return this.m_contactCount}},{key:"SetGravity",value:function(t){this.m_gravity=t}},{key:"GetGravity",value:function(){return this.m_gravity}},{key:"GetGroundBody",value:function(){return this.m_groundBody}},{key:"Step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.m_flags&t.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~t.e_newFixture),this.m_flags|=t.e_locked;var i=t.s_timestep2;i.dt=e,i.velocityIterations=r,i.positionIterations=o,i.inv_dt=e>0?1/e:0,i.dtRatio=this.m_inv_dt0*e,i.warmStarting=t.m_warmStarting,this.m_contactManager.Collide(),i.dt>0&&this.Solve(i),t.m_continuousPhysics&&i.dt>0&&this.SolveTOI(i),i.dt>0&&(this.m_inv_dt0=i.inv_dt),this.m_flags&=~t.e_locked}},{key:"ClearForces",value:function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0}},{key:"DrawDebugData",value:function(){if(this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var e,r,o,i,n,a,s=this.m_debugDraw.GetFlags(),m=[new ab,new ab,new ab,new ab],_=new ex(0,0,0);if(s&Pb.e_shapeBit)for(e=this.m_bodyList;e;e=e.m_next)for(a=e.m_xf,r=e.GetFixtureList();r;r=r.m_next)o=r.GetShape(),!1===e.IsActive()?(_.Set(.5,.5,.3),this.DrawShape(o,a,_)):e.GetType()===db.b2_staticBody?(_.Set(.5,.9,.5),this.DrawShape(o,a,_)):e.GetType()===db.b2_kinematicBody?(_.Set(.5,.5,.9),this.DrawShape(o,a,_)):!1===e.IsAwake()?(_.Set(.6,.6,.6),this.DrawShape(o,a,_)):(_.Set(.9,.7,.7),this.DrawShape(o,a,_));if(s&Pb.e_jointBit)for(i=this.m_jointList;i;i=i.m_next)this.DrawJoint(i);if(s&Pb.e_controllerBit)for(var $=this.m_controllerList;$;$=$.m_next)$.Draw(this.m_debugDraw);if(s&Pb.e_pairBit){_.Set(.3,.9,.9);for(var c=this.m_contactManager.m_contactList;c;c=c.GetNext()){var l=c.GetFixtureA(),d=c.GetFixtureB();if(l&&d){var u=l.GetAABB().GetCenter(),p=d.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(u,p,_)}}}if(s&Pb.e_aabbBit)for(n=this.m_contactManager.m_broadPhase,m=[new ab,new ab,new ab,new ab],e=this.m_bodyList;e;e=e.GetNext())if(e.IsActive())for(r=e.GetFixtureList();r;r=r.GetNext()){var x=n.GetFatAABB(r.m_proxy);m[0].Set(x.lowerBound.x,x.lowerBound.y),m[1].Set(x.upperBound.x,x.lowerBound.y),m[2].Set(x.upperBound.x,x.upperBound.y),m[3].Set(x.lowerBound.x,x.upperBound.y),this.m_debugDraw.DrawPolygon(m,4,_)}if(s&Pb.e_centerOfMassBit)for(e=this.m_bodyList;e;e=e.m_next)(a=t.s_xf).R=e.m_xf.R,a.position=e.GetWorldCenter(),this.m_debugDraw.DrawTransform(a)}}},{key:"QueryAABB",value:function(t,e){var r=this.m_contactManager.m_broadPhase;r.Query(function(e){return t(r.GetUserData(e))},e)}},{key:"QueryShape",value:function(t,e,r){r||(r=new Dd).SetIdentity();var o=this.m_contactManager.m_broadPhase,i=new Rd;e.ComputeAABB(i,r),o.Query(function(i){var n=o.GetUserData(i)instanceof Nj?o.GetUserData(i):null;return!mb.TestOverlap(e,r,n.GetShape(),n.GetBody().GetTransform())||t(n)},i)}},{key:"QueryPoint",value:function(t,e){var r=this.m_contactManager.m_broadPhase,o=new Rd;o.lowerBound.Set(e.x-Cd,e.y-Cd),o.upperBound.Set(e.x+Cd,e.y+Cd),r.Query(function(o){var i=r.GetUserData(o)instanceof Nj?r.GetUserData(o):null;return!i.TestPoint(e)||t(i)},o)}},{key:"RayCast",value:function(t,e,r){var o=this.m_contactManager.m_broadPhase,i=new RL,n=new Bx(e,r);o.RayCast(function(n,a){var s=o.GetUserData(a);if(!(s instanceof Nj))return n.maxFraction;if(s.RayCast(i,n)){var m=i.fraction,_=new ab((1-m)*e.x+m*r.x,(1-m)*e.y+m*r.y);return t(s,_,i.normal,m)}},n)}},{key:"RayCastOne",value:function(t,e){var r;return this.RayCast(function(t,e,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return r=t,i},t,e),r}},{key:"RayCastAll",value:function(t,e){var r=new Array;return this.RayCast(function(t,e,o){arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r[r.length]=t,1},t,e),r}},{key:"GetBodyList",value:function(){return this.m_bodyList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetContactList",value:function(){return this.m_contactList}},{key:"IsLocked",value:function(){return(this.m_flags&t.e_locked)>0}},{key:"Solve",value:function(t){for(var e,r=this.m_controllerList;r;r=r.m_next)r.Step(t);var o=this.m_island;for(o.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~db.e_islandFlag;for(var i=this.m_contactList;i;i=i.m_next)i.m_flags&=~vb.e_islandFlag;for(var n=this.m_jointList;n;n=n.m_next)n.m_islandFlag=!1;for(var a=this.s_stack,s=this.m_bodyList;s;s=s.m_next)if(!(s.m_flags&db.e_islandFlag)&&!1!==s.IsAwake()&&!1!==s.IsActive()&&s.GetType()!==db.b2_staticBody){o.Clear();var m=0;for(a[m++]=s,s.m_flags|=db.e_islandFlag;m>0;)if(e=a[--m],o.AddBody(e),!1===e.IsAwake()&&e.SetAwake(!0),e.GetType()!==db.b2_staticBody){for(var _=void 0,$=e.m_contactList;$;$=$.next)$.contact.m_flags&vb.e_islandFlag||!0!==$.contact.IsSensor()&&!1!==$.contact.IsEnabled()&&!1!==$.contact.IsTouching()&&(o.AddContact($.contact),$.contact.m_flags|=vb.e_islandFlag,(_=$.other).m_flags&db.e_islandFlag||(a[m++]=_,_.m_flags|=db.e_islandFlag));for(var c=e.m_jointList;c;c=c.next)!0!==c.joint.m_islandFlag&&!1!==(_=c.other).IsActive()&&(o.AddJoint(c.joint),c.joint.m_islandFlag=!0,_.m_flags&db.e_islandFlag||(a[m++]=_,_.m_flags|=db.e_islandFlag))}o.Solve(t,this.m_gravity,this.m_allowSleep);for(var l=0;l<o.m_bodyCount;++l)(e=o.m_bodies[l]).GetType()===db.b2_staticBody&&(e.m_flags&=~db.e_islandFlag)}for(var d=0;d<a.length&&a[d];++d)a[d]=null;for(e=this.m_bodyList;e;e=e.m_next)!1!==e.IsAwake()&&!1!==e.IsActive()&&e.GetType()!==db.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()}},{key:"SolveTOI",value:function(e){var r,o,i,n,a,s,m,_=this.m_island;_.Initialize(this.m_bodyCount,SH,TH,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var $,c=t.s_queue;for(r=this.m_bodyList;r;r=r.m_next)r.m_flags&=~db.e_islandFlag,r.m_sweep.t0=0;for($=this.m_contactList;$;$=$.m_next)$.m_flags&=~(vb.e_toiFlag|vb.e_islandFlag);for(m=this.m_jointList;m;m=m.m_next)m.m_islandFlag=!1;for(;;){var l=null,d=1;for($=this.m_contactList;$;$=$.m_next)if(!0!==$.IsSensor()&&!1!==$.IsEnabled()&&!1!==$.IsContinuous()){var u=1;if($.m_flags&vb.e_toiFlag)u=$.m_toi;else{if(o=$.m_fixtureA,i=$.m_fixtureB,n=o.m_body,a=i.m_body,!(n.GetType()===db.b2_dynamicBody&&!1!==n.IsAwake()||a.GetType()===db.b2_dynamicBody&&!1!==a.IsAwake()))continue;var p=n.m_sweep.t0;n.m_sweep.t0<a.m_sweep.t0?(p=a.m_sweep.t0,n.m_sweep.Advance(p)):a.m_sweep.t0<n.m_sweep.t0&&(p=n.m_sweep.t0,a.m_sweep.Advance(p)),u=$.ComputeTOI(n.m_sweep,a.m_sweep),Ab(0<=u&&u<=1),u>0&&u<1&&(u=(1-u)*p+u)>1&&(u=1),$.m_toi=u,$.m_flags|=vb.e_toiFlag}Number.MIN_VALUE<u&&u<d&&(l=$,d=u)}if(null===l||1-100*Number.MIN_VALUE<d)break;if(o=l.m_fixtureA,i=l.m_fixtureB,n=o.m_body,a=i.m_body,t.s_backupA.Set(n.m_sweep),t.s_backupB.Set(a.m_sweep),n.Advance(d),a.Advance(d),l.Update(this.m_contactManager.m_contactListener),l.m_flags&=~vb.e_toiFlag,!0!==l.IsSensor()&&!1!==l.IsEnabled()){if(!1!==l.IsTouching()){var x=n;x.GetType()!==db.b2_dynamicBody&&(x=a),_.Clear();var y=0,h=0;for(c[y+h++]=x,x.m_flags|=db.e_islandFlag;h>0;)if(r=c[y++],--h,_.AddBody(r),!1===r.IsAwake()&&r.SetAwake(!0),r.GetType()===db.b2_dynamicBody){for(s=r.m_contactList;s&&_.m_contactCount!==_.m_contactCapacity;s=s.next)if(!(s.contact.m_flags&vb.e_islandFlag)&&!0!==s.contact.IsSensor()&&!1!==s.contact.IsEnabled()&&!1!==s.contact.IsTouching()){_.AddContact(s.contact),s.contact.m_flags|=vb.e_islandFlag;var f=s.other;f.m_flags&db.e_islandFlag||(f.GetType()!==db.b2_staticBody&&(f.Advance(d),f.SetAwake(!0)),c[y+h]=f,++h,f.m_flags|=db.e_islandFlag)}for(var v=r.m_jointList;v;v=v.next)if(_.m_jointCount!==_.m_jointCapacity&&!0!==v.joint.m_islandFlag){var g=v.other;!1!==g.IsActive()&&(_.AddJoint(v.joint),v.joint.m_islandFlag=!0,g.m_flags&db.e_islandFlag||(g.GetType()!==db.b2_staticBody&&(g.Advance(d),g.SetAwake(!0)),c[y+h]=g,++h,g.m_flags|=db.e_islandFlag))}}var z=t.s_timestep;z.warmStarting=!1,z.dt=(1-d)*e.dt,z.inv_dt=1/z.dt,z.dtRatio=0,z.velocityIterations=e.velocityIterations,z.positionIterations=e.positionIterations,_.SolveTOI(z);for(var Y=0;Y<_.m_bodyCount;++Y)if((r=_.m_bodies[Y]).m_flags&=~db.e_islandFlag,!1!==r.IsAwake()&&r.GetType()===db.b2_dynamicBody)for(r.SynchronizeFixtures(),s=r.m_contactList;s;s=s.next)s.contact.m_flags&=~vb.e_toiFlag;for(var w=0;w<_.m_contactCount;++w)($=_.m_contacts[w]).m_flags&=~(vb.e_toiFlag|vb.e_islandFlag);for(var b=0;b<_.m_jointCount;++b)(m=_.m_joints[b]).m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else n.m_sweep.Set(t.s_backupA),a.m_sweep.Set(t.s_backupB),n.SynchronizeTransform(),a.SynchronizeTransform()}}},{key:"DrawJoint",value:function(e){if(this.m_debugDraw){var r=e.GetBodyA(),o=e.GetBodyB();if(r&&o){var i=r.m_xf,n=o.m_xf,a=i.position,s=n.position,m=e.GetAnchorA(),_=e.GetAnchorB();if(m&&_){var $=t.s_jointColor;switch(e.m_type){case qb.e_distanceJoint:this.m_debugDraw.DrawSegment(m,_,$);break;case qb.e_pulleyJoint:break;case qb.e_mouseJoint:this.m_debugDraw.DrawSegment(m,_,$);break;default:r!==this.m_groundBody&&this.m_debugDraw.DrawSegment(a,m,$),this.m_debugDraw.DrawSegment(m,_,$),o!==this.m_groundBody&&this.m_debugDraw.DrawSegment(s,_,$);}}}}}},{key:"DrawShape",value:function(t,e,r){if(this.m_debugDraw)switch(t.m_type){case mb.e_circleShape:if(!(t instanceof aj))return;var o=t,i=zb(e,o.m_p),n=o.m_radius,a=e.R.col1;this.m_debugDraw.DrawSolidCircle(i,n,a,r);break;case mb.e_polygonShape:if(!(t instanceof qg))return;for(var s=t,m=parseInt("".concat(s.GetVertexCount()),10),_=s.GetVertices(),$=new Array(m),c=0;c<m;++c)$[c]=zb(e,_[c]);this.m_debugDraw.DrawSolidPolygon($,m,r);break;case mb.e_edgeShape:if(!(t instanceof Xm))return;var l=t;this.m_debugDraw.DrawSegment(zb(e,l.GetVertex1()),zb(e,l.GetVertex2()),r);}}}]),t}();Xb.s_timestep2=new Nm,Xb.s_xf=new Dd,Xb.s_backupA=new pg,Xb.s_backupB=new pg,Xb.s_timestep=new Nm,Xb.s_queue=new Array,Xb.s_jointColor=new ex(.5,.8,.8),Xb.e_newFixture=1,Xb.e_locked=2,Xb.m_warmStarting=!0,Xb.m_continuousPhysics=!0;function SL(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ry=function t(){SL(this,t),this.filter=new lx,this.shape=void 0,this.userData=void 0,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0};var db=function(){function t(e,i){QH(this,t),this.m_world=i,this.m_xf=new Dd,this.m_sweep=new pg,this.m_linearVelocity=new ab,this.m_angularVelocity=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_force=new ab,this.m_torque=0,this.m_flags=0,this.m_islandIndex=0,this.m_flags=0,e.bullet&&(this.m_flags|=t.e_bulletFlag),e.fixedRotation&&(this.m_flags|=t.e_fixedRotationFlag),e.allowSleep&&(this.m_flags|=t.e_allowSleepFlag),e.awake&&(this.m_flags|=t.e_awakeFlag),e.active&&(this.m_flags|=t.e_activeFlag),this.m_xf.position.SetV(e.position),this.m_xf.R.Set(e.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=e.angle;var s=this.m_xf.R,a=this.m_sweep.localCenter;this.m_sweep.c.x=s.col1.x*a.x+s.col2.x*a.y,this.m_sweep.c.y=s.col1.y*a.x+s.col2.y*a.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=e.type,this.m_type===t.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=e.inertiaScale,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0}return RH(t,[{key:"connectEdges",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=Math.atan2(e.GetDirectionVector().y,e.GetDirectionVector().x),a=Math.tan(.5*(s-i)),n=Uw(a,e.GetDirectionVector());n=ub(n,e.GetNormalVector()),n=Uw(Mj,n),n=Ik(n,e.GetVertex1());var o=Ik(t.GetDirectionVector(),e.GetDirectionVector());o.Normalize();var r=Lb(t.GetDirectionVector(),e.GetNormalVector())>0;return t.SetNextEdge(e,n,o,r),e.SetPrevEdge(t,n,o,r),s}},{key:"CreateFixture",value:function(e){if(this.m_world&&!this.m_world.IsLocked()){var i=new Nj;if(i.Create(this,this.m_xf,e),this.m_flags&t.e_activeFlag){var s=this.m_world.m_contactManager.m_broadPhase;i.CreateProxy(s,this.m_xf)}return i.m_next=this.m_fixtureList,this.m_fixtureList=i,++this.m_fixtureCount,i.m_body=this,i.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=Xb.e_newFixture,i}}},{key:"CreateFixture2",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=new ry;return i.shape=t,i.density=e,this.CreateFixture(i)}},{key:"DestroyFixture",value:function(e){if(this.m_world&&!this.m_world.IsLocked()){for(var i=this.m_fixtureList,s=null;null!==i;){if(i===e){s?s.m_next=e.m_next:this.m_fixtureList=e.m_next;break}s=i,i=i.m_next}for(var a=this.m_contactList;a;){var n=a.contact;a=a.next;var o=n.GetFixtureA(),r=n.GetFixtureB();e!==o&&e!==r||this.m_world.m_contactManager.Destroy(n)}if(this.m_flags&t.e_activeFlag){var l=this.m_world.m_contactManager.m_broadPhase;e.DestroyProxy(l)}e.Destroy(),e.m_body=void 0,e.m_next=void 0,--this.m_fixtureCount,this.ResetMassData()}}},{key:"SetPositionAndAngle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.m_world&&!this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var i=this.m_xf.R,s=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*s.x+i.col2.x*s.y,this.m_sweep.c.y=i.col1.y*s.x+i.col2.y*s.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;for(var a=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(a,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}}},{key:"SetTransform",value:function(t){this.SetPositionAndAngle(t.position,t.GetAngle())}},{key:"GetTransform",value:function(){return this.m_xf}},{key:"GetPosition",value:function(){return this.m_xf.position}},{key:"SetPosition",value:function(t){this.SetPositionAndAngle(t,this.GetAngle())}},{key:"GetAngle",value:function(){return this.m_sweep.a}},{key:"SetAngle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.SetPositionAndAngle(this.GetPosition(),t)}},{key:"GetWorldCenter",value:function(){return this.m_sweep.c}},{key:"GetLocalCenter",value:function(){return this.m_sweep.localCenter}},{key:"SetLinearVelocity",value:function(e){this.m_type!==t.b2_staticBody&&this.m_linearVelocity.SetV(e)}},{key:"GetLinearVelocity",value:function(){return this.m_linearVelocity}},{key:"SetAngularVelocity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_type!==t.b2_staticBody&&(this.m_angularVelocity=e)}},{key:"GetAngularVelocity",value:function(){return this.m_angularVelocity}},{key:"GetDefinition",value:function(){var e=new Zm;return e.type=this.GetType(),e.allowSleep=(this.m_flags&t.e_allowSleepFlag)===t.e_allowSleepFlag,e.angle=this.GetAngle(),e.angularDamping=this.m_angularDamping,e.angularVelocity=this.m_angularVelocity,e.fixedRotation=(this.m_flags&t.e_fixedRotationFlag)===t.e_fixedRotationFlag,e.bullet=(this.m_flags&t.e_bulletFlag)===t.e_bulletFlag,e.awake=(this.m_flags&t.e_awakeFlag)===t.e_awakeFlag,e.linearDamping=this.m_linearDamping,e.linearVelocity.SetV(this.GetLinearVelocity()),e.position=this.GetPosition(),e.userData=this.GetUserData(),e}},{key:"ApplyForce",value:function(e,i){this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=e.x,this.m_force.y+=e.y,this.m_torque+=(i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x)}},{key:"ApplyTorque",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_torque+=e)}},{key:"ApplyImpulse",value:function(e,i){this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y,this.m_angularVelocity+=this.m_invI*((i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x))}},{key:"Split",value:function(t){if(this.m_world&&!this.m_world.IsLocked()){var e=this.GetLinearVelocity().Copy(),i=this.GetAngularVelocity(),s=this.GetWorldCenter(),a=this.m_world.CreateBody(this.GetDefinition());if(a){for(var n,o=this.m_fixtureList;o;)if(t(o)){var r=o.m_next;n?n.m_next=r:this.m_fixtureList=r,this.m_fixtureCount--,o.m_next=a.m_fixtureList,a.m_fixtureList=o,a.m_fixtureCount++,o.m_body=a,o=r}else n=o,o=o.m_next;this.ResetMassData(),a.ResetMassData();var l=this.GetWorldCenter(),m=a.GetWorldCenter(),_=Ik(e,Hk(i,ub(l,s))),h=Ik(e,Hk(i,ub(m,s)));return this.SetLinearVelocity(_),a.SetLinearVelocity(h),this.SetAngularVelocity(i),a.SetAngularVelocity(i),this.SynchronizeFixtures(),a.SynchronizeFixtures(),a}}}},{key:"Merge",value:function(t){for(var e=t,i=t.m_fixtureList;i;){var s=i.m_next;t.m_fixtureCount--,i.m_next=this.m_fixtureList,this.m_fixtureList=i,this.m_fixtureCount++,i.m_body=e,i=s}this.m_fixtureCount=0,this.ResetMassData(),this.SynchronizeFixtures()}},{key:"GetMass",value:function(){return this.m_mass}},{key:"GetInertia",value:function(){return this.m_I}},{key:"GetMassData",value:function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)}},{key:"SetMassData",value:function(e){if(this.m_world&&!this.m_world.IsLocked()&&(Ab(!1===this.m_world.IsLocked()),this.m_type===t.b2_dynamicBody)){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&t.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(zb(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}}},{key:"ResetMassData",value:function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!==t.b2_staticBody&&this.m_type!==t.b2_kinematicBody){for(var e=ab.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!==i.m_density){var s=i.GetMassData();this.m_mass+=s.mass,e.x+=s.center.x*s.mass,e.y+=s.center.y*s.mass,this.m_I+=s.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&t.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,Ab(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var a=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(zb(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-a.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-a.x)}}},{key:"GetWorldPoint",value:function(t){var e=this.m_xf.R,i=new ab(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i}},{key:"GetWorldVector",value:function(t){return og(this.m_xf.R,t)}},{key:"GetLocalPoint",value:function(t){return KH(this.m_xf,t)}},{key:"GetLocalVector",value:function(t){return Pd(this.m_xf.R,t)}},{key:"GetLinearVelocityFromWorldPoint",value:function(t){return new ab(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))}},{key:"GetLinearVelocityFromLocalPoint",value:function(t){var e=this.m_xf.R,i=new ab(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new ab(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))}},{key:"GetLinearDamping",value:function(){return this.m_linearDamping}},{key:"SetLinearDamping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_linearDamping=t}},{key:"GetAngularDamping",value:function(){return this.m_angularDamping}},{key:"SetAngularDamping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_angularDamping=t}},{key:"SetType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.m_type!==e){this.m_type=e,this.ResetMassData(),this.m_type===t.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var i=this.m_contactList;i;i=i.next)i.contact.FlagForFiltering()}}},{key:"GetType",value:function(){return this.m_type}},{key:"SetBullet",value:function(e){e?this.m_flags|=t.e_bulletFlag:this.m_flags&=~t.e_bulletFlag}},{key:"IsBullet",value:function(){return(this.m_flags&t.e_bulletFlag)===t.e_bulletFlag}},{key:"SetSleepingAllowed",value:function(e){e?this.m_flags|=t.e_allowSleepFlag:(this.m_flags&=~t.e_allowSleepFlag,this.SetAwake(!0))}},{key:"SetAwake",value:function(e){e?(this.m_flags|=t.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~t.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)}},{key:"IsAwake",value:function(){return(this.m_flags&t.e_awakeFlag)===t.e_awakeFlag}},{key:"SetFixedRotation",value:function(e){e?this.m_flags|=t.e_fixedRotationFlag:this.m_flags&=~t.e_fixedRotationFlag,this.ResetMassData()}},{key:"IsFixedRotation",value:function(){return(this.m_flags&t.e_fixedRotationFlag)===t.e_fixedRotationFlag}},{key:"SetActive",value:function(e){if(e!==this.IsActive()&&this.m_world&&!this.m_world.IsLocked()){var i=this.m_world.m_contactManager.m_broadPhase;if(e){this.m_flags|=t.e_activeFlag;for(var s=this.m_fixtureList;s;s=s.m_next)s.CreateProxy(i,this.m_xf)}else{this.m_flags&=~t.e_activeFlag;for(var a=this.m_fixtureList;a;a=a.m_next)a.DestroyProxy(i);for(var n=this.m_contactList;n;){var o=n;n=n.next,this.m_world.m_contactManager.Destroy(o.contact)}this.m_contactList=null}}}},{key:"IsActive",value:function(){return(this.m_flags&t.e_activeFlag)===t.e_activeFlag}},{key:"IsSleepingAllowed",value:function(){return(this.m_flags&t.e_allowSleepFlag)===t.e_allowSleepFlag}},{key:"GetFixtureList",value:function(){return this.m_fixtureList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetControllerList",value:function(){return this.m_controllerList}},{key:"GetContactList",value:function(){return this.m_contactList}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(t){this.m_userData=t}},{key:"GetWorld",value:function(){return this.m_world}},{key:"SynchronizeFixtures",value:function(){if(this.m_world&&!this.m_world.IsLocked()){var e=t.s_xf1;e.R.Set(this.m_sweep.a0);var i=e.R,s=this.m_sweep.localCenter;e.position.x=this.m_sweep.c0.x-(i.col1.x*s.x+i.col2.x*s.y),e.position.y=this.m_sweep.c0.y-(i.col1.y*s.x+i.col2.y*s.y);for(var a=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(a,e,this.m_xf)}}},{key:"SynchronizeTransform",value:function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)}},{key:"ShouldCollide",value:function(e){if(this.m_type!==t.b2_dynamicBody&&e.m_type!==t.b2_dynamicBody)return!1;for(var i=this.m_jointList;i;i=i.next)if(i.other===e&&!1===i.joint.m_collideConnected)return!1;return!0}},{key:"Advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()}}]),t}();db.s_xf1=new Dd,db.e_islandFlag=1,db.e_awakeFlag=2,db.e_allowSleepFlag=4,db.e_bulletFlag=8,db.e_fixedRotationFlag=16,db.e_activeFlag=32,db.b2_staticBody=0,db.b2_kinematicBody=1,db.b2_dynamicBody=2;var Zm=function t(){PH(this,t),this.position=new ab,this.linearVelocity=new ab,this.angle=0,this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=db.b2_staticBody,this.active=!0,this.inertiaScale=1};var Qk=30;function TL(e){var r=e.canvas,t=new Xb(new ab(0,30),!1),$=new ry;$.density=1,$.friction=.5,$.restitution=.2;var o=new Zm;o.type=db.b2_staticBody,$.shape=new qg;var i=r.width/Qk,s=r.height/Qk;$.shape.SetAsBox(i/2,1),o.position.Set(i/2,-1),t.CreateBody(o).CreateFixture($),o.position.Set(i/2,s+1),t.CreateBody(o).CreateFixture($),$.shape.SetAsBox(1,s/2),o.position.Set(-1,s/2),t.CreateBody(o).CreateFixture($),o.position.Set(i+1,s/2),t.CreateBody(o).CreateFixture($),o.type=db.b2_dynamicBody,$.shape=new aj(i/8),o.position.Set(i/2,s/2),t.CreateBody(o).CreateFixture($);var a=new Pb;a.SetDrawScale(Qk),a.SetSprite(e),a.SetFillAlpha(.5),a.SetLineThickness(1),a.SetFlags(Pb.e_shapeBit|Pb.e_jointBit),t.SetDebugDraw(a);return requestAnimationFrame(function e(r){requestAnimationFrame(e),t.Step(1/60,5,5),t.DrawDebugData(),t.ClearForces()}),t}var $m={},UL=(Zd(),cd).Buffer;function sy(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,r=new Uint8Array(e);return e>0&&crypto.getRandomValues(r),UL.from(r.buffer)}$m.default=sy;var VL=document.querySelector("ul"),_m=document.querySelector("pre"),WL=document.querySelector("canvas"),bj=function(r){_m.textContent+=r,_m.scrollTo({top:_m.scrollHeight,behavior:"smooth"})},ty=location,XL=ty.origin,YL=ty.pathname,ZL="".concat(XL).concat(YL).replace("/host","/player"),$L=sy(),ap=$L.toString("hex").slice(0,7);location.hash="#".concat(ap);var _L={color:{light:"#ffffff66"}};wE(WL,"".concat(ZL,"#").concat(ap),_L,function(r){r&&bj("qrcode error:\n".concat(r.message))});var rg={};var uy=function(r){requestAnimationFrame(uy),Object.entries(rg).forEach(function(r){var e=dp(r,2),t=e[0],a=e[1].orientation,n=document.getElementById("connection-".concat(t));if(n){var o=n.querySelector("p");if(o){var $=Sw(a);$[1]=-$[1],$[4]=-$[4];var c="matrix3d(".concat($.join(","),")");n.style.transform=c}}})};requestAnimationFrame(uy);var vy=function(r){rg[r]&&(rg[r].host.destroy(),delete rg[r]);var e=document.getElementById("connection-".concat(r));e&&e.remove()};Pw.signInAnonymously().then(function(r){if(r&&r.user){var e=r.user.uid,t=Qw.ref("/rooms/".concat(ap)),a=t.child("/connections").ref;t.onDisconnect().set(null);a.on("child_added",function(r){if(r&&r.key){var $Jlv9$$interop$default=wy(Hq);var t=r.key,a=r.child("offer").ref,n=r.child("answer").ref,o=new $Jlv9$$interop$default.d({initiator:!1,trickle:!1});rg[t]={orientation:[0,0,0,1],host:o};var $=document.createElement("li");$.id="connection-".concat(t);var c,i=document.createElement("canvas");$.append(i);var d=function(r){r?bj("error:\n".concat(r.message,"\n\n")):rg[t]&&bj("connection: ".concat(t," - disconnected\n")),vy(t)};o.on("signal",function(r){"answer"===r.type&&n.set(cp(cp({},r),{},{uid:e}))}).on("connect",function(){bj("connection: ".concat(t," - connected\n")),VL.appendChild($);var r=new Date().toLocaleTimeString();o.send(JSON.stringify({host:t,time:r}))}).on("error",d).on("close",d).on("end",d).on("data",function(r){var e=JSON.parse(r),a=e.time,n=e.player,d=e.width,y=e.height,l=e.orientation;if(a){var v=new Date().toLocaleTimeString();bj("\nplayer: ".concat(n," - added\nplayer time: ").concat(a,"\nhost time: ").concat(v,"\n\n")),$.style.width=i.style.width="".concat(d/2,"px"),$.style.height=i.style.height="".concat(y/2,"px"),i.width=d/2,i.height=y/2,c=TL(i.getContext("2d"));var s=document.createElement("p");$.append(s),s.innerText=n;var u=360*Math.random(),x=(u+120*(1+Math.round(Math.random())))%360,G=Math.round(Math.random())?"linear-gradient(hsl(".concat(u,", 80%, 50%), hsl(").concat(x,", 80%, 50%))"):"radial-gradient(circle at center, hsl(".concat(u,", 80%, 50%), hsl(").concat(x,", 80%, 50%))");return $.style.background=G,void o.send(JSON.stringify({bkgd:G}))}var p=dp(Sw(l),2),m=p[0],f=p[1],h=new ab(-f,m);h.Normalize(),h.Multiply(Qk),c.SetGravity(h),rg[t].orientation=l}),a.on("value",function(r){r&&r.val()&&o.signal(r.val())})}}),a.on("child_removed",function(r){if(r&&r.key){var e=r.key;vy(e),bj("connection: ".concat(e," - removed\n"))}})}});ok.__esModule=true;Rl.__esModule=true;$m.__esModule=true;return{"Jlv9":Hq,"d2yc":ok,"OJEJ":Rl,"Uuoh":{},"ela3":$m,"Gdyx":{}};});