parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function _g(a){return a&&a.__esModule?{d:a.default}:{d:a}}var S=this;function hm(e,r){return is(e)||$r(e,r)||Jp()}function Jp(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function $r(e,r){var t=[],a=!0,n=!1,o=void 0;try{for(var $,c=e[Symbol.iterator]();!(a=($=c.next()).done)&&(t.push($.value),!r||t.length!==r);a=!0);}catch(i){n=!0,o=i}finally{try{a||null==c.return||c.return()}finally{if(n)throw o}}return t}function is(e){if(Array.isArray(e))return e}var lb,bc,ac,e,Nc,Pa,Xg,pj,OD=false;function Sg(){throw new Error("setTimeout has not been defined")}function Ng(){throw new Error("clearTimeout has not been defined")}function Fi($){if(lb===setTimeout)return setTimeout($,0);if((lb===Sg||!lb)&&setTimeout)return lb=setTimeout,setTimeout($,0);try{return lb($,0)}catch(e){try{return lb.call(null,$,0)}catch(e){return lb.call(this,$,0)}}}function MD($){if(bc===clearTimeout)return clearTimeout($);if((bc===Ng||!bc)&&clearTimeout)return bc=clearTimeout,clearTimeout($);try{return bc($)}catch(e){try{return bc.call(null,$)}catch(e){return bc.call(this,$)}}}function KD(){Xg&&Nc&&(Xg=!1,Nc.length?Pa=Nc.concat(Pa):pj=-1,Pa.length&&Bj())}function Bj(){if(!Xg){var $=Fi(KD);Xg=!0;for(var e=Pa.length;e;){for(Nc=Pa,Pa=[];++pj<e;)Nc&&Nc[pj].run();pj=-1,e=Pa.length}Nc=null,Xg=!1,MD($)}}function cm($,e){this.fun=$,this.array=e}function ha(){}function Zb(){if(OD)return;OD=true;ac={};e=ac={};!function(){try{lb="function"==typeof setTimeout?setTimeout:Sg}catch($){lb=Sg}try{bc="function"==typeof clearTimeout?clearTimeout:Ng}catch($){bc=Ng}}();Pa=[];Xg=!1;pj=-1;e.nextTick=function($){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Pa.push(new cm($,e)),1!==Pa.length||Xg||Fi(Bj)},cm.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=ha,e.addListener=ha,e.once=ha,e.off=ha,e.removeListener=ha,e.removeAllListeners=ha,e.emit=ha,e.prependListener=ha,e.prependOnceListener=ha,e.listeners=function($){return[]},e.binding=function($){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function($){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}}var Y={},Ch=(Zb(),ac),ID=NC;Y.log=ID;var GD=PC;Y.formatArgs=GD;var FD=LC;Y.save=FD;var ED=EC;Y.load=ED;var DD=SC;var BD,Yb,Xb,Tb,Ta,tD,rD,nD=false;function mD($){if(!(($=String($)).length>100)){var r=/^((?:\d+)?\-?\d?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec($);if(r){var a=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*rD;case"weeks":case"week":case"w":return a*tD;case"days":case"day":case"d":return a*Ta;case"hours":case"hour":case"hrs":case"hr":case"h":return a*Tb;case"minutes":case"minute":case"mins":case"min":case"m":return a*Xb;case"seconds":case"second":case"secs":case"sec":case"s":return a*Yb;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return;}}}}function jD($){var r=Math.abs($);return r>=Ta?Math.round($/Ta)+"d":r>=Tb?Math.round($/Tb)+"h":r>=Xb?Math.round($/Xb)+"m":r>=Yb?Math.round($/Yb)+"s":$+"ms"}function hD($){var r=Math.abs($);return r>=Ta?Ud($,r,Ta,"day"):r>=Tb?Ud($,r,Tb,"hour"):r>=Xb?Ud($,r,Xb,"minute"):r>=Yb?Ud($,r,Yb,"second"):$+" ms"}function Ud($,r,a,s){var e=r>=1.5*a;return Math.round($/a)+" "+s+(e?"s":"")}function dD(){if(nD)return;nD=true;BD={};Yb=1e3;Xb=60*Yb;Tb=60*Xb;Ta=24*Tb;tD=7*Ta;rD=365.25*Ta;BD=function($,r){r=r||{};var a=typeof $;if("string"===a&&$.length>0)return mD($);if("number"===a&&!1===isNaN($))return r.long?hD($):jD($);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify($))}}var bD={};function YC(e){function n(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]}function t(e){let o;function a(...e){if(!a.enabled)return;const n=a,s=Number(new Date),r=s-(o||s);n.diff=r,n.prev=o,n.curr=s,o=s,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let i=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(s,r)=>{if("%%"===s)return s;i++;const o=t.formatters[r];if("function"==typeof o){const t=e[i];s=o.call(n,t),e.splice(i,1),i--}return s}),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.enabled=t.enabled(e),a.useColors=t.useColors(),a.color=n(e),a.destroy=s,a.extend=r,"function"==typeof t.init&&t.init(a),t.instances.push(a),a}function s(){const e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}function r(e,n){return t(this.namespace+(void 0===n?":":n)+e)}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const s=("string"==typeof e?e:"").split(/[\s,]+/),r=s.length;for(n=0;n<r;n++)s[n]&&("-"===(e=s[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){const e=t.instances[n];e.enabled=t.enabled(e.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,s;for(n=0,s=t.skips.length;n<s;n++)if(t.skips[n].test(e))return!1;for(n=0,s=t.names.length;n<s;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=(dD(),BD),Object.keys(e).forEach(n=>{t[n]=e[n]}),t.instances=[],t.names=[],t.skips=[],t.formatters={},t.selectColor=n,t.enable(t.load()),t}bD=YC;Y.useColors=DD;var hd=BC();Y.storage=hd;var WC=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function SC(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function PC(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Y.humanize(this.diff),!this.useColors)return;const o="color: "+this.color;e.splice(1,0,o,"color: inherit");let r=0,t=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(r++,"%c"===e&&(t=r))}),e.splice(t,0,o)}function NC(...e){return"object"==typeof console&&console.log&&console.log(...e)}function LC(e){try{e?hd.setItem("debug",e):hd.removeItem("debug")}catch(o){}}function EC(){let e;try{e=hd.getItem("debug")}catch(o){}return!e&&void 0!==Ch&&"env"in Ch&&(e=void 0),e}function BC(){try{return localStorage}catch(e){}}Y.colors=WC,Y=bD(Y);const{formatters:Yl}=Y;Yl.j=function(e){try{return JSON.stringify(e)}catch(o){return"[UnexpectedJSONParseError]: "+o.message}};var $l={};$l=function(){if("undefined"==typeof window)return null;var n={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return n.RTCPeerConnection?n:null};var Qb,AC=false;function Pb(){if(AC)return;AC=true;Qb={};Qb="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}}var Dd,tC,kC,hC,aC=false;function uh($){var r=$.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=$.indexOf("=");return-1===p&&(p=r),[p,p===r?0:4-p%4]}function ZB($){var r=uh($),p=r[0],o=r[1];return 3*(p+o)/4-o}function YB($,r,p){return 3*(r+p)/4-p}function VB($){for(var r,p=uh($),o=p[0],e=p[1],y=new $yh9p$var$Arr(YB($,o,e)),h=0,a=e>0?o-4:o,t=0;t<a;t+=4)r=$yh9p$var$revLookup[$.charCodeAt(t)]<<18|$yh9p$var$revLookup[$.charCodeAt(t+1)]<<12|$yh9p$var$revLookup[$.charCodeAt(t+2)]<<6|$yh9p$var$revLookup[$.charCodeAt(t+3)],y[h++]=r>>16&255,y[h++]=r>>8&255,y[h++]=255&r;return 2===e&&(r=$yh9p$var$revLookup[$.charCodeAt(t)]<<2|$yh9p$var$revLookup[$.charCodeAt(t+1)]>>4,y[h++]=255&r),1===e&&(r=$yh9p$var$revLookup[$.charCodeAt(t)]<<10|$yh9p$var$revLookup[$.charCodeAt(t+1)]<<4|$yh9p$var$revLookup[$.charCodeAt(t+2)]>>2,y[h++]=r>>8&255,y[h++]=255&r),y}function PB($){return $yh9p$var$lookup[$>>18&63]+$yh9p$var$lookup[$>>12&63]+$yh9p$var$lookup[$>>6&63]+$yh9p$var$lookup[63&$]}function GB($,r,p){for(var o,e=[],y=r;y<p;y+=3)o=($[y]<<16&16711680)+($[y+1]<<8&65280)+(255&$[y+2]),e.push(PB(o));return e.join("")}function DB($){for(var r,p=$.length,o=p%3,e=[],y=0,h=p-o;y<h;y+=16383)e.push(GB($,y,y+16383>h?h:y+16383));return 1===o?(r=$[p-1],e.push($yh9p$var$lookup[r>>2]+$yh9p$var$lookup[r<<4&63]+"==")):2===o&&(r=($[p-2]<<8)+$[p-1],e.push($yh9p$var$lookup[r>>10]+$yh9p$var$lookup[r>>4&63]+$yh9p$var$lookup[r<<2&63]+"=")),e.join("")}function CB(){if(aC)return;aC=true;Dd={};tC=ZB;Dd.byteLength=tC;kC=VB;Dd.toByteArray=kC;hC=DB;Dd.fromByteArray=hC;for(var $yh9p$var$lookup=[],$yh9p$var$revLookup=[],$yh9p$var$Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,$yh9p$var$code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$yh9p$var$i=0,$yh9p$var$len=$yh9p$var$code.length;$yh9p$var$i<$yh9p$var$len;++$yh9p$var$i)$yh9p$var$lookup[$yh9p$var$i]=$yh9p$var$code[$yh9p$var$i],$yh9p$var$revLookup[$yh9p$var$code.charCodeAt($yh9p$var$i)]=$yh9p$var$i;$yh9p$var$revLookup["-".charCodeAt(0)]=62,$yh9p$var$revLookup["_".charCodeAt(0)]=63}var zg,zB,tB,nB=false;function lB(){if(nB)return;nB=true;zg={};zB=function(t,r,o,a,$){var e,p,J=8*$-a-1,N=(1<<J)-1,h=N>>1,M=-7,w=o?$-1:0,f=o?-1:1,i=t[r+w];for(w+=f,e=i&(1<<-M)-1,i>>=-M,M+=J;M>0;e=256*e+t[r+w],w+=f,M-=8);for(p=e&(1<<-M)-1,e>>=-M,M+=a;M>0;p=256*p+t[r+w],w+=f,M-=8);if(0===e)e=1-h;else{if(e===N)return p?NaN:1/0*(i?-1:1);p+=Math.pow(2,a),e-=h}return(i?-1:1)*p*Math.pow(2,e-a)};zg.read=zB;tB=function(t,r,o,a,$,e){var p,J,N,h=8*e-$-1,M=(1<<h)-1,w=M>>1,f=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,i=a?0:e-1,g=a?1:-1,s=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(J=isNaN(r)?1:0,p=M):(p=Math.floor(Math.log(r)/Math.LN2),r*(N=Math.pow(2,-p))<1&&(p--,N*=2),(r+=p+w>=1?f/N:f*Math.pow(2,1-w))*N>=2&&(p++,N/=2),p+w>=M?(J=0,p=M):p+w>=1?(J=(r*N-1)*Math.pow(2,$),p+=w):(J=r*Math.pow(2,w-1)*Math.pow(2,$),p=0));$>=8;t[o+i]=255&J,i+=g,J/=256,$-=8);for(p=p<<$|J,h+=$;h>0;t[o+i]=255&p,i+=g,p/=256,h-=8);t[o+i-g]|=128*s};zg.write=tB}var kB,jB,_A=false;function $A(){if(_A)return;_A=true;kB={};jB={}.toString;kB=Array.isArray||function(r){return"[object Array]"==jB.call(r)}}var ya,qg,Mb,Jj,WA,UA,qk,SA,Dk,QA,PA=false;function OA(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===r.foo()&&"function"==typeof r.subarray&&0===r.subarray(1,1).byteLength}catch(e){return!1}}function Gd(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function wa(r,e){if(Gd()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(r=new Uint8Array(e)).__proto__=c.prototype:(null===r&&(r=new c(e)),r.length=e),r}function c(r,e,t){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(r,e,t);if("number"==typeof r){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return pg(this,r)}return Ql(this,r,e,t)}function Ql(r,e,t,$){if("number"==typeof e)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?LA(r,e,t,$):"string"==typeof e?MA(r,e,t):FA(r,e)}function Vl(r){if("number"!=typeof r)throw new TypeError("\"size\" argument must be a number");if(r<0)throw new RangeError("\"size\" argument must not be negative")}function NA(r,e,t,$){return Vl(e),e<=0?wa(r,e):void 0!==t?"string"==typeof $?wa(r,e).fill(t,$):wa(r,e).fill(t):wa(r,e)}function pg(r,e){if(Vl(e),r=wa(r,e<0?0:0|mg(e)),!c.TYPED_ARRAY_SUPPORT)for(var t=0;t<e;++t)r[t]=0;return r}function MA(r,e,t){if("string"==typeof t&&""!==t||(t="utf8"),!c.isEncoding(t))throw new TypeError("\"encoding\" must be a valid string encoding");var $=0|tm(e,t),n=(r=wa(r,$)).write(e,t);return n!==$&&(r=r.slice(0,n)),r}function og(r,e){var t=e.length<0?0:0|mg(e.length);r=wa(r,t);for(var $=0;$<t;$+=1)r[$]=255&e[$];return r}function LA(r,e,t,$){if(e.byteLength,t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+($||0))throw new RangeError("'length' is out of bounds");return e=void 0===t&&void 0===$?new Uint8Array(e):void 0===$?new Uint8Array(e,t):new Uint8Array(e,t,$),c.TYPED_ARRAY_SUPPORT?(r=e).__proto__=c.prototype:r=og(r,e),r}function FA(r,e){if(c.isBuffer(e)){var t=0|mg(e.length);return 0===(r=wa(r,t)).length?r:(e.copy(r,0,0,t),r)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||wz(e.length)?wa(r,0):og(r,e);if("Buffer"===e.type&&Jj(e.data))return og(r,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function mg(r){if(r>=Gd())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Gd().toString(16)+" bytes");return 0|r}function DA(r){return+r!=r&&(r=0),c.alloc(+r)}function tm(r,e){if(c.isBuffer(r))return r.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer))return r.byteLength;"string"!=typeof r&&(r=""+r);var t=r.length;if(0===t)return 0;for(var $=!1;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":case void 0:return zd(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t;case"hex":return t>>>1;case"base64":return Bi(r).length;default:if($)return zd(r).length;e=(""+e).toLowerCase(),$=!0;}}function zA(r,e,t){var $=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===t||t>this.length)&&(t=this.length),t<=0)return"";if((t>>>=0)<=(e>>>=0))return"";for(r||(r="utf8");;)switch(r){case"hex":return Tz(this,e,t);case"utf8":case"utf-8":return gh(this,e,t);case"ascii":return Zz(this,e,t);case"latin1":case"binary":return Wz(this,e,t);case"base64":return gA(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Mz(this,e,t);default:if($)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),$=!0;}}function Ka(r,e,t){var $=r[e];r[e]=r[t],r[t]=$}function xm(r,e,t,$,n){if(0===r.length)return-1;if("string"==typeof t?($=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,isNaN(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0){if(!n)return-1;t=0}if("string"==typeof e&&(e=c.from(e,$)),c.isBuffer(e))return 0===e.length?-1:Fm(r,e,t,$,n);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Fm(r,[e],t,$,n);throw new TypeError("val must be string, number or Buffer")}function Fm(r,e,t,$,n){var s,f=1,h=r.length,a=e.length;if(void 0!==$&&("ucs2"===($=String($).toLowerCase())||"ucs-2"===$||"utf16le"===$||"utf-16le"===$)){if(r.length<2||e.length<2)return-1;f=2,h/=2,a/=2,t/=2}function i(r,e){return 1===f?r[e]:r.readUInt16BE(e*f)}if(n){var o=-1;for(s=t;s<h;s++)if(i(r,s)===i(e,-1===o?0:s-o)){if(-1===o&&(o=s),s-o+1===a)return o*f}else-1!==o&&(s-=s-o),o=-1}else for(t+a>h&&(t=h-a),s=t;s>=0;s--){for(var u=!0,d=0;d<a;d++)if(i(r,s+d)!==i(e,d)){u=!1;break}if(u)return s}return-1}function yA(r,e,t,$){t=Number(t)||0;var n=r.length-t;$?($=Number($))>n&&($=n):$=n;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");$>s/2&&($=s/2);for(var f=0;f<$;++f){var h=parseInt(e.substr(2*f,2),16);if(isNaN(h))return f;r[t+f]=h}return f}function wA(r,e,t,$){return Fd(zd(e,r.length-t),r,t,$)}function Um(r,e,t,$){return Fd(Az(e),r,t,$)}function tA(r,e,t,$){return Um(r,e,t,$)}function rA(r,e,t,$){return Fd(Bi(e),r,t,$)}function oA(r,e,t,$){return Fd(yz(e,r.length-t),r,t,$)}function gA(r,e,t){return 0===e&&t===r.length?qg.fromByteArray(r):qg.fromByteArray(r.slice(e,t))}function gh(r,e,t){t=Math.min(r.length,t);for(var $=[],n=e;n<t;){var s,f,h,a,i=r[n],o=null,u=i>239?4:i>223?3:i>191?2:1;if(n+u<=t)switch(u){case 1:i<128&&(o=i);break;case 2:128==(192&(s=r[n+1]))&&(a=(31&i)<<6|63&s)>127&&(o=a);break;case 3:s=r[n+1],f=r[n+2],128==(192&s)&&128==(192&f)&&(a=(15&i)<<12|(63&s)<<6|63&f)>2047&&(a<55296||a>57343)&&(o=a);break;case 4:s=r[n+1],f=r[n+2],h=r[n+3],128==(192&s)&&128==(192&f)&&128==(192&h)&&(a=(15&i)<<18|(63&s)<<12|(63&f)<<6|63&h)>65535&&a<1114112&&(o=a);}null===o?(o=65533,u=1):o>65535&&(o-=65536,$.push(o>>>10&1023|55296),o=56320|1023&o),$.push(o),n+=u}return aA($)}function aA(r){var e=r.length;if(e<=Dk)return String.fromCharCode.apply(String,r);for(var t="",$=0;$<e;)t+=String.fromCharCode.apply(String,r.slice($,$+=Dk));return t}function Zz(r,e,t){var $="";t=Math.min(r.length,t);for(var n=e;n<t;++n)$+=String.fromCharCode(127&r[n]);return $}function Wz(r,e,t){var $="";t=Math.min(r.length,t);for(var n=e;n<t;++n)$+=String.fromCharCode(r[n]);return $}function Tz(r,e,t){var $=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>$)&&(t=$);for(var n="",s=e;s<t;++s)n+=Cz(r[s]);return n}function Mz(r,e,t){for(var $=r.slice(e,t),n="",s=0;s<$.length;s+=2)n+=String.fromCharCode($[s]+256*$[s+1]);return n}function y(r,e,t){if(r%1!=0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}function O(r,e,t,$,n,s){if(!c.isBuffer(r))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(e>n||e<s)throw new RangeError("\"value\" argument is out of bounds");if(t+$>r.length)throw new RangeError("Index out of range")}function wd(r,e,t,$){e<0&&(e=65535+e+1);for(var n=0,s=Math.min(r.length-t,2);n<s;++n)r[t+n]=(e&255<<8*($?n:1-n))>>>8*($?n:1-n)}function xd(r,e,t,$){e<0&&(e=4294967295+e+1);for(var n=0,s=Math.min(r.length-t,4);n<s;++n)r[t+n]=e>>>8*($?n:3-n)&255}function Sh(r,e,t,$,n,s){if(t+$>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Vh(r,e,t,$,n){return n||Sh(r,e,t,4,3.4028234663852886e38,-3.4028234663852886e38),Mb.write(r,e,t,$,23,4),t+4}function bi(r,e,t,$,n){return n||Sh(r,e,t,8,1.7976931348623157e308,-1.7976931348623157e308),Mb.write(r,e,t,$,52,8),t+8}function Iz(r){if((r=Fz(r).replace(QA,"")).length<2)return"";for(;r.length%4!=0;)r+="=";return r}function Fz(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function Cz(r){return r<16?"0"+r.toString(16):r.toString(16)}function zd(r,e){var t;e=e||1/0;for(var $=r.length,n=null,s=[],f=0;f<$;++f){if((t=r.charCodeAt(f))>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(f+1===$){(e-=3)>-1&&s.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&s.push(239,191,189),n=t;continue}t=65536+(n-55296<<10|t-56320)}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;s.push(t)}else if(t<2048){if((e-=2)<0)break;s.push(t>>6|192,63&t|128)}else if(t<65536){if((e-=3)<0)break;s.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return s}function Az(r){for(var e=[],t=0;t<r.length;++t)e.push(255&r.charCodeAt(t));return e}function yz(r,e){for(var t,$,n,s=[],f=0;f<r.length&&!((e-=2)<0);++f)$=(t=r.charCodeAt(f))>>8,n=t%256,s.push(n),s.push($);return s}function Bi(r){return qg.toByteArray(Iz(r))}function Fd(r,e,t,$){for(var n=0;n<$&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function wz(r){return r!=r}function Hd(){if(PA)return;PA=true;ya={};qg=(CB(),Dd);Mb=(lB(),zg);Jj=($A(),kB);WA=c;ya.Buffer=WA;UA=DA;ya.SlowBuffer=UA;qk=50;ya.INSPECT_MAX_BYTES=qk,c.TYPED_ARRAY_SUPPORT=void 0!==S.TYPED_ARRAY_SUPPORT?S.TYPED_ARRAY_SUPPORT:OA();SA=Gd();ya.kMaxLength=SA,c.poolSize=8192,c._augment=function(r){return r.__proto__=c.prototype,r},c.from=function(r,e,t){return Ql(null,r,e,t)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(r,e,t){return NA(null,r,e,t)},c.allocUnsafe=function(r){return pg(null,r)},c.allocUnsafeSlow=function(r){return pg(null,r)},c.isBuffer=function(r){return!(null==r||!r._isBuffer)},c.compare=function(r,e){if(!c.isBuffer(r)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(r===e)return 0;for(var t=r.length,$=e.length,n=0,s=Math.min(t,$);n<s;++n)if(r[n]!==e[n]){t=r[n],$=e[n];break}return t<$?-1:$<t?1:0},c.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},c.concat=function(r,e){if(!Jj(r))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===r.length)return c.alloc(0);var t;if(void 0===e)for(e=0,t=0;t<r.length;++t)e+=r[t].length;var $=c.allocUnsafe(e),n=0;for(t=0;t<r.length;++t){var s=r[t];if(!c.isBuffer(s))throw new TypeError("\"list\" argument must be an Array of Buffers");s.copy($,n),n+=s.length}return $},c.byteLength=tm,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var r=this.length;if(r%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<r;e+=2)Ka(this,e,e+1);return this},c.prototype.swap32=function(){var r=this.length;if(r%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<r;e+=4)Ka(this,e,e+3),Ka(this,e+1,e+2);return this},c.prototype.swap64=function(){var r=this.length;if(r%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<r;e+=8)Ka(this,e,e+7),Ka(this,e+1,e+6),Ka(this,e+2,e+5),Ka(this,e+3,e+4);return this},c.prototype.toString=function(){var r=0|this.length;return 0===r?"":0===arguments.length?gh(this,0,r):zA.apply(this,arguments)},c.prototype.equals=function(r){if(!c.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r||0===c.compare(this,r)},c.prototype.inspect=function(){var r="",e=qk;return this.length>0&&(r=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(r+=" ... ")),"<Buffer "+r+">"},c.prototype.compare=function(r,e,t,$,n){if(!c.isBuffer(r))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===t&&(t=r?r.length:0),void 0===$&&($=0),void 0===n&&(n=this.length),e<0||t>r.length||$<0||n>this.length)throw new RangeError("out of range index");if($>=n&&e>=t)return 0;if($>=n)return-1;if(e>=t)return 1;if(this===r)return 0;for(var s=(n>>>=0)-($>>>=0),f=(t>>>=0)-(e>>>=0),h=Math.min(s,f),a=this.slice($,n),i=r.slice(e,t),o=0;o<h;++o)if(a[o]!==i[o]){s=a[o],f=i[o];break}return s<f?-1:f<s?1:0},c.prototype.includes=function(r,e,t){return-1!==this.indexOf(r,e,t)},c.prototype.indexOf=function(r,e,t){return xm(this,r,e,t,!0)},c.prototype.lastIndexOf=function(r,e,t){return xm(this,r,e,t,!1)},c.prototype.write=function(r,e,t,$){if(void 0===e)$="utf8",t=this.length,e=0;else if(void 0===t&&"string"==typeof e)$=e,t=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(t)?(t|=0,void 0===$&&($="utf8")):($=t,t=void 0)}var n=this.length-e;if((void 0===t||t>n)&&(t=n),r.length>0&&(t<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");$||($="utf8");for(var s=!1;;)switch($){case"hex":return yA(this,r,e,t);case"utf8":case"utf-8":return wA(this,r,e,t);case"ascii":return Um(this,r,e,t);case"latin1":case"binary":return tA(this,r,e,t);case"base64":return rA(this,r,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oA(this,r,e,t);default:if(s)throw new TypeError("Unknown encoding: "+$);$=(""+$).toLowerCase(),s=!0;}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};Dk=4096;c.prototype.slice=function(r,e){var t,$=this.length;if((r=~~r)<0?(r+=$)<0&&(r=0):r>$&&(r=$),(e=void 0===e?$:~~e)<0?(e+=$)<0&&(e=0):e>$&&(e=$),e<r&&(e=r),c.TYPED_ARRAY_SUPPORT)(t=this.subarray(r,e)).__proto__=c.prototype;else{var n=e-r;t=new c(n,void 0);for(var s=0;s<n;++s)t[s]=this[s+r]}return t},c.prototype.readUIntLE=function(r,e,t){r|=0,e|=0,t||y(r,e,this.length);for(var $=this[r],n=1,s=0;++s<e&&(n*=256);)$+=this[r+s]*n;return $},c.prototype.readUIntBE=function(r,e,t){r|=0,e|=0,t||y(r,e,this.length);for(var $=this[r+--e],n=1;e>0&&(n*=256);)$+=this[r+--e]*n;return $},c.prototype.readUInt8=function(r,e){return e||y(r,1,this.length),this[r]},c.prototype.readUInt16LE=function(r,e){return e||y(r,2,this.length),this[r]|this[r+1]<<8},c.prototype.readUInt16BE=function(r,e){return e||y(r,2,this.length),this[r]<<8|this[r+1]},c.prototype.readUInt32LE=function(r,e){return e||y(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+16777216*this[r+3]},c.prototype.readUInt32BE=function(r,e){return e||y(r,4,this.length),16777216*this[r]+(this[r+1]<<16|this[r+2]<<8|this[r+3])},c.prototype.readIntLE=function(r,e,t){r|=0,e|=0,t||y(r,e,this.length);for(var $=this[r],n=1,s=0;++s<e&&(n*=256);)$+=this[r+s]*n;return $>=(n*=128)&&($-=Math.pow(2,8*e)),$},c.prototype.readIntBE=function(r,e,t){r|=0,e|=0,t||y(r,e,this.length);for(var $=e,n=1,s=this[r+--$];$>0&&(n*=256);)s+=this[r+--$]*n;return s>=(n*=128)&&(s-=Math.pow(2,8*e)),s},c.prototype.readInt8=function(r,e){return e||y(r,1,this.length),128&this[r]?-1*(255-this[r]+1):this[r]},c.prototype.readInt16LE=function(r,e){e||y(r,2,this.length);var t=this[r]|this[r+1]<<8;return 32768&t?4294901760|t:t},c.prototype.readInt16BE=function(r,e){e||y(r,2,this.length);var t=this[r+1]|this[r]<<8;return 32768&t?4294901760|t:t},c.prototype.readInt32LE=function(r,e){return e||y(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},c.prototype.readInt32BE=function(r,e){return e||y(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},c.prototype.readFloatLE=function(r,e){return e||y(r,4,this.length),Mb.read(this,r,!0,23,4)},c.prototype.readFloatBE=function(r,e){return e||y(r,4,this.length),Mb.read(this,r,!1,23,4)},c.prototype.readDoubleLE=function(r,e){return e||y(r,8,this.length),Mb.read(this,r,!0,52,8)},c.prototype.readDoubleBE=function(r,e){return e||y(r,8,this.length),Mb.read(this,r,!1,52,8)},c.prototype.writeUIntLE=function(r,e,t,$){(r=+r,e|=0,t|=0,$)||O(this,r,e,t,Math.pow(2,8*t)-1,0);var n=1,s=0;for(this[e]=255&r;++s<t&&(n*=256);)this[e+s]=r/n&255;return e+t},c.prototype.writeUIntBE=function(r,e,t,$){(r=+r,e|=0,t|=0,$)||O(this,r,e,t,Math.pow(2,8*t)-1,0);var n=t-1,s=1;for(this[e+n]=255&r;--n>=0&&(s*=256);)this[e+n]=r/s&255;return e+t},c.prototype.writeUInt8=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(r=Math.floor(r)),this[e]=255&r,e+1},c.prototype.writeUInt16LE=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&r,this[e+1]=r>>>8):wd(this,r,e,!0),e+2},c.prototype.writeUInt16BE=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=r>>>8,this[e+1]=255&r):wd(this,r,e,!1),e+2},c.prototype.writeUInt32LE=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=r>>>24,this[e+2]=r>>>16,this[e+1]=r>>>8,this[e]=255&r):xd(this,r,e,!0),e+4},c.prototype.writeUInt32BE=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=r>>>24,this[e+1]=r>>>16,this[e+2]=r>>>8,this[e+3]=255&r):xd(this,r,e,!1),e+4},c.prototype.writeIntLE=function(r,e,t,$){if(r=+r,e|=0,!$){var n=Math.pow(2,8*t-1);O(this,r,e,t,n-1,-n)}var s=0,f=1,h=0;for(this[e]=255&r;++s<t&&(f*=256);)r<0&&0===h&&0!==this[e+s-1]&&(h=1),this[e+s]=(r/f>>0)-h&255;return e+t},c.prototype.writeIntBE=function(r,e,t,$){if(r=+r,e|=0,!$){var n=Math.pow(2,8*t-1);O(this,r,e,t,n-1,-n)}var s=t-1,f=1,h=0;for(this[e+s]=255&r;--s>=0&&(f*=256);)r<0&&0===h&&0!==this[e+s+1]&&(h=1),this[e+s]=(r/f>>0)-h&255;return e+t},c.prototype.writeInt8=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(r=Math.floor(r)),r<0&&(r=255+r+1),this[e]=255&r,e+1},c.prototype.writeInt16LE=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&r,this[e+1]=r>>>8):wd(this,r,e,!0),e+2},c.prototype.writeInt16BE=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=r>>>8,this[e+1]=255&r):wd(this,r,e,!1),e+2},c.prototype.writeInt32LE=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&r,this[e+1]=r>>>8,this[e+2]=r>>>16,this[e+3]=r>>>24):xd(this,r,e,!0),e+4},c.prototype.writeInt32BE=function(r,e,t){return r=+r,e|=0,t||O(this,r,e,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),c.TYPED_ARRAY_SUPPORT?(this[e]=r>>>24,this[e+1]=r>>>16,this[e+2]=r>>>8,this[e+3]=255&r):xd(this,r,e,!1),e+4},c.prototype.writeFloatLE=function(r,e,t){return Vh(this,r,e,!0,t)},c.prototype.writeFloatBE=function(r,e,t){return Vh(this,r,e,!1,t)},c.prototype.writeDoubleLE=function(r,e,t){return bi(this,r,e,!0,t)},c.prototype.writeDoubleBE=function(r,e,t){return bi(this,r,e,!1,t)},c.prototype.copy=function(r,e,t,$){if(t||(t=0),$||0===$||($=this.length),e>=r.length&&(e=r.length),e||(e=0),$>0&&$<t&&($=t),$===t)return 0;if(0===r.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if($<0)throw new RangeError("sourceEnd out of bounds");$>this.length&&($=this.length),r.length-e<$-t&&($=r.length-e+t);var n,s=$-t;if(this===r&&t<e&&e<$)for(n=s-1;n>=0;--n)r[n+e]=this[n+t];else if(s<1e3||!c.TYPED_ARRAY_SUPPORT)for(n=0;n<s;++n)r[n+e]=this[n+t];else Uint8Array.prototype.set.call(r,this.subarray(t,t+s),e);return s},c.prototype.fill=function(r,e,t,$){if("string"==typeof r){if("string"==typeof e?($=e,e=0,t=this.length):"string"==typeof t&&($=t,t=this.length),1===r.length){var n=r.charCodeAt(0);n<256&&(r=n)}if(void 0!==$&&"string"!=typeof $)throw new TypeError("encoding must be a string");if("string"==typeof $&&!c.isEncoding($))throw new TypeError("Unknown encoding: "+$)}else"number"==typeof r&&(r&=255);if(e<0||this.length<e||this.length<t)throw new RangeError("Out of range index");if(t<=e)return this;var s;if(e>>>=0,t=void 0===t?this.length:t>>>0,r||(r=0),"number"==typeof r)for(s=e;s<t;++s)this[s]=r;else{var f=c.isBuffer(r)?r:zd(new c(r,$).toString()),h=f.length;for(s=0;s<t-e;++s)this[s+e]=f[s%h]}return this};QA=/[^+\/0-9A-Za-z-_]/g}var Wa,Md,ma,vz=false;function Ui(r,$){for(var f in r)$[f]=r[f]}function Fb(r,$,f){return ma(r,$,f)}function dc(){if(vz)return;vz=true;Wa={};Md=(Hd(),ya);ma=Md.Buffer;if(ma.from&&ma.alloc&&ma.allocUnsafe&&ma.allocUnsafeSlow)Wa=Md;else{Ui(Md,Wa);var $Wu$export$Buffer=Fb;Wa.Buffer=$Wu$export$Buffer}Ui(ma,Fb),Fb.from=function(r,$,f){if("number"==typeof r)throw new TypeError("Argument must not be a number");return ma(r,$,f)},Fb.alloc=function(r,$,f){if("number"!=typeof r)throw new TypeError("Argument must be a number");var u=ma(r);return void 0!==$?"string"==typeof f?u.fill($,f):u.fill($):u.fill(0),u},Fb.allocUnsafe=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return ma(r)},Fb.allocUnsafeSlow=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return Md.SlowBuffer(r)}}var hj={},uz=(Zb(),ac);function sz(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}var rz=(dc(),Wa).Buffer,eg=S.crypto||S.msCrypto;function jz(r,e){if(r>65536)throw new Error("requested too many random bytes");var $=new S.Uint8Array(r);r>0&&eg.getRandomValues($);var o=rz.from($.buffer);return"function"==typeof e?uz.nextTick(function(){e(null,o)}):o}hj=eg&&eg.getRandomValues?jz:sz;var ce,ea,hz=false;function ez(r,e,$,n){if("function"!=typeof r)throw new TypeError("\"callback\" argument must be a function");var c,v,s=arguments.length;switch(s){case 0:case 1:return ea.nextTick(r);case 2:return ea.nextTick(function(){r.call(null,e)});case 3:return ea.nextTick(function(){r.call(null,e,$)});case 4:return ea.nextTick(function(){r.call(null,e,$,n)});default:for(c=new Array(s-1),v=0;v<c.length;)c[v++]=arguments[v];return ea.nextTick(function(){r.apply(null,c)});}}function Zc(){if(hz)return;hz=true;ce={};ea=(Zb(),ac);ce=!ea.version||0===ea.version.indexOf("v0.")||0===ea.version.indexOf("v1.")&&0!==ea.version.indexOf("v1.8.")?{nextTick:ez}:ea}var cz,az,$y=false;function Zy(){if($y)return;$y=true;cz={};az={}.toString;cz=Array.isArray||function(r){return"[object Array]"==az.call(r)}}var jk,Xy=false;function v(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function ja(e){return"function"==typeof e}function Ty(e){return"number"==typeof e}function Kc(e){return"object"==typeof e&&null!==e}function vk(e){return void 0===e}function yk(){if(Xy)return;Xy=true;jk={};jk=v,v.EventEmitter=v,v.prototype._events=void 0,v.prototype._maxListeners=void 0,v.defaultMaxListeners=10,v.prototype.setMaxListeners=function(e){if(!Ty(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},v.prototype.emit=function(e){var t,r,i,n,s,v;if(this._events||(this._events={}),"error"===e&&(!this._events.error||Kc(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var o=new Error("Uncaught, unspecified \"error\" event. ("+t+")");throw o.context=t,o}if(vk(r=this._events[e]))return!1;if(ja(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),r.apply(this,n);}else if(Kc(r))for(n=Array.prototype.slice.call(arguments,1),i=(v=r.slice()).length,s=0;s<i;s++)v[s].apply(this,n);return!0},v.prototype.addListener=function(e,t){var r;if(!ja(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,ja(t.listener)?t.listener:t),this._events[e]?Kc(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,Kc(this._events[e])&&!this._events[e].warned&&(r=vk(this._maxListeners)?v.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},v.prototype.on=v.prototype.addListener,v.prototype.once=function(e,t){if(!ja(t))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},v.prototype.removeListener=function(e,t){var r,i,n,s;if(!ja(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=(r=this._events[e]).length,i=-1,r===t||ja(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(Kc(r)){for(s=n;s-->0;)if(r[s]===t||r[s].listener&&r[s].listener===t){i=s;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},v.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(ja(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},v.prototype.listeners=function(e){return this._events&&this._events[e]?ja(this._events[e])?[this._events[e]]:this._events[e].slice():[]},v.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(ja(t))return 1;if(t)return t.length}return 0},v.listenerCount=function(e,t){return e.listenerCount(t)}}var Ak,Ry=false;function Ek(){if(Ry)return;Ry=true;Ak={};Ak=(yk(),jk).EventEmitter}var r,Py,Ny,Ly,Iy,Fy,Cy,Ay,yy,wy,uy,sy,qy,ny,ly,jy,hy,fy=false;function dy($){return Array.isArray?Array.isArray($):"[object Array]"===Sd($)}function ay($){return"boolean"==typeof $}function _x($){return null===$}function Zx($){return null==$}function Yx($){return"number"==typeof $}function Xx($){return"string"==typeof $}function Wx($){return"symbol"==typeof $}function Vx($){return void 0===$}function Qx($){return"[object RegExp]"===Sd($)}function Px($){return"object"==typeof $&&null!==$}function Ox($){return"[object Date]"===Sd($)}function Nx($){return"[object Error]"===Sd($)||$ instanceof Error}function Mx($){return"function"==typeof $}function Lx($){return null===$||"boolean"==typeof $||"number"==typeof $||"string"==typeof $||"symbol"==typeof $||void 0===$}function Sd($){return Object.prototype.toString.call($)}function Bc(){if(fy)return;fy=true;r={};Py=(Hd(),ya).Buffer;Ny=dy;r.isArray=Ny;Ly=ay;r.isBoolean=Ly;Iy=_x;r.isNull=Iy;Fy=Zx;r.isNullOrUndefined=Fy;Cy=Yx;r.isNumber=Cy;Ay=Xx;r.isString=Ay;yy=Wx;r.isSymbol=yy;wy=Vx;r.isUndefined=wy;uy=Qx;r.isRegExp=uy;sy=Px;r.isObject=sy;qy=Ox;r.isDate=qy;ny=Nx;r.isError=ny;ly=Mx;r.isFunction=ly;jy=Lx;r.isPrimitive=jy;hy=Py.isBuffer;r.isBuffer=hy}var Jx=false;function mm(){if(Jx)return;Jx=true}var om,sm,Ac,Gx=false;function Fx(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Dx(t,e,a){t.copy(e,a)}function Bx(){if(Gx)return;Gx=true;om={};sm=(dc(),Wa).Buffer;Ac=(mm(),{});om=function(){function t(){Fx(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},t.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},t.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,a=""+e.data;e=e.next;)a+=t+e.data;return a},t.prototype.concat=function(t){if(0===this.length)return sm.alloc(0);if(1===this.length)return this.head.data;for(var e=sm.allocUnsafe(t>>>0),a=this.head,i=0;a;)Dx(a.data,e,i),i+=a.data.length,a=a.next;return e},t}(),Ac&&Ac.inspect&&Ac.inspect.custom&&(om.prototype[Ac.inspect.custom]=function(){var t=Ac.inspect({length:this.length});return this.constructor.name+" "+t})}var Cm,Em,Ax=false;function xx(t,e){var r=this,a=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return a||i?(e?e(t):!t||this._writableState&&this._writableState.errorEmitted||Em.nextTick(Pm,this,t),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?(Em.nextTick(Pm,r,t),r._writableState&&(r._writableState.errorEmitted=!0)):e&&e(t)}),this)}function wx(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Pm(t,e){t.emit("error",e)}function Qm(){if(Ax)return;Ax=true;Cm={};Em=(Zc(),ce);Cm={destroy:xx,undestroy:wx}}var vx,ux=false;function sx(r,o){if(Nf("noDeprecation"))return r;var e=!1;return function(){if(!e){if(Nf("throwDeprecation"))throw new Error(o);Nf("traceDeprecation")?console.trace(o):console.warn(o),e=!0}return r.apply(this,arguments)}}function Nf(r){try{if(!S.localStorage)return!1}catch(e){return!1}var o=S.localStorage[r];return null!=o&&"true"===String(o).toLowerCase()}function rx(){if(ux)return;ux=true;vx={};vx=sx}var ch,dh,eb,fd,qx,ih,px,kh,md,ox,ph,qh,nx=false;function th(e){var r=this;this.next=null,this.entry=null,this.finish=function(){tw(r,e)}}function mx(e){return md.from(e)}function lx(e){return md.isBuffer(e)||e instanceof ox}function jx(){}function Ic(e,r){fd=fd||(nb(),ob),e=e||{};var t=r instanceof fd;this.objectMode=!!e.objectMode,t&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,n=e.writableHighWaterMark,a=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:t&&(n||0===n)?n:a,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=!1===e.decodeStrings;this.decodeStrings=!$,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){zw(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new th(this)}function n(e){if(fd=fd||(nb(),ob),!(ph.call(n,this)||this instanceof fd))return new n(e);this._writableState=new Ic(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),kh.call(this)}function hx(e,r){var t=new Error("write after end");e.emit("error",t),eb.nextTick(r,t)}function cx(e,r,t,i){var n=!0,a=!1;return null===t?a=new TypeError("May not write null values to stream"):"string"==typeof t||void 0===t||r.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),eb.nextTick(i,a),n=!1),n}function bx(e,r,t){return e.objectMode||!1===e.decodeStrings||"string"!=typeof r||(r=md.from(r,t)),r}function ax(e,r,t,i,n,a){if(!t){var $=bx(r,i,n);i!==$&&(t=!0,n="buffer",i=$)}var o=r.objectMode?1:i.length;r.length+=o;var s=r.length<r.highWaterMark;if(s||(r.needDrain=!0),r.writing||r.corked){var f=r.lastBufferedRequest;r.lastBufferedRequest={chunk:i,encoding:n,isBuf:t,callback:a,next:null},f?f.next=r.lastBufferedRequest:r.bufferedRequest=r.lastBufferedRequest,r.bufferedRequestCount+=1}else Kf(e,r,!1,o,i,n,a);return s}function Kf(e,r,t,i,n,a,$){r.writelen=i,r.writecb=$,r.writing=!0,r.sync=!0,t?e._writev(n,r.onwrite):e._write(n,a,r.onwrite),r.sync=!1}function Tw(e,r,t,i,n){--r.pendingcb,t?(eb.nextTick(n,i),eb.nextTick(zc,e,r),e._writableState.errorEmitted=!0,e.emit("error",i)):(n(i),e._writableState.errorEmitted=!0,e.emit("error",i),zc(e,r))}function Sw(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function zw(e,r){var t=e._writableState,i=t.sync,n=t.writecb;if(Sw(t),r)Tw(e,t,i,r,n);else{var a=ii(t);a||t.corked||t.bufferProcessing||!t.bufferedRequest||gi(e,t),i?qx(ci,e,t,a,n):ci(e,t,a,n)}}function ci(e,r,t,i){t||yw(e,r),r.pendingcb--,i(),zc(e,r)}function yw(e,r){0===r.length&&r.needDrain&&(r.needDrain=!1,e.emit("drain"))}function gi(e,r){r.bufferProcessing=!0;var t=r.bufferedRequest;if(e._writev&&t&&t.next){var i=r.bufferedRequestCount,n=new Array(i),a=r.corkedRequestsFree;a.entry=t;for(var $=0,o=!0;t;)n[$]=t,t.isBuf||(o=!1),t=t.next,$+=1;n.allBuffers=o,Kf(e,r,!0,r.length,n,"",a.finish),r.pendingcb++,r.lastBufferedRequest=null,a.next?(r.corkedRequestsFree=a.next,a.next=null):r.corkedRequestsFree=new th(r),r.bufferedRequestCount=0}else{for(;t;){var s=t.chunk,f=t.encoding,u=t.callback;if(Kf(e,r,!1,r.objectMode?1:s.length,s,f,u),t=t.next,r.bufferedRequestCount--,r.writing)break}null===t&&(r.lastBufferedRequest=null)}r.bufferedRequest=t,r.bufferProcessing=!1}function ii(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function xw(e,r){e._final(function(t){r.pendingcb--,t&&e.emit("error",t),r.prefinished=!0,e.emit("prefinish"),zc(e,r)})}function ww(e,r){r.prefinished||r.finalCalled||("function"==typeof e._final?(r.pendingcb++,r.finalCalled=!0,eb.nextTick(xw,e,r)):(r.prefinished=!0,e.emit("prefinish")))}function zc(e,r){var t=ii(r);return t&&(ww(e,r),0===r.pendingcb&&(r.finished=!0,e.emit("finish"))),t}function uw(e,r,t){r.ending=!0,zc(e,r),t&&(r.finished?eb.nextTick(t):e.once("finish",t)),r.ended=!0,e.writable=!1}function tw(e,r,t){var i=e.entry;for(e.entry=null;i;){var n=i.callback;r.pendingcb--,n(t),i=i.next}r.corkedRequestsFree?r.corkedRequestsFree.next=e:r.corkedRequestsFree=e}function ti(){if(nx)return;nx=true;ch={};dh=(Zb(),ac);eb=(Zc(),ce);ch=n;qx=!dh.browser&&["v0.10","v0.9."].indexOf(dh.version.slice(0,5))>-1?setImmediate:eb.nextTick;n.WritableState=Ic;ih=(Bc(),r);ih.inherits=(Pb(),Qb);px={deprecate:(rx(),vx)};kh=(Ek(),Ak);md=(dc(),Wa).Buffer;ox=S.Uint8Array||function(){};qh=(Qm(),Cm);ih.inherits(n,kh),Ic.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r},function(){try{Object.defineProperty(Ic.prototype,"buffer",{get:px.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(ph=Function.prototype[Symbol.hasInstance],Object.defineProperty(n,Symbol.hasInstance,{value:function(e){return!!ph.call(this,e)||this===n&&e&&e._writableState instanceof Ic}})):ph=function(e){return e instanceof this},n.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},n.prototype.write=function(e,r,t){var i=this._writableState,n=!1,a=!i.objectMode&&lx(e);return a&&!md.isBuffer(e)&&(e=mx(e)),"function"==typeof r&&(t=r,r=null),a?r="buffer":r||(r=i.defaultEncoding),"function"!=typeof t&&(t=jx),i.ended?hx(this,t):(a||cx(this,i,e,t))&&(i.pendingcb++,n=ax(this,i,a,e,r,t)),n},n.prototype.cork=function(){this._writableState.corked++},n.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||gi(this,e))},n.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(n.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),n.prototype._write=function(e,r,t){t(new Error("_write() is not implemented"))},n.prototype._writev=null,n.prototype.end=function(e,r,t){var i=this._writableState;"function"==typeof e?(t=e,e=null,r=null):"function"==typeof r&&(t=r,r=null),null!=e&&this.write(e,r),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||uw(this,i,t)},Object.defineProperty(n.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),n.prototype.destroy=qh.destroy,n.prototype._undestroy=qh.undestroy,n.prototype._destroy=function(e,r){this.end(),r(e)}}var ob,vi,sw,xi,yi,je,pw=false;function va(a){if(!(this instanceof va))return new va(a);yi.call(this,a),je.call(this,a),a&&!1===a.readable&&(this.readable=!1),a&&!1===a.writable&&(this.writable=!1),this.allowHalfOpen=!0,a&&!1===a.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",ow)}function ow(){this.allowHalfOpen||this._writableState.ended||vi.nextTick(nw,this)}function nw(a){a.end()}function nb(){if(pw)return;pw=true;ob={};vi=(Zc(),ce);sw=Object.keys||function(a){var e=[];for(var $ in a)e.push($);return e};ob=va;xi=(Bc(),r);xi.inherits=(Pb(),Qb);yi=(xk(),mj);je=(ti(),ch);xi.inherits(va,yi);for(var $Hba$var$keys=sw(je.prototype),$Hba$var$v=0;$Hba$var$v<$Hba$var$keys.length;$Hba$var$v++){var $Hba$var$method=$Hba$var$keys[$Hba$var$v];va.prototype[$Hba$var$method]||(va.prototype[$Hba$var$method]=je.prototype[$Hba$var$method])}Object.defineProperty(va.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(va.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(a){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=a,this._writableState.destroyed=a)}}),va.prototype._destroy=function(a,e){this.push(null),this.end(),vi.nextTick(e,a)}}var Ff,Ef,Ii,lw,gw=false;function ew(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0;}}function dw(t){var e=ew(t);if("string"!=typeof e&&(Ef.isEncoding===Ii||!Ii(t)))throw new Error("Unknown encoding: "+t);return e||t}function Lc(t){var e;switch(this.encoding=dw(t),this.encoding){case"utf16le":this.text=Xv,this.end=Vv,e=4;break;case"utf8":this.fillLast=_v,e=4;break;case"base64":this.text=Uv,this.end=Ov,e=3;break;default:return this.write=Nv,void(this.end=Jv);}this.lastNeed=0,this.lastTotal=0,this.lastChar=Ef.allocUnsafe(e)}function Cf(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function cw(t,e,r){var a=e.length-1;if(a<r)return 0;var s=Cf(e[a]);return s>=0?(s>0&&(t.lastNeed=s-1),s):--a<r||-2===s?0:(s=Cf(e[a]))>=0?(s>0&&(t.lastNeed=s-2),s):--a<r||-2===s?0:(s=Cf(e[a]))>=0?(s>0&&(2===s?s=0:t.lastNeed=s-3),s):0}function aw(t,e,r){if(128!=(192&e[0]))return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"\uFFFD"}}function _v(t){var e=this.lastTotal-this.lastNeed,r=aw(this,t,e);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function $v(t,e){var r=cw(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var a=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,a),t.toString("utf8",e,a)}function Zv(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function Xv(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var a=r.charCodeAt(r.length-1);if(a>=55296&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function Vv(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function Uv(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function Ov(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function Nv(t){return t.toString(this.encoding)}function Jv(t){return t&&t.length?this.write(t):""}function jj(){if(gw)return;gw=true;Ff={};Ef=(dc(),Wa).Buffer;Ii=Ef.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1;}};lw=Lc;Ff.StringDecoder=lw,Lc.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},Lc.prototype.end=Zv,Lc.prototype.text=$v,Lc.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}}var mj,nj,Ib,qj,Fv,SD,tj,tf,ic,Xm,xj,sf,w,Yc,wv,Ej,qf,Gj,vv=false;function rv(e){return ic.from(e)}function pv(e){return ic.isBuffer(e)||e instanceof Xm}function nv(e,r,a){if("function"==typeof e.prependListener)return e.prependListener(r,a);e._events&&e._events[r]?Fv(e._events[r])?e._events[r].unshift(a):e._events[r]=[a,e._events[r]]:e.on(r,a)}function Rj(e,r){e=e||{};var a=r instanceof(qj=qj||(nb(),ob));this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var t=e.highWaterMark,n=e.readableHighWaterMark,$=this.objectMode?16:16384;this.highWaterMark=t||0===t?t:a&&(n||0===n)?n:$,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new wv,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(Yc||(Yc=(jj(),Ff).StringDecoder),this.decoder=new Yc(e.encoding),this.encoding=e.encoding)}function i(e){if(qj=qj||(nb(),ob),!(this instanceof i))return new i(e);this._readableState=new Rj(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),tf.call(this)}function Tj(e,r,a,t,n){var $,i=e._readableState;null===r?(i.reading=!1,bv(e,i)):(n||($=hv(i,r)),$?e.emit("error",$):i.objectMode||r&&r.length>0?("string"==typeof r||i.objectMode||Object.getPrototypeOf(r)===ic.prototype||(r=rv(r)),t?i.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):of(e,i,r,!0):i.ended?e.emit("error",new Error("stream.push() after EOF")):(i.reading=!1,i.decoder&&!a?(r=i.decoder.write(r),i.objectMode||0!==r.length?of(e,i,r,!1):gk(e,i)):of(e,i,r,!1))):t||(i.reading=!1));return gv(i)}function of(e,r,a,t){r.flowing&&0===r.length&&!r.sync?(e.emit("data",a),e.read(0)):(r.length+=r.objectMode?1:a.length,t?r.buffer.unshift(a):r.buffer.push(a),r.needReadable&&ed(e)),gk(e,r)}function hv(e,r){var a;return pv(r)||"string"==typeof r||void 0===r||e.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a}function gv(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function fv(e){return e>=Gj?e=Gj:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function _j(e,r){return e<=0||0===r.length&&r.ended?0:r.objectMode?1:e!=e?r.flowing&&r.length?r.buffer.head.data.length:r.length:(e>r.highWaterMark&&(r.highWaterMark=fv(e)),e<=r.length?e:r.ended?r.length:(r.needReadable=!0,0))}function bv(e,r){if(!r.ended){if(r.decoder){var a=r.decoder.end();a&&a.length&&(r.buffer.push(a),r.length+=r.objectMode?1:a.length)}r.ended=!0,ed(e)}}function ed(e){var r=e._readableState;r.needReadable=!1,r.emittedReadable||(w("emitReadable",r.flowing),r.emittedReadable=!0,r.sync?Ib.nextTick(dk,e):dk(e))}function dk(e){w("emit readable"),e.emit("readable"),lf(e)}function gk(e,r){r.readingMore||(r.readingMore=!0,Ib.nextTick($u,e,r))}function $u(e,r){for(var a=r.length;!r.reading&&!r.flowing&&!r.ended&&r.length<r.highWaterMark&&(w("maybeReadMore read 0"),e.read(0),a!==r.length);)a=r.length;r.readingMore=!1}function Zu(e){return function(){var r=e._readableState;w("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,0===r.awaitDrain&&tj(e,"data")&&(r.flowing=!0,lf(e))}}function Uu(e){w("readable nexttick read 0"),e.read(0)}function Tu(e,r){r.resumeScheduled||(r.resumeScheduled=!0,Ib.nextTick(Qu,e,r))}function Qu(e,r){r.reading||(w("resume read 0"),e.read(0)),r.resumeScheduled=!1,r.awaitDrain=0,e.emit("resume"),lf(e),r.flowing&&!r.reading&&e.read(0)}function lf(e){var r=e._readableState;for(w("flow",r.flowing);r.flowing&&null!==e.read(););}function pk(e,r){return 0===r.length?null:(r.objectMode?a=r.buffer.shift():!e||e>=r.length?(a=r.decoder?r.buffer.join(""):1===r.buffer.length?r.buffer.head.data:r.buffer.concat(r.length),r.buffer.clear()):a=Pu(e,r.buffer,r.decoder),a);var a}function Pu(e,r,a){var t;return e<r.head.data.length?(t=r.head.data.slice(0,e),r.head.data=r.head.data.slice(e)):t=e===r.head.data.length?r.shift():a?Ou(e,r):Nu(e,r),t}function Ou(e,r){var a=r.head,t=1,n=a.data;for(e-=n.length;a=a.next;){var $=a.data,i=e>$.length?$.length:e;if(i===$.length?n+=$:n+=$.slice(0,e),0===(e-=i)){i===$.length?(++t,a.next?r.head=a.next:r.head=r.tail=null):(r.head=a,a.data=$.slice(i));break}++t}return r.length-=t,n}function Nu(e,r){var a=ic.allocUnsafe(e),t=r.head,n=1;for(t.data.copy(a),e-=t.data.length;t=t.next;){var $=t.data,i=e>$.length?$.length:e;if($.copy(a,a.length-e,0,i),0===(e-=i)){i===$.length?(++n,t.next?r.head=t.next:r.head=r.tail=null):(r.head=t,t.data=$.slice(i));break}++n}return r.length-=n,a}function kf(e){var r=e._readableState;if(r.length>0)throw new Error("\"endReadable()\" called on non-empty stream");r.endEmitted||(r.ended=!0,Ib.nextTick(Mu,r,e))}function Mu(e,r){e.endEmitted||0!==e.length||(e.endEmitted=!0,r.readable=!1,r.emit("end"))}function wk(e,r){for(var a=0,t=e.length;a<t;a++)if(e[a]===r)return a;return-1}function xk(){if(vv)return;vv=true;mj={};nj=(Zb(),ac);Ib=(Zc(),ce);mj=i;Fv=(Zy(),cz);i.ReadableState=Rj;SD=(yk(),jk).EventEmitter;tj=function(e,r){return e.listeners(r).length};tf=(Ek(),Ak);ic=(dc(),Wa).Buffer;Xm=S.Uint8Array||function(){};xj=(Bc(),r);xj.inherits=(Pb(),Qb);sf=(mm(),{});w=void 0;w=sf&&sf.debuglog?sf.debuglog("stream"):function(){};wv=(Bx(),om);Ej=(Qm(),Cm);xj.inherits(i,tf);qf=["error","close","destroy","pause","resume"];Object.defineProperty(i.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),i.prototype.destroy=Ej.destroy,i.prototype._undestroy=Ej.undestroy,i.prototype._destroy=function(e,r){this.push(null),r(e)},i.prototype.push=function(e,r){var a,t=this._readableState;return t.objectMode?a=!0:"string"==typeof e&&((r=r||t.defaultEncoding)!==t.encoding&&(e=ic.from(e,r),r=""),a=!0),Tj(this,e,r,!1,a)},i.prototype.unshift=function(e){return Tj(this,e,null,!0,!1)},i.prototype.isPaused=function(){return!1===this._readableState.flowing},i.prototype.setEncoding=function(e){return Yc||(Yc=(jj(),Ff).StringDecoder),this._readableState.decoder=new Yc(e),this._readableState.encoding=e,this};Gj=8388608;i.prototype.read=function(e){w("read",e),e=parseInt(e,10);var r=this._readableState,a=e;if(0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&(r.length>=r.highWaterMark||r.ended))return w("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?kf(this):ed(this),null;if(0===(e=_j(e,r))&&r.ended)return 0===r.length&&kf(this),null;var t,n=r.needReadable;return w("need readable",n),(0===r.length||r.length-e<r.highWaterMark)&&w("length less than watermark",n=!0),r.ended||r.reading?w("reading or ended",n=!1):n&&(w("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=_j(a,r))),null===(t=e>0?pk(e,r):null)?(r.needReadable=!0,e=0):r.length-=e,0===r.length&&(r.ended||(r.needReadable=!0),a!==e&&r.ended&&kf(this)),null!==t&&this.emit("data",t),t},i.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},i.prototype.pipe=function(e,r){var a=this,t=this._readableState;switch(t.pipesCount){case 0:t.pipes=e;break;case 1:t.pipes=[t.pipes,e];break;default:t.pipes.push(e);}t.pipesCount+=1,w("pipe count=%d opts=%j",t.pipesCount,r);var n=(!r||!1!==r.end)&&e!==nj.stdout&&e!==nj.stderr?i:p;function $(r,n){w("onunpipe"),r===a&&n&&!1===n.hasUnpiped&&(n.hasUnpiped=!0,w("cleanup"),e.removeListener("close",v),e.removeListener("finish",h),e.removeListener("drain",d),e.removeListener("error",s),e.removeListener("unpipe",$),a.removeListener("end",i),a.removeListener("end",p),a.removeListener("data",u),o=!0,!t.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function i(){w("onend"),e.end()}t.endEmitted?Ib.nextTick(n):a.once("end",n),e.on("unpipe",$);var d=Zu(a);e.on("drain",d);var o=!1;var l=!1;function u(r){w("ondata"),l=!1,!1!==e.write(r)||l||((1===t.pipesCount&&t.pipes===e||t.pipesCount>1&&-1!==wk(t.pipes,e))&&!o&&(w("false write response, pause",a._readableState.awaitDrain),a._readableState.awaitDrain++,l=!0),a.pause())}function s(r){w("onerror",r),p(),e.removeListener("error",s),0===tj(e,"error")&&e.emit("error",r)}function v(){e.removeListener("finish",h),p()}function h(){w("onfinish"),e.removeListener("close",v),p()}function p(){w("unpipe"),a.unpipe(e)}return a.on("data",u),nv(e,"error",s),e.once("close",v),e.once("finish",h),e.emit("pipe",a),t.flowing||(w("pipe resume"),a.resume()),e},i.prototype.unpipe=function(e){var r=this._readableState,a={hasUnpiped:!1};if(0===r.pipesCount)return this;if(1===r.pipesCount)return e&&e!==r.pipes?this:(e||(e=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,e&&e.emit("unpipe",this,a),this);if(!e){var t=r.pipes,n=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var $=0;$<n;$++)t[$].emit("unpipe",this,a);return this}var i=wk(r.pipes,e);return-1===i?this:(r.pipes.splice(i,1),r.pipesCount-=1,1===r.pipesCount&&(r.pipes=r.pipes[0]),e.emit("unpipe",this,a),this)},i.prototype.on=function(e,r){var a=tf.prototype.on.call(this,e,r);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var t=this._readableState;t.endEmitted||t.readableListening||(t.readableListening=t.needReadable=!0,t.emittedReadable=!1,t.reading?t.length&&ed(this):Ib.nextTick(Uu,this))}return a},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var e=this._readableState;return e.flowing||(w("resume"),e.flowing=!0,Tu(this,e)),this},i.prototype.pause=function(){return w("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(w("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(e){var r=this,a=this._readableState,t=!1;for(var n in e.on("end",function(){if(w("wrapped end"),a.decoder&&!a.ended){var e=a.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function(n){(w("wrapped data"),a.decoder&&(n=a.decoder.write(n)),a.objectMode&&null==n)||(a.objectMode||n&&n.length)&&(r.push(n)||(t=!0,e.pause()))}),e)void 0===this[n]&&"function"==typeof e[n]&&(this[n]=function(r){return function(){return e[r].apply(e,arguments)}}(n));for(var $=0;$<qf.length;$++)e.on(qf[$],this.emit.bind(this,qf[$]));return this._read=function(r){w("wrapped _read",r),t&&(t=!1,e.resume())},this},Object.defineProperty(i.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),i._fromList=pk}var hf={};hf=ra;var sd=(nb(),ob),Ck=(Bc(),r);function Lu(r,t){var e=this._transformState;e.transforming=!1;var n=e.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));e.writechunk=null,e.writecb=null,null!=t&&this.push(t),n(r);var a=this._readableState;a.reading=!1,(a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}function ra(r){if(!(this instanceof ra))return new ra(r);sd.call(this,r),this._transformState={afterTransform:Lu.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",Ku)}function Ku(){var r=this;"function"==typeof this._flush?this._flush(function(t,e){Ik(r,t,e)}):Ik(this,null,null)}function Ik(r,t,e){if(t)return r.emit("error",t);if(null!=e&&r.push(e),r._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(r._transformState.transforming)throw new Error("Calling transform done when still transforming");return r.push(null)}Ck.inherits=(Pb(),Qb),Ck.inherits(ra,sd),ra.prototype.push=function(r,t){return this._transformState.needTransform=!1,sd.prototype.push.call(this,r,t)},ra.prototype._transform=function(r,t,e){throw new Error("_transform() is not implemented")},ra.prototype._write=function(r,t,e){var n=this._transformState;if(n.writecb=e,n.writechunk=r,n.writeencoding=t,!n.transforming){var a=this._readableState;(n.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},ra.prototype._read=function(r){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},ra.prototype._destroy=function(r,t){var e=this;sd.prototype._destroy.call(this,r,function(r){t(r),e.emit("close")})};var Ju={};Ju=Qc;var Kk=(Bc(),r);function Qc(r){if(!(this instanceof Qc))return new Qc(r);hf.call(this,r)}Kk.inherits=(Pb(),Qb),Kk.inherits(Qc,hf),Qc.prototype._transform=function(r,$,n){n(null,r)};var Xa={},Gu=Xa=Xa=(xk(),mj);Xa.Stream=Gu;Xa.Readable=Xa;var Fu=(ti(),ch);Xa.Writable=Fu;var ff=(nb(),ob);Xa.Duplex=ff;Xa.Transform=hf;Xa.PassThrough=Ju;var Vk={},Eu=(Hd(),ya).Buffer;Vk=a;var Xk=Y("simple-peer"),Du=(Pb(),Qb),ef=65536,Bu=5e3,zu=5e3;function a(e){var t=this;if(!(t instanceof a))return new a(e);if(t._id=hj(4).toString("hex").slice(0,7),t._debug("new peer %o",e),e=Object.assign({allowHalfOpen:!1},e),ff.call(t,e),t.channelName=e.initiator?e.channelName||hj(20).toString("hex"):null,t._isChromium="undefined"!=typeof window&&!!window.webkitRTCPeerConnection,t.initiator=e.initiator||!1,t.channelConfig=e.channelConfig||a.channelConfig,t.config=Object.assign({},a.config,e.config),t.constraints=t._transformConstraints(e.constraints||a.constraints),t.offerConstraints=t._transformConstraints(e.offerConstraints||{}),t.answerConstraints=t._transformConstraints(e.answerConstraints||{}),t.sdpTransform=e.sdpTransform||function(e){return e},t.streams=e.streams||(e.stream?[e.stream]:[]),t.trickle=void 0===e.trickle||e.trickle,t.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,t.iceCompleteTimeout=e.iceCompleteTimeout||Bu,t.destroyed=!1,t.connected=!1,t.remoteAddress=void 0,t.remoteFamily=void 0,t.remotePort=void 0,t.localAddress=void 0,t.localPort=void 0,t._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:$l(),!t._wrtc)throw"undefined"==typeof window?u("No WebRTC support: Specify `opts.wrtc` option in this environment","ERR_WEBRTC_SUPPORT"):u("No WebRTC support: Not a supported browser","ERR_WEBRTC_SUPPORT");t._pcReady=!1,t._channelReady=!1,t._iceComplete=!1,t._iceCompleteTimer=null,t._channel=null,t._pendingCandidates=[],t._isNegotiating=!t.initiator,t._batchedNegotiation=!1,t._queuedNegotiation=!1,t._sendersAwaitingStable=[],t._senderMap=new Map,t._firstStable=!0,t._closingInterval=null,t._remoteTracks=[],t._remoteStreams=[],t._chunk=null,t._cb=null,t._interval=null,t._pc=new t._wrtc.RTCPeerConnection(t.config,t.constraints),(t._isChromium||t._wrtc&&t._wrtc.electronDaemon)&&yu(t._wrtc.RTCPeerConnection,t._pc),t._isReactNativeWebrtc="number"==typeof t._pc._peerConnectionId,t._pc.oniceconnectionstatechange=function(){t._onIceStateChange()},t._pc.onicegatheringstatechange=function(){t._onIceStateChange()},t._pc.onsignalingstatechange=function(){t._onSignalingStateChange()},t._pc.onicecandidate=function(e){t._onIceCandidate(e)},t.initiator?t._setupData({channel:t._pc.createDataChannel(t.channelName,t.channelConfig)}):t._pc.ondatachannel=function(e){t._setupData(e)},"addTrack"in t._pc&&(t.streams&&t.streams.forEach(function(e){t.addStream(e)}),t._pc.ontrack=function(e){t._onTrack(e)}),t.initiator&&t._needsNegotiation(),t._onFinishBound=function(){t._onFinish()},t.once("finish",t._onFinishBound)}function yu(e,t){t.createOffer=function(t){return new Promise((n,r)=>{e.prototype.createOffer.call(this,n,r,t)})},t.createAnswer=function(t){return new Promise((n,r)=>{e.prototype.createAnswer.call(this,n,r,t)})},t.setLocalDescription=function(t){return new Promise((n,r)=>{e.prototype.setLocalDescription.call(this,t,n,r)})},t.setRemoteDescription=function(t){return new Promise((n,r)=>{e.prototype.setRemoteDescription.call(this,t,n,r)})}}function hl(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}function u(e,t){var n=new Error(e);return n.code=t,n}function xu(){}Du(a,ff),a.WEBRTC_SUPPORT=!!$l(),a.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]},a.constraints={},a.channelConfig={},Object.defineProperty(a.prototype,"bufferSize",{get:function(){return this._channel&&this._channel.bufferedAmount||0}}),a.prototype.address=function(){return{port:this.localPort,family:"IPv4",address:this.localAddress}},a.prototype.signal=function(e){var t=this;if(t.destroyed)throw u("cannot signal after peer is destroyed","ERR_SIGNALING");if("string"==typeof e)try{e=JSON.parse(e)}catch(n){e={}}t._debug("signal()"),e.renegotiate&&t.initiator&&(t._debug("got request to renegotiate"),t._needsNegotiation()),e.candidate&&(t._pc.remoteDescription&&t._pc.remoteDescription.type?t._addIceCandidate(e.candidate):t._pendingCandidates.push(e.candidate)),e.sdp&&t._pc.setRemoteDescription(new t._wrtc.RTCSessionDescription(e)).then(function(){t.destroyed||(t._pendingCandidates.forEach(function(e){t._addIceCandidate(e)}),t._pendingCandidates=[],"offer"===t._pc.remoteDescription.type&&t._createAnswer())}).catch(function(e){t.destroy(u(e,"ERR_SET_REMOTE_DESCRIPTION"))}),e.sdp||e.candidate||e.renegotiate||t.destroy(u("signal() called with invalid signal data","ERR_SIGNALING"))},a.prototype._addIceCandidate=function(e){var t=this;try{t._pc.addIceCandidate(new t._wrtc.RTCIceCandidate(e),xu,function(e){t.destroy(u(e,"ERR_ADD_ICE_CANDIDATE"))})}catch(n){t.destroy(u("error adding candidate: "+n.message,"ERR_ADD_ICE_CANDIDATE"))}},a.prototype.send=function(e){this._channel.send(e)},a.prototype.addStream=function(e){var t=this;t._debug("addStream()"),e.getTracks().forEach(function(n){t.addTrack(n,e)})},a.prototype.addTrack=function(e,t){this._debug("addTrack()");var n=this._pc.addTrack(e,t),r=this._senderMap.get(e)||new Map;r.set(t,n),this._senderMap.set(e,r),this._needsNegotiation()},a.prototype.replaceTrack=async function(e,t,n){this._debug("replaceTrack()");var r=this._senderMap.get(e),i=r?r.get(n):null;i||this.destroy(new Error("Cannot replace track that was never added.")),t&&this._senderMap.set(t,r),null!=i.replaceTrack?await i.replaceTrack(t):this.destroy(u("replaceTrack is not supported in this browser","ERR_UNSUPPORTED_REPLACETRACK"))},a.prototype.removeTrack=function(e,t){this._debug("removeSender()");var n=this._senderMap.get(e),r=n?n.get(t):null;r||this.destroy(new Error("Cannot remove track that was never added."));try{this._pc.removeTrack(r)}catch(i){"NS_ERROR_UNEXPECTED"===i.name?this._sendersAwaitingStable.push(r):this.destroy(i)}},a.prototype.removeStream=function(e){var t=this;t._debug("removeSenders()"),e.getTracks().forEach(function(n){t.removeTrack(n,e)})},a.prototype._needsNegotiation=function(){var e=this;e._debug("_needsNegotiation"),e._batchedNegotiation||(e._batchedNegotiation=!0,setTimeout(function(){e._batchedNegotiation=!1,e._debug("starting batched negotiation"),e.negotiate()},0))},a.prototype.negotiate=function(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),this._createOffer()):this._isNegotiating||(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0},a.prototype.destroy=function(e){this._destroy(e,function(){})},a.prototype._destroy=function(e,t){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.destroyed=!0,this.connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,"addTrack"in this._pc&&(this._pc.ontrack=null),this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()}},a.prototype._setupData=function(e){var t=this;if(!e.channel)return t.destroy(u("Data channel event is missing `channel` property","ERR_DATA_CHANNEL"));t._channel=e.channel,t._channel.binaryType="arraybuffer","number"==typeof t._channel.bufferedAmountLowThreshold&&(t._channel.bufferedAmountLowThreshold=ef),t.channelName=t._channel.label,t._channel.onmessage=function(e){t._onChannelMessage(e)},t._channel.onbufferedamountlow=function(){t._onChannelBufferedAmountLow()},t._channel.onopen=function(){t._onChannelOpen()},t._channel.onclose=function(){t._onChannelClose()},t._channel.onerror=function(e){t.destroy(u(e,"ERR_DATA_CHANNEL"))};var n=!1;t._closingInterval=setInterval(function(){t._channel&&"closing"===t._channel.readyState?(n&&t._onChannelClose(),n=!0):n=!1},zu)},a.prototype._read=function(){},a.prototype._write=function(e,t,n){if(this.destroyed)return n(u("cannot write after peer is destroyed","ERR_DATA_CHANNEL"));if(this.connected){try{this.send(e)}catch(r){return this.destroy(u(r,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>ef?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=n):n(null)}else this._debug("write before connect"),this._chunk=e,this._cb=n},a.prototype._onFinish=function(){var e=this;function t(){setTimeout(function(){e.destroy()},1e3)}e.destroyed||(e.connected?t():e.once("connect",t))},a.prototype._startIceCompleteTimeout=function(){Xk("started iceComplete timeout");var e=this;e.destroyed||e._iceCompleteTimer||(e._iceCompleteTimer=setTimeout(function(){e._iceComplete||(e._iceComplete=!0,e.emit("iceTimeout"),e.emit("_iceComplete"))},this.iceCompleteTimeout))},a.prototype._createOffer=function(){var e=this;e.destroyed||e._pc.createOffer(e.offerConstraints).then(function(t){function n(){if(!e.destroyed){var n=e._pc.localDescription||t;e._debug("signal"),e.emit("signal",{type:n.type,sdp:n.sdp})}}e.destroyed||(e.trickle||e.allowHalfTrickle||(t.sdp=hl(t.sdp)),t.sdp=e.sdpTransform(t.sdp),e._pc.setLocalDescription(t).then(function(){if(e._debug("createOffer success"),e.destroyed)return;e.trickle||e._iceComplete?n():e.once("_iceComplete",n)}).catch(function(t){e.destroy(u(t,"ERR_SET_LOCAL_DESCRIPTION"))}))}).catch(function(t){e.destroy(u(t,"ERR_CREATE_OFFER"))})},a.prototype._createAnswer=function(){var e=this;e.destroyed||e._pc.createAnswer(e.answerConstraints).then(function(t){function n(){if(!e.destroyed){var n=e._pc.localDescription||t;e._debug("signal"),e.emit("signal",{type:n.type,sdp:n.sdp})}}e.destroyed||(e.trickle||e.allowHalfTrickle||(t.sdp=hl(t.sdp)),t.sdp=e.sdpTransform(t.sdp),e._pc.setLocalDescription(t).then(function(){if(e.destroyed)return;e.trickle||e._iceComplete?n():e.once("_iceComplete",n)}).catch(function(t){e.destroy(u(t,"ERR_SET_LOCAL_DESCRIPTION"))}))}).catch(function(t){e.destroy(u(t,"ERR_CREATE_ANSWER"))})},a.prototype._onIceStateChange=function(){if(!this.destroyed){var e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),"connected"!==e&&"completed"!==e||(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(u("Ice connection failed.","ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(new Error("Ice connection closed."))}},a.prototype.getStats=function(e){var t=this;0===t._pc.getStats.length?t._pc.getStats().then(function(t){var n=[];t.forEach(function(e){n.push(e)}),e(null,n)},function(t){e(t)}):t._isReactNativeWebrtc?t._pc.getStats(null,function(t){var n=[];t.forEach(function(e){n.push(e)}),e(null,n)},function(t){e(t)}):t._pc.getStats.length>0?t._pc.getStats(function(n){if(!t.destroyed){var r=[];n.result().forEach(function(e){var t={};e.names().forEach(function(n){t[n]=e.stat(n)}),t.id=e.id,t.type=e.type,t.timestamp=e.timestamp,r.push(t)}),e(null,r)}},function(t){e(t)}):e(null,[])},a.prototype._maybeReady=function(){var e=this;e._debug("maybeReady pc %s channel %s",e._pcReady,e._channelReady),!e.connected&&!e._connecting&&e._pcReady&&e._channelReady&&(e._connecting=!0,function t(){e.destroyed||e.getStats(function(n,r){if(!e.destroyed){n&&(r=[]);var i={},o={},a={},s=!1;if(r.forEach(function(e){"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(i[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(o[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(a[e.id]=e)}),r.forEach(function(e){"transport"===e.type&&e.selectedCandidatePairId&&l(a[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&l(e)}),s||Object.keys(a).length&&!Object.keys(o).length){if(e._connecting=!1,e.connected=!0,e._chunk){try{e.send(e._chunk)}catch(n){return e.destroy(u(n,"ERR_DATA_CHANNEL"))}e._chunk=null,e._debug("sent chunk from \"write before connect\"");var c=e._cb;e._cb=null,c(null)}"number"!=typeof e._channel.bufferedAmountLowThreshold&&(e._interval=setInterval(function(){e._onInterval()},150),e._interval.unref&&e._interval.unref()),e._debug("connect"),e.emit("connect")}else setTimeout(t,100)}function l(t){s=!0;var n=o[t.localCandidateId];n&&n.ip?(e.localAddress=n.ip,e.localPort=Number(n.port)):n&&n.ipAddress?(e.localAddress=n.ipAddress,e.localPort=Number(n.portNumber)):"string"==typeof t.googLocalAddress&&(n=t.googLocalAddress.split(":"),e.localAddress=n[0],e.localPort=Number(n[1]));var r=i[t.remoteCandidateId];r&&r.ip?(e.remoteAddress=r.ip,e.remotePort=Number(r.port)):r&&r.ipAddress?(e.remoteAddress=r.ipAddress,e.remotePort=Number(r.portNumber)):"string"==typeof t.googRemoteAddress&&(r=t.googRemoteAddress.split(":"),e.remoteAddress=r[0],e.remotePort=Number(r[1])),e.remoteFamily="IPv4",e._debug("connect local: %s:%s remote: %s:%s",e.localAddress,e.localPort,e.remoteAddress,e.remotePort)}})}())},a.prototype._onInterval=function(){!this._cb||!this._channel||this._channel.bufferedAmount>ef||this._onChannelBufferedAmountLow()},a.prototype._onSignalingStateChange=function(){var e=this;e.destroyed||("stable"!==e._pc.signalingState||e._firstStable||(e._isNegotiating=!1,e._debug("flushing sender queue",e._sendersAwaitingStable),e._sendersAwaitingStable.forEach(function(t){e._pc.removeTrack(t),e._queuedNegotiation=!0}),e._sendersAwaitingStable=[],e._queuedNegotiation&&(e._debug("flushing negotiation queue"),e._queuedNegotiation=!1,e._needsNegotiation()),e._debug("negotiate"),e.emit("negotiate")),e._firstStable=!1,e._debug("signalingStateChange %s",e._pc.signalingState),e.emit("signalingStateChange",e._pc.signalingState))},a.prototype._onIceCandidate=function(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())},a.prototype._onChannelMessage=function(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=Eu.from(t)),this.push(t)}},a.prototype._onChannelBufferedAmountLow=function(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}},a.prototype._onChannelOpen=function(){this.connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())},a.prototype._onChannelClose=function(){this.destroyed||(this._debug("on channel close"),this.destroy())},a.prototype._onTrack=function(e){var t=this;t.destroyed||e.streams.forEach(function(n){t._debug("on track"),t.emit("track",e.track,n),t._remoteTracks.push({track:e.track,stream:n}),t._remoteStreams.some(function(e){return e.id===n.id})||(t._remoteStreams.push(n),setTimeout(function(){t.emit("stream",n)},0))})},a.prototype.setConstraints=function(e){this.initiator?this.offerConstraints=this._transformConstraints(e):this.answerConstraints=this._transformConstraints(e)},a.prototype._debug=function(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],Xk.apply(null,e)},a.prototype._transformConstraints=function(e){if(0===Object.keys(e).length)return e;if((e.mandatory||e.optional)&&!this._isChromium){var t=Object.assign({},e.optional,e.mandatory);return void 0!==t.OfferToReceiveVideo&&(t.offerToReceiveVideo=t.OfferToReceiveVideo,delete t.OfferToReceiveVideo),void 0!==t.OfferToReceiveAudio&&(t.offerToReceiveAudio=t.OfferToReceiveAudio,delete t.OfferToReceiveAudio),t}return e.mandatory||e.optional||!this._isChromium?e:(void 0!==e.offerToReceiveVideo&&(e.OfferToReceiveVideo=e.offerToReceiveVideo,delete e.offerToReceiveVideo),void 0!==e.offerToReceiveAudio&&(e.OfferToReceiveAudio=e.offerToReceiveAudio,delete e.offerToReceiveAudio),{mandatory:e})};var wu={};wu=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then};var _e={},vu={}.toString;_e=Array.isArray||function(r){return"[object Array]"==vu.call(r)};var I={};function uu(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===r.foo()}catch(e){return!1}}h.TYPED_ARRAY_SUPPORT=uu();var Dl=h.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function h(r,e,t){return h.TYPED_ARRAY_SUPPORT||this instanceof h?"number"==typeof r?Jl(this,r):mu(this,r,e,t):new h(r,e,t)}function Ye(r){if(r>=Dl)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Dl.toString(16)+" bytes");return 0|r}function tu(r){return r!=r}function sb(r,e){var t;return h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:(null===(t=r)&&(t=new h(e)),t.length=e),t}function Jl(r,e){var t=sb(r,e<0?0:0|Ye(e));if(!h.TYPED_ARRAY_SUPPORT)for(var a=0;a<e;++a)t[a]=0;return t}function su(r,e){var t=0|Pl(e),a=sb(r,t),f=a.write(e);return f!==t&&(a=a.slice(0,f)),a}function We(r,e){for(var t=e.length<0?0:0|Ye(e.length),a=sb(r,t),f=0;f<t;f+=1)a[f]=255&e[f];return a}function ru(r,e,t,a){if(t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+(a||0))throw new RangeError("'length' is out of bounds");var f;return f=void 0===t&&void 0===a?new Uint8Array(e):void 0===a?new Uint8Array(e,t):new Uint8Array(e,t,a),h.TYPED_ARRAY_SUPPORT?f.__proto__=h.prototype:f=We(r,f),f}function qu(r,e){if(h.isBuffer(e)){var t=0|Ye(e.length),a=sb(r,t);return 0===a.length?a:(e.copy(a,0,0,t),a)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||tu(e.length)?sb(r,0):We(r,e);if("Buffer"===e.type&&Array.isArray(e.data))return We(r,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Ol(r,e){var t;e=e||1/0;for(var a=r.length,f=null,$=[],n=0;n<a;++n){if((t=r.charCodeAt(n))>55295&&t<57344){if(!f){if(t>56319){(e-=3)>-1&&$.push(239,191,189);continue}if(n+1===a){(e-=3)>-1&&$.push(239,191,189);continue}f=t;continue}if(t<56320){(e-=3)>-1&&$.push(239,191,189),f=t;continue}t=65536+(f-55296<<10|t-56320)}else f&&(e-=3)>-1&&$.push(239,191,189);if(f=null,t<128){if((e-=1)<0)break;$.push(t)}else if(t<2048){if((e-=2)<0)break;$.push(t>>6|192,63&t|128)}else if(t<65536){if((e-=3)<0)break;$.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;$.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return $}function Pl(r){return h.isBuffer(r)?r.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer)?r.byteLength:("string"!=typeof r&&(r=""+r),0===r.length?0:Ol(r).length)}function ou(r,e,t,a){for(var f=0;f<a&&!(f+t>=e.length||f>=r.length);++f)e[f+t]=r[f];return f}function nu(r,e,t,a){return ou(Ol(e,r.length-t),r,t,a)}function mu(r,e,t,a){if("number"==typeof e)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?ru(r,e,t,a):"string"==typeof e?su(r,e,t):qu(r,e)}h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),h.prototype.write=function(r,e,t){void 0===e?(t=this.length,e=0):void 0===t&&"string"==typeof e?(t=this.length,e=0):isFinite(e)&&(e|=0,isFinite(t)?t|=0:t=void 0);var a=this.length-e;if((void 0===t||t>a)&&(t=a),r.length>0&&(t<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return nu(this,r,e,t)},h.prototype.slice=function(r,e){var t,a=this.length;if((r=~~r)<0?(r+=a)<0&&(r=0):r>a&&(r=a),(e=void 0===e?a:~~e)<0?(e+=a)<0&&(e=0):e>a&&(e=a),e<r&&(e=r),h.TYPED_ARRAY_SUPPORT)(t=this.subarray(r,e)).__proto__=h.prototype;else{var f=e-r;t=new h(f,void 0);for(var $=0;$<f;++$)t[$]=this[$+r]}return t},h.prototype.copy=function(r,e,t,a){if(t||(t=0),a||0===a||(a=this.length),e>=r.length&&(e=r.length),e||(e=0),a>0&&a<t&&(a=t),a===t)return 0;if(0===r.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),r.length-e<a-t&&(a=r.length-e+t);var f,$=a-t;if(this===r&&t<e&&e<a)for(f=$-1;f>=0;--f)r[f+e]=this[f+t];else if($<1e3||!h.TYPED_ARRAY_SUPPORT)for(f=0;f<$;++f)r[f+e]=this[f+t];else Uint8Array.prototype.set.call(r,this.subarray(t,t+$),e);return $},h.prototype.fill=function(r,e,t){if("string"==typeof r){if("string"==typeof e?(e=0,t=this.length):"string"==typeof t&&(t=this.length),1===r.length){var a=r.charCodeAt(0);a<256&&(r=a)}}else"number"==typeof r&&(r&=255);if(e<0||this.length<e||this.length<t)throw new RangeError("Out of range index");if(t<=e)return this;var f;if(e>>>=0,t=void 0===t?this.length:t>>>0,r||(r=0),"number"==typeof r)for(f=e;f<t;++f)this[f]=r;else{var $=h.isBuffer(r)?r:new h(r),n=$.length;for(f=0;f<t-e;++f)this[f+e]=$[f%n]}return this},h.concat=function(r,e){if(!_e(r))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===r.length)return sb(null,0);var t;if(void 0===e)for(e=0,t=0;t<r.length;++t)e+=r[t].length;var a=Jl(null,e),f=0;for(t=0;t<r.length;++t){var $=r[t];if(!h.isBuffer($))throw new TypeError("\"list\" argument must be an Array of Buffers");$.copy(a,f),f+=$.length}return a},h.byteLength=Pl,h.prototype._isBuffer=!0,h.isBuffer=function(r){return!(null==r||!r._isBuffer)},I=h;var Ul,ku=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],Re=function(o){if(!o)throw new Error("\"version\" cannot be null or undefined");if(o<1||o>40)throw new Error("\"version\" should be in range from 1 to 40");return 4*o+17};var Qe=function(o){return ku[o]};var yb=function(o){for(var t=0;0!==o;)t++,o>>>=1;return t};var iu=function(o){if("function"!=typeof o)throw new Error("\"toSJISFunc\" is not a valid function.");Ul=o};var be=function(){return void 0!==Ul};var hu=function(o){return Ul(o)};var Ne={bit:1};var zb={bit:0};var Me={bit:3};var Le={bit:2};function fu(r){if("string"!=typeof r)throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return Ne;case"m":case"medium":return zb;case"q":case"quartile":return Me;case"h":case"high":return Le;default:throw new Error("Unknown EC Level: "+r);}}var QD=function(r){return r&&void 0!==r.bit&&r.bit>=0&&r.bit<4};var nm=function(r,$){if(QD(r))return r;try{return fu(r)}catch(t){return $}};var eu={};function qm(){this.buffer=[],this.length=0}qm.prototype={get:function(t){var r=Math.floor(t/8);return 1==(this.buffer[r]>>>7-t%8&1)},put:function(t,r){for(var f=0;f<r;f++)this.putBit(1==(t>>>r-f-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}},eu=qm;var du={};function Dc(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new I(t*t),this.data.fill(0),this.reservedBit=new I(t*t),this.reservedBit.fill(0)}Dc.prototype.set=function(t,r,i,e){var $=t*this.size+r;this.data[$]=i,e&&(this.reservedBit[$]=!0)},Dc.prototype.get=function(t,r){return this.data[t*this.size+r]},Dc.prototype.xor=function(t,r,i){this.data[t*this.size+r]^=i},Dc.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]},du=Dc;var au=Re,$t=function(e){if(1===e)return[];for(var o=Math.floor(e/7)+2,r=au(e),t=145===r?26:2*Math.ceil((r-13)/(2*o-2)),$=[r-7],s=1;s<o-1;s++)$[s]=$[s-1]-t;return $.push(6),$.reverse()};var Zt=function(e){for(var o=[],r=$t(e),t=r.length,$=0;$<t;$++)for(var s=0;s<t;s++)0===$&&0===s||0===$&&s===t-1||$===t-1&&0===s||o.push([r[$],r[s]]);return o};var Yt=Re,Bm=7,Wt=function($){var o=Yt($);return[[0,0],[o-Bm,0],[0,o-Bm]]};var ka={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var La={N1:3,N2:3,N3:40,N4:10},St=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7};var Rt=function(t){return St(t)?parseInt(t,10):void 0};var Qt=function(t){for(var e=t.size,r=0,$=0,n=0,a=null,N=null,s=0;s<e;s++){$=n=0,a=N=null;for(var o=0;o<e;o++){var p=t.get(s,o);p===a?$++:($>=5&&(r+=La.N1+($-5)),a=p,$=1),(p=t.get(o,s))===N?n++:(n>=5&&(r+=La.N1+(n-5)),N=p,n=1)}$>=5&&(r+=La.N1+($-5)),n>=5&&(r+=La.N1+(n-5))}return r};var Lt=function(t){for(var e=t.size,r=0,$=0;$<e-1;$++)for(var n=0;n<e-1;n++){var a=t.get($,n)+t.get($,n+1)+t.get($+1,n)+t.get($+1,n+1);4!==a&&0!==a||r++}return r*La.N2};var Kt=function(t){for(var e=t.size,r=0,$=0,n=0,a=0;a<e;a++){$=n=0;for(var N=0;N<e;N++)$=$<<1&2047|t.get(a,N),N>=10&&(1488===$||93===$)&&r++,n=n<<1&2047|t.get(N,a),N>=10&&(1488===n||93===n)&&r++}return r*La.N3};var Jt=function(t){for(var e=0,r=t.data.length,$=0;$<r;$++)e+=t.data[$];return Math.abs(Math.ceil(100*e/r/5)-10)*La.N4};function It(t,e,r){switch(t){case ka.PATTERN000:return(e+r)%2==0;case ka.PATTERN001:return e%2==0;case ka.PATTERN010:return r%3==0;case ka.PATTERN011:return(e+r)%3==0;case ka.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case ka.PATTERN101:return e*r%2+e*r%3==0;case ka.PATTERN110:return(e*r%2+e*r%3)%2==0;case ka.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t);}}var Je=function(t,e){for(var r=e.size,$=0;$<r;$++)for(var n=0;n<r;n++)e.isReserved(n,$)||e.xor(n,$,It(t,n,$))};var Ft=function(t,e){for(var r=Object.keys(ka).length,$=0,n=1/0,a=0;a<r;a++){e(a),Je(a,t);var N=Qt(t)+Lt(t)+Kt(t)+Jt(t);Je(a,t),N<n&&(n=N,$=a)}return $};var jd=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],kd=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],Dt=function(e,$){switch($){case Ne:return jd[4*(e-1)+0];case zb:return jd[4*(e-1)+1];case Me:return jd[4*(e-1)+2];case Le:return jd[4*(e-1)+3];default:return;}};var He=function(e,$){switch($){case Ne:return kd[4*(e-1)+0];case zb:return kd[4*(e-1)+1];case Me:return kd[4*(e-1)+2];case Le:return kd[4*(e-1)+3];default:return;}};if(I.alloc)var ec=I.alloc(512),Ge=I.alloc(256);else ec=new I(512),Ge=new I(256);!function(){for(var $=1,r=0;r<255;r++)ec[r]=$,Ge[$]=r,256&($<<=1)&&($^=285);for(r=255;r<512;r++)ec[r]=ec[r-255]}();var Ct=function($){return ec[$]};var eh=function($,r){return 0===$||0===r?0:ec[Ge[$]+Ge[r]]};var At=function($,r){var e=new I($.length+r.length-1);e.fill(0);for(var J=0;J<$.length;J++)for(var o=0;o<r.length;o++)e[J+o]^=eh($[J],r[o]);return e};var zt=function($,r){for(var e=new I($);e.length-r.length>=0;){for(var J=e[0],o=0;o<r.length;o++)e[o]^=eh(r[o],J);for(var t=0;t<e.length&&0===e[t];)t++;e=e.slice(t)}return e};var yt=function($){for(var r=new I([1]),e=0;e<$;e++)r=At(r,[1,Ct(e)]);return r};var xt={};function ze(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}ze.prototype.initialize=function(e){this.degree=e,this.genPoly=yt(this.degree)},ze.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");var r=new I(this.degree);r.fill(0);var o=I.concat([e,r],e.length+this.degree),i=zt(o,this.genPoly),$=this.degree-i.length;if($>0){var n=new I(this.degree);return n.fill(0),i.copy(n,$),n}return i},xt=ze;var ud=function($){return!isNaN($)&&$>=1&&$<=40};var H={},mh="[0-9]+",wt="[A-Z $%*+\\-./:]+",xe="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",ut="(?:(?![A-Z0-9 $%*+\\-./:]|"+(xe=xe.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+",tt=new RegExp(xe,"g");H.KANJI=tt;var st=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");H.BYTE_KANJI=st;var qt=new RegExp(ut,"g");H.BYTE=qt;var pt=new RegExp(mh,"g");H.NUMERIC=pt;var ot=new RegExp(wt,"g");H.ALPHANUMERIC=ot;var kt=new RegExp("^"+xe+"$"),jt=new RegExp("^"+mh+"$"),it=new RegExp("^[A-Z0-9 $%*+\\-./:]+$"),ft=function($){return kt.test($)};H.testKanji=ft;var et=function($){return jt.test($)};H.testNumeric=et;var dt=function($){return it.test($)};H.testAlphanumeric=dt;var Ca={id:"Numeric",bit:1,ccBits:[10,12,14]};var ta={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};var J={id:"Byte",bit:4,ccBits:[8,16,16]};var sa={id:"Kanji",bit:8,ccBits:[8,10,12]};var Fh={bit:-1};var ue=function(r,$){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!ud($))throw new Error("Invalid version: "+$);return $>=1&&$<10?r.ccBits[0]:$<27?r.ccBits[1]:r.ccBits[2]};var ct=function(r){return H.testNumeric(r)?Ca:H.testAlphanumeric(r)?ta:H.testKanji(r)?sa:J};var Ih=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")};var bt=function(r){return r&&r.bit&&r.ccBits};function at(r){if("string"!=typeof r)throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return Ca;case"alphanumeric":return ta;case"kanji":return sa;case"byte":return J;default:throw new Error("Unknown mode: "+r);}}var _s=function(r,$){if(bt(r))return r;try{return at(r)}catch(t){return $}};var Mh=7973,Nh=yb(Mh);function $s(r,o,$){for(var e=1;e<=40;e++)if(o<=Th(e,$,r))return e}function Ph(r,o){return ue(r,o)+4}function Zs(r,o){var $=0;return r.forEach(function(r){var e=Ph(r.mode,o);$+=e+r.getBitsLength()}),$}function Ys(r,o){for(var $=1;$<=40;$++){if(Zs(r,$)<=Th($,o,Fh))return $}}var Ws=function(r,o){return ud(r)?parseInt(r,10):o};var Th=function(r,o,$){if(!ud(r))throw new Error("Invalid QR Code version");void 0===$&&($=J);var e=8*(Qe(r)-He(r,o));if($===Fh)return e;var t=e-Ph($,r);switch($){case Ca:return Math.floor(t/10*3);case ta:return Math.floor(t/11*2);case sa:return Math.floor(t/13);case J:default:return Math.floor(t/8);}};var Uh=function(r,o){var $,e=nm(o,zb);if(_e(r)){if(r.length>1)return Ys(r,e);if(0===r.length)return 1;$=r[0]}else $=r;return $s($.mode,$.getLength(),e)};var Vs=function(r){if(!ud(r)||r<7)throw new Error("Invalid QR Code version");for(var o=r<<12;yb(o)-Nh>=0;)o^=Mh<<yb(o)-Nh;return r<<12|o};var Wh=1335,Ts=21522,Yh=yb(Wh),Ss=function($,a){for(var r=$.bit<<3|a,t=r<<10;yb(t)-Yh>=0;)t^=Wh<<yb(t)-Yh;return(r<<10|t)^Ts};var $h={};function Sb(t){this.mode=Ca,this.data=t.toString()}Sb.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},Sb.prototype.getLength=function(){return this.data.length},Sb.prototype.getBitsLength=function(){return Sb.getBitsLength(this.data.length)},Sb.prototype.write=function(t){var a,r,e;for(a=0;a+3<=this.data.length;a+=3)r=this.data.substr(a,3),e=parseInt(r,10),t.put(e,10);var $=this.data.length-a;$>0&&(r=this.data.substr(a),e=parseInt(r,10),t.put(e,3*$+1))},$h=Sb;var ai={},te=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Ub(a){this.mode=ta,this.data=a}Ub.getBitsLength=function(a){return 11*Math.floor(a/2)+a%2*6},Ub.prototype.getLength=function(){return this.data.length},Ub.prototype.getBitsLength=function(){return Ub.getBitsLength(this.data.length)},Ub.prototype.write=function(a){var t;for(t=0;t+2<=this.data.length;t+=2){var $=45*te.indexOf(this.data[t]);$+=te.indexOf(this.data[t+1]),a.put($,11)}this.data.length%2&&a.put(te.indexOf(this.data[t]),6)},ai=Ub;var di={};function Vb(t){this.mode=J,this.data=new I(t)}Vb.getBitsLength=function(t){return 8*t},Vb.prototype.getLength=function(){return this.data.length},Vb.prototype.getBitsLength=function(){return Vb.getBitsLength(this.data.length)},Vb.prototype.write=function(t){for(var e=0,$=this.data.length;e<$;e++)t.put(this.data[e],8)},di=Vb;var fi={};function Wb(t){this.mode=sa,this.data=t}Wb.getBitsLength=function(t){return 13*t},Wb.prototype.getLength=function(){return this.data.length},Wb.prototype.getBitsLength=function(){return Wb.getBitsLength(this.data.length)},Wb.prototype.write=function(t){var a;for(a=0;a<this.data.length;a++){var r=hu(this.data[a]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[a]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13)}},fi=Wb;var Ns={},Fc={single_source_shortest_paths:function(r,t,e){var s={},o={};o[t]=0;var u,i,a,n,h,p,$,f=Fc.PriorityQueue.make();for(f.push(t,0);!f.empty();)for(a in i=(u=f.pop()).value,n=u.cost,h=r[i]||{})h.hasOwnProperty(a)&&(p=n+h[a],$=o[a],(void 0===o[a]||$>p)&&(o[a]=p,f.push(a,p),s[a]=i));if(void 0!==e&&void 0===o[e]){var v=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(v)}return s},extract_shortest_path_from_predecessor_list:function(r,t){for(var e=[],s=t;s;)e.push(s),r[s],s=r[s];return e.reverse(),e},find_path:function(r,t,e){var s=Fc.single_source_shortest_paths(r,t,e);return Fc.extract_shortest_path_from_predecessor_list(s,e)},PriorityQueue:{make:function(r){var t,e=Fc.PriorityQueue,s={};for(t in r=r||{},e)e.hasOwnProperty(t)&&(s[t]=e[t]);return s.queue=[],s.sorter=r.sorter||e.default_sorter,s},default_sorter:function(r,t){return r.cost-t.cost},push:function(r,t){var e={value:r,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};Ns=Fc;function ji(e){return unescape(encodeURIComponent(e)).length}function Gc(e,$,r){for(var a,t=[];null!==(a=e.exec(r));)t.push({data:a[0],index:a.index,mode:$,length:a[0].length});return t}function li(e){var $,r,a=Gc(H.NUMERIC,Ca,e),t=Gc(H.ALPHANUMERIC,ta,e);return be()?($=Gc(H.BYTE,J,e),r=Gc(H.KANJI,sa,e)):($=Gc(H.BYTE_KANJI,J,e),r=[]),a.concat(t,$,r).sort(function(e,$){return e.index-$.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function se(e,$){switch($){case Ca:return $h.getBitsLength(e);case ta:return ai.getBitsLength(e);case sa:return fi.getBitsLength(e);case J:return di.getBitsLength(e);}}function Ms(e){return e.reduce(function(e,$){var r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===$.mode?(e[e.length-1].data+=$.data,e):(e.push($),e)},[])}function Ls(e){for(var $=[],r=0;r<e.length;r++){var a=e[r];switch(a.mode){case Ca:$.push([a,{data:a.data,mode:ta,length:a.length},{data:a.data,mode:J,length:a.length}]);break;case ta:$.push([a,{data:a.data,mode:J,length:a.length}]);break;case sa:$.push([a,{data:a.data,mode:J,length:ji(a.data)}]);break;case J:$.push([{data:a.data,mode:J,length:ji(a.data)}]);}}return $}function Ks(e,$){for(var r={},a={start:{}},t=["start"],n=0;n<e.length;n++){for(var c=e[n],o=[],d=0;d<c.length;d++){var g=c[d],Q=""+n+d;o.push(Q),r[Q]={node:g,lastCount:0},a[Q]={};for(var V=0;V<t.length;V++){var i=t[V];r[i]&&r[i].node.mode===g.mode?(a[i][Q]=se(r[i].lastCount+g.length,g.mode)-se(r[i].lastCount,g.mode),r[i].lastCount+=g.length):(r[i]&&(r[i].lastCount=g.length),a[i][Q]=se(g.length,g.mode)+4+ue(g.mode,$))}}t=o}for(V=0;V<t.length;V++)a[t[V]].end=0;return{map:a,table:r}}function qi(e,$){var r,a=ct(e);if((r=_s($,a))!==J&&r.bit<a.bit)throw new Error("\""+e+"\" cannot be encoded with mode "+Ih(r)+".\n Suggested mode is: "+Ih(a));switch(r!==sa||be()||(r=J),r){case Ca:return new $h(e);case ta:return new ai(e);case sa:return new fi(e);case J:return new di(e);}}var qe=function(e){return e.reduce(function(e,$){return"string"==typeof $?e.push(qi($,null)):$.data&&e.push(qi($.data,$.mode)),e},[])};var Js=function(e,$){for(var r=Ks(Ls(li(e,be())),$),a=Ns.find_path(r.map,"start","end"),t=[],n=1;n<a.length-1;n++)t.push(r.table[a[n]].node);return qe(Ms(t))};var Hs=function(e){return qe(li(e,be()))};var Yd={};function Gs(r,e){for(var $=r.size,t=Wt(e),i=0;i<t.length;i++)for(var a=t[i][0],o=t[i][1],n=-1;n<=7;n++)if(!(a+n<=-1||$<=a+n))for(var s=-1;s<=7;s++)o+s<=-1||$<=o+s||(n>=0&&n<=6&&(0===s||6===s)||s>=0&&s<=6&&(0===n||6===n)||n>=2&&n<=4&&s>=2&&s<=4?r.set(a+n,o+s,!0,!0):r.set(a+n,o+s,!1,!0))}function Fs(r){for(var e=r.size,$=8;$<e-8;$++){var t=$%2==0;r.set($,6,t,!0),r.set(6,$,t,!0)}}function Ds(r,e){for(var $=Zt(e),t=0;t<$.length;t++)for(var i=$[t][0],a=$[t][1],o=-2;o<=2;o++)for(var n=-2;n<=2;n++)-2===o||2===o||-2===n||2===n||0===o&&0===n?r.set(i+o,a+n,!0,!0):r.set(i+o,a+n,!1,!0)}function Bs(r,e){for(var $,t,i,a=r.size,o=Vs(e),n=0;n<18;n++)$=Math.floor(n/3),t=n%3+a-8-3,i=1==(o>>n&1),r.set($,t,i,!0),r.set(t,$,i,!0)}function me(r,e,$){var t,i,a=r.size,o=Ss(e,$);for(t=0;t<15;t++)i=1==(o>>t&1),t<6?r.set(t,8,i,!0):t<8?r.set(t+1,8,i,!0):r.set(a-15+t,8,i,!0),t<8?r.set(8,a-t-1,i,!0):t<9?r.set(8,15-t-1+1,i,!0):r.set(8,15-t-1,i,!0);r.set(a-8,8,1,!0)}function As(r,e){for(var $=r.size,t=-1,i=$-1,a=7,o=0,n=$-1;n>0;n-=2)for(6===n&&n--;;){for(var s=0;s<2;s++)if(!r.isReserved(i,n-s)){var v=!1;o<e.length&&(v=1==(e[o]>>>a&1)),r.set(i,n-s,v),-1===--a&&(o++,a=7)}if((i+=t)<0||$<=i){i-=t,t=-t;break}}}function zs(r,e,$){var t=new eu;$.forEach(function(e){t.put(e.mode.bit,4),t.put(e.getLength(),ue(e.mode,r)),e.write(t)});var i=8*(Qe(r)-He(r,e));for(t.getLengthInBits()+4<=i&&t.put(0,4);t.getLengthInBits()%8!=0;)t.putBit(0);for(var a=(i-t.getLengthInBits())/8,o=0;o<a;o++)t.put(o%2?17:236,8);return ys(t,r,e)}function ys(r,e,$){for(var t=Qe(e),i=t-He(e,$),a=Dt(e,$),o=a-t%a,n=Math.floor(t/a),s=Math.floor(i/a),v=s+1,b=n-s,y=new xt(b),f=0,u=new Array(a),l=new Array(a),c=0,d=new I(r.buffer),m=0;m<a;m++){var p=m<o?s:v;u[m]=d.slice(f,f+p),l[m]=y.encode(u[m]),f+=p,c=Math.max(c,p)}var g,C,w=new I(t),h=0;for(g=0;g<c;g++)for(C=0;C<a;C++)g<u[C].length&&(w[h++]=u[C][g]);for(g=0;g<b;g++)for(C=0;C<a;C++)w[h++]=l[C][g];return w}function xs(r,e,$,t){var i;if(_e(r))i=qe(r);else{if("string"!=typeof r)throw new Error("Invalid data");var a=e;if(!a){var o=Hs(r);a=Uh(o,$)}i=Js(r,a||40)}var n=Uh(i,$);if(!n)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<n)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+n+".\n")}else e=n;var s=zs(e,$,i),v=Re(e),b=new du(v);return Gs(b,e),Fs(b),Ds(b,e),me(b,$,0),e>=7&&Bs(b,e),As(b,s),isNaN(t)&&(t=Ft(b,me.bind(null,b,$))),Je(t,b),me(b,$,t),{modules:b,version:e,errorCorrectionLevel:$,maskPattern:t,segments:i}}var ws=function(r,e){if(void 0===r||""===r)throw new Error("No input text");var $,t,i=zb;return void 0!==e&&(i=nm(e.errorCorrectionLevel,zb),$=Ws(e.version),t=Rt(e.maskPattern),e.toSJISFunc&&iu(e.toSJISFunc)),xs(r,$,i,t)};Yd.create=ws;var _={};function Gi(r){if("string"!=typeof r)throw new Error("Color should be defined as hex string");var t=r.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+r);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map(function(r){return[r,r]}))),6===t.length&&t.push("F","F");var e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:255&e,hex:"#"+t.slice(0,6).join("")}}var us=function(r){r||(r={}),r.color||(r.color={});var t=void 0===r.margin||null===r.margin||r.margin<0?4:r.margin,e=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:e,scale:e?4:o,margin:t,color:{dark:Gi(r.color.dark||"#000000ff"),light:Gi(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}};_.getOptions=us;var ts=function(r,t){return t.width&&t.width>=r+2*t.margin?t.width/(r+2*t.margin):t.scale};_.getScale=ts;var ss=function(r,t){var e=_.getScale(r,t);return Math.floor((r+2*t.margin)*e)};_.getImageWidth=ss;var rs=function(r,t,e){for(var o=t.modules.size,a=t.modules.data,n=_.getScale(o,e),i=Math.floor((o+2*e.margin)*n),$=e.margin*n,g=[e.color.light,e.color.dark],l=0;l<i;l++)for(var h=0;h<i;h++){var p=4*(l*i+h),c=e.color.light;if(l>=$&&h>=$&&l<i-$&&h<i-$)c=g[a[Math.floor((l-$)/n)*o+Math.floor((h-$)/n)]?1:0];r[p++]=c.r,r[p++]=c.g,r[p++]=c.b,r[p]=c.a}};_.qrToImageData=rs;function qs(e,t,r){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=r,t.width=r,t.style.height=r+"px",t.style.width=r+"px"}function ps(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}var Ni=function(e,t,r){var a=r,o=t;void 0!==a||t&&t.getContext||(a=t,t=void 0),t||(o=ps()),a=_.getOptions(a);var $=_.getImageWidth(e.modules.size,a),n=o.getContext("2d"),i=n.createImageData($,$);return _.qrToImageData(i.data,e,a),qs(n,o,$),n.putImageData(i,0,0),o};var os=function(e,t,r){var a=r;void 0!==a||t&&t.getContext||(a=t,t=void 0),a||(a={});var o=Ni(e,t,a),$=a.type||"image/png",n=a.rendererOpts||{};return o.toDataURL($,n.quality)};var Pi={};function Qi(r,t){var $=r.a/255,o=t+"=\""+r.hex+"\"";return $<1?o+" "+t+"-opacity=\""+$.toFixed(2).slice(1)+"\"":o}function ne(r,t,$){var o=r+t;return void 0!==$&&(o+=" "+$),o}function ns(r,t,$){for(var o="",e=0,a=!1,i=0,v=0;v<r.length;v++){var n=Math.floor(v%t),l=Math.floor(v/t);n||a||(a=!0),r[v]?(i++,v>0&&n>0&&r[v-1]||(o+=a?ne("M",n+$,.5+l+$):ne("m",e,0),e=0,a=!1),n+1<t&&r[v+1]||(o+=ne("h",i),i=0)):e++}return o}var ks=function(r,t,$){var o=_.getOptions(t),e=r.modules.size,a=r.modules.data,i=e+2*o.margin,v=o.color.light.a?"<path "+Qi(o.color.light,"fill")+" d=\"M0 0h"+i+"v"+i+"H0z\"/>":"",n="<path "+Qi(o.color.dark,"stroke")+" d=\""+ns(a,e,o.margin)+"\"/>",l="viewBox=\"0 0 "+i+" "+i+"\"",s="<svg xmlns=\"http://www.w3.org/2000/svg\" "+(o.width?"width=\""+o.width+"\" height=\""+o.width+"\" ":"")+l+" shape-rendering=\"crispEdges\">"+v+n+"</svg>\n";return"function"==typeof $&&$(null,s),s};Pi.render=ks;function pe(r,e,$,a,t){var n=[].slice.call(arguments,1),o=n.length,C="function"==typeof n[o-1];if(!C&&!wu())throw new Error("Callback required as last argument");if(!C){if(o<1)throw new Error("Too few arguments provided");return 1===o?($=e,e=a=void 0):2!==o||e.getContext||(a=$,$=e,e=void 0),new Promise(function(t,n){try{var o=Yd.create($,a);t(r(o,e,a))}catch(C){n(C)}})}if(o<2)throw new Error("Too few arguments provided");2===o?(t=$,$=e,e=a=void 0):3===o&&(e.getContext&&void 0===t?(t=a,a=void 0):(t=a,a=$,$=e,e=void 0));try{var x=Yd.create($,a);t(null,r(x,e,a))}catch(v){t(v)}}var TD=Yd.create;var hs=pe.bind(null,Ni);var UD=pe.bind(null,os);var VD=pe.bind(null,function(r,e,$){return Pi.render(r,$)});var Td={};var Zr=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};function X(t,e){function r(){this.constructor=t}Zr(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Xr={};!function(t){if(!t.fetch){var e={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(e.arrayBuffer)var r=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=function(t){return t&&DataView.prototype.isPrototypeOf(t)},n=ArrayBuffer.isView||function(t){return t&&r.indexOf(Object.prototype.toString.call(t))>-1};u.prototype.append=function(t,e){t=a(t),e=h(e);var r=this.map[t];this.map[t]=r?r+","+e:e},u.prototype.delete=function(t){delete this.map[a(t)]},u.prototype.get=function(t){return t=a(t),this.has(t)?this.map[t]:null},u.prototype.has=function(t){return this.map.hasOwnProperty(a(t))},u.prototype.set=function(t,e){this.map[a(t)]=h(e)},u.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},u.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),f(t)},u.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),f(t)},u.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),f(t)},e.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},c.call(b.prototype),c.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},w.error=function(){var t=new w(null,{status:0,statusText:""});return t.type="error",t};var s=[301,302,303,307,308];w.redirect=function(t,e){if(-1===s.indexOf(e))throw new RangeError("Invalid status code");return new w(null,{status:e,headers:{location:t}})},t.Headers=u,t.Request=b,t.Response=w,t.fetch=function(t,r){return new Promise(function(o,n){var i=new b(t,r),s=new XMLHttpRequest;s.onload=function(){var t,e,r={status:s.status,statusText:s.statusText,headers:(t=s.getAllResponseHeaders()||"",e=new u,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var r=t.split(":"),o=r.shift().trim();if(o){var n=r.join(":").trim();e.append(o,n)}}),e)};r.url="responseURL"in s?s.responseURL:r.headers.get("X-Request-URL");var n="response"in s?s.response:s.responseText;o(new w(n,r))},s.onerror=function(){n(new TypeError("Network request failed"))},s.ontimeout=function(){n(new TypeError("Network request failed"))},s.open(i.method,i.url,!0),"include"===i.credentials?s.withCredentials=!0:"omit"===i.credentials&&(s.withCredentials=!1),"responseType"in s&&e.blob&&(s.responseType="blob"),i.headers.forEach(function(t,e){s.setRequestHeader(e,t)}),s.send(void 0===i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}function a(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function h(t){return"string"!=typeof t&&(t=String(t)),t}function f(t){var r={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return e.iterable&&(r[Symbol.iterator]=function(){return r}),r}function u(t){this.map={},t instanceof u?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function d(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function y(t){return new Promise(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function p(t){var e=new FileReader,r=y(e);return e.readAsArrayBuffer(t),r}function l(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function c(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t){if("string"==typeof t)this._bodyText=t;else if(e.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(e.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(e.arrayBuffer&&e.blob&&o(t))this._bodyArrayBuffer=l(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!e.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!n(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(t)}}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},e.blob&&(this.blob=function(){var t=d(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(p)}),this.text=function(){var t,e,r,o=d(this);if(o)return o;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,r=y(e),e.readAsText(t),r;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),r=new Array(e.length),o=0;o<e.length;o++)r[o]=String.fromCharCode(e[o]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},e.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function b(t,e){var r,o,n=(e=e||{}).body;if(t instanceof b){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new u(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new u(e.headers)),this.method=(r=e.method||this.method||"GET",o=r.toUpperCase(),i.indexOf(o)>-1?o:r),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function m(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var r=t.split("="),o=r.shift().replace(/\+/g," "),n=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(o),decodeURIComponent(n))}}),e}function w(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new u(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:Xr);var Ur=setTimeout;function Tr(){}function Sr(r,e){return function(){r.apply(e,arguments)}}function o(r){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!=typeof r)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],kj(r,this)}function fj(r,e){for(;3===r._state;)r=r._value;0!==r._state?(r._handled=!0,o._immediateFn(function(){var n=1===r._state?e.onFulfilled:e.onRejected;if(null!==n){var t;try{t=n(r._value)}catch(o){return void kc(e.promise,o)}ye(e.promise,t)}else(1===r._state?ye:kc)(e.promise,r._value)})):r._deferreds.push(e)}function ye(r,e){try{if(e===r)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof o)return r._state=3,r._value=e,void Ae(r);if("function"==typeof n)return void kj(Sr(n,e),r)}r._state=1,r._value=e,Ae(r)}catch(t){kc(r,t)}}function kc(r,e){r._state=2,r._value=e,Ae(r)}function Ae(r){2===r._state&&0===r._deferreds.length&&o._immediateFn(function(){r._handled||o._unhandledRejectionFn(r._value)});for(var e=0,n=r._deferreds.length;e<n;e++)fj(r,r._deferreds[e]);r._deferreds=null}function Rr(r,e,n){this.onFulfilled="function"==typeof r?r:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function kj(r,e){var n=!1;try{r(function(r){n||(n=!0,ye(e,r))},function(r){n||(n=!0,kc(e,r))})}catch(t){if(n)return;n=!0,kc(e,t)}}o.prototype.catch=function(r){return this.then(null,r)},o.prototype.then=function(r,e){var n=new this.constructor(Tr);return fj(this,new Rr(r,e,n)),n},o.prototype.finally=function(r){var e=this.constructor;return this.then(function(n){return e.resolve(r()).then(function(){return n})},function(n){return e.resolve(r()).then(function(){return e.reject(n)})})},o.all=function(r){return new o(function(e,n){if(!r||void 0===r.length)throw new TypeError("Promise.all accepts an array");var t=Array.prototype.slice.call(r);if(0===t.length)return e([]);var o=t.length;function $(r,i){try{if(i&&("object"==typeof i||"function"==typeof i)){var a=i.then;if("function"==typeof a)return void a.call(i,function(e){$(r,e)},n)}t[r]=i,0==--o&&e(t)}catch(f){n(f)}}for(var i=0;i<t.length;i++)$(i,t[i])})},o.resolve=function(r){return r&&"object"==typeof r&&r.constructor===o?r:new o(function(e){e(r)})},o.reject=function(r){return new o(function(e,n){n(r)})},o.race=function(r){return new o(function(e,n){for(var t=0,o=r.length;t<o;t++)r[t].then(e,n)})},o._immediateFn="function"==typeof setImmediate&&function(r){setImmediate(r)}||function(r){Ur(r,0)},o._unhandledRejectionFn=function(r){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",r)};var lj=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof S)return S;throw new Error("unable to locate global object")}();lj.Promise||(lj.Promise=o);var pa,Qr,Pr=false;function oa(){if(Pr)return;Pr=true;pa={};Qr=pa="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=Qr)}var Fe,Or,Mq=false;function Ie(){if(Mq)return;Mq=true;Fe={};Or=Fe={version:"2.5.5"};"number"==typeof __e&&(__e=Or)}var bb,Kq=false;function Sa(){if(Kq)return;Kq=true;bb={};bb=function(t){return"object"==typeof t?null!==t:"function"==typeof t}}var fe,xq,rq=false;function de(){if(rq)return;rq=true;fe={};xq=(Sa(),bb);fe=function(e){if(!xq(e))throw TypeError(e+" is not an object!");return e}}var wc,qq=false;function tc(){if(qq)return;qq=true;wc={};wc=function(r){try{return!!r()}catch(t){return!0}}}var xb,jq=false;function vb(){if(jq)return;jq=true;xb={};xb=!(tc(),wc)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})}var Hj,Ij,Ue,hq,gq=false;function Mj(){if(gq)return;gq=true;Hj={};Ij=(Sa(),bb);Ue=(oa(),pa).document;hq=Ij(Ue)&&Ij(Ue.createElement);Hj=function($){return hq?Ue.createElement($):{}}}var Nj,fq=false;function Pj(){if(fq)return;fq=true;Nj={};Nj=!(vb(),xb)&&!(tc(),wc)(function(){return 7!=Object.defineProperty((Mj(),Hj)("div"),"a",{get:function(){return 7}}).a})}var Xe,Nd,dq=false;function $e(){if(dq)return;dq=true;Xe={};Nd=(Sa(),bb);Xe=function(t,r){if(!Nd(t))return t;var e,$;if(r&&"function"==typeof(e=t.toString)&&!Nd($=e.call(t)))return $;if("function"==typeof(e=t.valueOf)&&!Nd($=e.call(t)))return $;if(!r&&"function"==typeof(e=t.toString)&&!Nd($=e.call(t)))return $;throw TypeError("Can't convert object to primitive value")}}var Na,Vj,cq,$p,Xp,Vp,Tp=false;function qb(){if(Tp)return;Tp=true;Na={};Vj=(de(),fe);cq=(Pj(),Nj);$p=($e(),Xe);Xp=Object.defineProperty;Vp=(vb(),xb)?Object.defineProperty:function(e,r,$){if(Vj(e),r=$p(r,!0),Vj($),cq)try{return Xp(e,r,$)}catch(n){}if("get"in $||"set"in $)throw TypeError("Accessors not supported!");return"value"in $&&(e[r]=$.value),e};Na.f=Vp}var Ed,Rp=false;function Cd(){if(Rp)return;Rp=true;Ed={};Ed=function(e,r){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:r}}}var Ra,Qp,Pp,Op=false;function $a(){if(Op)return;Op=true;Ra={};Qp=(qb(),Na);Pp=(Cd(),Ed);Ra=(vb(),xb)?function(r,e,$){return Qp.f(r,e,Pp(1,$))}:function(r,e,$){return r[e]=$,r}}var cb,Np,Mp=false;function hb(){if(Mp)return;Mp=true;cb={};Np={}.hasOwnProperty;cb=function(r,$){return Np.call(r,$)}}var oc,Ip,Hp,Fp=false;function Pc(){if(Fp)return;Fp=true;oc={};Ip=0;Hp=Math.random();oc=function($){return"Symbol(".concat(void 0===$?"":$,")_",(++Ip+Hp).toString(36))}}var uc,Ep,ee,uk,uf,vf,wf,Dp,Cp=false;function sc(){if(Cp)return;Cp=true;uc={};Ep=(oa(),pa);ee=($a(),Ra);uk=(hb(),cb);uf=(Pc(),oc)("src");vf="toString";wf=Function[vf];Dp=(""+wf).split(vf);(Ie(),Fe).inspectSource=function($){return wf.call($)},(uc=function($,t,r,o){var a="function"==typeof r;a&&(uk(r,"name")||ee(r,"name",t)),$[t]!==r&&(a&&(uk(r,uf)||ee(r,uf,$[t]?""+$[t]:Dp.join(String(t)))),$===Ep?$[t]=r:o?$[t]?$[t]=r:ee($,t,r):(delete $[t],ee($,t,r)))})(Function.prototype,vf,function(){return"function"==typeof this&&this[uf]||wf.call(this)})}var Bp={};Bp=function(o){if("function"!=typeof o)throw TypeError(o+" is not a function!");return o};var zf={};zf=function(r,n,t){if(Bp(r),void 0===n)return r;switch(t){case 1:return function(t){return r.call(n,t)};case 2:return function(t,u){return r.call(n,t,u)};case 3:return function(t,u,e){return r.call(n,t,u,e)};}return function(){return r.apply(n,arguments)}};var l={},mb=(oa(),pa),Wd=(Ie(),Fe),Ap=($a(),Ra),zp=(sc(),uc),Df="prototype",N=function($,r,i){var a,b,e,z,C=$&N.F,v=$&N.G,o=$&N.S,t=$&N.P,p=$&N.B,l=v?mb:o?mb[r]||(mb[r]={}):(mb[r]||{})[Df],x=v?Wd:Wd[r]||(Wd[r]={}),c=x[Df]||(x[Df]={});for(a in v&&(i=r),i)e=((b=!C&&l&&void 0!==l[a])?l:i)[a],z=p&&b?zf(e,mb):t&&"function"==typeof e?zf(Function.call,e):e,l&&zp(l,a,e,$&N.U),x[a]!=e&&Ap(x,a,z),t&&c[a]!=e&&(c[a]=e)};mb.core=Wd,N.F=1,N.G=2,N.S=4,N.P=8,N.B=16,N.W=32,N.U=64,N.R=128,l=N;var Qd,yp,xp=false;function Ld(){if(xp)return;xp=true;Qd={};yp={}.toString;Qd=function(r){return yp.call(r).slice(8,-1)}}var Hf,tp,sp=false;function If(){if(sp)return;sp=true;Hf={};tp=(Ld(),Qd);Hf=Object("z").propertyIsEnumerable(0)?Object:function(r){return"String"==tp(r)?r.split(""):Object(r)}}var Ec,rp=false;function Hc(){if(rp)return;rp=true;Ec={};Ec=function(r){if(null==r)throw TypeError("Can't call method on  "+r);return r}}var Lf={},qp=(Hc(),Ec);Lf=function(r){return Object(qp(r))};var $c,pp,np,mp=false;function Rd(){if(mp)return;mp=true;$c={};pp=Math.ceil;np=Math.floor;$c=function($){return isNaN($=+$)?0:($>0?np:pp)($)}}var Rf,lp,jp,ip=false;function Sf(){if(ip)return;ip=true;Rf={};lp=(Rd(),$c);jp=Math.min;Rf=function($){return $>0?jp(lp($),9007199254740991):0}}var Tf={},gp=(Ld(),Qd);Tf=Array.isArray||function(r){return"Array"==gp(r)};var Uf,il,jl,kl,dp=false;function Vf(){if(dp)return;dp=true;Uf={};il=(oa(),pa);jl="__core-js_shared__";kl=il[jl]||(il[jl]={});Uf=function($){return kl[$]||(kl[$]={})}}var t={},Xf=(Vf(),Uf)("wks"),ap=(Pc(),oc),Zf=(oa(),pa).Symbol,rl="function"==typeof Zf,Xo=t=function($){return Xf[$]||(Xf[$]=rl&&Zf[$]||(rl?Zf:ap)("Symbol."+$))};Xo.store=Xf;var To={},Ro=(Sa(),bb),Qo=t("species");To=function(r){var $;return Tf(r)&&("function"!=typeof($=r.constructor)||$!==Array&&!Tf($.prototype)||($=void 0),Ro($)&&null===($=$[Qo])&&($=void 0)),void 0===$?Array:$};var Po={};Po=function(r,s){return new(To(r))(s)};var xl={},Oo=(If(),Hf),No=(Sf(),Rf);xl=function(r,e){var $=1==r,t=2==r,u=3==r,a=4==r,c=6==r,h=5==r||c,A=e||Po;return function(e,P,i){for(var n,o,s=Lf(e),v=Oo(s),l=zf(P,i,3),p=No(v.length),f=0,b=$?A(e,p):t?A(e,0):void 0;p>f;f++)if((h||f in v)&&(o=l(n=v[f],f,s),r))if($)b[f]=o;else if(o)switch(r){case 3:return!0;case 5:return n;case 6:return f;case 2:b.push(n);}else if(a)return!1;return c?-1:u||a?a:b}};var Mo=xl(5),_f="find",Ko=!0;var Mc={},bg=t("unscopables"),cg=Array.prototype;null==cg[bg]&&($a(),Ra)(cg,bg,{}),Mc=function(r){cg[bg][r]=!0};_f in[]&&Array(1)[_f](function(){Ko=!1}),l(l.P+l.F*Ko,"Array",{find:function($){return Mo(this,$,arguments.length>1?arguments[1]:void 0)}}),Mc(_f);var Io=xl(6),dg="findIndex",Ho=!0;dg in[]&&Array(1)[dg](function(){Ho=!1}),l(l.P+l.F*Ho,"Array",{findIndex:function($){return Io(this,$,arguments.length>1?arguments[1]:void 0)}}),Mc(dg);var Gb,Go,Eo,Co=false;function Hb(){if(Co)return;Co=true;Gb={};Go=(If(),Hf);Eo=(Hc(),Ec);Gb=function($){return Go(Eo($))}}var Bo,Ao,zo,yo,xo=false;function vo(){if(xo)return;xo=true;Bo={};Ao=(Rd(),$c);zo=Math.max;yo=Math.min;Bo=function($,r){return($=Ao($))<0?zo($+r,0):yo($,r)}}var uo,to,so,ro,qo=false;function po(){if(qo)return;qo=true;uo={};to=(Hb(),Gb);so=(Sf(),Rf);ro=(vo(),Bo);uo=function(e){return function(r,$,t){var a,o=to(r),n=so(o.length),u=ro(t,n);if(e&&$!=$){for(;n>u;)if((a=o[u++])!=a)return!0}else for(;n>u;u++)if((e||u in o)&&o[u]===$)return e||u||0;return!e&&-1}}}var ug,_l,oo,no=false;function wg(){if(no)return;no=true;ug={};_l=(Vf(),Uf)("keys");oo=(Pc(),oc);ug=function($){return _l[$]||(_l[$]=oo($))}}var dm,em,mo,lo,ko,jo=false;function jm(){if(jo)return;jo=true;dm={};em=(hb(),cb);mo=(Hb(),Gb);lo=(po(),uo)(!1);ko=(wg(),ug)("IE_PROTO");dm=function($,r){var a,v=mo($),e=0,L=[];for(a in v)a!=ko&&em(v,a)&&L.push(a);for(;r.length>e;)em(v,a=r[e++])&&(~lo(L,a)||L.push(a));return L}}var Ag,ho=false;function Cg(){if(ho)return;ho=true;Ag={};Ag="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")}var Ob={},fo=(jm(),dm),eo=(Cg(),Ag);Ob=Object.keys||function(e){return fo(e,eo)};var od,bo,ao=false;function Hg(){if(ao)return;ao=true;od={};bo=Object.getOwnPropertySymbols;od.f=bo}var xc,_n,$n=false;function Pd(){if($n)return;$n=true;xc={};_n={}.propertyIsEnumerable;xc.f=_n}var Yn={},Qn=(Hg(),od),On=(Pd(),xc),Mn=(If(),Hf),Kd=Object.assign;Yn=!Kd||(tc(),wc)(function(){var e={},$={},r=Symbol(),p="abcdefghijklmnopqrst";return e[r]=7,p.split("").forEach(function(e){$[e]=e}),7!=Kd({},e)[r]||Object.keys(Kd({},$)).join("")!=p})?function(e,$){for(var r=Lf(e),p=arguments.length,a=1,t=Qn.f,c=On.f;p>a;)for(var B,s=Mn(arguments[a++]),i=t?Ob(s).concat(t(s)):Ob(s),o=i.length,v=0;o>v;)c.call(s,B=i[v++])&&(r[B]=s[B]);return r}:Kd;l(l.S+l.F,"Object",{assign:Yn});var Ln={},Gn=(Sa(),bb),Fn=(Ld(),Qd),En=t("match");Ln=function($){var r;return Gn($)&&(void 0!==(r=$[En])?!!r:"RegExp"==Fn($))};var Dn={},Bn=(Hc(),Ec);Dn=function(e,r,$){if(Ln(r))throw TypeError("String#"+$+" doesn't accept regex!");return String(Bn(e))};var zn=(Sf(),Rf),Tg="startsWith",Lm=""[Tg];var wn={},mn=t("match");wn=function(r){var $=/./;try{"/./"[r]($)}catch(t){try{return $[mn]=!1,!"/./"[r]($)}catch(a){}}return!0};l(l.P+l.F*wn(Tg),"String",{startsWith:function($){var r=Dn(this,$,Tg),t=zn(Math.min(arguments.length>1?arguments[1]:void 0,r.length)),e=String($);return Lm?Lm.call(r,e,t):r.slice(t,t+e.length)===e}});var kn={},jn=(Rd(),$c),gn=(Hc(),Ec);kn=function(e){var r=String(gn(this)),$="",t=jn(e);if(t<0||t==1/0)throw RangeError("Count can't be negative");for(;t>0;(t>>>=1)&&(r+=r))1&t&&($+=r);return $};l(l.P,"String",{repeat:kn});var fn={},Ua=(Pc(),oc)("meta"),cn=(Sa(),bb),Zg=(hb(),cb),Zm=(qb(),Na).f,Ym=0,pd=Object.isExtensible||function(){return!0},xv=!(tc(),wc)(function(){return pd(Object.preventExtensions({}))}),$g=function($){Zm($,Ua,{value:{i:"O"+ ++Ym,w:{}}})},$m=function($,e){if(!cn($))return"symbol"==typeof $?$:("string"==typeof $?"S":"P")+$;if(!Zg($,Ua)){if(!pd($))return"F";if(!e)return"E";$g($)}return $[Ua].i},_m=function($,e){if(!Zg($,Ua)){if(!pd($))return!0;if(!e)return!1;$g($)}return $[Ua].w},an=function($){return xv&&bn.NEED&&pd($)&&!Zg($,Ua)&&$g($),$},bn=fn={KEY:Ua,NEED:!1,fastKey:$m,getWeak:_m,onFreeze:an};var gc={},dn=(qb(),Na).f,en=(hb(),cb),Rm=t("toStringTag");gc=function(r,$,q){r&&!en(r=q?r:r.prototype,Rm)&&dn(r,Rm,{configurable:!0,value:$})};var Wg,hn=false;function Vg(){if(hn)return;hn=true;Wg={};Wg=!1}var Ug={},ln=(oa(),pa),Nm=(Ie(),Fe),nn=(Vg(),Wg),on=(qb(),Na).f;Ug=function(r){var $=Nm.Symbol||(Nm.Symbol=nn?{}:ln.Symbol||{});"_"==r.charAt(0)||r in $||on($,r,{value:t(r)})};var pn={},qn=(Hg(),od),rn=(Pd(),xc);pn=function($){var j=Ob($),r=qn.f;if(r)for(var e,a=r($),w=rn.f,p=0;a.length>p;)w.call($,e=a[p++])&&j.push(e);return j};var sn={},tn=(qb(),Na),un=(de(),fe);sn=(vb(),xb)?Object.defineProperties:function(e,$){un(e);for(var r,M=Ob($),i=M.length,a=0;i>a;)tn.f(e,r=M[a++],$[r]);return e};var vn,Mm,xn=false;function yn(){if(xn)return;xn=true;vn={};Mm=(oa(),pa).document;vn=Mm&&Mm.documentElement}var $b={},An=(de(),fe),Im=(Cg(),Ag),Cn=(wg(),ug)("IE_PROTO"),Rg=function(){},Qg="prototype",Pg=function(){var $,a=(Mj(),Hj)("iframe"),e=Im.length;for(a.style.display="none",(yn(),vn).appendChild(a),a.src="javascript:",($=a.contentWindow.document).open(),$.write("<script>document.F=Object</script>"),$.close(),Pg=$.F;e--;)delete Pg[Qg][Im[e]];return Pg()};$b=Object.create||function($,a){var e;return null!==$?(Rg[Qg]=An($),e=new Rg,Rg[Qg]=null,e[Cn]=$):e=Pg(),void 0===a?e:sn(e,a)};var Og,Hn,In,Jn,Kn=false;function Dm(){if(Kn)return;Kn=true;Og={};Hn=(jm(),dm);In=(Cg(),Ag).concat("length","prototype");Jn=Object.getOwnPropertyNames||function(e){return Hn(e,In)};Og.f=Jn}var Mg={},Nn=(Hb(),Gb),Am=(Dm(),Og).f,Pn={}.toString,zm="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Rn=function($){try{return Am($)}catch(o){return zm.slice()}};Mg.f=function($){return zm&&"[object Window]"==Pn.call($)?Rn($):Am(Nn($))};var Sn=(Pd(),xc),Tn=(Cd(),Ed),Un=(Hb(),Gb),Vn=($e(),Xe),Wn=(hb(),cb),Xn=(Pj(),Nj),ym=Object.getOwnPropertyDescriptor,Zn=(vb(),xb)?ym:function($,r){if($=Un($),r=Vn(r,!0),Xn)try{return ym($,r)}catch(e){}if(Wn($,r))return Tn(!Sn.f.call($,r),$[r])};var Zd=(oa(),pa),s=(hb(),cb),Gg=(vb(),xb),rm=(sc(),uc),co=fn.KEY,pm=(tc(),wc),Eg=(Vf(),Uf),go=(Pc(),oc),Bg=(de(),fe),io=(Sa(),bb),Vd=(Hb(),Gb),yg=($e(),Xe),xg=(Cd(),Ed),fm=(qb(),Na),bm=Zn,Qa=fm.f,Zl=Mg.f,W=Zd.Symbol,ad=Zd.JSON,cd=ad&&ad.stringify,xa="prototype",P=t("_hidden"),Tl=t("toPrimitive"),wo={}.propertyIsEnumerable,mc=Eg("symbol-registry"),qa=Eg("symbols"),lc=Eg("op-symbols"),V=Object[xa],kb="function"==typeof W,ig=Zd.QObject,Do=!ig||!ig[xa]||!ig[xa].findChild,hg=Gg&&pm(function(){return 7!=$b(Qa({},"a",{get:function(){return Qa(this,"a",{value:7}).a}})).a})?function($,r,n){var a=bm(V,r);a&&delete V[r],Qa($,r,n),a&&$!==V&&Qa(V,r,a)}:Qa,Fo=function($){var r=qa[$]=$b(W[xa]);return r._k=$,r},gg=kb&&"symbol"==typeof W.iterator?function($){return"symbol"==typeof $}:function($){return $ instanceof W},$d=function($,r,n){return $===V&&$d(lc,r,n),Bg($),r=yg(r,!0),Bg(n),s(qa,r)?(n.enumerable?(s($,P)&&$[P][r]&&($[P][r]=!1),n=$b(n,{enumerable:xg(0,!1)})):(s($,P)||Qa($,P,xg(1,{})),$[P][r]=!0),hg($,r,n)):Qa($,r,n)},Gl=function($,r){Bg($);for(var n,a=pn(r=Vd(r)),e=0,u=a.length;u>e;)$d($,n=a[e++],r[n]);return $},Jo=function($,r){return void 0===r?$b($):Gl($b($),r)},Cl=function($){var r=wo.call(this,$=yg($,!0));return!(this===V&&s(qa,$)&&!s(lc,$))&&(!(r||!s(this,$)||!s(qa,$)||s(this,P)&&this[P][$])||r)},Lo=function($,r){if($=Vd($),r=yg(r,!0),$!==V||!s(qa,r)||s(lc,r)){var n=bm($,r);return!n||!s(qa,r)||s($,P)&&$[P][r]||(n.enumerable=!0),n}},Al=function($){for(var r,n=Zl(Vd($)),a=[],e=0;n.length>e;)s(qa,r=n[e++])||r==P||r==co||a.push(r);return a},zl=function($){for(var r,n=$===V,a=Zl(n?lc:Vd($)),e=[],u=0;a.length>u;)!s(qa,r=a[u++])||n&&!s(V,r)||e.push(qa[r]);return e};kb||(rm((W=function(){if(this instanceof W)throw TypeError("Symbol is not a constructor!");var $=go(arguments.length>0?arguments[0]:void 0),r=function(n){this===V&&r.call(lc,n),s(this,P)&&s(this[P],$)&&(this[P][$]=!1),hg(this,$,xg(1,n))};return Gg&&Do&&hg(V,$,{configurable:!0,set:r}),Fo($)})[xa],"toString",function(){return this._k}),fm.f=$d,(Dm(),Og).f=Mg.f=Al,(Pd(),xc).f=Cl,(Hg(),od).f=zl,Gg&&!(Vg(),Wg)&&rm(V,"propertyIsEnumerable",Cl,!0)),l(l.G+l.W+l.F*!kb,{Symbol:W});for(var yl="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),wl=0;yl.length>wl;)t(yl[wl++]);for(var vl=Ob(t.store),ul=0;vl.length>ul;)Ug(vl[ul++]);l(l.S+l.F*!kb,"Symbol",{for:function($){return s(mc,$+="")?mc[$]:mc[$]=W($)},keyFor:function($){if(!gg($))throw TypeError($+" is not a symbol!");for(var r in mc)if(mc[r]===$)return r},useSetter:function(){Do=!0},useSimple:function(){Do=!1}}),l(l.S+l.F*!kb,"Object",{create:Jo,defineProperty:$d,defineProperties:Gl,getOwnPropertyDescriptor:Lo,getOwnPropertyNames:Al,getOwnPropertySymbols:zl}),ad&&l(l.S+l.F*(!kb||pm(function(){var $=W();return"[null]"!=cd([$])||"{}"!=cd({a:$})||"{}"!=cd(Object($))})),"JSON",{stringify:function($){for(var r,n,a=[$],e=1;arguments.length>e;)a.push(arguments[e++]);if(n=r=a[1],(io(r)||void 0!==$)&&!gg($))return Tf(r)||(r=function($,r){if("function"==typeof n&&(r=n.call(this,$,r)),!gg(r))return r}),a[1]=r,cd.apply(ad,a)}}),W[xa][Tl]||($a(),Ra)(W[xa],Tl,W[xa].valueOf),gc(W,"Symbol"),gc(Math,"Math",!0),gc(Zd.JSON,"JSON",!0);var So={},$f=(Ld(),Qd),Uo=t("toStringTag"),Vo="Arguments"==$f(function(){return arguments}()),Wo=function($,r){try{return $[r]}catch(t){}};So=function($){var r,t,e;return void 0===$?"Undefined":null===$?"Null":"string"==typeof(t=Wo(r=Object($),Uo))?t:Vo?$f(r):"Object"==(e=$f(r))&&"function"==typeof r.callee?"Arguments":e};var sl={};sl[t("toStringTag")]="z",sl+""!="[object z]"&&(sc(),uc)(Object.prototype,"toString",function(){return"[object "+So(this)+"]"},!0);Ug("asyncIterator");Ug("observable");var Yo={},Zo=(Rd(),$c),$o=(Hc(),Ec);Yo=function(e){return function(r,$){var t,n,a=String($o(r)),i=Zo($),o=a.length;return i<0||i>=o?e?"":void 0:(t=a.charCodeAt(i))<55296||t>56319||i+1===o||(n=a.charCodeAt(i+1))<56320||n>57343?e?a.charAt(i):t:e?a.slice(i,i+2):n-56320+(t-55296<<10)+65536}};var _o=Yo(!0);var Cb={};Cb={};var bp={},cp=(Cd(),Ed),ll={};($a(),Ra)(ll,t("iterator"),function(){return this}),bp=function(e,r,$){e.prototype=$b(ll,{next:cp(1,$)}),gc(e,r+" Iterator")};var ep={},fp=(hb(),cb),gl=(wg(),ug)("IE_PROTO"),hp=Object.prototype;ep=Object.getPrototypeOf||function($){return $=Lf($),fp($,gl)?$[gl]:"function"==typeof $.constructor&&$ instanceof $.constructor?$.constructor.prototype:$ instanceof Object?hp:null};var dl={},cl=(Vg(),Wg),kp=(sc(),uc),bl=($a(),Ra),qc=t("iterator"),Of=!([].keys&&"next"in[].keys()),op="@@iterator",Yk="keys",yd="values",Tk=function(){return this};dl=function($,r,e,a,t,U,m){bp(e,r,a);var H,i,v,n=function($){if(!Of&&$ in c)return c[$];switch($){case Yk:case yd:return function(){return new e(this,$)};}return function(){return new e(this,$)}},o=r+" Iterator",s=t==yd,u=!1,c=$.prototype,p=c[qc]||c[op]||t&&c[t],T=p||n(t),R=t?s?n("entries"):T:void 0,f="Array"==r&&c.entries||p;if(f&&(v=ep(f.call(new $)))!==Object.prototype&&v.next&&(gc(v,o,!0),cl||"function"==typeof v[qc]||bl(v,qc,Tk)),s&&p&&p.name!==yd&&(u=!0,T=function(){return p.call(this)}),cl&&!m||!Of&&!u&&c[qc]||bl(c,qc,T),Cb[r]=T,Cb[o]=Tk,t)if(H={values:s?T:n(yd),keys:U?T:n(Yk),entries:R},m)for(i in H)i in c||kp(c,i,H[i]);else l(l.P+l.F*(Of||u),r,H);return H};dl(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,i=this._t,r=this._i;return r>=i.length?{value:void 0,done:!0}:(t=_o(i,r),this._i+=t.length,{value:t,done:!1})});var Qk={};Qk=function(e,r){return{value:r,done:!!e}};var Pk={},up=(Hb(),Gb);Pk=dl(Array,"Array",function(r,$){this._t=up(r),this._i=0,this._k=$},function(){var r=this._t,$=this._k,e=this._i++;return!r||e>=r.length?(this._t=void 0,Qk(1)):Qk(0,"keys"==$?e:"values"==$?r[e]:[e,r[e]])},"values"),Cb.Arguments=Cb.Array,Mc("keys"),Mc("values"),Mc("entries");for(var vp=(sc(),uc),wp=(oa(),pa),Mk=($a(),Ra),Lk=t("iterator"),Hk=t("toStringTag"),Gk=Cb.Array,Bk={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},zk=Ob(Bk),xf=0;xf<zk.length;xf++){var Vc,_c=zk[xf],Gp=Bk[_c],ok=wp[_c],jb=ok&&ok.prototype;if(jb&&(jb[Lk]||Mk(jb,Lk,Gk),jb[Hk]||Mk(jb,Hk,_c),Cb[_c]=Gk,Gp))for(Vc in Pk)jb[Vc]||vp(jb,Vc,Pk[Vc],!0)}var WD=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t};function Kp(t,e,r,o){return new(r||(r=Promise))(function(n,a){function $(t){try{_(o.next(t))}catch(e){a(e)}}function x(t){try{_(o.throw(t))}catch(e){a(e)}}function _(t){t.done?n(t.value):new r(function(e){e(t.value)}).then($,x)}_((o=o.apply(t,e||[])).next())})}function Lp(t,e){var r,o,n,a,$={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:x(0),throw:x(1),return:x(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function x(a){return function(x){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;$;)try{if(r=1,o&&(n=o[2&a[0]?"return":a[0]?"throw":"next"])&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[0,n.value]),a[0]){case 0:case 1:n=a;break;case 4:return $.label++,{value:a[1],done:!1};case 5:$.label++,o=a[1],a=[0];continue;case 7:a=$.ops.pop(),$.trys.pop();continue;default:if(!(n=(n=$.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){$=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){$.label=a[1];break}if(6===a[0]&&$.label<n[1]){$.label=n[1],n=a;break}if(n&&$.label<n[2]){$.label=n[2],$.ops.push(a);break}n[2]&&$.ops.pop(),$.trys.pop();continue;}a=e.call(t,$)}catch(x){a=[6,x],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,x])}}}function kk(t){return this instanceof kk?(this.v=t,this):new kk(t)}var b={};Object.defineProperty(b,"__esModule",{value:!0});var qd={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},fk=function(r,e){if(!r)throw ek(e)},ek=function(r){return new Error("Firebase Database ("+qd.SDK_VERSION+") INTERNAL ASSERT FAILED: "+r)},bk=function(r){for(var e=[],t=0,$=0;$<r.length;$++){var a=r.charCodeAt($);a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=63&a|128):55296==(64512&a)&&$+1<r.length&&56320==(64512&r.charCodeAt($+1))?(a=65536+((1023&a)<<10)+(1023&r.charCodeAt(++$)),e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=63&a|128):(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=63&a|128)}return e},Sp=function(r){for(var e=[],t=0,$=0;t<r.length;){var a=r[t++];if(a<128)e[$++]=String.fromCharCode(a);else if(a>191&&a<224){var o=r[t++];e[$++]=String.fromCharCode((31&a)<<6|63&o)}else if(a>239&&a<365){var i=((7&a)<<18|(63&(o=r[t++]))<<12|(63&(n=r[t++]))<<6|63&r[t++])-65536;e[$++]=String.fromCharCode(55296+(i>>10)),e[$++]=String.fromCharCode(56320+(1023&i))}else{o=r[t++];var n=r[t++];e[$++]=String.fromCharCode((15&a)<<12|(63&o)<<6|63&n)}}return e.join("")},cf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,$=[],a=0;a<r.length;a+=3){var o=r[a],i=a+1<r.length,n=i?r[a+1]:0,s=a+2<r.length,x=s?r[a+2]:0,A=o>>2,c=(3&o)<<4|n>>4,v=(15&n)<<2|x>>6,p=63&x;s||(p=64,i||(v=64)),$.push(t[A],t[c],t[v],t[p])}return $.join("")},encodeString:function(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(bk(r),e)},decodeString:function(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):Sp(this.decodeStringToByteArray(r,e))},decodeStringToByteArray:function(r,e){this.init_();for(var t=e?this.charToByteMapWebSafe_:this.charToByteMap_,$=[],a=0;a<r.length;){var o=t[r.charAt(a++)],i=a<r.length?t[r.charAt(a)]:0,n=++a<r.length?t[r.charAt(a)]:64,s=++a<r.length?t[r.charAt(a)]:64;if(++a,null==o||null==i||null==n||null==s)throw Error();var x=o<<2|i>>4;if($.push(x),64!=n){var A=i<<4&240|n>>2;if($.push(A),64!=s){var c=n<<6&192|s;$.push(c)}}}return $},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}},Up=function(r){var e=bk(r);return cf.encodeByteArray(e,!0)},bf=function(r){try{return cf.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Wp(r){return af(void 0,r)}function af(r,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===r&&(r={});break;case Array:r=[];break;default:return e;}for(var t in e)e.hasOwnProperty(t)&&(r[t]=af(r[t],e[t]));return r}function Yp(r,e,t){r[e]=t}var Zp=function(){function r(){var r=this;this.promise=new Promise(function(e,t){r.resolve=e,r.reject=t})}return r.prototype.wrapCallback=function(r){var e=this;return function(t,$){t?e.reject(t):e.resolve($),"function"==typeof r&&(e.promise.catch(function(){}),1===r.length?r(t):r(t,$))}},r}(),Xj=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},_p=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xj())},aq=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},bq=function(){return!0===qd.NODE_CLIENT||!0===qd.NODE_ADMIN},Wj="FirebaseError",Ze=Error.captureStackTrace;function eq(r){var e=Ze;return Ze=r,e}var ub=function(){return function(r,e){if(this.code=r,this.message=e,Ze)Ze(this,Lj.prototype.create);else try{throw Error.apply(this,arguments)}catch(t){this.name=Wj,Object.defineProperty(this,"stack",{get:function(){return t.stack}})}}}();ub.prototype=Object.create(Error.prototype),ub.prototype.constructor=ub,ub.prototype.name=Wj;var Lj=function(){function r(r,e,t){this.service=r,this.serviceName=e,this.errors=t,this.pattern=/\{\$([^}]+)}/g}return r.prototype.create=function(r,e){void 0===e&&(e={});var t,$=this.errors[r],a=this.service+"/"+r;t=void 0===$?"Error":$.replace(this.pattern,function(r,t){var $=e[t];return void 0!==$?$.toString():"<"+t+"?>"}),t=this.serviceName+": "+t+" ("+a+").";var o=new ub(a,t);for(var i in e)e.hasOwnProperty(i)&&"_"!==i.slice(-1)&&(o[i]=e[i]);return o},r}();function Ve(r){return JSON.parse(r)}function iq(r){return JSON.stringify(r)}var jc=function(r){var e={},t={},$={},a="";try{var o=r.split(".");e=Ve(bf(o[0])||""),t=Ve(bf(o[1])||""),a=o[2],$=t.d||{},delete t.d}catch(i){}return{header:e,claims:t,data:$,signature:a}},kq=function(r){var e,t,$=jc(r).claims,a=Math.floor(new Date().getTime()/1e3);return"object"==typeof $&&($.hasOwnProperty("nbf")?e=$.nbf:$.hasOwnProperty("iat")&&(e=$.iat),t=$.hasOwnProperty("exp")?$.exp:e+86400),a&&e&&t&&a>=e&&a<=t},lq=function(r){var e=jc(r).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},mq=function(r){var e=jc(r).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},nq=function(r){var e=jc(r).claims;return"object"==typeof e&&!0===e.admin},oq=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},pq=function(r,e){if(Object.prototype.hasOwnProperty.call(r,e))return r[e]},Pe=function(r,e){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])},zj=function(r,e){return Pe(e,function(e,t){r[e]=t}),r},sq=function(r){return zj({},r)},tq=function(r){return"object"==typeof r&&null!==r},uq=function(r){for(var e in r)return!1;return!0},vq=function(r){var e=0;for(var t in r)e++;return e},wq=function(r,e,t){var $={};for(var a in r)$[a]=e.call(t,r[a],a,r);return $},yj=function(r,e,t){for(var $ in r)if(e.call(t,r[$],$,r))return $},yq=function(r,e,t){var $=yj(r,e,t);return $&&r[$]},zq=function(r){for(var e in r)return e},Aq=function(r){var e=[],t=0;for(var $ in r)e[t++]=r[$];return e},Bq=function(r,e){for(var t in r)if(Object.prototype.hasOwnProperty.call(r,t)&&!e(t,r[t]))return!1;return!0},Cq=function(r){var e=[];return Pe(r,function(r,t){Array.isArray(t)?t.forEach(function(t){e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}),e.length?"&"+e.join("&"):""},Dq=function(r){var e={};return r.replace(/^\?/,"").split("&").forEach(function(r){if(r){var t=r.split("=");e[t[0]]=t[1]}}),e},Eq=function(){return function(){this.blockSize=-1}}(),Fq=function(r){function e(){var e=r.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var t=1;t<e.blockSize;++t)e.pad_[t]=0;return e.reset(),e}return X(e,r),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(r,e){e||(e=0);var t=this.W_;if("string"==typeof r)for(var $=0;$<16;$++)t[$]=r.charCodeAt(e)<<24|r.charCodeAt(e+1)<<16|r.charCodeAt(e+2)<<8|r.charCodeAt(e+3),e+=4;else for($=0;$<16;$++)t[$]=r[e]<<24|r[e+1]<<16|r[e+2]<<8|r[e+3],e+=4;for($=16;$<80;$++){var a=t[$-3]^t[$-8]^t[$-14]^t[$-16];t[$]=4294967295&(a<<1|a>>>31)}var o,i,n=this.chain_[0],s=this.chain_[1],x=this.chain_[2],A=this.chain_[3],c=this.chain_[4];for($=0;$<80;$++){$<40?$<20?(o=A^s&(x^A),i=1518500249):(o=s^x^A,i=1859775393):$<60?(o=s&x|A&(s|x),i=2400959708):(o=s^x^A,i=3395469782);a=(n<<5|n>>>27)+o+c+i+t[$]&4294967295;c=A,A=x,x=4294967295&(s<<30|s>>>2),s=n,n=a}this.chain_[0]=this.chain_[0]+n&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+x&4294967295,this.chain_[3]=this.chain_[3]+A&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},e.prototype.update=function(r,e){if(null!=r){void 0===e&&(e=r.length);for(var t=e-this.blockSize,$=0,a=this.buf_,o=this.inbuf_;$<e;){if(0==o)for(;$<=t;)this.compress_(r,$),$+=this.blockSize;if("string"==typeof r){for(;$<e;)if(a[o]=r.charCodeAt($),++$,++o==this.blockSize){this.compress_(a),o=0;break}}else for(;$<e;)if(a[o]=r[$],++$,++o==this.blockSize){this.compress_(a),o=0;break}}this.inbuf_=o,this.total_+=e}},e.prototype.digest=function(){var r=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var t=this.blockSize-1;t>=56;t--)this.buf_[t]=255&e,e/=256;this.compress_(this.buf_);var $=0;for(t=0;t<5;t++)for(var a=24;a>=0;a-=8)r[$]=this.chain_[t]>>a&255,++$;return r},e}(Eq);function Gq(r,e){var t=new Hq(r,e);return t.subscribe.bind(t)}var Hq=function(){function r(r,e){var t=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){r(t)}).catch(function(r){t.error(r)})}return r.prototype.next=function(r){this.forEachObserver(function(e){e.next(r)})},r.prototype.error=function(r){this.forEachObserver(function(e){e.error(r)}),this.close(r)},r.prototype.complete=function(){this.forEachObserver(function(r){r.complete()}),this.close()},r.prototype.subscribe=function(r,e,t){var $,a=this;if(void 0===r&&void 0===e&&void 0===t)throw new Error("Missing Observer.");void 0===($=Jq(r,["next","error","complete"])?r:{next:r,error:e,complete:t}).next&&($.next=Ke),void 0===$.error&&($.error=Ke),void 0===$.complete&&($.complete=Ke);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{a.finalError?$.error(a.finalError):$.complete()}catch(r){}}),this.observers.push($),o},r.prototype.unsubscribeOne=function(r){void 0!==this.observers&&void 0!==this.observers[r]&&(delete this.observers[r],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},r.prototype.forEachObserver=function(r){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,r)},r.prototype.sendOne=function(r,e){var t=this;this.task.then(function(){if(void 0!==t.observers&&void 0!==t.observers[r])try{e(t.observers[r])}catch($){"undefined"!=typeof console&&console.error&&console.error($)}})},r.prototype.close=function(r){var e=this;this.finalized||(this.finalized=!0,void 0!==r&&(this.finalError=r),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},r}();function Iq(r,e){return function(){for(var t=[],$=0;$<arguments.length;$++)t[$]=arguments[$];Promise.resolve(!0).then(function(){r.apply(void 0,t)}).catch(function(r){e&&e(r)})}}function Jq(r,e){if("object"!=typeof r||null===r)return!1;for(var t=0,$=e;t<$.length;t++){var a=$[t];if(a in r&&"function"==typeof r[a])return!0}return!1}function Ke(){}var Lq=function(r,e,t,$){var a;if($<e?a="at least "+e:$>t&&(a=0===t?"none":"no more than "+t),a)throw new Error(r+" failed: Was called with "+$+(1===$?" argument.":" arguments.")+" Expects "+a+".")};function ld(r,e,t){var $="";switch(e){case 1:$=t?"first":"First";break;case 2:$=t?"second":"Second";break;case 3:$=t?"third":"Third";break;case 4:$=t?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?");}var a=r+" failed: ";return a+=$+" argument "}function Nq(r,e,t,$){if((!$||t)&&"string"!=typeof t)throw new Error(ld(r,e,$)+"must be a valid firebase namespace.")}function Oq(r,e,t,$){if((!$||t)&&"function"!=typeof t)throw new Error(ld(r,e,$)+"must be a valid function.")}function Pq(r,e,t,$){if((!$||t)&&("object"!=typeof t||null===t))throw new Error(ld(r,e,$)+"must be a valid context object.")}var Qq=function(r){for(var e=[],t=0,$=0;$<r.length;$++){var a=r.charCodeAt($);if(a>=55296&&a<=56319){var o=a-55296;fk(++$<r.length,"Surrogate pair missing trail surrogate."),a=65536+(o<<10)+(r.charCodeAt($)-56320)}a<128?e[t++]=a:a<2048?(e[t++]=a>>6|192,e[t++]=63&a|128):a<65536?(e[t++]=a>>12|224,e[t++]=a>>6&63|128,e[t++]=63&a|128):(e[t++]=a>>18|240,e[t++]=a>>12&63|128,e[t++]=a>>6&63|128,e[t++]=63&a|128)}return e},Rq=function(r){for(var e=0,t=0;t<r.length;t++){var $=r.charCodeAt(t);$<128?e++:$<2048?e+=2:$>=55296&&$<=56319?(e+=4,t++):e+=3}return e},Sq=fk;b.assert=Sq;var Tq=ek;b.assertionError=Tq;var Uq=cf;b.base64=Uq;var Vq=bf;b.base64Decode=Vq;var Wq=Up;b.base64Encode=Wq;var Xq=qd;b.CONSTANTS=Xq;var Yq=Wp;b.deepCopy=Yq;var Zq=af;b.deepExtend=Zq;var $q=Yp;b.patchProperty=$q;var _q=Zp;b.Deferred=_q;var ar=Xj;b.getUA=ar;var br=_p;b.isMobileCordova=br;var cr=bq;b.isNodeSdk=cr;var dr=aq;b.isReactNative=dr;var er=Lj;b.ErrorFactory=er;var fr=ub;b.FirebaseError=fr;var gr=eq;b.patchCapture=gr;var hr=Ve;b.jsonEval=hr;var ir=iq;b.stringify=ir;var jr=jc;b.decode=jr;var kr=nq;b.isAdmin=kr;var lr=lq;b.issuedAtTime=lr;var mr=mq;b.isValidFormat=mr;var nr=kq;b.isValidTimestamp=nr;var or=sq;b.clone=or;var pr=oq;b.contains=pr;var qr=Bq;b.every=qr;var rr=zj;b.extend=rr;var sr=yj;b.findKey=sr;var tr=yq;b.findValue=tr;var ur=Pe;b.forEach=ur;var vr=zq;b.getAnyKey=vr;var wr=vq;b.getCount=wr;var xr=Aq;b.getValues=xr;var yr=uq;b.isEmpty=yr;var zr=tq;b.isNonNullObject=zr;var Ar=wq;b.map=Ar;var Br=pq;b.safeGet=Br;var Cr=Cq;b.querystring=Cr;var Dr=Dq;b.querystringDecode=Dr;var Er=Fq;b.Sha1=Er;var Fr=Iq;b.async=Fr;var Gr=Gq;b.createSubscribe=Gr;var Hr=ld;b.errorPrefix=Hr;var Ir=Lq;b.validateArgCount=Ir;var Jr=Oq;b.validateCallback=Jr;var Kr=Pq;b.validateContextObject=Kr;var Lr=Nq;b.validateNamespace=Lr;var Mr=Rq;b.stringLength=Mr;var Nr=Qq;b.stringToByteArray=Nr;var fc={};Object.defineProperty(fc,"__esModule",{value:!0});var oj=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},rd="[DEFAULT]",Be=[],Kb=function(){function e(e,r,t){this.firebase_=t,this.isDeleted_=!1,this.services_={},this.name_=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled||!1,this.options_=b.deepCopy(e),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(e){Be.push(e),setTimeout(function(){return e(null)},0)},removeAuthTokenListener:function(e){Be=Be.filter(function(r){return r!==e})}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed_(),this._automaticDataCollectionEnabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(r){e.checkDestroyed_(),r()}).then(function(){e.firebase_.INTERNAL.removeApp(e.name_);var r=[];return Object.keys(e.services_).forEach(function(t){Object.keys(e.services_[t]).forEach(function(a){r.push(e.services_[t][a])})}),Promise.all(r.map(function(e){return e.INTERNAL.delete()}))}).then(function(){e.isDeleted_=!0,e.services_={}})},e.prototype._getService=function(e,r){if(void 0===r&&(r=rd),this.checkDestroyed_(),this.services_[e]||(this.services_[e]={}),!this.services_[e][r]){var t=r!==rd?r:void 0,a=this.firebase_.INTERNAL.factories[e](this,this.extendApp.bind(this),t);this.services_[e][r]=a}return this.services_[e][r]},e.prototype.extendApp=function(e){var r=this;b.deepExtend(this,e),e.INTERNAL&&e.INTERNAL.addAuthTokenListener&&(Be.forEach(function(e){r.INTERNAL.addAuthTokenListener(e)}),Be=[])},e.prototype.checkDestroyed_=function(){this.isDeleted_&&Lb("app-deleted",{name:this.name_})},e}();function cj(){var e={},r={},t={},a={__esModule:!0,initializeApp:function(r,t){void 0===t&&(t={});if("object"!=typeof t||null===t){var n=t;t={name:n}}var i=t;void 0===i.name&&(i.name=rd);var s=i.name;"string"==typeof s&&s||Lb("bad-app-name",{name:s+""});oj(e,s)&&Lb("duplicate-app",{name:s});var $=new Kb(r,i,a);return e[s]=$,o($,"create"),$},app:n,apps:null,Promise:Promise,SDK_VERSION:"5.8.3",INTERNAL:{registerService:function(e,o,s,$,p){r[e]&&Lb("duplicate-service",{name:e});r[e]=o,$&&(t[e]=$,i().forEach(function(e){$("create",e)}));var d=function(r){return void 0===r&&(r=n()),"function"!=typeof r[e]&&Lb("invalid-app-argument",{name:e}),r[e]()};void 0!==s&&b.deepExtend(d,s);return a[e]=d,Kb.prototype[e]=function(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return this._getService.bind(this,e).apply(this,p?r:[])},d},createFirebaseNamespace:cj,extendNamespace:function(e){b.deepExtend(a,e)},createSubscribe:b.createSubscribe,ErrorFactory:b.ErrorFactory,removeApp:function(r){o(e[r],"delete"),delete e[r]},factories:r,useAsService:s,Promise:Promise,deepExtend:b.deepExtend}};function n(r){return oj(e,r=r||rd)||Lb("no-app",{name:r}),e[r]}function i(){return Object.keys(e).map(function(r){return e[r]})}function o(e,a){Object.keys(r).forEach(function(r){var n=s(e,r);null!==n&&t[n]&&t[n](a,e)})}function s(e,r){if("serverAuth"===r)return null;var t=r;e.options;return t}return b.patchProperty(a,"default",a),Object.defineProperty(a,"apps",{get:i}),b.patchProperty(n,"App",Kb),a}function Lb(e,r){throw Wr.create(e,r)}Kb.prototype.name&&Kb.prototype.options||Kb.prototype.delete||console.log("dc");var Vr={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},Wr=new b.ErrorFactory("app","Firebase",Vr),aj=cj(),Yr=aj;fc.firebase=Yr;var ab=aj;fc.default=ab;var Yi={};function _r(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var as=_r(fc);Yi=as;(function(){var t,e=e||{},n=this;function i(t){return"string"==typeof t}function r(t){return"boolean"==typeof t}function o(){}function a(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function s(t){return null===t}function u(t){return"array"==a(t)}function c(t){var e=a(t);return"array"==e||"object"==e&&"number"==typeof t.length}function h(t){return"function"==a(t)}function f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var l="closure_uid_"+(1e9*Math.random()>>>0),d=0;function p(t,e,n){return t.call.apply(t.bind,arguments)}function v(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function m(t,e,n){return(m=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:v).apply(null,arguments)}function g(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var b=Date.now||function(){return+new Date};function y(t,e){function n(){}n.prototype=e.prototype,t.ob=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ed=function(t,n,i){for(var r=Array(arguments.length-2),o=2;o<arguments.length;o++)r[o-2]=arguments[o];return e.prototype[n].apply(t,r)}}function w(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0}function I(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function k(t){if(Error.captureStackTrace)Error.captureStackTrace(this,k);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function T(t,e){for(var n="",i=(t=t.split("%s")).length-1,r=0;r<i;r++)n+=t[r]+(r<e.length?e[r]:"%s");k.call(this,n+t[i])}function E(t,e){throw new T("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function A(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function S(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function N(){this.b=this.a=null}y(k,Error),k.prototype.name="CustomError",y(T,k),T.prototype.name="AssertionError",A.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var _=new A(function(){return new P},function(t){t.reset()});function O(){var t=lt,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function P(){this.next=this.b=this.a=null}N.prototype.add=function(t,e){var n=_.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},P.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},P.prototype.reset=function(){this.next=this.b=this.a=null};var D=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(i(t))return i(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},R=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,o=i(t)?t.split(""):t,a=0;a<r;a++)a in o&&e.call(n,o[a],a,t)};var C=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),o=i(t)?t.split(""):t,a=0;a<n;a++)a in o&&(r[a]=e.call(void 0,o[a],a,t));return r},L=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=i(t)?t.split(""):t,o=0;o<n;o++)if(o in r&&e.call(void 0,r[o],o,t))return!0;return!1};function x(t,e){return 0<=D(t,e)}function M(t,e){var n;return(n=0<=(e=D(t,e)))&&Array.prototype.splice.call(t,e,1),n}function j(t,e){!function(t,e){var n=t.length,r=i(t)?t.split(""):t;for(--n;0<=n;--n)n in r&&e.call(void 0,r[n],n,t)}(t,function(n,i){e.call(void 0,n,i,t)&&1==Array.prototype.splice.call(t,i,1).length&&0})}function U(t){return Array.prototype.concat.apply([],arguments)}function $(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}function F(t,e){for(var n=t.split("%s"),i="",r=Array.prototype.slice.call(arguments,1);r.length&&1<n.length;)i+=n.shift()+r.shift();return i+n.join("%s")}var V=String.prototype.trim?function(t){return t.trim()}:function(t){return /^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function K(t){return z.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(H,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(W,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(B,"&gt;")),-1!=t.indexOf("\"")&&(t=t.replace(G,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(X,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(J,"&#0;")),t):t}var q,H=/&/g,W=/</g,B=/>/g,G=/"/g,X=/'/g,J=/\x00/g,z=/[\x00&<>"']/;function Y(t,e){return-1!=t.indexOf(e)}function Z(t,e){return t<e?-1:t>e?1:0}t:{var Q=n.navigator;if(Q){var tt=Q.userAgent;if(tt){q=tt;break t}}q=""}function et(t){return Y(q,t)}function nt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function it(t){for(var e in t)return!1;return!0}function rt(t){var e,n={};for(e in t)n[e]=t[e];return n}var ot,at,st="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ut(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<st.length;o++)n=st[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function ct(t){n.setTimeout(function(){throw t},0)}function ht(t,e){at||function(){if(n.Promise&&n.Promise.resolve){var t=n.Promise.resolve(void 0);at=function(){t.then(dt)}}else at=function(){var t=dt;!h(n.setImmediate)||n.Window&&n.Window.prototype&&!et("Edge")&&n.Window.prototype.setImmediate==n.setImmediate?(ot||(ot=function(){var t=n.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!et("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(""),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=m(function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),void 0!==t&&!et("Trident")&&!et("MSIE")){var e=new t,i={},r=i;return e.port1.onmessage=function(){if(void 0!==i.next){var t=(i=i.next).wb;i.wb=null,t()}},function(t){r.next={wb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){n.setTimeout(t,0)}}()),ot(t)):n.setImmediate(t)}}(),ft||(at(),ft=!0),lt.add(t,e)}var ft=!1,lt=new N;function dt(){for(var t;t=O();){try{t.a.call(t.b)}catch(e){ct(e)}S(_,t)}ft=!1}function pt(t,e){if(this.a=vt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=o)try{var n=this;t.call(e,function(t){Nt(n,mt,t)},function(t){if(!(t instanceof Lt))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}Nt(n,gt,t)})}catch(i){Nt(this,gt,i)}}var vt=0,mt=2,gt=3;function bt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}bt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var yt=new A(function(){return new bt},function(t){t.reset()});function wt(t,e,n){var i=yt.get();return i.g=t,i.b=e,i.f=n,i}function It(t){if(t instanceof pt)return t;var e=new pt(o);return Nt(e,mt,t),e}function kt(t){return new pt(function(e,n){n(t)})}function Tt(t,e,n){_t(t,e,n,null)||ht(g(e,t))}function Et(t){return new pt(function(e){var n=t.length,i=[];if(n)for(var r=function(t,r,o){n--,i[t]=r?{Db:!0,value:o}:{Db:!1,reason:o},0==n&&e(i)},o=0;o<t.length;o++)Tt(t[o],g(r,o,!0),g(r,o,!1));else e(i)})}function At(t,e){t.b||t.a!=mt&&t.a!=gt||Ot(t),t.f?t.f.next=e:t.b=e,t.f=e}function St(t,e,n,i){var r=wt(null,null,null);return r.a=new pt(function(t,o){r.g=e?function(n){try{var r=e.call(i,n);t(r)}catch(a){o(a)}}:t,r.b=n?function(e){try{var r=n.call(i,e);void 0===r&&e instanceof Lt?o(e):t(r)}catch(a){o(a)}}:o}),r.a.c=t,At(t,r),r.a}function Nt(t,e,n){t.a==vt&&(t===n&&(e=gt,n=new TypeError("Promise cannot resolve to itself")),t.a=1,_t(n,t.Nc,t.Oc,t)||(t.i=n,t.a=e,t.c=null,Ot(t),e!=gt||n instanceof Lt||function(t,e){t.g=!0,ht(function(){t.g&&Ct.call(null,e)})}(t,n)))}function _t(t,e,n,i){if(t instanceof pt)return At(t,wt(e||o,n||null,i)),!0;if(I(t))return t.then(e,n,i),!0;if(f(t))try{var r=t.then;if(h(r))return function(t,e,n,i,r){function o(t){a||(a=!0,i.call(r,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(r,t))},o)}catch(s){o(s)}}(t,r,e,n,i),!0}catch(a){return n.call(i,a),!0}return!1}function Ot(t){t.h||(t.h=!0,ht(t.Yb,t))}function Pt(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Dt(t,e,n,i){if(n==gt&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Rt(e,n,i);else try{e.c?e.g.call(e.f):Rt(e,n,i)}catch(r){Ct.call(null,r)}S(yt,e)}function Rt(t,e,n){e==mt?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}pt.prototype.then=function(t,e,n){return St(this,h(t)?t:null,h(e)?e:null,n)},w(pt),(t=pt.prototype).ia=function(t,e){return(t=wt(t,t,e)).c=!0,At(this,t),this},t.s=function(t,e){return St(this,null,t,e)},t.cancel=function(t){this.a==vt&&ht(function(){!function t(e,n){if(e.a==vt)if(e.c){var i=e.c;if(i.b){for(var r=0,o=null,a=null,s=i.b;s&&(s.c||(r++,s.a==e&&(o=s),!(o&&1<r)));s=s.next)o||(a=s);o&&(i.a==vt&&1==r?t(i,n):(a?((r=a).next==i.f&&(i.f=r),r.next=r.next.next):Pt(i),Dt(i,o,gt,n)))}e.c=null}else Nt(e,gt,n)}(this,new Lt(t))},this)},t.Nc=function(t){this.a=vt,Nt(this,mt,t)},t.Oc=function(t){this.a=vt,Nt(this,gt,t)},t.Yb=function(){for(var t;t=Pt(this);)Dt(this,t,this.a,this.i);this.h=!1};var Ct=ct;function Lt(t){k.call(this,t)}function xt(){0!=Mt&&(jt[this[l]||(this[l]=++d)]=this),this.qa=this.qa,this.ja=this.ja}y(Lt,k),Lt.prototype.name="cancel";var Mt=0,jt={};function Ut(t){if(!t.qa&&(t.qa=!0,t.va(),0!=Mt)){var e=t[l]||(t[l]=++d);if(0!=Mt&&t.ja&&0<t.ja.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete jt[e]}}function $t(t){return $t[" "](t),t}xt.prototype.qa=!1,xt.prototype.va=function(){if(this.ja)for(;this.ja.length;)this.ja.shift()()},$t[" "]=o;var Ft,Vt,Kt=et("Opera"),qt=et("Trident")||et("MSIE"),Ht=et("Edge"),Wt=Ht||qt,Bt=et("Gecko")&&!(Y(q.toLowerCase(),"webkit")&&!et("Edge"))&&!(et("Trident")||et("MSIE"))&&!et("Edge"),Gt=Y(q.toLowerCase(),"webkit")&&!et("Edge");function Xt(){var t=n.document;return t?t.documentMode:void 0}t:{var Jt="",zt=(Vt=q,Bt?/rv:([^\);]+)(\)|;)/.exec(Vt):Ht?/Edge\/([\d\.]+)/.exec(Vt):qt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Vt):Gt?/WebKit\/(\S+)/.exec(Vt):Kt?/(?:Version)[ \/]?(\S+)/.exec(Vt):void 0);if(zt&&(Jt=zt?zt[1]:""),qt){var Yt=Xt();if(null!=Yt&&Yt>parseFloat(Jt)){Ft=String(Yt);break t}}Ft=Jt}var Zt,Qt={};function te(t){return function(t,e){var n=Qt;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=V(String(Ft)).split("."),i=V(String(t)).split("."),r=Math.max(n.length,i.length),o=0;0==e&&o<r;o++){var a=n[o]||"",s=i[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=Z(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||Z(0==a[2].length,0==s[2].length)||Z(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}var ee=n.document;Zt=ee&&qt?Xt()||("CSS1Compat"==ee.compatMode?parseInt(Ft,10):5):void 0;var ne=Object.freeze||function(t){return t},ie=!qt||9<=Number(Zt),re=qt&&!te("9"),oe=function(){if(!n.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return n.addEventListener("test",o,e),n.removeEventListener("test",o,e),t}();function ae(t,e){this.type=t,this.b=this.target=e,this.Kb=!0}function se(t,e){if(ae.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Bt){t:{try{$t(e.nodeName);var o=!0;break t}catch(a){}o=!1}o||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===r?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=i(t.pointerType)?t.pointerType:ue[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}ae.prototype.preventDefault=function(){this.Kb=!1},y(se,ae);var ue=ne({2:"touch",3:"pen",4:"mouse"});se.prototype.preventDefault=function(){se.ob.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,re)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},se.prototype.f=function(){return this.a};var ce="closure_listenable_"+(1e6*Math.random()|0),he=0;function fe(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.La=r,this.key=++he,this.oa=this.Ia=!1}function le(t){t.oa=!0,t.listener=null,t.proxy=null,t.src=null,t.La=null}function de(t){this.src=t,this.a={},this.b=0}function pe(t,e){var n=e.type;n in t.a&&M(t.a[n],e)&&(le(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function ve(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.oa&&o.listener==e&&o.capture==!!n&&o.La==i)return r}return-1}de.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=ve(t,e,i,r);return-1<a?(e=t[a],n||(e.Ia=!1)):((e=new fe(e,this.src,o,!!i,r)).Ia=n,t.push(e)),e};var me="closure_lm_"+(1e6*Math.random()|0),ge={};function be(t,e,n,i,r){if(i&&i.once)we(t,e,n,i,r);else if(u(e))for(var o=0;o<e.length;o++)be(t,e[o],n,i,r);else n=Oe(n),t&&t[ce]?De(t,e,n,f(i)?!!i.capture:!!i,r):ye(t,e,n,!1,i,r)}function ye(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var a=f(r)?!!r.capture:!!r,s=Ne(t);if(s||(t[me]=s=new de(t)),!(n=s.add(e,n,i,a,o)).proxy){if(i=function(){var t=Se,e=ie?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)oe||(r=a),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(Te(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}0}}function we(t,e,n,i,r){if(u(e))for(var o=0;o<e.length;o++)we(t,e[o],n,i,r);else n=Oe(n),t&&t[ce]?Re(t,e,n,f(i)?!!i.capture:!!i,r):ye(t,e,n,!0,i,r)}function Ie(t,e,n,i,r){if(u(e))for(var o=0;o<e.length;o++)Ie(t,e[o],n,i,r);else i=f(i)?!!i.capture:!!i,n=Oe(n),t&&t[ce]?(t=t.l,(e=String(e).toString())in t.a&&-1<(n=ve(o=t.a[e],n,i,r))&&(le(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=Ne(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ve(e,n,i,r)),(n=-1<t?e[t]:null)&&ke(n))}function ke(t){if("number"!=typeof t&&t&&!t.oa){var e=t.src;if(e&&e[ce])pe(e.l,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(Te(n),i):e.addListener&&e.removeListener&&e.removeListener(i),0,(n=Ne(e))?(pe(n,t),0==n.b&&(n.src=null,e[me]=null)):le(t)}}}function Te(t){return t in ge?ge[t]:ge[t]="on"+t}function Ee(t,e,n,i){var r=!0;if((t=Ne(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.oa&&(o=Ae(o,i),r=r&&!1!==o)}return r}function Ae(t,e){var n=t.listener,i=t.La||t.src;return t.Ia&&ke(t),n.call(i,e)}function Se(t,e){if(t.oa)return!0;if(!ie){if(!e)t:{e=["window","event"];for(var i=n,r=0;r<e.length;r++)if(null==(i=i[e[r]])){e=null;break t}e=i}if(e=new se(r=e,this),i=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var o=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(s){o=!0}(o||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],o=e.b;o;o=o.parentNode)r.push(o);for(t=t.type,o=r.length-1;0<=o;o--){e.b=r[o];var a=Ee(r[o],t,!0,e);i=i&&a}for(o=0;o<r.length;o++)e.b=r[o],a=Ee(r[o],t,!1,e),i=i&&a}return i}return Ae(t,new se(e,this))}function Ne(t){return(t=t[me])instanceof de?t:null}var _e="__closure_events_fn_"+(1e9*Math.random()>>>0);function Oe(t){return h(t)?t:(t[_e]||(t[_e]=function(e){return t.handleEvent(e)}),t[_e])}function Pe(){xt.call(this),this.l=new de(this),this.Rb=this,this.Va=null}function De(t,e,n,i,r){t.l.add(String(e),n,!1,i,r)}function Re(t,e,n,i,r){t.l.add(String(e),n,!0,i,r)}function Ce(t,e,n,i){if(!(e=t.l.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.oa&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ia&&pe(t.l,a),r=!1!==s.call(u,i)&&r}}return r&&0!=i.Kb}function Le(t,e,i){if(h(t))i&&(t=m(t,i));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=m(t.handleEvent,t)}return 2147483647<Number(e)?-1:n.setTimeout(t,e||0)}function xe(t){var e=null;return new pt(function(n,i){-1==(e=Le(function(){n(void 0)},t))&&i(Error("Failed to schedule timer."))}).s(function(t){throw n.clearTimeout(e),t})}function Me(t){if(t.S&&"function"==typeof t.S)return t.S();if(i(t))return t.split("");if(c(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function je(t){if(t.U&&"function"==typeof t.U)return t.U();if(!t.S||"function"!=typeof t.S){if(c(t)||i(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Ue(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Ue)for(n=t.U(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function $e(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];Fe(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)Fe(r,i=t.a[e])||(t.a[n++]=i,r[i]=1),e++;t.a.length=n}}function Fe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}y(Pe,xt),Pe.prototype[ce]=!0,Pe.prototype.addEventListener=function(t,e,n,i){be(this,t,e,n,i)},Pe.prototype.removeEventListener=function(t,e,n,i){Ie(this,t,e,n,i)},Pe.prototype.dispatchEvent=function(t){var e,n=this.Va;if(n)for(e=[];n;n=n.Va)e.push(n);n=this.Rb;var r=t.type||t;if(i(t))t=new ae(t,n);else if(t instanceof ae)t.target=t.target||n;else{var o=t;ut(t=new ae(r,n),o)}if(o=!0,e)for(var a=e.length-1;0<=a;a--){var s=t.b=e[a];o=Ce(s,r,!0,t)&&o}if(o=Ce(s=t.b=n,r,!0,t)&&o,o=Ce(s,r,!1,t)&&o,e)for(a=0;a<e.length;a++)o=Ce(s=t.b=e[a],r,!1,t)&&o;return o},Pe.prototype.va=function(){if(Pe.ob.va.call(this),this.l){var t,e=this.l;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)0,le(n[i]);delete e.a[t],e.b--}}this.Va=null},(t=Ue.prototype).S=function(){$e(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.U=function(){return $e(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return Fe(this.b,t)?this.b[t]:e},t.set=function(t,e){Fe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.U(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var Ve=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){if(this.b=this.l=this.c="",this.i=null,this.h=this.g="",this.f=!1,t instanceof Ke){this.f=void 0!==e?e:t.f,qe(this,t.c),this.l=t.l,this.b=t.b,He(this,t.i),this.g=t.g,e=t.a;var n=new on;n.c=e.c,e.a&&(n.a=new Ue(e.a),n.b=e.b),We(this,n),this.h=t.h}else t&&(n=String(t).match(Ve))?(this.f=!!e,qe(this,n[1]||"",!0),this.l=ze(n[2]||""),this.b=ze(n[3]||"",!0),He(this,n[4]),this.g=ze(n[5]||"",!0),We(this,n[6]||"",!0),this.h=ze(n[7]||"")):(this.f=!!e,this.a=new on(null,this.f))}function qe(t,e,n){t.c=n?ze(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function He(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function We(t,e,n){e instanceof on?(t.a=e,function(t,e){e&&!t.f&&(an(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(un(this,e),hn(this,n,t))},t)),t.f=e}(t.a,t.f)):(n||(e=Ye(e,nn)),t.a=new on(e,t.f))}function Be(t,e,n){t.a.set(e,n)}function Ge(t,e){return t.a.get(e)}function Xe(t){return t instanceof Ke?new Ke(t):new Ke(t,void 0)}function Je(t,e){var n=new Ke(null,void 0);return qe(n,"https"),t&&(n.b=t),e&&(n.g=e),n}function ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ye(t,e,n){return i(t)?(t=encodeURI(t).replace(e,Ze),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ze(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Ye(e,Qe,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Ye(e,Qe,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Ye(n,"/"==n.charAt(0)?en:tn,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Ye(n,rn)),t.join("")};var Qe=/[#\/\?@]/g,tn=/[#\?:]/g,en=/[#\?]/g,nn=/[#\?@]/g,rn=/#/g;function on(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(t){t.a||(t.a=new Ue,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function sn(t){var e=je(t);if(void 0===e)throw Error("Keys are undefined");var n=new on(null,void 0);t=Me(t);for(var i=0;i<e.length;i++){var r=e[i],o=t[i];u(o)?hn(n,r,o):n.add(r,o)}return n}function un(t,e){an(t),e=fn(t,e),Fe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Fe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&$e(t)))}function cn(t,e){return an(t),e=fn(t,e),Fe(t.a.b,e)}function hn(t,e,n){un(t,e),0<n.length&&(t.c=null,t.a.set(fn(t,e),$(n)),t.b+=n.length)}function fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(t=on.prototype).add=function(t,e){an(this),this.c=null,t=fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){an(this),this.a.forEach(function(n,i){R(n,function(n){t.call(e,n,i,this)},this)},this)},t.U=function(){an(this);for(var t=this.a.S(),e=this.a.U(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},t.S=function(t){an(this);var e=[];if(i(t))cn(this,t)&&(e=U(e,this.a.get(fn(this,t))));else{t=this.a.S();for(var n=0;n<t.length;n++)e=U(e,t[n])}return e},t.set=function(t,e){return an(this),this.c=null,cn(this,t=fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return 0<(t=t?this.S(t):[]).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.S(i);for(var o=0;o<i.length;o++){var a=r;""!==i[o]&&(a+="="+encodeURIComponent(String(i[o]))),t.push(a)}}return this.c=t.join("&")};var ln=!qt||9<=Number(Zt);function dn(){this.a="",this.b=vn}function pn(t){return t instanceof dn&&t.constructor===dn&&t.b===vn?t.a:(E("expected object of type Const, got '"+t+"'"),"type_error:Const")}dn.prototype.na=!0,dn.prototype.ma=function(){return this.a},dn.prototype.toString=function(){return"Const{"+this.a+"}"};var vn={};function mn(t){var e=new dn;return e.a=t,e}function gn(){this.a="",this.b=kn}function bn(t){return t instanceof gn&&t.constructor===gn&&t.b===kn?t.a:(E("expected object of type TrustedResourceUrl, got '"+t+"' of type "+a(t)),"type_error:TrustedResourceUrl")}function yn(t,e){var n=pn(t);if(!In.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=new gn;return e.a=t,e}(t=n.replace(wn,function(t,i){if(!Object.prototype.hasOwnProperty.call(e,i))throw Error("Found marker, \""+i+"\", in format string, \""+n+"\", but no valid label mapping found in args: "+JSON.stringify(e));return(t=e[i])instanceof dn?pn(t):encodeURIComponent(String(t))}))}mn(""),gn.prototype.na=!0,gn.prototype.ma=function(){return this.a},gn.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var wn=/%{(\w+)}/g,In=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i,kn={};function Tn(){this.a="",this.b=Nn}function En(t){return t instanceof Tn&&t.constructor===Tn&&t.b===Nn?t.a:(E("expected object of type SafeUrl, got '"+t+"' of type "+a(t)),"type_error:SafeUrl")}Tn.prototype.na=!0,Tn.prototype.ma=function(){return this.a},Tn.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var An=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i;function Sn(t){return t instanceof Tn?t:(t=t.na?t.ma():String(t),An.test(t)||(t="about:invalid#zClosurez"),_n(t))}var Nn={};function _n(t){var e=new Tn;return e.a=t,e}function On(){this.a="",this.b=Pn}_n("about:blank"),On.prototype.na=!0,On.prototype.ma=function(){return this.a},On.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Pn={};function Dn(t){var e=new On;return e.a=t,e}function Rn(t){var e=document;return i(t)?e.getElementById(t):t}function Cn(t,e){nt(e,function(e,n){e&&e.na&&(e=e.ma()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:Ln.hasOwnProperty(n)?t.setAttribute(Ln[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}Dn("<!DOCTYPE html>"),Dn(""),Dn("<br>");var Ln={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function xn(t,e,n){var r=arguments,o=document,a=String(r[0]),s=r[1];if(!ln&&s&&(s.name||s.type)){if(a=["<",a],s.name&&a.push(" name=\"",K(s.name),"\""),s.type){a.push(" type=\"",K(s.type),"\"");var h={};ut(h,s),delete h.type,s=h}a.push(">"),a=a.join("")}return a=o.createElement(a),s&&(i(s)?a.className=s:u(s)?a.className=s.join(" "):Cn(a,s)),2<r.length&&function(t,e,n){function r(n){n&&e.appendChild(i(n)?t.createTextNode(n):n)}for(var o=2;o<n.length;o++){var a=n[o];!c(a)||f(a)&&0<a.nodeType?r(a):R(Mn(a)?$(a):a,r)}}(o,a,r),a}function Mn(t){if(t&&"number"==typeof t.length){if(f(t))return"function"==typeof t.item||"string"==typeof t.item;if(h(t))return"function"==typeof t.item}return!1}function jn(t){var e=[];return function t(e,n,i){if(null==n)i.push("null");else{if("object"==typeof n){if(u(n)){var r=n;n=r.length,i.push("[");for(var o="",a=0;a<n;a++)i.push(o),t(e,r[a],i),o=",";return void i.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(r in i.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,r)&&"function"!=typeof(a=n[r])&&(i.push(o),Vn(r,i),i.push(":"),t(e,a,i),o=",");return void i.push("}")}n=n.valueOf()}switch(typeof n){case"string":Vn(n,i);break;case"number":i.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":i.push(String(n));break;case"function":i.push("null");break;default:throw Error("Unknown type: "+typeof n);}}}(new Un,t,e),e.join("")}function Un(){}var $n={"\"":"\\\"","\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},Fn=/\uffff/.test("\uFFFF")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Vn(t,e){e.push("\"",t.replace(Fn,function(t){var e=$n[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),$n[t]=e),e}),"\"")}function Kn(){var t=si();return qt&&!!Zt&&11==Zt||/Edge\/\d+/.test(t)}function qn(){return n.window&&n.window.location.href||self&&self.location&&self.location.href||""}function Hn(t,e){e=e||n.window;var i="about:blank";t&&(i=En(Sn(t))),e.location.href=i}function Wn(t){return!!((t=(t||si()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function Bn(t){t=t||n.window;try{t.close()}catch(e){}}function Gn(t,e,n){var i=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<r?r:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=si().toLowerCase(),i&&(e.target=i,Y(n,"crios/")&&(e.target="_blank")),ri(si())==ni&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof Tn?n:Sn(void 0!==n.href?n.href:String(n)),n=t.target||n.target,r=[],t)switch(s){case"width":case"height":case"top":case"left":r.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(s+"="+(t[s]?1:0));}var s=r.join(",");if((et("iPhone")&&!et("iPod")&&!et("iPad")||et("iPad")||et("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(s=i.document.createElement("A"),e instanceof Tn||e instanceof Tn||(e=e.na?e.ma():String(e),An.test(e)||(e="about:invalid#zClosurez"),e=_n(e)),s.href=En(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,i,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=i.open("",n,s),t=En(e),s&&(Wt&&Y(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,mn("b/12014412, meta tag with sanitized URL"),t=Dn(t="<meta name=\"referrer\" content=\"no-referrer\"><meta http-equiv=\"refresh\" content=\"0; url="+K(t)+"\">"),s.document.write(function(t){return t instanceof On&&t.constructor===On&&t.b===Pn?t.a:(E("expected object of type SafeHtml, got '"+t+"' of type "+a(t)),"type_error:SafeHtml")}(t)),s.document.close())):(s=i.open(En(e),n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(u){}return s}var Xn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Jn=/^[^@]+@[^@]+$/;function zn(){var t=null;return new pt(function(e){"complete"==n.document.readyState?e():(t=function(){e()},we(window,"load",t))}).s(function(e){throw Ie(window,"load",t),e})}function Yn(t){return t=t||si(),!("file:"!==li()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Zn(){var t=n.window;try{return!(!t||t==t.top)}catch(e){return!1}}function Qn(){return"object"!=typeof n.window&&"function"==typeof n.importScripts}function ti(){return ab.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":ab.INTERNAL.hasOwnProperty("node")?"Node":Qn()?"Worker":"Browser"}function ei(){var t=ti();return"ReactNative"===t||"Node"===t}var ni="Firefox",ii="Chrome";function ri(t){var e=t.toLowerCase();return Y(e,"opera/")||Y(e,"opr/")||Y(e,"opios/")?"Opera":Y(e,"iemobile")?"IEMobile":Y(e,"msie")||Y(e,"trident/")?"IE":Y(e,"edge/")?"Edge":Y(e,"firefox/")?ni:Y(e,"silk/")?"Silk":Y(e,"blackberry")?"Blackberry":Y(e,"webos")?"Webos":!Y(e,"safari/")||Y(e,"chrome/")||Y(e,"crios/")||Y(e,"android")?!Y(e,"chrome/")&&!Y(e,"crios/")||Y(e,"edge/")?Y(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":ii:"Safari"}var oi={Uc:"FirebaseCore-web",Wc:"FirebaseUI-web"};function ai(t,e){e=e||[];var n,i=[],r={};for(n in oi)r[oi[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],i.push(e[n]));return i.sort(),(e=i).length||(e=["FirebaseCore-web"]),"Browser"===(i=ti())?i=ri(r=si()):"Worker"===i&&(i=ri(r=si())+"-"+i),i+"/JsCore/"+t+"/"+e.join(",")}function si(){return n.navigator&&n.navigator.userAgent||""}function ui(t,e){t=t.split("."),e=e||n;for(var i=0;i<t.length&&"object"==typeof e&&null!=e;i++)e=e[t[i]];return i!=t.length&&(e=void 0),e}function ci(){try{var t=n.localStorage,e=gi();if(t)return t.setItem(e,"1"),t.removeItem(e),!Kn()||!!n.indexedDB}catch(i){return Qn()&&!!n.indexedDB}return!1}function hi(){return(fi()||"chrome-extension:"===li()||Yn())&&!ei()&&ci()&&!Qn()}function fi(){return"http:"===li()||"https:"===li()}function li(){return n.location&&n.location.protocol||null}function di(t){return!Wn(t=t||si())&&ri(t)!=ni}function pi(t){return void 0===t?null:jn(t)}function vi(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function mi(t){if(null!==t)return JSON.parse(t)}function gi(t){return t||Math.floor(1e9*Math.random()).toString()}function bi(t){return"Safari"!=ri(t=t||si())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function yi(){var t=n.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var i=0;i<t.CP.length;i++)t.CP[i]=null}function wi(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=si(),e=ti(),this.b=Wn(t)||"ReactNative"===e}function Ii(){var t=n.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function ki(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function Ti(){return!(!ui("fireauth.oauthhelper",n)&&!ui("fireauth.iframe",n))}wi.prototype.get=function(){var t=n.navigator;return!t||"boolean"!=typeof t.onLine||!fi()&&"chrome-extension:"!==li()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Ei,Ai={};function Si(t){Ai[t]||(Ai[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Ni={};Object.defineProperty(Ni,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Ni,"abcd",{configurable:!0,enumerable:!0,value:2}),Ei=2==Ni.abcd}catch(Vt){Ei=!1}function _i(t,e,n){Ei?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Oi(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&_i(t,n,e[n])}function Pi(t){var e={};return Oi(e,t),e}function Di(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)_i(e,n,Di(t[n]));return e}function Ri(t){var e={},n=t[Li],i=t[xi];if(!(t=t[Mi])||t!=Ci&&!n)throw Error("Invalid provider user info!");e[Ui]=i||null,e[ji]=n||null,_i(this,Fi,t),_i(this,$i,Di(e))}var Ci="EMAIL_SIGNIN",Li="email",xi="newEmail",Mi="requestType",ji="email",Ui="fromEmail",$i="data",Fi="operation";function Vi(t,e){this.code=qi+t,this.message=e||Hi[t]||""}function Ki(t){var e=t&&t.code;return e?new Vi(e.substring(qi.length),t.message):null}y(Vi,Error),Vi.prototype.C=function(){return{code:this.code,message:this.message}},Vi.prototype.toJSON=function(){return this.C()};var qi="auth/",Hi={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The OIDC ID token requires a valid unhashed nonce.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":"This operation is not supported in the environment this application is running on. \"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.","popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function Wi(t){var e=t[zi];if(void 0===e)throw new Vi("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Vi("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Bi];if(n&&"object"==typeof n){e=n[Qi];var i=n[Yi];if(n=n[Zi],"string"==typeof e&&e.length){if(this.a=e,void 0!==i&&"boolean"!=typeof i)throw new Vi("argument-error",Yi+" property must be a boolean when specified.");if(this.g=!!i,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Vi("argument-error",Zi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new Vi("argument-error",Qi+" property must be a non empty string when specified.");if(void 0!==i||void 0!==n)throw new Vi("missing-android-pkg-name")}}else if(void 0!==n)throw new Vi("argument-error",Bi+" property must be a non null object when specified.");if(this.f=null,(e=t[Ji])&&"object"==typeof e){if("string"==typeof(e=e[tr])&&e.length)this.f=e;else if(void 0!==e)throw new Vi("argument-error",tr+" property must be a non empty string when specified.")}else if(void 0!==e)throw new Vi("argument-error",Ji+" property must be a non null object when specified.");if(void 0!==(e=t[Xi])&&"boolean"!=typeof e)throw new Vi("argument-error",Xi+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Gi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new Vi("argument-error",Gi+" property must be a non empty string when specified.");this.i=t||null}var Bi="android",Gi="dynamicLinkDomain",Xi="handleCodeInApp",Ji="iOS",zi="url",Yi="installApp",Zi="minimumVersion",Qi="packageName",tr="bundleId";function er(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var nr=null,ir=null;function rr(t){var e="";return function(t,e){function n(e){for(;i<t.length;){var n=t.charAt(i++),r=ir[n];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!nr){nr={},ir={};for(var t=0;65>t;t++)nr[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),ir[nr[t]]=t,62<=t&&(ir["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var i=0;;){var r=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===r)break;e(r<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}function or(t){this.c=t.sub,b(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function ar(t){return(t=sr(t))&&t.sub&&t.iss&&t.aud&&t.exp?new or(t):null}function sr(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(rr(t))}catch(i){}return null}or.prototype.f=function(){return this.b};var ur,cr={$c:{ab:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},bd:{ab:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},cd:{ab:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function hr(t){for(var e in cr)if(cr[e].id===t)return{firebaseEndpoint:(t=cr[e]).ab,secureTokenEndpoint:t.ib};return null}ur=hr("__EID__")?"__EID__":void 0;var fr="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),lr=["client_id","response_type","scope","redirect_uri","state"],dr={Vc:{Ma:"locale",Ba:500,Aa:600,Na:"facebook.com",hb:lr},Xc:{Ma:null,Ba:500,Aa:620,Na:"github.com",hb:lr},Yc:{Ma:"hl",Ba:515,Aa:680,Na:"google.com",hb:lr},dd:{Ma:"lang",Ba:485,Aa:705,Na:"twitter.com",hb:fr}};function pr(t){for(var e in dr)if(dr[e].Na==t)return dr[e];return null}function vr(t){var e={};e["facebook.com"]=wr,e["google.com"]=kr,e["github.com"]=Ir,e["twitter.com"]=Tr;var n=t&&t[gr];try{if(n)return e[n]?new e[n](t):new yr(t);if(void 0!==t[mr])return new br(t)}catch(i){}return null}var mr="idToken",gr="providerId";function br(t){var e=t[gr];if(!e&&t[mr]){var n=ar(t[mr]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),_i(this,"providerId",e),_i(this,"isNewUser",n)}function yr(t){br.call(this,t),_i(this,"profile",Di((t=mi(t.rawUserInfo||"{}"))||{}))}function wr(t){if(yr.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Ir(t){if(yr.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");_i(this,"username",this.profile&&this.profile.login||null)}function kr(t){if(yr.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function Tr(t){if(yr.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");_i(this,"username",t.screenName||null)}function Er(t){this.a=Xe(t)}function Ar(t){var e=Xe(t),n=Ge(e,"link"),i=Ge(Xe(n),"link");return e=Ge(e,"deep_link_id"),Ge(Xe(e),"link")||e||i||n||t}function Sr(t,e){return t.then(function(t){if(t[ua]){var n=ar(t[ua]);if(!n||e!=n.c)throw new Vi("user-mismatch");return t}throw new Vi("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==qi+"user-not-found"?new Vi("user-mismatch"):t})}function Nr(t,e){if(!e)throw new Vi("internal-error","failed to construct a credential");this.a=e,_i(this,"providerId",t),_i(this,"signInMethod",t)}function _r(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Or(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&_i(this,"idToken",e.idToken),e.accessToken&&_i(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&_i(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Vi("internal-error","failed to construct a credential");_i(this,"accessToken",e.oauthToken),_i(this,"secret",e.oauthTokenSecret)}_i(this,"providerId",t),_i(this,"signInMethod",n)}function Pr(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:sn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function Dr(t,e){this.Dc=e||[],Oi(this,{providerId:t,isOAuthProvider:!0}),this.yb={},this.cb=(pr(t)||{}).Ma||null,this.$a=null}function Rr(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new Vi("argument-error","SAML provider IDs must be prefixed with \"saml.\"");Dr.call(this,t,[])}function Cr(t){Dr.call(this,t,lr),this.a=[]}function Lr(){Cr.call(this,"facebook.com")}function xr(t){if(!t)throw new Vi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return f(t)&&(e=t.accessToken),new Lr().credential(null,e)}function Mr(){Cr.call(this,"github.com")}function jr(t){if(!t)throw new Vi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return f(t)&&(e=t.accessToken),new Mr().credential(null,e)}function Ur(){Cr.call(this,"google.com"),this.ua("profile")}function $r(t,e){var n=t;return f(t)&&(n=t.idToken,e=t.accessToken),new Ur().credential(n,e)}function Fr(){Dr.call(this,"twitter.com",fr)}function Vr(t,e){var n=t;if(f(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Vi("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Or("twitter.com",n,"twitter.com")}function Kr(t,e,n){this.a=t,this.c=e,_i(this,"providerId","password"),_i(this,"signInMethod",n===qr.EMAIL_LINK_SIGN_IN_METHOD?qr.EMAIL_LINK_SIGN_IN_METHOD:qr.EMAIL_PASSWORD_SIGN_IN_METHOD)}function qr(){Oi(this,{providerId:"password",isOAuthProvider:!1})}function Hr(t,e){if(!(e=Wr(e)))throw new Vi("argument-error","Invalid email link!");return new Kr(t,e,qr.EMAIL_LINK_SIGN_IN_METHOD)}function Wr(t){var e=Ge((t=new Er(t=Ar(t))).a,"oobCode")||null;return"signIn"===(Ge(t.a,"mode")||null)&&e?e:null}function Br(t){if(!(t.Ta&&t.Sa||t.Fa&&t.$))throw new Vi("internal-error");this.a=t,_i(this,"providerId","phone"),_i(this,"signInMethod","phone")}function Gr(t){return t.a.Fa&&t.a.$?{temporaryProof:t.a.Fa,phoneNumber:t.a.$}:{sessionInfo:t.a.Ta,code:t.a.Sa}}function Xr(t){try{this.a=t||ab.auth()}catch(e){throw new Vi("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Oi(this,{providerId:"phone",isOAuthProvider:!1})}function Jr(t,e){if(!t)throw new Vi("missing-verification-id");if(!e)throw new Vi("missing-verification-code");return new Br({Ta:t,Sa:e})}function zr(t){if(t.temporaryProof&&t.phoneNumber)return new Br({Fa:t.temporaryProof,$:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,i=t&&t.oauthTokenSecret,r=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return $r(o,n);case"facebook.com":return xr(n);case"github.com":return jr(n);case"twitter.com":return Vr(n,i);default:return n||i||o||a?a?0==e.indexOf("saml.")?new Nr(e,a):new Or(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new Cr(e).credential(o,n,r):null;}}catch(s){return null}}function Yr(t){if(!t.isOAuthProvider)throw new Vi("invalid-oauth-provider")}function Zr(t,e,n,i,r,o){if(this.b=t,this.c=e||null,this.f=n||null,this.g=i||null,this.h=o||null,this.a=r||null,!this.f&&!this.a)throw new Vi("invalid-auth-event");if(this.f&&this.a)throw new Vi("invalid-auth-event");if(this.f&&!this.g)throw new Vi("invalid-auth-event")}function Qr(t){return(t=t||{}).type?new Zr(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Ki(t.error),t.postBody):null}function to(){this.b=null,this.a=[]}y(yr,br),y(wr,yr),y(Ir,yr),y(kr,yr),y(Tr,yr),Nr.prototype.la=function(t){return Sa(t,_r(this))},Nr.prototype.b=function(t,e){var n=_r(this);return n.idToken=e,Na(t,n)},Nr.prototype.f=function(t,e){return Sr(_a(t,_r(this)),e)},Nr.prototype.C=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},Or.prototype.la=function(t){return Sa(t,Pr(this))},Or.prototype.b=function(t,e){var n=Pr(this);return n.idToken=e,Na(t,n)},Or.prototype.f=function(t,e){return Sr(_a(t,Pr(this)),e)},Or.prototype.C=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},Dr.prototype.Da=function(t){return this.yb=rt(t),this},y(Rr,Dr),y(Cr,Dr),Cr.prototype.ua=function(t){return x(this.a,t)||this.a.push(t),this},Cr.prototype.Eb=function(){return $(this.a)},Cr.prototype.credential=function(t,e,n){if(!t&&!e)throw new Vi("argument-error","credential failed: must provide the ID token and/or the access token.");return new Or(this.providerId,{idToken:t||null,accessToken:e||null,nonce:n||null},this.providerId)},y(Lr,Cr),_i(Lr,"PROVIDER_ID","facebook.com"),_i(Lr,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),y(Mr,Cr),_i(Mr,"PROVIDER_ID","github.com"),_i(Mr,"GITHUB_SIGN_IN_METHOD","github.com"),y(Ur,Cr),_i(Ur,"PROVIDER_ID","google.com"),_i(Ur,"GOOGLE_SIGN_IN_METHOD","google.com"),y(Fr,Dr),_i(Fr,"PROVIDER_ID","twitter.com"),_i(Fr,"TWITTER_SIGN_IN_METHOD","twitter.com"),Kr.prototype.la=function(t){return this.signInMethod==qr.EMAIL_LINK_SIGN_IN_METHOD?is(t,Ma,{email:this.a,oobCode:this.c}):is(t,Qa,{email:this.a,password:this.c})},Kr.prototype.b=function(t,e){return this.signInMethod==qr.EMAIL_LINK_SIGN_IN_METHOD?is(t,ja,{idToken:e,email:this.a,oobCode:this.c}):is(t,Ga,{idToken:e,email:this.a,password:this.c})},Kr.prototype.f=function(t,e){return Sr(this.la(t),e)},Kr.prototype.C=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Oi(qr,{PROVIDER_ID:"password"}),Oi(qr,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Oi(qr,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Br.prototype.la=function(t){return t.Ua(Gr(this))},Br.prototype.b=function(t,e){var n=Gr(this);return n.idToken=e,is(t,es,n)},Br.prototype.f=function(t,e){var n=Gr(this);return n.operation="REAUTH",Sr(t=is(t,ns,n),e)},Br.prototype.C=function(){var t={providerId:"phone"};return this.a.Ta&&(t.verificationId=this.a.Ta),this.a.Sa&&(t.verificationCode=this.a.Sa),this.a.Fa&&(t.temporaryProof=this.a.Fa),this.a.$&&(t.phoneNumber=this.a.$),t},Xr.prototype.Ua=function(t,e){var n=this.a.b;return It(e.verify()).then(function(r){if(!i(r))throw new Vi("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return function(t,e){return is(t,Wa,e)}(n,{phoneNumber:t,recaptchaToken:r}).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new Vi("argument-error","Only firebase.auth.ApplicationVerifiers with type=\"recaptcha\" are currently supported.");}})},Oi(Xr,{PROVIDER_ID:"phone"}),Oi(Xr,{PHONE_SIGN_IN_METHOD:"phone"}),Zr.prototype.C=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,postBody:this.h,error:this.a&&this.a.C()}};var eo,no=null;function io(t){var e="unauthorized-domain",n=void 0,i=Xe(t);t=i.b,"chrome-extension"==(i=i.c)?n=F("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==i||"https"==i?n=F("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Vi.call(this,e,n)}function ro(t,e,n){Vi.call(this,t,n),(t=e||{}).zb&&_i(this,"email",t.zb),t.$&&_i(this,"phoneNumber",t.$),t.credential&&_i(this,"credential",t.credential)}function oo(t){if(t.code){var e=t.code||"";0==e.indexOf(qi)&&(e=e.substring(qi.length));var n={credential:zr(t)};if(t.email)n.zb=t.email;else if(t.phoneNumber)n.$=t.phoneNumber;else if(!n.credential)return new Vi(e,t.message||void 0);return new ro(e,n,t.message)}return null}function ao(){}function so(t){return t.c||(t.c=t.b())}function uo(){}function co(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var i=e[n];try{return new ActiveXObject(i),t.f=i}catch(r){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function ho(){}function fo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText="",this.a.onload=m(this.ec,this),this.a.onerror=m(this.Fb,this),this.a.onprogress=m(this.fc,this),this.a.ontimeout=m(this.ic,this)}function lo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function po(t,e,n){this.reset(t,e,n,void 0,void 0)}to.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=ui("universalLinks.subscribe",n))&&t(null,this.b))},to.prototype.unsubscribe=function(t){j(this.a,function(e){return e==t})},y(io,Vi),y(ro,Vi),ro.prototype.C=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.C();return e&&ut(t,e),t},ro.prototype.toJSON=function(){return this.C()},ao.prototype.c=null,y(uo,ao),uo.prototype.a=function(){var t=co(this);return t?new ActiveXObject(t):new XMLHttpRequest},uo.prototype.b=function(){var t={};return co(this)&&(t[0]=!0,t[1]=!0),t},eo=new uo,y(ho,ao),ho.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new fo;throw Error("Unsupported browser")},ho.prototype.b=function(){return{}},(t=fo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.ec=function(){this.status=200,this.responseText=this.a.responseText,lo(this,4)},t.Fb=function(){this.status=500,this.responseText="",lo(this,4)},t.ic=function(){this.Fb()},t.fc=function(){this.status=200,lo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},po.prototype.a=null;function vo(t){this.f=t,this.b=this.c=this.a=null}function mo(t,e){this.name=t,this.value=e}po.prototype.reset=function(t,e,n,i,r){"number"==typeof r||0,i||b(),delete this.a},mo.prototype.toString=function(){return this.name};var go=new mo("SEVERE",1e3),bo=new mo("WARNING",900),yo=new mo("CONFIG",700),wo=new mo("FINE",500);vo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(E("Root logger has no level set."),null)}(this).value)for(h(e)&&(e=e()),t=new po(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Io={},ko=null;function To(t){var e;if(ko||(ko=new vo(""),Io[""]=ko,ko.c=yo),!(e=Io[t])){e=new vo(t);var n=t.lastIndexOf("."),i=t.substr(n+1);(n=To(t.substr(0,n))).b||(n.b={}),n.b[i]=e,e.a=n,Io[t]=e}return e}function Eo(t,e){t&&t.log(wo,e,void 0)}function Ao(t){this.f=t}function So(t){Pe.call(this),this.i=t,this.readyState=No,this.status=0,this.responseText=this.statusText="",this.onreadystatechange=null,this.g=new Headers,this.b=null,this.h="GET",this.c="",this.a=!1,this.f=To("goog.net.FetchXmlHttp")}y(Ao,ao),Ao.prototype.a=function(){return new So(this.f)},Ao.prototype.b=function(t){return function(){return t}}({}),y(So,Pe);var No=0;function _o(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Oo(t){Pe.call(this),this.headers=new Ue,this.D=t||null,this.c=!1,this.w=this.a=null,this.h=this.N=this.m="",this.f=this.I=this.i=this.G=!1,this.g=0,this.u=null,this.o=Po,this.v=this.O=!1}(t=So.prototype).open=function(t,e){if(this.readyState!=No)throw this.abort(),Error("Error reopening a connection");this.h=t,this.c=e,this.readyState=1,_o(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.g,method:this.h,credentials:void 0,cache:void 0};t&&(e.body=t),this.i.fetch(new Request(this.c,e)).then(this.hc.bind(this),this.Gb.bind(this))},t.abort=function(){this.responseText="",this.g=new Headers,this.status=0,1<=this.readyState&&this.a&&4!=this.readyState&&(this.readyState=4,this.a=!1,_o(this)),this.readyState=No},t.hc=function(t){this.a&&(this.b||(this.b=t.headers,this.readyState=2,_o(this)),this.a&&(this.readyState=3,_o(this),this.a&&t.text().then(this.gc.bind(this,t),this.Gb.bind(this))))},t.gc=function(t,e){this.a&&(this.status=t.status,this.statusText=t.statusText,this.responseText=e,this.readyState=4,_o(this))},t.Gb=function(t){var e=this.f;e&&e.log(bo,"Failed to fetch url "+this.c,t instanceof Error?t:Error(t)),this.a&&(this.readyState=4,_o(this))},t.setRequestHeader=function(t,e){this.g.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.f)&&t.log(bo,"Attempting to get response header but no headers have been received for url: "+this.c,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.f;return t&&t.log(bo,"Attempting to get all response headers but no headers have been received for url: "+this.c,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},y(Oo,Pe);var Po="";Oo.prototype.b=To("goog.net.XhrIo");var Do=/^https?$/i,Ro=["POST","PUT"];function Co(t,e,r,o,a){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.m+"; newUri="+e);r=r?r.toUpperCase():"GET",t.m=e,t.h="",t.N=r,t.G=!1,t.c=!0,t.a=t.D?t.D.a():eo.a(),t.w=t.D?so(t.D):so(eo),t.a.onreadystatechange=m(t.Jb,t);try{Eo(t.b,Ko(t,"Opening Xhr")),t.I=!0,t.a.open(r,String(e),!0),t.I=!1}catch(u){return Eo(t.b,Ko(t,"Error opening Xhr: "+u.message)),void xo(t,u)}e=o||"";var s=new Ue(t.headers);a&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(c(t)||i(t))R(t,e,void 0);else for(var n=je(t),r=Me(t),o=r.length,a=0;a<o;a++)e.call(void 0,r[a],n&&n[a],t)}(a,function(t,e){s.set(e,t)}),a=function(t){t:{for(var e=Lo,n=t.length,r=i(t)?t.split(""):t,o=0;o<n;o++)if(o in r&&e.call(void 0,r[o],o,t)){e=o;break t}e=-1}return 0>e?null:i(t)?t.charAt(e):t[e]}(s.U()),o=n.FormData&&e instanceof n.FormData,!x(Ro,r)||a||o||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.o&&(t.a.responseType=t.o),"withCredentials"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{$o(t),0<t.g&&(t.v=function(t){return qt&&te(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),Eo(t.b,Ko(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=m(t.Ga,t)):t.u=Le(t.Ga,t.g,t)),Eo(t.b,Ko(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(u){Eo(t.b,Ko(t,"Send error: "+u.message)),xo(t,u)}}function Lo(t){return"content-type"==t.toLowerCase()}function xo(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Mo(t),Uo(t)}function Mo(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function jo(t){if(t.c&&void 0!==e)if(t.w[1]&&4==Fo(t)&&2==Vo(t))Eo(t.b,Ko(t,"Local request error detected and ignored"));else if(t.i&&4==Fo(t))Le(t.Jb,0,t);else if(t.dispatchEvent("readystatechange"),4==Fo(t)){Eo(t.b,Ko(t,"Request complete")),t.c=!1;try{var i,r=Vo(t);t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var o=!0;break t;default:o=!1;}if(!(i=o)){var a;if(a=0===r){var s=String(t.m).match(Ve)[1]||null;if(!s&&n.self&&n.self.location){var u=n.self.location.protocol;s=u.substr(0,u.length-1)}a=!Do.test(s?s.toLowerCase():"")}i=a}if(i)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Fo(t)?t.a.statusText:""}catch(h){Eo(t.b,"Can not get status: "+h.message),c=""}t.h=c+" ["+Vo(t)+"]",Mo(t)}}finally{Uo(t)}}}function Uo(t,e){if(t.a){$o(t);var n=t.a,i=t.w[0]?o:null;t.a=null,t.w=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(r){(t=t.b)&&t.log(go,"Problem encountered resetting onreadystatechange: "+r.message,void 0)}}}function $o(t){t.a&&t.v&&(t.a.ontimeout=null),t.u&&(n.clearTimeout(t.u),t.u=null)}function Fo(t){return t.a?t.a.readyState:0}function Vo(t){try{return 2<Fo(t)?t.a.status:-1}catch(e){return-1}}function Ko(t,e){return e+" ["+t.N+" "+t.m+" "+Vo(t)+"]"}function qo(t,e){this.g=[],this.v=t,this.u=e||null,this.f=this.a=!1,this.c=void 0,this.m=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function Ho(t,e,n){t.a=!0,t.c=n,t.f=!e,Xo(t)}function Wo(t){if(t.a){if(!t.m)throw new Jo(t);t.m=!1}}function Bo(t,e,n,i){t.g.push([e,n,i]),t.a&&Xo(t)}function Go(t){return L(t.g,function(t){return h(t[1])})}function Xo(t){if(t.h&&t.a&&Go(t)){var e=t.h,i=Zo[e];i&&(n.clearTimeout(i.a),delete Zo[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=i=!1;t.g.length&&!t.i;){var o=t.g.shift(),a=o[0],s=o[1];if(o=o[2],a=t.f?s:a)try{var u=a.call(o||t.u,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(I(e)||"function"==typeof n.Promise&&e instanceof n.Promise)&&(r=!0,t.i=!0)}catch(c){e=c,t.f=!0,Go(t)||(i=!0)}}t.c=e,r&&(u=m(t.o,t,!0),r=m(t.o,t,!1),e instanceof qo?(Bo(e,u,r),e.w=!0):e.then(u,r)),i&&(e=new Yo(e),Zo[e.a]=e,t.h=e.a)}function Jo(){k.call(this)}function zo(){k.call(this)}function Yo(t){this.a=n.setTimeout(m(this.c,this),0),this.b=t}(t=Oo.prototype).Ga=function(){void 0!==e&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Eo(this.b,Ko(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(Eo(this.b,Ko(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Uo(this))},t.va=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Uo(this,!0)),Oo.ob.va.call(this)},t.Jb=function(){this.qa||(this.I||this.i||this.f?jo(this):this.wc())},t.wc=function(){jo(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case Po:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer;}var t=this.b;return t&&t.log(go,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(e){return Eo(this.b,"Can not get response: "+e.message),null}},qo.prototype.cancel=function(t){if(this.a)this.c instanceof qo&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.v?this.v.call(this.u,this):this.m=!0,this.a||(t=new zo(this),Wo(this),Ho(this,!1,t))}},qo.prototype.o=function(t,e){this.i=!1,Ho(this,t,e)},qo.prototype.D=function(){Wo(this),Ho(this,!0,null)},qo.prototype.then=function(t,e,n){var i,r,o=new pt(function(t,e){i=t,r=e});return Bo(this,i,function(t){t instanceof zo?o.cancel():r(t)}),o.then(t,e,n)},w(qo),y(Jo,k),Jo.prototype.message="Deferred has already fired",Jo.prototype.name="AlreadyCalledError",y(zo,k),zo.prototype.message="Deferred was canceled",zo.prototype.name="CanceledError",Yo.prototype.c=function(){throw delete Zo[this.a],this.b};var Zo={};function Qo(t){var e={},n=e.document||document,i=bn(t),r=document.createElement("SCRIPT"),o={Lb:r,Ga:void 0},a=new qo(ta,o),s=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(s=window.setTimeout(function(){ea(r,!0);var t=new ra(ia,"Timeout reached for loading script "+i);Wo(a),Ho(a,!1,t)},u),o.Ga=s),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(ea(r,e.fd||!1,s),a.D())},r.onerror=function(){ea(r,!0,s);var t=new ra(na,"Error while loading script "+i);Wo(a),Ho(a,!1,t)},ut(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),Cn(r,o),r.src=bn(t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(r),a}function ta(){if(this&&this.Lb){var t=this.Lb;t&&"SCRIPT"==t.tagName&&ea(t,!0,this.Ga)}}function ea(t,e,i){null!=i&&n.clearTimeout(i),t.onload=o,t.onerror=o,t.onreadystatechange=o,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var na=0,ia=1;function ra(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),k.call(this,n),this.code=t}function oa(t){this.f=t}function aa(t,e,i){if(this.b=t,t=e||{},this.i=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.l=t.secureTokenTimeout||ca,this.f=rt(t.secureTokenHeaders||ha),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||fa,this.a=rt(t.firebaseHeaders||la),i&&(this.a["X-Client-Version"]=i,this.f["X-Client-Version"]=i),i="Node"==ti(),!(i=n.XMLHttpRequest||i&&ab.INTERNAL.node&&ab.INTERNAL.node.XMLHttpRequest)&&!Qn())throw new Vi("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,Qn()?this.c=new Ao(self):ei()?this.c=new oa(i):this.c=new ho}y(ra,k),y(oa,ao),oa.prototype.a=function(){return new this.f},oa.prototype.b=function(){return{}};var sa,ua="idToken",ca=new wi(3e4,6e4),ha={"Content-Type":"application/x-www-form-urlencoded"},fa=new wi(3e4,6e4),la={"Content-Type":"application/json"};function da(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function pa(t,e){e?(t.a["X-Client-Version"]=e,t.f["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.f["X-Client-Version"])}function va(t,e,i,r,o,a,s){(function(){var t=si();return!((t=ri(t)!=ii?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||qt&&Zt&&!(9<Zt))})()||Qn()?t=m(t.o,t):(sa||(sa=new pt(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{n[ga]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var i=yn(ma,{onload:ga});!function(t,e){Bo(t,null,e,void 0)}(Qo(i),function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)})),t=m(t.m,t)),t(e,i,r,o,a,s)}aa.prototype.o=function(t,e,i,r,o,a){if(Qn()&&(void 0===n.fetch||void 0===n.Headers||void 0===n.Request))throw new Vi("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new Oo(this.c);if(a){s.g=Math.max(0,a);var u=setTimeout(function(){s.dispatchEvent("timeout")},a)}De(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return Eo(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)}),Re(s,"ready",function(){u&&clearTimeout(u),Ut(this)}),Re(s,"timeout",function(){u&&clearTimeout(u),Ut(this),e&&e(null)}),Co(s,t,i,r,o)};var ma=mn("https://apis.google.com/js/client.js?onload=%{onload}"),ga="__fcb"+Math.floor(1e6*Math.random()).toString();function ba(t){if(!i(t=t.email)||!Jn.test(t))throw new Vi("invalid-email")}function ya(t){"email"in t&&ba(t)}function wa(t){if(!t[ua])throw new Vi("internal-error")}function Ia(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Vi("internal-error")}else{if(!t.sessionInfo)throw new Vi("missing-verification-id");if(!t.code)throw new Vi("missing-verification-code")}}aa.prototype.m=function(t,e,n,i,r){var o=this;sa.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:i,headers:r,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},aa.prototype.Qa=function(){return is(this,Xa,{})},aa.prototype.pb=function(t,e){return is(this,Ba,{idToken:t,email:e})},aa.prototype.qb=function(t,e){return is(this,Ga,{idToken:t,password:e})};var ka={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function Ta(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Vi("internal-error")}function Ea(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&cn(t=new on(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function Aa(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=oo(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=oo(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=oo(t)):t.errorMessage&&(e=rs(t.errorMessage)),e)throw e;if(!t[ua])throw new Vi("internal-error")}function Sa(t,e){return e.returnIdpCredential=!0,is(t,Ja,e)}function Na(t,e){return e.returnIdpCredential=!0,is(t,Ya,e)}function _a(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,is(t,za,e)}function Oa(t){if(!t.oobCode)throw new Vi("invalid-action-code")}(t=aa.prototype).rb=function(t,e){var n={idToken:t},i=[];return nt(ka,function(t,r){var o=e[r];null===o?i.push(t):r in e&&(n[r]=o)}),i.length&&(n.deleteAttribute=i),is(this,Ba,n)},t.kb=function(t,e){return ut(t={requestType:"PASSWORD_RESET",email:t},e),is(this,Va,t)},t.lb=function(t,e){return ut(t={requestType:"EMAIL_SIGNIN",email:t},e),is(this,$a,t)},t.jb=function(t,e){return ut(t={requestType:"VERIFY_EMAIL",idToken:t},e),is(this,Fa,t)},t.Ua=function(t){return is(this,ts,t)},t.Za=function(t,e){return is(this,Ha,{oobCode:t,newPassword:e})},t.Ja=function(t){return is(this,Da,{oobCode:t})},t.Wa=function(t){return is(this,Pa,{oobCode:t})};var Pa={endpoint:"setAccountInfo",B:Oa,da:"email"},Da={endpoint:"resetPassword",B:Oa,J:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new Vi("internal-error")}},Ra={endpoint:"signupNewUser",B:function(t){if(ba(t),!t.password)throw new Vi("weak-password")},J:wa,R:!0},Ca={endpoint:"createAuthUri"},La={endpoint:"deleteAccount",T:["idToken"]},xa={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],B:function(t){if(!u(t.deleteProvider))throw new Vi("internal-error")}},Ma={endpoint:"emailLinkSignin",T:["email","oobCode"],B:ba,J:wa,R:!0},ja={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],B:ba,J:wa,R:!0},Ua={endpoint:"getAccountInfo"},$a={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new Vi("internal-error");ba(t)},da:"email"},Fa={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Vi("internal-error")},da:"email"},Va={endpoint:"getOobConfirmationCode",T:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Vi("internal-error");ba(t)},da:"email"},Ka={ub:!0,endpoint:"getProjectConfig",Ib:"GET"},qa={ub:!0,endpoint:"getRecaptchaParam",Ib:"GET",J:function(t){if(!t.recaptchaSiteKey)throw new Vi("internal-error")}},Ha={endpoint:"resetPassword",B:Oa,da:"email"},Wa={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],da:"sessionInfo"},Ba={endpoint:"setAccountInfo",T:["idToken"],B:ya,R:!0},Ga={endpoint:"setAccountInfo",T:["idToken"],B:function(t){if(ya(t),!t.password)throw new Vi("weak-password")},J:wa,R:!0},Xa={endpoint:"signupNewUser",J:wa,R:!0},Ja={endpoint:"verifyAssertion",B:Ta,Oa:Ea,J:Aa,R:!0},za={endpoint:"verifyAssertion",B:Ta,Oa:Ea,J:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Vi("user-not-found");if(t.errorMessage)throw rs(t.errorMessage);if(!t[ua])throw new Vi("internal-error")},R:!0},Ya={endpoint:"verifyAssertion",B:function(t){if(Ta(t),!t.idToken)throw new Vi("internal-error")},Oa:Ea,J:Aa,R:!0},Za={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new Vi("invalid-custom-token")},J:wa,R:!0},Qa={endpoint:"verifyPassword",B:function(t){if(ba(t),!t.password)throw new Vi("wrong-password")},J:wa,R:!0},ts={endpoint:"verifyPhoneNumber",B:Ia,J:wa},es={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new Vi("internal-error");Ia(t)},J:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",oo(t);wa(t)}},ns={Xb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:Ia,J:wa};function is(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var i=t[e[n]];if(null==i||""===i)return!1}return!0}(n,e.T))return kt(new Vi("internal-error"));var i,r=e.Ib||"POST";return It(n).then(e.B).then(function(){return e.R&&(n.returnSecureToken=!0),function(t,e,n,i,r,o){var a=Xe(t.g+e);Be(a,"key",t.b),o&&Be(a,"cb",b().toString());var s="GET"==n;if(s)for(var u in i)i.hasOwnProperty(u)&&Be(a,u,i[u]);return new pt(function(e,o){va(t,a.toString(),function(t){t?t.error?o(os(t,r||{})):e(t):o(new Vi("network-request-failed"))},n,s?void 0:jn(vi(i)),t.a,t.h.get())})}(t,e.endpoint,r,n,e.Xb,e.ub||!1)}).then(function(t){return i=t,e.Oa?e.Oa(n,i):i}).then(e.J).then(function(){if(!e.da)return i;if(!(e.da in i))throw new Vi("internal-error");return i[e.da]})}function rs(t){return os({error:{errors:[{message:t}],code:400,message:t}})}function os(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=i[n]?new Vi(i[n]):null)return n;for(var r in n=t.error&&t.error.message||"",ut(i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0,i)if(0===n.indexOf(r))return new Vi(i[r],e);return!e&&t&&(e=pi(t)),new Vi("internal-error",e)}function as(t){this.b=t,this.a=null,this.fb=function(t){return(hs||(hs=new pt(function(t,e){function i(){yi(),ui("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){yi(),e(Error("Network Error"))},timeout:us.get()})}if(ui("gapi.iframes.Iframe"))t();else if(ui("gapi.load"))i();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();n[r]=function(){ui("gapi.load")?i():e(Error("Network Error"))},It(Qo(r=yn(ss,{onload:r}))).s(function(){e(Error("Network Error"))})}}).s(function(t){throw hs=null,t}))).then(function(){return new pt(function(e,n){ui("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:ui("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(i){function r(){clearTimeout(o),e()}t.a=i,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},cs.get());i.ping(r).then(r,function(){n(Error("Network Error"))})})})})}(this)}var ss=mn("https://apis.google.com/js/api.js?onload=%{onload}"),us=new wi(3e4,6e4),cs=new wi(5e3,15e3),hs=null;function fs(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=Je(this.i,"/__/auth/iframe"),Be(this.a,"apiKey",this.g),Be(this.a,"appName",this.h),this.b=null,this.c=[]}function ls(t,e,n,i,r){this.o=t,this.m=e,this.c=n,this.l=i,this.h=this.g=this.i=null,this.a=r,this.f=null}function ds(t){try{return ab.app(t).auth().ya()}catch(e){return[]}}function ps(t,e,n,i,r){this.m=t,this.f=e,this.b=n,this.c=i||null,this.h=r||null,this.o=this.u=this.v=null,this.g=[],this.l=this.a=null}function vs(t){var e=qn();return function(t){return is(t,Ka,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=Xe(e),i=n.c;n=n.b;for(var r=0;r<t.length;r++){var o=t[r],a=n,s=i;if(0==o.indexOf("chrome-extension://")?a=Xe(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:Xn.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new io(qn())})}function ms(t){return t.l?t.l:(t.l=zn().then(function(){if(!t.u){var e=t.c,n=t.h,i=ds(t.b),r=new fs(t.m,t.f,t.b);r.f=e,r.b=n,r.c=$(i||[]),t.u=r.toString()}t.i=new as(t.u),function(t){if(!t.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.fb.then(function(){t.a.register("authEvent",e,ui("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.i,function(e){var n={};if(e&&e.authEvent){var i=!1;for(e=Qr(e.authEvent),n=0;n<t.g.length;n++)i=t.g[n](e)||i;return(n={}).status=i?"ACK":"ERROR",It(n)}return n.status="ERROR",It(n)})}(t)}),t.l)}function gs(t){return t.o||(t.v=t.c?ai(t.c,ds(t.b)):null,t.o=new aa(t.f,hr(t.h),t.v)),t.o}function bs(t,e,n,i,r,o,a,s,u,c){return(t=new ls(t,e,n,i,r)).i=o,t.g=a,t.h=s,t.b=rt(u||null),t.f=c,t.toString()}function ys(t){if(this.a=t||ab.INTERNAL.reactNative&&ab.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Vi("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function ws(t){this.b=t,this.a={},this.c=m(this.f,this)}fs.prototype.toString=function(){return this.f?Be(this.a,"v",this.f):un(this.a.a,"v"),this.b?Be(this.a,"eid",this.b):un(this.a.a,"eid"),this.c.length?Be(this.a,"fw",this.c.join(",")):un(this.a.a,"fw"),this.a.toString()},ls.prototype.toString=function(){var t=Je(this.o,"/__/auth/handler");if(Be(t,"apiKey",this.m),Be(t,"appName",this.c),Be(t,"authType",this.l),this.a.isOAuthProvider){var e=this.a;try{var n=ab.app(this.c).auth().ea()}catch(s){n=null}for(var i in e.$a=n,Be(t,"providerId",this.a.providerId),n=vi((e=this.a).yb))n[i]=n[i].toString();i=e.Dc,n=rt(n);for(var r=0;r<i.length;r++){var o=i[r];o in n&&delete n[o]}e.cb&&e.$a&&!n[e.cb]&&(n[e.cb]=e.$a),it(n)||Be(t,"customParameters",pi(n))}if("function"==typeof this.a.Eb&&(e=this.a.Eb()).length&&Be(t,"scopes",e.join(",")),this.i?Be(t,"redirectUrl",this.i):un(t.a,"redirectUrl"),this.g?Be(t,"eventId",this.g):un(t.a,"eventId"),this.h?Be(t,"v",this.h):un(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Ge(t,a)&&Be(t,a,this.b[a]);return this.f?Be(t,"eid",this.f):un(t.a,"eid"),(a=ds(this.c)).length&&Be(t,"fw",a.join(",")),t.toString()},(t=ps.prototype).Ea=function(t,e,n){var i=new Vi("popup-closed-by-user"),r=new Vi("web-storage-unsupported"),o=this,a=!1;return this.ga().then(function(){(function(t){var e={type:"webStorageSupport"};return ms(t).then(function(){return function(t,e){return t.fb.then(function(){return new pt(function(n){t.a.send(e.type,e,n,ui("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(t&&Bn(t),e(r),a=!0)})}).s(function(){}).then(function(){if(!a)return function(t){return new pt(function(e){return function n(){xe(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!a)return xe(n).then(function(){e(i)})})},t.Mb=function(){var t=si();return!di(t)&&!bi(t)},t.Hb=function(){return!1},t.Cb=function(t,e,n,i,r,o,a){if(!t)return kt(new Vi("popup-blocked"));if(a&&!di())return this.ga().s(function(e){Bn(t),r(e)}),i(),It();this.a||(this.a=vs(gs(this)));var s=this;return this.a.then(function(){var e=s.ga().s(function(e){throw Bn(t),r(e),e});return i(),e}).then(function(){(Yr(n),a)||Hn(bs(s.m,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}).s(function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t})},t.Ca=function(t,e,n){this.a||(this.a=vs(gs(this)));var i=this;return this.a.then(function(){Yr(e),Hn(bs(i.m,i.f,i.b,t,e,qn(),n,i.c,void 0,i.h))}).s(function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t})},t.ga=function(){var t=this;return ms(this).then(function(){return t.i.fb}).s(function(){throw t.a=null,new Vi("network-request-failed")})},t.Qb=function(){return!0},t.wa=function(t){this.g.push(t)},t.Ka=function(t){j(this.g,function(e){return e==t})},(t=ys.prototype).get=function(t){return It(this.a.getItem(t)).then(function(t){return t&&mi(t)})},t.set=function(t,e){return It(this.a.setItem(t,pi(e)))},t.P=function(t){return It(this.a.removeItem(t))},t.Y=function(){},t.ca=function(){};var Is,ks=[];function Ts(t){this.a=t}function Es(t){this.c=t,this.b=!1,this.a=[]}function As(t,e,n,i){var r,o,a,s,u=n||{},c=null;if(t.b)return kt(Error("connection_unavailable"));var h=i?800:50,f="undefined"!=typeof MessageChannel?new MessageChannel:null;return new pt(function(n,i){f?(r=Math.floor(Math.random()*Math.pow(10,20)).toString(),f.port1.start(),a=setTimeout(function(){i(Error("unsupported_event"))},h),c={messageChannel:f,onMessage:o=function(t){t.data.eventId===r&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){i(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):i(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),i(Error("invalid_response"))))}},t.a.push(c),f.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:r,data:u},[f.port2])):i(Error("connection_unavailable"))}).then(function(e){return Ss(t,c),e}).s(function(e){throw Ss(t,c),e})}function Ss(t,e){if(e){var n=e.messageChannel,i=e.onMessage;n&&(n.port1.removeEventListener("message",i),n.port1.close()),j(t.a,function(t){return t==e})}}function Ns(){if(!Ps())throw new Vi("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=n.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.u=!1,this.h=null;var t=this;Qn()&&self?(this.l=function(){var t=Qn()?self:null;if(R(ks,function(n){n.b==t&&(e=n)}),!e){var e=new ws(t);ks.push(e)}return e}(),this.l.subscribe("keyChanged",function(e,n){return xs(t).then(function(e){return 0<e.length&&R(t.a,function(t){t(e)}),{keyProcessed:x(e,n.key)}})}),this.l.subscribe("ping",function(){return It(["keyChanged"])})):function(){var t=n.navigator;return t&&t.serviceWorker?It().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):It(null)}().then(function(e){(t.h=e)&&(t.g=new Es(new Ts(e)),As(t.g,"ping",null,!0).then(function(e){e[0].fulfilled&&x(e[0].value,"keyChanged")&&(t.u=!0)}).s(function(){}))})}function _s(t){return new pt(function(e,n){var i=t.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(i):function(t){return new pt(function(e,n){var i=t.m.deleteDatabase("firebaseLocalStorageDb");i.onsuccess=function(){e()},i.onerror=function(t){n(Error(t.target.error))}})}(t).then(function(){return _s(t)}).then(function(t){e(t)}).s(function(t){n(t)})}})}function Os(t){return t.o||(t.o=_s(t)),t.o}function Ps(){try{return!!n.indexedDB}catch(Vt){return!1}}function Ds(t){return t.objectStore("firebaseLocalStorage")}function Rs(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Cs(t){return new pt(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function Ls(t,e){return t.g&&t.h&&function(){var t=n.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?As(t.g,"keyChanged",{key:e},t.u).then(function(){}).s(function(){}):It()}function xs(t){return Os(t).then(function(t){var e=Ds(Rs(t,!1));return e.getAll?Cs(e.getAll()):new pt(function(t,n){var i=[],r=e.openCursor();r.onsuccess=function(e){(e=e.target.result)?(i.push(e.value),e.continue()):t(i)},r.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},i=[];if(0==t.b){for(i=0;i<e.length;i++)n[e[i].fbase_key]=e[i].value;i=function t(e,n){var i,r=[];for(i in e)i in n?typeof e[i]!=typeof n[i]?r.push(i):"object"==typeof e[i]&&null!=e[i]&&null!=n[i]?0<t(e[i],n[i]).length&&r.push(i):e[i]!==n[i]&&r.push(i):r.push(i);for(i in n)i in e||r.push(i);return r}(t.c,n),t.c=n}return i})}function Ms(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function js(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=It().then(function(){if(Ps()){var t=gi(),i="__sak"+t;return Is||(Is=new Ns),(n=Is).set(i,t).then(function(){return n.get(i)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.P(i)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.Y(function(t){R(e.a,function(e){e(t)})}),t})}function Us(){this.a={},this.type="inMemory"}function $s(){if(!function(){var t="Node"==ti();if(!(t=Fs()||t&&ab.INTERNAL.node&&ab.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==ti())throw new Vi("internal-error","The LocalStorage compatibility library was not found.");throw new Vi("web-storage-unsupported")}this.a=Fs()||ab.INTERNAL.node.localStorage,this.type="localStorage"}function Fs(){try{var t=n.localStorage,e=gi();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(i){return null}}function Vs(){this.type="nullStorage"}function Ks(){if(!function(){var t="Node"==ti();if(!(t=qs()||t&&ab.INTERNAL.node&&ab.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==ti())throw new Vi("internal-error","The SessionStorage compatibility library was not found.");throw new Vi("web-storage-unsupported")}this.a=qs()||ab.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function qs(){try{var t=n.sessionStorage,e=gi();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(i){return null}}function Hs(){var t={};t.Browser=Gs,t.Node=Xs,t.ReactNative=Js,t.Worker=zs,this.a=t[ti()]}ws.prototype.f=function(t){var e=t.data.eventType,n=t.data.eventId,i=this.a[e];if(i&&0<i.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var r=[];R(i,function(e){r.push(It().then(function(){return e(t.origin,t.data.data)}))}),Et(r).then(function(i){var r=[];R(i,function(t){r.push({fulfilled:t.Db,value:t.value,reason:t.reason?t.reason.message:void 0})}),R(r,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:r})})}},ws.prototype.subscribe=function(t,e){it(this.a)&&this.b.addEventListener("message",this.c),void 0===this.a[t]&&(this.a[t]=[]),this.a[t].push(e)},ws.prototype.unsubscribe=function(t,e){void 0!==this.a[t]&&e?(j(this.a[t],function(t){return t==e}),0==this.a[t].length&&delete this.a[t]):e||delete this.a[t],it(this.a)&&this.b.removeEventListener("message",this.c)},Ts.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Es.prototype.close=function(){for(;0<this.a.length;)Ss(this,this.a[0]);this.b=!0},(t=Ns.prototype).set=function(t,e){var n,i=!1,r=this;return Os(this).then(function(e){return Cs((e=Ds(Rs(n=e,!0))).get(t))}).then(function(o){var a=Ds(Rs(n,!0));return o?(o.value=e,Cs(a.put(o))):(r.b++,i=!0,(o={}).fbase_key=t,o.value=e,Cs(a.add(o)))}).then(function(){return r.c[t]=e,Ls(r,t)}).ia(function(){i&&r.b--})},t.get=function(t){return Os(this).then(function(e){return Cs(Ds(Rs(e,!1)).get(t))}).then(function(t){return t&&t.value})},t.P=function(t){var e=!1,n=this;return Os(this).then(function(i){return e=!0,n.b++,Cs(Ds(Rs(i,!0)).delete(t))}).then(function(){return delete n.c[t],Ls(n,t)}).ia(function(){e&&n.b--})},t.Y=function(t){0==this.a.length&&function(t){Ms(t),function e(){t.f=setTimeout(function(){t.i=xs(t).then(function(e){0<e.length&&R(t.a,function(t){t(e)})}).then(function(){e()}).s(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()}(this),this.a.push(t)},t.ca=function(t){j(this.a,function(e){return e==t}),0==this.a.length&&Ms(this)},(t=js.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},t.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},t.P=function(t){return this.b.then(function(e){return e.P(t)})},t.Y=function(t){this.a.push(t)},t.ca=function(t){j(this.a,function(e){return e==t})},(t=Us.prototype).get=function(t){return It(this.a[t])},t.set=function(t,e){return this.a[t]=e,It()},t.P=function(t){return delete this.a[t],It()},t.Y=function(){},t.ca=function(){},(t=$s.prototype).get=function(t){var e=this;return It().then(function(){return mi(e.a.getItem(t))})},t.set=function(t,e){var n=this;return It().then(function(){var i=pi(e);null===i?n.P(t):n.a.setItem(t,i)})},t.P=function(t){var e=this;return It().then(function(){e.a.removeItem(t)})},t.Y=function(t){n.window&&be(n.window,"storage",t)},t.ca=function(t){n.window&&Ie(n.window,"storage",t)},(t=Vs.prototype).get=function(){return It(null)},t.set=function(){return It()},t.P=function(){return It()},t.Y=function(){},t.ca=function(){},(t=Ks.prototype).get=function(t){var e=this;return It().then(function(){return mi(e.a.getItem(t))})},t.set=function(t,e){var n=this;return It().then(function(){var i=pi(e);null===i?n.P(t):n.a.setItem(t,i)})},t.P=function(t){var e=this;return It().then(function(){e.a.removeItem(t)})},t.Y=function(){},t.ca=function(){};var Ws,Bs,Gs={A:$s,Ra:Ks},Xs={A:$s,Ra:Ks},Js={A:ys,Ra:Vs},zs={A:$s,Ra:Vs},Ys={Zc:"local",NONE:"none",ad:"session"};function Zs(){var t=!(bi(si())||!Zn()),e=di(),i=ci();this.o=t,this.h=e,this.l=i,this.a={},Ws||(Ws=new Hs),t=Ws;try{this.g=!Kn()&&Ti()||!n.indexedDB?new t.a.A:new js(Qn()?new Us:new t.a.A)}catch(r){this.g=new Us,this.h=!0}try{this.i=new t.a.Ra}catch(r){this.i=new Us}this.m=new Us,this.f=m(this.Pb,this),this.b={}}function Qs(){return Bs||(Bs=new Zs),Bs}function tu(t,e){switch(e){case"session":return t.i;case"none":return t.m;default:return t.g;}}function eu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function nu(t,e,n){return n=eu(e,n),"local"==e.A&&(t.b[n]=null),tu(t,e.A).P(n)}function iu(t){t.c&&(clearInterval(t.c),t.c=null)}function ru(t){this.a=t,this.b=Qs()}(t=Zs.prototype).get=function(t,e){return tu(this,t.A).get(eu(t,e))},t.set=function(t,e,n){var i=eu(t,n),r=this,o=tu(this,t.A);return o.set(i,e).then(function(){return o.get(i)}).then(function(e){"local"==t.A&&(r.b[i]=e)})},t.addListener=function(t,e,i){t=eu(t,e),this.l&&(this.b[t]=n.localStorage.getItem(t)),it(this.a)&&(tu(this,"local").Y(this.f),this.h||(Kn()||!Ti())&&n.indexedDB||!this.l||function(t){iu(t),t.c=setInterval(function(){for(var e in t.a){var i=n.localStorage.getItem(e),r=t.b[e];i!=r&&(t.b[e]=i,i=new se({type:"storage",key:e,target:window,oldValue:r,newValue:i,a:!0}),t.Pb(i))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(i)},t.removeListener=function(t,e,n){t=eu(t,e),this.a[t]&&(j(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),it(this.a)&&(tu(this,"local").ca(this.f),iu(this))},t.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var i in this.a){var r=this.b[i];void 0===r&&(r=null);var o=n.localStorage.getItem(i);o!==r&&(this.b[i]=o,this.Xa(i))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?tu(this,"local").ca(this.f):iu(this),this.o)if(i=n.localStorage.getItem(e),(r=t.a.newValue)!==i)null!==r?n.localStorage.setItem(e,r):n.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var a=this;i=function(){void 0===t.a.a&&a.b[e]===n.localStorage.getItem(e)||(a.b[e]=n.localStorage.getItem(e),a.Xa(e))},qt&&Zt&&10==Zt&&n.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(i,10):i()}}else R(t,m(this.Xa,this))},t.Xa=function(t){this.a[t]&&R(this.a[t],function(t){t()})};var ou,au={name:"authEvent",A:"local"};function su(){this.a=Qs()}function uu(t,e){this.b=cu,this.f=n.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=n.Int32Array?new Int32Array(64):Array(64),void 0!==ou||(ou=n.Int32Array?new Int32Array(mu):mu),this.reset()}y(uu,function(){this.b=-1});for(var cu=64,hu=cu-1,fu=[],lu=0;lu<hu;lu++)fu[lu]=0;var du=U(128,fu);function pu(t){for(var e=t.f,n=t.l,i=0,r=0;r<e.length;)n[i++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*i;for(e=16;64>e;e++){r=0|n[e-15],i=0|n[e-2];var o=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,a=(0|n[e-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;n[e]=o+a|0}i=0|t.a[0],r=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],f=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var l=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&s^r&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&f)+(0|ou[e])|0)+(0|n[e])|0)|0,o=f,f=h,h=c,c=u+a|0,u=s,s=r,r=i,i=a+l|0}t.a[0]=t.a[0]+i|0,t.a[1]=t.a[1]+r|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+f|0,t.a[7]=t.a[7]+o|0}function vu(t,e,n){void 0===n&&(n=e.length);var r=0,o=t.c;if(i(e))for(;r<n;)t.f[o++]=e.charCodeAt(r++),o==t.b&&(pu(t),o=0);else{if(!c(e))throw Error("message must be string or array");for(;r<n;){var a=e[r++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");t.f[o++]=a,o==t.b&&(pu(t),o=0)}}t.c=o,t.g+=n}uu.prototype.reset=function(){this.g=this.c=0,this.a=n.Int32Array?new Int32Array(this.h):$(this.h)};var mu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function gu(){uu.call(this,8,bu)}y(gu,uu);var bu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function yu(t,e,n,i,r){this.m=t,this.i=e,this.l=n,this.o=i||null,this.u=r||null,this.h=e+":"+n,this.v=new su,this.g=new ru(this.h),this.f=null,this.b=[],this.a=this.c=null}function wu(t){return new Vi("invalid-cordova-configuration",t)}function Iu(t){var e=new gu;vu(e,t),t=[];var n=8*e.g;56>e.c?vu(e,du,56-e.c):vu(e,du,e.b-(e.c-56));for(var i=63;56<=i;i--)e.f[i]=255&n,n/=256;for(pu(e),i=n=0;i<e.i;i++)for(var r=24;0<=r;r-=8)t[n++]=e.a[i]>>r&255;return function(t){return C(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function ku(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(i){}}function Tu(t){return t.f||(t.f=t.ga().then(function(){return new pt(function(e){t.wa(function n(i){return e(i),t.Ka(n),!1}),function(t){function e(e){r=!0,o&&o.cancel(),Eu(t).then(function(n){var r=i;if(n&&e&&e.url){var o=null;-1!=(r=Ar(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=mi(Ge(o=Xe(r),"firebaseError")||null))?Ki(o):null)?new Zr(n.b,n.c,null,null,o):new Zr(n.b,n.c,r,n.g)),r=o||i}ku(t,r)})}var i=new Zr("unknown",null,null,null,new Vi("no-auth-event")),r=!1,o=xe(500).then(function(){return Eu(t).then(function(){r||ku(t,i)})}),a=n.handleOpenURL;n.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(ui("BuildInfo.packageName",n).toLowerCase()+"://")&&e({url:t}),"function"==typeof a)try{a(t)}catch(i){console.error(i)}},no||(no=new to),no.subscribe(e)}(t)})})),t.f}function Eu(t){var e=null;return function(t){return t.b.get(au,t.a).then(function(t){return Qr(t)})}(t.g).then(function(n){return e=n,nu((n=t.g).b,au,n.a)}).then(function(){return e})}function Au(t){this.a=t,this.b=Qs()}(t=yu.prototype).ga=function(){return this.za?this.za:this.za=(Yn(void 0)?zn().then(function(){return new pt(function(t,e){var i=n.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);i.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):kt(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof ui("universalLinks.subscribe",n))throw wu("cordova-universal-links-plugin-fix is not installed");if(void 0===ui("BuildInfo.packageName",n))throw wu("cordova-plugin-buildinfo is not installed");if("function"!=typeof ui("cordova.plugins.browsertab.openUrl",n))throw wu("cordova-plugin-browsertab is not installed");if("function"!=typeof ui("cordova.InAppBrowser.open",n))throw wu("cordova-plugin-inappbrowser is not installed")},function(){throw new Vi("cordova-not-ready")})},t.Ea=function(t,e){return e(new Vi("operation-not-supported-in-this-environment")),It()},t.Cb=function(){return kt(new Vi("operation-not-supported-in-this-environment"))},t.Qb=function(){return!1},t.Mb=function(){return!0},t.Hb=function(){return!0},t.Ca=function(t,e,i){if(this.c)return kt(new Vi("redirect-operation-pending"));var r=this,o=n.document,a=null,s=null,u=null,c=null;return this.c=It().then(function(){return Yr(e),Tu(r)}).then(function(){return function(t,e,i,r){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Zr(e,r,null,o,new Vi("no-auth-event")),s=ui("BuildInfo.packageName",n);if("string"!=typeof s)throw new Vi("invalid-cordova-configuration");var u=ui("BuildInfo.displayName",n),c={};if(si().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=s;else{if(!si().toLowerCase().match(/android/))return kt(new Vi("operation-not-supported-in-this-environment"));c.apn=s}u&&(c.appDisplayName=u),o=Iu(o),c.sessionId=o;var h=bs(t.m,t.i,t.l,e,i,null,r,t.o,c,t.u);return t.ga().then(function(){var e=t.h;return t.v.a.set(au,a.C(),e)}).then(function(){var e=ui("cordova.plugins.browsertab.isAvailable",n);if("function"!=typeof e)throw new Vi("invalid-cordova-configuration");var i=null;e(function(e){if(e){if("function"!=typeof(i=ui("cordova.plugins.browsertab.openUrl",n)))throw new Vi("invalid-cordova-configuration");i(h)}else{if("function"!=typeof(i=ui("cordova.InAppBrowser.open",n)))throw new Vi("invalid-cordova-configuration");e=!(!(e=si()).match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),t.a=i(h,e?"_blank":"_system","location=yes")}})})}(r,t,e,i)}).then(function(){return new pt(function(t,e){s=function(){var e=ui("cordova.plugins.browsertab.close",n);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.wa(s),u=function(){a||(a=xe(2e3).then(function(){e(new Vi("redirect-cancelled-by-user"))}))},c=function(){Ii()&&u()},o.addEventListener("resume",u,!1),si().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)}).s(function(t){return Eu(r).then(function(){throw t})})}).ia(function(){u&&o.removeEventListener("resume",u,!1),c&&o.removeEventListener("visibilitychange",c,!1),a&&a.cancel(),s&&r.Ka(s),r.c=null})},t.wa=function(t){this.b.push(t),Tu(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Zr("unknown",null,null,null,new Vi("no-auth-event")),t(e))})},t.Ka=function(t){j(this.b,function(e){return e==t})};var Su={name:"pendingRedirect",A:"session"};function Nu(t){return nu(t.b,Su,t.a)}function _u(t,e,n){this.u=t,this.l=e,this.m=n,this.h=[],this.f=!1,this.i=m(this.bb,this),this.b=new Uu,this.o=new Ku,this.g=new Au(this.l+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.o,this.c.linkViaPopup=this.o,this.c.reauthViaPopup=this.o,this.a=Ou(this.u,this.l,this.m,ur)}function Ou(t,e,n,i){var r=ab.SDK_VERSION||null;return Yn()?new yu(t,e,n,r,i):new ps(t,e,n,r,i)}function Pu(t){t.f||(t.f=!0,t.a.wa(t.i));var e=t.a;return t.a.ga().s(function(n){throw t.a==e&&t.reset(),n})}function Du(t){t.a.Mb()&&Pu(t).s(function(e){var n=new Zr("unknown",null,null,null,new Vi("operation-not-supported-in-this-environment"));xu(e)&&t.bb(n)}),t.a.Hb()||$u(t.b)}(t=_u.prototype).reset=function(){this.f=!1,this.a.Ka(this.i),this.a=Ou(this.u,this.l,this.m)},t.Ya=function(){this.b.Ya()},t.subscribe=function(t){if(x(this.h,t)||this.h.push(t),!this.f){var e=this;(function(t){return t.b.get(Su,t.a).then(function(t){return"pending"==t})})(this.g).then(function(t){t?Nu(e.g).then(function(){Pu(e).s(function(t){var n=new Zr("unknown",null,null,null,new Vi("operation-not-supported-in-this-environment"));xu(t)&&e.bb(n)})}):Du(e)}).s(function(){Du(e)})}},t.unsubscribe=function(t){j(this.h,function(e){return e==t})},t.bb=function(t){if(!t)throw new Vi("invalid-auth-event");for(var e=!1,n=0;n<this.h.length;n++){var i=this.h[n];if(i.vb(t.b,t.c)){(e=this.c[t.b])&&e.h(t,i),e=!0;break}}return $u(this.b),e};var Ru=new wi(2e3,1e4),Cu=new wi(3e4,6e4);function Lu(t,e,n,i,r,o){return t.a.Cb(e,n,i,function(){t.f||(t.f=!0,t.a.wa(t.i))},function(){t.reset()},r,o)}function xu(t){return!(!t||"auth/cordova-not-ready"!=t.code)}_u.prototype.fa=function(){return this.b.fa()},_u.prototype.Ca=function(t,e,n){var i,r=this;return function(t){return t.b.set(Su,"pending",t.a)}(this.g).then(function(){return r.a.Ca(t,e,n).s(function(t){if(xu(t))throw new Vi("operation-not-supported-in-this-environment");return i=t,Nu(r.g).then(function(){throw i})}).then(function(){return r.a.Qb()?new pt(function(){}):Nu(r.g).then(function(){return r.fa()}).then(function(){}).s(function(){})})})},_u.prototype.Ea=function(t,e,n,i){return this.a.Ea(n,function(n){t.ha(e,null,n,i)},Ru.get())};var Mu={};function ju(t,e,n){var i=e+":"+n;return Mu[i]||(Mu[i]=new _u(t,e,n)),Mu[i]}function Uu(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function $u(t){t.g||(t.g=!0,Vu(t,!1,null,null))}function Fu(t,e){if(t.b=function(){return It(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Vu(t,e,n,i){e?i?function(t,e){if(t.b=function(){return kt(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,i):Fu(t,n):Fu(t,{user:null}),t.f=[],t.c=[]}function Ku(){}function qu(){this.sb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.sb},set:function(t){this.sb=t},enumerable:!1})}function Hu(t,e){this.a=e,_i(this,"verificationId",t)}function Wu(t,e,n,i){return new Xr(t).Ua(e,n).then(function(t){return new Hu(t,i)})}function Bu(t){var e=sr(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Vi("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Oi(this,{token:t,expirationTime:ki(1e3*e.exp),authTime:ki(1e3*e.auth_time),issuedAtTime:ki(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function Gu(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Xu(t){this.f=t,this.b=this.a=null,this.c=0}function Ju(t,e){var n=e[ua],i=e.refreshToken;e=zu(e.expiresIn),t.b=n,t.c=e,t.a=i}function zu(t){return b()+1e3*parseInt(t,10)}function Yu(t,e){return function(t,e){return new pt(function(n,i){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?va(t,t.i+"?key="+encodeURIComponent(t.b),function(t){t?t.error?i(os(t)):t.access_token&&t.refresh_token?n(t):i(new Vi("internal-error")):i(new Vi("network-request-failed"))},"POST",sn(e).toString(),t.f,t.l.get()):i(new Vi("internal-error"))})}(t.f,e).then(function(e){return t.b=e.access_token,t.c=zu(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function Zu(t,e){this.a=t||null,this.b=e||null,Oi(this,{lastSignInTime:ki(e||null),creationTime:ki(t||null)})}function Qu(t,e,n,i,r,o){Oi(this,{uid:t,displayName:i||null,photoURL:r||null,email:n||null,phoneNumber:o||null,providerId:e})}function tc(t,e){for(var n in ae.call(this,t),e)this[n]=e[n]}function ec(t,e,n){this.G=[],this.m=t.apiKey,this.o=t.appName,this.u=t.authDomain||null,t=ab.SDK_VERSION?ai(ab.SDK_VERSION):null,this.b=new aa(this.m,hr(ur),t),this.h=new Xu(this.b),uc(this,e[ua]),Ju(this.h,e),_i(this,"refreshToken",this.h.a),fc(this,n||{}),Pe.call(this),this.I=!1,this.u&&hi()&&(this.a=ju(this.u,this.m,this.o)),this.N=[],this.i=null,this.w=function(t){return new Gu(function(){return t.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.h.c-b()-3e5;return 0<e?e:0})}(this),this.V=m(this.Ha,this);var i=this;this.ka=null,this.ta=function(t){i.pa(t.g)},this.X=null,this.O=[],this.sa=function(t){ic(i,t.c)},this.W=null}function nc(t,e){t.X&&Ie(t.X,"languageCodeChanged",t.ta),(t.X=e)&&be(e,"languageCodeChanged",t.ta)}function ic(t,e){t.O=e,pa(t.b,ab.SDK_VERSION?ai(ab.SDK_VERSION,t.O):null)}function rc(t,e){t.W&&Ie(t.W,"frameworkChanged",t.sa),(t.W=e)&&be(e,"frameworkChanged",t.sa)}function oc(t){try{return ab.app(t.o).auth()}catch(e){throw new Vi("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}}function ac(t){t.D||t.w.b||(t.w.start(),Ie(t,"tokenChanged",t.V),be(t,"tokenChanged",t.V))}function sc(t){Ie(t,"tokenChanged",t.V),t.w.stop()}function uc(t,e){t.ra=e,_i(t,"_lat",e)}function cc(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return Et(e).then(function(){return t})}function hc(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function fc(t,e){Oi(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new Zu(e.createdAt,e.lastLoginAt),providerData:[]})}function lc(){}function dc(t){return It().then(function(){if(t.D)throw new Vi("app-deleted")})}function pc(t){return C(t.providerData,function(t){return t.providerId})}function vc(t,e){e&&(mc(t,e.providerId),t.providerData.push(e))}function mc(t,e){j(t.providerData,function(t){return t.providerId==e})}function gc(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&_i(t,e,n)}function bc(t,e){t!=e&&(Oi(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?_i(t,"metadata",function(t){return new Zu(t.a,t.b)}(e.metadata)):_i(t,"metadata",new Zu),R(e.providerData,function(e){vc(t,e)}),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),_i(t,"refreshToken",t.h.a))}function yc(t){return t.F().then(function(e){var n=t.isAnonymous;return function(t,e){return is(t.b,Ua,{idToken:e}).then(m(t.xc,t))}(t,e).then(function(){return n||gc(t,"isAnonymous",!1),e})})}function wc(t,e){e[ua]&&t.ra!=e[ua]&&(Ju(t.h,e),t.dispatchEvent(new tc("tokenChanged")),uc(t,e[ua]),gc(t,"refreshToken",t.h.a))}function Ic(t,e){return yc(t).then(function(){if(x(pc(t),e))return cc(t).then(function(){throw new Vi("provider-already-linked")})})}function kc(t,e,n){return Pi({user:t,credential:zr(e),additionalUserInfo:e=vr(e),operationType:n})}function Tc(t,e){return wc(t,e),t.reload().then(function(){return t})}function Ec(t,e,n,i,r){if(!hi())return kt(new Vi("operation-not-supported-in-this-environment"));if(t.i&&!r)return kt(t.i);var o=pr(n.providerId),a=gi(t.uid+":::"),s=null;(!di()||Zn())&&t.u&&n.isOAuthProvider&&(s=bs(t.u,t.m,t.o,e,n,null,a,ab.SDK_VERSION||null));var u=Gn(s,o&&o.Ba,o&&o.Aa);return i=i().then(function(){if(Sc(t),!r)return t.F().then(function(){})}).then(function(){return Lu(t.a,u,e,n,a,!!s)}).then(function(){return new pt(function(n,i){t.ha(e,null,new Vi("cancelled-popup-request"),t.g||null),t.f=n,t.v=i,t.g=a,t.c=t.a.Ea(t,e,u,a)})}).then(function(t){return u&&Bn(u),t?Pi(t):null}).s(function(t){throw u&&Bn(u),t}),Nc(t,i,r)}function Ac(t,e,n,i,r){if(!hi())return kt(new Vi("operation-not-supported-in-this-environment"));if(t.i&&!r)return kt(t.i);var o=null,a=gi(t.uid+":::");return i=i().then(function(){if(Sc(t),!r)return t.F().then(function(){})}).then(function(){return t.aa=a,cc(t)}).then(function(e){return t.ba&&(e=(e=t.ba).b.set(Pc,t.C(),e.a)),e}).then(function(){return t.a.Ca(e,n,a)}).s(function(e){if(o=e,t.ba)return Dc(t.ba);throw o}).then(function(){if(o)throw o}),Nc(t,i,r)}function Sc(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new Vi("internal-error");throw new Vi("auth-domain-config-required")}}function Nc(t,e,n){var i=function(t,e,n){return t.i&&!n?(e.cancel(),kt(t.i)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new tc("userInvalidated")),t.i=e),e})}(t,e,n);return t.G.push(i),i.ia(function(){M(t.G,i)}),i}function _c(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[ua]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-b())/1e3;var i=new ec(e,n,t);return t.providerData&&R(t.providerData,function(t){t&&vc(i,Pi(t))}),t.redirectEventId&&(i.aa=t.redirectEventId),i}function Oc(t){this.a=t,this.b=Qs()}Uu.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Uu.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.b,i=t.c,r=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!r&&!o),"unknown"!=n||r||o?t.a?(Vu(this,!0,null,t.a),It()):e.xa(n,i)?function(t,e,n){n=n.xa(e.b,e.c);var i=e.f,r=e.g,o=e.h,a=!!e.b.match(/Redirect$/);n(i,r,o).then(function(e){Vu(t,a,e,null)}).s(function(e){Vu(t,a,null,e)})}(this,t,e):kt(new Vi("invalid-auth-event")):(Vu(this,!1,null,null),It())}else kt(new Vi("invalid-auth-event"))},Uu.prototype.Ya=function(){this.g&&!this.i&&Vu(this,!1,null,null)},Uu.prototype.fa=function(){var t=this;return new pt(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new Vi("timeout");t.a&&t.a.cancel(),t.a=xe(Cu.get()).then(function(){t.b||(t.g=!0,Vu(t,!0,null,e))})}(t))})},Ku.prototype.h=function(t,e){if(t){var n=t.b,i=t.c;t.a?(e.ha(t.b,null,t.a,t.c),It()):e.xa(n,i)?function(t,e){var n=t.c,i=t.b;e.xa(i,n)(t.f,t.g,t.h).then(function(t){e.ha(i,t,null,n)}).s(function(t){e.ha(i,null,t,n)})}(t,e):kt(new Vi("invalid-auth-event"))}else kt(new Vi("invalid-auth-event"))},Hu.prototype.confirm=function(t){return t=Jr(this.verificationId,t),this.a(t)},Gu.prototype.start=function(){this.a=this.c,function t(e,i){e.stop();e.b=xe(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,i)).then(function(){return t=n.document,e=null,Ii()||!t?It():new pt(function(n){e=function(){Ii()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).s(function(n){e.i(n)&&t(e,!1)})}(this,!0)},Gu.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Xu.prototype.C=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Xu.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?kt(new Vi("user-token-expired")):t||!this.b||b()>this.c-3e4?this.a?Yu(this,{grant_type:"refresh_token",refresh_token:this.a}):It(null):It({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Zu.prototype.C=function(){return{lastLoginAt:this.b,createdAt:this.a}},y(tc,ae),y(ec,Pe),ec.prototype.pa=function(t){this.ka=t,da(this.b,t)},ec.prototype.ea=function(){return this.ka},ec.prototype.ya=function(){return $(this.O)},ec.prototype.Ha=function(){this.w.b&&(this.w.stop(),this.w.start())},_i(ec.prototype,"providerId","firebase"),(t=ec.prototype).reload=function(){var t=this;return Nc(this,dc(this).then(function(){return yc(t).then(function(){return cc(t)}).then(lc)}))},t.dc=function(t){return this.F(t).then(function(t){return new Bu(t)})},t.F=function(t){var e=this;return Nc(this,dc(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new Vi("internal-error");return t.accessToken!=e.ra&&(uc(e,t.accessToken),e.dispatchEvent(new tc("tokenChanged"))),gc(e,"refreshToken",t.refreshToken),t.accessToken}))},t.xc=function(t){if(!(t=t.users)||!t.length)throw new Vi("internal-error");fc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?C(t,function(t){return new Qu(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)vc(this,e[n]);gc(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},t.gb=function(t){var e=this,n=null;return Nc(this,t.f(this.b,this.uid).then(function(t){return wc(e,t),n=kc(e,t,"reauthenticate"),e.i=null,e.reload()}).then(function(){return n}),!0)},t.yc=function(t){return Si("firebase.User.prototype.reauthenticateWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential instead."),this.gb(t).then(function(){})},t.eb=function(t){var e=this,n=null;return Nc(this,Ic(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.b(e.b,n)}).then(function(t){return n=kc(e,t,"link"),Tc(e,t)}).then(function(){return n}))},t.pc=function(t){return Si("firebase.User.prototype.linkWithCredential is deprecated. Please use firebase.User.prototype.linkAndRetrieveDataWithCredential instead."),this.eb(t).then(function(t){return t.user})},t.qc=function(t,e){var n=this;return Nc(this,Ic(this,"phone").then(function(){return Wu(oc(n),t,e,m(n.eb,n))}))},t.zc=function(t,e){var n=this;return Nc(this,It().then(function(){return Wu(oc(n),t,e,m(n.gb,n))}),!0)},t.pb=function(t){var e=this;return Nc(this,this.F().then(function(n){return e.b.pb(n,t)}).then(function(t){return wc(e,t),e.reload()}))},t.Rc=function(t){var e=this;return Nc(this,this.F().then(function(n){return t.b(e.b,n)}).then(function(t){return wc(e,t),e.reload()}))},t.qb=function(t){var e=this;return Nc(this,this.F().then(function(n){return e.b.qb(n,t)}).then(function(t){return wc(e,t),e.reload()}))},t.rb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return dc(this);var e=this;return Nc(this,this.F().then(function(n){return e.b.rb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return wc(e,t),gc(e,"displayName",t.displayName||null),gc(e,"photoURL",t.photoUrl||null),R(e.providerData,function(t){"password"===t.providerId&&(_i(t,"displayName",e.displayName),_i(t,"photoURL",e.photoURL))}),cc(e)}).then(lc))},t.Pc=function(t){var e=this;return Nc(this,yc(this).then(function(n){return x(pc(e),t)?function(t,e,n){return is(t,xa,{idToken:e,deleteProvider:n})}(e.b,n,[t]).then(function(t){var n={};return R(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),R(pc(e),function(t){n[t]||mc(e,t)}),n[Xr.PROVIDER_ID]||_i(e,"phoneNumber",null),cc(e)}):cc(e).then(function(){throw new Vi("no-such-provider")})}))},t.delete=function(){var t=this;return Nc(this,this.F().then(function(e){return is(t.b,La,{idToken:e})}).then(function(){t.dispatchEvent(new tc("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");nc(t,null),rc(t,null),t.G=[],t.D=!0,sc(t),_i(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},t.vb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.aa||null)==e||"reauthViaRedirect"==t&&(this.aa||null)==e)},t.ha=function(t,e,n,i){"linkViaPopup"!=t&&"reauthViaPopup"!=t||i!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.xa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?m(this.Ab,this):"reauthViaPopup"==t&&e==(this.g||null)?m(this.Bb,this):"linkViaRedirect"==t&&(this.aa||null)==e?m(this.Ab,this):"reauthViaRedirect"==t&&(this.aa||null)==e?m(this.Bb,this):null},t.rc=function(t){var e=this;return Ec(this,"linkViaPopup",t,function(){return Ic(e,t.providerId).then(function(){return cc(e)})},!1)},t.Ac=function(t){return Ec(this,"reauthViaPopup",t,function(){return It()},!0)},t.sc=function(t){var e=this;return Ac(this,"linkViaRedirect",t,function(){return Ic(e,t.providerId)},!1)},t.Bc=function(t){return Ac(this,"reauthViaRedirect",t,function(){return It()},!0)},t.Ab=function(t,e,n){var i=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return Nc(this,this.F().then(function(r){return Na(i.b,{requestUri:t,postBody:n,sessionId:e,idToken:r})}).then(function(t){return r=kc(i,t,"link"),Tc(i,t)}).then(function(){return r}))},t.Bb=function(t,e,n){var i=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return Nc(this,It().then(function(){return Sr(_a(i.b,{requestUri:t,sessionId:e,postBody:n}),i.uid)}).then(function(t){return r=kc(i,t,"reauthenticate"),wc(i,t),i.i=null,i.reload()}).then(function(){return r}),!0)},t.jb=function(t){var e=this,n=null;return Nc(this,this.F().then(function(e){return n=e,void 0===t||it(t)?{}:er(new Wi(t))}).then(function(t){return e.b.jb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},t.toJSON=function(){return this.C()},t.C=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.m,appName:this.o,authDomain:this.u,stsTokenManager:this.h.C(),redirectEventId:this.aa||null};return this.metadata&&ut(t,this.metadata.C()),R(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),t};var Pc={name:"redirectUser",A:"session"};function Dc(t){return nu(t.b,Pc,t.a)}function Rc(t){this.a=t,this.b=Qs(),this.c=null,this.f=function(t){var e=xc("local"),i=xc("session"),r=xc("none");return function(t,e,i){var r=eu(e,i),o=tu(t,e.A);return t.get(e,i).then(function(a){var s=null;try{s=mi(n.localStorage.getItem(r))}catch(u){}if(s&&!a)return n.localStorage.removeItem(r),t.set(e,s,i);s&&a&&"localStorage"!=o.type&&n.localStorage.removeItem(r)})}(t.b,e,t.a).then(function(){return t.b.get(i,t.a)}).then(function(n){return n?i:t.b.get(r,t.a).then(function(n){return n?r:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(Lc,t.a).then(function(t){return t?xc(t):e})})})}).then(function(e){return t.c=e,Cc(t,e.A)}).s(function(){t.c||(t.c=e)})}(this),this.b.addListener(xc("local"),this.a,m(this.g,this))}function Cc(t,e){var n,i=[];for(n in Ys)Ys[n]!==e&&i.push(nu(t.b,xc(Ys[n]),t.a));return i.push(nu(t.b,Lc,t.a)),function(t){return new pt(function(e,n){var i=t.length,r=[];if(i)for(var o=function(t,n){i--,r[t]=n,0==i&&e(r)},a=function(t){n(t)},s=0;s<t.length;s++)Tt(t[s],g(o,s),a);else e(r)})}(i)}Rc.prototype.g=function(){var t=this,e=xc("local");$c(this,function(){return It().then(function(){return t.c&&"local"!=t.c.A?t.b.get(e,t.a):null}).then(function(n){if(n)return Cc(t,"local").then(function(){t.c=e})})})};var Lc={name:"persistence",A:"session"};function xc(t){return{name:"authUser",A:t}}function Mc(t,e){return $c(t,function(){return t.b.set(t.c,e.C(),t.a)})}function jc(t){return $c(t,function(){return nu(t.b,t.c,t.a)})}function Uc(t,e){return $c(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),_c(t||{})})})}function $c(t,e){return t.f=t.f.then(e,e),t.f}function Fc(t){if(this.m=!1,_i(this,"settings",new qu),_i(this,"app",t),!Gc(this).options||!Gc(this).options.apiKey)throw new Vi("invalid-api-key");t=ab.SDK_VERSION?ai(ab.SDK_VERSION):null,this.b=new aa(Gc(this).options&&Gc(this).options.apiKey,hr(ur),t),this.N=[],this.o=[],this.I=[],this.Tb=ab.INTERNAL.createSubscribe(m(this.mc,this)),this.O=void 0,this.Ub=ab.INTERNAL.createSubscribe(m(this.nc,this)),Wc(this,null),this.h=new Rc(Gc(this).options.apiKey+":"+Gc(this).name),this.w=new Oc(Gc(this).options.apiKey+":"+Gc(this).name),this.V=Yc(this,function(t){var e=Gc(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Pc,t.a).then(function(t){return t&&e&&(t.authDomain=e),_c(t||{})})}(t.w,Gc(t).options.authDomain).then(function(e){return(t.D=e)&&(e.ba=t.w),Dc(t.w)});return Yc(t,e)}(t).then(function(){return Uc(t.h,e)}).then(function(e){return e?(e.ba=t.w,t.D&&(t.D.aa||null)==(e.aa||null)?e:e.reload().then(function(){return Mc(t.h,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:jc(t.h)})):null}).then(function(e){Wc(t,e||null)});return Yc(t,n)}(this)),this.i=Yc(this,function(t){return t.V.then(function(){return t.fa()}).s(function(){}).then(function(){if(!t.m)return t.ka()}).s(function(){}).then(function(){if(!t.m){t.X=!0;var e=t.h;e.b.addListener(xc("local"),e.a,t.ka)}})}(this)),this.X=!1,this.ka=m(this.Mc,this),this.Ha=m(this.Z,this),this.ra=m(this.bc,this),this.sa=m(this.jc,this),this.ta=m(this.kc,this),function(t){var e=Gc(t).options.authDomain,n=Gc(t).options.apiKey;e&&hi()&&(t.Sb=t.V.then(function(){if(!t.m){if(t.a=ju(e,n,Gc(t).name),t.a.subscribe(t),Xc(t)&&hc(Xc(t)),t.D){hc(t.D);var i=t.D;i.pa(t.ea()),nc(i,t),ic(i=t.D,t.G),rc(i,t),t.D=null}return t.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=m(this.delete,this),this.INTERNAL.logFramework=m(this.tc,this),this.u=0,Pe.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ea()},set:function(t){this.pa(t)},enumerable:!1}),t.W=null}(this),this.G=[]}function Vc(t){ae.call(this,"languageCodeChanged"),this.g=t}function Kc(t){ae.call(this,"frameworkChanged"),this.c=t}function qc(t){return t.Sb||kt(new Vi("auth-domain-config-required"))}function Hc(t,e){var n={};return n.apiKey=Gc(t).options.apiKey,n.authDomain=Gc(t).options.authDomain,n.appName=Gc(t).name,t.V.then(function(){return function(t,e,n,i){var r=new ec(t,e);return n&&(r.ba=n),i&&ic(r,i),r.reload().then(function(){return r})}(n,e,t.w,t.ya())}).then(function(e){return Xc(t)&&e.uid==Xc(t).uid?(bc(Xc(t),e),t.Z(e)):(Wc(t,e),hc(e),t.Z(e))}).then(function(){zc(t)})}function Wc(t,e){Xc(t)&&(function(t,e){j(t.N,function(t){return t==e})}(Xc(t),t.Ha),Ie(Xc(t),"tokenChanged",t.ra),Ie(Xc(t),"userDeleted",t.sa),Ie(Xc(t),"userInvalidated",t.ta),sc(Xc(t))),e&&(e.N.push(t.Ha),be(e,"tokenChanged",t.ra),be(e,"userDeleted",t.sa),be(e,"userInvalidated",t.ta),0<t.u&&ac(e)),_i(t,"currentUser",e),e&&(e.pa(t.ea()),nc(e,t),ic(e,t.G),rc(e,t))}function Bc(t,e){var n=null,i=null;return Yc(t,e.then(function(e){return n=zr(e),i=vr(e),Hc(t,e)}).then(function(){return Pi({user:Xc(t),credential:n,additionalUserInfo:i,operationType:"signIn"})}))}function Gc(t){return t.app}function Xc(t){return t.currentUser}function Jc(t){return Xc(t)&&Xc(t)._lat||null}function zc(t){if(t.X){for(var e=0;e<t.o.length;e++)t.o[e]&&t.o[e](Jc(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](Jc(t))}}function Yc(t,e){return t.N.push(e),e.ia(function(){M(t.N,e)}),e}function Zc(){}function Qc(){this.a={},this.b=1e12}Rc.prototype.mb=function(t){var e=null,n=this;return function(t){var e=new Vi("invalid-persistence-type"),n=new Vi("unsupported-persistence-type");t:{for(i in Ys)if(Ys[i]==t){var i=!0;break t}i=!1}if(!i||"string"!=typeof t)throw e;switch(ti()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!ci()&&"none"!==t)throw n;}}(t),$c(this,function(){return t!=n.c.A?n.b.get(n.c,n.a).then(function(i){return e=i,Cc(n,t)}).then(function(){if(n.c=xc(t),e)return n.b.set(n.c,e,n.a)}):It()})},y(Fc,Pe),y(Vc,ae),y(Kc,ae),(t=Fc.prototype).mb=function(t){return Yc(this,t=this.h.mb(t))},t.pa=function(t){this.W===t||this.m||(this.W=t,da(this.b,this.W),this.dispatchEvent(new Vc(this.ea())))},t.ea=function(){return this.W},t.Sc=function(){var t=n.navigator;this.pa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.tc=function(t){this.G.push(t),pa(this.b,ab.SDK_VERSION?ai(ab.SDK_VERSION,this.G):null),this.dispatchEvent(new Kc(this.G))},t.ya=function(){return $(this.G)},t.toJSON=function(){return{apiKey:Gc(this).options.apiKey,authDomain:Gc(this).options.authDomain,appName:Gc(this).name,currentUser:Xc(this)&&Xc(this).C()}},t.vb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1;}},t.ha=function(t,e,n,i){"signInViaPopup"==t&&this.g==i&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.xa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?m(this.ac,this):null},t.ac=function(t,e,n){var i=this;t={requestUri:t,postBody:n,sessionId:e},this.c&&(this.c.cancel(),this.c=null);var r=null,o=null,a=Sa(i.b,t).then(function(t){return r=zr(t),o=vr(t),t});return Yc(this,t=i.V.then(function(){return a}).then(function(t){return Hc(i,t)}).then(function(){return Pi({user:Xc(i),credential:r,additionalUserInfo:o,operationType:"signIn"})}))},t.Kc=function(t){if(!hi())return kt(new Vi("operation-not-supported-in-this-environment"));var e=this,n=pr(t.providerId),i=gi(),r=null;(!di()||Zn())&&Gc(this).options.authDomain&&t.isOAuthProvider&&(r=bs(Gc(this).options.authDomain,Gc(this).options.apiKey,Gc(this).name,"signInViaPopup",t,null,i,ab.SDK_VERSION||null));var o=Gn(r,n&&n.Ba,n&&n.Aa);return Yc(this,n=qc(this).then(function(e){return Lu(e,o,"signInViaPopup",t,i,!!r)}).then(function(){return new pt(function(t,n){e.ha("signInViaPopup",null,new Vi("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=i,e.c=e.a.Ea(e,"signInViaPopup",o,i)})}).then(function(t){return o&&Bn(o),t?Pi(t):null}).s(function(t){throw o&&Bn(o),t}))},t.Lc=function(t){if(!hi())return kt(new Vi("operation-not-supported-in-this-environment"));var e=this;return Yc(this,qc(this).then(function(){return $c(t=e.h,function(){return t.b.set(Lc,t.c.A,t.a)});var t}).then(function(){return e.a.Ca("signInViaRedirect",t)}))},t.fa=function(){if(!hi())return kt(new Vi("operation-not-supported-in-this-environment"));var t=this;return Yc(this,qc(this).then(function(){return t.a.fa()}).then(function(t){return t?Pi(t):null}))},t.Qc=function(t){if(!t)return kt(new Vi("null-user"));var e=this,n={};n.apiKey=Gc(this).options.apiKey,n.authDomain=Gc(this).options.authDomain,n.appName=Gc(this).name;var i=function(t,e,n,i){e=e||{apiKey:t.m,authDomain:t.u,appName:t.o};var r=t.h,o={};return o[ua]=r.b,o.refreshToken=r.a,o.expiresIn=(r.c-b())/1e3,e=new ec(e,o),n&&(e.ba=n),i&&ic(e,i),bc(e,t),e}(t,n,e.w,e.ya());return Yc(this,this.i.then(function(){if(Gc(e).options.apiKey!=t.m)return i.reload()}).then(function(){return Xc(e)&&t.uid==Xc(e).uid?(bc(Xc(e),t),e.Z(t)):(Wc(e,i),hc(i),e.Z(i))}).then(function(){zc(e)}))},t.nb=function(){var t=this;return Yc(this,this.i.then(function(){return Xc(t)?(Wc(t,null),jc(t.h).then(function(){zc(t)})):It()}))},t.Mc=function(){var t=this;return Uc(this.h,Gc(this).options.authDomain).then(function(e){if(!t.m){var n;if(n=Xc(t)&&e){n=Xc(t).uid;var i=e.uid;n=null!=n&&""!==n&&null!=i&&""!==i&&n==i}if(n)return bc(Xc(t),e),Xc(t).F();(Xc(t)||e)&&(Wc(t,e),e&&(hc(e),e.ba=t.w),t.a&&t.a.subscribe(t),zc(t))}})},t.Z=function(t){return Mc(this.h,t)},t.bc=function(){zc(this),this.Z(Xc(this))},t.jc=function(){this.nb()},t.kc=function(){this.nb()},t.mc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(Xc(e))})},t.nc=function(t){var e=this;!function(t,e){t.I.push(e),Yc(t,t.i.then(function(){!t.m&&x(t.I,e)&&t.O!==t.getUid()&&(t.O=t.getUid(),e(Jc(t)))}))}(this,function(){t.next(Xc(e))})},t.vc=function(t,e,n){var i=this;return this.X&&ab.Promise.resolve().then(function(){h(t)?t(Xc(i)):h(t.next)&&t.next(Xc(i))}),this.Tb(t,e,n)},t.uc=function(t,e,n){var i=this;return this.X&&ab.Promise.resolve().then(function(){i.O=i.getUid(),h(t)?t(Xc(i)):h(t.next)&&t.next(Xc(i))}),this.Ub(t,e,n)},t.cc=function(t){var e=this;return Yc(this,this.i.then(function(){return Xc(e)?Xc(e).F(t).then(function(t){return{accessToken:t}}):null}))},t.Nb=function(t){var e=this;return this.i.then(function(){return Bc(e,is(e.b,Za,{token:t}))}).then(function(t){var n=t.user;return gc(n,"isAnonymous",!1),e.Z(n),t})},t.Ec=function(t){return Si("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCustomToken is deprecated. Please use firebase.auth.Auth.prototype.signInWithCustomToken instead."),this.Nb(t)},t.Fc=function(t,e){return Si("firebase.auth.Auth.prototype.signInAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.signInWithEmailAndPassword instead."),this.Ob(t,e)},t.Ob=function(t,e){var n=this;return this.i.then(function(){return Bc(n,is(n.b,Qa,{email:t,password:e}))})},t.xb=function(t,e){var n=this;return this.i.then(function(){return Bc(n,is(n.b,Ra,{email:t,password:e}))})},t.Wb=function(t,e){return Si("firebase.auth.Auth.prototype.createUserAndRetrieveDataWithEmailAndPassword is deprecated. Please use firebase.auth.Auth.prototype.createUserWithEmailAndPassword instead."),this.xb(t,e)},t.Hc=function(t){return Si("firebase.auth.Auth.prototype.signInWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential instead."),this.Pa(t).then(function(t){return t.user})},t.Pa=function(t){var e=this;return this.i.then(function(){return Bc(e,t.la(e.b))})},t.Qa=function(){var t=this;return this.i.then(function(){var e=Xc(t);if(e&&e.isAnonymous){var n=Pi({providerId:null,isNewUser:!1});return Pi({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return Bc(t,t.b.Qa()).then(function(e){var n=e.user;return gc(n,"isAnonymous",!0),t.Z(n),e})})},t.Gc=function(){return Si("firebase.auth.Auth.prototype.signInAnonymouslyAndRetrieveData is deprecated. Please use firebase.auth.Auth.prototype.signInAnonymously instead."),this.Qa()},t.getUid=function(){return Xc(this)&&Xc(this).uid||null},t.Vb=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&Xc(this)&&ac(Xc(this))},t.Cc=function(t){var e=this;R(this.o,function(n){n==t&&e.u--}),0>this.u&&(this.u=0),0==this.u&&Xc(this)&&sc(Xc(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.o.push(t),Yc(this,this.i.then(function(){e.m||x(e.o,t)&&t(Jc(e))}))},t.removeAuthTokenListener=function(t){j(this.o,function(e){return e==t})},t.delete=function(){this.m=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h).b.removeListener(xc("local"),t.a,this.ka),this.a&&(this.a.unsubscribe(this),this.a.Ya()),ab.Promise.resolve()},t.Zb=function(t){return Si("firebase.auth.Auth.prototype.fetchProvidersForEmail is deprecated. Please use firebase.auth.Auth.prototype.fetchSignInMethodsForEmail instead."),Yc(this,function(t,e){return is(t,Ca,{identifier:e,continueUri:fi()?qn():"http://localhost"}).then(function(t){return t.allProviders||[]})}(this.b,t))},t.$b=function(t){return Yc(this,function(t,e){return is(t,Ca,{identifier:e,continueUri:fi()?qn():"http://localhost"}).then(function(t){return t.signinMethods||[]})}(this.b,t))},t.oc=function(t){return!!Wr(t)},t.lb=function(t,e){var n=this;return Yc(this,It().then(function(){var t=new Wi(e);if(!t.c)throw new Vi("argument-error",Xi+" must be true when sending sign in link to email");return er(t)}).then(function(e){return n.b.lb(t,e)}).then(function(){}))},t.Tc=function(t){return this.Ja(t).then(function(t){return t.data.email})},t.Za=function(t,e){return Yc(this,this.b.Za(t,e).then(function(){}))},t.Ja=function(t){return Yc(this,this.b.Ja(t).then(function(t){return new Ri(t)}))},t.Wa=function(t){return Yc(this,this.b.Wa(t).then(function(){}))},t.kb=function(t,e){var n=this;return Yc(this,It().then(function(){return void 0===e||it(e)?{}:er(new Wi(e))}).then(function(e){return n.b.kb(t,e)}).then(function(){}))},t.Jc=function(t,e){return Yc(this,Wu(this,t,e,m(this.Pa,this)))},t.Ic=function(t,e){var n=this;return Yc(this,It().then(function(){var i=Hr(t,e||qn());return n.Pa(i)}))},Zc.prototype.render=function(){},Zc.prototype.reset=function(){},Zc.prototype.getResponse=function(){},Zc.prototype.execute=function(){};var th=null;function eh(t,e){return(e=nh(e))&&t.a[e]||null}function nh(t){return(t=void 0===t?1e12:t)?t.toString():null}function ih(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=Rn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():be(this.f,"click",this.i)}function rh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function oh(){}Qc.prototype.render=function(t,e){return this.a[this.b.toString()]=new ih(t,e),this.b++},Qc.prototype.reset=function(t){var e=eh(this,t);t=nh(t),e&&t&&(e.delete(),delete this.a[t])},Qc.prototype.getResponse=function(t){return(t=eh(this,t))?t.getResponse():null},Qc.prototype.execute=function(t){(t=eh(this,t))&&t.execute()},ih.prototype.getResponse=function(){return rh(this),this.b},ih.prototype.execute=function(){rh(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(i){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(i){}t.h&&t.execute()},6e4)},500))},ih.prototype.delete=function(){rh(this),this.g=!0,clearTimeout(this.a),this.a=null,Ie(this.f,"click",this.i)},oh.prototype.g=function(){return th||(th=new Qc),It(th)},oh.prototype.c=function(){};var ah=null;function sh(){this.b=n.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var uh=mn("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),ch=new wi(3e4,6e4);sh.prototype.g=function(t){var e=this;return new pt(function(i,r){var o=setTimeout(function(){r(new Vi("network-request-failed"))},ch.get());!n.grecaptcha||t!==e.f&&!e.b?(n[e.a]=function(){if(n.grecaptcha){e.f=t;var a=n.grecaptcha.render;n.grecaptcha.render=function(t,n){return t=a(t,n),e.b++,t},clearTimeout(o),i(n.grecaptcha)}else clearTimeout(o),r(new Vi("internal-error"));delete n[e.a]},It(Qo(yn(uh,{onload:e.a,hl:t||""}))).s(function(){clearTimeout(o),r(new Vi("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(o),i(n.grecaptcha))})},sh.prototype.c=function(){this.b--};var hh=null;function fh(t,e,i,r,o,a,s){if(_i(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.m=e,this.g=null,s?(ah||(ah=new oh),s=ah):(hh||(hh=new sh),s=hh),this.o=s,this.a=i||{theme:"light",type:"image"},this.h=[],this.a[ph])throw new Vi("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[vh],!n.document)throw new Vi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Rn(e)||!this.i&&Rn(e).hasChildNodes())throw new Vi("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new aa(t,a||null,o||null),this.v=r||function(){return null};var u=this;this.l=[];var c=this.a[lh];this.a[lh]=function(t){if(mh(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=ui(c,n);"function"==typeof e&&e(t)}};var h=this.a[dh];this.a[dh]=function(){if(mh(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=ui(h,n);"function"==typeof t&&t()}}}var lh="callback",dh="expired-callback",ph="sitekey",vh="size";function mh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(i){}}function gh(t,e){return t.h.push(e),e.ia(function(){M(t.h,e)}),e}function bh(t){if(t.D)throw new Vi("internal-error","RecaptchaVerifier instance has been destroyed.")}function yh(t,e,n){var i=!1;try{this.b=n||ab.app()}catch(a){throw new Vi("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Vi("invalid-api-key");n=this.b.options.apiKey;var r=this,o=null;try{o=this.b.auth().ya()}catch(a){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(a){}o=ab.SDK_VERSION?ai(ab.SDK_VERSION,o):null,fh.call(this,n,t,e,function(){try{var t=r.b.auth().ea()}catch(e){t=null}return t},o,hr(ur),i)}function wh(t,e,n,i){t:{n=Array.prototype.slice.call(n);for(var r=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new Vi("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(o=e.length,n.length<r||o<n.length)i="Expected "+(r==o?1==r?"1 argument":r+" arguments":r+"-"+o+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(o=e[r].optional&&void 0===n[r],!e[r].M(n[r])&&!o){if(e=e[r],0>r||r>=Ih.length)throw new Vi("internal-error","Argument validator received an unsupported number of arguments.");n=Ih[r],i=(i?"":n+" argument ")+(e.name?"\""+e.name+"\" ":"")+"must be "+e.K+".";break t}i=null}}if(i)throw new Vi("argument-error",t+" failed: "+i)}(t=fh.prototype).za=function(){var t=this;return this.f?this.f:this.f=gh(this,It().then(function(){if(fi()&&!Qn())return zn();throw new Vi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.o.g(t.v())}).then(function(e){return t.g=e,is(t.u,qa,{})}).then(function(e){t.a[ph]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},t.render=function(){bh(this);var t=this;return gh(this,this.za().then(function(){if(null===t.c){var e=t.m;if(!t.i){var n=Rn(e);e=xn("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},t.verify=function(){bh(this);var t=this;return gh(this,this.render().then(function(e){return new pt(function(n){var i=t.g.getResponse(e);if(i)n(i);else{var r=function(e){e&&(function(t,e){j(t.l,function(t){return t==e})}(t,r),n(e))};t.l.push(r),t.i&&t.g.execute(t.c)}})}))},t.reset=function(){bh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){bh(this),this.D=!0,this.o.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=Rn(this.m);for(var e;e=t.firstChild;)t.removeChild(e)}},y(yh,fh);var Ih="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function kh(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:i}}function Th(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:r}}function Eh(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:f}}function Ah(t,e){return{name:t||"",K:"a function",optional:!!e,M:h}}function Sh(t,e){return{name:t||"",K:"null",optional:!!e,M:s}}function Nh(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.la||!n)}}}function _h(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!!(t&&i(t.type)&&h(t.verify))}}}function Oh(t,e,n,i){return{name:n||"",K:t.K+" or "+e.K,optional:!!i,M:function(n){return t.M(n)||e.M(n)}}}function Ph(t,e){for(var n in e){var i=e[n].name;t[i]=Ch(i,t[n],e[n].j)}}function Dh(t,e){for(var n in e){var i=e[n].name;i!==n&&Object.defineProperty(t,i,{get:g(function(t){return this[t]},n),set:g(function(t,e,n,i){wh(t,[n],[i],!0),this[e]=i},i,n,e[n].tb),enumerable:!0})}}function Rh(t,e,n,i){t[e]=Ch(e,n,i)}function Ch(t,e,n){function i(){var t=Array.prototype.slice.call(arguments);return wh(o,n,t),e.apply(this,t)}if(!n)return e;var r,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(r in e)i[r]=e[r];for(r in e.prototype)i.prototype[r]=e.prototype[r];return i}Ph(Fc.prototype,{Wa:{name:"applyActionCode",j:[kh("code")]},Ja:{name:"checkActionCode",j:[kh("code")]},Za:{name:"confirmPasswordReset",j:[kh("code"),kh("newPassword")]},xb:{name:"createUserWithEmailAndPassword",j:[kh("email"),kh("password")]},Wb:{name:"createUserAndRetrieveDataWithEmailAndPassword",j:[kh("email"),kh("password")]},Zb:{name:"fetchProvidersForEmail",j:[kh("email")]},$b:{name:"fetchSignInMethodsForEmail",j:[kh("email")]},fa:{name:"getRedirectResult",j:[]},oc:{name:"isSignInWithEmailLink",j:[kh("emailLink")]},uc:{name:"onAuthStateChanged",j:[Oh(Eh(),Ah(),"nextOrObserver"),Ah("opt_error",!0),Ah("opt_completed",!0)]},vc:{name:"onIdTokenChanged",j:[Oh(Eh(),Ah(),"nextOrObserver"),Ah("opt_error",!0),Ah("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[kh("email"),Oh(Eh("opt_actionCodeSettings",!0),Sh(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[kh("email"),Eh("actionCodeSettings")]},mb:{name:"setPersistence",j:[kh("persistence")]},Pa:{name:"signInAndRetrieveDataWithCredential",j:[Nh()]},Qa:{name:"signInAnonymously",j:[]},Gc:{name:"signInAnonymouslyAndRetrieveData",j:[]},Hc:{name:"signInWithCredential",j:[Nh()]},Nb:{name:"signInWithCustomToken",j:[kh("token")]},Ec:{name:"signInAndRetrieveDataWithCustomToken",j:[kh("token")]},Ob:{name:"signInWithEmailAndPassword",j:[kh("email"),kh("password")]},Ic:{name:"signInWithEmailLink",j:[kh("email"),kh("emailLink",!0)]},Fc:{name:"signInAndRetrieveDataWithEmailAndPassword",j:[kh("email"),kh("password")]},Jc:{name:"signInWithPhoneNumber",j:[kh("phoneNumber"),_h()]},Kc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Qc:{name:"updateCurrentUser",j:[Oh({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof ec)}},Sh(),"user")]},nb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[kh(null,!0)]},Sc:{name:"useDeviceLanguage",j:[]},Tc:{name:"verifyPasswordResetCode",j:[kh("code")]}}),Dh(Fc.prototype,{lc:{name:"languageCode",tb:Oh(kh(),Sh(),"languageCode")}}),Fc.Persistence=Ys,Fc.Persistence.LOCAL="local",Fc.Persistence.SESSION="session",Fc.Persistence.NONE="none",Ph(ec.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[Th("opt_forceRefresh",!0)]},F:{name:"getIdToken",j:[Th("opt_forceRefresh",!0)]},eb:{name:"linkAndRetrieveDataWithCredential",j:[Nh()]},pc:{name:"linkWithCredential",j:[Nh()]},qc:{name:"linkWithPhoneNumber",j:[kh("phoneNumber"),_h()]},rc:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},sc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},gb:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Nh()]},yc:{name:"reauthenticateWithCredential",j:[Nh()]},zc:{name:"reauthenticateWithPhoneNumber",j:[kh("phoneNumber"),_h()]},Ac:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Bc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[Oh(Eh("opt_actionCodeSettings",!0),Sh(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[kh(null,!0)]},Pc:{name:"unlink",j:[kh("provider")]},pb:{name:"updateEmail",j:[kh("email")]},qb:{name:"updatePassword",j:[kh("password")]},Rc:{name:"updatePhoneNumber",j:[Nh("phone")]},rb:{name:"updateProfile",j:[Eh("profile")]}}),Ph(Qc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Ph(Zc.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Ph(pt.prototype,{ia:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Dh(qu.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",tb:Th("appVerificationDisabledForTesting")}}),Ph(Hu.prototype,{confirm:{name:"confirm",j:[kh("verificationCode")]}}),Rh(qr,"credential",function(t,e){return new Kr(t,e)},[kh("email"),kh("password")]),Ph(Lr.prototype,{ua:{name:"addScope",j:[kh("scope")]},Da:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Rh(Lr,"credential",xr,[Oh(kh(),Eh(),"token")]),Rh(qr,"credentialWithLink",Hr,[kh("email"),kh("emailLink")]),Ph(Mr.prototype,{ua:{name:"addScope",j:[kh("scope")]},Da:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Rh(Mr,"credential",jr,[Oh(kh(),Eh(),"token")]),Ph(Ur.prototype,{ua:{name:"addScope",j:[kh("scope")]},Da:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Rh(Ur,"credential",$r,[Oh(kh(),Oh(Eh(),Sh()),"idToken"),Oh(kh(),Sh(),"accessToken",!0)]),Ph(Fr.prototype,{Da:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Rh(Fr,"credential",Vr,[Oh(kh(),Eh(),"token"),kh("secret",!0)]),Ph(Cr.prototype,{ua:{name:"addScope",j:[kh("scope")]},credential:{name:"credential",j:[Oh(kh(),Sh(),"idToken",!0),Oh(kh(),Sh(),"accessToken",!0),Oh(kh(),Sh(),"nonce",!0)]},Da:{name:"setCustomParameters",j:[Eh("customOAuthParameters")]}}),Rh(Xr,"credential",Jr,[kh("verificationId"),kh("verificationCode")]),Ph(Xr.prototype,{Ua:{name:"verifyPhoneNumber",j:[kh("phoneNumber"),_h()]}}),Ph(Vi.prototype,{toJSON:{name:"toJSON",j:[kh(null,!0)]}}),Ph(ro.prototype,{toJSON:{name:"toJSON",j:[kh(null,!0)]}}),Ph(io.prototype,{toJSON:{name:"toJSON",j:[kh(null,!0)]}}),Ph(yh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),function(){if("undefined"==typeof ab||!ab.INTERNAL||!ab.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:Fc,Error:Vi};Rh(t,"EmailAuthProvider",qr,[]),Rh(t,"FacebookAuthProvider",Lr,[]),Rh(t,"GithubAuthProvider",Mr,[]),Rh(t,"GoogleAuthProvider",Ur,[]),Rh(t,"TwitterAuthProvider",Fr,[]),Rh(t,"OAuthProvider",Cr,[kh("providerId")]),Rh(t,"SAMLAuthProvider",Rr,[kh("providerId")]),Rh(t,"PhoneAuthProvider",Xr,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof Fc)}}]),Rh(t,"RecaptchaVerifier",yh,[Oh(kh(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Eh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof ab.app.App)}}]),ab.INTERNAL.registerService("auth",function(t,e){return e({INTERNAL:{getUid:m((t=new Fc(t)).getUid,t),getToken:m(t.cc,t),addAuthTokenListener:m(t.Vb,t),removeAuthTokenListener:m(t.Cc,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(n){}}),ab.INTERNAL.extendNamespace({User:ec})}()}).apply("undefined"!=typeof S?S:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var bs,Q,ds=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(Q||(bs=Q={},bs));var es=Q.INFO,fs=function(e,o){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];if(!(o<e.logLevel)){var p=new Date().toISOString();switch(o){case Q.DEBUG:case Q.VERBOSE:console.log.apply(console,["["+p+"]  "+e.name+":"].concat(t));break;case Q.INFO:console.info.apply(console,["["+p+"]  "+e.name+":"].concat(t));break;case Q.WARN:console.warn.apply(console,["["+p+"]  "+e.name+":"].concat(t));break;case Q.ERROR:console.error.apply(console,["["+p+"]  "+e.name+":"].concat(t));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+o+")");}}},gs=function(){function e(e){this.name=e,this._logLevel=es,this._logHandler=fs,ds.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in Q))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!0,configurable:!0}),e.prototype.debug=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,[this,Q.DEBUG].concat(e))},e.prototype.log=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,[this,Q.VERBOSE].concat(e))},e.prototype.info=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,[this,Q.INFO].concat(e))},e.prototype.warn=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,[this,Q.WARN].concat(e))},e.prototype.error=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];this._logHandler.apply(this,[this,Q.ERROR].concat(e))},e}();var na={},Vi=(Zb(),ac);function js(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(na,"__esModule",{value:!0});var oe=js(fc),ls=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),b.stringify(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:b.jsonEval(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),ms=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return b.contains(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),Si=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new ls(t)}}catch(r){}return new ms},ib=Si("localStorage"),le=Si("sessionStorage"),cc=new gs("@firebase/database"),Ki=function(){var e=1;return function(){return e++}}(),Ji=function(e){var t=b.stringToByteArray(e),r=new b.Sha1;r.update(t);var n=r.digest();return b.base64.encodeByteArray(n)},Tc=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r="",n=0;n<e.length;n++)Array.isArray(e[n])||e[n]&&"object"==typeof e[n]&&"number"==typeof e[n].length?r+=Tc.apply(null,e[n]):"object"==typeof e[n]?r+=b.stringify(e[n]):r+=e[n],r+=" ";return r},ie=null,vs=!0,ke=function(e,t){b.assert(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(cc.logLevel=Q.VERBOSE,ie=cc.log.bind(cc),t&&le.set("logging_enabled",!0)):"function"==typeof e?ie=e:(ie=null,le.remove("logging_enabled"))},L=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===vs&&(vs=!1,null===ie&&!0===le.get("logging_enabled")&&ke(!0)),ie){var r=Tc.apply(null,e);ie(r)}},Rc=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];L.apply(void 0,[e].concat(t))}},Gf=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE INTERNAL ERROR: "+Tc.apply(void 0,e);cc.error(r)},ga=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE FATAL ERROR: "+Tc.apply(void 0,e);throw cc.error(r),new Error(r)},K=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE WARNING: "+Tc.apply(void 0,e);cc.warn(r)},Cs=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&K("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},_d=function(e){return"number"==typeof e&&(e!=e||e==Number.POSITIVE_INFINITY||e==Number.NEGATIVE_INFINITY)},Es=function(e){if(b.isNodeSdk()||"complete"===document.readyState)e();else{var t=!1,r=function(){document.body?t||(t=!0,e()):setTimeout(r,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&r()}),window.attachEvent("onload",r))}},Va="[MIN_NAME]",Ga="[MAX_NAME]",Oa=function(e,t){if(e===t)return 0;if(e===Va||t===Ga)return-1;if(t===Va||e===Ga)return 1;var r=Zh(e),n=Zh(t);return null!==r?null!==n?r-n==0?e.length-t.length:r-n:-1:null!==n?1:e<t?-1:1},Is=function(e,t){return e===t?0:e<t?-1:1},Jc=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+b.stringify(t))},re=function(e){if("object"!=typeof e||null===e)return b.stringify(e);var t=[];for(var r in e)t.push(r);t.sort();for(var n="{",i=0;i<t.length;i++)0!==i&&(n+=","),n+=b.stringify(t[i]),n+=":",n+=re(e[t[i]]);return n+="}"},oi=function(e,t){var r=e.length;if(r<=t)return[e];for(var n=[],i=0;i<r;i+=t)i+t>r?n.push(e.substring(i,r)):n.push(e.substring(i,i+t));return n},ni=function(e,t){if(Array.isArray(e))for(var r=0;r<e.length;++r)t(r,e[r]);else b.forEach(e,function(e,r){return t(r,e)})},hi=function(e){b.assert(!_d(e),"Invalid JSON number");var t,r,n,i,a,o,s;for(0===e?(r=0,n=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(r=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,n=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(r=0,n=Math.round(e/Math.pow(2,-1074)))),o=[],a=52;a;a-=1)o.push(n%2?1:0),n=Math.floor(n/2);for(a=11;a;a-=1)o.push(r%2?1:0),r=Math.floor(r/2);o.push(t?1:0),o.reverse(),s=o.join("");var v="";for(a=0;a<64;a+=8){var l=parseInt(s.substr(a,8),2).toString(16);1===l.length&&(l="0"+l),v+=l}return v.toLowerCase()},Os=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},Ps=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},Qs=function(e,t){var r="Unknown Error";"too_big"===e?r="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==e?r="Client doesn't have permission to access the desired data.":"unavailable"==e&&(r="The service is unavailable");var n=new Error(e+" at "+t.path.toString()+": "+r);return n.code=e.toUpperCase(),n},Rs=new RegExp("^-?\\d{1,10}$"),Zh=function(e){if(Rs.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Rb=function(e){try{e()}catch(t){setTimeout(function(){var e=t.stack||"";throw K("Exception was thrown by user callback.",e),t},Math.floor(0))}},Us=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},yc=function(e,t){var r=setTimeout(e,t);return"object"==typeof r&&r.unref&&r.unref(),r},g=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var r=0,n=0;n<this.pieces_.length;n++)this.pieces_[n].length>0&&(this.pieces_[r]=this.pieces_[n],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:!0,configurable:!0}),e.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},e.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},e.prototype.popFront=function(){var t=this.pieceNum_;return t<this.pieces_.length&&t++,new e(this.pieces_,t)},e.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},e.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},e.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var t=[],r=this.pieceNum_;r<this.pieces_.length-1;r++)t.push(this.pieces_[r]);return new e(t,0)},e.prototype.child=function(t){for(var r=[],n=this.pieceNum_;n<this.pieces_.length;n++)r.push(this.pieces_[n]);if(t instanceof e)for(n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);else{var i=t.split("/");for(n=0;n<i.length;n++)i[n].length>0&&r.push(i[n])}return new e(r,0)},e.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},e.relativePath=function(t,r){var n=t.getFront(),i=r.getFront();if(null===n)return r;if(n===i)return e.relativePath(t.popFront(),r.popFront());throw new Error("INTERNAL ERROR: innerPath ("+r+") is not within outerPath ("+t+")")},e.comparePaths=function(e,t){for(var r=e.slice(),n=t.slice(),i=0;i<r.length&&i<n.length;i++){var a=Oa(r[i],n[i]);if(0!==a)return a}return r.length===n.length?0:r.length<n.length?-1:1},e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,r=e.pieceNum_;t<=this.pieces_.length;t++,r++)if(this.pieces_[t]!==e.pieces_[r])return!1;return!0},e.prototype.contains=function(e){var t=this.pieceNum_,r=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0},e}(),Xs=function(){function e(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=b.stringLength(this.parts_[r]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=b.stringLength(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=b.stringLength(e),this.parts_.length>0&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}(),Id="5",Qh="v",Oh="s",Lh="r",Kh="f",Jh="firebaseio.com",Hh="ls",Ah="websocket",zh="long_polling",yh=function(){function e(e,t,r,n,i){void 0===i&&(i=""),this.secure=t,this.namespace=r,this.webSocketOnly=n,this.persistenceKey=i,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=ib.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&ib.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){var r;if(b.assert("string"==typeof e,"typeof type must == string"),b.assert("object"==typeof t,"typeof params must == object"),e===Ah)r=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==zh)throw new Error("Unknown connection type: "+e);r=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var n=[];return b.forEach(t,function(e,t){n.push(e+"="+t)}),r+n.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}();function gt(e){for(var t="",r=e.split("/"),n=0;n<r.length;n++)if(r[n].length>0){var i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(a){}t+="/"+i}return t}function ht(e){var t={};"?"===e.charAt(0)&&(e=e.substring(1));for(var r=0,n=e.split("&");r<n.length;r++){var i=n[r];if(0!==i.length){var a=i.split("=");2===a.length?t[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):K("Invalid query segment '"+i+"' in query '"+e+"'")}}return t}var ve,wh,vh=function(e){var t=lt(e),r=t.subdomain;"firebase"===t.domain&&ga(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!=r||"localhost"===t.domain||ga("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||Cs();var n="ws"===t.scheme||"wss"===t.scheme;return{repoInfo:new yh(t.host,t.secure,r,n),path:new g(t.pathString)}},lt=function(e){var t="",r="",n="",i="",a=!0,o="https",s=443;if("string"==typeof e){var v=e.indexOf("//");v>=0&&(o=e.substring(0,v-1),e=e.substring(v+2));var l=e.indexOf("/");-1===l&&(l=e.length);var u=e.indexOf("?");-1===u&&(u=e.length),t=e.substring(0,Math.min(l,u)),l<u&&(i=gt(e.substring(l,u)));var $=ht(e.substring(Math.min(e.length,u)));(v=t.indexOf(":"))>=0?(a="https"===o||"wss"===o,s=parseInt(t.substring(v+1),10)):v=e.length;var h=t.split(".");3===h.length?(r=h[1],n=h[0].toLowerCase()):2===h.length?r=h[0]:"localhost"===h[0].slice(0,v).toLowerCase()&&(r="localhost"),""===n&&"ns"in $&&(n=$.ns)}return{host:t,port:s,domain:r,subdomain:n,secure:a,scheme:o,pathString:i}},mt=/[\[\].#$\/\u0000-\u001F\u007F]/,nt=/[\[\].#$\u0000-\u001F\u007F]/,we=10485760,Ad=function(e){return"string"==typeof e&&0!==e.length&&!mt.test(e)},sh=function(e){return"string"==typeof e&&0!==e.length&&!nt.test(e)},rt=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),sh(e)},pc=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!_d(e)||e&&"object"==typeof e&&b.contains(e,".sv")},Ia=function(e,t,r,n,i){i&&void 0===r||nc(b.errorPrefix(e,t,i),r,n)},nc=function(e,t,r){var n=r instanceof g?new Xs(r,e):r;if(void 0===t)throw new Error(e+"contains undefined "+n.toErrorString());if("function"==typeof t)throw new Error(e+"contains a function "+n.toErrorString()+" with contents = "+t.toString());if(_d(t))throw new Error(e+"contains "+t.toString()+" "+n.toErrorString());if("string"==typeof t&&t.length>we/3&&b.stringLength(t)>we)throw new Error(e+"contains a string greater than "+we+" utf8 bytes "+n.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,a=!1;if(b.forEach(t,function(t,r){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(a=!0,!Ad(t)))throw new Error(e+" contains an invalid key ("+t+") "+n.toErrorString()+".  Keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"");n.push(t),nc(e,r,n),n.pop()}),i&&a)throw new Error(e+" contains \".value\" child "+n.toErrorString()+" in addition to actual children.")}},vt=function(e,t){var r,n;for(r=0;r<t.length;r++)for(var i=(n=t[r]).slice(),a=0;a<i.length;a++)if(".priority"===i[a]&&a===i.length-1);else if(!Ad(i[a]))throw new Error(e+"contains an invalid key ("+i[a]+") in path "+n.toString()+". Keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"");t.sort(g.comparePaths);var o=null;for(r=0;r<t.length;r++){if(n=t[r],null!==o&&o.contains(n))throw new Error(e+"contains a path "+o.toString()+" that is ancestor of another path "+n.toString());o=n}},nh=function(e,t,r,n,i){if(!i||void 0!==r){var a=b.errorPrefix(e,t,i);if(!r||"object"!=typeof r||Array.isArray(r))throw new Error(a+" must be an object containing the children to replace.");var o=[];b.forEach(r,function(e,t){var r=new g(e);if(nc(a,t,n.child(r)),".priority"===r.getBack()&&!pc(t))throw new Error(a+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");o.push(r)}),vt(a,o)}},Ce=function(e,t,r,n){if(!n||void 0!==r){if(_d(r))throw new Error(b.errorPrefix(e,t,n)+"is "+r.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!pc(r))throw new Error(b.errorPrefix(e,t,n)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},De=function(e,t,r,n){if(!n||void 0!==r)switch(r){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(b.errorPrefix(e,t,n)+"must be a valid event type = \"value\", \"child_added\", \"child_removed\", \"child_changed\", or \"child_moved\".");}},Ee=function(e,t,r,n){if(!(n&&void 0===r||Ad(r)))throw new Error(b.errorPrefix(e,t,n)+"was an invalid key = \""+r+"\".  Firebase keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").")},hc=function(e,t,r,n){if(!(n&&void 0===r||sh(r)))throw new Error(b.errorPrefix(e,t,n)+"was an invalid path = \""+r+"\". Paths must be non-empty strings and can't contain \".\", \"#\", \"$\", \"[\", or \"]\"")},Bt=function(e,t,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),hc(e,t,r,n)},U=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")},Wm=function(e,t,r){var n=r.path.toString();if("string"!=typeof r.repoInfo.host||0===r.repoInfo.host.length||!Ad(r.repoInfo.namespace)&&"localhost"!==r.repoInfo.host.split(":")[0]||0!==n.length&&!rt(n))throw new Error(b.errorPrefix(e,t,!1)+"must be a valid firebase URL and the path can't contain \".\", \"#\", \"$\", \"[\", or \"]\".")},Et=function(e,t,r,n){if((!n||void 0!==r)&&"boolean"!=typeof r)throw new Error(b.errorPrefix(e,t,n)+"must be a boolean.")},Tm=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){b.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),b.validateCallback("OnDisconnect.cancel",1,e,!0);var t=new b.Deferred;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){b.validateArgCount("OnDisconnect.remove",0,1,arguments.length),U("OnDisconnect.remove",this.path_),b.validateCallback("OnDisconnect.remove",1,e,!0);var t=new b.Deferred;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){b.validateArgCount("OnDisconnect.set",1,2,arguments.length),U("OnDisconnect.set",this.path_),Ia("OnDisconnect.set",1,e,this.path_,!1),b.validateCallback("OnDisconnect.set",2,t,!0);var r=new b.Deferred;return this.repo_.onDisconnectSet(this.path_,e,r.wrapCallback(t)),r.promise},e.prototype.setWithPriority=function(e,t,r){b.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),U("OnDisconnect.setWithPriority",this.path_),Ia("OnDisconnect.setWithPriority",1,e,this.path_,!1),Ce("OnDisconnect.setWithPriority",2,t,!1),b.validateCallback("OnDisconnect.setWithPriority",3,r,!0);var n=new b.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,n.wrapCallback(r)),n.promise},e.prototype.update=function(e,t){if(b.validateArgCount("OnDisconnect.update",1,2,arguments.length),U("OnDisconnect.update",this.path_),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,K("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}nh("OnDisconnect.update",1,e,this.path_,!1),b.validateCallback("OnDisconnect.update",2,t,!0);var i=new b.Deferred;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},e}(),Gt=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return b.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),Ht=function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,r=[];return function(n){var i,a=n===t;t=n;var o=new Array(8);for(i=7;i>=0;i--)o[i]=e.charAt(n%64),n=Math.floor(n/64);b.assert(0===n,"Cannot push at time == 0");var s=o.join("");if(a){for(i=11;i>=0&&63===r[i];i--)r[i]=0;r[i]++}else for(i=0;i<12;i++)r[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)s+=e.charAt(r[i]);return b.assert(20===s.length,"nextPushId: Length should be 20."),s}}(),m=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,r){return new e(t,r)},e}(),gd=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var r=new m(Va,e),n=new m(Va,t);return 0!==this.compare(r,n)},e.prototype.minPost=function(){return m.MIN},e}(),Om=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return ve},set:function(e){ve=e},enumerable:!0,configurable:!0}),t.prototype.compare=function(e,t){return Oa(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw b.assertionError("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return m.MIN},t.prototype.maxPost=function(){return new m(Ga,ve)},t.prototype.makePost=function(e,t){return b.assert("string"==typeof e,"KeyIndex indexValue must always be a string."),new m(e,ve)},t.prototype.toString=function(){return".key"},t}(gd),Ea=new Om;function Mt(e){wh=e}var Nt,Ot,Pt,Jm=function(e){return"number"==typeof e?"number:"+hi(e):"string:"+e},Hm=function(e){if(e.isLeafNode()){var t=e.val();b.assert("string"==typeof t||"number"==typeof t||"object"==typeof t&&b.contains(t,".sv"),"Priority must be a string or number.")}else b.assert(e===wh||e.isEmpty(),"priority of unexpected type.");b.assert(e===wh||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Eb=function(){function e(t,r){void 0===r&&(r=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=r,this.lazyHash_=null,b.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Hm(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return Nt},set:function(e){Nt=e},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,r){var n=t.getFront();return null===n?r:r.isEmpty()&&".priority"!==n?this:(b.assert(".priority"!==n||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(n,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),r)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Jm(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?hi(this.value_):this.value_,this.lazyHash_=Ji(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(b.assert(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var r=typeof t.value_,n=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(r),a=e.VALUE_TYPE_ORDER.indexOf(n);return b.assert(i>=0,"Unknown leaf type: "+r),b.assert(a>=0,"Unknown leaf type: "+n),i===a?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();function Tt(e){Ot=e}function Ut(e){Pt=e}var Vt,bd,Xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X(t,e),t.prototype.compare=function(e,t){var r=e.node.getPriority(),n=t.node.getPriority(),i=r.compareTo(n);return 0===i?Oa(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return m.MIN},t.prototype.maxPost=function(){return new m(Ga,new Eb("[PRIORITY-POST]",Pt))},t.prototype.makePost=function(e,t){var r=Ot(e);return new m(t,new Eb("[PRIORITY-POST]",r))},t.prototype.toString=function(){return".priority"},t}(gd),x=new Xt,Uc=function(){function e(e,t,r,n,i){void 0===i&&(i=null),this.isReverse_=n,this.resultGenerator_=i,this.nodeStack_=[];for(var a=1;!e.isEmpty();)if(e=e,a=t?r(e.key,t):1,n&&(a*=-1),a<0)e=this.isReverse_?e.left:e.right;else{if(0===a){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),Z=function(){function e(t,r,n,i,a){this.key=t,this.value=r,this.color=null!=n?n:e.RED,this.left=null!=i?i:Aa.EMPTY_NODE,this.right=null!=a?a:Aa.EMPTY_NODE}return e.prototype.copy=function(t,r,n,i,a){return new e(null!=t?t:this.key,null!=r?r:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=a?a:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,r){var n,i;return(i=(n=r(e,(i=this).key))<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===n?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return Aa.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var r,n;if(t(e,(r=this).key)<0)r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()||(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),r.right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()||(r=r.moveRedRight_()),0===t(e,r.key)){if(r.right.isEmpty())return Aa.EMPTY_NODE;n=r.right.min_(),r=r.copy(n.key,n.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){var e;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((e=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),_t=function(){function e(){}return e.prototype.copy=function(e,t,r,n,i){return this},e.prototype.insert=function(e,t,r){return new Z(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),Aa=function(){function e(t,r){void 0===r&&(r=e.EMPTY_NODE),this.comparator_=t,this.root_=r}return e.prototype.insert=function(t,r){return new e(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,Z.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Z.BLACK,null,null))},e.prototype.get=function(e){for(var t,r=this.root_;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key)))return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,r=this.root_,n=null;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key))){if(r.left.isEmpty())return n?n.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(n=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new Uc(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new Uc(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new Uc(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new Uc(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new _t,e}(),bu=Math.log(2),cu=function(){function e(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/bu,10)),this.current_=this.count-1;var r,n=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=e+1&n}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),Xc=function(e,t,r,n){e.sort(t);var i=function(t,n){var a,o,s=n-t;if(0==s)return null;if(1==s)return a=e[t],o=r?r(a):a,new Z(o,a.node,Z.BLACK,null,null);var v=parseInt(s/2,10)+t,l=i(t,v),u=i(v+1,n);return a=e[v],o=r?r(a):a,new Z(o,a.node,Z.BLACK,l,u)},a=function(t){for(var n=null,a=null,o=e.length,s=function(t,n){var a=o-t,s=o;o-=t;var l=i(a+1,s),u=e[a],$=r?r(u):u;v(new Z($,u.node,n,null,l))},v=function(e){n?(n.left=e,n=e):(a=e,n=e)},l=0;l<t.count;++l){var u=t.nextBitIsOne(),$=Math.pow(2,t.count-(l+1));u?s($,Z.BLACK):(s($,Z.BLACK),s($,Z.RED))}return a}(new cu(e.length));return new Aa(n||t,a)},Ma={},he=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return b.assert(Ma&&x,"ChildrenNode.ts has not been loaded"),Vt=Vt||new e({".priority":Ma},{".priority":x})},enumerable:!0,configurable:!0}),e.prototype.get=function(e){var t=b.safeGet(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t===Ma?null:t},e.prototype.hasIndex=function(e){return b.contains(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,r){b.assert(t!==Ea,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,i=[],a=!1,o=r.getIterator(m.Wrap),s=o.getNext();s;)a=a||t.isDefinedOn(s.node),i.push(s),s=o.getNext();n=a?Xc(i,t.getCompare()):Ma;var v=t.toString(),l=b.clone(this.indexSet_);l[v]=t;var u=b.clone(this.indexes_);return u[v]=n,new e(u,l)},e.prototype.addToIndexes=function(t,r){var n=this;return new e(b.map(this.indexes_,function(e,i){var a=b.safeGet(n.indexSet_,i);if(b.assert(a,"Missing index implementation for "+i),e===Ma){if(a.isDefinedOn(t.node)){for(var o=[],s=r.getIterator(m.Wrap),v=s.getNext();v;)v.name!=t.name&&o.push(v),v=s.getNext();return o.push(t),Xc(o,a.getCompare())}return Ma}var l=r.get(t.name),u=e;return l&&(u=u.remove(new m(t.name,l))),u.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,r){return new e(b.map(this.indexes_,function(e){if(e===Ma)return e;var n=r.get(t.name);return n?e.remove(new m(t.name,n)):e}),this.indexSet_)},e}();function gu(e,t){return Oa(e.name,t.name)}function Oe(e,t){return Oa(e,t)}var f=function(){function e(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Hm(this.priorityNode_),this.children_.isEmpty()&&b.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return bd||(bd=new e(new Aa(Oe),null,he.Default))},enumerable:!0,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||bd},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?bd:t},e.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,r){if(b.assert(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);var n,i=new m(t,r),a=void 0,o=void 0;return r.isEmpty()?(a=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_)),n=a.isEmpty()?bd:this.priorityNode_,new e(a,n,o)},e.prototype.updateChild=function(e,t){var r=e.getFront();if(null===r)return t;b.assert(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var n=this.getImmediateChild(r).updateChild(e.popFront(),t);return this.updateImmediateChild(r,n)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var r={},n=0,i=0,a=!0;if(this.forEachChild(x,function(o,s){r[o]=s.val(t),n++,a&&e.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):a=!1}),!t&&a&&i<2*n){var o=[];for(var s in r)o[s]=r[s];return o}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Jm(this.getPriority().val())+":"),this.forEachChild(x,function(t,r){var n=r.hash();""!==n&&(e+=":"+t+":"+n)}),this.lazyHash_=""===e?"":Ji(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,r){var n=this.resolveIndex_(r);if(n){var i=n.getPredecessorKey(new m(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.minKey();return r&&r.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new m(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.maxKey();return r&&r.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new m(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var r=this.resolveIndex_(e);return r?r.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,function(e){return e});for(var n=this.children_.getIteratorFrom(e.name,m.Wrap),i=n.peek();null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,function(e){return e});for(var n=this.children_.getReverseIteratorFrom(e.name,m.Wrap),i=n.peek();null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===rc?-1:0},e.prototype.withIndex=function(t){if(t===Ea||this.indexMap_.hasIndex(t))return this;var r=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,r)},e.prototype.isIndexed=function(e){return e===Ea||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var r=this.getIterator(x),n=t.getIterator(x),i=r.getNext(),a=n.getNext();i&&a;){if(i.name!==a.name||!i.node.equals(a.node))return!1;i=r.getNext(),a=n.getNext()}return null===i&&null===a}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===Ea?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),ju=function(e){function t(){return e.call(this,new Aa(Oe),f.EMPTY_NODE,he.Default)||this}return X(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return f.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(f),rc=new ju;Object.defineProperties(m,{MIN:{value:new m(Va,f.EMPTY_NODE)},MAX:{value:new m(Ga,rc)}}),Om.__EMPTY_NODE=f.EMPTY_NODE,Eb.__childrenNodeConstructor=f,Mt(rc),Ut(rc);var lu=!0;function C(e,t){if(void 0===t&&(t=null),null===e)return f.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),b.assert(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new Eb(e,C(t));if(e instanceof Array||!lu){var r=f.EMPTY_NODE,n=e;return b.forEach(n,function(e,t){if(b.contains(n,e)&&"."!==e.substring(0,1)){var i=C(t);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(e,i))}}),r.updatePriority(C(t))}var i=[],a=!1,o=e;if(b.forEach(o,function(e,t){if("string"!=typeof e||"."!==e.substring(0,1)){var r=C(o[e]);r.isEmpty()||(a=a||!r.getPriority().isEmpty(),i.push(new m(e,r)))}}),0==i.length)return f.EMPTY_NODE;var s=Xc(i,gu,function(e){return e.name},Oe);if(a){var v=Xc(i,x.getCompare());return new f(s,C(t),new he({".priority":v},{".priority":x}))}return new f(s,C(t),he.Default)}Tt(C);var Rl,da,pu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return X(t,e),t.prototype.compare=function(e,t){var r=e.node.compareTo(t.node);return 0===r?Oa(e.name,t.name):r},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return m.MIN},t.prototype.maxPost=function(){return m.MAX},t.prototype.makePost=function(e,t){var r=C(e);return new m(t,r)},t.prototype.toString=function(){return".value"},t}(gd),Se=new pu,Te=function(e){function t(t){var r=e.call(this)||this;return r.indexPath_=t,b.assert(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),r}return X(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var r=this.extractChild(e.node),n=this.extractChild(t.node),i=r.compareTo(n);return 0===i?Oa(e.name,t.name):i},t.prototype.makePost=function(e,t){var r=C(e),n=f.EMPTY_NODE.updateChild(this.indexPath_,r);return new m(t,n)},t.prototype.maxPost=function(){var e=f.EMPTY_NODE.updateChild(this.indexPath_,rc);return new m(Ga,e)},t.prototype.toString=function(){return this.indexPath_.slice().join("/")},t}(gd),tb=function(){function e(e,t,r){this.node_=e,this.ref_=t,this.index_=r}return e.prototype.val=function(){return b.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},e.prototype.exportVal=function(){return b.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},e.prototype.toJSON=function(){return b.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return b.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},e.prototype.child=function(t){b.validateArgCount("DataSnapshot.child",0,1,arguments.length),t=String(t),hc("DataSnapshot.child",1,t,!1);var r=new g(t),n=this.ref_.child(r);return new e(this.node_.getChild(r),n,x)},e.prototype.hasChild=function(e){b.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),hc("DataSnapshot.hasChild",1,e,!1);var t=new g(e);return!this.node_.getChild(t).isEmpty()},e.prototype.getPriority=function(){return b.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},e.prototype.forEach=function(t){var r=this;return b.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),b.validateCallback("DataSnapshot.forEach",1,t,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(n,i){return t(new e(i,r.ref_.child(n),x))})},e.prototype.hasChildren=function(){return b.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return b.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},e.prototype.getRef=function(){return b.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),Hl=function(){function e(e,t,r,n){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=n}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+b.stringify(this.snapshot.exportVal())},e}(),Bl=function(){function e(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),ql=function(){function e(e,t,r){this.callback_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var r=t.getQueryParams().getIndex();return new Hl("value",this,new tb(e.snapshotNode,t.getRef(),r))},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){b.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callback_;return function(){n.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Bl(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}(),ol=function(){function e(e,t,r){this.callbacks_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,b.contains(this.callbacks_,t)},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new Bl(this,e,t):null},e.prototype.createEvent=function(e,t){b.assert(null!=e.childName,"Child events should have a childName.");var r=t.getRef().child(e.childName),n=t.getQueryParams().getIndex();return new Hl(e.type,this,new tb(e.snapshotNode,r,n),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){b.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callbacks_[e.eventType];return function(){n.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var r=b.getCount(t.callbacks_);if(r===b.getCount(this.callbacks_)){if(1===r){var n=b.getAnyKey(t.callbacks_),i=b.getAnyKey(this.callbacks_);return!(i!==n||t.callbacks_[n]&&this.callbacks_[i]&&t.callbacks_[n]!==this.callbacks_[i])}return b.every(this.callbacks_,function(e,r){return t.callbacks_[e]===r})}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks_},e}(),Jd=function(){function e(e,t,r,n){this.repo=e,this.path=t,this.queryParams_=r,this.orderByCalled_=n}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return b.assert(Rl,"Reference.ts has not been loaded"),Rl},set:function(e){Rl=e},enumerable:!0,configurable:!0}),e.validateQueryEndpoints_=function(e){var t=null,r=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(r=e.getIndexEndValue()),e.getIndex()===Ea){var n="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!=Va)throw new Error(n);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!=Ga)throw new Error(n);if("string"!=typeof r)throw new Error(i)}}else if(e.getIndex()===x){if(null!=t&&!pc(t)||null!=r&&!pc(r))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(b.assert(e.getIndex()instanceof Te||e.getIndex()===Se,"unknown index type."),null!=t&&"object"==typeof t||null!=r&&"object"==typeof r)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.queryParams_},e.prototype.getRef=function(){return b.validateArgCount("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,r,n,i){b.validateArgCount("Query.on",2,4,arguments.length),De("Query.on",1,t,!1),b.validateCallback("Query.on",2,r,!1);var a=e.getCancelAndContextArgs_("Query.on",n,i);if("value"===t)this.onValueEvent(r,a.cancel,a.context);else{var o={};o[t]=r,this.onChildEvent(o,a.cancel,a.context)}return r},e.prototype.onValueEvent=function(e,t,r){var n=new ql(e,t||null,r||null);this.repo.addEventCallbackForQuery(this,n)},e.prototype.onChildEvent=function(e,t,r){var n=new ol(e,t,r);this.repo.addEventCallbackForQuery(this,n)},e.prototype.off=function(e,t,r){b.validateArgCount("Query.off",0,3,arguments.length),De("Query.off",1,e,!0),b.validateCallback("Query.off",2,t,!0),b.validateContextObject("Query.off",3,r,!0);var n=null,i=null;"value"===e?n=new ql(t||null,null,r||null):e&&(t&&((i={})[e]=t),n=new ol(i,null,r||null));this.repo.removeEventCallbackForQuery(this,n)},e.prototype.once=function(t,r,n,i){var a=this;b.validateArgCount("Query.once",1,4,arguments.length),De("Query.once",1,t,!1),b.validateCallback("Query.once",2,r,!0);var o=e.getCancelAndContextArgs_("Query.once",n,i),s=!0,v=new b.Deferred;v.promise.catch(function(){});var l=function(e){s&&(s=!1,a.off(t,l),r&&r.bind(o.context)(e),v.resolve(e))};return this.on(t,l,function(e){a.off(t,l),o.cancel&&o.cancel.bind(o.context)(e),v.reject(e)}),v.promise},e.prototype.limitToFirst=function(t){if(b.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},e.prototype.limitToLast=function(t){if(b.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)},e.prototype.orderByChild=function(t){if(b.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error("Query.orderByChild: \"$key\" is invalid.  Use Query.orderByKey() instead.");if("$priority"===t)throw new Error("Query.orderByChild: \"$priority\" is invalid.  Use Query.orderByPriority() instead.");if("$value"===t)throw new Error("Query.orderByChild: \"$value\" is invalid.  Use Query.orderByValue() instead.");hc("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var r=new g(t);if(r.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var n=new Te(r),i=this.queryParams_.orderBy(n);return e.validateQueryEndpoints_(i),new e(this.repo,this.path,i,!0)},e.prototype.orderByKey=function(){b.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(Ea);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){b.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(x);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){b.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(Se);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,r){void 0===t&&(t=null),b.validateArgCount("Query.startAt",0,2,arguments.length),Ia("Query.startAt",1,t,this.path,!0),Ee("Query.startAt",2,r,!0);var n=this.queryParams_.startAt(t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,r=null),new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.endAt=function(t,r){void 0===t&&(t=null),b.validateArgCount("Query.endAt",0,2,arguments.length),Ia("Query.endAt",1,t,this.path,!0),Ee("Query.endAt",2,r,!0);var n=this.queryParams_.endAt(t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.equalTo=function(e,t){if(b.validateArgCount("Query.equalTo",1,2,arguments.length),Ia("Query.equalTo",1,e,this.path,!1),Ee("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return b.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},e.prototype.toJSON=function(){return b.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},e.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=re(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if(b.validateArgCount("Query.isEqual",1,1,arguments.length),!(t instanceof e)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var r=this.repo===t.repo,n=this.path.equals(t.path),i=this.queryIdentifier()===t.queryIdentifier();return r&&n&&i},e.getCancelAndContextArgs_=function(e,t,r){var n={cancel:null,context:null};if(t&&r)n.cancel=t,b.validateCallback(e,3,n.cancel,!0),n.context=r,b.validateContextObject(e,4,n.context,!0);else if(t)if("object"==typeof t&&null!==t)n.context=t;else{if("function"!=typeof t)throw new Error(b.errorPrefix(e,3,!0)+" must either be a cancel callback or a context object.");n.cancel=t}return n},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),e}(),fl=function(){function e(){this.set={}}return e.prototype.add=function(e,t){this.set[e]=null===t||t},e.prototype.contains=function(e){return b.contains(this.set,e)},e.prototype.get=function(e){return this.contains(e)?this.set[e]:void 0},e.prototype.remove=function(e){delete this.set[e]},e.prototype.clear=function(){this.set={}},e.prototype.isEmpty=function(){return b.isEmpty(this.set)},e.prototype.count=function(){return b.getCount(this.set)},e.prototype.each=function(e){b.forEach(this.set,function(t,r){return e(t,r)})},e.prototype.keys=function(){var e=[];return b.forEach(this.set,function(t){e.push(t)}),e},e}(),df=function(){function e(){this.value_=null,this.children_=null}return e.prototype.find=function(e){if(null!=this.value_)return this.value_.getChild(e);if(e.isEmpty()||null==this.children_)return null;var t=e.getFront();return e=e.popFront(),this.children_.contains(t)?this.children_.get(t).find(e):null},e.prototype.remember=function(t,r){if(t.isEmpty())this.value_=r,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(t,r);else{null==this.children_&&(this.children_=new fl);var n=t.getFront();this.children_.contains(n)||this.children_.add(n,new e);var i=this.children_.get(n);t=t.popFront(),i.remember(t,r)}},e.prototype.forget=function(e){if(e.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var t=this.value_;this.value_=null;var r=this;return t.forEachChild(x,function(e,t){r.remember(new g(e),t)}),this.forget(e)}if(null!==this.children_){var n=e.getFront();if(e=e.popFront(),this.children_.contains(n))this.children_.get(n).forget(e)&&this.children_.remove(n);return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},e.prototype.forEachTree=function(e,t){null!==this.value_?t(e,this.value_):this.forEachChild(function(r,n){var i=new g(e.toString()+"/"+r);n.forEachTree(i,t)})},e.prototype.forEachChild=function(e){null!==this.children_&&this.children_.each(function(t,r){e(t,r)})},e}(),Au=function(e){return(e=e||{}).timestamp=e.timestamp||new Date().getTime(),e},_k=function(e,t){return e&&"object"==typeof e?(b.assert(".sv"in e,"Unexpected leaf node or priority contents"),t[e[".sv"]]):e},Cu=function(e,t){var r=new df;return e.forEachTree(new g(""),function(e,n){r.remember(e,pb(n,t))}),r},pb=function(e,t){var r,n=e.getPriority().val(),i=_k(n,t);if(e.isLeafNode()){var a=e,o=_k(a.getValue(),t);return o!==a.getValue()||i!==a.getPriority().val()?new Eb(o,C(i)):e}var s=e;return r=s,i!==s.getPriority().val()&&(r=r.updatePriority(new Eb(i))),s.forEachChild(x,function(e,n){var i=pb(n,t);i!==n&&(r=r.updateImmediateChild(e,i))}),r};!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(da||(da={}));var Wk,gf,ua=function(){function e(e,t,r,n){this.fromUser=e,this.fromServer=t,this.queryId=r,this.tagged=n,b.assert(!n||t,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}(),Hu=function(){function e(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=da.ACK_USER_WRITE,this.source=ua.User}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return b.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var r=this.affectedTree.subtree(new g(t));return new e(g.Empty,r,this.revert)}return b.assert(this.path.getFront()===t,"operationForChild called for unrelated child."),new e(this.path.popFront(),this.affectedTree,this.revert)},e}(),Iu=function(){return Wk||(Wk=new Aa(Is)),Wk},R=function(){function e(e,t){void 0===t&&(t=Iu()),this.value=e,this.children=t}return e.fromObject=function(t){var r=e.Empty;return b.forEach(t,function(e,t){r=r.set(new g(e),t)}),r},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:g.Empty,value:this.value};if(e.isEmpty())return null;var r=e.getFront(),n=this.children.get(r);if(null!==n){var i=n.findRootMostMatchingPathAndValue(e.popFront(),t);return null!=i?{path:new g(r).child(i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(t.isEmpty())return this;var r=t.getFront(),n=this.children.get(r);return null!==n?n.subtree(t.popFront()):e.Empty},e.prototype.set=function(t,r){if(t.isEmpty())return new e(r,this.children);var n=t.getFront(),i=(this.children.get(n)||e.Empty).set(t.popFront(),r),a=this.children.insert(n,i);return new e(this.value,a)},e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var r=t.getFront(),n=this.children.get(r);if(n){var i=n.remove(t.popFront()),a=void 0;return a=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),null===this.value&&a.isEmpty()?e.Empty:new e(this.value,a)}return this},e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),r=this.children.get(t);return r?r.get(e.popFront()):null},e.prototype.setTree=function(t,r){if(t.isEmpty())return r;var n=t.getFront(),i=(this.children.get(n)||e.Empty).setTree(t.popFront(),r),a=void 0;return a=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new e(this.value,a)},e.prototype.fold=function(e){return this.fold_(g.Empty,e)},e.prototype.fold_=function(e,t){var r={};return this.children.inorderTraversal(function(n,i){r[n]=i.fold_(e.child(n),t)}),t(e,this.value,r)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,g.Empty,t)},e.prototype.findOnPath_=function(e,t,r){var n=!!this.value&&r(t,this.value);if(n)return n;if(e.isEmpty())return null;var i=e.getFront(),a=this.children.get(i);return a?a.findOnPath_(e.popFront(),t.child(i),r):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,g.Empty,t)},e.prototype.foreachOnPath_=function(t,r,n){if(t.isEmpty())return this;this.value&&n(r,this.value);var i=t.getFront(),a=this.children.get(i);return a?a.foreachOnPath_(t.popFront(),r.child(i),n):e.Empty},e.prototype.foreach=function(e){this.foreach_(g.Empty,e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(r,n){n.foreach_(e.child(r),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,r){r.value&&e(t,r.value)})},e.Empty=new e(null),e}(),Fk=function(){function e(e,t){this.source=e,this.path=t,this.type=da.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,g.Empty):new e(this.source,this.path.popFront())},e}(),td=function(){function e(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=da.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,g.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}(),jf=function(){function e(e,t,r){this.source=e,this.path=t,this.children=r,this.type=da.MERGE}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var r=this.children.subtree(new g(t));return r.isEmpty()?null:r.value?new td(this.source,g.Empty,r.value):new e(this.source,g.Empty,r)}return b.assert(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,this.path.popFront(),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),la=function(){function e(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),rk=function(){function e(e,t){this.eventCache_=e,this.serverCache_=t}return e.prototype.updateEventSnap=function(t,r,n){return new e(new la(t,r,n),this.serverCache_)},e.prototype.updateServerSnap=function(t,r,n){return new e(this.eventCache_,new la(t,r,n))},e.prototype.getEventCache=function(){return this.eventCache_},e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},e.prototype.getServerCache=function(){return this.serverCache_},e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},e.Empty=new e(new la(f.EMPTY_NODE,!1,!1),new la(f.EMPTY_NODE,!1,!1)),e}(),d=function(){function e(e,t,r,n,i){this.type=e,this.snapshotNode=t,this.childName=r,this.oldSnap=n,this.prevName=i}return e.valueChange=function(t){return new e(e.VALUE,t)},e.childAddedChange=function(t,r){return new e(e.CHILD_ADDED,r,t)},e.childRemovedChange=function(t,r){return new e(e.CHILD_REMOVED,r,t)},e.childChangedChange=function(t,r,n){return new e(e.CHILD_CHANGED,r,t,n)},e.childMovedChange=function(t,r){return new e(e.CHILD_MOVED,r,t)},e.CHILD_ADDED="child_added",e.CHILD_REMOVED="child_removed",e.CHILD_CHANGED="child_changed",e.CHILD_MOVED="child_moved",e.VALUE="value",e}(),mf=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,r,n,i,a){b.assert(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var o=e.getImmediateChild(t);return o.getChild(n).equals(r.getChild(n))&&o.isEmpty()==r.isEmpty()?e:(null!=a&&(r.isEmpty()?e.hasChild(t)?a.trackChildChange(d.childRemovedChange(t,o)):b.assert(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?a.trackChildChange(d.childAddedChange(t,r)):a.trackChildChange(d.childChangedChange(t,r,o))),e.isLeafNode()&&r.isEmpty()?e:e.updateImmediateChild(t,r).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(x,function(e,n){t.hasChild(e)||r.trackChildChange(d.childRemovedChange(e,n))}),t.isLeafNode()||t.forEachChild(x,function(t,n){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(n)||r.trackChildChange(d.childChangedChange(t,n,i))}else r.trackChildChange(d.childAddedChange(t,n))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?f.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),Ru=function(){function e(){this.changeMap_={}}return e.prototype.trackChildChange=function(e){var t=e.type,r=e.childName;b.assert(t==d.CHILD_ADDED||t==d.CHILD_CHANGED||t==d.CHILD_REMOVED,"Only child changes supported for tracking"),b.assert(".priority"!==r,"Only non-priority child changes can be tracked.");var n=b.safeGet(this.changeMap_,r);if(n){var i=n.type;if(t==d.CHILD_ADDED&&i==d.CHILD_REMOVED)this.changeMap_[r]=d.childChangedChange(r,e.snapshotNode,n.snapshotNode);else if(t==d.CHILD_REMOVED&&i==d.CHILD_ADDED)delete this.changeMap_[r];else if(t==d.CHILD_REMOVED&&i==d.CHILD_CHANGED)this.changeMap_[r]=d.childRemovedChange(r,n.oldSnap);else if(t==d.CHILD_CHANGED&&i==d.CHILD_ADDED)this.changeMap_[r]=d.childAddedChange(r,e.snapshotNode);else{if(t!=d.CHILD_CHANGED||i!=d.CHILD_CHANGED)throw b.assertionError("Illegal combination of changes: "+e+" occurred after "+n);this.changeMap_[r]=d.childChangedChange(r,e.snapshotNode,n.oldSnap)}}else this.changeMap_[r]=e},e.prototype.getChanges=function(){return b.getValues(this.changeMap_)},e}(),Su=function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,r){return null},e}(),lk=new Su,nf=function(){function e(e,t,r){void 0===r&&(r=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var r=null!=this.optCompleteServerCache_?new la(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,r)},e.prototype.getChildAfterChild=function(e,t,r){var n=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(n,t,1,r,e);return 0===i.length?null:i[0]},e}(),Vu=function(){return function(e,t){this.viewCache=e,this.changes=t}}(),Wu=function(){function e(e){this.filter_=e}return e.prototype.assertIndexed=function(e){b.assert(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),b.assert(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,r,n,i){var a,o,s=new Ru;if(r.type===da.OVERWRITE){var v=r;v.source.fromUser?a=this.applyUserOverwrite_(t,v.path,v.snap,n,i,s):(b.assert(v.source.fromServer,"Unknown source."),o=v.source.tagged||t.getServerCache().isFiltered()&&!v.path.isEmpty(),a=this.applyServerOverwrite_(t,v.path,v.snap,n,i,o,s))}else if(r.type===da.MERGE){var l=r;l.source.fromUser?a=this.applyUserMerge_(t,l.path,l.children,n,i,s):(b.assert(l.source.fromServer,"Unknown source."),o=l.source.tagged||t.getServerCache().isFiltered(),a=this.applyServerMerge_(t,l.path,l.children,n,i,o,s))}else if(r.type===da.ACK_USER_WRITE){var u=r;a=u.revert?this.revertUserWrite_(t,u.path,n,i,s):this.ackUserWrite_(t,u.path,u.affectedTree,n,i,s)}else{if(r.type!==da.LISTEN_COMPLETE)throw b.assertionError("Unknown operation type: "+r.type);a=this.listenComplete_(t,r.path,n,s)}var $=s.getChanges();return e.maybeAddValueEvent_(t,a,$),new Vu(a,$)},e.maybeAddValueEvent_=function(e,t,r){var n=t.getEventCache();if(n.isFullyInitialized()){var i=n.getNode().isLeafNode()||n.getNode().isEmpty(),a=e.getCompleteEventSnap();(r.length>0||!e.getEventCache().isFullyInitialized()||i&&!n.getNode().equals(a)||!n.getNode().getPriority().equals(a.getPriority()))&&r.push(d.valueChange(t.getCompleteEventSnap()))}},e.prototype.generateEventCacheAfterServerEvent_=function(e,t,r,n,i){var a=e.getEventCache();if(null!=r.shadowingWrite(t))return e;var o=void 0,s=void 0;if(t.isEmpty()){if(b.assert(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var v=e.getCompleteServerSnap(),l=v instanceof f?v:f.EMPTY_NODE,u=r.calcCompleteEventChildren(l);o=this.filter_.updateFullNode(e.getEventCache().getNode(),u,i)}else{var $=r.calcCompleteEventCache(e.getCompleteServerSnap());o=this.filter_.updateFullNode(e.getEventCache().getNode(),$,i)}}else{var h=t.getFront();if(".priority"==h){b.assert(1==t.getLength(),"Can't have a priority with additional path components");var c=a.getNode();s=e.getServerCache().getNode();var p=r.calcEventCacheAfterServerOverwrite(t,c,s);o=null!=p?this.filter_.updatePriority(c,p):a.getNode()}else{var d=t.popFront(),m=void 0;if(a.isCompleteForChild(h)){s=e.getServerCache().getNode();var _=r.calcEventCacheAfterServerOverwrite(t,a.getNode(),s);m=null!=_?a.getNode().getImmediateChild(h).updateChild(d,_):a.getNode().getImmediateChild(h)}else m=r.calcCompleteChild(h,e.getServerCache());o=null!=m?this.filter_.updateChild(a.getNode(),h,m,d,n,i):a.getNode()}}return e.updateEventSnap(o,a.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},e.prototype.applyServerOverwrite_=function(e,t,r,n,i,a,o){var s,v=e.getServerCache(),l=a?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())s=l.updateFullNode(v.getNode(),r,null);else if(l.filtersNodes()&&!v.isFiltered()){var u=v.getNode().updateChild(t,r);s=l.updateFullNode(v.getNode(),u,null)}else{var $=t.getFront();if(!v.isCompleteForPath(t)&&t.getLength()>1)return e;var h=t.popFront(),c=v.getNode().getImmediateChild($).updateChild(h,r);s=".priority"==$?l.updatePriority(v.getNode(),c):l.updateChild(v.getNode(),$,c,h,lk,null)}var p=e.updateServerSnap(s,v.isFullyInitialized()||t.isEmpty(),l.filtersNodes()),d=new nf(n,p,i);return this.generateEventCacheAfterServerEvent_(p,t,n,d,o)},e.prototype.applyUserOverwrite_=function(e,t,r,n,i,a){var o,s,v=e.getEventCache(),l=new nf(n,e,i);if(t.isEmpty())s=this.filter_.updateFullNode(e.getEventCache().getNode(),r,a),o=e.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var u=t.getFront();if(".priority"===u)s=this.filter_.updatePriority(e.getEventCache().getNode(),r),o=e.updateEventSnap(s,v.isFullyInitialized(),v.isFiltered());else{var $=t.popFront(),h=v.getNode().getImmediateChild(u),c=void 0;if($.isEmpty())c=r;else{var p=l.getCompleteChild(u);c=null!=p?".priority"===$.getBack()&&p.getChild($.parent()).isEmpty()?p:p.updateChild($,r):f.EMPTY_NODE}if(h.equals(c))o=e;else{var d=this.filter_.updateChild(v.getNode(),u,c,$,l,a);o=e.updateEventSnap(d,v.isFullyInitialized(),this.filter_.filtersNodes())}}}return o},e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.applyUserMerge_=function(t,r,n,i,a,o){var s=this,v=t;return n.foreach(function(n,l){var u=r.child(n);e.cacheHasChild_(t,u.getFront())&&(v=s.applyUserOverwrite_(v,u,l,i,a,o))}),n.foreach(function(n,l){var u=r.child(n);e.cacheHasChild_(t,u.getFront())||(v=s.applyUserOverwrite_(v,u,l,i,a,o))}),v},e.prototype.applyMerge_=function(e,t){return t.foreach(function(t,r){e=e.updateChild(t,r)}),e},e.prototype.applyServerMerge_=function(e,t,r,n,i,a,o){var s=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var v,l=e;v=t.isEmpty()?r:R.Empty.setTree(t,r);var u=e.getServerCache().getNode();return v.children.inorderTraversal(function(t,r){if(u.hasChild(t)){var v=e.getServerCache().getNode().getImmediateChild(t),$=s.applyMerge_(v,r);l=s.applyServerOverwrite_(l,new g(t),$,n,i,a,o)}}),v.children.inorderTraversal(function(t,r){var v=!e.getServerCache().isCompleteForChild(t)&&null==r.value;if(!u.hasChild(t)&&!v){var $=e.getServerCache().getNode().getImmediateChild(t),h=s.applyMerge_($,r);l=s.applyServerOverwrite_(l,new g(t),h,n,i,a,o)}}),l},e.prototype.ackUserWrite_=function(e,t,r,n,i,a){if(null!=n.shadowingWrite(t))return e;var o=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=r.value){if(t.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,s.getNode().getChild(t),n,i,o,a);if(t.isEmpty()){var v=R.Empty;return s.getNode().forEachChild(Ea,function(e,t){v=v.set(new g(e),t)}),this.applyServerMerge_(e,t,v,n,i,o,a)}return e}var l=R.Empty;return r.foreach(function(e,r){var n=t.child(e);s.isCompleteForPath(n)&&(l=l.set(e,s.getNode().getChild(n)))}),this.applyServerMerge_(e,t,l,n,i,o,a)},e.prototype.listenComplete_=function(e,t,r,n){var i=e.getServerCache(),a=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(a,t,r,lk,n)},e.prototype.revertUserWrite_=function(e,t,r,n,i){var a;if(null!=r.shadowingWrite(t))return e;var o=new nf(r,e,n),s=e.getEventCache().getNode(),v=void 0;if(t.isEmpty()||".priority"===t.getFront()){var l=void 0;if(e.getServerCache().isFullyInitialized())l=r.calcCompleteEventCache(e.getCompleteServerSnap());else{var u=e.getServerCache().getNode();b.assert(u instanceof f,"serverChildren would be complete if leaf node"),l=r.calcCompleteEventChildren(u)}l=l,v=this.filter_.updateFullNode(s,l,i)}else{var $=t.getFront(),h=r.calcCompleteChild($,e.getServerCache());null==h&&e.getServerCache().isCompleteForChild($)&&(h=s.getImmediateChild($)),(v=null!=h?this.filter_.updateChild(s,$,h,t.popFront(),o,i):e.getEventCache().getNode().hasChild($)?this.filter_.updateChild(s,$,f.EMPTY_NODE,t.popFront(),o,i):s).isEmpty()&&e.getServerCache().isFullyInitialized()&&(a=r.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(v=this.filter_.updateFullNode(v,a,i))}return a=e.getServerCache().isFullyInitialized()||null!=r.shadowingWrite(g.Empty),e.updateEventSnap(v,a,this.filter_.filtersNodes())},e}(),Xu=function(){function e(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,r){var n=this,i=[],a=[];return e.forEach(function(e){e.type===d.CHILD_CHANGED&&n.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&a.push(d.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(i,d.CHILD_REMOVED,e,r,t),this.generateEventsForType_(i,d.CHILD_ADDED,e,r,t),this.generateEventsForType_(i,d.CHILD_MOVED,a,r,t),this.generateEventsForType_(i,d.CHILD_CHANGED,e,r,t),this.generateEventsForType_(i,d.VALUE,e,r,t),i},e.prototype.generateEventsForType_=function(e,t,r,n,i){var a=this,o=r.filter(function(e){return e.type===t});o.sort(this.compareChanges_.bind(this)),o.forEach(function(t){var r=a.materializeSingleChange_(t,i);n.forEach(function(n){n.respondsTo(t.type)&&e.push(n.createEvent(r,a.query_))})})},e.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type?e:(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_),e)},e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw b.assertionError("Should only compare child_ events.");var r=new m(e.childName,e.snapshotNode),n=new m(t.childName,t.snapshotNode);return this.index_.compare(r,n)},e}(),Yu=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var r=this.query_.getQueryParams(),n=new mf(r.getIndex()),i=r.getNodeFilter();this.processor_=new Wu(i);var a=t.getServerCache(),o=t.getEventCache(),s=n.updateFullNode(f.EMPTY_NODE,a.getNode(),null),v=i.updateFullNode(f.EMPTY_NODE,o.getNode(),null),l=new la(s,a.isFullyInitialized(),n.filtersNodes()),u=new la(v,o.isFullyInitialized(),i.filtersNodes());this.viewCache_=new rk(u,l),this.eventGenerator_=new Xu(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,t){var r=[];if(t){b.assert(null==e,"A cancel should cancel all event registrations.");var n=this.query_.path;this.eventRegistrations_.forEach(function(e){t=t;var i=e.createCancelEvent(t,n);i&&r.push(i)})}if(e){for(var i=[],a=0;a<this.eventRegistrations_.length;++a){var o=this.eventRegistrations_[a];if(o.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(a+1));break}}else i.push(o)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return r},e.prototype.applyOperation=function(e,t,r){e.type===da.MERGE&&null!==e.source.queryId&&(b.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),b.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var n=this.viewCache_,i=this.processor_.applyOperation(n,e,t,r);return this.processor_.assertIndexed(i.viewCache),b.assert(i.viewCache.getServerCache().isFullyInitialized()||!n.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),r=[];t.getNode().isLeafNode()||t.getNode().forEachChild(x,function(e,t){r.push(d.childAddedChange(e,t))});return t.isFullyInitialized()&&r.push(d.valueChange(t.getNode())),this.generateEventsForChanges_(r,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,r){var n=r?[r]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,n)},e}(),ik=function(){function e(){this.views_={}}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return b.assert(gf,"Reference.ts has not been loaded"),gf},set:function(e){b.assert(!gf,"__referenceConstructor has already been defined"),gf=e},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return b.isEmpty(this.views_)},e.prototype.applyOperation=function(e,t,r){var n=e.source.queryId;if(null!==n){var i=b.safeGet(this.views_,n);return b.assert(null!=i,"SyncTree gave us an op for an invalid query."),i.applyOperation(e,t,r)}var a=[];return b.forEach(this.views_,function(n,i){a=a.concat(i.applyOperation(e,t,r))}),a},e.prototype.addEventRegistration=function(e,t,r,n,i){var a=e.queryIdentifier(),o=b.safeGet(this.views_,a);if(!o){var s=r.calcCompleteEventCache(i?n:null),v=!1;s?v=!0:n instanceof f?(s=r.calcCompleteEventChildren(n),v=!1):(s=f.EMPTY_NODE,v=!1);var l=new rk(new la(s,v,!1),new la(n,i,!1));o=new Yu(e,l),this.views_[a]=o}return o.addEventRegistration(t),o.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,r,n){var i=t.queryIdentifier(),a=[],o=[],s=this.hasCompleteView();if("default"===i){var v=this;b.forEach(this.views_,function(e,t){o=o.concat(t.removeEventRegistration(r,n)),t.isEmpty()&&(delete v.views_[e],t.getQuery().getQueryParams().loadsAllData()||a.push(t.getQuery()))})}else{var l=b.safeGet(this.views_,i);l&&(o=o.concat(l.removeEventRegistration(r,n)),l.isEmpty()&&(delete this.views_[i],l.getQuery().getQueryParams().loadsAllData()||a.push(l.getQuery())))}return s&&!this.hasCompleteView()&&a.push(new e.__referenceConstructor(t.repo,t.path)),{removed:a,events:o}},e.prototype.getQueryViews=function(){var e=this;return Object.keys(this.views_).map(function(t){return e.views_[t]}).filter(function(e){return!e.getQuery().getQueryParams().loadsAllData()})},e.prototype.getCompleteServerCache=function(e){var t=null;return b.forEach(this.views_,function(r,n){t=t||n.getCompleteServerCache(e)}),t},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return b.safeGet(this.views_,t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){return b.findValue(this.views_,function(e){return e.getQuery().getQueryParams().loadsAllData()})||null},e}(),hk=function(){function e(e){this.writeTree_=e}return e.prototype.addWrite=function(t,r){if(t.isEmpty())return new e(new R(r));var n=this.writeTree_.findRootMostValueAndPath(t);if(null!=n){var i=n.path,a=n.value,o=g.relativePath(i,t);return a=a.updateChild(o,r),new e(this.writeTree_.set(i,a))}var s=new R(r);return new e(this.writeTree_.setTree(t,s))},e.prototype.addWrites=function(e,t){var r=this;return b.forEach(t,function(t,n){r=r.addWrite(e.child(t),n)}),r},e.prototype.removeWrite=function(t){return t.isEmpty()?e.Empty:new e(this.writeTree_.setTree(t,R.Empty))},e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},e.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(g.relativePath(t.path,e)):null},e.prototype.getCompleteChildren=function(){var e=[],t=this.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(x,function(t,r){e.push(new m(t,r))}):this.writeTree_.children.inorderTraversal(function(t,r){null!=r.value&&e.push(new m(t,r.value))}),e},e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var r=this.getCompleteNode(t);return new e(null!=r?new R(r):this.writeTree_.subtree(t))},e.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},e.prototype.apply=function(t){return e.applySubtreeWrite_(g.Empty,this.writeTree_,t)},e.Empty=new e(new R(null)),e.applySubtreeWrite_=function(t,r,n){if(null!=r.value)return n.updateChild(t,r.value);var i=null;return r.children.inorderTraversal(function(r,a){".priority"===r?(b.assert(null!==a.value,"Priority writes must always be leaf nodes"),i=a.value):n=e.applySubtreeWrite_(t.child(r),a,n)}),n.getChild(t).isEmpty()||null===i||(n=n.updateChild(t.child(".priority"),i)),n},e}(),_u=function(){function e(){this.visibleWrites_=hk.Empty,this.allWrites_=[],this.lastWriteId_=-1}return e.prototype.childWrites=function(e){return new av(e,this)},e.prototype.addOverwrite=function(e,t,r,n){b.assert(r>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===n&&(n=!0),this.allWrites_.push({path:e,snap:t,writeId:r,visible:n}),n&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=r},e.prototype.addMerge=function(e,t,r){b.assert(r>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:r,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=r},e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var r=this.allWrites_[t];if(r.writeId===e)return r}return null},e.prototype.removeWrite=function(e){var t=this,r=this.allWrites_.findIndex(function(t){return t.writeId===e});b.assert(r>=0,"removeWrite called with nonexistent writeId.");var n=this.allWrites_[r];this.allWrites_.splice(r,1);for(var i=n.visible,a=!1,o=this.allWrites_.length-1;i&&o>=0;){var s=this.allWrites_[o];s.visible&&(o>=r&&this.recordContainsPath_(s,n.path)?i=!1:n.path.contains(s.path)&&(a=!0)),o--}if(i){if(a)return this.resetTree_(),!0;if(n.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(n.path);else{var v=n.children;b.forEach(v,function(e){t.visibleWrites_=t.visibleWrites_.removeWrite(n.path.child(e))})}return!0}return!1},e.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcCompleteEventCache=function(t,r,n,i){if(n||i){var a=this.visibleWrites_.childCompoundWrite(t);if(!i&&a.isEmpty())return r;if(i||null!=r||a.hasCompleteWrite(g.Empty)){var o=e.layerTree_(this.allWrites_,function(e){return(e.visible||i)&&(!n||!~n.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},t);l=r||f.EMPTY_NODE;return o.apply(l)}return null}var s=this.visibleWrites_.getCompleteNode(t);if(null!=s)return s;var v=this.visibleWrites_.childCompoundWrite(t);if(v.isEmpty())return r;if(null!=r||v.hasCompleteWrite(g.Empty)){var l=r||f.EMPTY_NODE;return v.apply(l)}return null},e.prototype.calcCompleteEventChildren=function(e,t){var r=f.EMPTY_NODE,n=this.visibleWrites_.getCompleteNode(e);if(n)return n.isLeafNode()||n.forEachChild(x,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(x,function(e,t){var n=i.childCompoundWrite(new g(e)).apply(t);r=r.updateImmediateChild(e,n)}),i.getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r,n){b.assert(r||n,"Either existingEventSnap or existingServerSnap must exist");var i=e.child(t);if(this.visibleWrites_.hasCompleteWrite(i))return null;var a=this.visibleWrites_.childCompoundWrite(i);return a.isEmpty()?n.getChild(t):a.apply(n.getChild(t))},e.prototype.calcCompleteChild=function(e,t,r){var n=e.child(t),i=this.visibleWrites_.getCompleteNode(n);return null!=i?i:r.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(n).apply(r.getNode().getImmediateChild(t)):null},e.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcIndexedSlice=function(e,t,r,n,i,a){var o,s=this.visibleWrites_.childCompoundWrite(e),v=s.getCompleteNode(g.Empty);if(null!=v)o=v;else{if(null==t)return[];o=s.apply(t)}if((o=o.withIndex(a)).isEmpty()||o.isLeafNode())return[];for(var l=[],u=a.getCompare(),$=i?o.getReverseIteratorFrom(r,a):o.getIteratorFrom(r,a),h=$.getNext();h&&l.length<n;)0!==u(h,r)&&l.push(h),h=$.getNext();return l},e.prototype.recordContainsPath_=function(e,t){return e.snap?e.path.contains(t):!!b.findKey(e.children,function(r,n){return e.path.child(n).contains(t)})},e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,g.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},e.DefaultFilter_=function(e){return e.visible},e.layerTree_=function(e,t,r){for(var n=hk.Empty,i=0;i<e.length;++i){var a=e[i];if(t(a)){var o=a.path,s=void 0;if(a.snap)r.contains(o)?(s=g.relativePath(r,o),n=n.addWrite(s,a.snap)):o.contains(r)&&(s=g.relativePath(o,r),n=n.addWrite(g.Empty,a.snap.getChild(s)));else{if(!a.children)throw b.assertionError("WriteRecord should have .snap or .children");if(r.contains(o))s=g.relativePath(r,o),n=n.addWrites(s,a.children);else if(o.contains(r))if((s=g.relativePath(o,r)).isEmpty())n=n.addWrites(g.Empty,a.children);else{var v=b.safeGet(a.children,s.getFront());if(v){var l=v.getChild(s.popFront());n=n.addWrite(g.Empty,l)}}}}}return n},e}(),av=function(){function e(e,t){this.treePath_=e,this.writeTree_=t}return e.prototype.calcCompleteEventCache=function(e,t,r){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,r)},e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,r)},e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},e.prototype.calcIndexedSlice=function(e,t,r,n,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,r,n,i)},e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},e.prototype.child=function(t){return new e(this.treePath_.child(t),this.writeTree_)},e}(),ak=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=R.Empty,this.pendingWriteTree_=new _u,this.tagToQueryMap_={},this.queryToTagMap_={}}return e.prototype.applyUserOverwrite=function(e,t,r,n){return this.pendingWriteTree_.addOverwrite(e,t,r,n),n?this.applyOperationToSyncPoints_(new td(ua.User,e,t)):[]},e.prototype.applyUserMerge=function(e,t,r){this.pendingWriteTree_.addMerge(e,t,r);var n=R.fromObject(t);return this.applyOperationToSyncPoints_(new jf(ua.User,e,n))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var r=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var n=R.Empty;return null!=r.snap?n=n.set(g.Empty,!0):b.forEach(r.children,function(e,t){n=n.set(new g(e),t)}),this.applyOperationToSyncPoints_(new Hu(r.path,n,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new td(ua.Server,e,t))},e.prototype.applyServerMerge=function(e,t){var r=R.fromObject(t);return this.applyOperationToSyncPoints_(new jf(ua.Server,e,r))},e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new Fk(ua.Server,e))},e.prototype.applyTaggedQueryOverwrite=function(t,r,n){var i=this.queryKeyForTag_(n);if(null!=i){var a=e.parseQueryKey_(i),o=a.path,s=a.queryId,v=g.relativePath(o,t),l=new td(ua.forServerTaggedQuery(s),v,r);return this.applyTaggedOperation_(o,l)}return[]},e.prototype.applyTaggedQueryMerge=function(t,r,n){var i=this.queryKeyForTag_(n);if(i){var a=e.parseQueryKey_(i),o=a.path,s=a.queryId,v=g.relativePath(o,t),l=R.fromObject(r),u=new jf(ua.forServerTaggedQuery(s),v,l);return this.applyTaggedOperation_(o,u)}return[]},e.prototype.applyTaggedListenComplete=function(t,r){var n=this.queryKeyForTag_(r);if(n){var i=e.parseQueryKey_(n),a=i.path,o=i.queryId,s=g.relativePath(a,t),v=new Fk(ua.forServerTaggedQuery(o),s);return this.applyTaggedOperation_(a,v)}return[]},e.prototype.addEventRegistration=function(t,r){var n=t.path,i=null,a=!1;this.syncPointTree_.foreachOnPath(n,function(e,t){var r=g.relativePath(e,n);i=i||t.getCompleteServerCache(r),a=a||t.hasCompleteView()});var o,s=this.syncPointTree_.get(n);(s?(a=a||s.hasCompleteView(),i=i||s.getCompleteServerCache(g.Empty)):(s=new ik,this.syncPointTree_=this.syncPointTree_.set(n,s)),null!=i)?o=!0:(o=!1,i=f.EMPTY_NODE,this.syncPointTree_.subtree(n).foreachChild(function(e,t){var r=t.getCompleteServerCache(g.Empty);r&&(i=i.updateImmediateChild(e,r))}));var v=s.viewExistsForQuery(t);if(!v&&!t.getQueryParams().loadsAllData()){var l=e.makeQueryKey_(t);b.assert(!(l in this.queryToTagMap_),"View does not exist, but we have a tag");var u=e.getNextQueryTag_();this.queryToTagMap_[l]=u,this.tagToQueryMap_["_"+u]=l}var $=this.pendingWriteTree_.childWrites(n),h=s.addEventRegistration(t,r,$,i,o);if(!v&&!a){var c=s.viewForQuery(t);h=h.concat(this.setupListener_(t,c))}return h},e.prototype.removeEventRegistration=function(t,r,n){var i=this,a=t.path,o=this.syncPointTree_.get(a),s=[];if(o&&("default"===t.queryIdentifier()||o.viewExistsForQuery(t))){var v=o.removeEventRegistration(t,r,n);o.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(a));var l=v.removed;s=v.events;var u=-1!==l.findIndex(function(e){return e.getQueryParams().loadsAllData()}),$=this.syncPointTree_.findOnPath(a,function(e,t){return t.hasCompleteView()});if(u&&!$){var h=this.syncPointTree_.subtree(a);if(!h.isEmpty())for(var c=this.collectDistinctViewsForSubTree_(h),p=0;p<c.length;++p){var d=c[p],m=d.getQuery(),_=this.createListenerForView_(d);this.listenProvider_.startListening(e.queryForListening_(m),this.tagForQuery_(m),_.hashFn,_.onComplete)}}if(!$&&l.length>0&&!n)if(u){this.listenProvider_.stopListening(e.queryForListening_(t),null)}else l.forEach(function(t){var r=i.queryToTagMap_[e.makeQueryKey_(t)];i.listenProvider_.stopListening(e.queryForListening_(t),r)});this.removeTags_(l)}return s},e.prototype.calcCompleteEventCache=function(e,t){var r=this.pendingWriteTree_,n=this.syncPointTree_.findOnPath(e,function(t,r){var n=g.relativePath(t,e),i=r.getCompleteServerCache(n);if(i)return i});return r.calcCompleteEventCache(e,n,t,!0)},e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,r){if(t&&t.hasCompleteView())return[t.getCompleteView()];var n=[];return t&&(n=t.getQueryViews()),b.forEach(r,function(e,t){n=n.concat(t)}),n})},e.prototype.removeTags_=function(t){for(var r=0;r<t.length;++r){var n=t[r];if(!n.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(n),a=this.queryToTagMap_[i];delete this.queryToTagMap_[i],delete this.tagToQueryMap_["_"+a]}}},e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.setupListener_=function(t,r){var n=t.path,i=this.tagForQuery_(t),a=this.createListenerForView_(r),o=this.listenProvider_.startListening(e.queryForListening_(t),i,a.hashFn,a.onComplete),s=this.syncPointTree_.subtree(n);if(i)b.assert(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var v=s.fold(function(e,t,r){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var n=[];return t&&(n=n.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),b.forEach(r,function(e,t){n=n.concat(t)}),n}),l=0;l<v.length;++l){var u=v[l];this.listenProvider_.stopListening(e.queryForListening_(u),this.tagForQuery_(u))}return o},e.prototype.createListenerForView_=function(e){var t=this,r=e.getQuery(),n=this.tagForQuery_(r);return{hashFn:function(){return(e.getServerCache()||f.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return n?t.applyTaggedListenComplete(r.path,n):t.applyListenComplete(r.path);var i=Qs(e,r);return t.removeEventRegistration(r,null,i)}}},e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},e.parseQueryKey_=function(e){var t=e.indexOf("$");return b.assert(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new g(e.substr(0,t))}},e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap_["_"+e]},e.prototype.tagForQuery_=function(t){var r=e.makeQueryKey_(t);return b.safeGet(this.queryToTagMap_,r)},e.getNextQueryTag_=function(){return e.nextQueryTag_++},e.prototype.applyTaggedOperation_=function(e,t){var r=this.syncPointTree_.get(e);b.assert(r,"Missing sync point for query tag that we're tracking");var n=this.pendingWriteTree_.childWrites(e);return r.applyOperation(t,n,null)},e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(g.Empty))},e.prototype.applyOperationHelper_=function(e,t,r,n){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,r,n);var i=t.get(g.Empty);null==r&&null!=i&&(r=i.getCompleteServerCache(g.Empty));var a=[],o=e.path.getFront(),s=e.operationForChild(o),v=t.children.get(o);if(v&&s){var l=r?r.getImmediateChild(o):null,u=n.child(o);a=a.concat(this.applyOperationHelper_(s,v,l,u))}return i&&(a=a.concat(i.applyOperation(e,n,r))),a},e.prototype.applyOperationDescendantsHelper_=function(e,t,r,n){var i=this,a=t.get(g.Empty);null==r&&null!=a&&(r=a.getCompleteServerCache(g.Empty));var o=[];return t.children.inorderTraversal(function(t,a){var s=r?r.getImmediateChild(t):null,v=n.child(t),l=e.operationForChild(t);l&&(o=o.concat(i.applyOperationDescendantsHelper_(l,a,s,v)))}),a&&(o=o.concat(a.applyOperation(e,n,r))),o},e.nextQueryTag_=1,e}(),cv=function(){function e(){this.rootNode_=f.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}(),dv=function(){function e(e){this.app_=e}return e.prototype.getToken=function(e){return this.app_.INTERNAL.getToken(e).then(null,function(e){return e&&"auth/token-not-initialized"===e.code?(L("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})},e.prototype.addTokenChangeListener=function(e){this.app_.INTERNAL.addAuthTokenListener(e)},e.prototype.removeTokenChangeListener=function(e){this.app_.INTERNAL.removeAuthTokenListener(e)},e.prototype.notifyForInvalidToken=function(){var e="Provided authentication credentials for the app named \""+this.app_.name+"\" are invalid. This usually indicates your app was not initialized correctly. ";"credential"in this.app_.options?e+="Make sure the \"credential\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.":"serviceAccount"in this.app_.options?e+="Make sure the \"serviceAccount\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.":e+="Make sure the \"apiKey\" and \"databaseURL\" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.",K(e)},e}(),ev=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),b.contains(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return b.deepCopy(this.counters_)},e}(),dd=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new ev),this.collections_[t]},e.getOrCreateReporter=function(e,t){var r=e.toString();return this.reporters_[r]||(this.reporters_[r]=t()),this.reporters_[r]},e.collections_={},e.reporters_={},e}(),Zj=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=b.clone(e);return this.last_&&b.forEach(this.last_,function(e,r){t[e]=t[e]-r}),this.last_=e,t},e}(),Yj=1e4,iv=3e4,jv=3e5,kv=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Zj(e);var r=Yj+(iv-Yj)*Math.random();yc(this.reportStats_.bind(this),Math.floor(r))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),r={},n=!1;b.forEach(t,function(t,i){i>0&&b.contains(e.statsToReport_,t)&&(r[t]=i,n=!0)}),n&&this.server_.reportStats(r),yc(this.reportStats_.bind(this),Math.floor(2*Math.random()*jv))},e}(),lv=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e.prototype.queueEvents=function(e){for(var t=null,r=0;r<e.length;r++){var n=e[r],i=n.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new mv(i)),t.add(n)}t&&this.eventLists_.push(t)},e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.equals(e)})},e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.contains(e)||e.contains(t)})},e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,r=0;r<this.eventLists_.length;r++){var n=this.eventLists_[r];if(n)e(n.getPath())?(this.eventLists_[r].raise(),this.eventLists_[r]=null):t=!1}t&&(this.eventLists_=[]),this.recursionDepth_--},e}(),mv=function(){function e(e){this.path_=e,this.events_=[]}return e.prototype.add=function(e){this.events_.push(e)},e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var r=t.getEventRunner();ie&&L("event: "+t.toString()),Rb(r)}}},e.prototype.getPath=function(){return this.path_},e}(),Qj=function(){function e(e){this.allowedEvents_=e,this.listeners_={},b.assert(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Array.isArray(this.listeners_[e]))for(var n=this.listeners_[e].slice(),i=0;i<n.length;i++)n[i].callback.apply(n[i].context,t)},e.prototype.on=function(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});var n=this.getInitialEvent(e);n&&t.apply(r,n)},e.prototype.off=function(e,t,r){this.validateEventType_(e);for(var n=this.listeners_[e]||[],i=0;i<n.length;i++)if(n[i].callback===t&&(!r||r===n[i].context))return void n.splice(i,1)},e.prototype.validateEventType_=function(e){b.assert(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}(),ov=function(e){function t(){var t,r,n=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(r="visibilitychange",t="hidden"):void 0!==document.mozHidden?(r="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(r="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(r="webkitvisibilitychange",t="webkitHidden")),n.visible_=!0,r&&document.addEventListener(r,function(){var e=!document[t];e!==n.visible_&&(n.visible_=e,n.trigger("visible",e))},!1),n}return X(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return b.assert("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(Qj),Oj=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||b.isMobileCordova()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return X(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return b.assert("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(Qj),qv=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var r=this;this.pendingResponses[e]=t;for(var n=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&Rb(function(){r.onMessage_(e[t])})},n=0;n<e.length;++n)t(n);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===n())break}},e}(),Kj="start",sv="close",tv="pLPCommand",uv="pRTLPCB",pf="id",rf="pw",wj="ser",yv="cb",zv="seg",Av="ts",Bv="d",Cv="disconn",Dv="dframe",sj=1870,rj=30,Gv=sj-rj,Hv=25e3,Iv=3e4,yf=function(){function e(e,t,r,n){this.connId=e,this.repoInfo=t,this.transportSessionId=r,this.lastSessionId=n,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Rc(e),this.stats_=dd.getCollection(t),this.urlFn=function(e){return t.connectionURL(zh,e)}}return e.prototype.open=function(e,t){var r=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new qv(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){r.log_("Timed out trying to connect."),r.onClosed_(),r.connectTimeoutTimer_=null},Math.floor(Iv)),Es(function(){if(!r.isClosed_){r.scriptTagHolder=new Kv(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],i=e[1],a=e[2];if(r.incrementIncomingBytes_(e),r.scriptTagHolder)if(r.connectTimeoutTimer_&&(clearTimeout(r.connectTimeoutTimer_),r.connectTimeoutTimer_=null),r.everConnected_=!0,n==Kj)r.id=i,r.password=a;else{if(n!==sv)throw new Error("Unrecognized command received: "+n);i?(r.scriptTagHolder.sendNewPolls=!1,r.myPacketOrderer.closeAfter(i,function(){r.onClosed_()})):r.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e[0],i=e[1];r.incrementIncomingBytes_(e),r.myPacketOrderer.handleResponse(n,i)},function(){r.onClosed_()},r.urlFn);var e={};e[Kj]="t",e[wj]=Math.floor(1e8*Math.random()),r.scriptTagHolder.uniqueCallbackIdentifier&&(e[yv]=r.scriptTagHolder.uniqueCallbackIdentifier),e[Qh]=Id,r.transportSessionId&&(e[Oh]=r.transportSessionId),r.lastSessionId&&(e[Hh]=r.lastSessionId),!b.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Jh)&&(e[Lh]=Kh);var t=r.urlFn(e);r.log_("Connecting via long-poll to "+t),r.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return e.forceAllow_||!e.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!Os()&&!Ps()&&!b.isNodeSdk()},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=b.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var r=b.base64Encode(t),n=oi(r,Gv),i=0;i<n.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!b.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var r={};r[Dv]="t",r[pf]=e,r[rf]=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=b.stringify(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),Kv=function(){function e(t,r,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new fl,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,b.isNodeSdk())this.commandCB=t,this.onMessageCB=r;else{this.uniqueCallbackIdentifier=Ki(),window[tv+this.uniqueCallbackIdentifier]=t,window[uv+this.uniqueCallbackIdentifier]=r,this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))a="<script>document.domain=\""+document.domain+"\";</script>";var o="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(s){L("frame writing exception"),s.stack&&L(s.stack),L(s)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||L("No IE domain setting required")}catch(r){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var t=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0))),b.isNodeSdk()&&this.myID){var r={};r[Cv]="t",r[pf]=this.myID,r[rf]=this.myPW;var n=this.urlFn(r);e.nodeRestRequest(n)}var i=this.onDisconnect;i&&(this.onDisconnect=null,i())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e[pf]=this.myID,e[rf]=this.myPW,e[wj]=this.currentSerial;for(var t=this.urlFn(e),r="",n=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+rj+r.length<=sj))break;var i=this.pendingSegs.shift();r=r+"&"+zv+n+"="+i.seg+"&"+Av+n+"="+i.ts+"&"+Bv+n+"="+i.d,n++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var r=this;this.outstandingRequests.add(t,1);var n=function(){r.outstandingRequests.remove(t),r.newRequest_()},i=setTimeout(n,Math.floor(Hv));this.addTag(e,function(){clearTimeout(i),n()})},e.prototype.addTag=function(e,t){var r=this;b.isNodeSdk()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!r.sendNewPolls)return;var n=r.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){var e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=function(){L("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(n)}catch(i){}},Math.floor(1))},e}(),Lv=16384,Mv=45e3,Af=null;"undefined"!=typeof MozWebSocket?Af=MozWebSocket:"undefined"!=typeof WebSocket&&(Af=WebSocket);var _a=function(){function e(t,r,n,i){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Rc(this.connId),this.stats_=dd.getCollection(r),this.connURL=e.connectionURL_(r,n,i)}return e.connectionURL_=function(e,t,r){var n={};return n[Qh]=Id,!b.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Jh)&&(n[Lh]=Kh),t&&(n[Oh]=t),r&&(n[Hh]=r),e.connectionURL(Ah,n)},e.prototype.open=function(e,t){var r=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,ib.set("previous_websocket_failure",!0);try{if(b.isNodeSdk()){var n=b.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/"+Id+"/"+oe.SDK_VERSION+"/"+Vi.platform+"/"+n}},a=Vi.env,o=0==this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;o&&(i.proxy={origin:o}),this.mySock=new Af(this.connURL,[],i)}else this.mySock=new Af(this.connURL)}catch(v){this.log_("Error instantiating WebSocket.");var s=v.message||v.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&r.log_(t),r.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==Af&&!e.forceDisallow_},e.previouslyFailed=function(){return ib.isInMemoryStorage||!0===ib.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){ib.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length==this.totalFrames){var t=this.frames.join("");this.frames=null;var r=b.jsonEval(t);this.onMessage(r)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(b.assert(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var r=this.extractFrameCount_(t);null!==r&&this.appendFrame_(r)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=b.stringify(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var r=oi(t,Lv);r.length>1&&this.sendString_(String(r.length));for(var n=0;n<r.length;n++)this.sendString_(r[n])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(Mv))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),Pv=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[yf,_a]},enumerable:!0,configurable:!0}),e.prototype.initTransports_=function(t){var r=_a&&_a.isAvailable(),n=r&&!_a.previouslyFailed();if(t.webSocketOnly&&(r||K("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[_a];else{var i=this.transports_=[];ni(e.ALL_TRANSPORTS,function(e,t){t&&t.isAvailable()&&i.push(t)})}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),Qv=6e4,Rv=5e3,Sv=10240,Tv=102400,Bf="t",dj="d",Wv="s",bj="r",Yv="e",_i="o",$i="a",Zi="n",Xi="p",bw="h",Wi=function(){function e(e,t,r,n,i,a,o){this.id=e,this.repoInfo_=t,this.onMessage_=r,this.onReady_=n,this.onDisconnect_=i,this.onKill_=a,this.lastSessionId=o,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Rc("c:"+this.id+":"),this.transportManager_=new Pv(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(r,n)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=yc(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>Tv?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>Sv?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(r){e===t.conn_?t.onConnectionLost_(r):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(r){2!=t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(r):e===t.secondaryConn_?t.onSecondaryMessageReceived_(r):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if(Bf in e){var t=e[Bf];t===$i?this.upgradeIfSecondaryHealthy_():t===bj?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):t===_i&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=Jc("t",e),r=Jc("d",e);if("c"==t)this.onSecondaryControl_(r);else{if("d"!=t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Xi,d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:$i,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Zi,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=Jc("t",e),r=Jc("d",e);"c"==t?this.onControl_(r):"d"==t&&this.onDataMessage_(r)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=Jc(Bf,e);if(dj in e){var r=e[dj];if(t===bw)this.onHandshake_(r);else if(t===Zi){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===Wv?this.onConnectionShutdown_(r):t===bj?this.onReset_(r):t===Yv?Gf("Server Error: "+r):t===_i?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Gf("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,r=e.v,n=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(n),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),Id!==r&&K("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),yc(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(Qv))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var r=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):yc(function(){r.sendPingOnPrimaryIfNecessary_()},Math.floor(Rv))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Xi,d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(ib.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),Ri=function(){function e(){}return e.prototype.put=function(e,t,r,n){},e.prototype.merge=function(e,t,r,n){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,r){},e.prototype.onDisconnectMerge=function(e,t,r){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),Oc=1e3,fw=3e5,Mi=3e4,hw=1.3,iw=3e4,jw="server_kill",kw=3,Za=function(e){function t(r,n,i,a,o,s){var v=e.call(this)||this;if(v.repoInfo_=r,v.onDataUpdate_=n,v.onConnectStatus_=i,v.onServerInfoUpdate_=a,v.authTokenProvider_=o,v.authOverride_=s,v.id=t.nextPersistentConnectionId_++,v.log_=Rc("p:"+v.id+":"),v.interruptReasons_={},v.listens_={},v.outstandingPuts_=[],v.outstandingPutCount_=0,v.onDisconnectRequestQueue_=[],v.connected_=!1,v.reconnectDelay_=Oc,v.maxReconnectDelay_=fw,v.securityDebugCallback_=null,v.lastSessionId=null,v.establishConnectionTimer_=null,v.visible_=!1,v.requestCBHash_={},v.requestNumber_=0,v.realtime_=null,v.authToken_=null,v.forceTokenRefresh_=!1,v.invalidAuthTokenCount_=0,v.firstConnection_=!0,v.lastConnectionAttemptTime_=null,v.lastConnectionEstablishedTime_=null,s&&!b.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return v.scheduleConnect_(0),ov.getInstance().on("visible",v.onVisible_,v),-1===r.host.indexOf("fblocal")&&Oj.getInstance().on("online",v.onOnline_,v),v}return X(t,e),t.prototype.sendRequest=function(e,t,r){var n=++this.requestNumber_,i={r:n,a:e,b:t};this.log_(b.stringify(i)),b.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[n]=r)},t.prototype.listen=function(e,t,r,n){var i=e.queryIdentifier(),a=e.path.toString();this.log_("Listen called for "+a+" "+i),this.listens_[a]=this.listens_[a]||{},b.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),b.assert(!this.listens_[a][i],"listen() called twice for same path/queryId.");var o={onComplete:n,hashFn:t,query:e,tag:r};this.listens_[a][i]=o,this.connected_&&this.sendListen_(o)},t.prototype.sendListen_=function(e){var r=this,n=e.query,i=n.path.toString(),a=n.queryIdentifier();this.log_("Listen on "+i+" for "+a);var o={p:i};e.tag&&(o.q=n.queryObject(),o.t=e.tag),o.h=e.hashFn(),this.sendRequest("q",o,function(o){var s=o.d,v=o.s;t.warnOnListenWarnings_(s,n),(r.listens_[i]&&r.listens_[i][a])===e&&(r.log_("listen response",o),"ok"!==v&&r.removeListen_(i,a),e.onComplete&&e.onComplete(v,s))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&b.contains(e,"w")){var r=b.safeGet(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){var n="\".indexOn\": \""+t.getQueryParams().getIndex().toString()+"\"",i=t.path.toString();K("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+n+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||b.isAdmin(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Mi)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,r=b.isValidFormat(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(r,n,function(r){var n=r.s,i=r.d||"error";e.authToken_===t&&("ok"===n?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(n,i))})}},t.prototype.unlisten=function(e,t){var r=e.path.toString(),n=e.queryIdentifier();this.log_("Unlisten called for "+r+" "+n),b.assert(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,n)&&this.connected_&&this.sendUnlisten_(r,n,e.queryObject(),t)},t.prototype.sendUnlisten_=function(e,t,r,n){this.log_("Unlisten on "+e+" for "+t);var i={p:e};n&&(i.q=r,i.t=n),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,r){this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})},t.prototype.onDisconnectMerge=function(e,t,r){this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,r,n){var i={p:t,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){n&&setTimeout(function(){n(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,r,n){this.putInternal("p",e,t,r,n)},t.prototype.merge=function(e,t,r,n){this.putInternal("m",e,t,r,n)},t.prototype.putInternal=function(e,t,r,n,i){var a={p:t,d:r};void 0!==i&&(a.h=i),this.outstandingPuts_.push({action:e,request:a,onComplete:n}),this.outstandingPutCount_++;var o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,r=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,n,function(n){t.log_(r+" response",n),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(n.s,n.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,function(e){if("ok"!==e.s){var r=e.d;t.log_("reportStats","Error sending stats: "+r)}})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+b.stringify(e));var t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Gf("Unrecognized action received from server: "+b.stringify(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;b.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Oc,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=Oc,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){new Date().getTime()-this.lastConnectionEstablishedTime_>iw&&(this.reconnectDelay_=Oc),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime();var e=new Date().getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*hw)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+t.nextConnectionId_++,a=this,o=this.lastSessionId,s=!1,v=null,l=function(){v?v.close():(s=!0,n())};this.realtime_={close:l,sendRequest:function(e){b.assert(v,"sendRequest call when we're not connected not allowed."),v.sendRequest(e)}};var u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(u).then(function(t){s?L("getToken() completed but was canceled"):(L("getToken() completed. Creating connection."),a.authToken_=t&&t.accessToken,v=new Wi(i,a.repoInfo_,e,r,n,function(e){K(e+" ("+a.repoInfo_.toString()+")"),a.interrupt(jw)},o))}).then(null,function(e){a.log_("Failed to get token: "+e),s||(b.CONSTANTS.NODE_ADMIN&&K(e),l())})}},t.prototype.interrupt=function(e){L("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){L("Resuming connection for reason: "+e),delete this.interruptReasons_[e],b.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=Oc,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var r;r=t?t.map(function(e){return re(e)}).join("$"):"default";var n=this.removeListen_(e,r);n&&n.onComplete&&n.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var r,n=new g(e).toString();return void 0!==this.listens_[n]?(r=this.listens_[n][t],delete this.listens_[n][t],0===b.getCount(this.listens_[n])&&delete this.listens_[n]):r=void 0,r},t.prototype.onAuthRevoked_=function(e,t){L("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=kw&&(this.reconnectDelay_=Mi,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e=this;this.tryAuth(),b.forEach(this.listens_,function(t,r){b.forEach(r,function(t,r){e.sendListen_(r)})});for(var t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){var r=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(r.action,r.pathString,r.data,r.onComplete)}},t.prototype.sendConnectStats_=function(){var e={},t="js";b.CONSTANTS.NODE_ADMIN?t="admin_node":b.CONSTANTS.NODE_CLIENT&&(t="node"),e["sdk."+t+"."+oe.SDK_VERSION.replace(/\./g,"-")]=1,b.isMobileCordova()?e["framework.cordova"]=1:b.isReactNative()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=Oj.getInstance().currentlyOnline();return b.isEmpty(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(Ri),mw=function(e){function t(t,r,n){var i=e.call(this)||this;return i.repoInfo_=t,i.onDataUpdate_=r,i.authTokenProvider_=n,i.log_=Rc("p:rest:"),i.listens_={},i}return X(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(b.assert(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},t.prototype.listen=function(e,r,n,i){var a=this,o=e.path.toString();this.log_("Listen called for "+o+" "+e.queryIdentifier());var s=t.getListenId_(e,n),v={};this.listens_[s]=v;var l=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(o+".json",l,function(e,t){var r=t;(404===e&&(r=null,e=null),null===e&&a.onDataUpdate_(o,r,!1,n),b.safeGet(a.listens_,s)===v)&&i(e?401==e?"permission_denied":"rest_error:"+e:"ok",null)})},t.prototype.unlisten=function(e,r){var n=t.getListenId_(e,r);delete this.listens_[n]},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,r){var n=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var a=i&&i.accessToken;a&&(t.auth=a);var o=(n.repoInfo_.secure?"https://":"http://")+n.repoInfo_.host+e+"?ns="+n.repoInfo_.namespace+b.querystring(t);n.log_("Sending REST request for "+o);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(r&&4===s.readyState){n.log_("REST Response for "+o+" received. status:",s.status,"response:",s.responseText);var e=null;if(s.status>=200&&s.status<300){try{e=b.jsonEval(s.responseText)}catch(t){K("Failed to parse JSON response for "+o+": "+s.responseText)}r(null,e)}else 401!==s.status&&404!==s.status&&K("Got unsuccessful REST response for "+o+" Status: "+s.status),r(s.status);r=null}},s.open("GET",o,!0),s.send()})},t}(Ri),Di="repo_interrupt",E=function(){function e(e,t,r){var n=this;this.repoInfo_=e,this.app=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new lv,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new df,this.persistentConnection_=null;var i=new dv(r);if(this.stats_=dd.getCollection(e),t||Us())this.server_=new mw(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var a=r.options.databaseAuthVariableOverride;if(null!=a){if("object"!=typeof a)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{b.stringify(a)}catch(o){throw new Error("Invalid authOverride provided: "+o)}}this.persistentConnection_=new Za(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,a),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(e){n.server_.refreshAuthToken(e)}),this.statsReporter_=dd.getOrCreateReporter(e,function(){return new kv(n.stats_,n.server_)}),this.transactions_init_(),this.infoData_=new cv,this.infoSyncTree_=new ak({startListening:function(e,t,r,i){var a=[],o=n.infoData_.getNode(e.path);return o.isEmpty()||(a=n.infoSyncTree_.applyServerOverwrite(e.path,o),setTimeout(function(){i("ok")},0)),a},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new ak({startListening:function(e,t,r,i){return n.server_.listen(e,r,t,function(t,r){var a=i(t,r);n.eventQueue_.raiseEventsForChangedPath(e.path,a)}),[]},stopListening:function(e,t){n.server_.unlisten(e,t)}})}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new g(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e},e.prototype.generateServerValues=function(){return Au({timestamp:this.serverTime()})},e.prototype.onDataUpdate_=function(e,t,r,n){this.dataUpdateCount++;var i=new g(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var a=[];if(n){if(r){var o=b.map(t,function(e){return C(e)});a=this.serverSyncTree_.applyTaggedQueryMerge(i,o,n)}else{var s=C(t);a=this.serverSyncTree_.applyTaggedQueryOverwrite(i,s,n)}}else if(r){var v=b.map(t,function(e){return C(e)});a=this.serverSyncTree_.applyServerMerge(i,v)}else{var l=C(t);a=this.serverSyncTree_.applyServerOverwrite(i,l)}var u=i;a.length>0&&(u=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(u,a)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var t=this;ni(e,function(e,r){t.updateInfo_(r,e)})},e.prototype.updateInfo_=function(e,t){var r=new g("/.info/"+e),n=C(t);this.infoData_.updateSnapshot(r,n);var i=this.infoSyncTree_.applyServerOverwrite(r,n);this.eventQueue_.raiseEventsForChangedPath(r,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.setWithPriority=function(e,t,r,n){var i=this;this.log_("set",{path:e.toString(),value:t,priority:r});var a=this.generateServerValues(),o=C(t,r),s=pb(o,a),v=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserOverwrite(e,s,v,!0);this.eventQueue_.queueEvents(l),this.server_.put(e.toString(),o.val(!0),function(t,r){var a="ok"===t;a||K("set at "+e+" failed: "+t);var o=i.serverSyncTree_.ackUserWrite(v,!a);i.eventQueue_.raiseEventsForChangedPath(e,o),i.callOnCompleteCallback(n,t,r)});var u=this.abortTransactions_(e);this.rerunTransactions_(u),this.eventQueue_.raiseEventsForChangedPath(u,[])},e.prototype.update=function(e,t,r){var n=this;this.log_("update",{path:e.toString(),value:t});var i=!0,a=this.generateServerValues(),o={};if(b.forEach(t,function(e,t){i=!1;var r=C(t);o[e]=pb(r,a)}),i)L("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(r,"ok");else{var s=this.getNextWriteId_(),v=this.serverSyncTree_.applyUserMerge(e,o,s);this.eventQueue_.queueEvents(v),this.server_.merge(e.toString(),t,function(t,i){var a="ok"===t;a||K("update at "+e+" failed: "+t);var o=n.serverSyncTree_.ackUserWrite(s,!a),v=o.length>0?n.rerunTransactions_(e):e;n.eventQueue_.raiseEventsForChangedPath(v,o),n.callOnCompleteCallback(r,t,i)}),b.forEach(t,function(t){var r=n.abortTransactions_(e.child(t));n.rerunTransactions_(r)}),this.eventQueue_.raiseEventsForChangedPath(e,[])}},e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),r=Cu(this.onDisconnect_,t),n=[];r.forEachTree(g.Empty,function(t,r){n=n.concat(e.serverSyncTree_.applyServerOverwrite(t,r));var i=e.abortTransactions_(t);e.rerunTransactions_(i)}),this.onDisconnect_=new df,this.eventQueue_.raiseEventsForChangedPath(g.Empty,n)},e.prototype.onDisconnectCancel=function(e,t){var r=this;this.server_.onDisconnectCancel(e.toString(),function(n,i){"ok"===n&&r.onDisconnect_.forget(e),r.callOnCompleteCallback(t,n,i)})},e.prototype.onDisconnectSet=function(e,t,r){var n=this,i=C(t);this.server_.onDisconnectPut(e.toString(),i.val(!0),function(t,a){"ok"===t&&n.onDisconnect_.remember(e,i),n.callOnCompleteCallback(r,t,a)})},e.prototype.onDisconnectSetWithPriority=function(e,t,r,n){var i=this,a=C(t,r);this.server_.onDisconnectPut(e.toString(),a.val(!0),function(t,r){"ok"===t&&i.onDisconnect_.remember(e,a),i.callOnCompleteCallback(n,t,r)})},e.prototype.onDisconnectUpdate=function(e,t,r){var n=this;if(b.isEmpty(t))return L("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(r,"ok");this.server_.onDisconnectMerge(e.toString(),t,function(i,a){"ok"===i&&b.forEach(t,function(t,r){var i=C(r);n.onDisconnect_.remember(e.child(t),i)}),n.callOnCompleteCallback(r,i,a)})},e.prototype.addEventCallbackForQuery=function(e,t){var r;r=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,r)},e.prototype.removeEventCallbackForQuery=function(e,t){var r;r=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,r)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(Di)},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(Di)},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new Zj(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var r=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);b.forEach(t,function(e,t){for(var n=e.length;n<r+2;n++)e+=" ";console.log(e+t)})}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="";this.persistentConnection_&&(r=this.persistentConnection_.id+":"),L.apply(void 0,[r].concat(e))},e.prototype.callOnCompleteCallback=function(e,t,r){e&&Rb(function(){if("ok"==t)e(null);else{var n=(t||"error").toUpperCase(),i=n;r&&(i+=": "+r);var a=new Error(i);a.code=n,e(a)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new Bd(this))},enumerable:!0,configurable:!0}),e}(),Ai=function(){function e(t){this.indexedFilter_=new mf(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,r,n,i,a){return this.matches(new m(t,r))||(r=f.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,n,i,a)},e.prototype.updateFullNode=function(e,t,r){t.isLeafNode()&&(t=f.EMPTY_NODE);var n=t.withIndex(this.index_);n=n.updatePriority(f.EMPTY_NODE);var i=this;return t.forEachChild(x,function(e,t){i.matches(new m(e,t))||(n=n.updateImmediateChild(e,f.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),qw=function(){function e(e){this.rangedFilter_=new Ai(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,r,n,i,a){return this.rangedFilter_.matches(new m(t,r))||(r=f.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,n,i,a):this.fullLimitUpdateChild_(e,t,r,i,a)},e.prototype.updateFullNode=function(e,t,r){var n;if(t.isLeafNode()||t.isEmpty())n=f.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){n=f.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;i.hasNext()&&a<this.limit_;){var o=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),o)<=0:this.index_.compare(o,this.rangedFilter_.getEndPost())<=0))break;n=n.updateImmediateChild(o.name,o.node),a++}}else{n=(n=t.withIndex(this.index_)).updatePriority(f.EMPTY_NODE);var s=void 0,v=void 0,l=void 0;i=void 0;if(this.reverse_){i=n.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),v=this.rangedFilter_.getStartPost();var u=this.index_.getCompare();l=function(e,t){return u(t,e)}}else i=n.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),v=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();a=0;for(var $=!1;i.hasNext();){o=i.getNext();!$&&l(s,o)<=0&&($=!0),$&&a<this.limit_&&l(o,v)<=0?a++:n=n.updateImmediateChild(o.name,f.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,r,n,i){var a;if(this.reverse_){var o=this.index_.getCompare();a=function(e,t){return o(t,e)}}else a=this.index_.getCompare();var s=e;b.assert(s.numChildren()==this.limit_,"");var v=new m(t,r),l=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),u=this.rangedFilter_.matches(v);if(s.hasChild(t)){for(var $=s.getImmediateChild(t),h=n.getChildAfterChild(this.index_,l,this.reverse_);null!=h&&(h.name==t||s.hasChild(h.name));)h=n.getChildAfterChild(this.index_,h,this.reverse_);var c=null==h?1:a(h,v);if(u&&!r.isEmpty()&&c>=0)return null!=i&&i.trackChildChange(d.childChangedChange(t,r,$)),s.updateImmediateChild(t,r);null!=i&&i.trackChildChange(d.childRemovedChange(t,$));var p=s.updateImmediateChild(t,f.EMPTY_NODE);return null!=h&&this.rangedFilter_.matches(h)?(null!=i&&i.trackChildChange(d.childAddedChange(h.name,h.node)),p.updateImmediateChild(h.name,h.node)):p}return r.isEmpty()?e:u&&a(l,v)>=0?(null!=i&&(i.trackChildChange(d.childRemovedChange(l.name,l.node)),i.trackChildChange(d.childAddedChange(t,r))),s.updateImmediateChild(t,r).updateImmediateChild(l.name,f.EMPTY_NODE)):e},e}(),rw=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=x}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},e.prototype.getIndexStartValue=function(){return b.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return b.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:Va},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return b.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return b.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ga},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return b.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.copy_=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},e.prototype.limitToFirst=function(t){var r=this.copy_();return r.limitSet_=!0,r.limit_=t,r.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,r},e.prototype.limitToLast=function(t){var r=this.copy_();return r.limitSet_=!0,r.limit_=t,r.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,r},e.prototype.startAt=function(e,t){var r=this.copy_();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r},e.prototype.endAt=function(e,t){var r=this.copy_();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r},e.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},e.prototype.getQueryObject=function(){var t=e.WIRE_PROTOCOL_CONSTANTS_,r={};if(this.startSet_&&(r[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(r[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(r[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(r[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){r[t.LIMIT]=this.limit_;var n=this.viewFrom_;""===n&&(n=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),r[t.VIEW_FROM]=n}return this.index_!==x&&(r[t.INDEX]=this.index_.toString()),r},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==x},e.prototype.getNodeFilter=function(){return this.loadsAllData()?new mf(this.getIndex()):this.hasLimit()?new qw(this):new Ai(this)},e.prototype.toRestQueryStringParameters=function(){var t,r=e.REST_QUERY_CONSTANTS_,n={};return this.isDefault()?n:(this.index_===x?t=r.PRIORITY_INDEX:this.index_===Se?t=r.VALUE_INDEX:this.index_===Ea?t=r.KEY_INDEX:(b.assert(this.index_ instanceof Te,"Unrecognized index type!"),t=this.index_.toString()),n[r.ORDER_BY]=b.stringify(t),this.startSet_&&(n[r.START_AT]=b.stringify(this.indexStartValue_),this.startNameSet_&&(n[r.START_AT]+=","+b.stringify(this.indexStartName_))),this.endSet_&&(n[r.END_AT]=b.stringify(this.indexEndValue_),this.endNameSet_&&(n[r.END_AT]+=","+b.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[r.LIMIT_TO_FIRST]=this.limit_:n[r.LIMIT_TO_LAST]=this.limit_),n)},e.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},e.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},e.DEFAULT=new e,e}(),ca=function(e){function t(t,r){if(!(t instanceof E))throw new Error("new Reference() no longer supported - use app.database().");return e.call(this,t,r,rw.DEFAULT,!1)||this}return X(t,e),t.prototype.getKey=function(){return b.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return b.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof g||(null===this.path.getFront()?Bt("Reference.child",1,e,!1):hc("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){b.validateArgCount("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){b.validateArgCount("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){b.validateArgCount("Reference.set",1,2,arguments.length),U("Reference.set",this.path),Ia("Reference.set",1,e,this.path,!1),b.validateCallback("Reference.set",2,t,!0);var r=new b.Deferred;return this.repo.setWithPriority(this.path,e,null,r.wrapCallback(t)),r.promise},t.prototype.update=function(e,t){if(b.validateArgCount("Reference.update",1,2,arguments.length),U("Reference.update",this.path),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,K("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}nh("Reference.update",1,e,this.path,!1),b.validateCallback("Reference.update",2,t,!0);var i=new b.Deferred;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,r){if(b.validateArgCount("Reference.setWithPriority",2,3,arguments.length),U("Reference.setWithPriority",this.path),Ia("Reference.setWithPriority",1,e,this.path,!1),Ce("Reference.setWithPriority",2,t,!1),b.validateCallback("Reference.setWithPriority",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var n=new b.Deferred;return this.repo.setWithPriority(this.path,e,t,n.wrapCallback(r)),n.promise},t.prototype.remove=function(e){return b.validateArgCount("Reference.remove",0,1,arguments.length),U("Reference.remove",this.path),b.validateCallback("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,r){if(b.validateArgCount("Reference.transaction",1,3,arguments.length),U("Reference.transaction",this.path),b.validateCallback("Reference.transaction",1,e,!1),b.validateCallback("Reference.transaction",2,t,!0),Et("Reference.transaction",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===r&&(r=!0);var n=new b.Deferred;"function"==typeof t&&n.promise.catch(function(){});return this.repo.startTransaction(this.path,e,function(e,r,i){e?n.reject(e):n.resolve(new Gt(r,i)),"function"==typeof t&&t(e,r,i)},r),n.promise},t.prototype.setPriority=function(e,t){b.validateArgCount("Reference.setPriority",1,2,arguments.length),U("Reference.setPriority",this.path),Ce("Reference.setPriority",1,e,!1),b.validateCallback("Reference.setPriority",2,t,!0);var r=new b.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),e,null,r.wrapCallback(t)),r.promise},t.prototype.push=function(e,t){b.validateArgCount("Reference.push",0,2,arguments.length),U("Reference.push",this.path),Ia("Reference.push",1,e,this.path,!0),b.validateCallback("Reference.push",2,t,!0);var r,n=this.repo.serverTime(),i=Ht(n),a=this.child(i),o=this.child(i);return r=null!=e?a.set(e,t).then(function(){return o}):Promise.resolve(o),a.then=r.then.bind(r),a.catch=r.then.bind(r,void 0),"function"==typeof t&&r.catch(function(){}),a},t.prototype.onDisconnect=function(){return U("Reference.onDisconnect",this.path),new Tm(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),t}(Jd);Jd.__referenceConstructor=ca,ik.__referenceConstructor=ca;var D,ri=function(){return function(){this.children={},this.childCount=0,this.value=null}}(),vw=function(){function e(e,t,r){void 0===e&&(e=""),void 0===t&&(t=null),void 0===r&&(r=new ri),this.name_=e,this.parent_=t,this.node_=r}return e.prototype.subTree=function(t){for(var r,n=t instanceof g?t:new g(t),i=this;null!==(r=n.getFront());){i=new e(r,i,b.safeGet(i.node_.children,r)||new ri),n=n.popFront()}return i},e.prototype.getValue=function(){return this.node_.value},e.prototype.setValue=function(e){b.assert(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},e.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},e.prototype.hasChildren=function(){return this.node_.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var r=this;b.forEach(this.node_.children,function(n,i){t(new e(n,r,i))})},e.prototype.forEachDescendant=function(e,t,r){t&&!r&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,r)}),t&&r&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var r=t?this:this.parent();null!==r;){if(e(r))return!0;r=r.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},e.prototype.path=function(){return new g(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},e.prototype.name=function(){return this.name_},e.prototype.parent=function(){return this.parent_},e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},e.prototype.updateChild_=function(e,t){var r=t.isEmpty(),n=b.contains(this.node_.children,e);r&&n?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):r||n||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},e}();!function(e){e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT"}(D||(D={})),E.MAX_TRANSACTION_RETRIES_=25,E.prototype.transactions_init_=function(){this.transactionQueueTree_=new vw},E.prototype.startTransaction=function(e,t,r,n){this.log_("transaction on "+e);var i=function(){},a=new ca(this,e);a.on("value",i);var o={path:e,update:t,onComplete:r,status:null,order:Ki(),applyLocally:n,retryCount:0,unwatcher:function(){a.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=this.getLatestState_(e);o.currentInputSnapshot=s;var v=o.update(s.val());if(void 0===v){if(o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete){var l=new tb(o.currentInputSnapshot,new ca(this,o.path),x);o.onComplete(null,!1,l)}}else{nc("transaction failed: Data returned ",v,o.path),o.status=D.RUN;var u=this.transactionQueueTree_.subTree(e),$=u.getValue()||[];$.push(o),u.setValue($);var h=void 0;if("object"==typeof v&&null!==v&&b.contains(v,".priority"))h=b.safeGet(v,".priority"),b.assert(pc(h),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else h=(this.serverSyncTree_.calcCompleteEventCache(e)||f.EMPTY_NODE).getPriority().val();h=h;var c=this.generateServerValues(),p=C(v,h),d=pb(p,c);o.currentOutputSnapshotRaw=p,o.currentOutputSnapshotResolved=d,o.currentWriteId=this.getNextWriteId_();var m=this.serverSyncTree_.applyUserOverwrite(e,d,o.currentWriteId,o.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,m),this.sendReadyTransactions_()}},E.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||f.EMPTY_NODE},E.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var r=this.buildTransactionQueue_(e);b.assert(r.length>0,"Sending zero length transaction queue"),r.every(function(e){return e.status===D.RUN})&&this.sendTransactionQueue_(e.path(),r)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})},E.prototype.sendTransactionQueue_=function(e,t){for(var r=this,n=t.map(function(e){return e.currentWriteId}),i=this.getLatestState_(e,n),a=i,o=i.hash(),s=0;s<t.length;s++){var v=t[s];b.assert(v.status===D.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),v.status=D.SENT,v.retryCount++;var l=g.relativePath(e,v.path);a=a.updateChild(l,v.currentOutputSnapshotRaw)}var u=a.val(!0),$=e;this.server_.put($.toString(),u,function(n){r.log_("transaction put response",{path:$.toString(),status:n});var i=[];if("ok"===n){for(var a=[],o=0;o<t.length;o++){if(t[o].status=D.COMPLETED,i=i.concat(r.serverSyncTree_.ackUserWrite(t[o].currentWriteId)),t[o].onComplete){var s=t[o].currentOutputSnapshotResolved,v=new ca(r,t[o].path),l=new tb(s,v,x);a.push(t[o].onComplete.bind(null,null,!0,l))}t[o].unwatcher()}r.pruneCompletedTransactionsBelowNode_(r.transactionQueueTree_.subTree(e)),r.sendReadyTransactions_(),r.eventQueue_.raiseEventsForChangedPath(e,i);for(o=0;o<a.length;o++)Rb(a[o])}else{if("datastale"===n)for(o=0;o<t.length;o++)t[o].status===D.SENT_NEEDS_ABORT?t[o].status=D.NEEDS_ABORT:t[o].status=D.RUN;else{K("transaction at "+$.toString()+" failed: "+n);for(o=0;o<t.length;o++)t[o].status=D.NEEDS_ABORT,t[o].abortReason=n}r.rerunTransactions_(e)}},o)},E.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),r=t.path(),n=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(n,r),r},E.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var r,n=[],i=[],a=e.filter(function(e){return e.status===D.RUN}).map(function(e){return e.currentWriteId}),o=0;o<e.length;o++){var s=e[o],v=g.relativePath(t,s.path),l=!1,u=void 0;if(b.assert(null!==v,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===D.NEEDS_ABORT)l=!0,u=s.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===D.RUN)if(s.retryCount>=E.MAX_TRANSACTION_RETRIES_)l=!0,u="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var $=this.getLatestState_(s.path,a);s.currentInputSnapshot=$;var h=e[o].update($.val());if(void 0!==h){nc("transaction failed: Data returned ",h,s.path);var c=C(h);"object"==typeof h&&null!=h&&b.contains(h,".priority")||(c=c.updatePriority($.getPriority()));var p=s.currentWriteId,d=this.generateServerValues(),m=pb(c,d);s.currentOutputSnapshotRaw=c,s.currentOutputSnapshotResolved=m,s.currentWriteId=this.getNextWriteId_(),a.splice(a.indexOf(p),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(s.path,m,s.currentWriteId,s.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(p,!0))}else l=!0,u="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(t,i),i=[],l&&(e[o].status=D.COMPLETED,r=e[o].unwatcher,setTimeout(r,Math.floor(0)),e[o].onComplete))if("nodata"===u){var _=new ca(this,e[o].path),f=e[o].currentInputSnapshot,y=new tb(f,_,x);n.push(e[o].onComplete.bind(null,null,!1,y))}else n.push(e[o].onComplete.bind(null,new Error(u),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(o=0;o<n.length;o++)Rb(n[o]);this.sendReadyTransactions_()}},E.prototype.getAncestorTransactionNode_=function(e){for(var t,r=this.transactionQueueTree_;null!==(t=e.getFront())&&null===r.getValue();)r=r.subTree(t),e=e.popFront();return r},E.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},E.prototype.aggregateTransactionQueuesForNode_=function(e,t){var r=this,n=e.getValue();if(null!==n)for(var i=0;i<n.length;i++)t.push(n[i]);e.forEachChild(function(e){r.aggregateTransactionQueuesForNode_(e,t)})},E.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,r=e.getValue();if(r){for(var n=0,i=0;i<r.length;i++)r[i].status!==D.COMPLETED&&(r[n]=r[i],n++);r.length=n,e.setValue(r.length>0?r:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},E.prototype.abortTransactions_=function(e){var t=this,r=this.getAncestorTransactionNode_(e).path(),n=this.transactionQueueTree_.subTree(e);return n.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(n),n.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),r},E.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var r=[],n=[],i=-1,a=0;a<t.length;a++)if(t[a].status===D.SENT_NEEDS_ABORT);else if(t[a].status===D.SENT)b.assert(i===a-1,"All SENT items should be at beginning of queue."),i=a,t[a].status=D.SENT_NEEDS_ABORT,t[a].abortReason="set";else if(b.assert(t[a].status===D.RUN,"Unexpected transaction status in abort"),t[a].unwatcher(),n=n.concat(this.serverSyncTree_.ackUserWrite(t[a].currentWriteId,!0)),t[a].onComplete){r.push(t[a].onComplete.bind(null,new Error("set"),!1,null))}-1===i?e.setValue(null):t.length=i+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),n);for(a=0;a<r.length;a++)Rb(r[a])}};var mi,ki="databaseURL",Jf=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return mi||(mi=new e),mi},e.prototype.interrupt=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].interrupt()},e.prototype.resume=function(){for(var e in this.repos_)for(var t in this.repos_[e])this.repos_[e][t].resume()},e.prototype.databaseFromApp=function(e,t){var r=t||e.options[ki];void 0===r&&ga("Can't determine Firebase Database URL.  Be sure to include "+ki+" option when calling firebase.initializeApp().");var n=vh(r),i=n.repoInfo;return Wm("Invalid Firebase Database URL",1,n),n.path.isEmpty()||ga("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,e).database},e.prototype.deleteRepo=function(e){var t=b.safeGet(this.repos_,e.app.name);t&&b.safeGet(t,e.repoInfo_.toURLString())===e||ga("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.repoInfo_.toURLString()]},e.prototype.createRepo=function(e,t){var r=b.safeGet(this.repos_,t.name);r||(r={},this.repos_[t.name]=r);var n=b.safeGet(r,e.toURLString());return n&&ga("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),n=new E(e,this.useRestClient_,t),r[e.toURLString()]=n,n},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}(),Bd=function(){function e(e){this.repo_=e,e instanceof E||ga("Don't call new Database() directly - please use firebase.database()."),this.root_=new ca(e,g.Empty),this.INTERNAL=new Aw(this)}return Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),e.prototype.ref=function(e){return this.checkDeleted_("ref"),b.validateArgCount("database.ref",0,1,arguments.length),e instanceof ca?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),b.validateArgCount(t,1,1,arguments.length);var r=vh(e);Wm(t,1,r);var n=r.repoInfo;return n.host!==this.repo_.repoInfo_.host&&ga(t+": Host name does not match the current database: (found "+n.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(r.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repo_&&ga("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){b.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){b.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"}},e}(),Aw=function(){function e(e){this.database=e}return e.prototype.delete=function(){return Kp(this,void 0,void 0,function(){return Lp(this,function(e){return this.database.checkDeleted_("delete"),Jf.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},e}(),Bw=function(){_a.forceDisallow(),yf.forceAllow()},Cw=function(){yf.forceDisallow()},Dw=function(){return _a.isAvailable()},Ew=function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},Fw=function(e,t){e.repo.stats(t)},Gw=function(e,t){e.repo.statsIncrementCounter(t)},Hw=function(e){return e.repo.dataUpdateCount},Iw=function(e,t){return e.repo.interceptServerData_(t)},Jw=Object.freeze({forceLongPolling:Bw,forceWebSockets:Cw,isWebSocketsAvailable:Dw,setSecurityDebugCallback:Ew,stats:Fw,statsIncrementCounter:Gw,dataUpdateCount:Hw,interceptServerData:Iw}),Kw=Za;Za.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},Za.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Lw=Wi,Mw=function(e){var t=Za.prototype.put;return Za.prototype.put=function(r,n,i,a){void 0!==a&&(a=e()),t.call(this,r,n,i,a)},function(){Za.prototype.put=t}},Nw=yh,Ow=function(e){return e.queryIdentifier()},Pw=function(e){return e.repo.persistentConnection_.listens_},Qw=function(e){Jf.getInstance().forceRestClient(e)},Rw=Object.freeze({DataConnection:Kw,RealTimeConnection:Lw,hijackHash:Mw,ConnectionTarget:Nw,queryIdentifier:Ow,listens:Pw,forceRestClient:Qw}),_h=Bd.ServerValue;function Xh(e){var t=e.INTERNAL.registerService("database",function(e,t,r){return Jf.getInstance().databaseFromApp(e,r)},{Reference:ca,Query:Jd,Database:Bd,enableLogging:ke,INTERNAL:Jw,ServerValue:_h,TEST_ACCESS:Rw},null,!0);b.isNodeSdk()&&(na=t)}Xh(oe);var Uw=Xh;na.registerDatabase=Uw;var Vw=Bd;na.Database=Vw;var Ww=Jd;na.Query=Ww;var Xw=ca;na.Reference=Xw;var Yw=ke;na.enableLogging=Yw;var Zw=_h;na.ServerValue=Zw;var $w=tb;na.DataSnapshot=$w;var _w=Tm;na.OnDisconnect=_w;var Mf=_g(Yi);Mf.d.initializeApp({apiKey:"AIzaSyDMhnS2dJk0yTMERT0j4g6jEQ80_nikPHw",authDomain:"flickering-torch-6356.firebaseapp.com",databaseURL:"https://flickering-torch-6356.firebaseio.com",projectId:"flickering-torch-6356",storageBucket:"flickering-torch-6356.appspot.com",messagingSenderId:"60549942221"});var Rh=Mf.d.auth();Td.auth=Rh;var Gh=Mf.d.database();Td.database=Gh;function dx(r,t){return gx(r)||fx(r,t)||ex()}function ex(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function fx(r,t){var e=[],a=!0,$=!1,n=void 0;try{for(var o,i=r[Symbol.iterator]();!(a=(o=i.next()).done)&&(e.push(o.value),!t||e.length!==t);a=!0);}catch(l){$=!0,n=l}finally{try{a||null==i.return||i.return()}finally{if($)throw n}}return e}function gx(r){if(Array.isArray(r))return r}function Eh(r){var t=dx(r,4),e=t[0],a=t[1],$=t[2],n=t[3],o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=e+e,l=a+a,u=$+$,v=e*i,y=e*l,L=e*u,f=a*l,s=a*u,O=$*u,X=n*i,c=n*l,d=n*u;return o[0]=1-(f+O),o[1]=y+d,o[2]=L-c,o[4]=y-d,o[5]=1-(v+O),o[6]=s+X,o[8]=L+c,o[9]=s-X,o[10]=1-(v+f),o}function ix(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Bh(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function kx(t,i,e){return i&&Bh(t.prototype,i),e&&Bh(t,e),t}function rb($){return Math.abs(parseInt("".concat($),10))}function F($,n){return $.x*n.x+$.y*n.y}function wb($,n){return $.x*n.y-$.y*n.x}function gb($){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new k(n*$.y,-n*$.x)}function id(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return new k(-$*n.y,$*n.x)}function fb($,n){return new k($.col1.x*n.x+$.col2.x*n.y,$.col1.y*n.x+$.col2.y*n.y)}function Da($,n){return new k(F(n,$.col1),F(n,$.col2))}function B($,n){var o=fb($.R,n);return o.x+=$.position.x,o.y+=$.position.y,o}function tx($,n){var o=z(n,$.position),t=o.x*$.R.col1.x+o.y*$.R.col1.y;return o.y=o.x*$.R.col2.x+o.y*$.R.col2.y,o.x=t,o}function Wc($,n){return new k($.x+n.x,$.y+n.y)}function z($,n){return new k($.x-n.x,$.y-n.y)}function Km(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return new k($*n.x,$*n.y)}function Pf(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return $>0?$:-$}function yx($){return new k(Pf($.x),Pf($.y))}function zx(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $<n?$:n}function vc(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $>n?$:n}function ia(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $<n?n:$>o?o:$}function Cx(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wm(e,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function Ex(e,t,o){return t&&wm(e.prototype,t),o&&wm(e,o),e}var Fa=function(){function e(){Cx(this,e),this.col1=new k,this.col2=new k,this.SetIdentity()}return Ex(e,[{key:"Set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Math.cos(e),o=Math.sin(e);this.col1.x=t,this.col2.x=-o,this.col1.y=o,this.col2.y=t}},{key:"SetVV",value:function(e,t){this.col1.SetV(e),this.col2.SetV(t)}},{key:"Copy",value:function(){var t=new e;return t.SetM(this),t}},{key:"SetM",value:function(e){this.col1.SetV(e.col1),this.col2.SetV(e.col2)}},{key:"AddM",value:function(e){this.col1.x+=e.col1.x,this.col1.y+=e.col1.y,this.col2.x+=e.col2.x,this.col2.y+=e.col2.y}},{key:"SetIdentity",value:function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1}},{key:"SetZero",value:function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0}},{key:"GetAngle",value:function(){return Math.atan2(this.col1.y,this.col1.x)}},{key:"GetInverse",value:function(e){var t=this.col1.x,o=this.col2.x,l=this.col1.y,c=this.col2.y,i=t*c-o*l;return 0!==i&&(i=1/i),e.col1.x=i*c,e.col2.x=-i*o,e.col1.y=-i*l,e.col2.y=i*t,e}},{key:"Solve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=this.col1.x,c=this.col2.x,i=this.col1.y,n=this.col2.y,r=l*n-c*i;return 0!==r&&(r=1/r),e.x=r*(n*t-c*o),e.y=r*(l*o-i*t),e}},{key:"Abs",value:function(){this.col1.Abs(),this.col2.Abs()}}],[{key:"FromAngle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=new e;return o.Set(t),o}},{key:"FromVV",value:function(t,o){var l=new e;return l.SetVV(t,o),l}}]),e}();var k=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ix(this,t),this.x=i,this.y=e}return kx(t,[{key:"SetZero",value:function(){this.x=0,this.y=0}},{key:"Set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=t,this.y=i}},{key:"SetV",value:function(t){this.x=t.x,this.y=t.y}},{key:"GetNegative",value:function(){return new t(-this.x,-this.y)}},{key:"NegativeSelf",value:function(){this.x=-this.x,this.y=-this.y}},{key:"Copy",value:function(){return new t(this.x,this.y)}},{key:"Add",value:function(t){this.x+=t.x,this.y+=t.y}},{key:"Subtract",value:function(t){this.x-=t.x,this.y-=t.y}},{key:"Multiply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.x*=t,this.y*=t}},{key:"MulM",value:function(t){var i=this.x;this.x=t.col1.x*i+t.col2.x*this.y,this.y=t.col1.y*i+t.col2.y*this.y}},{key:"MulTM",value:function(t){var i=F(this,t.col1);this.y=F(this,t.col2),this.x=i}},{key:"CrossVF",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.x;this.x=t*this.y,this.y=-t*i}},{key:"CrossFV",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.x;this.x=-t*this.y,this.y=t*i}},{key:"MinV",value:function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y}},{key:"MaxV",value:function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y}},{key:"Abs",value:function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)}},{key:"Length",value:function(){return Math.hypot(this.x,this.y)}},{key:"LengthSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"Normalize",value:function(){var t=this.Length();if(t<Number.MIN_VALUE)return 0;var i=1/t;return this.x*=i,this.y*=i,t}},{key:"IsValid",value:function(){return isFinite(this.x)&&isFinite(this.y)}}],[{key:"Make",value:function(){return new t(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}}]),t}();function Hx(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function Ix(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lm(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function Kx(t,e,i){return e&&lm(t.prototype,e),i&&lm(t,i),t}var Qf=Math.PI;var ba=2;var Od=.1;var am=2;var fa=.005;var Cc=8*fa;var Rx=32;var Sx=32;var Tx=1;var Ux=.2;var Ab=2;var Wl=Ab*Ab;var Bb=.5*Qf;var Sl=Bb*Bb;var Wf=.2;var $x=.5;var Nl=.01;var Ml=2/180*Qf;function by(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.sqrt($*r)}function cy(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $>r?$:r}function aa($){if(!$)throw new Error("Assertion failed!")}function ey(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Kl(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function gy(t,e,i){return e&&Kl(t.prototype,e),i&&Kl(t,i),t}var db=function(){function t(){ey(this,t),this.localCenter=new k,this.c0=new k,this.c=new k,this.a0=0,this.a=0,this.t0=0}return gy(t,[{key:"Set",value:function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0}},{key:"Copy",value:function(){var e=new t;return e.Set(this),e}},{key:"GetTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var s=t.R;t.position.x-=s.col1.x*this.localCenter.x+s.col2.x*this.localCenter.y,t.position.y-=s.col1.y*this.localCenter.x+s.col2.y*this.localCenter.y}},{key:"Advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}}}]),t}();function iy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Fl(e,t){for(var a=0;a<t.length;a++){var c=t[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function ky(e,t,a){return t&&Fl(e.prototype,t),a&&Fl(e,a),e}var $=function(){function e(t,a){iy(this,e),this.position=new k,this.R=new Fa,t&&this.position.SetV(t),a&&this.R.SetM(a)}return ky(e,[{key:"Initialize",value:function(e,t){this.position.SetV(e),this.R.SetM(t)}},{key:"SetIdentity",value:function(){this.position.SetZero(),this.R.SetIdentity()}},{key:"Set",value:function(e){this.position.SetV(e.position),this.R.SetM(e.R)}},{key:"GetAngle",value:function(){return Math.atan2(this.R.col1.y,this.R.col1.x)}}]),e}();function my(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tl(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function oy(t,e,r){return e&&tl(t.prototype,e),r&&tl(t,r),t}function py(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pl(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ry(t,e,r){return e&&pl(t.prototype,e),r&&pl(t,r),t}var nl=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;py(this,t),this._r=0,this._g=0,this._b=0,this.Set(e,r,n)}return ry(t,[{key:"Set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.r=t,this.g=e,this.b=r}},{key:"r",get:function(){return this._r},set:function(t){this._r=rb(255*ia(t,0,1))}},{key:"g",get:function(){return this._g},set:function(t){this._g=rb(255*ia(t,0,1))}},{key:"b",get:function(){return this._b},set:function(t){this._b=rb(255*ia(t,0,1))}},{key:"color",get:function(){return this._r<<16|this._g<<8|this._b}}]),t}();function ty(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ml(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function vy(t,e,i){return e&&ml(t.prototype,e),i&&ml(t,i),t}var M=function(){function t(){var e=this;ty(this,t),this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1,this.m_sprite={graphics:{clear:function(){if(e.m_ctx){var t=e.m_ctx.canvas,i=t.width,a=t.height;e.m_ctx.clearRect(0,0,i,a)}}}},this.m_drawFlags=0}return vy(t,[{key:"_color",value:function(t,e){return"rgba(".concat((16711680&t)>>16,",").concat((65280&t)>>8,",").concat(255&t,",").concat(e,")")}},{key:"SetFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags=t}},{key:"GetFlags",value:function(){return this.m_drawFlags}},{key:"AppendFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags|=t}},{key:"ClearFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags&=~t}},{key:"SetSprite",value:function(t){this.m_ctx=t}},{key:"GetSprite",value:function(){return this.m_ctx}},{key:"SetDrawScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawScale=t}},{key:"GetDrawScale",value:function(){return this.m_drawScale}},{key:"SetLineThickness",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_lineThickness=t,this.m_ctx&&(this.m_ctx.lineWidth=t)}},{key:"GetLineThickness",value:function(){return this.m_lineThickness}},{key:"SetAlpha",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_alpha=t}},{key:"GetAlpha",value:function(){return this.m_alpha}},{key:"SetFillAlpha",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_fillAlpha=t}},{key:"GetFillAlpha",value:function(){return this.m_fillAlpha}},{key:"SetXFormScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_xformScale=t}},{key:"GetXFormScale",value:function(){return this.m_xformScale}},{key:"DrawPolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.moveTo(t[0].x*l,t[0].y*l);for(var o=1;o<e;o++)a.lineTo(t[o].x*l,t[o].y*l);a.lineTo(t[0].x*l,t[0].y*l),a.closePath(),a.stroke()}}},{key:"DrawSolidPolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.fillStyle=this._color(i.color,this.m_fillAlpha),a.moveTo(t[0].x*l,t[0].y*l);for(var o=1;o<e;o++)a.lineTo(t[o].x*l,t[o].y*l);a.lineTo(t[0].x*l,t[0].y*l),a.closePath(),a.fill(),a.stroke()}}},{key:"DrawCircle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale,o=t.x*l,r=t.y*l;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.arc(o,r,e*l,0,2*Math.PI,!0),a.closePath(),a.stroke()}}},{key:"DrawSolidCircle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(this.m_ctx&&e){var l=this.m_ctx,o=this.m_drawScale,r=t.x*o,n=t.y*o;l.moveTo(0,0),l.beginPath(),l.strokeStyle=this._color(a.color,this.m_alpha),l.fillStyle=this._color(a.color,this.m_fillAlpha),l.arc(r,n,e*o,0,2*Math.PI,!0),l.moveTo(r,n),l.lineTo((t.x+i.x*e)*o,(t.y+i.y*e)*o),l.closePath(),l.fill(),l.stroke()}}},{key:"DrawSegment",value:function(t,e,i){if(this.m_ctx){var a=this.m_ctx,l=this.m_drawScale;a.strokeStyle=this._color(i.color,this.m_alpha),a.beginPath(),a.moveTo(t.x*l,t.y*l),a.lineTo(e.x*l,e.y*l),a.closePath(),a.stroke()}}},{key:"DrawTransform",value:function(t){if(this.m_ctx){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}}]),t}();M.e_shapeBit=1,M.e_jointBit=2,M.e_aabbBit=4,M.e_pairBit=8,M.e_centerOfMassBit=16,M.e_controllerBit=32;function xy(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function al(t,r){for(var e=0;e<r.length;e++){var i=r[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function zy(t,r,e){return r&&al(t.prototype,r),e&&al(t,e),t}var Yf=function(){function t(){xy(this,t),this.dt=1/60,this.inv_dt=1/this.dt,this.positionIterations=10,this.velocityIterations=10,this.dtRatio=1,this.warmStarting=!0}return zy(t,[{key:"Set",value:function(t){var r=t.dt,e=t.inv_dt,i=t.positionIterations,a=t.velocityIterations,n=t.warmStarting;this.dt=r,this.inv_dt=e,this.positionIterations=i,this.velocityIterations=a,this.warmStarting=n}}]),t}();function By(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zk(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Dy(t,e,o){return e&&Zk(t.prototype,e),o&&Zk(t,o),t}function Ey(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Uk(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Gy(e,r,t){return r&&Uk(e.prototype,r),t&&Uk(e,t),e}function Hy(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sk(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function Jy(t,e,i){return e&&Sk(t.prototype,e),i&&Sk(t,i),t}function Ky(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Rk(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function My(e,r,t){return r&&Rk(e.prototype,r),t&&Rk(e,t),e}var Ok=function(){function e(){Ky(this,e),this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return My(e,[{key:"Copy",value:function(){var r=new e;return r.categoryBits=this.categoryBits,r.maskBits=this.maskBits,r.groupIndex=this.groupIndex,r}}]),e}();function Oy(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Nk(e,r){for(var n=0;n<r.length;n++){var u=r[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}function Qy(e,r,n){return r&&Nk(e.prototype,r),n&&Nk(e,n),e}var Ha=function(){function e(){Oy(this,e),this.lowerBound=new k,this.upperBound=new k}return Qy(e,[{key:"IsValid",value:function(){var e=this.upperBound.x-this.lowerBound.x,r=this.upperBound.y-this.lowerBound.y;return e>=0&&r>=0&&this.lowerBound.IsValid()&&this.upperBound.IsValid()}},{key:"GetCenter",value:function(){return new k((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)}},{key:"GetExtents",value:function(){return new k((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)}},{key:"Contains",value:function(e){return this.lowerBound.x<=e.lowerBound.x&&this.lowerBound.y<=e.lowerBound.y&&e.upperBound.x<=this.upperBound.x&&e.upperBound.y<=this.upperBound.y}},{key:"RayCast",value:function(e,r){var n=-Number.MAX_VALUE,u=Number.MAX_VALUE,o=r.p1.x,t=r.p1.y,i=r.p2.x-r.p1.x,p=r.p2.y-r.p1.y,a=Math.abs(i),s=Math.abs(p),d=e.normal,l=0,B=0,h=0,$=0,y=0;if(a<Number.MIN_VALUE){if(o<this.lowerBound.x||this.upperBound.x<o)return!1}else if(l=1/i,y=-1,(B=(this.lowerBound.x-o)*l)>(h=(this.upperBound.x-o)*l)&&($=B,B=h,h=$,y=1),B>n&&(d.x=y,d.y=0,n=B),n>(u=Math.min(u,h)))return!1;if(s<Number.MIN_VALUE){if(t<this.lowerBound.y||this.upperBound.y<t)return!1}else if(l=1/p,y=-1,(B=(this.lowerBound.y-t)*l)>(h=(this.upperBound.y-t)*l)&&($=B,B=h,h=$,y=1),B>n&&(d.y=y,d.x=0,n=B),n>(u=Math.min(u,h)))return!1;return e.fraction=n,!0}},{key:"TestOverlap",value:function(e){var r=e.lowerBound.x-this.upperBound.x,n=e.lowerBound.y-this.upperBound.y,u=this.lowerBound.x-e.upperBound.x,o=this.lowerBound.y-e.upperBound.y;return r<0||n<0||u<0||o<0}},{key:"Combine",value:function(e,r){this.lowerBound.x=Math.min(e.lowerBound.x,r.lowerBound.x),this.lowerBound.y=Math.min(e.lowerBound.y,r.lowerBound.y),this.upperBound.x=Math.max(e.upperBound.x,r.upperBound.x),this.upperBound.y=Math.max(e.upperBound.y,r.upperBound.y)}}],[{key:"Combine",value:function(r,n){var u=new e;return u.Combine(r,n),u}}]),e}();function Sy(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function sk(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Uy(e,n,t){return n&&sk(e.prototype,n),t&&sk(e,t),e}function Vy(o,r){if(!(o instanceof r))throw new TypeError("Cannot call a class as a function")}function Wy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mk(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Yy(e,t,r){return t&&mk(e.prototype,t),r&&mk(e,r),e}var Db=function(){function e(){Wy(this,e),this.m_vertices=[],this.m_count=0,this.m_radius=0}return Yy(e,[{key:"Set",value:function(e){switch(e.GetType()){case q.e_circleShape:var t=e;this.m_vertices=[t.m_p],this.m_count=1,this.m_radius=t.m_radius;break;case q.e_polygonShape:var r=e;this.m_vertices=r.m_vertices,this.m_count=r.m_vertexCount,this.m_radius=r.m_radius;break;default:aa(!1);}}},{key:"GetSupport",value:function(e){for(var t=0,r=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y,i=1;i<this.m_count;++i){var s=this.m_vertices[i].x*e.x+this.m_vertices[i].y*e.y;s>r&&(t=i,r=s)}return t}},{key:"GetSupportVertex",value:function(e){for(var t=0,r=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y,i=1;i<this.m_count;++i){var s=this.m_vertices[i].x*e.x+this.m_vertices[i].y*e.y;s>r&&(t=i,r=s)}return this.m_vertices[t]}},{key:"GetVertexCount",value:function(){return this.m_count}},{key:"GetVertex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return aa(0<=e&&e<this.m_count),this.m_vertices[e]}}]),e}();var $j=function o(){Vy(this,o),this.proxyA=new Db,this.proxyB=new Db,this.transformA=new $,this.transformB=new $,this.sweepA=new db,this.sweepB=new db,this.useRadii=!1};function _y(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var Uj=function s(){_y(this,s),this.pointA=new k,this.pointB=new k,this.distance=0,this.iterations=0};function bz(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var Sj=function a(){bz(this,a),this.indexA=new Array(3).fill(0),this.indexB=new Array(3).fill(0),this.count=0,this.metric=0};function dz(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Fj(t,i){for(var e=0;e<i.length;e++){var r=i[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function fz(t,i,e){return i&&Fj(t.prototype,i),e&&Fj(t,e),t}function gz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dj(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function iz(e,t,r){return t&&Dj(e.prototype,t),r&&Dj(e,r),e}var ag=function(){function e(){gz(this,e),this.wA=new k,this.wB=new k,this.w=new k,this.a=0,this.indexA=0,this.indexB=0}return iz(e,[{key:"Set",value:function(e){this.wA.SetV(e.wA),this.wB.SetV(e.wB),this.w.SetV(e.w),this.a=e.a,this.indexA=e.indexA,this.indexB=e.indexB}}]),e}();var kz=function(){function t(){dz(this,t),this.m_v1=new ag,this.m_v2=new ag,this.m_v3=new ag,this.m_vertices=new Array(3),this.m_count=0,this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3}return fz(t,[{key:"ReadCache",value:function(t,i,e,r,s){var m,$;aa(0<=t.count&&t.count<=3),this.m_count=t.count;for(var o,v=this.m_vertices,a=0;a<this.m_count;a++)(o=v[a]).indexA=t.indexA[a],o.indexB=t.indexB[a],m=i.GetVertex(o.indexA),$=r.GetVertex(o.indexB),o.wA=B(e,m),o.wB=B(s,$),o.w=z(o.wB,o.wA),o.a=0;if(this.m_count>1){var h=t.metric,n=this.GetMetric();(n<.5*h||2*h<n||n<Number.MIN_VALUE)&&(this.m_count=0)}0===this.m_count&&((o=v[0]).indexA=0,o.indexB=0,m=i.GetVertex(0),$=r.GetVertex(0),o.wA=B(e,m),o.wB=B(s,$),o.w=z(o.wB,o.wA),this.m_count=1)}},{key:"WriteCache",value:function(t){t.metric=this.GetMetric(),t.count=rb(this.m_count);for(var i=this.m_vertices,e=0;e<this.m_count;e++)t.indexA[e]=rb(i[e].indexA),t.indexB[e]=rb(i[e].indexB)}},{key:"GetSearchDirection",value:function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=z(this.m_v2.w,this.m_v1.w);return wb(t,this.m_v1.w.GetNegative())>0?id(1,t):gb(t,1);default:return aa(!1),new k;}}},{key:"GetClosestPoint",value:function(){switch(this.m_count){case 0:return aa(!1),new k;case 1:return this.m_v1.w;case 2:return new k(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return aa(!1),new k;}}},{key:"GetWitnessPoints",value:function(t,i){switch(this.m_count){case 0:aa(!1);break;case 1:t.SetV(this.m_v1.wA),i.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,i.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,i.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:i.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,i.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:aa(!1);}}},{key:"GetMetric",value:function(){switch(this.m_count){case 0:return aa(!1),0;case 1:return 0;case 2:return z(this.m_v1.w,this.m_v2.w).Length();case 3:return wb(z(this.m_v2.w,this.m_v1.w),z(this.m_v3.w,this.m_v1.w));default:return aa(!1),0;}}},{key:"Solve2",value:function(){var t=this.m_v1.w,i=this.m_v2.w,e=z(i,t),r=-(t.x*e.x+t.y*e.y);if(r<=0)return this.m_v1.a=1,void(this.m_count=1);var s=i.x*e.x+i.y*e.y;if(s<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var m=1/(s+r);this.m_v1.a=s*m,this.m_v2.a=r*m,this.m_count=2}},{key:"Solve3",value:function(){var t=this.m_v1.w,i=this.m_v2.w,e=this.m_v3.w,r=z(i,t),s=F(t,r),m=F(i,r),$=-s,o=z(e,t),v=F(t,o),a=F(e,o),h=-v,n=z(e,i),_=F(i,n),c=F(e,n),u=-_,A=wb(r,o),p=A*wb(i,e),P=A*wb(e,t),w=A*wb(t,i);if($<=0&&h<=0)return this.m_v1.a=1,void(this.m_count=1);if(m>0&&$>0&&w<=0){var J=1/(m+$);return this.m_v1.a=m*J,this.m_v2.a=$*J,void(this.m_count=2)}if(a>0&&h>0&&P<=0){var V=1/(a+h);return this.m_v1.a=a*V,this.m_v3.a=h*V,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(m<=0&&u<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(a<=0&&c<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(c>0&&u>0&&p<=0){var l=1/(c+u);return this.m_v2.a=c*l,this.m_v3.a=u*l,this.m_count=2,void this.m_v1.Set(this.m_v3)}var x=1/(p+P+w);this.m_v1.a=p*x,this.m_v2.a=P*x,this.m_v3.a=w*x,this.m_count=3}}]),t}();var lz=new kz;var mz=new Array(3).fill(0);var nz=new Array(3).fill(0);var oz=0;var pz=0;var qz=0;function uj(e,t,$){++oz;var r=$.proxyA,o=$.proxyB,s=$.transformA,i=$.transformB,a=lz;a.ReadCache(t,r,s,o,i);for(var p,d=a.m_vertices,x=mz,n=nz,N=0,_=(a.GetClosestPoint().LengthSquared(),0);_<20;){N=a.m_count;for(var m=0;m<N;m++)x[m]=d[m].indexA,n[m]=d[m].indexB;switch(a.m_count){case 1:break;case 2:a.Solve2();break;case 3:a.Solve3();break;default:aa(!1);}if(3===a.m_count)break;(p=a.GetClosestPoint()).LengthSquared();var l=a.GetSearchDirection();if(l.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var c=d[a.m_count];c.indexA=r.GetSupport(Da(s.R,l.GetNegative())),c.wA=B(s,r.GetVertex(c.indexA)),c.indexB=o.GetSupport(Da(i.R,l)),c.wB=B(i,o.GetVertex(c.indexB)),c.w=z(c.wB,c.wA),++_,++pz;for(var b=!1,u=0;u<N;u++)if(c.indexA===x[u]&&c.indexB===n[u]){b=!0;break}if(b)break;++a.m_count}if(qz=vc(qz,_),a.GetWitnessPoints(e.pointA,e.pointB),e.distance=z(e.pointA,e.pointB).Length(),e.iterations=_,a.WriteCache(t),$.useRadii){var v=r.m_radius,A=o.m_radius;if(e.distance>v+A&&e.distance>Number.MIN_VALUE){e.distance-=v+A;var g=z(e.pointB,e.pointA);g.Normalize(),e.pointA.x+=v*g.x,e.pointA.y+=v*g.y,e.pointB.x-=A*g.x,e.pointB.y-=A*g.y}else(p=new k).x=.5*(e.pointA.x+e.pointB.x),p.y=.5*(e.pointA.y+e.pointB.y),e.pointA.x=e.pointB.x=p.x,e.pointA.y=e.pointB.y=p.y,e.distance=0}}var q=function(){function e(){Sy(this,e),this.m_type=e.e_unknownShape,this.m_radius=fa}return Uy(e,[{key:"Set",value:function(e){this.m_radius=e.m_radius}},{key:"GetType",value:function(){return this.m_type}},{key:"TestPoint",value:function(e,n){return!1}},{key:"RayCast",value:function(e,n,t){return!1}},{key:"ComputeAABB",value:function(e,n){}},{key:"ComputeMass",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}],[{key:"TestOverlap",value:function(e,n,t,r){var u=new $j;u.proxyA=new Db,u.proxyA.Set(e),u.proxyB=new Db,u.proxyB.Set(t),u.transformA=n,u.transformB=r,u.useRadii=!0;var a=new Sj;a.count=0;var $=new Uj;return uj($,a,u),$.distance<10*Number.MIN_VALUE}}]),e}();q.e_unknownShape=parseInt("-1",10),q.e_circleShape=0,q.e_polygonShape=1,q.e_edgeShape=2,q.e_shapeTypeCount=3,q.e_hitCollide=1,q.e_missCollide=0,q.e_startsInsideCollide=parseInt("-1",10);function tz(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var ij=function a(){tz(this,a),this.mass=0,this.center=new k(0,0),this.I=0};var Sc=function(){function t(){Hy(this,t),this.m_filter=new Ok,this.m_aabb=new Ha,this.m_density=0,this.m_friction=0,this.m_restitution=0,this.m_isSensor=!1}return Jy(t,[{key:"GetType",value:function(){return this.m_shape?this.m_shape.GetType():q.e_unknownShape}},{key:"GetShape",value:function(){return this.m_shape}},{key:"SetSensor",value:function(t){if(this.m_isSensor!==t&&(this.m_isSensor=t,this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,s=i.GetFixtureA(),r=i.GetFixtureB();s!==this&&r!==this||i.SetSensor(s.IsSensor()||r.IsSensor()),e=e.next}}},{key:"IsSensor",value:function(){return this.m_isSensor}},{key:"SetFilterData",value:function(t){if(this.m_filter=t.Copy(),this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,s=i.GetFixtureA(),r=i.GetFixtureB();s!==this&&r!==this||i.FlagForFiltering(),e=e.next}}},{key:"GetFilterData",value:function(){return this.m_filter.Copy()}},{key:"GetBody",value:function(){return this.m_body}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(t){this.m_userData=t}},{key:"TestPoint",value:function(t){return!(!this.m_shape||!this.m_body)&&this.m_shape.TestPoint(this.m_body.GetTransform(),t)}},{key:"RayCast",value:function(t,e){return!(!this.m_shape||!this.m_body)&&this.m_shape.RayCast(t,e,this.m_body.GetTransform())}},{key:"GetMassData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ij;return!(!this.m_shape||!this.m_body)&&(this.m_shape.ComputeMass(t,this.m_density),t)}},{key:"SetDensity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_density=t}},{key:"GetDensity",value:function(){return this.m_density}},{key:"GetFriction",value:function(){return this.m_friction}},{key:"SetFriction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_friction=t}},{key:"GetRestitution",value:function(){return this.m_restitution}},{key:"SetRestitution",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_restitution=t}},{key:"GetAABB",value:function(){return this.m_aabb}},{key:"Create",value:function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=void 0,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density}},{key:"Destroy",value:function(){this.m_shape=void 0}},{key:"CreateProxy",value:function(t,e){if(!this.m_shape||!this.m_body)return!1;this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)}},{key:"DestroyProxy",value:function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=void 0)}},{key:"Synchronize",value:function(t,e,i){if(this.m_proxy&&this.m_shape){var s=new Ha,r=new Ha;this.m_shape.ComputeAABB(s,e),this.m_shape.ComputeAABB(r,i),this.m_aabb.Combine(s,r);var n=z(i.position,e.position);t.MoveProxy(this.m_proxy,this.m_aabb,n)}}}]),t}();var fg=function(){function e(){Ey(this,e)}return Gy(e,[{key:"ShouldCollide",value:function(e,r){var t=e.GetFilterData(),a=r.GetFilterData();return t.groupIndex===a.groupIndex&&0!==t.groupIndex?t.groupIndex>0:0!=(t.maskBits&a.categoryBits)&&0!=(t.categoryBits&a.maskBits)}},{key:"RayCollide",value:function(e,r){return!(e instanceof Sc)||this.ShouldCollide(e,r)}}]),e}();fg.b2_defaultFilter=new fg;function xz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zi(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function zz(e,t,a){return t&&zi(e.prototype,t),a&&zi(e,a),e}var jg=function(){function e(){xz(this,e)}return zz(e,[{key:"BeginContact",value:function(e){}},{key:"EndContact",value:function(e){}},{key:"PreSolve",value:function(e,t){}},{key:"PostSolve",value:function(e,t){}}]),e}();jg.b2_defaultListener=new jg;function Bz(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function si(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Dz(e,r,t){return r&&si(e.prototype,r),t&&si(e,t),e}function Ez(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function pi(e,a){for(var r=0;r<a.length;r++){var t=a[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function Gz(e,a,r){return a&&pi(e.prototype,a),r&&pi(e,r),e}function Hz(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function ei(e,r){for(var a=0;a<r.length;a++){var $=r[a];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function Jz(e,r,a){return r&&ei(e.prototype,r),a&&ei(e,a),e}var Kz=function(){function e(){Hz(this,e),this.aabb=new Ha}return Jz(e,[{key:"IsLeaf",value:function(){return null==this.child1}}]),e}();function Lz(t,$){if(!(t instanceof $))throw new TypeError("Cannot call a class as a function")}var rh=function t(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new k,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new k,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Lz(this,t),this.p1=$,this.p2=a,this.maxFraction=e};var Nz=function(){function e(){Ez(this,e),this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0}return Gz(e,[{key:"CreateProxy",value:function(e,a){var r=this.AllocateNode(),t=Od,o=Od;return r.aabb.lowerBound.x=e.lowerBound.x-t,r.aabb.lowerBound.y=e.lowerBound.y-o,r.aabb.upperBound.x=e.upperBound.x+t,r.aabb.upperBound.y=e.upperBound.y+o,r.userData=a,this.InsertLeaf(r),r}},{key:"DestroyProxy",value:function(e){this.RemoveLeaf(e),this.FreeNode(e)}},{key:"MoveProxy",value:function(e,a,r){if(aa(e.IsLeaf()),e.aabb.Contains(a))return!1;this.RemoveLeaf(e);var t=Od+am*(r.x>0?r.x:-r.x),o=Od+am*(r.y>0?r.y:-r.y);return e.aabb.lowerBound.x=a.lowerBound.x-t,e.aabb.lowerBound.y=a.lowerBound.y-o,e.aabb.upperBound.x=a.upperBound.x+t,e.aabb.upperBound.y=a.upperBound.y+o,this.InsertLeaf(e),!0}},{key:"Rebalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.m_root)for(var a=0;a<e;a++){for(var r=this.m_root,t=0;!r.IsLeaf();)r=this.m_path>>t&1?r.child2:r.child1,t=t+1&31;++this.m_path,this.RemoveLeaf(r),this.InsertLeaf(r)}}},{key:"GetFatAABB",value:function(e){return e.aabb}},{key:"GetUserData",value:function(e){return e.userData}},{key:"Query",value:function(e,a){if(this.m_root){var r=[],t=0;for(r[t++]=this.m_root;t>0;){var o=r[--t];if(o.aabb.TestOverlap(a))if(o.IsLeaf()){if(!e(o))return}else r[t++]=o.child1,r[t++]=o.child2}}}},{key:"RayCast",value:function(e,a){if(this.m_root){var r=a.p1,t=a.p2,o=z(r,t);o.Normalize();var i=id(1,o),n=yx(i),u=a.maxFraction,l=new Ha,b=0,s=0;b=r.x+u*(t.x-r.x),s=r.y+u*(t.y-r.y),l.lowerBound.x=Math.min(r.x,b),l.lowerBound.y=Math.min(r.y,s),l.upperBound.x=Math.max(r.x,b),l.upperBound.y=Math.max(r.y,s);var p=[],h=0;for(p[h++]=this.m_root;h>0;){var $=p[--h];if(!1!==$.aabb.TestOverlap(l)){var d=$.aabb.GetCenter(),c=$.aabb.GetExtents();if(!(Math.abs(i.x*(r.x-d.x)+i.y*(r.y-d.y))-n.x*c.x-n.y*c.y>0))if($.IsLeaf()){var f=new rh;if(f.p1=a.p1,f.p2=a.p2,f.maxFraction=a.maxFraction,0===(u=e(f,$)))return;u>0&&(b=r.x+u*(t.x-r.x),s=r.y+u*(t.y-r.y),l.lowerBound.x=Math.min(r.x,b),l.lowerBound.y=Math.min(r.y,s),l.upperBound.x=Math.max(r.x,b),l.upperBound.y=Math.max(r.y,s))}else p[h++]=$.child1,p[h++]=$.child2}}}}},{key:"AllocateNode",value:function(){if(this.m_freeList){var e=this.m_freeList;return this.m_freeList=e.parent,e.parent=null,e.child1=null,e.child2=null,e}return new Kz}},{key:"FreeNode",value:function(e){e.parent=this.m_freeList,this.m_freeList=e}},{key:"InsertLeaf",value:function(e){if(++this.m_insertionCount,null==this.m_root)return this.m_root=e,void(this.m_root.parent=null);var a=e.aabb.GetCenter(),r=this.m_root;if(!1===r.IsLeaf())do{var t=r.child1,o=r.child2;r=Math.abs((t.aabb.lowerBound.x+t.aabb.upperBound.x)/2-a.x)+Math.abs((t.aabb.lowerBound.y+t.aabb.upperBound.y)/2-a.y)<Math.abs((o.aabb.lowerBound.x+o.aabb.upperBound.x)/2-a.x)+Math.abs((o.aabb.lowerBound.y+o.aabb.upperBound.y)/2-a.y)?t:o}while(!r.IsLeaf());var i=r.parent,n=this.AllocateNode();if(n.parent=i,n.userData=null,n.aabb.Combine(e.aabb,r.aabb),i){r.parent.child1===r?i.child1=n:i.child2=n,n.child1=r,n.child2=e,r.parent=n,e.parent=n;do{if(i.aabb.Contains(n.aabb))break;i.aabb.Combine(i.child1.aabb,i.child2.aabb),n=i,i=i.parent}while(i)}else n.child1=r,n.child2=e,r.parent=n,e.parent=n,this.m_root=n}},{key:"RemoveLeaf",value:function(e){if(e!==this.m_root){var a,r=e.parent,t=r.parent;if(a=r.child1===e?r.child2:r.child1,t)for(t.child1===r?t.child1=a:t.child2=a,a.parent=t,this.FreeNode(r);t;){var o=t.aabb;if(t.aabb=Ha.Combine(t.child1.aabb,t.child2.aabb),o.Contains(t.aabb))break;t=t.parent}else this.m_root=a,a.parent=null,this.FreeNode(r)}else this.m_root=null}}]),e}();function Oz(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function")}var Pz=function a(){Oz(this,a)};var Qz=function(){function e(){Bz(this,e),this.m_tree=new Nz,this.m_moveBuffer=[],this.m_pairBuffer=[],this.m_pairCount=0,this.m_proxyCount=0}return Dz(e,[{key:"CreateProxy",value:function(e,r){var t=this.m_tree.CreateProxy(e,r);return++this.m_proxyCount,this.BufferMove(t),t}},{key:"DestroyProxy",value:function(e){this.UnBufferMove(e),--this.m_proxyCount,this.m_tree.DestroyProxy(e)}},{key:"MoveProxy",value:function(e,r,t){this.m_tree.MoveProxy(e,r,t)&&this.BufferMove(e)}},{key:"TestOverlap",value:function(e,r){var t=this.m_tree.GetFatAABB(e),a=this.m_tree.GetFatAABB(r);return t.TestOverlap(a)}},{key:"GetUserData",value:function(e){return this.m_tree.GetUserData(e)}},{key:"GetFatAABB",value:function(e){return this.m_tree.GetFatAABB(e)}},{key:"GetProxyCount",value:function(){return this.m_proxyCount}},{key:"UpdatePairs",value:function(e){var r=this;this.m_pairCount=0;var t=!0,a=!1,o=void 0;try{for(var i,n=function(){var e=i.value,t=r.m_tree.GetFatAABB(e);r.m_tree.Query(function(t){if(t===e)return!0;r.m_pairCount===r.m_pairBuffer.length&&(r.m_pairBuffer[r.m_pairCount]=new Pz);var a=r.m_pairBuffer[r.m_pairCount];return a.proxyA=t<e?t:e,a.proxyB=t>=e?t:e,++r.m_pairCount,!0},t)},u=this.m_moveBuffer[Symbol.iterator]();!(t=(i=u.next()).done);t=!0)n()}catch(m){a=!0,o=m}finally{try{t||null==u.return||u.return()}finally{if(a)throw o}}this.m_moveBuffer.length=0;for(var f=0;f<this.m_pairCount;){var s=this.m_pairBuffer[f];for(e(this.m_tree.GetUserData(s.proxyA),this.m_tree.GetUserData(s.proxyB)),++f;f<this.m_pairCount;){var v=this.m_pairBuffer[f];if(v.proxyA!==s.proxyA||v.proxyB!==s.proxyB)break;++f}}}},{key:"Query",value:function(e,r){this.m_tree.Query(e,r)}},{key:"RayCast",value:function(e,r){this.m_tree.RayCast(e,r)}},{key:"Validate",value:function(){}},{key:"Rebalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_tree.Rebalance(e)}},{key:"BufferMove",value:function(e){this.m_moveBuffer[this.m_moveBuffer.length]=e}},{key:"UnBufferMove",value:function(e){var r=parseInt("".concat(this.m_moveBuffer.indexOf(e)),10);this.m_moveBuffer.splice(r,1)}},{key:"ComparePairs",value:function(e,r){return 0}}]),e}();function Rz(c,$){if(!(c instanceof $))throw new TypeError("Cannot call a class as a function")}function Sz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oh(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function Uz(e,t,r){return t&&oh(e.prototype,t),r&&oh(e,r),e}function Vz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xz(e,t,i){return t&&lh(e.prototype,t),i&&lh(e,i),e}var Yz=function(){function e(){Vz(this,e),this._referenceEdge=0,this._incidentEdge=0,this._incidentVertex=0,this._flip=0}return Xz(e,[{key:"referenceEdge",get:function(){return this._referenceEdge},set:function(e){this._referenceEdge!==e&&(this._referenceEdge=e,this.m_id.key=4294967040&this.m_id.key|255&this._referenceEdge)}},{key:"incidentEdge",get:function(){return this._incidentEdge},set:function(e){this._incidentEdge!==e&&(this._incidentEdge=e,this.m_id.key=4294902015&this.m_id.key|this._incidentEdge<<8&65280)}},{key:"incidentVertex",get:function(){return this._incidentVertex},set:function(e){this._incidentVertex!==e&&(this._incidentVertex=e,this.m_id.key=4278255615&this.m_id.key|this._incidentVertex<<16&16711680)}},{key:"flip",get:function(){return this._flip},set:function(e){this._flip!==e&&(this._flip=e,this.m_id.key=16777215&this.m_id.key|this._flip<<24&4278190080)}}]),e}();var kg=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Yz;Sz(this,e),this.features=t,this._key=0,this.features.m_id=this}return Uz(e,[{key:"Set",value:function(e){this.key=e.key}},{key:"Copy",value:function(){var t=new e;return t.key=this.key,t}},{key:"key",get:function(){return this._key},set:function(e){this._key!==e&&(this._key=e,this.features.referenceEdge=255&this._key,this.features.incidentEdge=(65280&this._key)>>8&255,this.features.incidentVertex=(16711680&this._key)>>16&255,this.features.flip=(4278190080&this._key)>>24&255)}}]),e}();var $z=function c(){Rz(this,c),this.position=new k,this.velocity=new k,this.normal=new k,this.id=new kg};function _z(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hh(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function bA(e,t,r){return t&&hh(e.prototype,t),r&&hh(e,r),e}function cA(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var dA=function a(){cA(this,a),this.poolCount=0};function eA(e){return(eA="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function fh(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function hA(e,t,r){return t&&fh(e.prototype,t),r&&fh(e,r),e}function iA(e,t){return!t||"object"!==eA(t)&&"function"!=typeof t?jA(e):t}function jA(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kA(e){return(kA=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lA(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mA(e,t)}function mA(e,t){return(mA=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function nA(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bh(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pA(e,t,i){return t&&bh(e.prototype,t),i&&bh(e,i),e}function qA(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}var ah=function a(){qA(this,a)};function sA(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function Vm(o,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,r.key,r)}}function uA(o,t,e){return t&&Vm(o.prototype,t),e&&Vm(o,e),o}function vA(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sm(t,e){for(var l=0;l<e.length;l++){var a=e[l];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function xA(t,e,l){return e&&Sm(t.prototype,e),l&&Sm(t,l),t}var lg=function(){function t(){vA(this,t),this.m_localPoint=new k,this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id=new kg,this.Reset()}return xA(t,[{key:"Reset",value:function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0}},{key:"Set",value:function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)}}]),t}();var G=function(){function o(){sA(this,o),this.m_pointCount=0,this.m_points=new Array(ba),this.m_localPlaneNormal=new k,this.m_localPoint=new k,this.m_type=0;for(var t=0;t<ba;t++)this.m_points[t]=new lg}return uA(o,[{key:"Reset",value:function(){for(var o=0;o<ba;o++)(this.m_points[o]instanceof lg?this.m_points[o]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0}},{key:"Set",value:function(o){this.m_pointCount=o.m_pointCount;for(var t=0;t<ba;t++)(this.m_points[t]instanceof lg?this.m_points[t]:null).Set(o.m_points[t]);this.m_localPlaneNormal.SetV(o.m_localPlaneNormal),this.m_localPoint.SetV(o.m_localPoint),this.m_type=o.m_type}},{key:"Copy",value:function(){var t=new o;return t.Set(this),t}}]),o}();G.e_circles=1,G.e_faceA=2,G.e_faceB=4;function AA(e,$){if(!(e instanceof $))throw new TypeError("Cannot call a class as a function")}var BA=function e(){AA(this,e),this.proxyA=new Db,this.proxyB=new Db,this.sweepA=new db,this.sweepB=new db,this.tolerance=1};function CA(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function km(t,i){for(var o=0;o<i.length;o++){var e=i[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function EA(t,i,o){return i&&km(t.prototype,i),o&&km(t,o),t}var ge=function(){function t(){CA(this,t),this.m_localPoint=new k,this.m_axis=new k,this.m_type=t.e_points}return EA(t,[{key:"Initialize",value:function(i,o,e,x,c){this.m_proxyA=o,this.m_proxyB=x;var r,s,n,$,l,y,a=parseInt("".concat(i.count),10);aa(0<a&&a<3);var m,p,_=0,h=0,B=0,u=0,I=0,V=0,f=0;if(1===a)this.m_type=t.e_points,r=this.m_proxyA.GetVertex(i.indexA[0]),$=this.m_proxyB.GetVertex(i.indexB[0]),p=r,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),this.m_axis.x=B-_,this.m_axis.y=u-h,this.m_axis.Normalize();else if(i.indexB[0]===i.indexB[1])this.m_type=t.e_faceA,s=this.m_proxyA.GetVertex(i.indexA[0]),n=this.m_proxyA.GetVertex(i.indexA[1]),$=this.m_proxyB.GetVertex(i.indexB[0]),this.m_localPoint.x=.5*(s.x+n.x),this.m_localPoint.y=.5*(s.y+n.y),this.m_axis=gb(z(n,s),1),this.m_axis.Normalize(),p=this.m_axis,I=(m=e.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,(f=((B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y))-_)*I+((u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y))-h)*V)<0&&this.m_axis.NegativeSelf();else if(i.indexA[0]==i.indexA[0])this.m_type=t.e_faceB,l=this.m_proxyB.GetVertex(i.indexB[0]),y=this.m_proxyB.GetVertex(i.indexB[1]),r=this.m_proxyA.GetVertex(i.indexA[0]),this.m_localPoint.x=.5*(l.x+y.x),this.m_localPoint.y=.5*(l.y+y.y),this.m_axis=gb(z(y,l),1),this.m_axis.Normalize(),p=this.m_axis,I=(m=c.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=r,m=e.R,(f=((_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y))-B)*I+((h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y))-u)*V)<0&&this.m_axis.NegativeSelf();else{s=this.m_proxyA.GetVertex(i.indexA[0]),n=this.m_proxyA.GetVertex(i.indexA[1]),l=this.m_proxyB.GetVertex(i.indexB[0]),y=this.m_proxyB.GetVertex(i.indexB[1]);var v=fb(e.R,z(n,s)),d=fb(c.R,z(y,l)),A=v.x*v.x+v.y*v.y,M=d.x*d.x+d.y*d.y,R=z(d,v),G=v.x*R.x+v.y*R.y,P=d.x*R.x+d.y*R.y,S=v.x*d.x+v.y*d.y,b=A*M-S*S;f=0,0!==b&&(f=ia((S*P-G*M)/b,0,1));var C=(S*f+P)/M;C<0&&(C=0,f=ia((S-G)/A,0,1)),(r=new k).x=s.x+f*(n.x-s.x),r.y=s.y+f*(n.y-s.y),($=new k).x=l.x+f*(y.x-l.x),$.y=l.y+f*(y.y-l.y),0===f||1===f?(this.m_type=t.e_faceB,this.m_axis=gb(z(y,l),1),this.m_axis.Normalize(),this.m_localPoint=$,p=this.m_axis,I=(m=c.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=r,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),f<0&&this.m_axis.NegativeSelf()):(this.m_type=t.e_faceA,this.m_axis=gb(z(n,s),1),this.m_localPoint=r,p=this.m_axis,I=(m=e.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),f<0&&this.m_axis.NegativeSelf())}}},{key:"Evaluate",value:function(i,o){if(!this.m_proxyA||!this.m_proxyB)return 0;var e,x,c,r,s,n,$;switch(this.m_type){case t.e_points:return e=Da(i.R,this.m_axis),x=Da(o.R,this.m_axis.GetNegative()),c=this.m_proxyA.GetSupportVertex(e),r=this.m_proxyB.GetSupportVertex(x),s=B(i,c),((n=B(o,r)).x-s.x)*this.m_axis.x+(n.y-s.y)*this.m_axis.y;case t.e_faceA:return $=fb(i.R,this.m_axis),s=B(i,this.m_localPoint),x=Da(o.R,$.GetNegative()),r=this.m_proxyB.GetSupportVertex(x),((n=B(o,r)).x-s.x)*$.x+(n.y-s.y)*$.y;case t.e_faceB:return $=fb(o.R,this.m_axis),n=B(o,this.m_localPoint),e=Da(i.R,$.GetNegative()),c=this.m_proxyA.GetSupportVertex(e),((s=B(i,c)).x-n.x)*$.x+(s.y-n.y)*$.y;default:return aa(!1),0;}}}]),t}();ge.e_points=1,ge.e_faceA=2,ge.e_faceB=4;var GA=0;var HA=0;var IA=0;var JA=0;var KA=0;var ng=new Sj;var Jb=new $j;var Ba=new $;var za=new $;var vd=new ge;var Jk=new Uj;function RA($){++GA;var t=$.proxyA,a=$.proxyB,r=$.sweepA,e=$.sweepB;aa(r.t0===e.t0),aa(1-r.t0>Number.MIN_VALUE);var o=t.m_radius+a.m_radius,b=$.tolerance,s=0,p=0,x=0;for(ng.count=0,Jb.useRadii=!1;;){if(r.GetTransform(Ba,s),e.GetTransform(za,s),Jb.proxyA=t,Jb.proxyB=a,Jb.transformA=Ba,Jb.transformB=za,uj(Jk,ng,Jb),Jk.distance<=0){s=1;break}vd.Initialize(ng,t,Ba,a,za);var R=vd.Evaluate(Ba,za);if(R<=0){s=1;break}if(0===p&&(x=R>o?vc(o-b,.75*o):vc(R-b,.02*o)),R-x<.5*b){if(0===p){s=1;break}break}var k=s,i=s,_=1,n=R;r.GetTransform(Ba,_),e.GetTransform(za,_);var c=vd.Evaluate(Ba,za);if(c>=x){s=1;break}for(var f=0;;){var u=0;u=1&f?i+(x-n)*(_-i)/(c-n):.5*(i+_),r.GetTransform(Ba,u),e.GetTransform(za,u);var m=vd.Evaluate(Ba,za);if(Pf(m-x)<.025*b){k=u;break}if(m>x?(i=u,n=m):(_=u,c=m),++f,++JA,50===f)break}if(KA=vc(KA,f),k<(1+100*Number.MIN_VALUE)*s)break;if(s=k,p++,++HA,1e3===p)break}return IA=vc(IA,p),s}var A=function(){function e(){nA(this,e),this.m_nodeA=new ah,this.m_nodeB=new ah,this.m_manifold=new G,this.m_oldManifold=new G,this.m_flags=0,this.m_toi=1}return pA(e,[{key:"GetManifold",value:function(){return this.m_manifold}},{key:"GetWorldManifold",value:function(e){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();t&&i&&n&&a&&e.Initialize(this.m_manifold,t.GetTransform(),n.m_radius,i.GetTransform(),a.m_radius)}}},{key:"IsTouching",value:function(){return(this.m_flags&e.e_touchingFlag)===e.e_touchingFlag}},{key:"IsContinuous",value:function(){return(this.m_flags&e.e_continuousFlag)===e.e_continuousFlag}},{key:"SetSensor",value:function(t){t?this.m_flags|=e.e_sensorFlag:this.m_flags&=~e.e_sensorFlag}},{key:"IsSensor",value:function(){return(this.m_flags&e.e_sensorFlag)===e.e_sensorFlag}},{key:"SetEnabled",value:function(t){t?this.m_flags|=e.e_enabledFlag:this.m_flags&=~e.e_enabledFlag}},{key:"IsEnabled",value:function(){return(this.m_flags&e.e_enabledFlag)===e.e_enabledFlag}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetFixtureA",value:function(){return this.m_fixtureA}},{key:"GetFixtureB",value:function(){return this.m_fixtureB}},{key:"FlagForFiltering",value:function(){this.m_flags|=e.e_filterFlag}},{key:"Reset",value:function(t,i){if(this.m_flags=e.e_enabledFlag,!t||!i)return this.m_fixtureA=void 0,void(this.m_fixtureB=void 0);(t.IsSensor()||i.IsSensor())&&(this.m_flags|=e.e_sensorFlag);var n=t.GetBody(),a=i.GetBody();n&&a&&((n.GetType()!==j.b2_dynamicBody||n.IsBullet()||a.GetType()!==j.b2_dynamicBody||a.IsBullet())&&(this.m_flags|=e.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=i,this.m_manifold.m_pointCount=0,this.m_prev=void 0,this.m_next=void 0,this.m_nodeA.contact=void 0,this.m_nodeA.prev=void 0,this.m_nodeA.next=void 0,this.m_nodeA.other=void 0,this.m_nodeB.contact=void 0,this.m_nodeB.prev=void 0,this.m_nodeB.next=void 0,this.m_nodeB.other=void 0)}},{key:"Update",value:function(t){var i=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=i,this.m_flags|=e.e_enabledFlag;var n=!1,a=(this.m_flags&e.e_touchingFlag)===e.e_touchingFlag;if(this.m_fixtureA&&this.m_fixtureB){var o=this.m_fixtureA.m_body,s=this.m_fixtureB.m_body;if(o&&s){var r=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&e.e_sensorFlag){if(r){var l=this.m_fixtureA.GetShape(),u=this.m_fixtureB.GetShape();if(!l||!u)return;var _=o.GetTransform(),m=s.GetTransform();n=q.TestOverlap(l,_,u,m)}this.m_manifold.m_pointCount=0}else{if(o.GetType()!==j.b2_dynamicBody||o.IsBullet()||s.GetType()!==j.b2_dynamicBody||s.IsBullet()?this.m_flags|=e.e_continuousFlag:this.m_flags&=~e.e_continuousFlag,r){this.Evaluate(),n=this.m_manifold.m_pointCount>0;for(var h=0;h<this.m_manifold.m_pointCount;++h){var f=this.m_manifold.m_points[h];f.m_normalImpulse=0,f.m_tangentImpulse=0;for(var d=f.m_id,$=0;$<this.m_oldManifold.m_pointCount;++$){var p=this.m_oldManifold.m_points[$];if(p.m_id.key===d.key){f.m_normalImpulse=p.m_normalImpulse,f.m_tangentImpulse=p.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;n!==a&&(o.SetAwake(!0),s.SetAwake(!0))}n?this.m_flags|=e.e_touchingFlag:this.m_flags&=~e.e_touchingFlag,!1===a&&!0===n&&t.BeginContact(this),!0===a&&!1===n&&t.EndContact(this),0==(this.m_flags&e.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)}}}},{key:"Evaluate",value:function(){}},{key:"ComputeTOI",value:function(t,i){if(!this.m_fixtureA||!this.m_fixtureB)return 0;var n=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();return n&&a?(e.s_input.proxyA.Set(n),e.s_input.proxyB.Set(a),e.s_input.sweepA=t,e.s_input.sweepB=i,e.s_input.tolerance=fa,RA(e.s_input)):0}}]),e}();A.e_sensorFlag=1,A.e_continuousFlag=2,A.e_islandFlag=4,A.e_toiFlag=8,A.e_touchingFlag=16,A.e_enabledFlag=32,A.e_filterFlag=64,A.s_input=new BA;function TA(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function nk(e,r){for(var t=0;t<r.length;t++){var $=r[t];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function VA(e,r,t){return r&&nk(e.prototype,r),t&&nk(e,t),e}var ck=function(){function e(){TA(this,e),this.v=new k,this.id=new kg}return VA(e,[{key:"Set",value:function(e){this.v.SetV(e.v),this.id.Set(e.id)}}]),e}();var XA=tg();var YA=tg();var ZA=tg();var rg=new Array(1).fill(0);var sg=new Array(1).fill(0);var aB=new k;var bB=new k;var cB=new k;var dB=new k;var eB=new k;var fB=new k;var gB=new k;var hB=new k;var RD=new k;function gj(o,e,l){var t,$=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=0,n=(t=e[0]).v,i=(t=e[1]).v,x=l.x*n.x+l.y*n.y-$,a=l.x*i.x+l.y*i.y-$;if(x<=0&&o[r++].Set(e[0]),a<=0&&o[r++].Set(e[1]),x*a<0){var p,c=x/(x-a),s=(t=o[r]).v;s.x=n.x+c*(i.x-n.x),s.y=n.y+c*(i.y-n.y),t=o[r],x>0?(p=e[0],t.id=p.id):(p=e[1],t.id=p.id),++r}return r}function ae(o,e){var l,t,$=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=o.m_vertices,x=o.m_normals,a=parseInt("".concat(r.m_vertexCount),10),p=r.m_vertices;l=e.R,t=x[$];for(var c=l.col1.x*t.x+l.col2.x*t.y,s=l.col1.y*t.x+l.col2.y*t.y,_=(l=n.R).col1.x*c+l.col1.y*s,y=l.col2.x*c+l.col2.y*s,m=0,E=Number.MAX_VALUE,d=0;d<a;++d){var v=(t=p[d]).x*_+t.y*y;v<E&&(E=v,m=d)}t=i[$],l=e.R;var g=e.position.x+(l.col1.x*t.x+l.col2.x*t.y),u=e.position.y+(l.col1.y*t.x+l.col2.y*t.y);t=p[m],l=n.R;var f=n.position.x+(l.col1.x*t.x+l.col2.x*t.y),P=n.position.y+(l.col1.y*t.x+l.col2.y*t.y);return(f-=g)*c+(P-=u)*s}function Ti(){var o,e,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,$=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=parseInt("".concat(t.m_vertexCount),10),x=t.m_normals;e=n.R,o=r.m_centroid;var a=n.position.x+(e.col1.x*o.x+e.col2.x*o.y),p=n.position.y+(e.col1.y*o.x+e.col2.y*o.y);e=$.R,o=t.m_centroid,a-=$.position.x+(e.col1.x*o.x+e.col2.x*o.y),p-=$.position.y+(e.col1.y*o.x+e.col2.y*o.y);for(var c=a*$.R.col1.x+p*$.R.col1.y,s=a*$.R.col2.x+p*$.R.col2.y,_=0,y=-Number.MAX_VALUE,m=0;m<i;++m){var E=(o=x[m]).x*c+o.y*s;E>y&&(y=E,_=m)}var d=ae(t,$,_,r,n),v=parseInt("".concat(_-1>=0?_-1:i-1),10),g=ae(t,$,v,r,n),u=parseInt("".concat(_+1<i?_+1:0),10),f=ae(t,$,u,r,n),P=0,C=0,V=0;if(g>d&&g>f)P=-1,C=v,V=g;else{if(!(f>d))return l[0]=_,d;P=1,C=u,V=f}for(;(d=ae(t,$,_=-1===P?C-1>=0?C-1:i-1:C+1<i?C+1:0,r,n))>V;)C=_,V=d;return l[0]=C,V}function mB(o,e,l){var t,$,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,x=e.m_normals,a=parseInt("".concat(n.m_vertexCount),10),p=n.m_vertices,c=n.m_normals;t=l.R,$=x[r];var s=t.col1.x*$.x+t.col2.x*$.y,_=t.col1.y*$.x+t.col2.y*$.y,y=(t=i.R).col1.x*s+t.col1.y*_;_=t.col2.x*s+t.col2.y*_,s=y;for(var m,E=0,d=Number.MAX_VALUE,v=0;v<a;++v){var g=s*($=c[v]).x+_*$.y;g<d&&(d=g,E=v)}var u=parseInt("".concat(E),10),f=parseInt("".concat(u+1<a?u+1:0),10);m=o[0],$=p[u],t=i.R,m.v.x=i.position.x+(t.col1.x*$.x+t.col2.x*$.y),m.v.y=i.position.y+(t.col1.y*$.x+t.col2.y*$.y),m.id.features.referenceEdge=r,m.id.features.incidentEdge=u,m.id.features.incidentVertex=0,m=o[1],$=p[f],t=i.R,m.v.x=i.position.x+(t.col1.x*$.x+t.col2.x*$.y),m.v.y=i.position.y+(t.col1.y*$.x+t.col2.y*$.y),m.id.features.referenceEdge=r,m.id.features.incidentEdge=f,m.id.features.incidentVertex=1}function tg(){return[new ck,new ck]}function oB(o,e,l,t,$){var r;o.m_pointCount=0;var n=e.m_radius+t.m_radius,i=0;rg[0]=i;var x=Ti(rg,e,l,t,$);if(i=rg[0],!(x>n)){var a=0;sg[0]=a;var p=Ti(sg,t,$,e,l);if(a=sg[0],!(p>n)){var c,s,_,y,m,E=0,d=0;p>.98*x+.001?(c=t,s=e,_=$,y=l,E=a,o.m_type=G.e_faceB,d=1):(c=e,s=t,_=l,y=$,E=i,o.m_type=G.e_faceA,d=0);var v=XA;mB(v,c,_,E,s,y);var g,u=parseInt("".concat(c.m_vertexCount),10),f=c.m_vertices,P=f[E];g=E+1<u?f[parseInt("".concat(E+1),10)]:f[0];var C=aB;C.Set(g.x-P.x,g.y-P.y),C.Normalize();var V=bB;V.x=C.y,V.y=-C.x;var S=cB;S.Set(.5*(P.x+g.x),.5*(P.y+g.y));var N=eB;m=_.R,N.x=m.col1.x*C.x+m.col2.x*C.y,N.y=m.col1.y*C.x+m.col2.y*C.y;var A=fB;A.x=-N.x,A.y=-N.y;var M=dB;M.x=N.y,M.y=-N.x;var R=gB,I=hB;R.x=_.position.x+(m.col1.x*P.x+m.col2.x*P.y),R.y=_.position.y+(m.col1.y*P.x+m.col2.y*P.y),I.x=_.position.x+(m.col1.x*g.x+m.col2.x*g.y),I.y=_.position.y+(m.col1.y*g.x+m.col2.y*g.y);var O=M.x*R.x+M.y*R.y,T=-N.x*R.x-N.y*R.y+n,h=N.x*I.x+N.y*I.y+n,w=YA,b=ZA;if(!(gj(w,v,A,T)<2||gj(b,w,N,h)<2)){o.m_localPlaneNormal.SetV(V),o.m_localPoint.SetV(S);for(var F=0,k=0;k<ba;++k){if(r=b[k],M.x*r.v.x+M.y*r.v.y-O<=n){var L=o.m_points[F];m=y.R;var B=r.v.x-y.position.x,U=r.v.y-y.position.y;L.m_localPoint.x=B*m.col1.x+U*m.col1.y,L.m_localPoint.y=B*m.col2.x+U*m.col2.y,L.m_id.Set(r.id),L.m_id.features.flip=d,++F}}o.m_pointCount=F}}}}function pB(o,e,l,t,$){var r,n;o.m_pointCount=0,r=l.R,n=e.m_p;var i=l.position.x+(r.col1.x*n.x+r.col2.x*n.y),x=l.position.y+(r.col1.y*n.x+r.col2.y*n.y);r=$.R,n=t.m_p;var a=$.position.x+(r.col1.x*n.x+r.col2.x*n.y)-i,p=$.position.y+(r.col1.y*n.x+r.col2.y*n.y)-x,c=a*a+p*p,s=e.m_radius+t.m_radius;c>s*s||(o.m_type=G.e_circles,o.m_localPoint.SetV(e.m_p),o.m_localPlaneNormal.SetZero(),o.m_pointCount=1,o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0)}function qB(o,e,l,t,$){o.m_pointCount=0;var r,n,i=0,x=0;n=$.R,r=t.m_p;var a=$.position.x+(n.col1.x*r.x+n.col2.x*r.y),p=$.position.y+(n.col1.y*r.x+n.col2.y*r.y);i=a-l.position.x,x=p-l.position.y;for(var c=i*(n=l.R).col1.x+x*n.col1.y,s=i*n.col2.x+x*n.col2.y,_=0,y=-Number.MAX_VALUE,m=e.m_radius+t.m_radius,E=parseInt("".concat(e.m_vertexCount),10),d=e.m_vertices,v=e.m_normals,g=0;g<E;++g){i=c-(r=d[g]).x,x=s-r.y;var u=(r=v[g]).x*i+r.y*x;if(u>m)return;u>y&&(y=u,_=g)}var f=parseInt("".concat(_),10),P=parseInt("".concat(f+1<E?f+1:0),10),C=d[f],V=d[P];if(y<Number.MIN_VALUE)return o.m_pointCount=1,o.m_type=G.e_faceA,o.m_localPlaneNormal.SetV(v[_]),o.m_localPoint.x=.5*(C.x+V.x),o.m_localPoint.y=.5*(C.y+V.y),o.m_points[0].m_localPoint.SetV(t.m_p),void(o.m_points[0].m_id.key=0);var S=(c-C.x)*(V.x-C.x)+(s-C.y)*(V.y-C.y),N=(c-V.x)*(C.x-V.x)+(s-V.y)*(C.y-V.y);if(S<=0){if((c-C.x)*(c-C.x)+(s-C.y)*(s-C.y)>m*m)return;o.m_pointCount=1,o.m_type=G.e_faceA,o.m_localPlaneNormal.x=c-C.x,o.m_localPlaneNormal.y=s-C.y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.SetV(C),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}else if(N<=0){if((c-V.x)*(c-V.x)+(s-V.y)*(s-V.y)>m*m)return;o.m_pointCount=1,o.m_type=G.e_faceA,o.m_localPlaneNormal.x=c-V.x,o.m_localPlaneNormal.y=s-V.y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.SetV(V),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}else{var A=.5*(C.x+V.x),M=.5*(C.y+V.y);if((y=(c-A)*v[f].x+(s-M)*v[f].y)>m)return;o.m_pointCount=1,o.m_type=G.e_faceA,o.m_localPlaneNormal.x=v[f].x,o.m_localPlaneNormal.y=v[f].y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.Set(A,M),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}}function rB(t){return(rB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function sB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Li(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function uB(t,e,r){return e&&Li(t.prototype,e),r&&Li(t,r),t}function vB(t,e){return!e||"object"!==rB(e)&&"function"!=typeof e?wB(t):e}function wB(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xB(t,e,r){return(xB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=yB(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function yB(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=vg(t)););return t}function vg(t){return(vg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function AB(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&BB(t,e)}function BB(t,e){return(BB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Nb=function(t){function e(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return sB(this,e),(t=vB(this,vg(e).call(this))).m_radius=r,t.m_p=new k,t.m_type=q.e_circleShape,t}return AB(e,q),uB(e,[{key:"Copy",value:function(){var t=new e;return t.Set(this),t}},{key:"Set",value:function(t){xB(vg(e.prototype),"Set",this).call(this,t),t instanceof e&&this.m_p.SetV(t.m_p)}},{key:"TestPoint",value:function(t,e){var r=t.R,n=t.position.x+(r.col1.x*this.m_p.x+r.col2.x*this.m_p.y),o=t.position.y+(r.col1.y*this.m_p.x+r.col2.y*this.m_p.y);return(n=e.x-n)*n+(o=e.y-o)*o<=this.m_radius*this.m_radius}},{key:"RayCast",value:function(t,e,r){var n=r.R,o=r.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),i=r.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),a=e.p1.x-o,s=e.p1.y-i,u=a*a+s*s-this.m_radius*this.m_radius,$=e.p2.x-e.p1.x,p=e.p2.y-e.p1.y,c=a*$+s*p,l=$*$+p*p,_=c*c-l*u;if(_<0||l<Number.MIN_VALUE)return!1;var f=-(c+Math.sqrt(_));return 0<=f&&f<=e.maxFraction*l&&(f/=l,t.fraction=f,t.normal.x=a+f*$,t.normal.y=s+f*p,t.normal.Normalize(),!0)}},{key:"ComputeAABB",value:function(t,e){var r=e.R,n=e.position.x+(r.col1.x*this.m_p.x+r.col2.x*this.m_p.y),o=e.position.y+(r.col1.y*this.m_p.x+r.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,o-this.m_radius),t.upperBound.Set(n+this.m_radius,o+this.m_radius)}},{key:"ComputeMass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.mass=e*Qf*this.m_radius*this.m_radius,t.center.SetV(this.m_p),t.I=t.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))}},{key:"ComputeSubmergedArea",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=B(r,this.m_p),i=-(F(t,o)-e);if(i<-this.m_radius+Number.MIN_VALUE)return 0;if(i>this.m_radius)return n.SetV(o),Math.PI*this.m_radius*this.m_radius;var a=this.m_radius*this.m_radius,s=i*i,u=a*(Math.asin(i/this.m_radius)+Math.PI/2)+i*Math.sqrt(a-s),$=-2/3*Math.pow(a-s,1.5)/u;return n.x=o.x+t.x*$,n.y=o.y+t.y*$,u}},{key:"GetLocalPosition",value:function(){return this.m_p}},{key:"SetLocalPosition",value:function(t){this.m_p.SetV(t)}},{key:"GetRadius",value:function(){return this.m_radius}},{key:"SetRadius",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_radius=t}}]),e}();var Ci=function(e){function t(){return fA(this,t),iA(this,kA(t).apply(this,arguments))}return lA(t,A),hA(t,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var e=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();e&&t&&r instanceof Nb&&o instanceof Nb&&pB(this.m_manifold,r,e.m_xf,o,t.m_xf)}}}],[{key:"Create",value:function(e){return new t}},{key:"Destroy",value:function(e,t){}}]),t}();function EB(e){return(EB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function FB(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wi(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function HB(e,t,r){return t&&wi(e.prototype,t),r&&wi(e,r),e}function IB(e,t){return!t||"object"!==EB(t)&&"function"!=typeof t?JB(e):t}function JB(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function KB(e){return(KB=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function LB(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&MB(e,t)}function MB(e,t){return(MB=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NB(t){return(NB="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function OB(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ui(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function QB(t,e,r){return e&&ui(t.prototype,e),r&&ui(t,r),t}function RB(t,e){return!e||"object"!==NB(e)&&"function"!=typeof e?SB(t):e}function SB(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function TB(t,e,r){return(TB="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=UB(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function UB(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Dg(t)););return t}function Dg(t){return(Dg=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function WB(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&XB(t,e)}function XB(t,e){return(XB=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Ja=function(t){function e(){var t;return OB(this,e),(t=RB(this,Dg(e).call(this))).m_centroid=new k,t.m_vertexCount=0,t.m_vertices=[],t.m_normals=[],t.m_type=q.e_polygonShape,t.m_centroid=new k,t.m_vertices=[],t.m_normals=[],t}return WB(e,q),QB(e,[{key:"Copy",value:function(){var t=new e;return t.Set(this),t}},{key:"Set",value:function(t){if(TB(Dg(e.prototype),"Set",this).call(this,t),t instanceof e){this.m_centroid.SetV(t.m_centroid),this.m_vertexCount=t.m_vertexCount,this.Reserve(this.m_vertexCount);for(var r=0;r<this.m_vertexCount;r++)this.m_vertices[r].SetV(t.m_vertices[r]),this.m_normals[r].SetV(t.m_normals[r])}}},{key:"SetAsArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.SetAsVector(t.slice(),e)}},{key:"SetAsVector",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===r&&(r=t.length),aa(2<=r),this.m_vertexCount=r,this.Reserve(r);for(var o=0;o<this.m_vertexCount;o++)this.m_vertices[o].SetV(t[o]);for(var i=0;i<this.m_vertexCount;++i){var n=parseInt("".concat(i),10),s=parseInt("".concat(i+1<this.m_vertexCount?i+1:0),10),a=z(this.m_vertices[s],this.m_vertices[n]);aa(a.LengthSquared()>Number.MIN_VALUE),this.m_normals[i].SetV(gb(a,1)),this.m_normals[i].Normalize()}this.m_centroid=e.ComputeCentroid(this.m_vertices,this.m_vertexCount)}},{key:"SetAsBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()}},{key:"SetAsOrientedBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new k,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=r;var i=new $;i.position=r,i.R.Set(o);for(var n=0;n<this.m_vertexCount;++n)this.m_vertices[n]=B(i,this.m_vertices[n]),this.m_normals[n]=fb(i.R,this.m_normals[n])}},{key:"SetAsEdge",value:function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=gb(z(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y}},{key:"TestPoint",value:function(t,e){for(var r,o=t.R,i=e.x-t.position.x,n=e.y-t.position.y,s=i*o.col1.x+n*o.col1.y,a=i*o.col2.x+n*o.col2.y,c=0;c<this.m_vertexCount;++c){if(i=s-(r=this.m_vertices[c]).x,n=a-r.y,(r=this.m_normals[c]).x*i+r.y*n>0)return!1}return!0}},{key:"RayCast",value:function(t,e,r){var o,i,n=0,s=e.maxFraction,a=0,c=0;a=e.p1.x-r.position.x,c=e.p1.y-r.position.y;var m=a*(o=r.R).col1.x+c*o.col1.y,v=a*o.col2.x+c*o.col2.y;a=e.p2.x-r.position.x,c=e.p2.y-r.position.y;for(var u=a*(o=r.R).col1.x+c*o.col1.y-m,$=a*o.col2.x+c*o.col2.y-v,l=parseInt("-1",10),h=0;h<this.m_vertexCount;++h){a=(i=this.m_vertices[h]).x-m,c=i.y-v;var _=(i=this.m_normals[h]).x*a+i.y*c,y=i.x*u+i.y*$;if(0===y){if(_<0)return!1}else y<0&&_<n*y?(n=_/y,l=h):y>0&&_<s*y&&(s=_/y);if(s<n-Number.MIN_VALUE)return!1}return l>=0&&(t.fraction=n,o=r.R,i=this.m_normals[l],t.normal.x=o.col1.x*i.x+o.col2.x*i.y,t.normal.y=o.col1.y*i.x+o.col2.y*i.y,!0)}},{key:"ComputeAABB",value:function(t,e){for(var r=e.R,o=this.m_vertices[0],i=e.position.x+(r.col1.x*o.x+r.col2.x*o.y),n=e.position.y+(r.col1.y*o.x+r.col2.y*o.y),s=i,a=n,c=1;c<this.m_vertexCount;++c){o=this.m_vertices[c];var m=e.position.x+(r.col1.x*o.x+r.col2.x*o.y),v=e.position.y+(r.col1.y*o.x+r.col2.y*o.y);i=i<m?i:m,n=n<v?n:v,s=s>m?s:m,a=a>v?a:v}t.lowerBound.x=i-this.m_radius,t.lowerBound.y=n-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius}},{key:"ComputeMass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(2===this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var r=0,o=0,i=0,n=0,s=0;s<this.m_vertexCount;++s){var a=this.m_vertices[s],c=s+1<this.m_vertexCount?this.m_vertices[parseInt("".concat(s+1),10)]:this.m_vertices[0],m=a.x-0,v=a.y-0,u=c.x-0,$=c.y-0,l=m*$-v*u,h=.5*l;i+=h,r+=h*(1/3)*(0+a.x+c.x),o+=h*(1/3)*(0+a.y+c.y);n+=l*(1/3*(.25*(m*m+u*m+u*u)+(0*m+0*u))+0+(1/3*(.25*(v*v+$*v+$*$)+(0*v+0*$))+0))}t.mass=e*i,r*=1/i,o*=1/i,t.center.Set(r,o),t.I=e*n}},{key:"ComputeSubmergedArea",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=Da(r.R,t),n=e-F(t,r.position),s=[],a=0,c=parseInt("".concat(-1),10),m=parseInt("".concat(-1),10),v=!1,u=0;u<this.m_vertexCount;++u){s[u]=F(i,this.m_vertices[u])-n;var $=s[u]<-Number.MIN_VALUE;u>0&&($?v||(c=u-1,a++):v&&(m=u-1,a++)),v=$}switch(a){case 0:if(v){var l=new ij;return this.ComputeMass(l,1),o.SetV(B(r,l.center)),l.mass}return 0;case 1:-1===c?c=this.m_vertexCount-1:m=this.m_vertexCount-1;}for(var h,_=parseInt("".concat((c+1)%this.m_vertexCount),10),y=parseInt("".concat((m+1)%this.m_vertexCount),10),p=(0-s[c])/(s[_]-s[c]),x=(0-s[m])/(s[y]-s[m]),f=new k(this.m_vertices[c].x*(1-p)+this.m_vertices[_].x*p,this.m_vertices[c].y*(1-p)+this.m_vertices[_].y*p),M=new k(this.m_vertices[m].x*(1-x)+this.m_vertices[y].x*x,this.m_vertices[m].y*(1-x)+this.m_vertices[y].y*x),E=0,j=new k,X=this.m_vertices[_],d=_;d!==y;){h=(d=(d+1)%this.m_vertexCount)===y?M:this.m_vertices[d];var S=.5*((X.x-f.x)*(h.y-f.y)-(X.y-f.y)*(h.x-f.x));E+=S,j.x+=S*(f.x+X.x+h.x)/3,j.y+=S*(f.y+X.y+h.y)/3,X=h}return j.Multiply(1/E),o.SetV(B(r,j)),E}},{key:"GetVertexCount",value:function(){return this.m_vertexCount}},{key:"GetVertices",value:function(){return this.m_vertices}},{key:"GetNormals",value:function(){return this.m_normals}},{key:"GetSupport",value:function(t){for(var e=0,r=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;o<this.m_vertexCount;++o){var i=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;i>r&&(e=o,r=i)}return e}},{key:"GetSupportVertex",value:function(t){for(var e=0,r=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;o<this.m_vertexCount;++o){var i=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;i>r&&(e=o,r=i)}return this.m_vertices[e]}},{key:"Validate",value:function(){return!1}},{key:"Reserve",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=parseInt("".concat(this.m_vertices.length),10);e<t;e++)this.m_vertices[e]=new k,this.m_normals[e]=new k}}],[{key:"ComputeCentroid",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new k,o=0,i=0;i<e;++i){var n=t[i],s=i+1<e?t[parseInt("".concat(i+1),10)]:t[0],a=n.x-0,c=n.y-0,m=s.x-0,v=.5*(a*(s.y-0)-c*m);o+=v,r.x+=v*(1/3)*(0+n.x+s.x),r.y+=v*(1/3)*(0+n.y+s.y)}return r.x*=1/o,r.y*=1/o,r}},{key:"ComputeOBB",value:function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=new Array(r+1),i=0;i<r;++i)o[i]=e[i];o[r]=o[0];for(var n=Number.MAX_VALUE,s=1;s<=r;++s){for(var a=o[parseInt("".concat(s-1),10)],c=o[s].x-a.x,m=o[s].y-a.y,v=Math.sqrt(c*c+m*m),u=-(m/=v),$=c/=v,l=Number.MAX_VALUE,h=Number.MAX_VALUE,_=-Number.MAX_VALUE,y=-Number.MAX_VALUE,p=0;p<r;++p){var x=o[p].x-a.x,f=o[p].y-a.y,M=c*x+m*f,E=u*x+$*f;M<l&&(l=M),E<h&&(h=E),M>_&&(_=M),E>y&&(y=E)}var j=(_-l)*(y-h);if(j<.95*n){n=j,t.R.col1.x=c,t.R.col1.y=m,t.R.col2.x=u,t.R.col2.y=$;var X=.5*(l+_),d=.5*(h+y),S=t.R;t.center.x=a.x+(S.col1.x*X+S.col2.x*d),t.center.y=a.y+(S.col1.y*X+S.col2.y*d),t.extents.x=.5*(_-l),t.extents.y=.5*(y-h)}}}},{key:"AsArray",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new e;return o.SetAsArray(t,r),o}},{key:"AsVector",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new e;return o.SetAsVector(t,r),o}},{key:"AsBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new e;return o.SetAsBox(t,r),o}},{key:"AsOrientedBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new k,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=new e;return n.SetAsOrientedBox(t,r,o,i),n}},{key:"AsEdge",value:function(t,r){var o=new e;return o.SetAsEdge(t,r),o}}]),e}();Ja.s_mat=new Fa;var xh=function(e){function t(){return FB(this,t),IB(this,KB(t).apply(this,arguments))}return LB(t,A),HB(t,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var e=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();e&&t&&r instanceof Ja&&o instanceof Nb&&qB(this.m_manifold,r,e.m_xf,o,t.m_xf)}}}],[{key:"Create",value:function(e){return new t}},{key:"Destroy",value:function(e,t){}}]),t}();function $B(r){return($B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function _B(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function jh(r,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function bC(r,t,e){return t&&jh(r.prototype,t),e&&jh(r,e),r}function cC(r,t){return!t||"object"!==$B(t)&&"function"!=typeof t?dC(r):t}function dC(r){if(void 0===r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function eC(r){return(eC=Object.setPrototypeOf?Object.getPrototypeOf:function(r){return r.__proto__||Object.getPrototypeOf(r)})(r)}function fC(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),t&&gC(r,t)}function gC(r,t){return(gC=Object.setPrototypeOf||function(r,t){return r.__proto__=t,r})(r,t)}var Gm=function(r){function t(){return _B(this,t),cC(this,eC(t).apply(this,arguments))}return fC(t,A),bC(t,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var r=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody(),e=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();r&&t&&e instanceof Ja&&o instanceof Ja&&oB(this.m_manifold,e,r.m_xf,o,t.m_xf)}}}],[{key:"Create",value:function(r){return new t}},{key:"Destroy",value:function(r,t){}}]),t}();function iC(e){return(iC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vm(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function lC(e,t,r){return t&&vm(e.prototype,t),r&&vm(e,r),e}function mC(e,t){return!t||"object"!==iC(t)&&"function"!=typeof t?nC(e):t}function nC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oC(e){return(oC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pC(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qC(e,t)}function qC(e,t){return(qC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rC(e){return(rC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sC(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function um(e,o){for(var t=0;t<o.length;t++){var r=o[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function uC(e,o,t){return o&&um(e.prototype,o),t&&um(e,t),e}function vC(e,o){return!o||"object"!==rC(o)&&"function"!=typeof o?wC(e):o}function wC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xC(e){return(xC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yC(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),o&&zC(e,o)}function zC(e,o){return(zC=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e})(e,o)}var Fg=function(e){function o(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new k,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new k;return sC(this,o),(e=vC(this,xC(o).call(this))).s_supportVec=new k,e.m_v1=new k,e.m_v2=new k,e.m_coreV1=new k,e.m_coreV2=new k,e.m_normal=new k,e.m_direction=new k,e.m_cornerDir1=new k,e.m_cornerDir2=new k,e.m_length=0,e.m_cornerConvex1=!1,e.m_cornerConvex2=!1,e.m_type=q.e_edgeShape,e.m_prevEdge=void 0,e.m_nextEdge=void 0,e.m_v1=t,e.m_v2=r,e.m_direction.Set(e.m_v2.x-e.m_v1.x,e.m_v2.y-e.m_v1.y),e.m_length=e.m_direction.Normalize(),e.m_normal.Set(e.m_direction.y,-e.m_direction.x),e.m_coreV1.Set(-Cc*(e.m_normal.x-e.m_direction.x)+e.m_v1.x,-Cc*(e.m_normal.y-e.m_direction.y)+e.m_v1.y),e.m_coreV2.Set(-Cc*(e.m_normal.x+e.m_direction.x)+e.m_v2.x,-Cc*(e.m_normal.y+e.m_direction.y)+e.m_v2.y),e.m_cornerDir1=e.m_normal,e.m_cornerDir2.Set(-e.m_normal.x,-e.m_normal.y),e}return yC(o,q),uC(o,[{key:"RayCast",value:function(e,o,t){var r=t.R,n=o.p2.x-o.p1.x,i=o.p2.y-o.p1.y,c=t.position.x+(r.col1.x*this.m_v1.x+r.col2.x*this.m_v1.y),m=t.position.y+(r.col1.y*this.m_v1.x+r.col2.y*this.m_v1.y),$=t.position.y+(r.col1.y*this.m_v2.x+r.col2.y*this.m_v2.y)-m,s=-(t.position.x+(r.col1.x*this.m_v2.x+r.col2.x*this.m_v2.y)-c),u=100*Number.MIN_VALUE,_=-(n*$+i*s);if(_>u){var l=o.p1.x-c,p=o.p1.y-m,y=l*$+p*s;if(0<=y&&y<=o.maxFraction*_){var a=-n*p+i*l;if(-u*_<=a&&a<=_*(1+u)){y/=_,e.fraction=y;var v=Math.sqrt($*$+s*s);return e.normal.x=$/v,e.normal.y=s/v,!0}}}return!1}},{key:"ComputeAABB",value:function(e,o){var t=o.R,r=o.position.x+(t.col1.x*this.m_v1.x+t.col2.x*this.m_v1.y),n=o.position.y+(t.col1.y*this.m_v1.x+t.col2.y*this.m_v1.y),i=o.position.x+(t.col1.x*this.m_v2.x+t.col2.x*this.m_v2.y),c=o.position.y+(t.col1.y*this.m_v2.x+t.col2.y*this.m_v2.y);r<i?(e.lowerBound.x=r,e.upperBound.x=i):(e.lowerBound.x=i,e.upperBound.x=r),n<c?(e.lowerBound.y=n,e.upperBound.y=c):(e.lowerBound.y=c,e.upperBound.y=n)}},{key:"ComputeMass",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.mass=0,e.center.SetV(this.m_v1),e.I=0}},{key:"ComputeSubmergedArea",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=new k(e.x*o,e.y*o),i=B(t,this.m_v1),c=B(t,this.m_v2),m=F(e,i)-o,$=F(e,c)-o;if(m>0){if($>0)return 0;i.x=-$/(m-$)*i.x+m/(m-$)*c.x,i.y=-$/(m-$)*i.y+m/(m-$)*c.y}else $>0&&(c.x=-$/(m-$)*i.x+m/(m-$)*c.x,c.y=-$/(m-$)*i.y+m/(m-$)*c.y);return r.x=(n.x+i.x+c.x)/3,r.y=(n.y+i.y+c.y)/3,.5*((i.x-n.x)*(c.y-n.y)-(i.y-n.y)*(c.x-n.x))}},{key:"GetLength",value:function(){return this.m_length}},{key:"GetVertex1",value:function(){return this.m_v1}},{key:"GetVertex2",value:function(){return this.m_v2}},{key:"GetCoreVertex1",value:function(){return this.m_coreV1}},{key:"GetCoreVertex2",value:function(){return this.m_coreV2}},{key:"GetNormalVector",value:function(){return this.m_normal}},{key:"GetDirectionVector",value:function(){return this.m_direction}},{key:"GetCorner1Vector",value:function(){return this.m_cornerDir1}},{key:"GetCorner2Vector",value:function(){return this.m_cornerDir2}},{key:"Corner1IsConvex",value:function(){return this.m_cornerConvex1}},{key:"Corner2IsConvex",value:function(){return this.m_cornerConvex2}},{key:"GetFirstVertex",value:function(e){var o=e.R;return new k(e.position.x+(o.col1.x*this.m_coreV1.x+o.col2.x*this.m_coreV1.y),e.position.y+(o.col1.y*this.m_coreV1.x+o.col2.y*this.m_coreV1.y))}},{key:"GetNextEdge",value:function(){return this.m_nextEdge}},{key:"GetPrevEdge",value:function(){return this.m_prevEdge}},{key:"Support",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.R,n=e.position.x+(r.col1.x*this.m_coreV1.x+r.col2.x*this.m_coreV1.y),i=e.position.y+(r.col1.y*this.m_coreV1.x+r.col2.y*this.m_coreV1.y),c=e.position.x+(r.col1.x*this.m_coreV2.x+r.col2.x*this.m_coreV2.y),m=e.position.y+(r.col1.y*this.m_coreV2.x+r.col2.y*this.m_coreV2.y);return n*o+i*t>c*o+m*t?(this.s_supportVec.x=n,this.s_supportVec.y=i):(this.s_supportVec.x=c,this.s_supportVec.y=m),this.s_supportVec}},{key:"SetPrevEdge",value:function(e,o,t,r){this.m_prevEdge=e,this.m_coreV1=o,this.m_cornerDir1=t,this.m_cornerConvex1=r}},{key:"SetNextEdge",value:function(e,o,t,r){this.m_nextEdge=e,this.m_coreV2=o,this.m_cornerDir2=t,this.m_cornerConvex2=r}}]),o}();var Xl=function(e){function t(){return jC(this,t),mC(this,oC(t).apply(this,arguments))}return pC(t,A),lC(t,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var e=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();e&&t&&r instanceof Fg&&o instanceof Nb&&this.CollideEdgeAndCircle(this.m_manifold,r,e.m_xf,o,t.m_xf)}}},{key:"CollideEdgeAndCircle",value:function(e,t,r,o,n){}}],[{key:"Create",value:function(e){return new t}},{key:"Destroy",value:function(e,t){}}]),t}();function CC(e){return(CC="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function DC(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ll(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function FC(e,t,r){return t&&Ll(e.prototype,t),r&&Ll(e,r),e}function GC(e,t){return!t||"object"!==CC(t)&&"function"!=typeof t?HC(e):t}function HC(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function IC(e){return(IC=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function JC(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&KC(e,t)}function KC(e,t){return(KC=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Il=function(e){function t(){return DC(this,t),GC(this,IC(t).apply(this,arguments))}return JC(t,A),FC(t,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var e=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();e&&t&&r instanceof Ja&&o instanceof Fg&&this.CollidePolyAndEdge(this.m_manifold,r,e.m_xf,o,t.m_xf)}}},{key:"CollidePolyAndEdge",value:function(e,t,r,o,n){}}],[{key:"Create",value:function(e){return new t}},{key:"Destroy",value:function(e,t){}}]),t}();var MC=function(){function e(t){_z(this,e),this.m_allocator=t,this.m_registers={},this.InitializeRegisters()}return bA(e,[{key:"AddType",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.m_registers[r][o].createFn=e,this.m_registers[r][o].destroyFn=t,this.m_registers[r][o].primary=!0,r!==o&&(this.m_registers[o][r].createFn=e,this.m_registers[o][r].destroyFn=t,this.m_registers[o][r].primary=!1)}},{key:"InitializeRegisters",value:function(){this.m_registers=new Array(q.e_shapeTypeCount);for(var e=0;e<q.e_shapeTypeCount;e++){this.m_registers[e]=new Array(q.e_shapeTypeCount);for(var t=0;t<q.e_shapeTypeCount;t++)this.m_registers[e][t]=new dA}this.AddType(Ci.Create,Ci.Destroy,q.e_circleShape,q.e_circleShape),this.AddType(xh.Create,xh.Destroy,q.e_polygonShape,q.e_circleShape),this.AddType(Gm.Create,Gm.Destroy,q.e_polygonShape,q.e_polygonShape),this.AddType(Xl.Create,Xl.Destroy,q.e_edgeShape,q.e_circleShape),this.AddType(Il.Create,Il.Destroy,q.e_polygonShape,q.e_edgeShape)}},{key:"Create",value:function(e,t){var r,o=parseInt("".concat(e.GetType()),10),a=parseInt("".concat(t.GetType()),10),i=this.m_registers[o][a];if(i.pool)return r=i.pool,i.pool=r.m_next,i.poolCount--,r.Reset(e,t),r;var $=i.createFn;return $?i.primary?((r=$(this.m_allocator)).Reset(e,t),r):((r=$(this.m_allocator)).Reset(t,e),r):void 0}},{key:"Destroy",value:function(e){if(e.m_fixtureA&&e.m_fixtureB&&e.m_fixtureA.m_body&&e.m_fixtureB.m_body){e.m_manifold.m_pointCount>0&&(e.m_fixtureA.m_body.SetAwake(!0),e.m_fixtureB.m_body.SetAwake(!0));var t=parseInt("".concat(e.m_fixtureA.GetType()),10),r=parseInt("".concat(e.m_fixtureB.GetType()),10),o=this.m_registers[t][r];o.poolCount++,e.m_next=o.pool,o.pool=e;var a=o.destroyFn;a&&a(e,this.m_allocator)}}}]),e}();var El=function(){function t(){By(this,t),this.m_contactCount=0,this.m_contactFilter=fg.b2_defaultFilter,this.m_contactListener=jg.b2_defaultListener,this.m_contactFactory=new MC(void 0),this.m_broadPhase=new Qz}return Dy(t,[{key:"AddPair",value:function(t,e){var o=t.GetBody(),n=e.GetBody();if(this.m_world&&o&&n&&o!==n){for(var r=n.GetContactList();r;){if(r.other===o){var i=r.contact.GetFixtureA(),a=r.contact.GetFixtureB();if(i===t&&a===e)return;if(i===e&&a===t)return}r=r.next}if(!1!==n.ShouldCollide(o)&&!1!==this.m_contactFilter.ShouldCollide(t,e)){var c=this.m_contactFactory.Create(t,e);t=c.GetFixtureA(),e=c.GetFixtureB(),o=t.m_body,n=e.m_body,o&&n&&(c.m_prev=void 0,c.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=c),this.m_world.m_contactList=c,c.m_nodeA.contact=c,c.m_nodeA.other=n,c.m_nodeA.prev=void 0,c.m_nodeA.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=c.m_nodeA),o.m_contactList=c.m_nodeA,c.m_nodeB.contact=c,c.m_nodeB.other=o,c.m_nodeB.prev=void 0,c.m_nodeB.next=n.m_contactList,null!=n.m_contactList&&(n.m_contactList.prev=c.m_nodeB),n.m_contactList=c.m_nodeB,++this.m_world.m_contactCount)}}}},{key:"FindNewContacts",value:function(){var t=this;this.m_broadPhase.UpdatePairs(function(e,o){t.AddPair(e,o)})}},{key:"Destroy",value:function(t){if(this.m_world){var e=t.GetFixtureA(),o=t.GetFixtureB(),n=e.GetBody(),r=o.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA===n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB===r.m_contactList&&(r.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount}}},{key:"Collide",value:function(){if(this.m_world)for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),o=t.GetFixtureB();if(!e||!o)return;var n=e.GetBody(),r=o.GetBody();if(!n||!r)return;if(!1!==n.IsAwake()||!1!==r.IsAwake()){if(t.m_flags&A.e_filterFlag){if(!1===r.ShouldCollide(n)){var i=t;t=i.GetNext(),this.Destroy(i);continue}if(!1===this.m_contactFilter.ShouldCollide(e,o)){var a=t;t=a.GetNext(),this.Destroy(a);continue}t.m_flags&=~A.e_filterFlag}var c=e.m_proxy,_=o.m_proxy;if(!1!==this.m_broadPhase.TestOverlap(c,_))t.Update(this.m_contactListener),t=t.GetNext();else{var m=t;t=m.GetNext(),this.Destroy(m)}}else t=t.GetNext()}}}]),t}();El.s_evalCP=new $z;function OC(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function el(r,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function QC(r,n,o){return n&&el(r.prototype,n),o&&el(r,o),r}function RC(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function $k(o,i){for(var t=0;t<i.length;t++){var l=i[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,l.key,l)}}function TC(o,i,t){return i&&$k(o.prototype,i),t&&$k(o,t),o}var UC=function(){function o(){RC(this,o),this.m_normal=new k,this.m_points=new Array(ba),this.m_points=this.m_points.fill(0).map(function(){return new k})}return TC(o,[{key:"Initialize",value:function(o,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(0!==o.m_pointCount){var a,r,e=0,c=0,s=0,x=0,m=0,$=0;switch(o.m_type){case G.e_circles:r=i.R,a=o.m_localPoint;var y=i.position.x+r.col1.x*a.x+r.col2.x*a.y,_=i.position.y+r.col1.y*a.x+r.col2.y*a.y;r=l.R,a=o.m_points[0].m_localPoint;var p=l.position.x+r.col1.x*a.x+r.col2.x*a.y,h=l.position.y+r.col1.y*a.x+r.col2.y*a.y,f=p-y,u=h-_,v=f*f+u*u;if(v>Number.MIN_VALUE*Number.MIN_VALUE){var O=Math.sqrt(v);this.m_normal.x=f/O,this.m_normal.y=u/O}else this.m_normal.x=1,this.m_normal.y=0;var J=y+t*this.m_normal.x,d=_+t*this.m_normal.y,P=p-n*this.m_normal.x,b=h-n*this.m_normal.y;this.m_points[0].x=.5*(J+P),this.m_points[0].y=.5*(d+b);break;case G.e_faceA:r=i.R,a=o.m_localPlaneNormal,e=r.col1.x*a.x+r.col2.x*a.y,c=r.col1.y*a.x+r.col2.y*a.y,r=i.R,a=o.m_localPoint,s=i.position.x+r.col1.x*a.x+r.col2.x*a.y,x=i.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_normal.x=e,this.m_normal.y=c;for(var C=0;C<o.m_pointCount;C++)r=l.R,a=o.m_points[C].m_localPoint,m=l.position.x+r.col1.x*a.x+r.col2.x*a.y,$=l.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_points[C].x=m+.5*(t-(m-s)*e-($-x)*c-n)*e,this.m_points[C].y=$+.5*(t-(m-s)*e-($-x)*c-n)*c;break;case G.e_faceB:r=l.R,a=o.m_localPlaneNormal,e=r.col1.x*a.x+r.col2.x*a.y,c=r.col1.y*a.x+r.col2.y*a.y,r=l.R,a=o.m_localPoint,s=l.position.x+r.col1.x*a.x+r.col2.x*a.y,x=l.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_normal.x=-e,this.m_normal.y=-c;for(var R=0;R<o.m_pointCount;R++)r=i.R,a=o.m_points[R].m_localPoint,m=i.position.x+r.col1.x*a.x+r.col2.x*a.y,$=i.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_points[R].x=m+.5*(n-(m-s)*e-($-x)*c-t)*e,this.m_points[R].y=$+.5*(n-(m-s)*e-($-x)*c-t)*c;}}}}]),o}();function VC(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function tk(o,i){for(var t=0;t<i.length;t++){var l=i[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,l.key,l)}}function XC(o,i,t){return i&&tk(o.prototype,i),t&&tk(o,t),o}var Ig=function(){function o(){VC(this,o),this.m_normal=new k,this.m_separations=new Array(ba).fill(0),this.m_points=new Array(ba).fill(0),this.m_points=this.m_points.map(function(){return new k})}return XC(o,[{key:"Initialize",value:function(o){aa(o.pointCount>0);var i,t,l=0,n=0,r=0,a=0;switch(o.type){case G.e_circles:i=o.bodyA.m_xf.R,t=o.localPoint;var e=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),s=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y);i=o.bodyB.m_xf.R,t=o.points[0].localPoint;var m=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),c=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),x=m-e,y=c-s,$=x*x+y*y;if($>Number.MIN_VALUE*Number.MIN_VALUE){var _=Math.sqrt($);this.m_normal.x=x/_,this.m_normal.y=y/_}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(e+m),this.m_points[0].y=.5*(s+c),this.m_separations[0]=x*this.m_normal.x+y*this.m_normal.y-o.radius;break;case G.e_faceA:i=o.bodyA.m_xf.R,t=o.localPlaneNormal,this.m_normal.x=i.col1.x*t.x+i.col2.x*t.y,this.m_normal.y=i.col1.y*t.x+i.col2.y*t.y,i=o.bodyA.m_xf.R,t=o.localPoint,r=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),a=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),i=o.bodyB.m_xf.R;for(var p=0;p<o.pointCount;++p)t=o.points[p].localPoint,l=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),n=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),this.m_separations[p]=(l-r)*this.m_normal.x+(n-a)*this.m_normal.y-o.radius,this.m_points[p].x=l,this.m_points[p].y=n;break;case G.e_faceB:i=o.bodyB.m_xf.R,t=o.localPlaneNormal,this.m_normal.x=i.col1.x*t.x+i.col2.x*t.y,this.m_normal.y=i.col1.y*t.x+i.col2.y*t.y,i=o.bodyB.m_xf.R,t=o.localPoint,r=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),a=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),i=o.bodyA.m_xf.R;for(var f=0;f<o.pointCount;++f)t=o.points[f].localPoint,l=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),n=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),this.m_separations[f]=(l-r)*this.m_normal.x+(n-a)*this.m_normal.y-o.radius,this.m_points[f].Set(l,n);this.m_normal.x*=-1,this.m_normal.y*=-1;}}}]),o}();Ig.circlePointA=new k,Ig.circlePointB=new k;function ZC(t,$){if(!(t instanceof $))throw new TypeError("Cannot call a class as a function")}function $C($,e){if(!($ instanceof e))throw new TypeError("Cannot call a class as a function")}var _C=function $(){$C(this,$),this.localPoint=new k,this.rA=new k,this.rB=new k};var aD=function t(){ZC(this,t),this.localPlaneNormal=new k,this.localPoint=new k,this.normal=new k,this.normalMass=new Fa,this.K=new Fa,this.points=new Array(ba).fill(0),this.points=this.points.map(function(){return new _C})};var Xd=function(){function r(){OC(this,r),this.m_step=new Yf,this.m_constraints=new Array,this.m_constraintCount=0}return QC(r,[{key:"Initialize",value:function(n,o){var t,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;this.m_step.Set(n),this.m_allocator=i;var e=0;for(this.m_constraintCount=a;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new aD;for(e=0;e<a;++e){var s=(t=o[e]).m_fixtureA,l=t.m_fixtureB;if(s&&l){var m=s.m_shape,p=l.m_shape;if(m&&p){var _=m.m_radius,y=p.m_radius,c=s.m_body,u=l.m_body;if(c&&u){var x=t.GetManifold(),v=by(s.GetFriction(),l.GetFriction()),$=cy(s.GetRestitution(),l.GetRestitution()),f=c.m_linearVelocity.x,d=c.m_linearVelocity.y,I=u.m_linearVelocity.x,B=u.m_linearVelocity.y,A=c.m_angularVelocity,G=u.m_angularVelocity;aa(x.m_pointCount>0),r.s_worldManifold.Initialize(x,c.m_xf,_,u.m_xf,y);var M=r.s_worldManifold.m_normal.x,h=r.s_worldManifold.m_normal.y,C=this.m_constraints[e];C.bodyA=c,C.bodyB=u,C.manifold=x,C.normal.x=M,C.normal.y=h,C.pointCount=x.m_pointCount,C.friction=v,C.restitution=$,C.localPlaneNormal.x=x.m_localPlaneNormal.x,C.localPlaneNormal.y=x.m_localPlaneNormal.y,C.localPoint.x=x.m_localPoint.x,C.localPoint.y=x.m_localPoint.y,C.radius=_+y,C.type=x.m_type;for(var w=0;w<C.pointCount;++w){var J=x.m_points[w],g=C.points[w];g.normalImpulse=J.m_normalImpulse,g.tangentImpulse=J.m_tangentImpulse,g.localPoint.SetV(J.m_localPoint);var b=g.rA.x=r.s_worldManifold.m_points[w].x-c.m_sweep.c.x,V=g.rA.y=r.s_worldManifold.m_points[w].y-c.m_sweep.c.y,P=g.rB.x=r.s_worldManifold.m_points[w].x-u.m_sweep.c.x,k=g.rB.y=r.s_worldManifold.m_points[w].y-u.m_sweep.c.y,S=b*h-V*M,q=P*h-k*M;S*=S,q*=q;var z=c.m_invMass+u.m_invMass+c.m_invI*S+u.m_invI*q;g.normalMass=1/z;var K=c.m_mass*c.m_invMass+u.m_mass*u.m_invMass;K+=c.m_mass*c.m_invI*S+u.m_mass*u.m_invI*q,g.equalizedMass=1/K;var R=-M,T=b*R-V*h,F=P*R-k*h;T*=T,F*=F;var N=c.m_invMass+u.m_invMass+c.m_invI*T+u.m_invI*F;g.tangentMass=1/N,g.velocityBias=0;var j=I+-G*k-f- -A*V,E=B+G*P-d-A*b,L=C.normal.x*j+C.normal.y*E;L<-Tx&&(g.velocityBias+=-C.restitution*L)}if(2===C.pointCount){var O=C.points[0],W=C.points[1],D=c.m_invMass,H=c.m_invI,Q=u.m_invMass,U=u.m_invI,X=O.rA.x*h-O.rA.y*M,Y=O.rB.x*h-O.rB.y*M,Z=W.rA.x*h-W.rA.y*M,rr=W.rB.x*h-W.rB.y*M,nr=D+Q+H*X*X+U*Y*Y,or=D+Q+H*Z*Z+U*rr*rr,tr=D+Q+H*X*Z+U*Y*rr;nr*nr<100*(nr*or-tr*tr)?(C.K.col1.Set(nr,tr),C.K.col2.Set(tr,or),C.K.GetInverse(C.normalMass)):C.pointCount=1}}}}}}},{key:"InitVelocityConstraints",value:function(r){for(var n=0;n<this.m_constraintCount;++n){var o=this.m_constraints[n],t=o.bodyA,a=o.bodyB,i=t.m_invMass,e=t.m_invI,s=a.m_invMass,l=a.m_invI,m=o.normal.x,p=o.normal.y,_=p,y=-m,c=0;if(r.warmStarting){c=o.pointCount;for(var u=0;u<c;++u){var x=o.points[u];x.normalImpulse*=r.dtRatio,x.tangentImpulse*=r.dtRatio;var v=x.normalImpulse*m+x.tangentImpulse*_,$=x.normalImpulse*p+x.tangentImpulse*y;t.m_angularVelocity-=e*(x.rA.x*$-x.rA.y*v),t.m_linearVelocity.x-=i*v,t.m_linearVelocity.y-=i*$,a.m_angularVelocity+=l*(x.rB.x*$-x.rB.y*v),a.m_linearVelocity.x+=s*v,a.m_linearVelocity.y+=s*$}}else{c=o.pointCount;for(var f=0;f<c;++f){var d=o.points[f];d.normalImpulse=0,d.tangentImpulse=0}}}}},{key:"SolveVelocityConstraints",value:function(){for(var r,n,o=0,t=0,a=0,i=0,e=0,s=0,l=0,m=0,p=0,_=0,y=0,c=0,u=0,x=0;x<this.m_constraintCount;++x){for(var v=this.m_constraints[x],$=v.bodyA,f=v.bodyB,d=$.m_angularVelocity,I=f.m_angularVelocity,B=$.m_linearVelocity,A=f.m_linearVelocity,G=$.m_invMass,M=$.m_invI,h=f.m_invMass,C=f.m_invI,w=v.normal.x,J=v.normal.y,g=J,b=-w,V=v.friction,P=0;P<v.pointCount;P++)r=v.points[P],t=(A.x-I*r.rB.y-B.x+d*r.rA.y)*g+(A.y+I*r.rB.x-B.y-d*r.rA.x)*b,a=r.tangentMass*-t,i=V*r.normalImpulse,s=(a=(e=ia(r.tangentImpulse+a,-i,i))-r.tangentImpulse)*g,l=a*b,B.x-=G*s,B.y-=G*l,d-=M*(r.rA.x*l-r.rA.y*s),A.x+=h*s,A.y+=h*l,I+=C*(r.rB.x*l-r.rB.y*s),r.tangentImpulse=e;if(1===v.pointCount)r=v.points[0],o=(A.x+-I*r.rB.y-B.x- -d*r.rA.y)*w+(A.y+I*r.rB.x-B.y-d*r.rA.x)*J,a=-r.normalMass*(o-r.velocityBias),s=(a=(e=(e=r.normalImpulse+a)>0?e:0)-r.normalImpulse)*w,l=a*J,B.x-=G*s,B.y-=G*l,d-=M*(r.rA.x*l-r.rA.y*s),A.x+=h*s,A.y+=h*l,I+=C*(r.rB.x*l-r.rB.y*s),r.normalImpulse=e;else{var k=v.points[0],S=v.points[1],q=k.normalImpulse,z=S.normalImpulse,K=(A.x-I*k.rB.y-B.x+d*k.rA.y)*w+(A.y+I*k.rB.x-B.y-d*k.rA.x)*J,R=(A.x-I*S.rB.y-B.x+d*S.rA.y)*w+(A.y+I*S.rB.x-B.y-d*S.rA.x)*J,T=K-k.velocityBias,F=R-S.velocityBias;for(T-=(n=v.K).col1.x*q+n.col2.x*z,F-=n.col1.y*q+n.col2.y*z;;){var N=-((n=v.normalMass).col1.x*T+n.col2.x*F),j=-(n.col1.y*T+n.col2.y*F);if(N>=0&&j>=0){_=(m=N-q)*w,y=m*J,c=(p=j-z)*w,u=p*J,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(k.rA.x*y-k.rA.y*_+S.rA.x*u-S.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(k.rB.x*y-k.rB.y*_+S.rB.x*u-S.rB.y*c),k.normalImpulse=N,S.normalImpulse=j;break}if(N=-k.normalMass*T,j=0,K=0,R=v.K.col1.y*N+F,N>=0&&R>=0){_=(m=N-q)*w,y=m*J,c=(p=j-z)*w,u=p*J,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(k.rA.x*y-k.rA.y*_+S.rA.x*u-S.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(k.rB.x*y-k.rB.y*_+S.rB.x*u-S.rB.y*c),k.normalImpulse=N,S.normalImpulse=j;break}if(N=0,j=-S.normalMass*F,K=v.K.col2.x*j+T,R=0,j>=0&&K>=0){_=(m=N-q)*w,y=m*J,c=(p=j-z)*w,u=p*J,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(k.rA.x*y-k.rA.y*_+S.rA.x*u-S.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(k.rB.x*y-k.rB.y*_+S.rB.x*u-S.rB.y*c),k.normalImpulse=N,S.normalImpulse=j;break}if(N=0,j=0,R=F,(K=T)>=0&&R>=0){_=(m=N-q)*w,y=m*J,c=(p=j-z)*w,u=p*J,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(k.rA.x*y-k.rA.y*_+S.rA.x*u-S.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(k.rB.x*y-k.rB.y*_+S.rB.x*u-S.rB.y*c),k.normalImpulse=N,S.normalImpulse=j;break}break}}$.m_angularVelocity=d,f.m_angularVelocity=I}}},{key:"FinalizeVelocityConstraints",value:function(){for(var r=0;r<this.m_constraintCount;++r)for(var n=this.m_constraints[r],o=n.manifold,t=0;t<n.pointCount;++t){var a=o.m_points[t],i=n.points[t];a.m_normalImpulse=i.normalImpulse,a.m_tangentImpulse=i.tangentImpulse}}},{key:"SolvePositionConstraints",value:function(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=0,t=0;t<this.m_constraintCount;t++){var a=this.m_constraints[t],i=a.bodyA,e=a.bodyB,s=i.m_mass*i.m_invMass,l=i.m_mass*i.m_invI,m=e.m_mass*e.m_invMass,p=e.m_mass*e.m_invI;r.s_psm.Initialize(a);for(var _=r.s_psm.m_normal,y=0;y<a.pointCount;y++){var c=a.points[y],u=r.s_psm.m_points[y],x=r.s_psm.m_separations[y],v=u.x-i.m_sweep.c.x,$=u.y-i.m_sweep.c.y,f=u.x-e.m_sweep.c.x,d=u.y-e.m_sweep.c.y;o=o<x?o:x;var I=ia(n*(x+fa),-Ux,0),B=-c.equalizedMass*I,A=B*_.x,G=B*_.y;i.m_sweep.c.x-=s*A,i.m_sweep.c.y-=s*G,i.m_sweep.a-=l*(v*G-$*A),i.SynchronizeTransform(),e.m_sweep.c.x+=m*A,e.m_sweep.c.y+=m*G,e.m_sweep.a+=p*(f*G-d*A),e.SynchronizeTransform()}}return o>-1.5*fa}}]),r}();Xd.s_worldManifold=new UC,Xd.s_psm=new Ig;function cD(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function vj(t,i){for(var o=0;o<i.length;o++){var e=i[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function eD(t,i,o){return i&&vj(t.prototype,i),o&&vj(t,o),t}function fD(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}var gD=function a(){fD(this,a),this.normalImpulses=new Array(ba),this.tangentImpulses=new Array(ba)};var ej=function(){function t(){cD(this,t),this.m_bodies=new Array,this.m_contacts=new Array,this.m_joints=new Array,this.m_bodyCapacity=0,this.m_contactCapacity=0,this.m_jointCapacity=0,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=void 0,this.m_listener=void 0,this.m_contactSolver=new Xd}return eD(t,[{key:"Initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;this.m_bodyCapacity=t,this.m_contactCapacity=i,this.m_jointCapacity=o,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=e,this.m_listener=n,this.m_contactSolver=a;for(var r=this.m_bodies.length;r<t;r++)this.m_bodies[r]=null;for(var s=this.m_contacts.length;s<i;s++)this.m_contacts[s]=null;for(var m=this.m_joints.length;m<o;m++)this.m_joints[m]=null}},{key:"Clear",value:function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0}},{key:"Solve",value:function(t,i,o){var e,n=0,a=0;for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).GetType()===j.b2_dynamicBody&&(e.m_linearVelocity.x+=t.dt*(i.x+e.m_invMass*e.m_force.x),e.m_linearVelocity.y+=t.dt*(i.y+e.m_invMass*e.m_force.y),e.m_angularVelocity+=t.dt*e.m_invI*e.m_torque,e.m_linearVelocity.Multiply(ia(1-t.dt*e.m_linearDamping,0,1)),e.m_angularVelocity*=ia(1-t.dt*e.m_angularDamping,0,1));this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var r=this.m_contactSolver;for(r.InitVelocityConstraints(t),n=0;n<this.m_jointCount;++n)this.m_joints[n].InitVelocityConstraints(t);for(n=0;n<t.velocityIterations;++n){for(a=0;a<this.m_jointCount;++a)this.m_joints[a].SolveVelocityConstraints(t);r.SolveVelocityConstraints()}for(n=0;n<this.m_jointCount;++n)this.m_joints[n].FinalizeVelocityConstraints();for(r.FinalizeVelocityConstraints(),n=0;n<this.m_bodyCount;++n)if((e=this.m_bodies[n]).GetType()!==j.b2_staticBody){var s=t.dt*e.m_linearVelocity.x,m=t.dt*e.m_linearVelocity.y;s*s+m*m>Wl&&(e.m_linearVelocity.Normalize(),e.m_linearVelocity.x*=Ab*t.inv_dt,e.m_linearVelocity.y*=Ab*t.inv_dt);var l=t.dt*e.m_angularVelocity;l*l>Sl&&(e.m_angularVelocity<0?e.m_angularVelocity=-Bb*t.inv_dt:e.m_angularVelocity=Bb*t.inv_dt),e.m_sweep.c0.SetV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=t.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=t.dt*e.m_linearVelocity.y,e.m_sweep.a+=t.dt*e.m_angularVelocity,e.SynchronizeTransform()}for(n=0;n<t.positionIterations;++n){var _=r.SolvePositionConstraints(Wf),c=!0;for(a=0;a<this.m_jointCount;++a){var $=this.m_joints[a].SolvePositionConstraints(Wf);c=c&&$}if(_&&c)break}if(this.Report(r.m_constraints),o){var y=Number.MAX_VALUE,p=Nl*Nl,u=Ml*Ml;for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).GetType()!==j.b2_staticBody&&(0==(e.m_flags&j.e_allowSleepFlag)&&(e.m_sleepTime=0,y=0),0==(e.m_flags&j.e_allowSleepFlag)||e.m_angularVelocity*e.m_angularVelocity>u||F(e.m_linearVelocity,e.m_linearVelocity)>p?(e.m_sleepTime=0,y=0):(e.m_sleepTime+=t.dt,y=zx(y,e.m_sleepTime)));if(y>=$x)for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).SetAwake(!1)}}},{key:"SolveTOI",value:function(t){var i=0,o=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var e=this.m_contactSolver;for(i=0;i<this.m_jointCount;++i)this.m_joints[i].InitVelocityConstraints(t);for(i=0;i<t.velocityIterations;++i)for(e.SolveVelocityConstraints(),o=0;o<this.m_jointCount;++o)this.m_joints[o].SolveVelocityConstraints(t);for(i=0;i<this.m_bodyCount;++i){var n=this.m_bodies[i];if(n.GetType()!==j.b2_staticBody){var a=t.dt*n.m_linearVelocity.x,r=t.dt*n.m_linearVelocity.y;a*a+r*r>Wl&&(n.m_linearVelocity.Normalize(),n.m_linearVelocity.x*=Ab*t.inv_dt,n.m_linearVelocity.y*=Ab*t.inv_dt);var s=t.dt*n.m_angularVelocity;s*s>Sl&&(n.m_angularVelocity<0?n.m_angularVelocity=-Bb*t.inv_dt:n.m_angularVelocity=Bb*t.inv_dt),n.m_sweep.c0.SetV(n.m_sweep.c),n.m_sweep.a0=n.m_sweep.a,n.m_sweep.c.x+=t.dt*n.m_linearVelocity.x,n.m_sweep.c.y+=t.dt*n.m_linearVelocity.y,n.m_sweep.a+=t.dt*n.m_angularVelocity,n.SynchronizeTransform()}}for(i=0;i<t.positionIterations;++i){var m=e.SolvePositionConstraints(.75),l=!0;for(o=0;o<this.m_jointCount;++o){var _=this.m_joints[o].SolvePositionConstraints(Wf);l=l&&_}if(m&&l)break}this.Report(e.m_constraints)}},{key:"Report",value:function(i){if(this.m_listener)for(var o=0;o<this.m_contactCount;++o){this.m_contacts[o];for(var e=i[o],n=0;n<e.pointCount;++n)t.s_impulse.normalImpulses[n]=e.points[n].normalImpulse,t.s_impulse.tangentImpulses[n]=e.points[n].tangentImpulse}}},{key:"AddBody",value:function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t}},{key:"AddContact",value:function(t){this.m_contacts[this.m_contactCount++]=t}},{key:"AddJoint",value:function(t){this.m_joints[this.m_jointCount++]=t}}]),t}();ej.s_impulse=new gD;function iD(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oi(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function kD(e,t,n){return t&&Oi(e.prototype,t),n&&Oi(e,n),e}function lD(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var Hi=function a(){lD(this,a)};var p=function(){function e(t){iD(this,e),this.m_edgeA=new Hi,this.m_edgeB=new Hi,this.m_localCenterA=new k,this.m_localCenterB=new k,this.m_type=e.e_unknownJoint,this.m_collideConnected=!1,this.m_islandFlag=!1,aa(t.bodyA!==t.bodyB),this.m_type=t.type,this.m_prev=void 0,this.m_next=void 0,this.m_bodyA=t.bodyA,this.m_bodyB=t.bodyB,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData}return kD(e,[{key:"GetType",value:function(){return this.m_type}},{key:"GetAnchorA",value:function(){return new k}},{key:"GetAnchorB",value:function(){return new k}},{key:"GetReactionForce",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new k}},{key:"GetReactionTorque",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0}},{key:"GetBodyA",value:function(){return this.m_bodyA}},{key:"GetBodyB",value:function(){return this.m_bodyB}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(e){this.m_userData=e}},{key:"IsActive",value:function(){return this.m_bodyA&&this.m_bodyA.IsActive()&&this.m_bodyB&&this.m_bodyB.IsActive()}},{key:"InitVelocityConstraints",value:function(e){}},{key:"SolveVelocityConstraints",value:function(e){}},{key:"FinalizeVelocityConstraints",value:function(){}},{key:"SolvePositionConstraints",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!1}}],[{key:"Destroy",value:function(e,t){}}]),e}();p.e_unknownJoint=0,p.e_revoluteJoint=1,p.e_prismaticJoint=2,p.e_distanceJoint=3,p.e_pulleyJoint=4,p.e_mouseJoint=5,p.e_gearJoint=6,p.e_lineJoint=7,p.e_weldJoint=8,p.e_frictionJoint=9,p.e_inactiveLimit=0,p.e_atLowerLimit=1,p.e_atUpperLimit=2,p.e_equalLimits=3;function oD(e,t){switch(e.type){case p.e_distanceJoint:break;case p.e_mouseJoint:return new yD(e);case p.e_prismaticJoint:case p.e_revoluteJoint:case p.e_pulleyJoint:case p.e_gearJoint:case p.e_lineJoint:case p.e_weldJoint:case p.e_frictionJoint:}return new p(e)}function pD(t){return(pD="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function qD(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ei(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function sD(t,e,o){return e&&Ei(t.prototype,e),o&&Ei(t,o),t}function Dh(t,e){return!e||"object"!==pD(e)&&"function"!=typeof e?uD(t):e}function uD(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vD(t){return(vD=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function wD(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xD(t,e)}function xD(t,e){return(xD=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var yD=function(t){function e(t){var o;if(qD(this,e),(o=Dh(this,vD(e).call(this,t))).K=new Fa,o.K1=new Fa,o.K2=new Fa,o.m_localAnchor=new k,o.m_target=new k,o.m_impulse=new k,o.m_mass=new Fa,o.m_C=new k,o.m_maxForce=1/0,o.m_frequencyHz=0,o.m_dampingRatio=0,o.m_beta=0,o.m_gamma=0,o.m_target.SetV(t.target),!o.m_bodyB)return Dh(o);var i=o.m_target.x-o.m_bodyB.m_xf.position.x,r=o.m_target.y-o.m_bodyB.m_xf.position.y,n=o.m_bodyB.m_xf.R;return o.m_localAnchor.x=i*n.col1.x+r*n.col1.y,o.m_localAnchor.y=i*n.col2.x+r*n.col2.y,o.m_maxForce=t.maxForce,o.m_frequencyHz=t.frequencyHz,o.m_dampingRatio=t.dampingRatio,o}return wD(e,p),sD(e,[{key:"GetAnchorA",value:function(){return this.m_target}},{key:"GetAnchorB",value:function(){return this.m_bodyB?this.m_bodyB.GetWorldPoint(this.m_localAnchor):new k}},{key:"GetReactionForce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new k(t*this.m_impulse.x,t*this.m_impulse.y)}},{key:"GetReactionTorque",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0}},{key:"GetTarget",value:function(){return this.m_target}},{key:"SetTarget",value:function(t){this.m_bodyB&&(!1===this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t)}},{key:"GetMaxForce",value:function(){return this.m_maxForce}},{key:"SetMaxForce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_maxForce=t}},{key:"GetFrequency",value:function(){return this.m_frequencyHz}},{key:"SetFrequency",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_frequencyHz=t}},{key:"GetDampingRatio",value:function(){return this.m_dampingRatio}},{key:"SetDampingRatio",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_dampingRatio=t}},{key:"InitVelocityConstraints",value:function(t){var e=this.m_bodyB,o=e.GetMass(),i=2*Math.PI*this.m_frequencyHz,r=2*o*this.m_dampingRatio*i,n=o*i*i;this.m_gamma=t.dt*(r+t.dt*n),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*n*this.m_gamma;var a=e.m_xf.R,m=this.m_localAnchor.x-e.m_sweep.localCenter.x,s=this.m_localAnchor.y-e.m_sweep.localCenter.y,l=a.col1.x*m+a.col2.x*s;s=a.col1.y*m+a.col2.y*s,m=l;var c=e.m_invMass,_=e.m_invI;this.K1.col1.x=c,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=c,this.K2.col1.x=_*s*s,this.K2.col2.x=-_*m*s,this.K2.col1.y=-_*m*s,this.K2.col2.y=_*m*m,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=e.m_sweep.c.x+m-this.m_target.x,this.m_C.y=e.m_sweep.c.y+s-this.m_target.y,e.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,e.m_linearVelocity.x+=c*this.m_impulse.x,e.m_linearVelocity.y+=c*this.m_impulse.y,e.m_angularVelocity+=_*(m*this.m_impulse.y-s*this.m_impulse.x)}},{key:"SolveVelocityConstraints",value:function(t){var e,o=this.m_bodyB,i=0,r=o.m_xf.R,n=this.m_localAnchor.x-o.m_sweep.localCenter.x,a=this.m_localAnchor.y-o.m_sweep.localCenter.y;i=r.col1.x*n+r.col2.x*a,a=r.col1.y*n+r.col2.y*a,n=i;var m=o.m_linearVelocity.x+-o.m_angularVelocity*a,s=o.m_linearVelocity.y+o.m_angularVelocity*n;r=this.m_mass,i=m+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,e=s+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var l=-(r.col1.x*i+r.col2.x*e),c=-(r.col1.y*i+r.col2.y*e),_=this.m_impulse.x,u=this.m_impulse.y;this.m_impulse.x+=l,this.m_impulse.y+=c;var y=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>y*y&&this.m_impulse.Multiply(y/this.m_impulse.Length()),l=this.m_impulse.x-_,c=this.m_impulse.y-u,o.m_linearVelocity.x+=o.m_invMass*l,o.m_linearVelocity.y+=o.m_invMass*c,o.m_angularVelocity+=o.m_invI*(n*c-a*l)}},{key:"SolvePositionConstraints",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!0}}]),e}();function zD(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var AD=function a(){zD(this,a),this.normal=new k,this.fraction=0};var T=function(){function t(e,r){my(this,t),this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,this.m_allowSleep=!0,this.m_gravity=new k,this.m_inv_dt0=0,this.m_flags=0,this.m_contactManager=new El,this.m_contactSolver=new Xd,this.m_island=new ej,this.m_groundBody=this.CreateBody(new Jg),this.s_stack=[],this.m_gravity=e,this.m_allowSleep=r,this.m_contactManager.m_world=this}return oy(t,[{key:"SetDestructionListener",value:function(t){this.m_destructionListener=t}},{key:"SetContactFilter",value:function(t){this.m_contactManager.m_contactFilter=t}},{key:"SetContactListener",value:function(t){this.m_contactManager.m_contactListener=t}},{key:"SetDebugDraw",value:function(t){this.m_debugDraw=t}},{key:"SetBroadPhase",value:function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var r=this.m_bodyList;r;r=r.m_next)for(var o=r.m_fixtureList;o;o=o.m_next)o.m_proxy=t.CreateProxy(e.GetFatAABB(o.m_proxy),o)}},{key:"Validate",value:function(){this.m_contactManager.m_broadPhase.Validate()}},{key:"GetProxyCount",value:function(){return this.m_contactManager.m_broadPhase.GetProxyCount()}},{key:"CreateBody",value:function(t){if(this.IsLocked())throw new Error("Cannot create bodies on a locked world.");var e=new j(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e}},{key:"DestroyBody",value:function(t){if(!this.IsLocked()){for(var e=t.m_jointList;e;){var r=e;e=e.next,this.m_destructionListener&&(this.m_destructionListener.SayGoodbyeJoint(r.joint),this.DestroyJoint(r.joint))}for(var o=t.m_controllerList;o;){var i=o;o=o.nextController,i.controller.RemoveBody(t)}for(var n=t.m_contactList;n;){var a=n;n=n.next,this.m_contactManager.Destroy(a.contact)}t.m_contactList=null;for(var s=t.m_fixtureList;s;){var m=s;s=s.m_next,this.m_destructionListener&&(this.m_destructionListener.SayGoodbyeFixture(m),m.DestroyProxy(this.m_contactManager.m_broadPhase),m.Destroy())}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}}},{key:"CreateJoint",value:function(t){if(t.bodyA&&t.bodyB){var e=oD(t,null);if(e.m_bodyA&&e.m_bodyB){e.m_prev=void 0,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=void 0,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=void 0,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var r=t.bodyA,o=t.bodyB;if(!1===t.collideConnected)for(var i=o.GetContactList();i;)i.other===r&&i.contact.FlagForFiltering(),i=i.next;return e}}}},{key:"DestroyJoint",value:function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_jointList&&(this.m_jointList=t.m_next);var r=t.m_bodyA,o=t.m_bodyB;if(r&&o&&(r.SetAwake(!0),o.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA===r.m_jointList&&(r.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=void 0,t.m_edgeA.next=void 0,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB===o.m_jointList&&(o.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=void 0,t.m_edgeB.next=void 0,p.Destroy(t,null),--this.m_jointCount,!1===e))for(var i=o.GetContactList();i;)i.other===r&&i.contact.FlagForFiltering(),i=i.next}},{key:"AddController",value:function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t}},{key:"RemoveController",value:function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList===t&&(this.m_controllerList=t.m_next),this.m_controllerCount--}},{key:"CreateController",value:function(t){if(t.m_world!==this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t}},{key:"DestroyController",value:function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t===this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount}},{key:"SetWarmStarting",value:function(e){t.m_warmStarting=e}},{key:"SetContinuousPhysics",value:function(e){t.m_continuousPhysics=e}},{key:"GetBodyCount",value:function(){return this.m_bodyCount}},{key:"GetJointCount",value:function(){return this.m_jointCount}},{key:"GetContactCount",value:function(){return this.m_contactCount}},{key:"SetGravity",value:function(t){this.m_gravity=t}},{key:"GetGravity",value:function(){return this.m_gravity}},{key:"GetGroundBody",value:function(){return this.m_groundBody}},{key:"Step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.m_flags&t.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~t.e_newFixture),this.m_flags|=t.e_locked;var i=t.s_timestep2;i.dt=e,i.velocityIterations=r,i.positionIterations=o,i.inv_dt=e>0?1/e:0,i.dtRatio=this.m_inv_dt0*e,i.warmStarting=t.m_warmStarting,this.m_contactManager.Collide(),i.dt>0&&this.Solve(i),t.m_continuousPhysics&&i.dt>0&&this.SolveTOI(i),i.dt>0&&(this.m_inv_dt0=i.inv_dt),this.m_flags&=~t.e_locked}},{key:"ClearForces",value:function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0}},{key:"DrawDebugData",value:function(){if(this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var e,r,o,i,n,a,s=this.m_debugDraw.GetFlags(),m=[new k,new k,new k,new k],_=new nl(0,0,0);if(s&M.e_shapeBit)for(e=this.m_bodyList;e;e=e.m_next)for(a=e.m_xf,r=e.GetFixtureList();r;r=r.m_next)o=r.GetShape(),!1===e.IsActive()?(_.Set(.5,.5,.3),this.DrawShape(o,a,_)):e.GetType()===j.b2_staticBody?(_.Set(.5,.9,.5),this.DrawShape(o,a,_)):e.GetType()===j.b2_kinematicBody?(_.Set(.5,.5,.9),this.DrawShape(o,a,_)):!1===e.IsAwake()?(_.Set(.6,.6,.6),this.DrawShape(o,a,_)):(_.Set(.9,.7,.7),this.DrawShape(o,a,_));if(s&M.e_jointBit)for(i=this.m_jointList;i;i=i.m_next)this.DrawJoint(i);if(s&M.e_controllerBit)for(var $=this.m_controllerList;$;$=$.m_next)$.Draw(this.m_debugDraw);if(s&M.e_pairBit){_.Set(.3,.9,.9);for(var c=this.m_contactManager.m_contactList;c;c=c.GetNext()){var l=c.GetFixtureA(),d=c.GetFixtureB();if(l&&d){var u=l.GetAABB().GetCenter(),p=d.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(u,p,_)}}}if(s&M.e_aabbBit)for(n=this.m_contactManager.m_broadPhase,m=[new k,new k,new k,new k],e=this.m_bodyList;e;e=e.GetNext())if(e.IsActive())for(r=e.GetFixtureList();r;r=r.GetNext()){var x=n.GetFatAABB(r.m_proxy);m[0].Set(x.lowerBound.x,x.lowerBound.y),m[1].Set(x.upperBound.x,x.lowerBound.y),m[2].Set(x.upperBound.x,x.upperBound.y),m[3].Set(x.lowerBound.x,x.upperBound.y),this.m_debugDraw.DrawPolygon(m,4,_)}if(s&M.e_centerOfMassBit)for(e=this.m_bodyList;e;e=e.m_next)(a=t.s_xf).R=e.m_xf.R,a.position=e.GetWorldCenter(),this.m_debugDraw.DrawTransform(a)}}},{key:"QueryAABB",value:function(t,e){var r=this.m_contactManager.m_broadPhase;r.Query(function(e){return t(r.GetUserData(e))},e)}},{key:"QueryShape",value:function(t,e,r){r||(r=new $).SetIdentity();var o=this.m_contactManager.m_broadPhase,i=new Ha;e.ComputeAABB(i,r),o.Query(function(i){var n=o.GetUserData(i)instanceof Sc?o.GetUserData(i):null;return!q.TestOverlap(e,r,n.GetShape(),n.GetBody().GetTransform())||t(n)},i)}},{key:"QueryPoint",value:function(t,e){var r=this.m_contactManager.m_broadPhase,o=new Ha;o.lowerBound.Set(e.x-fa,e.y-fa),o.upperBound.Set(e.x+fa,e.y+fa),r.Query(function(o){var i=r.GetUserData(o)instanceof Sc?r.GetUserData(o):null;return!i.TestPoint(e)||t(i)},o)}},{key:"RayCast",value:function(t,e,r){var o=this.m_contactManager.m_broadPhase,i=new AD,n=new rh(e,r);o.RayCast(function(n,a){var s=o.GetUserData(a);if(!(s instanceof Sc))return n.maxFraction;if(s.RayCast(i,n)){var m=i.fraction,_=new k((1-m)*e.x+m*r.x,(1-m)*e.y+m*r.y);return t(s,_,i.normal,m)}},n)}},{key:"RayCastOne",value:function(t,e){var r;return this.RayCast(function(t,e,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return r=t,i},t,e),r}},{key:"RayCastAll",value:function(t,e){var r=new Array;return this.RayCast(function(t,e,o){arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r[r.length]=t,1},t,e),r}},{key:"GetBodyList",value:function(){return this.m_bodyList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetContactList",value:function(){return this.m_contactList}},{key:"IsLocked",value:function(){return(this.m_flags&t.e_locked)>0}},{key:"Solve",value:function(t){for(var e,r=this.m_controllerList;r;r=r.m_next)r.Step(t);var o=this.m_island;for(o.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~j.e_islandFlag;for(var i=this.m_contactList;i;i=i.m_next)i.m_flags&=~A.e_islandFlag;for(var n=this.m_jointList;n;n=n.m_next)n.m_islandFlag=!1;for(var a=this.s_stack,s=this.m_bodyList;s;s=s.m_next)if(!(s.m_flags&j.e_islandFlag)&&!1!==s.IsAwake()&&!1!==s.IsActive()&&s.GetType()!==j.b2_staticBody){o.Clear();var m=0;for(a[m++]=s,s.m_flags|=j.e_islandFlag;m>0;)if(e=a[--m],o.AddBody(e),!1===e.IsAwake()&&e.SetAwake(!0),e.GetType()!==j.b2_staticBody){for(var _=void 0,$=e.m_contactList;$;$=$.next)$.contact.m_flags&A.e_islandFlag||!0!==$.contact.IsSensor()&&!1!==$.contact.IsEnabled()&&!1!==$.contact.IsTouching()&&(o.AddContact($.contact),$.contact.m_flags|=A.e_islandFlag,(_=$.other).m_flags&j.e_islandFlag||(a[m++]=_,_.m_flags|=j.e_islandFlag));for(var c=e.m_jointList;c;c=c.next)!0!==c.joint.m_islandFlag&&!1!==(_=c.other).IsActive()&&(o.AddJoint(c.joint),c.joint.m_islandFlag=!0,_.m_flags&j.e_islandFlag||(a[m++]=_,_.m_flags|=j.e_islandFlag))}o.Solve(t,this.m_gravity,this.m_allowSleep);for(var l=0;l<o.m_bodyCount;++l)(e=o.m_bodies[l]).GetType()===j.b2_staticBody&&(e.m_flags&=~j.e_islandFlag)}for(var d=0;d<a.length&&a[d];++d)a[d]=null;for(e=this.m_bodyList;e;e=e.m_next)!1!==e.IsAwake()&&!1!==e.IsActive()&&e.GetType()!==j.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()}},{key:"SolveTOI",value:function(e){var r,o,i,n,a,s,m,_=this.m_island;_.Initialize(this.m_bodyCount,Rx,Sx,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var $,c=t.s_queue;for(r=this.m_bodyList;r;r=r.m_next)r.m_flags&=~j.e_islandFlag,r.m_sweep.t0=0;for($=this.m_contactList;$;$=$.m_next)$.m_flags&=~(A.e_toiFlag|A.e_islandFlag);for(m=this.m_jointList;m;m=m.m_next)m.m_islandFlag=!1;for(;;){var l=null,d=1;for($=this.m_contactList;$;$=$.m_next)if(!0!==$.IsSensor()&&!1!==$.IsEnabled()&&!1!==$.IsContinuous()){var u=1;if($.m_flags&A.e_toiFlag)u=$.m_toi;else{if(o=$.m_fixtureA,i=$.m_fixtureB,n=o.m_body,a=i.m_body,!(n.GetType()===j.b2_dynamicBody&&!1!==n.IsAwake()||a.GetType()===j.b2_dynamicBody&&!1!==a.IsAwake()))continue;var p=n.m_sweep.t0;n.m_sweep.t0<a.m_sweep.t0?(p=a.m_sweep.t0,n.m_sweep.Advance(p)):a.m_sweep.t0<n.m_sweep.t0&&(p=n.m_sweep.t0,a.m_sweep.Advance(p)),u=$.ComputeTOI(n.m_sweep,a.m_sweep),aa(0<=u&&u<=1),u>0&&u<1&&(u=(1-u)*p+u)>1&&(u=1),$.m_toi=u,$.m_flags|=A.e_toiFlag}Number.MIN_VALUE<u&&u<d&&(l=$,d=u)}if(null===l||1-100*Number.MIN_VALUE<d)break;if(o=l.m_fixtureA,i=l.m_fixtureB,n=o.m_body,a=i.m_body,t.s_backupA.Set(n.m_sweep),t.s_backupB.Set(a.m_sweep),n.Advance(d),a.Advance(d),l.Update(this.m_contactManager.m_contactListener),l.m_flags&=~A.e_toiFlag,!0!==l.IsSensor()&&!1!==l.IsEnabled()){if(!1!==l.IsTouching()){var x=n;x.GetType()!==j.b2_dynamicBody&&(x=a),_.Clear();var y=0,h=0;for(c[y+h++]=x,x.m_flags|=j.e_islandFlag;h>0;)if(r=c[y++],--h,_.AddBody(r),!1===r.IsAwake()&&r.SetAwake(!0),r.GetType()===j.b2_dynamicBody){for(s=r.m_contactList;s&&_.m_contactCount!==_.m_contactCapacity;s=s.next)if(!(s.contact.m_flags&A.e_islandFlag)&&!0!==s.contact.IsSensor()&&!1!==s.contact.IsEnabled()&&!1!==s.contact.IsTouching()){_.AddContact(s.contact),s.contact.m_flags|=A.e_islandFlag;var f=s.other;f.m_flags&j.e_islandFlag||(f.GetType()!==j.b2_staticBody&&(f.Advance(d),f.SetAwake(!0)),c[y+h]=f,++h,f.m_flags|=j.e_islandFlag)}for(var v=r.m_jointList;v;v=v.next)if(_.m_jointCount!==_.m_jointCapacity&&!0!==v.joint.m_islandFlag){var g=v.other;!1!==g.IsActive()&&(_.AddJoint(v.joint),v.joint.m_islandFlag=!0,g.m_flags&j.e_islandFlag||(g.GetType()!==j.b2_staticBody&&(g.Advance(d),g.SetAwake(!0)),c[y+h]=g,++h,g.m_flags|=j.e_islandFlag))}}var z=t.s_timestep;z.warmStarting=!1,z.dt=(1-d)*e.dt,z.inv_dt=1/z.dt,z.dtRatio=0,z.velocityIterations=e.velocityIterations,z.positionIterations=e.positionIterations,_.SolveTOI(z);for(var Y=0;Y<_.m_bodyCount;++Y)if((r=_.m_bodies[Y]).m_flags&=~j.e_islandFlag,!1!==r.IsAwake()&&r.GetType()===j.b2_dynamicBody)for(r.SynchronizeFixtures(),s=r.m_contactList;s;s=s.next)s.contact.m_flags&=~A.e_toiFlag;for(var w=0;w<_.m_contactCount;++w)($=_.m_contacts[w]).m_flags&=~(A.e_toiFlag|A.e_islandFlag);for(var b=0;b<_.m_jointCount;++b)(m=_.m_joints[b]).m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else n.m_sweep.Set(t.s_backupA),a.m_sweep.Set(t.s_backupB),n.SynchronizeTransform(),a.SynchronizeTransform()}}},{key:"DrawJoint",value:function(e){if(this.m_debugDraw){var r=e.GetBodyA(),o=e.GetBodyB();if(r&&o){var i=r.m_xf,n=o.m_xf,a=i.position,s=n.position,m=e.GetAnchorA(),_=e.GetAnchorB();if(m&&_){var $=t.s_jointColor;switch(e.m_type){case p.e_distanceJoint:this.m_debugDraw.DrawSegment(m,_,$);break;case p.e_pulleyJoint:break;case p.e_mouseJoint:this.m_debugDraw.DrawSegment(m,_,$);break;default:r!==this.m_groundBody&&this.m_debugDraw.DrawSegment(a,m,$),this.m_debugDraw.DrawSegment(m,_,$),o!==this.m_groundBody&&this.m_debugDraw.DrawSegment(s,_,$);}}}}}},{key:"DrawShape",value:function(t,e,r){if(this.m_debugDraw)switch(t.m_type){case q.e_circleShape:if(!(t instanceof Nb))return;var o=t,i=B(e,o.m_p),n=o.m_radius,a=e.R.col1;this.m_debugDraw.DrawSolidCircle(i,n,a,r);break;case q.e_polygonShape:if(!(t instanceof Ja))return;for(var s=t,m=parseInt("".concat(s.GetVertexCount()),10),_=s.GetVertices(),$=new Array(m),c=0;c<m;++c)$[c]=B(e,_[c]);this.m_debugDraw.DrawSolidPolygon($,m,r);break;case q.e_edgeShape:if(!(t instanceof Fg))return;var l=t;this.m_debugDraw.DrawSegment(B(e,l.GetVertex1()),B(e,l.GetVertex2()),r);}}}]),t}();T.s_timestep2=new Yf,T.s_xf=new $,T.s_backupA=new db,T.s_backupB=new db,T.s_timestep=new Yf,T.s_queue=new Array,T.s_jointColor=new nl(.5,.8,.8),T.e_newFixture=1,T.e_locked=2,T.m_warmStarting=!0,T.m_continuousPhysics=!0;function CD(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}var Cj=function t(){CD(this,t),this.filter=new Ok,this.shape=void 0,this.userData=void 0,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0};var j=function(){function t(e,i){Ix(this,t),this.m_world=i,this.m_xf=new $,this.m_sweep=new db,this.m_linearVelocity=new k,this.m_angularVelocity=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_force=new k,this.m_torque=0,this.m_flags=0,this.m_islandIndex=0,this.m_flags=0,e.bullet&&(this.m_flags|=t.e_bulletFlag),e.fixedRotation&&(this.m_flags|=t.e_fixedRotationFlag),e.allowSleep&&(this.m_flags|=t.e_allowSleepFlag),e.awake&&(this.m_flags|=t.e_awakeFlag),e.active&&(this.m_flags|=t.e_activeFlag),this.m_xf.position.SetV(e.position),this.m_xf.R.Set(e.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=e.angle;var s=this.m_xf.R,a=this.m_sweep.localCenter;this.m_sweep.c.x=s.col1.x*a.x+s.col2.x*a.y,this.m_sweep.c.y=s.col1.y*a.x+s.col2.y*a.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=e.type,this.m_type===t.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=e.inertiaScale,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0}return Kx(t,[{key:"connectEdges",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=Math.atan2(e.GetDirectionVector().y,e.GetDirectionVector().x),a=Math.tan(.5*(s-i)),n=Km(a,e.GetDirectionVector());n=z(n,e.GetNormalVector()),n=Km(Cc,n),n=Wc(n,e.GetVertex1());var o=Wc(t.GetDirectionVector(),e.GetDirectionVector());o.Normalize();var r=F(t.GetDirectionVector(),e.GetNormalVector())>0;return t.SetNextEdge(e,n,o,r),e.SetPrevEdge(t,n,o,r),s}},{key:"CreateFixture",value:function(e){if(this.m_world&&!this.m_world.IsLocked()){var i=new Sc;if(i.Create(this,this.m_xf,e),this.m_flags&t.e_activeFlag){var s=this.m_world.m_contactManager.m_broadPhase;i.CreateProxy(s,this.m_xf)}return i.m_next=this.m_fixtureList,this.m_fixtureList=i,++this.m_fixtureCount,i.m_body=this,i.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=T.e_newFixture,i}}},{key:"CreateFixture2",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=new Cj;return i.shape=t,i.density=e,this.CreateFixture(i)}},{key:"DestroyFixture",value:function(e){if(this.m_world&&!this.m_world.IsLocked()){for(var i=this.m_fixtureList,s=null;null!==i;){if(i===e){s?s.m_next=e.m_next:this.m_fixtureList=e.m_next;break}s=i,i=i.m_next}for(var a=this.m_contactList;a;){var n=a.contact;a=a.next;var o=n.GetFixtureA(),r=n.GetFixtureB();e!==o&&e!==r||this.m_world.m_contactManager.Destroy(n)}if(this.m_flags&t.e_activeFlag){var l=this.m_world.m_contactManager.m_broadPhase;e.DestroyProxy(l)}e.Destroy(),e.m_body=void 0,e.m_next=void 0,--this.m_fixtureCount,this.ResetMassData()}}},{key:"SetPositionAndAngle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.m_world&&!this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var i=this.m_xf.R,s=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*s.x+i.col2.x*s.y,this.m_sweep.c.y=i.col1.y*s.x+i.col2.y*s.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;for(var a=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(a,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}}},{key:"SetTransform",value:function(t){this.SetPositionAndAngle(t.position,t.GetAngle())}},{key:"GetTransform",value:function(){return this.m_xf}},{key:"GetPosition",value:function(){return this.m_xf.position}},{key:"SetPosition",value:function(t){this.SetPositionAndAngle(t,this.GetAngle())}},{key:"GetAngle",value:function(){return this.m_sweep.a}},{key:"SetAngle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.SetPositionAndAngle(this.GetPosition(),t)}},{key:"GetWorldCenter",value:function(){return this.m_sweep.c}},{key:"GetLocalCenter",value:function(){return this.m_sweep.localCenter}},{key:"SetLinearVelocity",value:function(e){this.m_type!==t.b2_staticBody&&this.m_linearVelocity.SetV(e)}},{key:"GetLinearVelocity",value:function(){return this.m_linearVelocity}},{key:"SetAngularVelocity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_type!==t.b2_staticBody&&(this.m_angularVelocity=e)}},{key:"GetAngularVelocity",value:function(){return this.m_angularVelocity}},{key:"GetDefinition",value:function(){var e=new Jg;return e.type=this.GetType(),e.allowSleep=(this.m_flags&t.e_allowSleepFlag)===t.e_allowSleepFlag,e.angle=this.GetAngle(),e.angularDamping=this.m_angularDamping,e.angularVelocity=this.m_angularVelocity,e.fixedRotation=(this.m_flags&t.e_fixedRotationFlag)===t.e_fixedRotationFlag,e.bullet=(this.m_flags&t.e_bulletFlag)===t.e_bulletFlag,e.awake=(this.m_flags&t.e_awakeFlag)===t.e_awakeFlag,e.linearDamping=this.m_linearDamping,e.linearVelocity.SetV(this.GetLinearVelocity()),e.position=this.GetPosition(),e.userData=this.GetUserData(),e}},{key:"ApplyForce",value:function(e,i){this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=e.x,this.m_force.y+=e.y,this.m_torque+=(i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x)}},{key:"ApplyTorque",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_torque+=e)}},{key:"ApplyImpulse",value:function(e,i){this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y,this.m_angularVelocity+=this.m_invI*((i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x))}},{key:"Split",value:function(t){if(this.m_world&&!this.m_world.IsLocked()){var e=this.GetLinearVelocity().Copy(),i=this.GetAngularVelocity(),s=this.GetWorldCenter(),a=this.m_world.CreateBody(this.GetDefinition());if(a){for(var n,o=this.m_fixtureList;o;)if(t(o)){var r=o.m_next;n?n.m_next=r:this.m_fixtureList=r,this.m_fixtureCount--,o.m_next=a.m_fixtureList,a.m_fixtureList=o,a.m_fixtureCount++,o.m_body=a,o=r}else n=o,o=o.m_next;this.ResetMassData(),a.ResetMassData();var l=this.GetWorldCenter(),m=a.GetWorldCenter(),_=Wc(e,id(i,z(l,s))),h=Wc(e,id(i,z(m,s)));return this.SetLinearVelocity(_),a.SetLinearVelocity(h),this.SetAngularVelocity(i),a.SetAngularVelocity(i),this.SynchronizeFixtures(),a.SynchronizeFixtures(),a}}}},{key:"Merge",value:function(t){for(var e=t,i=t.m_fixtureList;i;){var s=i.m_next;t.m_fixtureCount--,i.m_next=this.m_fixtureList,this.m_fixtureList=i,this.m_fixtureCount++,i.m_body=e,i=s}this.m_fixtureCount=0,this.ResetMassData(),this.SynchronizeFixtures()}},{key:"GetMass",value:function(){return this.m_mass}},{key:"GetInertia",value:function(){return this.m_I}},{key:"GetMassData",value:function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)}},{key:"SetMassData",value:function(e){if(this.m_world&&!this.m_world.IsLocked()&&(aa(!1===this.m_world.IsLocked()),this.m_type===t.b2_dynamicBody)){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&t.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(B(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}}},{key:"ResetMassData",value:function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!==t.b2_staticBody&&this.m_type!==t.b2_kinematicBody){for(var e=k.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!==i.m_density){var s=i.GetMassData();this.m_mass+=s.mass,e.x+=s.center.x*s.mass,e.y+=s.center.y*s.mass,this.m_I+=s.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&t.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,aa(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var a=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(B(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-a.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-a.x)}}},{key:"GetWorldPoint",value:function(t){var e=this.m_xf.R,i=new k(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i}},{key:"GetWorldVector",value:function(t){return fb(this.m_xf.R,t)}},{key:"GetLocalPoint",value:function(t){return tx(this.m_xf,t)}},{key:"GetLocalVector",value:function(t){return Da(this.m_xf.R,t)}},{key:"GetLinearVelocityFromWorldPoint",value:function(t){return new k(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))}},{key:"GetLinearVelocityFromLocalPoint",value:function(t){var e=this.m_xf.R,i=new k(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new k(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))}},{key:"GetLinearDamping",value:function(){return this.m_linearDamping}},{key:"SetLinearDamping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_linearDamping=t}},{key:"GetAngularDamping",value:function(){return this.m_angularDamping}},{key:"SetAngularDamping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_angularDamping=t}},{key:"SetType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.m_type!==e){this.m_type=e,this.ResetMassData(),this.m_type===t.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var i=this.m_contactList;i;i=i.next)i.contact.FlagForFiltering()}}},{key:"GetType",value:function(){return this.m_type}},{key:"SetBullet",value:function(e){e?this.m_flags|=t.e_bulletFlag:this.m_flags&=~t.e_bulletFlag}},{key:"IsBullet",value:function(){return(this.m_flags&t.e_bulletFlag)===t.e_bulletFlag}},{key:"SetSleepingAllowed",value:function(e){e?this.m_flags|=t.e_allowSleepFlag:(this.m_flags&=~t.e_allowSleepFlag,this.SetAwake(!0))}},{key:"SetAwake",value:function(e){e?(this.m_flags|=t.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~t.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)}},{key:"IsAwake",value:function(){return(this.m_flags&t.e_awakeFlag)===t.e_awakeFlag}},{key:"SetFixedRotation",value:function(e){e?this.m_flags|=t.e_fixedRotationFlag:this.m_flags&=~t.e_fixedRotationFlag,this.ResetMassData()}},{key:"IsFixedRotation",value:function(){return(this.m_flags&t.e_fixedRotationFlag)===t.e_fixedRotationFlag}},{key:"SetActive",value:function(e){if(e!==this.IsActive()&&this.m_world&&!this.m_world.IsLocked()){var i=this.m_world.m_contactManager.m_broadPhase;if(e){this.m_flags|=t.e_activeFlag;for(var s=this.m_fixtureList;s;s=s.m_next)s.CreateProxy(i,this.m_xf)}else{this.m_flags&=~t.e_activeFlag;for(var a=this.m_fixtureList;a;a=a.m_next)a.DestroyProxy(i);for(var n=this.m_contactList;n;){var o=n;n=n.next,this.m_world.m_contactManager.Destroy(o.contact)}this.m_contactList=null}}}},{key:"IsActive",value:function(){return(this.m_flags&t.e_activeFlag)===t.e_activeFlag}},{key:"IsSleepingAllowed",value:function(){return(this.m_flags&t.e_allowSleepFlag)===t.e_allowSleepFlag}},{key:"GetFixtureList",value:function(){return this.m_fixtureList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetControllerList",value:function(){return this.m_controllerList}},{key:"GetContactList",value:function(){return this.m_contactList}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(t){this.m_userData=t}},{key:"GetWorld",value:function(){return this.m_world}},{key:"SynchronizeFixtures",value:function(){if(this.m_world&&!this.m_world.IsLocked()){var e=t.s_xf1;e.R.Set(this.m_sweep.a0);var i=e.R,s=this.m_sweep.localCenter;e.position.x=this.m_sweep.c0.x-(i.col1.x*s.x+i.col2.x*s.y),e.position.y=this.m_sweep.c0.y-(i.col1.y*s.x+i.col2.y*s.y);for(var a=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(a,e,this.m_xf)}}},{key:"SynchronizeTransform",value:function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)}},{key:"ShouldCollide",value:function(e){if(this.m_type!==t.b2_dynamicBody&&e.m_type!==t.b2_dynamicBody)return!1;for(var i=this.m_jointList;i;i=i.next)if(i.other===e&&!1===i.joint.m_collideConnected)return!1;return!0}},{key:"Advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()}}]),t}();j.s_xf1=new $,j.e_islandFlag=1,j.e_awakeFlag=2,j.e_allowSleepFlag=4,j.e_bulletFlag=8,j.e_fixedRotationFlag=16,j.e_activeFlag=32,j.b2_staticBody=0,j.b2_kinematicBody=1,j.b2_dynamicBody=2;var Jg=function t(){Hx(this,t),this.position=new k,this.linearVelocity=new k,this.angle=0,this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=j.b2_staticBody,this.active=!0,this.inertiaScale=1};var nd=30;function HD(e){var r=e.canvas,t=new T(new k(0,30),!1),$=new Cj;$.density=1,$.friction=.5,$.restitution=.2;var o=new Jg;o.type=j.b2_staticBody,$.shape=new Ja;var i=r.width/nd,s=r.height/nd;$.shape.SetAsBox(i/2,1),o.position.Set(i/2,-1),t.CreateBody(o).CreateFixture($),o.position.Set(i/2,s+1),t.CreateBody(o).CreateFixture($),$.shape.SetAsBox(1,s/2),o.position.Set(-1,s/2),t.CreateBody(o).CreateFixture($),o.position.Set(i+1,s/2),t.CreateBody(o).CreateFixture($),o.type=j.b2_dynamicBody,$.shape=new Nb(i/8),o.position.Set(i/2,s/2),t.CreateBody(o).CreateFixture($);var a=new M;a.SetDrawScale(nd),a.SetSprite(e),a.SetFillAlpha(.5),a.SetLineThickness(1),a.SetFlags(M.e_shapeBit|M.e_jointBit),t.SetDebugDraw(a);return requestAnimationFrame(function e(r){requestAnimationFrame(e),t.Step(1/60,5,5),t.DrawDebugData(),t.ClearForces()}),t}var Kg={},JD=(Hd(),ya).Buffer;function Aj(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,r=new Uint8Array(e);return e>0&&crypto.getRandomValues(r),JD.from(r.buffer)}Kg.default=Aj;var LD=document.querySelector("ul"),Lg=document.querySelector("pre"),ND=document.querySelector("canvas"),_b=function(e){Lg.textContent+=e,Lg.scrollTo({top:Lg.scrollHeight,behavior:"smooth"})},PD=location,iB=PD.href,Ev=iB.replace("/host","/player"),Yg=Aj().toString("hex").slice(0,7);location.hash="#".concat(Yg);var cs={color:{light:"#ffffff66"}};hs(ND,"".concat(Ev,"#").concat(Yg),cs,function(e){e&&_b("qrcode error:\n".concat(e.message))});var Ya={};var im=function(e){requestAnimationFrame(im),Object.entries(Ya).forEach(function(e){var r=hm(e,2),t=r[0],a=r[1].orientation,n=document.getElementById("connection-".concat(t));if(n){var o=n.querySelector("p");if(o){var $=Eh(a);$[1]=-$[1],$[4]=-$[4];var c="matrix3d(".concat($.join(","),")");n.style.transform=c}}})};requestAnimationFrame(im);var gm=function(e){Ya[e]&&(Ya[e].host.destroy(),delete Ya[e]);var r=document.getElementById("connection-".concat(e));r&&r.remove()};Rh.signInAnonymously().then(function(e){if(e&&e.user){var r=e.user.uid,t=Gh.ref("/rooms/".concat(Yg)),a=t.child("/connections").ref;t.onDisconnect().set(null);a.on("child_added",function(e){if(e&&e.key){var $Jlv9$$interop$default=_g(Vk);var t=e.key,a=e.child("offer").ref,n=e.child("answer").ref,o=new $Jlv9$$interop$default.d({initiator:!1,trickle:!1});Ya[t]={orientation:[0,0,0,1],host:o};var $=document.createElement("li");$.id="connection-".concat(t);var c,i=document.createElement("canvas");$.append(i);var d=function(e){e?_b("error:\n".concat(e.message,"\n\n")):Ya[t]&&_b("connection: ".concat(t," - disconnected\n")),gm(t)};o.on("signal",function(e){"answer"===e.type&&n.set(Object.assign({},e,{uid:r}))}).on("connect",function(){_b("connection: ".concat(t," - connected\n")),LD.appendChild($);var e=new Date().toLocaleTimeString();o.send(JSON.stringify({host:t,time:e}))}).on("error",d).on("close",d).on("end",d).on("data",function(e){var r=JSON.parse(e),a=r.time,n=r.player,d=r.width,y=r.height,l=r.orientation;if(a){var s=new Date().toLocaleTimeString();_b("\nplayer: ".concat(n," - added\nplayer time: ").concat(a,"\nhost time: ").concat(s,"\n\n")),$.style.width=i.style.width="".concat(d/2,"px"),$.style.height=i.style.height="".concat(y/2,"px"),i.width=d/2,i.height=y/2,c=HD(i.getContext("2d"));var v=document.createElement("p");$.append(v),v.innerText=n;var x=360*Math.random(),u=(x+120*(1+Math.round(Math.random())))%360,G=Math.round(Math.random())?"linear-gradient(hsl(".concat(x,", 80%, 50%), hsl(").concat(u,", 80%, 50%))"):"radial-gradient(circle at center, hsl(".concat(x,", 80%, 50%), hsl(").concat(u,", 80%, 50%))");return $.style.background=G,void o.send(JSON.stringify({bkgd:G}))}var m=hm(Eh(l),2),p=m[0],h=m[1],f=new k(-h,p);f.Normalize(),f.Multiply(nd),c.SetGravity(f),Ya[t].orientation=l}),a.on("value",function(e){e&&e.val()&&o.signal(e.val())})}}),a.on("child_removed",function(e){if(e&&e.key){var r=e.key;gm(r),_b("connection: ".concat(r," - removed\n"))}})}});Td.__esModule=true;Kg.__esModule=true;return{"Jlv9":Vk,"d2yc":Td,"ZUoI":Yi,"Uuoh":{},"ela3":Kg,"Gdyx":{}};});