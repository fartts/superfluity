parcelRequire=function(e){var r="function"==typeof parcelRequire&&parcelRequire,n="function"==typeof require&&require,i={};function u(e,u){if(e in i)return i[e];var t="function"==typeof parcelRequire&&parcelRequire;if(!u&&t)return t(e,!0);if(r)return r(e,!0);if(n&&"string"==typeof e)return n(e);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}return u.register=function(e,r){i[e]=r},i=e(u),u.modules=i,u}(function (require) {function Ex(a){return a&&a.__esModule?{d:a.default}:{d:a}}var Qb=this;var a=(yd(),Tb).Buffer;function rm(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,a)}return t}function sm(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?rm(Object(t),!0).forEach(function(e){Fx(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):rm(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}function Fx(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function tm(r,e){return Jx(r)||Ix(r,e)||Hx(r,e)||Gx()}function Gx(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Hx(r,e){if(r){if("string"==typeof r)return um(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?um(r,e):void 0}}function um(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,a=new Array(e);t<e;t++)a[t]=r[t];return a}function Ix(r,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var t=[],a=!0,n=!1,o=void 0;try{for(var $,c=r[Symbol.iterator]();!(a=($=c.next()).done)&&(t.push($.value),!e||t.length!==e);a=!0);}catch(i){n=!0,o=i}finally{try{a||null==c.return||c.return()}finally{if(n)throw o}}return t}}function Jx(r){if(Array.isArray(r))return r}var hf,jf,wd,zb,Tf,Md,wj,vm,Kx=false;function xj(){throw new Error("setTimeout has not been defined")}function yj(){throw new Error("clearTimeout has not been defined")}function wm($){if(hf===setTimeout)return setTimeout($,0);if((hf===xj||!hf)&&setTimeout)return hf=setTimeout,setTimeout($,0);try{return hf($,0)}catch(e){try{return hf.call(null,$,0)}catch(e){return hf.call(this,$,0)}}}function Lx($){if(jf===clearTimeout)return clearTimeout($);if((jf===yj||!jf)&&clearTimeout)return jf=clearTimeout,clearTimeout($);try{return jf($)}catch(e){try{return jf.call(null,$)}catch(e){return jf.call(this,$)}}}function Mx(){wj&&Tf&&(wj=!1,Tf.length?Md=Tf.concat(Md):vm=-1,Md.length&&xm())}function xm(){if(!wj){var $=wm(Mx);wj=!0;for(var e=Md.length;e;){for(Tf=Md,Md=[];++vm<e;)Tf&&Tf[vm].run();vm=-1,e=Md.length}Tf=null,wj=!1,Lx($)}}function ym($,e){this.fun=$,this.array=e}function id(){}function xd(){if(Kx)return;Kx=true;wd={};zb=wd={};!function(){try{hf="function"==typeof setTimeout?setTimeout:xj}catch($){hf=xj}try{jf="function"==typeof clearTimeout?clearTimeout:yj}catch($){jf=yj}}();Md=[];wj=!1;vm=-1;zb.nextTick=function($){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];Md.push(new ym($,e)),1!==Md.length||wj||wm(xm)},ym.prototype.run=function(){this.fun.apply(null,this.array)},zb.title="browser",zb.env={},zb.argv=[],zb.version="",zb.versions={},zb.on=id,zb.addListener=id,zb.once=id,zb.off=id,zb.removeListener=id,zb.removeAllListeners=id,zb.emit=id,zb.prependListener=id,zb.prependOnceListener=id,zb.listeners=function($){return[]},zb.binding=function($){throw new Error("process.binding is not supported")},zb.cwd=function(){return"/"},zb.chdir=function($){throw new Error("process.chdir is not supported")},zb.umask=function(){return 0}}var Yb={},zm=(xd(),wd),Nx=fy;Yb.formatArgs=Nx;var Ox=hy;Yb.save=Ox;var Px=iy;Yb.load=Px;var Qx=ey;Yb.useColors=Qx;var Rx,kf,lf,mf,Nd,Sx,Tx,Ux=false;function Vx($){if(!(($=String($)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec($);if(r){var a=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return a*Tx;case"weeks":case"week":case"w":return a*Sx;case"days":case"day":case"d":return a*Nd;case"hours":case"hour":case"hrs":case"hr":case"h":return a*mf;case"minutes":case"minute":case"mins":case"min":case"m":return a*lf;case"seconds":case"second":case"secs":case"sec":case"s":return a*kf;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return;}}}}function Wx($){var r=Math.abs($);return r>=Nd?Math.round($/Nd)+"d":r>=mf?Math.round($/mf)+"h":r>=lf?Math.round($/lf)+"m":r>=kf?Math.round($/kf)+"s":$+"ms"}function Xx($){var r=Math.abs($);return r>=Nd?xg($,r,Nd,"day"):r>=mf?xg($,r,mf,"hour"):r>=lf?xg($,r,lf,"minute"):r>=kf?xg($,r,kf,"second"):$+" ms"}function xg($,r,a,s){var e=r>=1.5*a;return Math.round($/a)+" "+s+(e?"s":"")}function Yx(){if(Ux)return;Ux=true;Rx={};kf=1e3;lf=60*kf;mf=60*lf;Nd=24*mf;Sx=7*Nd;Tx=365.25*Nd;Rx=function($,r){r=r||{};var a=typeof $;if("string"===a&&$.length>0)return Vx($);if("number"===a&&isFinite($))return r.long?Xx($):Wx($);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify($))}}var Zx={};function Am(r){return by(r)||ay(r)||_x(r)||$x()}function $x(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _x(r,e){if(r){if("string"==typeof r)return zj(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?zj(r,e):void 0}}function ay(r){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}function by(r){if(Array.isArray(r))return zj(r)}function zj(r,e){(null==e||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function cy(r){function e(r){var a;function o(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];if(o.enabled){var s=o,i=Number(new Date),u=i-(a||i);s.diff=u,s.prev=a,s.curr=i,a=i,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var l=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,function(r,n){if("%%"===r)return r;l++;var a=e.formatters[n];if("function"==typeof a){var o=t[l];r=a.call(s,o),t.splice(l,1),l--}return r}),e.formatArgs.call(s,t),(s.log||e.log).apply(s,t)}}return o.namespace=r,o.enabled=e.enabled(r),o.useColors=e.useColors(),o.color=e.selectColor(r),o.destroy=t,o.extend=n,"function"==typeof e.init&&e.init(o),e.instances.push(o),o}function t(){var r=e.instances.indexOf(this);return-1!==r&&(e.instances.splice(r,1),!0)}function n(r,t){var n=e(this.namespace+(void 0===t?":":t)+r);return n.log=this.log,n}function a(r){return r.toString().substring(2,r.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(r){if(r instanceof Error)return r.stack||r.message;return r},e.disable=function(){var r=[].concat(Am(e.names.map(a)),Am(e.skips.map(a).map(function(r){return"-"+r}))).join(",");return e.enable(""),r},e.enable=function(r){var t;e.save(r),e.names=[],e.skips=[];var n=("string"==typeof r?r:"").split(/[\s,]+/),a=n.length;for(t=0;t<a;t++)n[t]&&("-"===(r=n[t].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+r.substr(1)+"$")):e.names.push(new RegExp("^"+r+"$")));for(t=0;t<e.instances.length;t++){var o=e.instances[t];o.enabled=e.enabled(o.namespace)}},e.enabled=function(r){if("*"===r[r.length-1])return!0;var t,n;for(t=0,n=e.skips.length;t<n;t++)if(e.skips[t].test(r))return!1;for(t=0,n=e.names.length;t<n;t++)if(e.names[t].test(r))return!0;return!1},e.humanize=(Yx(),Rx),Object.keys(r).forEach(function(t){e[t]=r[t]}),e.instances=[],e.names=[],e.skips=[],e.formatters={},e.selectColor=function(r){for(var t=0,n=0;n<r.length;n++)t=(t<<5)-t+r.charCodeAt(n),t|=0;return e.colors[Math.abs(t)%e.colors.length]},e.enable(e.load()),e}Zx=cy;var yg=jy();Yb.storage=yg;var dy=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function ey(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))}function fy(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+Yb.humanize(this.diff),this.useColors){var o="color: "+this.color;e.splice(1,0,o,"color: inherit");var r=0,t=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(t=r))}),e.splice(t,0,o)}}Yb.colors=dy;var gy=console.debug||console.log||function(){};function hy(e){try{e?yg.setItem("debug",e):yg.removeItem("debug")}catch(o){}}function iy(){var e;try{e=yg.getItem("debug")}catch(o){}return!e&&void 0!==zm&&"env"in zm&&(e=void 0),e}function jy(){try{return localStorage}catch(e){}}Yb.log=gy,Yb=Zx(Yb);var{formatters:ky}=Yb;ky.j=function(e){try{return JSON.stringify(e)}catch(o){return"[UnexpectedJSONParseError]: "+o.message}};var Bm={};Bm=function(){if("undefined"==typeof window)return null;var n={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};return n.RTCPeerConnection?n:null};var zg,ly,my,ny,oy=false;function Cm($){var r=$.length;if(r%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=$.indexOf("=");return-1===p&&(p=r),[p,p===r?0:4-p%4]}function py($){var r=Cm($),p=r[0],o=r[1];return 3*(p+o)/4-o}function qy($,r,p){return 3*(r+p)/4-p}function ry($){var r,p,o=Cm($),e=o[0],y=o[1],h=new $yh9p$var$Arr(qy($,e,y)),a=0,t=y>0?e-4:e;for(p=0;p<t;p+=4)r=$yh9p$var$revLookup[$.charCodeAt(p)]<<18|$yh9p$var$revLookup[$.charCodeAt(p+1)]<<12|$yh9p$var$revLookup[$.charCodeAt(p+2)]<<6|$yh9p$var$revLookup[$.charCodeAt(p+3)],h[a++]=r>>16&255,h[a++]=r>>8&255,h[a++]=255&r;return 2===y&&(r=$yh9p$var$revLookup[$.charCodeAt(p)]<<2|$yh9p$var$revLookup[$.charCodeAt(p+1)]>>4,h[a++]=255&r),1===y&&(r=$yh9p$var$revLookup[$.charCodeAt(p)]<<10|$yh9p$var$revLookup[$.charCodeAt(p+1)]<<4|$yh9p$var$revLookup[$.charCodeAt(p+2)]>>2,h[a++]=r>>8&255,h[a++]=255&r),h}function sy($){return $yh9p$var$lookup[$>>18&63]+$yh9p$var$lookup[$>>12&63]+$yh9p$var$lookup[$>>6&63]+$yh9p$var$lookup[63&$]}function ty($,r,p){for(var o,e=[],y=r;y<p;y+=3)o=($[y]<<16&16711680)+($[y+1]<<8&65280)+(255&$[y+2]),e.push(sy(o));return e.join("")}function uy($){for(var r,p=$.length,o=p%3,e=[],y=0,h=p-o;y<h;y+=16383)e.push(ty($,y,y+16383>h?h:y+16383));return 1===o?(r=$[p-1],e.push($yh9p$var$lookup[r>>2]+$yh9p$var$lookup[r<<4&63]+"==")):2===o&&(r=($[p-2]<<8)+$[p-1],e.push($yh9p$var$lookup[r>>10]+$yh9p$var$lookup[r>>4&63]+$yh9p$var$lookup[r<<2&63]+"=")),e.join("")}function vy(){if(oy)return;oy=true;zg={};ly=py;zg.byteLength=ly;my=ry;zg.toByteArray=my;ny=uy;zg.fromByteArray=ny;for(var $yh9p$var$lookup=[],$yh9p$var$revLookup=[],$yh9p$var$Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,$yh9p$var$code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$yh9p$var$i=0,$yh9p$var$len=$yh9p$var$code.length;$yh9p$var$i<$yh9p$var$len;++$yh9p$var$i)$yh9p$var$lookup[$yh9p$var$i]=$yh9p$var$code[$yh9p$var$i],$yh9p$var$revLookup[$yh9p$var$code.charCodeAt($yh9p$var$i)]=$yh9p$var$i;$yh9p$var$revLookup["-".charCodeAt(0)]=62,$yh9p$var$revLookup["_".charCodeAt(0)]=63}var Aj,wy,xy,yy=false;function zy(){if(yy)return;yy=true;Aj={};wy=function(t,r,o,a,$){var e,p,J=8*$-a-1,N=(1<<J)-1,h=N>>1,M=-7,w=o?$-1:0,f=o?-1:1,i=t[r+w];for(w+=f,e=i&(1<<-M)-1,i>>=-M,M+=J;M>0;e=256*e+t[r+w],w+=f,M-=8);for(p=e&(1<<-M)-1,e>>=-M,M+=a;M>0;p=256*p+t[r+w],w+=f,M-=8);if(0===e)e=1-h;else{if(e===N)return p?NaN:1/0*(i?-1:1);p+=Math.pow(2,a),e-=h}return(i?-1:1)*p*Math.pow(2,e-a)};Aj.read=wy;xy=function(t,r,o,a,$,e){var p,J,N,h=8*e-$-1,M=(1<<h)-1,w=M>>1,f=23===$?Math.pow(2,-24)-Math.pow(2,-77):0,i=a?0:e-1,g=a?1:-1,s=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(J=isNaN(r)?1:0,p=M):(p=Math.floor(Math.log(r)/Math.LN2),r*(N=Math.pow(2,-p))<1&&(p--,N*=2),(r+=p+w>=1?f/N:f*Math.pow(2,1-w))*N>=2&&(p++,N/=2),p+w>=M?(J=0,p=M):p+w>=1?(J=(r*N-1)*Math.pow(2,$),p+=w):(J=r*Math.pow(2,w-1)*Math.pow(2,$),p=0));$>=8;t[o+i]=255&J,i+=g,J/=256,$-=8);for(p=p<<$|J,h+=$;h>0;t[o+i]=255&p,i+=g,p/=256,h-=8);t[o+i-g]|=128*s};Aj.write=xy}var Ay,By,Cy=false;function Dy(){if(Cy)return;Cy=true;Ay={};By={}.toString;Ay=Array.isArray||function(r){return"[object Array]"==By.call(r)}}var Tb,Bj,nf,Dm,Ey,Fy,Em,Gy,Fm,Hy,Iy=false;function Jy(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(r){return!1}}function Ag(){return bb.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function jd(e,r){if(Ag()<r)throw new RangeError("Invalid typed array length");return bb.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(r)).__proto__=bb.prototype:(null===e&&(e=new bb(r)),e.length=r),e}function bb(e,r,t){if(!(bb.TYPED_ARRAY_SUPPORT||this instanceof bb))return new bb(e,r,t);if("number"==typeof e){if("string"==typeof r)throw new Error("If encoding is specified then the first argument must be a string");return Cj(this,e)}return Gm(this,e,r,t)}function Gm(e,r,t,$){if("number"==typeof r)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer?My(e,r,t,$):"string"==typeof r?Ly(e,r,t):Ny(e,r)}function Hm(e){if("number"!=typeof e)throw new TypeError("\"size\" argument must be a number");if(e<0)throw new RangeError("\"size\" argument must not be negative")}function Ky(e,r,t,$){return Hm(r),r<=0?jd(e,r):void 0!==t?"string"==typeof $?jd(e,r).fill(t,$):jd(e,r).fill(t):jd(e,r)}function Cj(e,r){if(Hm(r),e=jd(e,r<0?0:0|Ej(r)),!bb.TYPED_ARRAY_SUPPORT)for(var t=0;t<r;++t)e[t]=0;return e}function Ly(e,r,t){if("string"==typeof t&&""!==t||(t="utf8"),!bb.isEncoding(t))throw new TypeError("\"encoding\" must be a valid string encoding");var $=0|Im(r,t),n=(e=jd(e,$)).write(r,t);return n!==$&&(e=e.slice(0,n)),e}function Dj(e,r){var t=r.length<0?0:0|Ej(r.length);e=jd(e,t);for(var $=0;$<t;$+=1)e[$]=255&r[$];return e}function My(e,r,t,$){if(r.byteLength,t<0||r.byteLength<t)throw new RangeError("'offset' is out of bounds");if(r.byteLength<t+($||0))throw new RangeError("'length' is out of bounds");return r=void 0===t&&void 0===$?new Uint8Array(r):void 0===$?new Uint8Array(r,t):new Uint8Array(r,t,$),bb.TYPED_ARRAY_SUPPORT?(e=r).__proto__=bb.prototype:e=Dj(e,r),e}function Ny(e,r){if(bb.isBuffer(r)){var t=0|Ej(r.length);return 0===(e=jd(e,t)).length?e:(r.copy(e,0,0,t),e)}if(r){if("undefined"!=typeof ArrayBuffer&&r.buffer instanceof ArrayBuffer||"length"in r)return"number"!=typeof r.length||ez(r.length)?jd(e,0):Dj(e,r);if("Buffer"===r.type&&Dm(r.data))return Dj(e,r.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Ej(e){if(e>=Ag())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ag().toString(16)+" bytes");return 0|e}function Oy(e){return+e!=e&&(e=0),bb.alloc(+e)}function Im(e,r){if(bb.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var t=e.length;if(0===t)return 0;for(var $=!1;;)switch(r){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":case void 0:return Dg(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t;case"hex":return t>>>1;case"base64":return Qm(e).length;default:if($)return Dg(e).length;r=(""+r).toLowerCase(),$=!0;}}function Py(e,r,t){var $=!1;if((void 0===r||r<0)&&(r=0),r>this.length)return"";if((void 0===t||t>this.length)&&(t=this.length),t<=0)return"";if((t>>>=0)<=(r>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return Zy(this,r,t);case"utf8":case"utf-8":return Mm(this,r,t);case"ascii":return Xy(this,r,t);case"latin1":case"binary":return Yy(this,r,t);case"base64":return Vy(this,r,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $y(this,r,t);default:if($)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),$=!0;}}function Od(e,r,t){var $=e[r];e[r]=e[t],e[t]=$}function Jm(e,r,t,$,n){if(0===e.length)return-1;if("string"==typeof t?($=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,isNaN(t)&&(t=n?0:e.length-1),t<0&&(t=e.length+t),t>=e.length){if(n)return-1;t=e.length-1}else if(t<0){if(!n)return-1;t=0}if("string"==typeof r&&(r=bb.from(r,$)),bb.isBuffer(r))return 0===r.length?-1:Km(e,r,t,$,n);if("number"==typeof r)return r&=255,bb.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,r,t):Uint8Array.prototype.lastIndexOf.call(e,r,t):Km(e,[r],t,$,n);throw new TypeError("val must be string, number or Buffer")}function Km(e,r,t,$,n){var f,a=1,i=e.length,o=r.length;if(void 0!==$&&("ucs2"===($=String($).toLowerCase())||"ucs-2"===$||"utf16le"===$||"utf-16le"===$)){if(e.length<2||r.length<2)return-1;a=2,i/=2,o/=2,t/=2}function u(e,r){return 1===a?e[r]:e.readUInt16BE(r*a)}if(n){var p=-1;for(f=t;f<i;f++)if(u(e,f)===u(r,-1===p?0:f-p)){if(-1===p&&(p=f),f-p+1===o)return p*a}else-1!==p&&(f-=f-p),p=-1}else for(t+o>i&&(t=i-o),f=t;f>=0;f--){for(var s=!0,h=0;h<o;h++)if(u(e,f+h)!==u(r,h)){s=!1;break}if(s)return f}return-1}function Qy(e,r,t,$){t=Number(t)||0;var n=e.length-t;$?($=Number($))>n&&($=n):$=n;var f=r.length;if(f%2!=0)throw new TypeError("Invalid hex string");$>f/2&&($=f/2);for(var a=0;a<$;++a){var i=parseInt(r.substr(2*a,2),16);if(isNaN(i))return a;e[t+a]=i}return a}function Ry(e,r,t,$){return Eg(Dg(r,e.length-t),e,t,$)}function Lm(e,r,t,$){return Eg(cz(r),e,t,$)}function Sy(e,r,t,$){return Lm(e,r,t,$)}function Ty(e,r,t,$){return Eg(Qm(r),e,t,$)}function Uy(e,r,t,$){return Eg(dz(r,e.length-t),e,t,$)}function Vy(e,r,t){return 0===r&&t===e.length?Bj.fromByteArray(e):Bj.fromByteArray(e.slice(r,t))}function Mm(e,r,t){t=Math.min(e.length,t);for(var $=[],n=r;n<t;){var f,a,i,o,u=e[n],p=null,s=u>239?4:u>223?3:u>191?2:1;if(n+s<=t)switch(s){case 1:u<128&&(p=u);break;case 2:128==(192&(f=e[n+1]))&&(o=(31&u)<<6|63&f)>127&&(p=o);break;case 3:f=e[n+1],a=e[n+2],128==(192&f)&&128==(192&a)&&(o=(15&u)<<12|(63&f)<<6|63&a)>2047&&(o<55296||o>57343)&&(p=o);break;case 4:f=e[n+1],a=e[n+2],i=e[n+3],128==(192&f)&&128==(192&a)&&128==(192&i)&&(o=(15&u)<<18|(63&f)<<12|(63&a)<<6|63&i)>65535&&o<1114112&&(p=o);}null===p?(p=65533,s=1):p>65535&&(p-=65536,$.push(p>>>10&1023|55296),p=56320|1023&p),$.push(p),n+=s}return Wy($)}function Wy(e){var r=e.length;if(r<=Fm)return String.fromCharCode.apply(String,e);for(var t="",$=0;$<r;)t+=String.fromCharCode.apply(String,e.slice($,$+=Fm));return t}function Xy(e,r,t){var $="";t=Math.min(e.length,t);for(var n=r;n<t;++n)$+=String.fromCharCode(127&e[n]);return $}function Yy(e,r,t){var $="";t=Math.min(e.length,t);for(var n=r;n<t;++n)$+=String.fromCharCode(e[n]);return $}function Zy(e,r,t){var $=e.length;(!r||r<0)&&(r=0),(!t||t<0||t>$)&&(t=$);for(var n="",f=r;f<t;++f)n+=bz(e[f]);return n}function $y(e,r,t){for(var $=e.slice(r,t),n="",f=0;f<$.length;f+=2)n+=String.fromCharCode($[f]+256*$[f+1]);return n}function Cb(e,r,t){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+r>t)throw new RangeError("Trying to access beyond buffer length")}function Nb(e,r,t,$,n,f){if(!bb.isBuffer(e))throw new TypeError("\"buffer\" argument must be a Buffer instance");if(r>n||r<f)throw new RangeError("\"value\" argument is out of bounds");if(t+$>e.length)throw new RangeError("Index out of range")}function Bg(e,r,t,$){r<0&&(r=65535+r+1);for(var n=0,f=Math.min(e.length-t,2);n<f;++n)e[t+n]=(r&255<<8*($?n:1-n))>>>8*($?n:1-n)}function Cg(e,r,t,$){r<0&&(r=4294967295+r+1);for(var n=0,f=Math.min(e.length-t,4);n<f;++n)e[t+n]=r>>>8*($?n:3-n)&255}function Nm(e,r,t,$,n,f){if(t+$>e.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Om(e,r,t,$,n){return n||Nm(e,r,t,4,3.4028234663852886e38,-3.4028234663852886e38),nf.write(e,r,t,$,23,4),t+4}function Pm(e,r,t,$,n){return n||Nm(e,r,t,8,1.7976931348623157e308,-1.7976931348623157e308),nf.write(e,r,t,$,52,8),t+8}function _y(e){if((e=az(e).replace(Hy,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function az(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function bz(e){return e<16?"0"+e.toString(16):e.toString(16)}function Dg(e,r){var t;r=r||1/0;for(var $=e.length,n=null,f=[],a=0;a<$;++a){if((t=e.charCodeAt(a))>55295&&t<57344){if(!n){if(t>56319){(r-=3)>-1&&f.push(239,191,189);continue}if(a+1===$){(r-=3)>-1&&f.push(239,191,189);continue}n=t;continue}if(t<56320){(r-=3)>-1&&f.push(239,191,189),n=t;continue}t=65536+(n-55296<<10|t-56320)}else n&&(r-=3)>-1&&f.push(239,191,189);if(n=null,t<128){if((r-=1)<0)break;f.push(t)}else if(t<2048){if((r-=2)<0)break;f.push(t>>6|192,63&t|128)}else if(t<65536){if((r-=3)<0)break;f.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;f.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return f}function cz(e){for(var r=[],t=0;t<e.length;++t)r.push(255&e.charCodeAt(t));return r}function dz(e,r){for(var t,$,n,f=[],a=0;a<e.length&&!((r-=2)<0);++a)$=(t=e.charCodeAt(a))>>8,n=t%256,f.push(n),f.push($);return f}function Qm(e){return Bj.toByteArray(_y(e))}function Eg(e,r,t,$){for(var n=0;n<$&&!(n+t>=r.length||n>=e.length);++n)r[n+t]=e[n];return n}function ez(e){return e!=e}function yd(){if(Iy)return;Iy=true;Tb={};Bj=(vy(),zg);nf=(zy(),Aj);Dm=(Dy(),Ay);Ey=bb;Tb.Buffer=Ey;Fy=Oy;Tb.SlowBuffer=Fy;Em=50;Tb.INSPECT_MAX_BYTES=Em,bb.TYPED_ARRAY_SUPPORT=void 0!==Qb.TYPED_ARRAY_SUPPORT?Qb.TYPED_ARRAY_SUPPORT:Jy();Gy=Ag();Tb.kMaxLength=Gy,bb.poolSize=8192,bb._augment=function(e){return e.__proto__=bb.prototype,e},bb.from=function(e,r,t){return Gm(null,e,r,t)},bb.TYPED_ARRAY_SUPPORT&&(bb.prototype.__proto__=Uint8Array.prototype,bb.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&bb[Symbol.species]===bb&&Object.defineProperty(bb,Symbol.species,{value:null,configurable:!0})),bb.alloc=function(e,r,t){return Ky(null,e,r,t)},bb.allocUnsafe=function(e){return Cj(null,e)},bb.allocUnsafeSlow=function(e){return Cj(null,e)},bb.isBuffer=function(e){return!(null==e||!e._isBuffer)},bb.compare=function(e,r){if(!bb.isBuffer(e)||!bb.isBuffer(r))throw new TypeError("Arguments must be Buffers");if(e===r)return 0;for(var t=e.length,$=r.length,n=0,f=Math.min(t,$);n<f;++n)if(e[n]!==r[n]){t=e[n],$=r[n];break}return t<$?-1:$<t?1:0},bb.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1;}},bb.concat=function(e,r){if(!Dm(e))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===e.length)return bb.alloc(0);var t;if(void 0===r)for(r=0,t=0;t<e.length;++t)r+=e[t].length;var $=bb.allocUnsafe(r),n=0;for(t=0;t<e.length;++t){var f=e[t];if(!bb.isBuffer(f))throw new TypeError("\"list\" argument must be an Array of Buffers");f.copy($,n),n+=f.length}return $},bb.byteLength=Im,bb.prototype._isBuffer=!0,bb.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)Od(this,r,r+1);return this},bb.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)Od(this,r,r+3),Od(this,r+1,r+2);return this},bb.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)Od(this,r,r+7),Od(this,r+1,r+6),Od(this,r+2,r+5),Od(this,r+3,r+4);return this},bb.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?Mm(this,0,e):Py.apply(this,arguments)},bb.prototype.equals=function(e){if(!bb.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===bb.compare(this,e)},bb.prototype.inspect=function(){var e="",r=Em;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},bb.prototype.compare=function(e,r,t,$,n){if(!bb.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===r&&(r=0),void 0===t&&(t=e?e.length:0),void 0===$&&($=0),void 0===n&&(n=this.length),r<0||t>e.length||$<0||n>this.length)throw new RangeError("out of range index");if($>=n&&r>=t)return 0;if($>=n)return-1;if(r>=t)return 1;if(this===e)return 0;for(var f=(n>>>=0)-($>>>=0),a=(t>>>=0)-(r>>>=0),i=Math.min(f,a),o=this.slice($,n),u=e.slice(r,t),p=0;p<i;++p)if(o[p]!==u[p]){f=o[p],a=u[p];break}return f<a?-1:a<f?1:0},bb.prototype.includes=function(e,r,t){return-1!==this.indexOf(e,r,t)},bb.prototype.indexOf=function(e,r,t){return Jm(this,e,r,t,!0)},bb.prototype.lastIndexOf=function(e,r,t){return Jm(this,e,r,t,!1)},bb.prototype.write=function(e,r,t,$){if(void 0===r)$="utf8",t=this.length,r=0;else if(void 0===t&&"string"==typeof r)$=r,t=this.length,r=0;else{if(!isFinite(r))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");r|=0,isFinite(t)?(t|=0,void 0===$&&($="utf8")):($=t,t=void 0)}var n=this.length-r;if((void 0===t||t>n)&&(t=n),e.length>0&&(t<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");$||($="utf8");for(var f=!1;;)switch($){case"hex":return Qy(this,e,r,t);case"utf8":case"utf-8":return Ry(this,e,r,t);case"ascii":return Lm(this,e,r,t);case"latin1":case"binary":return Sy(this,e,r,t);case"base64":return Ty(this,e,r,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Uy(this,e,r,t);default:if(f)throw new TypeError("Unknown encoding: "+$);$=(""+$).toLowerCase(),f=!0;}},bb.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};Fm=4096;bb.prototype.slice=function(e,r){var t,$=this.length;if((e=~~e)<0?(e+=$)<0&&(e=0):e>$&&(e=$),(r=void 0===r?$:~~r)<0?(r+=$)<0&&(r=0):r>$&&(r=$),r<e&&(r=e),bb.TYPED_ARRAY_SUPPORT)(t=this.subarray(e,r)).__proto__=bb.prototype;else{var n=r-e;t=new bb(n,void 0);for(var f=0;f<n;++f)t[f]=this[f+e]}return t},bb.prototype.readUIntLE=function(e,r,t){e|=0,r|=0,t||Cb(e,r,this.length);for(var $=this[e],n=1,f=0;++f<r&&(n*=256);)$+=this[e+f]*n;return $},bb.prototype.readUIntBE=function(e,r,t){e|=0,r|=0,t||Cb(e,r,this.length);for(var $=this[e+--r],n=1;r>0&&(n*=256);)$+=this[e+--r]*n;return $},bb.prototype.readUInt8=function(e,r){return r||Cb(e,1,this.length),this[e]},bb.prototype.readUInt16LE=function(e,r){return r||Cb(e,2,this.length),this[e]|this[e+1]<<8},bb.prototype.readUInt16BE=function(e,r){return r||Cb(e,2,this.length),this[e]<<8|this[e+1]},bb.prototype.readUInt32LE=function(e,r){return r||Cb(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},bb.prototype.readUInt32BE=function(e,r){return r||Cb(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},bb.prototype.readIntLE=function(e,r,t){e|=0,r|=0,t||Cb(e,r,this.length);for(var $=this[e],n=1,f=0;++f<r&&(n*=256);)$+=this[e+f]*n;return $>=(n*=128)&&($-=Math.pow(2,8*r)),$},bb.prototype.readIntBE=function(e,r,t){e|=0,r|=0,t||Cb(e,r,this.length);for(var $=r,n=1,f=this[e+--$];$>0&&(n*=256);)f+=this[e+--$]*n;return f>=(n*=128)&&(f-=Math.pow(2,8*r)),f},bb.prototype.readInt8=function(e,r){return r||Cb(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},bb.prototype.readInt16LE=function(e,r){r||Cb(e,2,this.length);var t=this[e]|this[e+1]<<8;return 32768&t?4294901760|t:t},bb.prototype.readInt16BE=function(e,r){r||Cb(e,2,this.length);var t=this[e+1]|this[e]<<8;return 32768&t?4294901760|t:t},bb.prototype.readInt32LE=function(e,r){return r||Cb(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},bb.prototype.readInt32BE=function(e,r){return r||Cb(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},bb.prototype.readFloatLE=function(e,r){return r||Cb(e,4,this.length),nf.read(this,e,!0,23,4)},bb.prototype.readFloatBE=function(e,r){return r||Cb(e,4,this.length),nf.read(this,e,!1,23,4)},bb.prototype.readDoubleLE=function(e,r){return r||Cb(e,8,this.length),nf.read(this,e,!0,52,8)},bb.prototype.readDoubleBE=function(e,r){return r||Cb(e,8,this.length),nf.read(this,e,!1,52,8)},bb.prototype.writeUIntLE=function(e,r,t,$){(e=+e,r|=0,t|=0,$)||Nb(this,e,r,t,Math.pow(2,8*t)-1,0);var n=1,f=0;for(this[r]=255&e;++f<t&&(n*=256);)this[r+f]=e/n&255;return r+t},bb.prototype.writeUIntBE=function(e,r,t,$){(e=+e,r|=0,t|=0,$)||Nb(this,e,r,t,Math.pow(2,8*t)-1,0);var n=t-1,f=1;for(this[r+n]=255&e;--n>=0&&(f*=256);)this[r+n]=e/f&255;return r+t},bb.prototype.writeUInt8=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,1,255,0),bb.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[r]=255&e,r+1},bb.prototype.writeUInt16LE=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,2,65535,0),bb.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):Bg(this,e,r,!0),r+2},bb.prototype.writeUInt16BE=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,2,65535,0),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):Bg(this,e,r,!1),r+2},bb.prototype.writeUInt32LE=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,4,4294967295,0),bb.TYPED_ARRAY_SUPPORT?(this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=255&e):Cg(this,e,r,!0),r+4},bb.prototype.writeUInt32BE=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,4,4294967295,0),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):Cg(this,e,r,!1),r+4},bb.prototype.writeIntLE=function(e,r,t,$){if(e=+e,r|=0,!$){var n=Math.pow(2,8*t-1);Nb(this,e,r,t,n-1,-n)}var f=0,a=1,i=0;for(this[r]=255&e;++f<t&&(a*=256);)e<0&&0===i&&0!==this[r+f-1]&&(i=1),this[r+f]=(e/a>>0)-i&255;return r+t},bb.prototype.writeIntBE=function(e,r,t,$){if(e=+e,r|=0,!$){var n=Math.pow(2,8*t-1);Nb(this,e,r,t,n-1,-n)}var f=t-1,a=1,i=0;for(this[r+f]=255&e;--f>=0&&(a*=256);)e<0&&0===i&&0!==this[r+f+1]&&(i=1),this[r+f]=(e/a>>0)-i&255;return r+t},bb.prototype.writeInt8=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,1,127,-128),bb.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[r]=255&e,r+1},bb.prototype.writeInt16LE=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,2,32767,-32768),bb.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8):Bg(this,e,r,!0),r+2},bb.prototype.writeInt16BE=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,2,32767,-32768),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>8,this[r+1]=255&e):Bg(this,e,r,!1),r+2},bb.prototype.writeInt32LE=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,4,2147483647,-2147483648),bb.TYPED_ARRAY_SUPPORT?(this[r]=255&e,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24):Cg(this,e,r,!0),r+4},bb.prototype.writeInt32BE=function(e,r,t){return e=+e,r|=0,t||Nb(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),bb.TYPED_ARRAY_SUPPORT?(this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=255&e):Cg(this,e,r,!1),r+4},bb.prototype.writeFloatLE=function(e,r,t){return Om(this,e,r,!0,t)},bb.prototype.writeFloatBE=function(e,r,t){return Om(this,e,r,!1,t)},bb.prototype.writeDoubleLE=function(e,r,t){return Pm(this,e,r,!0,t)},bb.prototype.writeDoubleBE=function(e,r,t){return Pm(this,e,r,!1,t)},bb.prototype.copy=function(e,r,t,$){if(t||(t=0),$||0===$||($=this.length),r>=e.length&&(r=e.length),r||(r=0),$>0&&$<t&&($=t),$===t)return 0;if(0===e.length||0===this.length)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if($<0)throw new RangeError("sourceEnd out of bounds");$>this.length&&($=this.length),e.length-r<$-t&&($=e.length-r+t);var n,f=$-t;if(this===e&&t<r&&r<$)for(n=f-1;n>=0;--n)e[n+r]=this[n+t];else if(f<1e3||!bb.TYPED_ARRAY_SUPPORT)for(n=0;n<f;++n)e[n+r]=this[n+t];else Uint8Array.prototype.set.call(e,this.subarray(t,t+f),r);return f},bb.prototype.fill=function(e,r,t,$){if("string"==typeof e){if("string"==typeof r?($=r,r=0,t=this.length):"string"==typeof t&&($=t,t=this.length),1===e.length){var n=e.charCodeAt(0);n<256&&(e=n)}if(void 0!==$&&"string"!=typeof $)throw new TypeError("encoding must be a string");if("string"==typeof $&&!bb.isEncoding($))throw new TypeError("Unknown encoding: "+$)}else"number"==typeof e&&(e&=255);if(r<0||this.length<r||this.length<t)throw new RangeError("Out of range index");if(t<=r)return this;var f;if(r>>>=0,t=void 0===t?this.length:t>>>0,e||(e=0),"number"==typeof e)for(f=r;f<t;++f)this[f]=e;else{var a=bb.isBuffer(e)?e:Dg(new bb(e,$).toString()),i=a.length;for(f=0;f<t-r;++f)this[f+r]=a[f%i]}return this};Hy=/[^+\/0-9A-Za-z-_]/g}var fz,Fg,Gg,cd,gz=false;function Rm(r,$){for(var f in r)$[f]=r[f]}function Pd(r,$,f){return cd(r,$,f)}function Sm(){if(gz)return;gz=true;Fg={};Gg=(yd(),Tb);cd=Gg.Buffer;cd.from&&cd.alloc&&cd.allocUnsafe&&cd.allocUnsafeSlow?Fg=Gg:(Rm(Gg,Fg),fz=Pd,Fg.Buffer=fz),Pd.prototype=Object.create(cd.prototype),Rm(cd,Pd),Pd.from=function(r,$,f){if("number"==typeof r)throw new TypeError("Argument must not be a number");return cd(r,$,f)},Pd.alloc=function(r,$,f){if("number"!=typeof r)throw new TypeError("Argument must be a number");var u=cd(r);return void 0!==$?"string"==typeof f?u.fill($,f):u.fill($):u.fill(0),u},Pd.allocUnsafe=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return cd(r)},Pd.allocUnsafeSlow=function(r){if("number"!=typeof r)throw new TypeError("Argument must be a number");return Gg.SlowBuffer(r)}}var Tm={},hz=(xd(),wd),Fj=65536,iz=4294967295;function jz(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}var kz=(Sm(),Fg).Buffer,Hg=Qb.crypto||Qb.msCrypto;function lz(r,$){if(r>iz)throw new RangeError("requested too many random bytes");var e=kz.allocUnsafe(r);if(r>0)if(r>Fj)for(var o=0;o<r;o+=Fj)Hg.getRandomValues(e.slice(o,o+Fj));else Hg.getRandomValues(e);return"function"==typeof $?hz.nextTick(function(){$(null,e)}):e}Tm=Hg&&Hg.getRandomValues?lz:jz;var mz,Um,of,Vm,Wm,nz,oz=false;function pz(e){console&&console.warn&&console.warn(e)}function pb(){pb.init.call(this)}function Ig(e){if("function"!=typeof e)throw new TypeError("The \"listener\" argument must be of type Function. Received type "+typeof e)}function Xm(e){return void 0===e._maxListeners?pb.defaultMaxListeners:e._maxListeners}function Ym(e,t,r,n){var s,o,i;if(Ig(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),i=o[t]),void 0===i)i=o[t]=r,++e._eventsCount;else if("function"==typeof i?i=o[t]=n?[r,i]:[i,r]:n?i.unshift(r):i.push(r),(s=Xm(e))>0&&i.length>s&&!i.warned){i.warned=!0;var $=new Error("Possible EventEmitter memory leak detected. "+i.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");$.name="MaxListenersExceededWarning",$.emitter=e,$.type=t,$.count=i.length,pz($)}return e}function qz(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Zm(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=qz.bind(n);return s.listener=r,n.wrapFn=s,s}function $m(e,t,r){var n=e._events;if(void 0===n)return[];var s=n[t];return void 0===s?[]:"function"==typeof s?r?[s.listener||s]:[s]:r?sz(s):ap(s,s.length)}function _m(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function ap(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function rz(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function sz(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function bp(){if(oz)return;oz=true;Um={};of="object"==typeof Reflect?Reflect:null;Vm=of&&"function"==typeof of.apply?of.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};mz=of&&"function"==typeof of.ownKeys?of.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};Wm=Number.isNaN||function(e){return e!=e};Um=pb,pb.EventEmitter=pb,pb.prototype._events=void 0,pb.prototype._eventsCount=0,pb.prototype._maxListeners=void 0;nz=10;Object.defineProperty(pb,"defaultMaxListeners",{enumerable:!0,get:function(){return nz},set:function(e){if("number"!=typeof e||e<0||Wm(e))throw new RangeError("The value of \"defaultMaxListeners\" is out of range. It must be a non-negative number. Received "+e+".");nz=e}}),pb.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},pb.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||Wm(e))throw new RangeError("The value of \"n\" is out of range. It must be a non-negative number. Received "+e+".");return this._maxListeners=e,this},pb.prototype.getMaxListeners=function(){return Xm(this)},pb.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var n="error"===e,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var i=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw i.context=o,i}var $=s[e];if(void 0===$)return!1;if("function"==typeof $)Vm($,this,t);else{var v=$.length,a=ap($,v);for(r=0;r<v;++r)Vm(a[r],this,t)}return!0},pb.prototype.addListener=function(e,t){return Ym(this,e,t,!1)},pb.prototype.on=pb.prototype.addListener,pb.prototype.prependListener=function(e,t){return Ym(this,e,t,!0)},pb.prototype.once=function(e,t){return Ig(t),this.on(e,Zm(this,e,t)),this},pb.prototype.prependOnceListener=function(e,t){return Ig(t),this.prependListener(e,Zm(this,e,t)),this},pb.prototype.removeListener=function(e,t){var r,n,s,o,i;if(Ig(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){i=r[o].listener,s=o;break}if(s<0)return this;0===s?r.shift():rz(r,s),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,i||t)}return this},pb.prototype.off=pb.prototype.removeListener,pb.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var s,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(s=o[n])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},pb.prototype.listeners=function(e){return $m(this,e,!0)},pb.prototype.rawListeners=function(e){return $m(this,e,!1)},pb.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):_m.call(e,t)},pb.prototype.listenerCount=_m,pb.prototype.eventNames=function(){return this._eventsCount>0?mz(this._events):[]}}var cp,tz=false;function dp(){if(tz)return;tz=true;cp={};cp=(bp(),Um).EventEmitter}var uz=false;function ep(){if(uz)return;uz=true}var vz,wz,Jg,xz,Gj,yz,zz=false;function fp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function Az(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fp(Object(r),!0).forEach(function(t){Bz(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fp(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Bz(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cz(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gp(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function Dz(e,t,r){return t&&gp(e.prototype,t),r&&gp(e,r),e}function Ez(e,t,r){Jg.prototype.copy.call(e,t,r)}function Fz(){if(zz)return;zz=true;vz={};wz=(yd(),Tb);Jg=wz.Buffer;xz=(ep(),{});Gj=xz.inspect;yz=Gj&&Gj.custom||"inspect";vz=function(){function e(){Cz(this,e),this.head=null,this.tail=null,this.length=0}return Dz(e,[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r}},{key:"concat",value:function(e){if(0===this.length)return Jg.alloc(0);for(var t=Jg.allocUnsafe(e>>>0),r=this.head,a=0;r;)Ez(r.data,t,a),a+=r.data.length,r=r.next;return t}},{key:"consume",value:function(e,t){var r;return e<this.head.data.length?(r=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):r=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,r=1,a=t.data;for(e-=a.length;t=t.next;){var n=t.data,i=e>n.length?n.length:e;if(i===n.length?a+=n:a+=n.slice(0,e),0===(e-=i)){i===n.length?(++r,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=n.slice(i));break}++r}return this.length-=r,a}},{key:"_getBuffer",value:function(e){var t=Jg.allocUnsafe(e),r=this.head,a=1;for(r.data.copy(t),e-=r.data.length;r=r.next;){var n=r.data,i=e>n.length?n.length:e;if(n.copy(t,t.length-e,0,i),0===(e-=i)){i===n.length?(++a,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=n.slice(i));break}++a}return this.length-=a,t}},{key:yz,value:function(e,t){return Gj(this,Az({},t,{depth:0,customInspect:!1}))}}]),e}()}var hp,Qd,Gz=false;function Hz(t,e){var r=this,a=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return a||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,Qd.nextTick(Hj,this,t)):Qd.nextTick(Hj,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(t){!e&&t?r._writableState?r._writableState.errorEmitted?Qd.nextTick(Kg,r):(r._writableState.errorEmitted=!0,Qd.nextTick(ip,r,t)):Qd.nextTick(ip,r,t):e?(Qd.nextTick(Kg,r),e(t)):Qd.nextTick(Kg,r)}),this)}function ip(t,e){Hj(t,e),Kg(t)}function Kg(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function Iz(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function Hj(t,e){t.emit("error",e)}function Jz(t,e){var r=t._readableState,a=t._writableState;r&&r.autoDestroy||a&&a.autoDestroy?t.destroy(e):t.emit("error",e)}function jp(){if(Gz)return;Gz=true;hp={};Qd=(xd(),wd);hp={destroy:Hz,undestroy:Iz,errorOrDestroy:Jz}}var Rd,kp,Kz=false;function Lz(r){return(Lz="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}function Mz(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}function Ub(r,e,t){t||(t=Error);var o=function(r){function t(t,o,n){return r.call(this,function(r,t,o){return"string"==typeof e?e:e(r,t,o)}(t,o,n))||this}return Mz(t,r),t}(t);o.prototype.name=t.name,o.prototype.code=r,kp[r]=o}function lp(r,e){if(Array.isArray(r)){var t=r.length;return r=r.map(function(r){return String(r)}),t>2?"one of ".concat(e," ").concat(r.slice(0,t-1).join(", "),", or ")+r[t-1]:2===t?"one of ".concat(e," ").concat(r[0]," or ").concat(r[1]):"of ".concat(e," ").concat(r[0])}return"of ".concat(e," ").concat(String(r))}function Nz(r,e,t){return r.substr(!t||t<0?0:+t,e.length)===e}function Oz(r,e,t){return(void 0===t||t>r.length)&&(t=r.length),r.substring(t-e.length,t)===e}function Pz(r,e,t){return"number"!=typeof t&&(t=0),!(t+e.length>r.length)&&-1!==r.indexOf(e,t)}function pf(){if(Kz)return;Kz=true;Rd={};kp={};Ub("ERR_INVALID_OPT_VALUE",function(r,e){return"The value \""+e+"\" is invalid for option \""+r+"\""},TypeError),Ub("ERR_INVALID_ARG_TYPE",function(r,e,t){var o,n;if("string"==typeof e&&Nz(e,"not ")?(o="must not be",e=e.replace(/^not /,"")):o="must be",Oz(r," argument"))n="The ".concat(r," ").concat(o," ").concat(lp(e,"type"));else{var a=Pz(r,".")?"property":"argument";n="The \"".concat(r,"\" ").concat(a," ").concat(o," ").concat(lp(e,"type"))}return n+=". Received type ".concat(Lz(t))},TypeError),Ub("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),Ub("ERR_METHOD_NOT_IMPLEMENTED",function(r){return"The "+r+" method is not implemented"}),Ub("ERR_STREAM_PREMATURE_CLOSE","Premature close"),Ub("ERR_STREAM_DESTROYED",function(r){return"Cannot call "+r+" after a stream was destroyed"}),Ub("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),Ub("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),Ub("ERR_STREAM_WRITE_AFTER_END","write after end"),Ub("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),Ub("ERR_UNKNOWN_ENCODING",function(r){return"Unknown encoding: "+r},TypeError),Ub("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Rd.codes=kp}var mp,Qz,Rz=false;function Sz(r,a,e){return null!=r.highWaterMark?r.highWaterMark:a?r[e]:null}function Tz(r,a,e,$){var t=Sz(a,$,e);if(null!=t){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new Qz($?e:"highWaterMark",t);return Math.floor(t)}return r.objectMode?16:16384}function np(){if(Rz)return;Rz=true;mp={};Qz=(pf(),Rd).codes.ERR_INVALID_OPT_VALUE;mp={getHighWaterMark:Tz}}var Uf,Uz=false;function Vf(){if(Uz)return;Uz=true;Uf={};Uf="function"==typeof Object.create?function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:function(t,e){if(e){t.super_=e;var o=function(){};o.prototype=e.prototype,t.prototype=new o,t.prototype.constructor=t}}}var Vz,Wz=false;function Xz(r,o){if(Ij("noDeprecation"))return r;var e=!1;return function(){if(!e){if(Ij("throwDeprecation"))throw new Error(o);Ij("traceDeprecation")?console.trace(o):console.warn(o),e=!0}return r.apply(this,arguments)}}function Ij(r){try{if(!Qb.localStorage)return!1}catch(e){return!1}var o=Qb.localStorage[r];return null!=o&&"true"===String(o).toLowerCase()}function Yz(){if(Wz)return;Wz=true;Vz={};Vz=Xz}var Jj,op,Sd,Zz,pp,Lg,$z,qp,Kj,_z,aA,zd,bA,cA,dA,eA,fA,gA,hA,iA,qf,jA=false;function rp(e){var r=this;this.next=null,this.entry=null,this.finish=function(){yA(r,e)}}function kA(e){return Lg.from(e)}function lA(e){return Lg.isBuffer(e)||e instanceof $z}function mA(){}function Wf(e,r,t){Jj=Jj||(sf(),rf),e=e||{},"boolean"!=typeof t&&(t=r instanceof Jj),this.objectMode=!!e.objectMode,t&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=aA(this,e,"writableHighWaterMark",t),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var $=!1===e.decodeStrings;this.decodeStrings=!$,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){tA(r,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new rp(this)}function xb(e){var r=this instanceof(Jj=Jj||(sf(),rf));if(!r&&!qp.call(xb,this))return new xb(e);this._writableState=new Wf(e,this,r),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),pp.call(this)}function nA(e,r){var t=new hA;qf(e,t),Sd.nextTick(r,t)}function oA(e,r,t,$){var i;return null===t?i=new gA:"string"==typeof t||r.objectMode||(i=new bA("chunk",["string","Buffer"],t)),!i||(qf(e,i),Sd.nextTick($,i),!1)}function pA(e,r,t){return e.objectMode||!1===e.decodeStrings||"string"!=typeof r||(r=Lg.from(r,t)),r}function qA(e,r,t,$,i,a){if(!t){var n=pA(r,$,i);$!==n&&(t=!0,i="buffer",$=n)}var o=r.objectMode?1:$.length;r.length+=o;var s=r.length<r.highWaterMark;if(s||(r.needDrain=!0),r.writing||r.corked){var E=r.lastBufferedRequest;r.lastBufferedRequest={chunk:$,encoding:i,isBuf:t,callback:a,next:null},E?E.next=r.lastBufferedRequest:r.bufferedRequest=r.lastBufferedRequest,r.bufferedRequestCount+=1}else Lj(e,r,!1,o,$,i,a);return s}function Lj(e,r,t,$,i,a,n){r.writelen=$,r.writecb=n,r.writing=!0,r.sync=!0,r.destroyed?r.onwrite(new fA("write")):t?e._writev(i,r.onwrite):e._write(i,a,r.onwrite),r.sync=!1}function rA(e,r,t,$,i){--r.pendingcb,t?(Sd.nextTick(i,$),Sd.nextTick(Xf,e,r),e._writableState.errorEmitted=!0,qf(e,$)):(i($),e._writableState.errorEmitted=!0,qf(e,$),Xf(e,r))}function sA(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function tA(e,r){var t=e._writableState,$=t.sync,i=t.writecb;if("function"!=typeof i)throw new dA;if(sA(t),r)rA(e,t,$,r,i);else{var a=up(t)||e.destroyed;a||t.corked||t.bufferProcessing||!t.bufferedRequest||tp(e,t),$?Sd.nextTick(sp,e,t,a,i):sp(e,t,a,i)}}function sp(e,r,t,$){t||uA(e,r),r.pendingcb--,$(),Xf(e,r)}function uA(e,r){0===r.length&&r.needDrain&&(r.needDrain=!1,e.emit("drain"))}function tp(e,r){r.bufferProcessing=!0;var t=r.bufferedRequest;if(e._writev&&t&&t.next){var $=r.bufferedRequestCount,i=new Array($),a=r.corkedRequestsFree;a.entry=t;for(var n=0,o=!0;t;)i[n]=t,t.isBuf||(o=!1),t=t.next,n+=1;i.allBuffers=o,Lj(e,r,!0,r.length,i,"",a.finish),r.pendingcb++,r.lastBufferedRequest=null,a.next?(r.corkedRequestsFree=a.next,a.next=null):r.corkedRequestsFree=new rp(r),r.bufferedRequestCount=0}else{for(;t;){var s=t.chunk,E=t.encoding,w=t.callback;if(Lj(e,r,!1,r.objectMode?1:s.length,s,E,w),t=t.next,r.bufferedRequestCount--,r.writing)break}null===t&&(r.lastBufferedRequest=null)}r.bufferedRequest=t,r.bufferProcessing=!1}function up(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function vA(e,r){e._final(function(t){r.pendingcb--,t&&qf(e,t),r.prefinished=!0,e.emit("prefinish"),Xf(e,r)})}function wA(e,r){r.prefinished||r.finalCalled||("function"!=typeof e._final||r.destroyed?(r.prefinished=!0,e.emit("prefinish")):(r.pendingcb++,r.finalCalled=!0,Sd.nextTick(vA,e,r)))}function Xf(e,r){var t=up(r);if(t&&(wA(e,r),0===r.pendingcb&&(r.finished=!0,e.emit("finish"),r.autoDestroy))){var $=e._readableState;(!$||$.autoDestroy&&$.endEmitted)&&e.destroy()}return t}function xA(e,r,t){r.ending=!0,Xf(e,r),t&&(r.finished?Sd.nextTick(t):e.once("finish",t)),r.ended=!0,e.writable=!1}function yA(e,r,t){var $=e.entry;for(e.entry=null;$;){var i=$.callback;r.pendingcb--,i(t),$=$.next}r.corkedRequestsFree.next=e}function vp(){if(jA)return;jA=true;op={};Sd=(xd(),wd);op=xb,xb.WritableState=Wf;Zz={deprecate:(Yz(),Vz)};pp=(dp(),cp);Lg=(yd(),Tb).Buffer;$z=Qb.Uint8Array||function(){};Kj=(jp(),hp);_z=(np(),mp);aA=_z.getHighWaterMark;zd=(pf(),Rd).codes;bA=zd.ERR_INVALID_ARG_TYPE;cA=zd.ERR_METHOD_NOT_IMPLEMENTED;dA=zd.ERR_MULTIPLE_CALLBACK;eA=zd.ERR_STREAM_CANNOT_PIPE;fA=zd.ERR_STREAM_DESTROYED;gA=zd.ERR_STREAM_NULL_VALUES;hA=zd.ERR_STREAM_WRITE_AFTER_END;iA=zd.ERR_UNKNOWN_ENCODING;qf=Kj.errorOrDestroy;(Vf(),Uf)(xb,pp),Wf.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r},function(){try{Object.defineProperty(Wf.prototype,"buffer",{get:Zz.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(qp=Function.prototype[Symbol.hasInstance],Object.defineProperty(xb,Symbol.hasInstance,{value:function(e){return!!qp.call(this,e)||this===xb&&e&&e._writableState instanceof Wf}})):qp=function(e){return e instanceof this},xb.prototype.pipe=function(){qf(this,new eA)},xb.prototype.write=function(e,r,t){var $=this._writableState,i=!1,a=!$.objectMode&&lA(e);return a&&!Lg.isBuffer(e)&&(e=kA(e)),"function"==typeof r&&(t=r,r=null),a?r="buffer":r||(r=$.defaultEncoding),"function"!=typeof t&&(t=mA),$.ending?nA(this,t):(a||oA(this,$,e,t))&&($.pendingcb++,i=qA(this,$,a,e,r,t)),i},xb.prototype.cork=function(){this._writableState.corked++},xb.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||tp(this,e))},xb.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new iA(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(xb.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(xb.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),xb.prototype._write=function(e,r,t){t(new cA("_write()"))},xb.prototype._writev=null,xb.prototype.end=function(e,r,t){var $=this._writableState;return"function"==typeof e?(t=e,e=null,r=null):"function"==typeof r&&(t=r,r=null),null!=e&&this.write(e,r),$.corked&&($.corked=1,this.uncork()),$.ending||xA(this,$,t),this},Object.defineProperty(xb.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(xb.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),xb.prototype.destroy=Kj.destroy,xb.prototype._undestroy=Kj.undestroy,xb.prototype._destroy=function(e,r){r(e)}}var rf,zA,AA,wp,Mj,BA=false;function dd(e){if(!(this instanceof dd))return new dd(e);wp.call(this,e),Mj.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",CA)))}function CA(){this._writableState.ended||zA.nextTick(DA,this)}function DA(e){e.end()}function sf(){if(BA)return;BA=true;rf={};zA=(xd(),wd);AA=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};rf=dd;wp=(Pp(),Dp);Mj=(vp(),op);(Vf(),Uf)(dd,wp);for(var $YgPj$var$keys=AA(Mj.prototype),$YgPj$var$v=0;$YgPj$var$v<$YgPj$var$keys.length;$YgPj$var$v++){var $YgPj$var$method=$YgPj$var$keys[$YgPj$var$v];dd.prototype[$YgPj$var$method]||(dd.prototype[$YgPj$var$method]=Mj.prototype[$YgPj$var$method])}Object.defineProperty(dd.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(dd.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(dd.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(dd.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})}var Nj,Oj,xp,EA,FA=false;function GA(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0;}}function HA(t){var e=GA(t);if("string"!=typeof e&&(Oj.isEncoding===xp||!xp(t)))throw new Error("Unknown encoding: "+t);return e||t}function Yf(t){var e;switch(this.encoding=HA(t),this.encoding){case"utf16le":this.text=NA,this.end=OA,e=4;break;case"utf8":this.fillLast=KA,e=4;break;case"base64":this.text=PA,this.end=QA,e=3;break;default:return this.write=RA,void(this.end=SA);}this.lastNeed=0,this.lastTotal=0,this.lastChar=Oj.allocUnsafe(e)}function Pj(t){return t<=127?0:t>>5==6?2:t>>4==14?3:t>>3==30?4:t>>6==2?-1:-2}function IA(t,e,r){var a=e.length-1;if(a<r)return 0;var s=Pj(e[a]);return s>=0?(s>0&&(t.lastNeed=s-1),s):--a<r||-2===s?0:(s=Pj(e[a]))>=0?(s>0&&(t.lastNeed=s-2),s):--a<r||-2===s?0:(s=Pj(e[a]))>=0?(s>0&&(2===s?s=0:t.lastNeed=s-3),s):0}function JA(t,e,r){if(128!=(192&e[0]))return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if(128!=(192&e[1]))return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&128!=(192&e[2]))return t.lastNeed=2,"\uFFFD"}}function KA(t){var e=this.lastTotal-this.lastNeed,r=JA(this,t,e);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function LA(t,e){var r=IA(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var a=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,a),t.toString("utf8",e,a)}function MA(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function NA(t,e){if((t.length-e)%2==0){var r=t.toString("utf16le",e);if(r){var a=r.charCodeAt(r.length-1);if(a>=55296&&a<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function OA(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function PA(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function QA(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function RA(t){return t.toString(this.encoding)}function SA(t){return t&&t.length?this.write(t):""}function yp(){if(FA)return;FA=true;Nj={};Oj=(Sm(),Fg).Buffer;xp=Oj.isEncoding||function(t){switch((t=""+t)&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1;}};EA=Yf;Nj.StringDecoder=EA,Yf.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(void 0===(e=this.fillLast(t)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},Yf.prototype.end=MA,Yf.prototype.text=LA,Yf.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}}var Qj,zp,TA=false;function UA(e){var r=!1;return function(){if(!r){r=!0;for(var n=arguments.length,t=new Array(n),o=0;o<n;o++)t[o]=arguments[o];e.apply(this,t)}}}function VA(){}function WA(e){return e.setHeader&&"function"==typeof e.abort}function Ap(e,r,n){if("function"==typeof r)return Ap(e,null,r);r||(r={}),n=UA(n||VA);var t=r.readable||!1!==r.readable&&e.readable,o=r.writable||!1!==r.writable&&e.writable,a=function(){e.writable||$()},i=e._writableState&&e._writableState.finished,$=function(){o=!1,i=!0,t||n.call(e)},l=e._readableState&&e._readableState.endEmitted,R=function(){t=!1,l=!0,o||n.call(e)},s=function(r){n.call(e,r)},c=function(){var r;return t&&!l?(e._readableState&&e._readableState.ended||(r=new zp),n.call(e,r)):o&&!i?(e._writableState&&e._writableState.ended||(r=new zp),n.call(e,r)):void 0},v=function(){e.req.on("finish",$)};return WA(e)?(e.on("complete",$),e.on("abort",c),e.req?v():e.on("request",v)):o&&!e._writableState&&(e.on("end",a),e.on("close",a)),e.on("end",R),e.on("finish",$),!1!==r.error&&e.on("error",s),e.on("close",c),function(){e.removeListener("complete",$),e.removeListener("abort",c),e.removeListener("request",v),e.req&&e.req.removeListener("finish",$),e.removeListener("end",a),e.removeListener("close",a),e.removeListener("finish",$),e.removeListener("end",R),e.removeListener("error",s),e.removeListener("close",c)}}function Rj(){if(TA)return;TA=true;Qj={};zp=(pf(),Rd).codes.ERR_STREAM_PREMATURE_CLOSE;Qj=Ap}var Bp,XA,Cp,YA,Ad,Td,Zf,Mg,Ud,Sj,Vd,ZA,$A,_A,aB=false;function Bd(e,r,$){return r in e?Object.defineProperty(e,r,{value:$,enumerable:!0,configurable:!0,writable:!0}):e[r]=$,e}function Cd(e,r){return{value:e,done:r}}function bB(e){var r=e[Ad];if(null!==r){var $=e[Vd].read();null!==$&&(e[Ud]=null,e[Ad]=null,e[Td]=null,r(Cd($,!1)))}}function cB(e){Cp.nextTick(bB,e)}function dB(e,r){return function($,a){e.then(function(){r[Mg]?$(Cd(void 0,!0)):r[Sj]($,a)},a)}}function eB(){if(aB)return;aB=true;XA={};Cp=(xd(),wd);YA=(Rj(),Qj);Ad=Symbol("lastResolve");Td=Symbol("lastReject");Zf=Symbol("error");Mg=Symbol("ended");Ud=Symbol("lastPromise");Sj=Symbol("handlePromise");Vd=Symbol("stream");ZA=Object.getPrototypeOf(function(){});$A=Object.setPrototypeOf((Bd(Bp={get stream(){return this[Vd]},next:function(){var e=this,r=this[Zf];if(null!==r)return Promise.reject(r);if(this[Mg])return Promise.resolve(Cd(void 0,!0));if(this[Vd].destroyed)return new Promise(function(r,$){Cp.nextTick(function(){e[Zf]?$(e[Zf]):r(Cd(void 0,!0))})});var $,a=this[Ud];if(a)$=new Promise(dB(a,this));else{var t=this[Vd].read();if(null!==t)return Promise.resolve(Cd(t,!1));$=new Promise(this[Sj])}return this[Ud]=$,$}},Symbol.asyncIterator,function(){return this}),Bd(Bp,"return",function(){var e=this;return new Promise(function(r,$){e[Vd].destroy(null,function(e){e?$(e):r(Cd(void 0,!0))})})}),Bp),ZA);_A=function(e){var r,$=Object.create($A,(Bd(r={},Vd,{value:e,writable:!0}),Bd(r,Ad,{value:null,writable:!0}),Bd(r,Td,{value:null,writable:!0}),Bd(r,Zf,{value:null,writable:!0}),Bd(r,Mg,{value:e._readableState.endEmitted,writable:!0}),Bd(r,Sj,{value:function(e,r){var a=$[Vd].read();a?($[Ud]=null,$[Ad]=null,$[Td]=null,e(Cd(a,!1))):($[Ad]=e,$[Td]=r)},writable:!0}),r));return $[Ud]=null,YA(e,function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var r=$[Td];return null!==r&&($[Ud]=null,$[Ad]=null,$[Td]=null,r(e)),void($[Zf]=e)}var a=$[Ad];null!==a&&($[Ud]=null,$[Ad]=null,$[Td]=null,a(Cd(void 0,!0))),$[Mg]=!0}),e.on("readable",cB.bind(null,$)),$};XA=_A}var fB,gB=false;function hB(){if(gB)return;gB=true;fB={};fB=function(){throw new Error("Readable.from is not available in the browser")}}var Ng,Dp,ed,b,Ep,$f,Og,iB,jb,Tj,Pg,Fp,Gp,jB,Uj,kB,lB,Qg,mB,nB,oB,pB,_f,Vj,Hp,qB=false;function rB(e){return Og.from(e)}function sB(e){return Og.isBuffer(e)||e instanceof iB}function tB(e,r,a){if("function"==typeof e.prependListener)return e.prependListener(r,a);e._events&&e._events[r]?Array.isArray(e._events[r])?e._events[r].unshift(a):e._events[r]=[a,e._events[r]]:e.on(r,a)}function Ip(e,r,a){Ng=Ng||(sf(),rf),e=e||{},"boolean"!=typeof a&&(a=r instanceof Ng),this.objectMode=!!e.objectMode,a&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=lB(this,e,"readableHighWaterMark",a),this.buffer=new jB,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(Pg||(Pg=(yp(),Nj).StringDecoder),this.decoder=new Pg(e.encoding),this.encoding=e.encoding)}function nb(e){if(Ng=Ng||(sf(),rf),!(this instanceof nb))return new nb(e);var r=this instanceof Ng;this._readableState=new Ip(e,this,r),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),$f.call(this)}function Jp(e,r,a,t,$){jb("readableAddChunk",r);var n,i=e._readableState;if(null===r)i.reading=!1,wB(e,i);else if($||(n=uB(i,r)),n)_f(e,n);else if(i.objectMode||r&&r.length>0){if("string"==typeof r||i.objectMode||Object.getPrototypeOf(r)===Og.prototype||(r=rB(r)),t)i.endEmitted?_f(e,new pB):Wj(e,i,r,!0);else if(i.ended)_f(e,new nB);else{if(i.destroyed)return!1;i.reading=!1,i.decoder&&!a?(r=i.decoder.write(r),i.objectMode||0!==r.length?Wj(e,i,r,!1):Xj(e,i)):Wj(e,i,r,!1)}}else t||(i.reading=!1,Xj(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function Wj(e,r,a,t){r.flowing&&0===r.length&&!r.sync?(r.awaitDrain=0,e.emit("data",a)):(r.length+=r.objectMode?1:a.length,t?r.buffer.unshift(a):r.buffer.push(a),r.needReadable&&Rg(e)),Xj(e,r)}function uB(e,r){var a;return sB(r)||"string"==typeof r||void 0===r||e.objectMode||(a=new mB("chunk",["string","Buffer","Uint8Array"],r)),a}function vB(e){return e>=Hp?e=Hp:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function Kp(e,r){return e<=0||0===r.length&&r.ended?0:r.objectMode?1:e!=e?r.flowing&&r.length?r.buffer.head.data.length:r.length:(e>r.highWaterMark&&(r.highWaterMark=vB(e)),e<=r.length?e:r.ended?r.length:(r.needReadable=!0,0))}function wB(e,r){if(jb("onEofChunk"),!r.ended){if(r.decoder){var a=r.decoder.end();a&&a.length&&(r.buffer.push(a),r.length+=r.objectMode?1:a.length)}r.ended=!0,r.sync?Rg(e):(r.needReadable=!1,r.emittedReadable||(r.emittedReadable=!0,Lp(e)))}}function Rg(e){var r=e._readableState;jb("emitReadable",r.needReadable,r.emittedReadable),r.needReadable=!1,r.emittedReadable||(jb("emitReadable",r.flowing),r.emittedReadable=!0,ed.nextTick(Lp,e))}function Lp(e){var r=e._readableState;jb("emitReadable_",r.destroyed,r.length,r.ended),r.destroyed||!r.length&&!r.ended||(e.emit("readable"),r.emittedReadable=!1),r.needReadable=!r.flowing&&!r.ended&&r.length<=r.highWaterMark,Yj(e)}function Xj(e,r){r.readingMore||(r.readingMore=!0,ed.nextTick(xB,e,r))}function xB(e,r){for(;!r.reading&&!r.ended&&(r.length<r.highWaterMark||r.flowing&&0===r.length);){var a=r.length;if(jb("maybeReadMore read 0"),e.read(0),a===r.length)break}r.readingMore=!1}function yB(e){return function(){var r=e._readableState;jb("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,0===r.awaitDrain&&Ep(e,"data")&&(r.flowing=!0,Yj(e))}}function Mp(e){var r=e._readableState;r.readableListening=e.listenerCount("readable")>0,r.resumeScheduled&&!r.paused?r.flowing=!0:e.listenerCount("data")>0&&e.resume()}function zB(e){jb("readable nexttick read 0"),e.read(0)}function AB(e,r){r.resumeScheduled||(r.resumeScheduled=!0,ed.nextTick(BB,e,r))}function BB(e,r){jb("resume",r.reading),r.reading||e.read(0),r.resumeScheduled=!1,e.emit("resume"),Yj(e),r.flowing&&!r.reading&&e.read(0)}function Yj(e){var r=e._readableState;for(jb("flow",r.flowing);r.flowing&&null!==e.read(););}function Np(e,r){return 0===r.length?null:(r.objectMode?a=r.buffer.shift():!e||e>=r.length?(a=r.decoder?r.buffer.join(""):1===r.buffer.length?r.buffer.first():r.buffer.concat(r.length),r.buffer.clear()):a=r.buffer.consume(e,r.decoder),a);var a}function Zj(e){var r=e._readableState;jb("endReadable",r.endEmitted),r.endEmitted||(r.ended=!0,ed.nextTick(CB,r,e))}function CB(e,r){if(jb("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,r.readable=!1,r.emit("end"),e.autoDestroy)){var a=r._writableState;(!a||a.autoDestroy&&a.finished)&&r.destroy()}}function Op(e,r){for(var a=0,t=e.length;a<t;a++)if(e[a]===r)return a;return-1}function Pp(){if(qB)return;qB=true;Dp={};ed=(xd(),wd);Dp=nb,nb.ReadableState=Ip;b=(bp(),Um).EventEmitter;Ep=function(e,r){return e.listeners(r).length};$f=(dp(),cp);Og=(yd(),Tb).Buffer;iB=Qb.Uint8Array||function(){};Tj=(ep(),{});jb=Tj&&Tj.debuglog?Tj.debuglog("stream"):function(){};jB=(Fz(),vz);Uj=(jp(),hp);kB=(np(),mp);lB=kB.getHighWaterMark;Qg=(pf(),Rd).codes;mB=Qg.ERR_INVALID_ARG_TYPE;nB=Qg.ERR_STREAM_PUSH_AFTER_EOF;oB=Qg.ERR_METHOD_NOT_IMPLEMENTED;pB=Qg.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;(Vf(),Uf)(nb,$f);_f=Uj.errorOrDestroy;Vj=["error","close","destroy","pause","resume"];Object.defineProperty(nb.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),nb.prototype.destroy=Uj.destroy,nb.prototype._undestroy=Uj.undestroy,nb.prototype._destroy=function(e,r){r(e)},nb.prototype.push=function(e,r){var a,t=this._readableState;return t.objectMode?a=!0:"string"==typeof e&&((r=r||t.defaultEncoding)!==t.encoding&&(e=Og.from(e,r),r=""),a=!0),Jp(this,e,r,!1,a)},nb.prototype.unshift=function(e){return Jp(this,e,null,!0,!1)},nb.prototype.isPaused=function(){return!1===this._readableState.flowing},nb.prototype.setEncoding=function(e){Pg||(Pg=(yp(),Nj).StringDecoder);var r=new Pg(e);this._readableState.decoder=r,this._readableState.encoding=this._readableState.decoder.encoding;for(var a=this._readableState.buffer.head,t="";null!==a;)t+=r.write(a.data),a=a.next;return this._readableState.buffer.clear(),""!==t&&this._readableState.buffer.push(t),this._readableState.length=t.length,this};Hp=1073741824;nb.prototype.read=function(e){jb("read",e),e=parseInt(e,10);var r=this._readableState,a=e;if(0!==e&&(r.emittedReadable=!1),0===e&&r.needReadable&&((0!==r.highWaterMark?r.length>=r.highWaterMark:r.length>0)||r.ended))return jb("read: emitReadable",r.length,r.ended),0===r.length&&r.ended?Zj(this):Rg(this),null;if(0===(e=Kp(e,r))&&r.ended)return 0===r.length&&Zj(this),null;var t,$=r.needReadable;return jb("need readable",$),(0===r.length||r.length-e<r.highWaterMark)&&jb("length less than watermark",$=!0),r.ended||r.reading?jb("reading or ended",$=!1):$&&(jb("do read"),r.reading=!0,r.sync=!0,0===r.length&&(r.needReadable=!0),this._read(r.highWaterMark),r.sync=!1,r.reading||(e=Kp(a,r))),null===(t=e>0?Np(e,r):null)?(r.needReadable=r.length<=r.highWaterMark,e=0):(r.length-=e,r.awaitDrain=0),0===r.length&&(r.ended||(r.needReadable=!0),a!==e&&r.ended&&Zj(this)),null!==t&&this.emit("data",t),t},nb.prototype._read=function(e){_f(this,new oB("_read()"))},nb.prototype.pipe=function(e,r){var a=this,t=this._readableState;switch(t.pipesCount){case 0:t.pipes=e;break;case 1:t.pipes=[t.pipes,e];break;default:t.pipes.push(e);}t.pipesCount+=1,jb("pipe count=%d opts=%j",t.pipesCount,r);var $=(!r||!1!==r.end)&&e!==ed.stdout&&e!==ed.stderr?i:u;function n(r,$){jb("onunpipe"),r===a&&$&&!1===$.hasUnpiped&&($.hasUnpiped=!0,jb("cleanup"),e.removeListener("close",s),e.removeListener("finish",l),e.removeListener("drain",d),e.removeListener("error",o),e.removeListener("unpipe",n),a.removeListener("end",i),a.removeListener("end",u),a.removeListener("data",h),U=!0,!t.awaitDrain||e._writableState&&!e._writableState.needDrain||d())}function i(){jb("onend"),e.end()}t.endEmitted?ed.nextTick($):a.once("end",$),e.on("unpipe",n);var d=yB(a);e.on("drain",d);var U=!1;function h(r){jb("ondata");var $=e.write(r);jb("dest.write",$),!1===$&&((1===t.pipesCount&&t.pipes===e||t.pipesCount>1&&-1!==Op(t.pipes,e))&&!U&&(jb("false write response, pause",t.awaitDrain),t.awaitDrain++),a.pause())}function o(r){jb("onerror",r),u(),e.removeListener("error",o),0===Ep(e,"error")&&_f(e,r)}function s(){e.removeListener("finish",l),u()}function l(){jb("onfinish"),e.removeListener("close",s),u()}function u(){jb("unpipe"),a.unpipe(e)}return a.on("data",h),tB(e,"error",o),e.once("close",s),e.once("finish",l),e.emit("pipe",a),t.flowing||(jb("pipe resume"),a.resume()),e},nb.prototype.unpipe=function(e){var r=this._readableState,a={hasUnpiped:!1};if(0===r.pipesCount)return this;if(1===r.pipesCount)return e&&e!==r.pipes?this:(e||(e=r.pipes),r.pipes=null,r.pipesCount=0,r.flowing=!1,e&&e.emit("unpipe",this,a),this);if(!e){var t=r.pipes,$=r.pipesCount;r.pipes=null,r.pipesCount=0,r.flowing=!1;for(var n=0;n<$;n++)t[n].emit("unpipe",this,{hasUnpiped:!1});return this}var i=Op(r.pipes,e);return-1===i?this:(r.pipes.splice(i,1),r.pipesCount-=1,1===r.pipesCount&&(r.pipes=r.pipes[0]),e.emit("unpipe",this,a),this)},nb.prototype.on=function(e,r){var a=$f.prototype.on.call(this,e,r),t=this._readableState;return"data"===e?(t.readableListening=this.listenerCount("readable")>0,!1!==t.flowing&&this.resume()):"readable"===e&&(t.endEmitted||t.readableListening||(t.readableListening=t.needReadable=!0,t.flowing=!1,t.emittedReadable=!1,jb("on readable",t.length,t.reading),t.length?Rg(this):t.reading||ed.nextTick(zB,this))),a},nb.prototype.addListener=nb.prototype.on,nb.prototype.removeListener=function(e,r){var a=$f.prototype.removeListener.call(this,e,r);return"readable"===e&&ed.nextTick(Mp,this),a},nb.prototype.removeAllListeners=function(e){var r=$f.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||ed.nextTick(Mp,this),r},nb.prototype.resume=function(){var e=this._readableState;return e.flowing||(jb("resume"),e.flowing=!e.readableListening,AB(this,e)),e.paused=!1,this},nb.prototype.pause=function(){return jb("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(jb("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},nb.prototype.wrap=function(e){var r=this,a=this._readableState,t=!1;for(var $ in e.on("end",function(){if(jb("wrapped end"),a.decoder&&!a.ended){var e=a.decoder.end();e&&e.length&&r.push(e)}r.push(null)}),e.on("data",function($){(jb("wrapped data"),a.decoder&&($=a.decoder.write($)),a.objectMode&&null==$)||(a.objectMode||$&&$.length)&&(r.push($)||(t=!0,e.pause()))}),e)void 0===this[$]&&"function"==typeof e[$]&&(this[$]=function(r){return function(){return e[r].apply(e,arguments)}}($));for(var n=0;n<Vj.length;n++)e.on(Vj[n],this.emit.bind(this,Vj[n]));return this._read=function(r){jb("wrapped _read",r),t&&(t=!1,e.resume())},this},"function"==typeof Symbol&&(nb.prototype[Symbol.asyncIterator]=function(){return void 0===Fp&&(Fp=(eB(),XA)),Fp(this)}),Object.defineProperty(nb.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(nb.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(nb.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),nb._fromList=Np,Object.defineProperty(nb.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(nb.from=function(e,r){return void 0===Gp&&(Gp=(hB(),fB)),Gp(nb,e,r)})}var $j={};$j=kd;var Sg=(pf(),Rd).codes,DB=Sg.ERR_METHOD_NOT_IMPLEMENTED,EB=Sg.ERR_MULTIPLE_CALLBACK,FB=Sg.ERR_TRANSFORM_ALREADY_TRANSFORMING,GB=Sg.ERR_TRANSFORM_WITH_LENGTH_0,Tg=(sf(),rf);function HB(r,e){var t=this._transformState;t.transforming=!1;var a=t.writecb;if(null===a)return this.emit("error",new EB);t.writechunk=null,t.writecb=null,null!=e&&this.push(e),a(r);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function kd(r){if(!(this instanceof kd))return new kd(r);Tg.call(this,r),this._transformState={afterTransform:HB.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,r&&("function"==typeof r.transform&&(this._transform=r.transform),"function"==typeof r.flush&&(this._flush=r.flush)),this.on("prefinish",IB)}function IB(){var r=this;"function"!=typeof this._flush||this._readableState.destroyed?Qp(this,null,null):this._flush(function(e,t){Qp(r,e,t)})}function Qp(r,e,t){if(e)return r.emit("error",e);if(null!=t&&r.push(t),r._writableState.length)throw new GB;if(r._transformState.transforming)throw new FB;return r.push(null)}(Vf(),Uf)(kd,Tg),kd.prototype.push=function(r,e){return this._transformState.needTransform=!1,Tg.prototype.push.call(this,r,e)},kd.prototype._transform=function(r,e,t){t(new DB("_transform()"))},kd.prototype._write=function(r,e,t){var a=this._transformState;if(a.writecb=t,a.writechunk=r,a.writeencoding=e,!a.transforming){var o=this._readableState;(a.needTransform||o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}},kd.prototype._read=function(r){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},kd.prototype._destroy=function(r,e){Tg.prototype._destroy.call(this,r,function(r){e(r)})};var JB={};JB=ag;function ag(r){if(!(this instanceof ag))return new ag(r);$j.call(this,r)}(Vf(),Uf)(ag,$j),ag.prototype._transform=function(r,$,a){a(null,r)};var Rp,KB={};function LB(r){var e=!1;return function(){e||(e=!0,r.apply(void 0,arguments))}}var Sp=(pf(),Rd).codes,MB=Sp.ERR_MISSING_ARGS,NB=Sp.ERR_STREAM_DESTROYED;function Tp(r){if(r)throw r}function OB(r){return r.setHeader&&"function"==typeof r.abort}function PB(r,e,$,a){a=LB(a);var n=!1;r.on("close",function(){n=!0}),void 0===Rp&&(Rp=(Rj(),Qj)),Rp(r,{readable:e,writable:$},function(r){if(r)return a(r);n=!0,a()});var o=!1;return function(e){if(!n&&!o)return o=!0,OB(r)?r.abort():"function"==typeof r.destroy?r.destroy():void a(e||new NB("pipe"))}}function Up(r){r()}function QB(r,e){return r.pipe(e)}function RB(r){return r.length?"function"!=typeof r[r.length-1]?Tp:r.pop():Tp}function SB(){for(var r=arguments.length,e=new Array(r),$=0;$<r;$++)e[$]=arguments[$];var a,n=RB(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new MB("streams");var o=e.map(function(r,$){var t=$<e.length-1;return PB(r,t,$>0,function(r){a||(a=r),r&&o.forEach(Up),t||(o.forEach(Up),n(a))})});return e.reduce(QB)}KB=SB;var ld={},TB=ld=ld=(Pp(),Dp);ld.Stream=TB;ld.Readable=ld;var UB=(vp(),op);ld.Writable=UB;var Vp=(sf(),rf);ld.Duplex=Vp;ld.Transform=$j;ld.PassThrough=JB;var VB=(Rj(),Qj);ld.finished=VB;ld.pipeline=KB;var _j={};let WB;_j="function"==typeof queueMicrotask?queueMicrotask.bind(globalThis):e=>(WB||(WB=Promise.resolve())).then(e).catch(e=>setTimeout(()=>{throw e},0));var tb={};function Wp(r,e){for(const t in e)Object.defineProperty(r,t,{value:e[t],enumerable:!0,configurable:!0});return r}function XB(r,e,t){if(!r||"string"==typeof r)throw new TypeError("Please pass an Error to err-code");t||(t={}),"object"==typeof e&&(t=e,e=void 0),null!=e&&(t.code=e);try{return Wp(r,t)}catch(o){t.message=r.message,t.stack=r.stack;const e=function(){};return e.prototype=Object.create(Object.getPrototypeOf(r)),Wp(new e,t)}}tb=XB;var Xp={},YB=(yd(),Tb).Buffer,ZB=Yb("simple-peer"),ak=65536,$B=5e3,_B=5e3;function Yp(e){return e.replace(/a=ice-options:trickle\s\n/g,"")}function aC(e){console.warn(e)}class tf extends Vp{constructor(e){if(super(e=Object.assign({allowHalfOpen:!1},e)),this._id=Tm(4).toString("hex").slice(0,7),this._debug("new peer %o",e),this.channelName=e.initiator?e.channelName||Tm(20).toString("hex"):null,this.initiator=e.initiator||!1,this.channelConfig=e.channelConfig||tf.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},tf.config,e.config),this.offerOptions=e.offerOptions||{},this.answerOptions=e.answerOptions||{},this.sdpTransform=e.sdpTransform||(e=>e),this.streams=e.streams||(e.stream?[e.stream]:[]),this.trickle=void 0===e.trickle||e.trickle,this.allowHalfTrickle=void 0!==e.allowHalfTrickle&&e.allowHalfTrickle,this.iceCompleteTimeout=e.iceCompleteTimeout||$B,this.destroyed=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=e.wrtc&&"object"==typeof e.wrtc?e.wrtc:Bm(),!this._wrtc)throw"undefined"==typeof window?tb(new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"),"ERR_WEBRTC_SUPPORT"):tb(new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(t){return void _j(()=>this.destroy(tb(t,"ERR_PC_CONSTRUCTOR")))}this._isReactNativeWebrtc="number"==typeof this._pc._peerConnectionId,this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=e=>{this._onIceCandidate(e)},this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=e=>{this._setupData(e)},this.streams&&this.streams.forEach(e=>{this.addStream(e)}),this._pc.ontrack=e=>{this._onTrack(e)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&"open"===this._channel.readyState}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(e){if(this.destroyed)throw tb(new Error("cannot signal after peer is destroyed"),"ERR_SIGNALING");if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}this._debug("signal()"),e.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),e.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(e.transceiverRequest.kind,e.transceiverRequest.init)),e.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(e.candidate):this._pendingCandidates.push(e.candidate)),e.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(e)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(e=>{this._addIceCandidate(e)}),this._pendingCandidates=[],"offer"===this._pc.remoteDescription.type&&this._createAnswer())}).catch(e=>{this.destroy(tb(e,"ERR_SET_REMOTE_DESCRIPTION"))}),e.sdp||e.candidate||e.renegotiate||e.transceiverRequest||this.destroy(tb(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}_addIceCandidate(e){var t=new this._wrtc.RTCIceCandidate(e);this._pc.addIceCandidate(t).catch(e=>{!t.address||t.address.endsWith(".local")?aC("Ignoring unsupported ICE candidate."):this.destroy(tb(e,"ERR_ADD_ICE_CANDIDATE"))})}send(e){this._channel.send(e)}addTransceiver(e,t){if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(e,t),this._needsNegotiation()}catch(i){this.destroy(tb(i,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{transceiverRequest:{kind:e,init:t}})}addStream(e){this._debug("addStream()"),e.getTracks().forEach(t=>{this.addTrack(t,e)})}addTrack(e,t){this._debug("addTrack()");var i=this._senderMap.get(e)||new Map,s=i.get(t);if(s)throw s.removed?tb(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):tb(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED");s=this._pc.addTrack(e,t),i.set(t,s),this._senderMap.set(e,i),this._needsNegotiation()}replaceTrack(e,t,i){this._debug("replaceTrack()");var s=this._senderMap.get(e),r=s?s.get(i):null;if(!r)throw tb(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");t&&this._senderMap.set(t,s),null!=r.replaceTrack?r.replaceTrack(t):this.destroy(tb(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK"))}removeTrack(e,t){this._debug("removeSender()");var i=this._senderMap.get(e),s=i?i.get(t):null;if(!s)throw tb(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{s.removed=!0,this._pc.removeTrack(s)}catch(r){"NS_ERROR_UNEXPECTED"===r.name?this._sendersAwaitingStable.push(s):this.destroy(tb(r,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(e){this._debug("removeSenders()"),e.getTracks().forEach(t=>{this.removeTrack(t,e)})}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,_j(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{renegotiate:!0})),this._isNegotiating=!0}destroy(e){this._destroy(e,()=>{})}_destroy(e,t){if(!this.destroyed){if(this._debug("destroy (error: %s)",e&&(e.message||e)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this.destroyed=!0,this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch(e){}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch(e){}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,e&&this.emit("error",e),this.emit("close"),t()}}_setupData(e){if(!e.channel)return this.destroy(tb(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=e.channel,this._channel.binaryType="arraybuffer","number"==typeof this._channel.bufferedAmountLowThreshold&&(this._channel.bufferedAmountLowThreshold=ak),this.channelName=this._channel.label,this._channel.onmessage=e=>{this._onChannelMessage(e)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=e=>{this.destroy(tb(e,"ERR_DATA_CHANNEL"))};var t=!1;this._closingInterval=setInterval(()=>{this._channel&&"closing"===this._channel.readyState?(t&&this._onChannelClose(),t=!0):t=!1},_B)}_read(){}_write(e,t,i){if(this.destroyed)return i(tb(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(e)}catch(s){return this.destroy(tb(s,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>ak?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=i):i(null)}else this._debug("write before connect"),this._chunk=e,this._cb=i}_onFinish(){if(this.destroyed)return;const e=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?e():this.once("connect",e)}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=Yp(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(!this.destroyed){var t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp})}};this._pc.setLocalDescription(e).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(e=>{this.destroy(tb(e,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.destroy(tb(e,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(e=>{e.mid||!e.sender.track||e.requested||(e.requested=!0,this.addTransceiver(e.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(e=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(e.sdp=Yp(e.sdp)),e.sdp=this.sdpTransform(e.sdp);const t=()=>{if(!this.destroyed){var t=this._pc.localDescription||e;this._debug("signal"),this.emit("signal",{type:t.type,sdp:t.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(e).then(()=>{this.destroyed||(this.trickle||this._iceComplete?t():this.once("_iceComplete",t))}).catch(e=>{this.destroy(tb(e,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(e=>{this.destroy(tb(e,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||"failed"===this._pc.connectionState&&this.destroy(tb(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(!this.destroyed){var e=this._pc.iceConnectionState,t=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",e,t),this.emit("iceStateChange",e,t),"connected"!==e&&"completed"!==e||(this._pcReady=!0,this._maybeReady()),"failed"===e&&this.destroy(tb(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),"closed"===e&&this.destroy(tb(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}}getStats(e){const t=e=>("[object Array]"===Object.prototype.toString.call(e.values)&&e.values.forEach(t=>{Object.assign(e,t)}),e);0===this._pc.getStats.length||this._isReactNativeWebrtc?this._pc.getStats().then(i=>{var s=[];i.forEach(e=>{s.push(t(e))}),e(null,s)},t=>e(t)):this._pc.getStats.length>0?this._pc.getStats(i=>{if(!this.destroyed){var s=[];i.result().forEach(e=>{var i={};e.names().forEach(t=>{i[t]=e.stat(t)}),i.id=e.id,i.type=e.type,i.timestamp=e.timestamp,s.push(t(i))}),e(null,s)}},t=>e(t)):e(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const e=()=>{this.destroyed||this.getStats((t,i)=>{if(this.destroyed)return;t&&(i=[]);var s={},r={},n={},a=!1;i.forEach(e=>{"remotecandidate"!==e.type&&"remote-candidate"!==e.type||(s[e.id]=e),"localcandidate"!==e.type&&"local-candidate"!==e.type||(r[e.id]=e),"candidatepair"!==e.type&&"candidate-pair"!==e.type||(n[e.id]=e)});const o=e=>{a=!0;var t=r[e.localCandidateId];t&&(t.ip||t.address)?(this.localAddress=t.ip||t.address,this.localPort=Number(t.port)):t&&t.ipAddress?(this.localAddress=t.ipAddress,this.localPort=Number(t.portNumber)):"string"==typeof e.googLocalAddress&&(t=e.googLocalAddress.split(":"),this.localAddress=t[0],this.localPort=Number(t[1])),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");var i=s[e.remoteCandidateId];i&&(i.ip||i.address)?(this.remoteAddress=i.ip||i.address,this.remotePort=Number(i.port)):i&&i.ipAddress?(this.remoteAddress=i.ipAddress,this.remotePort=Number(i.portNumber)):"string"==typeof e.googRemoteAddress&&(i=e.googRemoteAddress.split(":"),this.remoteAddress=i[0],this.remotePort=Number(i[1])),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(i.forEach(e=>{"transport"===e.type&&e.selectedCandidatePairId&&o(n[e.selectedCandidatePairId]),("googCandidatePair"===e.type&&"true"===e.googActiveConnection||("candidatepair"===e.type||"candidate-pair"===e.type)&&e.selected)&&o(e)}),a||Object.keys(n).length&&!Object.keys(r).length){if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(t){return this.destroy(tb(t,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug("sent chunk from \"write before connect\"");var h=this._cb;this._cb=null,h(null)}"number"!=typeof this._channel.bufferedAmountLowThreshold&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")}else setTimeout(e,100)})};e()}_onInterval(){!this._cb||!this._channel||this._channel.bufferedAmount>ak||this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||("stable"===this._pc.signalingState&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(e=>{this._pc.removeTrack(e),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiate"),this.emit("negotiate"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(e){this.destroyed||(e.candidate&&this.trickle?this.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}}):e.candidate||this._iceComplete||(this._iceComplete=!0,this.emit("_iceComplete")),e.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(e){if(!this.destroyed){var t=e.data;t instanceof ArrayBuffer&&(t=YB.from(t)),this.push(t)}}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);var e=this._cb;this._cb=null,e(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(e){this.destroyed||e.streams.forEach(t=>{this._debug("on track"),this.emit("track",e.track,t),this._remoteTracks.push({track:e.track,stream:t}),this._remoteStreams.some(e=>e.id===t.id)||(this._remoteStreams.push(t),_j(()=>{this.emit("stream",t)}))})}_debug(){var e=[].slice.call(arguments);e[0]="["+this._id+"] "+e[0],ZB.apply(null,e)}}tf.WEBRTC_SUPPORT=!!Bm(),tf.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},tf.channelConfig={},Xp=tf;var bC={};bC=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then};var bk={},cC={}.toString;bk=Array.isArray||function(r){return"[object Array]"==cC.call(r)};var Ob={};function dC(){try{var r=new Uint8Array(1);return r.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===r.foo()}catch(e){return!1}}kb.TYPED_ARRAY_SUPPORT=dC();var Zp=kb.TYPED_ARRAY_SUPPORT?2147483647:1073741823;function kb(r,e,t){return kb.TYPED_ARRAY_SUPPORT||this instanceof kb?"number"==typeof r?$p(this,r):kC(this,r,e,t):new kb(r,e,t)}function ck(r){if(r>=Zp)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Zp.toString(16)+" bytes");return 0|r}function eC(r){return r!=r}function uf(r,e){var t;return kb.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=kb.prototype:(null===(t=r)&&(t=new kb(e)),t.length=e),t}function $p(r,e){var t=uf(r,e<0?0:0|ck(e));if(!kb.TYPED_ARRAY_SUPPORT)for(var a=0;a<e;++a)t[a]=0;return t}function fC(r,e){var t=0|aq(e),a=uf(r,t),f=a.write(e);return f!==t&&(a=a.slice(0,f)),a}function dk(r,e){for(var t=e.length<0?0:0|ck(e.length),a=uf(r,t),f=0;f<t;f+=1)a[f]=255&e[f];return a}function gC(r,e,t,a){if(t<0||e.byteLength<t)throw new RangeError("'offset' is out of bounds");if(e.byteLength<t+(a||0))throw new RangeError("'length' is out of bounds");var f;return f=void 0===t&&void 0===a?new Uint8Array(e):void 0===a?new Uint8Array(e,t):new Uint8Array(e,t,a),kb.TYPED_ARRAY_SUPPORT?f.__proto__=kb.prototype:f=dk(r,f),f}function hC(r,e){if(kb.isBuffer(e)){var t=0|ck(e.length),a=uf(r,t);return 0===a.length?a:(e.copy(a,0,0,t),a)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||eC(e.length)?uf(r,0):dk(r,e);if("Buffer"===e.type&&Array.isArray(e.data))return dk(r,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function _p(r,e){var t;e=e||1/0;for(var a=r.length,f=null,$=[],n=0;n<a;++n){if((t=r.charCodeAt(n))>55295&&t<57344){if(!f){if(t>56319){(e-=3)>-1&&$.push(239,191,189);continue}if(n+1===a){(e-=3)>-1&&$.push(239,191,189);continue}f=t;continue}if(t<56320){(e-=3)>-1&&$.push(239,191,189),f=t;continue}t=65536+(f-55296<<10|t-56320)}else f&&(e-=3)>-1&&$.push(239,191,189);if(f=null,t<128){if((e-=1)<0)break;$.push(t)}else if(t<2048){if((e-=2)<0)break;$.push(t>>6|192,63&t|128)}else if(t<65536){if((e-=3)<0)break;$.push(t>>12|224,t>>6&63|128,63&t|128)}else{if(!(t<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;$.push(t>>18|240,t>>12&63|128,t>>6&63|128,63&t|128)}}return $}function aq(r){return kb.isBuffer(r)?r.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(r)||r instanceof ArrayBuffer)?r.byteLength:("string"!=typeof r&&(r=""+r),0===r.length?0:_p(r).length)}function iC(r,e,t,a){for(var f=0;f<a&&!(f+t>=e.length||f>=r.length);++f)e[f+t]=r[f];return f}function jC(r,e,t,a){return iC(_p(e,r.length-t),r,t,a)}function kC(r,e,t,a){if("number"==typeof e)throw new TypeError("\"value\" argument must not be a number");return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?gC(r,e,t,a):"string"==typeof e?fC(r,e,t):hC(r,e)}kb.TYPED_ARRAY_SUPPORT&&(kb.prototype.__proto__=Uint8Array.prototype,kb.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&kb[Symbol.species]===kb&&Object.defineProperty(kb,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),kb.prototype.write=function(r,e,t){void 0===e?(t=this.length,e=0):void 0===t&&"string"==typeof e?(t=this.length,e=0):isFinite(e)&&(e|=0,isFinite(t)?t|=0:t=void 0);var a=this.length-e;if((void 0===t||t>a)&&(t=a),r.length>0&&(t<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return jC(this,r,e,t)},kb.prototype.slice=function(r,e){var t,a=this.length;if((r=~~r)<0?(r+=a)<0&&(r=0):r>a&&(r=a),(e=void 0===e?a:~~e)<0?(e+=a)<0&&(e=0):e>a&&(e=a),e<r&&(e=r),kb.TYPED_ARRAY_SUPPORT)(t=this.subarray(r,e)).__proto__=kb.prototype;else{var f=e-r;t=new kb(f,void 0);for(var $=0;$<f;++$)t[$]=this[$+r]}return t},kb.prototype.copy=function(r,e,t,a){if(t||(t=0),a||0===a||(a=this.length),e>=r.length&&(e=r.length),e||(e=0),a>0&&a<t&&(a=t),a===t)return 0;if(0===r.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(t<0||t>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),r.length-e<a-t&&(a=r.length-e+t);var f,$=a-t;if(this===r&&t<e&&e<a)for(f=$-1;f>=0;--f)r[f+e]=this[f+t];else if($<1e3||!kb.TYPED_ARRAY_SUPPORT)for(f=0;f<$;++f)r[f+e]=this[f+t];else Uint8Array.prototype.set.call(r,this.subarray(t,t+$),e);return $},kb.prototype.fill=function(r,e,t){if("string"==typeof r){if("string"==typeof e?(e=0,t=this.length):"string"==typeof t&&(t=this.length),1===r.length){var a=r.charCodeAt(0);a<256&&(r=a)}}else"number"==typeof r&&(r&=255);if(e<0||this.length<e||this.length<t)throw new RangeError("Out of range index");if(t<=e)return this;var f;if(e>>>=0,t=void 0===t?this.length:t>>>0,r||(r=0),"number"==typeof r)for(f=e;f<t;++f)this[f]=r;else{var $=kb.isBuffer(r)?r:new kb(r),n=$.length;for(f=0;f<t-e;++f)this[f+e]=$[f%n]}return this},kb.concat=function(r,e){if(!bk(r))throw new TypeError("\"list\" argument must be an Array of Buffers");if(0===r.length)return uf(null,0);var t;if(void 0===e)for(e=0,t=0;t<r.length;++t)e+=r[t].length;var a=$p(null,e),f=0;for(t=0;t<r.length;++t){var $=r[t];if(!kb.isBuffer($))throw new TypeError("\"list\" argument must be an Array of Buffers");$.copy(a,f),f+=$.length}return a},kb.byteLength=aq,kb.prototype._isBuffer=!0,kb.isBuffer=function(r){return!(null==r||!r._isBuffer)},Ob.alloc=function(r){var e=new kb(r);return e.fill(0),e},Ob.from=function(r){return new kb(r)};var bq,lC=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706],ek=function(o){if(!o)throw new Error("\"version\" cannot be null or undefined");if(o<1||o>40)throw new Error("\"version\" should be in range from 1 to 40");return 4*o+17};var fk=function(o){return lC[o]};var vf=function(o){for(var t=0;0!==o;)t++,o>>>=1;return t};var mC=function(o){if("function"!=typeof o)throw new Error("\"toSJISFunc\" is not a valid function.");bq=o};var Ug=function(){return void 0!==bq};var nC=function(o){return bq(o)};var gk={bit:1};var wf={bit:0};var hk={bit:3};var ik={bit:2};function oC(r){if("string"!=typeof r)throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return gk;case"m":case"medium":return wf;case"q":case"quartile":return hk;case"h":case"high":return ik;default:throw new Error("Unknown EC Level: "+r);}}var pC=function(r){return r&&void 0!==r.bit&&r.bit>=0&&r.bit<4};var cq=function(r,$){if(pC(r))return r;try{return oC(r)}catch(t){return $}};var qC={};function dq(){this.buffer=[],this.length=0}dq.prototype={get:function(t){var r=Math.floor(t/8);return 1==(this.buffer[r]>>>7-t%8&1)},put:function(t,r){for(var f=0;f<r;f++)this.putBit(1==(t>>>r-f-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}},qC=dq;var rC={};function bg(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=Ob.alloc(t*t),this.reservedBit=Ob.alloc(t*t)}bg.prototype.set=function(t,r,i,e){var $=t*this.size+r;this.data[$]=i,e&&(this.reservedBit[$]=!0)},bg.prototype.get=function(t,r){return this.data[t*this.size+r]},bg.prototype.xor=function(t,r,i){this.data[t*this.size+r]^=i},bg.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]},rC=bg;var sC=ek,tC=function(e){if(1===e)return[];for(var o=Math.floor(e/7)+2,r=sC(e),t=145===r?26:2*Math.ceil((r-13)/(2*o-2)),$=[r-7],s=1;s<o-1;s++)$[s]=$[s-1]-t;return $.push(6),$.reverse()};var uC=function(e){for(var o=[],r=tC(e),t=r.length,$=0;$<t;$++)for(var s=0;s<t;s++)0===$&&0===s||0===$&&s===t-1||$===t-1&&0===s||o.push([r[$],r[s]]);return o};var vC=ek,eq=7,wC=function($){var o=vC($);return[[0,0],[o-eq,0],[0,o-eq]]};var md={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};var Wd={N1:3,N2:3,N3:40,N4:10},xC=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7};var yC=function(t){return xC(t)?parseInt(t,10):void 0};var zC=function(t){for(var e=t.size,r=0,$=0,n=0,a=null,N=null,s=0;s<e;s++){$=n=0,a=N=null;for(var o=0;o<e;o++){var p=t.get(s,o);p===a?$++:($>=5&&(r+=Wd.N1+($-5)),a=p,$=1),(p=t.get(o,s))===N?n++:(n>=5&&(r+=Wd.N1+(n-5)),N=p,n=1)}$>=5&&(r+=Wd.N1+($-5)),n>=5&&(r+=Wd.N1+(n-5))}return r};var AC=function(t){for(var e=t.size,r=0,$=0;$<e-1;$++)for(var n=0;n<e-1;n++){var a=t.get($,n)+t.get($,n+1)+t.get($+1,n)+t.get($+1,n+1);4!==a&&0!==a||r++}return r*Wd.N2};var BC=function(t){for(var e=t.size,r=0,$=0,n=0,a=0;a<e;a++){$=n=0;for(var N=0;N<e;N++)$=$<<1&2047|t.get(a,N),N>=10&&(1488===$||93===$)&&r++,n=n<<1&2047|t.get(N,a),N>=10&&(1488===n||93===n)&&r++}return r*Wd.N3};var CC=function(t){for(var e=0,r=t.data.length,$=0;$<r;$++)e+=t.data[$];return Math.abs(Math.ceil(100*e/r/5)-10)*Wd.N4};function DC(t,e,r){switch(t){case md.PATTERN000:return(e+r)%2==0;case md.PATTERN001:return e%2==0;case md.PATTERN010:return r%3==0;case md.PATTERN011:return(e+r)%3==0;case md.PATTERN100:return(Math.floor(e/2)+Math.floor(r/3))%2==0;case md.PATTERN101:return e*r%2+e*r%3==0;case md.PATTERN110:return(e*r%2+e*r%3)%2==0;case md.PATTERN111:return(e*r%3+(e+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t);}}var jk=function(t,e){for(var r=e.size,$=0;$<r;$++)for(var n=0;n<r;n++)e.isReserved(n,$)||e.xor(n,$,DC(t,n,$))};var EC=function(t,e){for(var r=Object.keys(md).length,$=0,n=1/0,a=0;a<r;a++){e(a),jk(a,t);var N=zC(t)+AC(t)+BC(t)+CC(t);jk(a,t),N<n&&(n=N,$=a)}return $};var Vg=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Wg=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430],FC=function(e,$){switch($){case gk:return Vg[4*(e-1)+0];case wf:return Vg[4*(e-1)+1];case hk:return Vg[4*(e-1)+2];case ik:return Vg[4*(e-1)+3];default:return;}};var kk=function(e,$){switch($){case gk:return Wg[4*(e-1)+0];case wf:return Wg[4*(e-1)+1];case hk:return Wg[4*(e-1)+2];case ik:return Wg[4*(e-1)+3];default:return;}};var cg=Ob.alloc(512),lk=Ob.alloc(256);!function(){for(var $=1,r=0;r<255;r++)cg[r]=$,lk[$]=r,256&($<<=1)&&($^=285);for(r=255;r<512;r++)cg[r]=cg[r-255]}();var GC=function($){return cg[$]};var fq=function($,r){return 0===$||0===r?0:cg[lk[$]+lk[r]]};var HC=function(r,$){for(var e=Ob.alloc(r.length+$.length-1),J=0;J<r.length;J++)for(var o=0;o<$.length;o++)e[J+o]^=fq(r[J],$[o]);return e};var IC=function(r,$){for(var e=Ob.from(r);e.length-$.length>=0;){for(var J=e[0],o=0;o<$.length;o++)e[o]^=fq($[o],J);for(var t=0;t<e.length&&0===e[t];)t++;e=e.slice(t)}return e};var JC=function(r){for(var $=Ob.from([1]),e=0;e<r;e++)$=HC($,[1,GC(e)]);return $};var KC={},LC=(yd(),Tb).Buffer;function mk(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}mk.prototype.initialize=function(e){this.degree=e,this.genPoly=JC(this.degree)},mk.prototype.encode=function(e){if(!this.genPoly)throw new Error("Encoder not initialized");var r=Ob.alloc(this.degree),o=LC.concat([e,r],e.length+this.degree),$=IC(o,this.genPoly),i=this.degree-$.length;if(i>0){var t=Ob.alloc(this.degree);return $.copy(t,i),t}return $},KC=mk;var Xg=function($){return!isNaN($)&&$>=1&&$<=40};var gq="[0-9]+",MC="[A-Z $%*+\\-./:]+",nk="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",NC="(?:(?![A-Z0-9 $%*+\\-./:]|"+(nk=nk.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+",OC=new RegExp(nk,"g");var PC=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");var QC=new RegExp(NC,"g");var RC=new RegExp(gq,"g");var SC=new RegExp(MC,"g");var TC=new RegExp("^"+nk+"$"),UC=new RegExp("^"+gq+"$"),VC=new RegExp("^[A-Z0-9 $%*+\\-./:]+$"),WC=function($){return TC.test($)};var XC=function($){return UC.test($)};var YC=function($){return VC.test($)};var Dd={id:"Numeric",bit:1,ccBits:[10,12,14]};var nd={id:"Alphanumeric",bit:2,ccBits:[9,11,13]};var Jb={id:"Byte",bit:4,ccBits:[8,16,16]};var od={id:"Kanji",bit:8,ccBits:[8,10,12]};var hq={bit:-1};var ok=function(r,$){if(!r.ccBits)throw new Error("Invalid mode: "+r);if(!Xg($))throw new Error("Invalid version: "+$);return $>=1&&$<10?r.ccBits[0]:$<27?r.ccBits[1]:r.ccBits[2]};var ZC=function(r){return XC(r)?Dd:YC(r)?nd:WC(r)?od:Jb};var iq=function(r){if(r&&r.id)return r.id;throw new Error("Invalid mode")};var $C=function(r){return r&&r.bit&&r.ccBits};function _C(r){if("string"!=typeof r)throw new Error("Param is not a string");switch(r.toLowerCase()){case"numeric":return Dd;case"alphanumeric":return nd;case"kanji":return od;case"byte":return Jb;default:throw new Error("Unknown mode: "+r);}}var aD=function(r,$){if($C(r))return r;try{return _C(r)}catch(t){return $}};var jq=7973,kq=vf(jq);function bD(r,o,$){for(var e=1;e<=40;e++)if(o<=mq(e,$,r))return e}function lq(r,o){return ok(r,o)+4}function cD(r,o){var $=0;return r.forEach(function(r){var e=lq(r.mode,o);$+=e+r.getBitsLength()}),$}function dD(r,o){for(var $=1;$<=40;$++){if(cD(r,$)<=mq($,o,hq))return $}}var eD=function(r,o){return Xg(r)?parseInt(r,10):o};var mq=function(r,o,$){if(!Xg(r))throw new Error("Invalid QR Code version");void 0===$&&($=Jb);var e=8*(fk(r)-kk(r,o));if($===hq)return e;var t=e-lq($,r);switch($){case Dd:return Math.floor(t/10*3);case nd:return Math.floor(t/11*2);case od:return Math.floor(t/13);case Jb:default:return Math.floor(t/8);}};var nq=function(r,o){var $,e=cq(o,wf);if(bk(r)){if(r.length>1)return dD(r,e);if(0===r.length)return 1;$=r[0]}else $=r;return bD($.mode,$.getLength(),e)};var fD=function(r){if(!Xg(r)||r<7)throw new Error("Invalid QR Code version");for(var o=r<<12;vf(o)-kq>=0;)o^=jq<<vf(o)-kq;return r<<12|o};var oq=1335,gD=21522,pq=vf(oq),hD=function($,a){for(var r=$.bit<<3|a,t=r<<10;vf(t)-pq>=0;)t^=oq<<vf(t)-pq;return(r<<10|t)^gD};var qq={};function xf(t){this.mode=Dd,this.data=t.toString()}xf.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},xf.prototype.getLength=function(){return this.data.length},xf.prototype.getBitsLength=function(){return xf.getBitsLength(this.data.length)},xf.prototype.write=function(t){var a,r,e;for(a=0;a+3<=this.data.length;a+=3)r=this.data.substr(a,3),e=parseInt(r,10),t.put(e,10);var $=this.data.length-a;$>0&&(r=this.data.substr(a),e=parseInt(r,10),t.put(e,3*$+1))},qq=xf;var rq={},pk=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function yf(a){this.mode=nd,this.data=a}yf.getBitsLength=function(a){return 11*Math.floor(a/2)+a%2*6},yf.prototype.getLength=function(){return this.data.length},yf.prototype.getBitsLength=function(){return yf.getBitsLength(this.data.length)},yf.prototype.write=function(a){var t;for(t=0;t+2<=this.data.length;t+=2){var $=45*pk.indexOf(this.data[t]);$+=pk.indexOf(this.data[t+1]),a.put($,11)}this.data.length%2&&a.put(pk.indexOf(this.data[t]),6)},rq=yf;var sq={};function zf(t){this.mode=Jb,this.data=Ob.from(t)}zf.getBitsLength=function(t){return 8*t},zf.prototype.getLength=function(){return this.data.length},zf.prototype.getBitsLength=function(){return zf.getBitsLength(this.data.length)},zf.prototype.write=function(t){for(var $=0,e=this.data.length;$<e;$++)t.put(this.data[$],8)},sq=zf;var tq={};function Af(t){this.mode=od,this.data=t}Af.getBitsLength=function(t){return 13*t},Af.prototype.getLength=function(){return this.data.length},Af.prototype.getBitsLength=function(){return Af.getBitsLength(this.data.length)},Af.prototype.write=function(t){var a;for(a=0;a<this.data.length;a++){var r=nC(this.data[a]);if(r>=33088&&r<=40956)r-=33088;else{if(!(r>=57408&&r<=60351))throw new Error("Invalid SJIS character: "+this.data[a]+"\nMake sure your charset is UTF-8");r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13)}},tq=Af;var iD={},dg={single_source_shortest_paths:function(r,t,e){var s={},o={};o[t]=0;var u,i,a,n,h,p,$,f=dg.PriorityQueue.make();for(f.push(t,0);!f.empty();)for(a in i=(u=f.pop()).value,n=u.cost,h=r[i]||{})h.hasOwnProperty(a)&&(p=n+h[a],$=o[a],(void 0===o[a]||$>p)&&(o[a]=p,f.push(a,p),s[a]=i));if(void 0!==e&&void 0===o[e]){var v=["Could not find a path from ",t," to ",e,"."].join("");throw new Error(v)}return s},extract_shortest_path_from_predecessor_list:function(r,t){for(var e=[],s=t;s;)e.push(s),r[s],s=r[s];return e.reverse(),e},find_path:function(r,t,e){var s=dg.single_source_shortest_paths(r,t,e);return dg.extract_shortest_path_from_predecessor_list(s,e)},PriorityQueue:{make:function(r){var t,e=dg.PriorityQueue,s={};for(t in r=r||{},e)e.hasOwnProperty(t)&&(s[t]=e[t]);return s.queue=[],s.sorter=r.sorter||e.default_sorter,s},default_sorter:function(r,t){return r.cost-t.cost},push:function(r,t){var e={value:r,cost:t};this.queue.push(e),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};iD=dg;function uq(e){return unescape(encodeURIComponent(e)).length}function eg(e,$,r){for(var a,t=[];null!==(a=e.exec(r));)t.push({data:a[0],index:a.index,mode:$,length:a[0].length});return t}function vq(e){var $,r,a=eg(RC,Dd,e),t=eg(SC,nd,e);return Ug()?($=eg(QC,Jb,e),r=eg(OC,od,e)):($=eg(PC,Jb,e),r=[]),a.concat(t,$,r).sort(function(e,$){return e.index-$.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function qk(e,$){switch($){case Dd:return qq.getBitsLength(e);case nd:return rq.getBitsLength(e);case od:return tq.getBitsLength(e);case Jb:return sq.getBitsLength(e);}}function jD(e){return e.reduce(function(e,$){var r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===$.mode?(e[e.length-1].data+=$.data,e):(e.push($),e)},[])}function kD(e){for(var $=[],r=0;r<e.length;r++){var a=e[r];switch(a.mode){case Dd:$.push([a,{data:a.data,mode:nd,length:a.length},{data:a.data,mode:Jb,length:a.length}]);break;case nd:$.push([a,{data:a.data,mode:Jb,length:a.length}]);break;case od:$.push([a,{data:a.data,mode:Jb,length:uq(a.data)}]);break;case Jb:$.push([{data:a.data,mode:Jb,length:uq(a.data)}]);}}return $}function lD(e,$){for(var r={},a={start:{}},t=["start"],n=0;n<e.length;n++){for(var c=e[n],o=[],d=0;d<c.length;d++){var g=c[d],Q=""+n+d;o.push(Q),r[Q]={node:g,lastCount:0},a[Q]={};for(var V=0;V<t.length;V++){var i=t[V];r[i]&&r[i].node.mode===g.mode?(a[i][Q]=qk(r[i].lastCount+g.length,g.mode)-qk(r[i].lastCount,g.mode),r[i].lastCount+=g.length):(r[i]&&(r[i].lastCount=g.length),a[i][Q]=qk(g.length,g.mode)+4+ok(g.mode,$))}}t=o}for(V=0;V<t.length;V++)a[t[V]].end=0;return{map:a,table:r}}function wq(e,$){var r,a=ZC(e);if((r=aD($,a))!==Jb&&r.bit<a.bit)throw new Error("\""+e+"\" cannot be encoded with mode "+iq(r)+".\n Suggested mode is: "+iq(a));switch(r!==od||Ug()||(r=Jb),r){case Dd:return new qq(e);case nd:return new rq(e);case od:return new tq(e);case Jb:return new sq(e);}}var rk=function(e){return e.reduce(function(e,$){return"string"==typeof $?e.push(wq($,null)):$.data&&e.push(wq($.data,$.mode)),e},[])};var mD=function(e,$){for(var r=lD(kD(vq(e,Ug())),$),a=iD.find_path(r.map,"start","end"),t=[],n=1;n<a.length-1;n++)t.push(r.table[a[n]].node);return rk(jD(t))};var nD=function(e){return rk(vq(e,Ug()))};function oD(r,e){for(var $=r.size,t=wC(e),i=0;i<t.length;i++)for(var a=t[i][0],o=t[i][1],n=-1;n<=7;n++)if(!(a+n<=-1||$<=a+n))for(var s=-1;s<=7;s++)o+s<=-1||$<=o+s||(n>=0&&n<=6&&(0===s||6===s)||s>=0&&s<=6&&(0===n||6===n)||n>=2&&n<=4&&s>=2&&s<=4?r.set(a+n,o+s,!0,!0):r.set(a+n,o+s,!1,!0))}function pD(r){for(var e=r.size,$=8;$<e-8;$++){var t=$%2==0;r.set($,6,t,!0),r.set(6,$,t,!0)}}function qD(r,e){for(var $=uC(e),t=0;t<$.length;t++)for(var i=$[t][0],a=$[t][1],o=-2;o<=2;o++)for(var n=-2;n<=2;n++)-2===o||2===o||-2===n||2===n||0===o&&0===n?r.set(i+o,a+n,!0,!0):r.set(i+o,a+n,!1,!0)}function rD(r,e){for(var $,t,i,a=r.size,o=fD(e),n=0;n<18;n++)$=Math.floor(n/3),t=n%3+a-8-3,i=1==(o>>n&1),r.set($,t,i,!0),r.set(t,$,i,!0)}function sk(r,e,$){var t,i,a=r.size,o=hD(e,$);for(t=0;t<15;t++)i=1==(o>>t&1),t<6?r.set(t,8,i,!0):t<8?r.set(t+1,8,i,!0):r.set(a-15+t,8,i,!0),t<8?r.set(8,a-t-1,i,!0):t<9?r.set(8,15-t-1+1,i,!0):r.set(8,15-t-1,i,!0);r.set(a-8,8,1,!0)}function sD(r,e){for(var $=r.size,t=-1,i=$-1,a=7,o=0,n=$-1;n>0;n-=2)for(6===n&&n--;;){for(var s=0;s<2;s++)if(!r.isReserved(i,n-s)){var v=!1;o<e.length&&(v=1==(e[o]>>>a&1)),r.set(i,n-s,v),-1===--a&&(o++,a=7)}if((i+=t)<0||$<=i){i-=t,t=-t;break}}}function tD(r,e,$){var t=new qC;$.forEach(function(e){t.put(e.mode.bit,4),t.put(e.getLength(),ok(e.mode,r)),e.write(t)});var i=8*(fk(r)-kk(r,e));for(t.getLengthInBits()+4<=i&&t.put(0,4);t.getLengthInBits()%8!=0;)t.putBit(0);for(var a=(i-t.getLengthInBits())/8,o=0;o<a;o++)t.put(o%2?17:236,8);return uD(t,r,e)}function uD(r,e,$){for(var t=fk(e),i=t-kk(e,$),a=FC(e,$),o=a-t%a,n=Math.floor(t/a),s=Math.floor(i/a),v=s+1,b=n-s,y=new KC(b),X=0,f=new Array(a),u=new Array(a),l=0,c=Ob.from(r.buffer),d=0;d<a;d++){var m=d<o?s:v;f[d]=c.slice(X,X+m),u[d]=y.encode(f[d]),X+=m,l=Math.max(l,m)}var p,g,C=Ob.alloc(t),h=0;for(p=0;p<l;p++)for(g=0;g<a;g++)p<f[g].length&&(C[h++]=f[g][p]);for(p=0;p<b;p++)for(g=0;g<a;g++)C[h++]=u[g][p];return C}function vD(r,e,$,t){var i;if(bk(r))i=rk(r);else{if("string"!=typeof r)throw new Error("Invalid data");var a=e;if(!a){var o=nD(r);a=nq(o,$)}i=mD(r,a||40)}var n=nq(i,$);if(!n)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<n)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+n+".\n")}else e=n;var s=tD(e,$,i),v=ek(e),b=new rC(v);return oD(b,e),pD(b),qD(b,e),sk(b,$,0),e>=7&&rD(b,e),sD(b,s),isNaN(t)&&(t=EC(b,sk.bind(null,b,$))),jk(t,b),sk(b,$,t),{modules:b,version:e,errorCorrectionLevel:$,maskPattern:t,segments:i}}var xq=function(r,e){if(void 0===r||""===r)throw new Error("No input text");var $,t,i=wf;return void 0!==e&&(i=cq(e.errorCorrectionLevel,wf),$=eD(e.version),t=yC(e.maskPattern),e.toSJISFunc&&mC(e.toSJISFunc)),vD(r,$,i,t)};function yq(r){if("number"==typeof r&&(r=r.toString()),"string"!=typeof r)throw new Error("Color should be defined as hex string");var t=r.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw new Error("Invalid hex color: "+r);3!==t.length&&4!==t.length||(t=Array.prototype.concat.apply([],t.map(function(r){return[r,r]}))),6===t.length&&t.push("F","F");var e=parseInt(t.join(""),16);return{r:e>>24&255,g:e>>16&255,b:e>>8&255,a:255&e,hex:"#"+t.slice(0,6).join("")}}var zq=function(r){r||(r={}),r.color||(r.color={});var t=void 0===r.margin||null===r.margin||r.margin<0?4:r.margin,e=r.width&&r.width>=21?r.width:void 0,o=r.scale||4;return{width:e,scale:e?4:o,margin:t,color:{dark:yq(r.color.dark||"#000000ff"),light:yq(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}};var Aq=function(r,t){return t.width&&t.width>=r+2*t.margin?t.width/(r+2*t.margin):t.scale};var wD=function(r,t){var e=Aq(r,t);return Math.floor((r+2*t.margin)*e)};var xD=function(r,t,e){for(var o=t.modules.size,a=t.modules.data,n=Aq(o,e),i=Math.floor((o+2*e.margin)*n),$=e.margin*n,g=[e.color.light,e.color.dark],l=0;l<i;l++)for(var h=0;h<i;h++){var p=4*(l*i+h),c=e.color.light;if(l>=$&&h>=$&&l<i-$&&h<i-$)c=g[a[Math.floor((l-$)/n)*o+Math.floor((h-$)/n)]?1:0];r[p++]=c.r,r[p++]=c.g,r[p++]=c.b,r[p]=c.a}};function yD(e,t,r){e.clearRect(0,0,t.width,t.height),t.style||(t.style={}),t.height=r,t.width=r,t.style.height=r+"px",t.style.width=r+"px"}function zD(){try{return document.createElement("canvas")}catch(e){throw new Error("You need to specify a canvas element")}}var Bq=function(e,t,r){var a=r,o=t;void 0!==a||t&&t.getContext||(a=t,t=void 0),t||(o=zD()),a=zq(a);var $=wD(e.modules.size,a),n=o.getContext("2d"),i=n.createImageData($,$);return xD(i.data,e,a),yD(n,o,$),n.putImageData(i,0,0),o};var AD=function(e,t,r){var a=r;void 0!==a||t&&t.getContext||(a=t,t=void 0),a||(a={});var o=Bq(e,t,a),$=a.type||"image/png",n=a.rendererOpts||{};return o.toDataURL($,n.quality)};function Cq(r,t){var $=r.a/255,o=t+"=\""+r.hex+"\"";return $<1?o+" "+t+"-opacity=\""+$.toFixed(2).slice(1)+"\"":o}function tk(r,t,$){var o=r+t;return void 0!==$&&(o+=" "+$),o}function BD(r,t,$){for(var o="",e=0,a=!1,i=0,v=0;v<r.length;v++){var n=Math.floor(v%t),l=Math.floor(v/t);n||a||(a=!0),r[v]?(i++,v>0&&n>0&&r[v-1]||(o+=a?tk("M",n+$,.5+l+$):tk("m",e,0),e=0,a=!1),n+1<t&&r[v+1]||(o+=tk("h",i),i=0)):e++}return o}var CD=function(r,t,$){var o=zq(t),e=r.modules.size,a=r.modules.data,i=e+2*o.margin,v=o.color.light.a?"<path "+Cq(o.color.light,"fill")+" d=\"M0 0h"+i+"v"+i+"H0z\"/>":"",n="<path "+Cq(o.color.dark,"stroke")+" d=\""+BD(a,e,o.margin)+"\"/>",l="viewBox=\"0 0 "+i+" "+i+"\"",s="<svg xmlns=\"http://www.w3.org/2000/svg\" "+(o.width?"width=\""+o.width+"\" height=\""+o.width+"\" ":"")+l+" shape-rendering=\"crispEdges\">"+v+n+"</svg>\n";return"function"==typeof $&&$(null,s),s};function uk(r,e,$,a,t){var n=[].slice.call(arguments,1),o=n.length,C="function"==typeof n[o-1];if(!C&&!bC())throw new Error("Callback required as last argument");if(!C){if(o<1)throw new Error("Too few arguments provided");return 1===o?($=e,e=a=void 0):2!==o||e.getContext||(a=$,$=e,e=void 0),new Promise(function(t,n){try{var o=xq($,a);t(r(o,e,a))}catch(C){n(C)}})}if(o<2)throw new Error("Too few arguments provided");2===o?(t=$,$=e,e=a=void 0):3===o&&(e.getContext&&void 0===t?(t=a,a=void 0):(t=a,a=$,$=e,e=void 0));try{var x=xq($,a);t(null,r(x,e,a))}catch(v){t(v)}}var DD=uk.bind(null,Bq);var c=uk.bind(null,AD);var d=uk.bind(null,function(r,e,$){return CD(r,$)});var Yg={};var vk={};var Bf;var ED=function(t,e){return(ED=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function Zb(t,e){function r(){this.constructor=t}ED(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var Xd=function(){return Xd=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},Xd.apply(this,arguments)};function Dq(t,e,r,o){return new(r||(r=Promise))(function(n,a){function $(t){try{x(o.next(t))}catch(e){a(e)}}function i(t){try{x(o.throw(t))}catch(e){a(e)}}function x(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then($,i)}x((o=o.apply(t,e||[])).next())})}function Eq(t,e){var r,o,n,a,$={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;$;)try{if(r=1,o&&(n=2&a[0]?o.return:a[0]?o.throw||((n=o.return)&&n.call(o),0):o.next)&&!(n=n.call(o,a[1])).done)return n;switch(o=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return $.label++,{value:a[1],done:!1};case 5:$.label++,o=a[1],a=[0];continue;case 7:a=$.ops.pop(),$.trys.pop();continue;default:if(!(n=(n=$.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){$=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){$.label=a[1];break}if(6===a[0]&&$.label<n[1]){$.label=n[1],n=a;break}if(n&&$.label<n[2]){$.label=n[2],$.ops.push(a);break}n[2]&&$.ops.pop(),$.trys.pop();continue;}a=e.call(t,$)}catch(i){a=[6,i],o=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}function Kb(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],o=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function fg(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,a=r.call(t),$=[];try{for(;(void 0===e||e-->0)&&!(o=a.next()).done;)$.push(o.value)}catch(i){n={error:i}}finally{try{o&&!o.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return $}function Yd(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(fg(arguments[e]));return t}function Fq(t){return this instanceof Fq?(this.v=t,this):new Fq(t)}var wk={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},cb=function(e,r){if(!e)throw Cf(r)},Cf=function(e){return new Error("Firebase Database ("+wk.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},Gq=function(e){for(var r=[],t=0,o=0;o<e.length;o++){var i=e.charCodeAt(o);i<128?r[t++]=i:i<2048?(r[t++]=i>>6|192,r[t++]=63&i|128):55296==(64512&i)&&o+1<e.length&&56320==(64512&e.charCodeAt(o+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++o)),r[t++]=i>>18|240,r[t++]=i>>12&63|128,r[t++]=i>>6&63|128,r[t++]=63&i|128):(r[t++]=i>>12|224,r[t++]=i>>6&63|128,r[t++]=63&i|128)}return r},FD=function(e){for(var r=[],t=0,o=0;t<e.length;){var i=e[t++];if(i<128)r[o++]=String.fromCharCode(i);else if(i>191&&i<224){var n=e[t++];r[o++]=String.fromCharCode((31&i)<<6|63&n)}else if(i>239&&i<365){var $=((7&i)<<18|(63&(n=e[t++]))<<12|(63&(a=e[t++]))<<6|63&e[t++])-65536;r[o++]=String.fromCharCode(55296+($>>10)),r[o++]=String.fromCharCode(56320+(1023&$))}else{n=e[t++];var a=e[t++];r[o++]=String.fromCharCode((15&i)<<12|(63&n)<<6|63&a)}}return r.join("")},xk={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(e,r){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var t=r?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[],i=0;i<e.length;i+=3){var n=e[i],$=i+1<e.length,a=$?e[i+1]:0,s=i+2<e.length,x=s?e[i+2]:0,p=n>>2,c=(3&n)<<4|a>>4,h=(15&a)<<2|x>>6,m=63&x;s||(m=64,$||(h=64)),o.push(t[p],t[c],t[h],t[m])}return o.join("")},encodeString:function(e,r){return this.HAS_NATIVE_SUPPORT&&!r?btoa(e):this.encodeByteArray(Gq(e),r)},decodeString:function(e,r){return this.HAS_NATIVE_SUPPORT&&!r?atob(e):FD(this.decodeStringToByteArray(e,r))},decodeStringToByteArray:function(e,r){this.init_();for(var t=r?this.charToByteMapWebSafe_:this.charToByteMap_,o=[],i=0;i<e.length;){var n=t[e.charAt(i++)],$=i<e.length?t[e.charAt(i)]:0,a=++i<e.length?t[e.charAt(i)]:64,s=++i<e.length?t[e.charAt(i)]:64;if(++i,null==n||null==$||null==a||null==s)throw Error();var x=n<<2|$>>4;if(o.push(x),64!==a){var p=$<<4&240|a>>2;if(o.push(p),64!==s){var c=a<<6&192|s;o.push(c)}}}return o},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},GD=function(e){var r=Gq(e);return xk.encodeByteArray(r,!0)},Hq=function(e){try{return xk.decodeString(e,!0)}catch(r){console.error("base64Decode failed: ",r)}return null};function Iq(e){return gg(void 0,e)}function gg(e,r){if(!(r instanceof Object))return r;switch(r.constructor){case Date:return new Date(r.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return r;}for(var t in r)r.hasOwnProperty(t)&&(e[t]=gg(e[t],r[t]));return e}var Vb=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(r,t){e.resolve=r,e.reject=t})}return e.prototype.wrapCallback=function(e){var r=this;return function(t,o){t?r.reject(t):r.resolve(o),"function"==typeof e&&(r.promise.catch(function(){}),1===e.length?e(t):e(t,o))}},e}();function HD(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Jq(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(HD())}function ID(){try{return"[object process]"===Object.prototype.toString.call(Qb.process)}catch(e){return!1}}function JD(){return"object"==typeof self&&self.self===self}function KD(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function fd(){return!0===wk.NODE_CLIENT||!0===wk.NODE_ADMIN}var LD="FirebaseError",MD=function(e){function r(t,o,i){var n=e.call(this,o)||this;return n.code=t,n.customData=i,n.name=LD,Object.setPrototypeOf(n,r.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,yk.prototype.create),n}return Zb(r,e),r}(Error),yk=function(){function e(e,r,t){this.service=e,this.serviceName=r,this.errors=t}return e.prototype.create=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var o=r[0]||{},i=this.service+"/"+e,n=this.errors[e],$=n?ND(n,o):"Error",a=this.serviceName+": "+$+" ("+i+").";return new MD(i,a,o)},e}();function ND(e,r){return e.replace(OD,function(e,t){var o=r[t];return null!=o?String(o):"<"+t+"?>"})}var OD=/\{\$([^}]+)}/g;function hg(e){return JSON.parse(e)}function Db(e){return JSON.stringify(e)}var Kq=function(e){var r={},t={},o={},i="";try{var n=e.split(".");r=hg(Hq(n[0])||""),t=hg(Hq(n[1])||""),i=n[2],o=t.d||{},delete t.d}catch($){}return{header:r,claims:t,data:o,signature:i}},PD=function(e){var r=Kq(e).claims;return!!r&&"object"==typeof r&&r.hasOwnProperty("iat")},QD=function(e){var r=Kq(e).claims;return"object"==typeof r&&!0===r.admin};function Pb(e,r){return Object.prototype.hasOwnProperty.call(e,r)}function $b(e,r){return Object.prototype.hasOwnProperty.call(e,r)?e[r]:void 0}function zk(e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r))return!1;return!0}function Zg(e,r,t){var o={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(o[i]=r.call(t,e[i],i,e));return o}function RD(e){for(var r=[],t=function(e,t){Array.isArray(t)?t.forEach(function(t){r.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}):r.push(encodeURIComponent(e)+"="+encodeURIComponent(t))},o=0,i=Object.entries(e);o<i.length;o++){var n=i[o];t(n[0],n[1])}return r.length?"&"+r.join("&"):""}var SD=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,r){r||(r=0);var t=this.W_;if("string"==typeof e)for(var o=0;o<16;o++)t[o]=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),r+=4;else for(o=0;o<16;o++)t[o]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r+=4;for(o=16;o<80;o++){var i=t[o-3]^t[o-8]^t[o-14]^t[o-16];t[o]=4294967295&(i<<1|i>>>31)}var n,$,a=this.chain_[0],s=this.chain_[1],x=this.chain_[2],p=this.chain_[3],c=this.chain_[4];for(o=0;o<80;o++){o<40?o<20?(n=p^s&(x^p),$=1518500249):(n=s^x^p,$=1859775393):o<60?(n=s&x|p&(s|x),$=2400959708):(n=s^x^p,$=3395469782);i=(a<<5|a>>>27)+n+c+$+t[o]&4294967295;c=p,p=x,x=4294967295&(s<<30|s>>>2),s=a,a=i}this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+x&4294967295,this.chain_[3]=this.chain_[3]+p&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295},e.prototype.update=function(e,r){if(null!=e){void 0===r&&(r=e.length);for(var t=r-this.blockSize,o=0,i=this.buf_,n=this.inbuf_;o<r;){if(0===n)for(;o<=t;)this.compress_(e,o),o+=this.blockSize;if("string"==typeof e){for(;o<r;)if(i[n]=e.charCodeAt(o),++o,++n===this.blockSize){this.compress_(i),n=0;break}}else for(;o<r;)if(i[n]=e[o],++o,++n===this.blockSize){this.compress_(i),n=0;break}}this.inbuf_=n,this.total_+=r}},e.prototype.digest=function(){var e=[],r=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var t=this.blockSize-1;t>=56;t--)this.buf_[t]=255&r,r/=256;this.compress_(this.buf_);var o=0;for(t=0;t<5;t++)for(var i=24;i>=0;i-=8)e[o]=this.chain_[t]>>i&255,++o;return e},e}();function TD(e,r){var t=new UD(e,r);return t.subscribe.bind(t)}var UD=function(){function e(e,r){var t=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(function(){e(t)}).catch(function(e){t.error(e)})}return e.prototype.next=function(e){this.forEachObserver(function(r){r.next(e)})},e.prototype.error=function(e){this.forEachObserver(function(r){r.error(e)}),this.close(e)},e.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},e.prototype.subscribe=function(e,r,t){var o,i=this;if(void 0===e&&void 0===r&&void 0===t)throw new Error("Missing Observer.");void 0===(o=VD(e,["next","error","complete"])?e:{next:e,error:r,complete:t}).next&&(o.next=Ak),void 0===o.error&&(o.error=Ak),void 0===o.complete&&(o.complete=Ak);var n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?o.error(i.finalError):o.complete()}catch(e){}}),this.observers.push(o),n},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var r=0;r<this.observers.length;r++)this.sendOne(r,e)},e.prototype.sendOne=function(e,r){var t=this;this.task.then(function(){if(void 0!==t.observers&&void 0!==t.observers[e])try{r(t.observers[e])}catch(o){"undefined"!=typeof console&&console.error&&console.error(o)}})},e.prototype.close=function(e){var r=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(function(){r.observers=void 0,r.onNoObservers=void 0}))},e}();function VD(e,r){if("object"!=typeof e||null===e)return!1;for(var t=0,o=r;t<o.length;t++){var i=o[t];if(i in e&&"function"==typeof e[i])return!0}return!1}function Ak(){}var fb=function(e,r,t,o){var i;if(o<r?i="at least "+r:o>t&&(i=0===t?"none":"no more than "+t),i)throw new Error(e+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+i+".")};function Wb(e,r,t){var o="";switch(r){case 1:o=t?"first":"First";break;case 2:o=t?"second":"Second";break;case 3:o=t?"third":"Third";break;case 4:o=t?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?");}var i=e+" failed: ";return i+=o+" argument "}function Eb(e,r,t,o){if((!o||t)&&"function"!=typeof t)throw new Error(Wb(e,r,o)+"must be a valid function.")}function Lq(e,r,t,o){if((!o||t)&&("object"!=typeof t||null===t))throw new Error(Wb(e,r,o)+"must be a valid context object.")}var WD=function(e){for(var r=[],t=0,o=0;o<e.length;o++){var i=e.charCodeAt(o);if(i>=55296&&i<=56319){var n=i-55296;cb(++o<e.length,"Surrogate pair missing trail surrogate."),i=65536+(n<<10)+(e.charCodeAt(o)-56320)}i<128?r[t++]=i:i<2048?(r[t++]=i>>6|192,r[t++]=63&i|128):i<65536?(r[t++]=i>>12|224,r[t++]=i>>6&63|128,r[t++]=63&i|128):(r[t++]=i>>18|240,r[t++]=i>>12&63|128,r[t++]=i>>6&63|128,r[t++]=63&i|128)}return r},$g=function(e){for(var r=0,t=0;t<e.length;t++){var o=e.charCodeAt(t);o<128?r++:o<2048?r+=2:o>=55296&&o<=56319?(r+=4,t++):r+=3}return r};var ig=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t}(),Df="[DEFAULT]",Mq=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return t.prototype.get=function(t){void 0===t&&(t=Df);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Vb;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e=Xd({identifier:Df,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(!o){if(r)return null;throw Error("Service "+this.name+" is not available")}return o}catch(s){if(r)return null;throw s}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,YD(t))try{this.getOrInitializeService(Df)}catch(c){}try{for(var r=Kb(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=fg(i.value,2),s=o[0],a=o[1],p=this.normalizeInstanceIdentifier(s);try{var u=this.getOrInitializeService(p);a.resolve(u)}catch(c){}}}catch($){e={error:$}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},t.prototype.clearInstance=function(t){void 0===t&&(t=Df),this.instancesDeferred.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return Dq(this,void 0,void 0,function(){var t;return Eq(this,function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all(Yd(t.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}),t.filter(function(t){return"_delete"in t}).map(function(t){return t._delete()})))];case 1:return e.sent(),[2];}})})},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,XD(t)),this.instances.set(t,e)),e||null},t.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:Df:t},t}();function XD(t){return t===Df?void 0:t}function YD(t){return"EAGER"===t.instantiationMode}var Nq=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new Mq(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();var ZD,jg;function _b(){for(var e=0,r=0,o=arguments.length;r<o;r++)e+=arguments[r].length;var t=Array(e),$=0;for(r=0;r<o;r++)for(var p=arguments[r],l=0,n=p.length;l<n;l++,$++)t[$]=p[l];return t}var ub,Bk=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(ub||(ZD=ub={},ZD));var Oq={debug:ub.DEBUG,verbose:ub.VERBOSE,info:ub.INFO,warn:ub.WARN,error:ub.ERROR,silent:ub.SILENT},$D=ub.INFO,_D=((jg={})[ub.DEBUG]="log",jg[ub.VERBOSE]="log",jg[ub.INFO]="info",jg[ub.WARN]="warn",jg[ub.ERROR]="error",jg),aE=function(e,r){for(var o=[],t=2;t<arguments.length;t++)o[t-2]=arguments[t];if(!(r<e.logLevel)){var $=new Date().toISOString(),p=_D[r];if(!p)throw new Error("Attempted to log a message with an invalid logType (value: "+r+")");console[p].apply(console,_b(["["+$+"]  "+e.name+":"],o))}},Pq=function(){function e(e){this.name=e,this._logLevel=$D,this._logHandler=aE,this._userLogHandler=null,Bk.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in ub))throw new TypeError("Invalid value \""+e+"\" assigned to `logLevel`");this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"==typeof e?Oq[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,_b([this,ub.DEBUG],e)),this._logHandler.apply(this,_b([this,ub.DEBUG],e))},e.prototype.log=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,_b([this,ub.VERBOSE],e)),this._logHandler.apply(this,_b([this,ub.VERBOSE],e))},e.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,_b([this,ub.INFO],e)),this._logHandler.apply(this,_b([this,ub.INFO],e))},e.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,_b([this,ub.WARN],e)),this._logHandler.apply(this,_b([this,ub.WARN],e))},e.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];this._userLogHandler&&this._userLogHandler.apply(this,_b([this,ub.ERROR],e)),this._logHandler.apply(this,_b([this,ub.ERROR],e))},e}();function bE(e){Bk.forEach(function(r){r.setLogLevel(e)})}function cE(e,r){for(var o=function(o){var t=null;r&&r.level&&(t=Oq[r.level]),o.userLogHandler=null===e?null:function(r,o){for(var $=[],p=2;p<arguments.length;p++)$[p-2]=arguments[p];var l=$.map(function(e){if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(function(e){return e}).join(" ");o>=(null!=t?t:r.logLevel)&&e({level:ub[o].toLowerCase(),message:l,args:$,type:r.name})}},t=0,$=Bk;t<$.length;t++){o($[t])}}var Qq,dE=((Bf={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Bf["bad-app-name"]="Illegal App name: '{$appName}",Bf["duplicate-app"]="Firebase App named '{$appName}' already exists",Bf["app-deleted"]="Firebase App named '{$appName}' already deleted",Bf["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Bf["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Bf),Ef=new yk("app","Firebase",dE),Rq="@firebase/app",eE="0.6.12",_g="[DEFAULT]",fE=((Qq={})[Rq]="fire-core",Qq["fire-js"]="fire-js",Qq),Ff=new Pq("@firebase/app"),aj=function(){function e(e,r,a){var n,t,$=this;this.firebase_=a,this.isDeleted_=!1,this.name_=r.name,this.automaticDataCollectionEnabled_=r.automaticDataCollectionEnabled||!1,this.options_=Iq(e),this.container=new Nq(r.name),this._addComponent(new ig("app",function(){return $},"PUBLIC"));try{for(var i=Kb(this.firebase_.INTERNAL.components.values()),o=i.next();!o.done;o=i.next()){var s=o.value;this._addComponent(s)}}catch(p){n={error:p}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise(function(r){e.checkDestroyed_(),r()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(e){return e.delete()}))}).then(function(){e.isDeleted_=!0})},e.prototype._getService=function(e,r){return void 0===r&&(r=_g),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:r})},e.prototype._removeServiceInstance=function(e,r){void 0===r&&(r=_g),this.container.getProvider(e).clearInstance(r)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(r){Ff.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,r)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Ef.create("app-deleted",{appName:this.name_})},e}();aj.prototype.name&&aj.prototype.options||aj.prototype.delete||console.log("dc");var gE="8.0.0";function hE(e){var r={},a=new Map,n={__esModule:!0,initializeApp:function(a,t){void 0===t&&(t={});if("object"!=typeof t||null===t){var $=t;t={name:$}}var i=t;void 0===i.name&&(i.name=_g);var o=i.name;if("string"!=typeof o||!o)throw Ef.create("bad-app-name",{appName:String(o)});if(Pb(r,o))throw Ef.create("duplicate-app",{appName:o});var s=new e(a,i,n);return r[o]=s,s},app:t,registerVersion:function(e,r,a){var n,t=null!==(n=fE[e])&&void 0!==n?n:e;a&&(t+="-"+a);var i=t.match(/\s|\//),o=r.match(/\s|\//);if(i||o){var s=["Unable to register library \""+t+"\" with version \""+r+"\":"];return i&&s.push("library name \""+t+"\" contains illegal characters (whitespace or \"/\")"),i&&o&&s.push("and"),o&&s.push("version name \""+r+"\" contains illegal characters (whitespace or \"/\")"),void Ff.warn(s.join(" "))}$(new ig(t+"-version",function(){return{library:t,version:r}},"VERSION"))},setLogLevel:bE,onLog:function(e,r){if(null!==e&&"function"!=typeof e)throw Ef.create("invalid-log-argument",{appName:name});cE(e,r)},apps:null,SDK_VERSION:gE,INTERNAL:{registerComponent:$,removeApp:function(e){delete r[e]},components:a,useAsService:function(e,r){if("serverAuth"===r)return null;return r}}};function t(e){if(e=e||_g,!Pb(r,e))throw Ef.create("no-app",{appName:e});return r[e]}function $($){var i,o,s=$.name;if(a.has(s))return Ff.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===$.type?n[s]:null;if(a.set(s,$),"PUBLIC"===$.type){var p=function(e){if(void 0===e&&(e=t()),"function"!=typeof e[s])throw Ef.create("invalid-app-argument",{appName:s});return e[s]()};void 0!==$.serviceProps&&gg(p,$.serviceProps),n[s]=p,e.prototype[s]=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return this._getService.bind(this,s).apply(this,$.multipleInstances?e:[])}}try{for(var l=Kb(Object.keys(r)),c=l.next();!c.done;c=l.next()){var v=c.value;r[v]._addComponent($)}}catch(m){i={error:m}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}return"PUBLIC"===$.type?n[s]:null}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(r).map(function(e){return r[e]})}}),t.App=e,n}function Sq(){var e=hE(aj);return e.INTERNAL=Xd(Xd({},e.INTERNAL),{createFirebaseNamespace:Sq,extendNamespace:function(r){gg(e,r)},createSubscribe:TD,ErrorFactory:yk,deepExtend:gg}),e}var Ck=Sq(),iE=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(e){if(jE(e)){var r=e.getImmediate();return r.library+"/"+r.version}return null}).filter(function(e){return e}).join(" ")},e}();function jE(e){var r=e.getComponent();return"VERSION"===(null==r?void 0:r.type)}function kE(e,r){e.INTERNAL.registerComponent(new ig("platform-logger",function(e){return new iE(e)},"PRIVATE")),e.registerVersion(Rq,eE,r),e.registerVersion("fire-js","")}if(JD()&&void 0!==self.firebase){Ff.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Tq=self.firebase.SDK_VERSION;Tq&&Tq.indexOf("LITE")>=0&&Ff.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var lE=Ck.initializeApp;Ck.initializeApp=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return ID()&&Ff.warn("\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the \"main\" field in package.json.\n      \n      If you are using Webpack, you can specify \"main\" as the first item in\n      \"resolve.mainFields\":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify \"main\"\n      as the first item in \"mainFields\", e.g. ['main', 'module'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      "),lE.apply(void 0,e)};var gb=Ck;kE(gb);vk.default=gb;var mE="firebase",nE="8.0.0";gb.registerVersion(mE,nE,"app");(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var n=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Qb&&Qb,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function i(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function r(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:i(t)}}!function(t,i){if(i){var r=n;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in r||(r[a]={}),r=r[a]}(i=i(o=r[t=t[t.length-1]]))!=o&&null!=i&&e(r,t,{configurable:!0,writable:!0,value:i})}}("Promise",function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(n){e.reject(n)}}function i(){this.a=null}function o(t){return t instanceof e?t:new e(function(e){e(t)})}if(t)return t;i.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var a=n.setTimeout;i.prototype.c=function(t){a(t,0)},i.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(i){this.f(i)}}}this.a=null},i.prototype.f=function(t){this.c(function(){throw t})},e.prototype.f=function(){function t(t){return function(i){n||(n=!0,t.call(e,i))}}var e=this,n=!1;return{resolve:t(this.v),reject:t(this.g)}},e.prototype.v=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.o(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1;}n?this.m(t):this.h(t)}},e.prototype.m=function(t){var e=void 0;try{e=t.then}catch(n){return void this.g(n)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new i;return e.prototype.o=function(t){var e=this.f();t.Pa(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(i){n.reject(i)}},e.prototype.then=function(t,n){function i(t,e){return"function"==typeof t?function(e){try{r(t(e))}catch(n){o(n)}}:e}var r,o,a=new e(function(t,e){r=t,o=e});return this.Pa(i(t,r),i(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Pa=function(t,e){function n(){switch(i.b){case 1:t(i.c);break;case 2:e(i.c);break;default:throw Error("Unexpected state: "+i.b);}}var i=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=o,e.reject=function(t){return new e(function(e,n){n(t)})},e.race=function(t){return new e(function(e,n){for(var i=r(t),a=i.next();!a.done;a=i.next())o(a.value).Pa(e,n)})},e.all=function(t){var n=r(t),i=n.next();return i.done?o([]):new e(function(t,e){function r(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,o(i.value).Pa(r(a.length-1),e),i=n.next()}while(!i.done)})},e});var o=o||{},a=this||self,s=/^[\w+/_-]+[=]{0,2}$/,u=null;function c(){}function h(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function l(t){var e=h(t);return"array"==e||"object"==e&&"number"==typeof t.length}function f(t){return"function"==h(t)}function d(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function p(t){return Object.prototype.hasOwnProperty.call(t,v)&&t[v]||(t[v]=++m)}var v="closure_uid_"+(1e9*Math.random()>>>0),m=0;function g(t,e,n){return t.call.apply(t.bind,arguments)}function b(t,e,n){if(!t)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,i),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function y(t,e,n){return(y=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?g:b).apply(null,arguments)}function w(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var I=Date.now||function(){return+new Date};function T(t,e){function n(){}n.prototype=e.prototype,t.$a=e.prototype,t.prototype=new n,t.prototype.constructor=t}function E(t,e,n){this.code=S+t,this.message=e||N[t]||"",this.a=n||null}function k(t){var e=t&&t.code;return e?new E(e.substring(S.length),t.message,t.serverResponse):null}T(E,Error),E.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},E.prototype.toJSON=function(){return this.w()};var A,S="auth/",N={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":"This operation is not supported in the environment this application is running on. \"location.protocol\" must be http, https or chrome-extension and web storage must be enabled.","popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},_={kd:{Sa:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},rd:{Sa:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://securetoken.googleapis.com/v1/token",Va:"https://identitytoolkit.googleapis.com/v2/",id:"p"},td:{Sa:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Ya:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Va:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},ud:{Sa:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Ya:"https://test-securetoken.sandbox.googleapis.com/v1/token",Va:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function O(t){for(var e in _)if(_[e].id===t)return{firebaseEndpoint:(t=_[e]).Sa,secureTokenEndpoint:t.Ya,identityPlatformEndpoint:t.Va};return null}function C(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(e){return!1}}function R(t){if(Error.captureStackTrace)Error.captureStackTrace(this,R);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function P(t,e){for(var n="",i=(t=t.split("%s")).length-1,r=0;r<i;r++)n+=t[r]+(r<e.length?e[r]:"%s");R.call(this,n+t[i])}function D(t,e){throw new P("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function L(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function x(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function M(){this.b=this.a=null}A=O("__EID__")?"__EID__":void 0,T(R,Error),R.prototype.name="CustomError",T(P,R),P.prototype.name="AssertionError",L.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var F=new L(function(){return new U},function(t){t.reset()});function j(){var t=me,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function U(){this.next=this.b=this.a=null}M.prototype.add=function(t,e){var n=F.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},U.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},U.prototype.reset=function(){this.next=this.b=this.a=null};var V=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},$=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var i=t.length,r="string"==typeof t?t.split(""):t,o=0;o<i;o++)o in r&&e.call(n,r[o],o,t)};var K=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=[],r=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(i[r++]=s)}return i},q=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,i=Array(n),r="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in r&&(i[o]=e.call(void 0,r[o],o,t));return i},H=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t))return!0;return!1};function G(t,e){return 0<=V(t,e)}function B(t,e){var n;return(n=0<=(e=V(t,e)))&&Array.prototype.splice.call(t,e,1),n}function W(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,i=t.length-1;0<=i;--i)i in n&&e.call(void 0,n[i],i,t)}(t,function(n,i){e.call(void 0,n,i,t)&&1==Array.prototype.splice.call(t,i,1).length&&0})}function X(t){return Array.prototype.concat.apply([],arguments)}function J(t){var e=t.length;if(0<e){for(var n=Array(e),i=0;i<e;i++)n[i]=t[i];return n}return[]}var Y,z=String.prototype.trim?function(t){return t.trim()}:function(t){return /^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},Z=/&/g,Q=/</g,tt=/>/g,et=/"/g,nt=/'/g,it=/\x00/g,rt=/[\x00&<>"']/;function ot(t,e){return-1!=t.indexOf(e)}function at(t,e){return t<e?-1:t>e?1:0}t:{var st=a.navigator;if(st){var ut=st.userAgent;if(ut){Y=ut;break t}}Y=""}function ct(t){return ot(Y,t)}function ht(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function lt(t){for(var e in t)return!1;return!0}function ft(t){var e,n={};for(e in t)n[e]=t[e];return n}var dt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pt(t,e){for(var n,i,r=1;r<arguments.length;r++){for(n in i=arguments[r])t[n]=i[n];for(var o=0;o<dt.length;o++)n=dt[o],Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}}function vt(t,e){t:{try{var n=t&&t.ownerDocument,i=n&&(n.defaultView||n.parentWindow);if((i=i||a).Element&&i.Location){var r=i;break t}}catch(s){}r=null}if(r&&void 0!==r[e]&&(!t||!(t instanceof r[e])&&(t instanceof r.Location||t instanceof r.Element))){if(d(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(s){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;D("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function mt(t,e){this.a=t===yt&&e||"",this.b=bt}function gt(t){return t instanceof mt&&t.constructor===mt&&t.b===bt?t.a:(D("expected object of type Const, got '"+t+"'"),"type_error:Const")}mt.prototype.sa=!0,mt.prototype.ra=function(){return this.a},mt.prototype.toString=function(){return"Const{"+this.a+"}"};var bt={},yt={},wt=new mt(yt,"");function It(t,e){this.a=t===Nt&&e||"",this.b=St}function Tt(t){return t instanceof It&&t.constructor===It&&t.b===St?t.a:(D("expected object of type TrustedResourceUrl, got '"+t+"' of type "+h(t)),"type_error:TrustedResourceUrl")}function Et(t,e){var n=gt(t);if(!At.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(kt,function(t,i){if(!Object.prototype.hasOwnProperty.call(e,i))throw Error("Found marker, \""+i+"\", in format string, \""+n+"\", but no valid label mapping found in args: "+JSON.stringify(e));return(t=e[i])instanceof mt?gt(t):encodeURIComponent(String(t))}),new It(Nt,t)}It.prototype.sa=!0,It.prototype.ra=function(){return this.a.toString()},It.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var kt=/%{(\w+)}/g,At=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,St={},Nt={};function _t(t,e){this.a=t===Dt&&e||"",this.b=Pt}function Ot(t){return t instanceof _t&&t.constructor===_t&&t.b===Pt?t.a:(D("expected object of type SafeUrl, got '"+t+"' of type "+h(t)),"type_error:SafeUrl")}_t.prototype.sa=!0,_t.prototype.ra=function(){return this.a.toString()},_t.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Ct=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Rt(t){return t instanceof _t?t:(t="object"==typeof t&&t.sa?t.ra():String(t),Ct.test(t)||(t="about:invalid#zClosurez"),new _t(Dt,t))}var Pt={},Dt={};function Lt(){this.a="",this.b=Mt}function xt(t){return t instanceof Lt&&t.constructor===Lt&&t.b===Mt?t.a:(D("expected object of type SafeHtml, got '"+t+"' of type "+h(t)),"type_error:SafeHtml")}Lt.prototype.sa=!0,Lt.prototype.ra=function(){return this.a.toString()},Lt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Mt={};function Ft(t){var e=new Lt;return e.a=t,e}Ft("<!DOCTYPE html>");var jt=Ft("");function Ut(t,e){for(var n=t.split("%s"),i="",r=Array.prototype.slice.call(arguments,1);r.length&&1<n.length;)i+=n.shift()+r.shift();return i+n.join("%s")}function Vt(t){return rt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(Z,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Q,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(tt,"&gt;")),-1!=t.indexOf("\"")&&(t=t.replace(et,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(nt,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(it,"&#0;"))),t}function $t(t){return $t[" "](t),t}Ft("<br>"),$t[" "]=c;var Kt,qt,Ht=ct("Opera"),Gt=ct("Trident")||ct("MSIE"),Bt=ct("Edge"),Wt=Bt||Gt,Xt=ct("Gecko")&&!(ot(Y.toLowerCase(),"webkit")&&!ct("Edge"))&&!(ct("Trident")||ct("MSIE"))&&!ct("Edge"),Jt=ot(Y.toLowerCase(),"webkit")&&!ct("Edge");function Yt(){var t=a.document;return t?t.documentMode:void 0}t:{var zt="",Zt=(qt=Y,Xt?/rv:([^\);]+)(\)|;)/.exec(qt):Bt?/Edge\/([\d\.]+)/.exec(qt):Gt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(qt):Jt?/WebKit\/(\S+)/.exec(qt):Ht?/(?:Version)[ \/]?(\S+)/.exec(qt):void 0);if(Zt&&(zt=Zt?Zt[1]:""),Gt){var Qt=Yt();if(null!=Qt&&Qt>parseFloat(zt)){Kt=String(Qt);break t}}Kt=zt}var te,ee={};function ne(t){return function(t,e){var n=ee;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,function(){for(var e=0,n=z(String(Kt)).split("."),i=z(String(t)).split("."),r=Math.max(n.length,i.length),o=0;0==e&&o<r;o++){var a=n[o]||"",s=i[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=at(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||at(0==a[2].length,0==s[2].length)||at(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}te=a.document&&Gt?Yt():void 0;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(qt){}var ie=!Gt||9<=Number(te);function re(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function oe(t,e){ht(e,function(e,n){e&&"object"==typeof e&&e.sa&&(e=e.ra()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ue.hasOwnProperty(n)?t.setAttribute(ue[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}var ae,se,ue={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ce(t,e,n){var i=arguments,r=document,o=String(i[0]),a=i[1];if(!ie&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(" name=\"",Vt(a.name),"\""),a.type){o.push(" type=\"",Vt(a.type),"\"");var s={};pt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=he(r,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):oe(o,a)),2<i.length&&function(t,e,n){function i(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var r=2;r<n.length;r++){var o=n[r];!l(o)||d(o)&&0<o.nodeType?i(o):$(le(o)?J(o):o,i)}}(r,o,i),o}function he(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function le(t){if(t&&"number"==typeof t.length){if(d(t))return"function"==typeof t.item||"string"==typeof t.item;if(f(t))return"function"==typeof t.item}return!1}function fe(t){a.setTimeout(function(){throw t},0)}function de(){var t=a.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ct("Presto")&&(t=function(){var t,e,n=he(document,"IFRAME");n.style.display="none",t=n,e=new It(Nt,gt(wt)),vt(t,"HTMLIFrameElement"),t.src=Tt(e).toString(),document.documentElement.appendChild(n);var i=n.contentWindow;(n=i.document).open(),n.write(xt(jt)),n.close();var r="callImmediate"+Math.random(),o="file:"==i.location.protocol?"*":i.location.protocol+"//"+i.location.host;n=y(function(t){"*"!=o&&t.origin!=o||t.data!=r||this.port1.onmessage()},this),i.addEventListener("message",n,!1),this.port1={},this.port2={postMessage:function(){i.postMessage(r,o)}}}),void 0!==t&&!ct("Trident")&&!ct("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Fb;n.Fb=null,t()}},function(t){i.next={Fb:t},i=i.next,e.port2.postMessage(0)}}return function(t){a.setTimeout(t,0)}}function pe(t,e){se||function(){if(a.Promise&&a.Promise.resolve){var t=a.Promise.resolve(void 0);se=function(){t.then(ge)}}else se=function(){var t=ge;!f(a.setImmediate)||a.Window&&a.Window.prototype&&!ct("Edge")&&a.Window.prototype.setImmediate==a.setImmediate?(ae||(ae=de()),ae(t)):a.setImmediate(t)}}(),ve||(se(),ve=!0),me.add(t,e)}var ve=!1,me=new M;function ge(){for(var t;t=j();){try{t.a.call(t.b)}catch(e){fe(e)}x(F,t)}ve=!1}function be(t,e){if(this.a=ye,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=c)try{var n=this;t.call(e,function(t){Re(n,we,t)},function(t){if(!(t instanceof je))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(e){}Re(n,Ie,t)})}catch(i){Re(this,Ie,i)}}var ye=0,we=2,Ie=3;function Te(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Te.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ee=new L(function(){return new Te},function(t){t.reset()});function ke(t,e,n){var i=Ee.get();return i.g=t,i.b=e,i.f=n,i}function Ae(t){if(t instanceof be)return t;var e=new be(c);return Re(e,we,t),e}function Se(t){return new be(function(e,n){n(t)})}function Ne(t,e,n){Pe(t,e,n,null)||pe(w(e,t))}function _e(t){return new be(function(e){var n=t.length,i=[];if(n)for(var r=function(t,r,o){n--,i[t]=r?{Ob:!0,value:o}:{Ob:!1,reason:o},0==n&&e(i)},o=0;o<t.length;o++)Ne(t[o],w(r,o,!0),w(r,o,!1));else e(i)})}function Oe(t,e){t.b||t.a!=we&&t.a!=Ie||De(t),t.f?t.f.next=e:t.b=e,t.f=e}function Ce(t,e,n,i){var r=ke(null,null,null);return r.a=new be(function(t,o){r.g=e?function(n){try{var r=e.call(i,n);t(r)}catch(a){o(a)}}:t,r.b=n?function(e){try{var r=n.call(i,e);void 0===r&&e instanceof je?o(e):t(r)}catch(a){o(a)}}:o}),r.a.c=t,Oe(t,r),r.a}function Re(t,e,n){t.a==ye&&(t===n&&(e=Ie,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Pe(n,t.Zc,t.$c,t)||(t.i=n,t.a=e,t.c=null,De(t),e!=Ie||n instanceof je||function(t,e){t.g=!0,pe(function(){t.g&&Fe.call(null,e)})}(t,n)))}function Pe(t,e,n,i){if(t instanceof be)return Oe(t,ke(e||c,n||null,i)),!0;if(C(t))return t.then(e,n,i),!0;if(d(t))try{var r=t.then;if(f(r))return function(t,e,n,i,r){function o(t){a||(a=!0,i.call(r,t))}var a=!1;try{e.call(t,function(t){a||(a=!0,n.call(r,t))},o)}catch(s){o(s)}}(t,r,e,n,i),!0}catch(o){return n.call(i,o),!0}return!1}function De(t){t.h||(t.h=!0,pe(t.fc,t))}function Le(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function xe(t,e,n,i){if(n==Ie&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Me(e,n,i);else try{e.c?e.g.call(e.f):Me(e,n,i)}catch(r){Fe.call(null,r)}x(Ee,e)}function Me(t,e,n){e==we?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}be.prototype.then=function(t,e,n){return Ce(this,f(t)?t:null,f(e)?e:null,n)},be.prototype.$goog_Thenable=!0,(t=be.prototype).na=function(t,e){return(t=ke(t,t,e)).c=!0,Oe(this,t),this},t.s=function(t,e){return Ce(this,null,t,e)},t.cancel=function(t){if(this.a==ye){var e=new je(t);pe(function(){!function t(e,n){if(e.a==ye)if(e.c){var i=e.c;if(i.b){for(var r=0,o=null,a=null,s=i.b;s&&(s.c||(r++,s.a==e&&(o=s),!(o&&1<r)));s=s.next)o||(a=s);o&&(i.a==ye&&1==r?t(i,n):(a?((r=a).next==i.f&&(i.f=r),r.next=r.next.next):Le(i),xe(i,o,Ie,n)))}e.c=null}else Re(e,Ie,n)}(this,e)},this)}},t.Zc=function(t){this.a=ye,Re(this,we,t)},t.$c=function(t){this.a=ye,Re(this,Ie,t)},t.fc=function(){for(var t;t=Le(this);)xe(this,t,this.a,this.i);this.h=!1};var Fe=fe;function je(t){R.call(this,t)}function Ue(){0!=Ve&&($e[p(this)]=this),this.xa=this.xa,this.oa=this.oa}T(je,R),je.prototype.name="cancel";var Ve=0,$e={};function Ke(t){if(!t.xa&&(t.xa=!0,t.Da(),0!=Ve)){var e=p(t);if(0!=Ve&&t.oa&&0<t.oa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete $e[e]}}Ue.prototype.xa=!1,Ue.prototype.Da=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()};var qe=Object.freeze||function(t){return t},He=!Gt||9<=Number(te),Ge=Gt&&!ne("9"),Be=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{a.addEventListener("test",c,e),a.removeEventListener("test",c,e)}catch(n){}return t}();function We(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function Xe(t,e){if(We.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,i=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Xt){t:{try{$t(e.nodeName);var r=!0;break t}catch(o){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:Je[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}We.prototype.preventDefault=function(){this.defaultPrevented=!0},T(Xe,We);var Je=qe({2:"touch",3:"pen",4:"mouse"});Xe.prototype.preventDefault=function(){Xe.$a.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Ge)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(e){}},Xe.prototype.g=function(){return this.a};var Ye="closure_listenable_"+(1e6*Math.random()|0),ze=0;function Ze(t,e,n,i,r){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!i,this.Ua=r,this.key=++ze,this.va=this.Oa=!1}function Qe(t){t.va=!0,t.listener=null,t.proxy=null,t.src=null,t.Ua=null}function tn(t){this.src=t,this.a={},this.b=0}function en(t,e){var n=e.type;n in t.a&&B(t.a[n],e)&&(Qe(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function nn(t,e,n,i){for(var r=0;r<t.length;++r){var o=t[r];if(!o.va&&o.listener==e&&o.capture==!!n&&o.Ua==i)return r}return-1}tn.prototype.add=function(t,e,n,i,r){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=nn(t,e,i,r);return-1<a?(e=t[a],n||(e.Oa=!1)):((e=new Ze(e,this.src,o,!!i,r)).Oa=n,t.push(e)),e};var rn="closure_lm_"+(1e6*Math.random()|0),on={};function an(t,e,n,i,r){if(i&&i.once)un(t,e,n,i,r);else if(Array.isArray(e))for(var o=0;o<e.length;o++)an(t,e[o],n,i,r);else n=gn(n),t&&t[Ye]?yn(t,e,n,d(i)?!!i.capture:!!i,r):sn(t,e,n,!1,i,r)}function sn(t,e,n,i,r,o){if(!e)throw Error("Invalid event type");var a=d(r)?!!r.capture:!!r,s=vn(t);if(s||(t[rn]=s=new tn(t)),!(n=s.add(e,n,i,a,o)).proxy){if(i=function(){var t=pn,e=He?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=i,i.src=t,i.listener=n,t.addEventListener)Be||(r=a),void 0===r&&(r=!1),t.addEventListener(e.toString(),i,r);else if(t.attachEvent)t.attachEvent(ln(e.toString()),i);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(i)}0}}function un(t,e,n,i,r){if(Array.isArray(e))for(var o=0;o<e.length;o++)un(t,e[o],n,i,r);else n=gn(n),t&&t[Ye]?wn(t,e,n,d(i)?!!i.capture:!!i,r):sn(t,e,n,!0,i,r)}function cn(t,e,n,i,r){if(Array.isArray(e))for(var o=0;o<e.length;o++)cn(t,e[o],n,i,r);else i=d(i)?!!i.capture:!!i,n=gn(n),t&&t[Ye]?(t=t.v,(e=String(e).toString())in t.a&&-1<(n=nn(o=t.a[e],n,i,r))&&(Qe(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--))):t&&(t=vn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=nn(e,n,i,r)),(n=-1<t?e[t]:null)&&hn(n))}function hn(t){if("number"!=typeof t&&t&&!t.va){var e=t.src;if(e&&e[Ye])en(e.v,t);else{var n=t.type,i=t.proxy;e.removeEventListener?e.removeEventListener(n,i,t.capture):e.detachEvent?e.detachEvent(ln(n),i):e.addListener&&e.removeListener&&e.removeListener(i),0,(n=vn(e))?(en(n,t),0==n.b&&(n.src=null,e[rn]=null)):Qe(t)}}}function ln(t){return t in on?on[t]:on[t]="on"+t}function fn(t,e,n,i){var r=!0;if((t=vn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.va&&(o=dn(o,i),r=r&&!1!==o)}return r}function dn(t,e){var n=t.listener,i=t.Ua||t.src;return t.Oa&&hn(t),n.call(i,e)}function pn(t,e){if(t.va)return!0;if(!He){if(!e)t:{e=["window","event"];for(var n=a,i=0;i<e.length;i++)if(null==(n=n[e[i]])){e=null;break t}e=n}if(e=new Xe(i=e,this),n=!0,!(0>i.keyCode||null!=i.returnValue)){t:{var r=!1;if(0==i.keyCode)try{i.keyCode=-1;break t}catch(s){r=!0}(r||null==i.returnValue)&&(i.returnValue=!0)}for(i=[],r=e.b;r;r=r.parentNode)i.push(r);for(t=t.type,r=i.length-1;0<=r;r--){e.b=i[r];var o=fn(i[r],t,!0,e);n=n&&o}for(r=0;r<i.length;r++)e.b=i[r],o=fn(i[r],t,!1,e),n=n&&o}return n}return dn(t,new Xe(e,this))}function vn(t){return(t=t[rn])instanceof tn?t:null}var mn="__closure_events_fn_"+(1e9*Math.random()>>>0);function gn(t){return f(t)?t:(t[mn]||(t[mn]=function(e){return t.handleEvent(e)}),t[mn])}function bn(){Ue.call(this),this.v=new tn(this),this.$b=this,this.fb=null}function yn(t,e,n,i,r){t.v.add(String(e),n,!1,i,r)}function wn(t,e,n,i,r){t.v.add(String(e),n,!0,i,r)}function In(t,e,n,i){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var r=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.va&&a.capture==n){var s=a.listener,u=a.Ua||a.src;a.Oa&&en(t.v,a),r=!1!==s.call(u,i)&&r}}return r&&!i.defaultPrevented}function Tn(t,e,n){if(f(t))n&&(t=y(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=y(t.handleEvent,t)}return 2147483647<Number(e)?-1:a.setTimeout(t,e||0)}function En(t){var e=null;return new be(function(n,i){-1==(e=Tn(function(){n(void 0)},t))&&i(Error("Failed to schedule timer."))}).s(function(t){throw a.clearTimeout(e),t})}function kn(t){if(t.V&&"function"==typeof t.V)return t.V();if("string"==typeof t)return t.split("");if(l(t)){for(var e=[],n=t.length,i=0;i<n;i++)e.push(t[i]);return e}for(i in e=[],n=0,t)e[n++]=t[i];return e}function An(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.V||"function"!=typeof t.V){if(l(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var i in e=[],n=0,t)e[n++]=i;return e}}function Sn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var i=0;i<n;i+=2)this.set(arguments[i],arguments[i+1])}else if(t)if(t instanceof Sn)for(n=t.Y(),i=0;i<n.length;i++)this.set(n[i],t.get(n[i]));else for(i in t)this.set(i,t[i])}function Nn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var i=t.a[e];_n(t.b,i)&&(t.a[n++]=i),e++}t.a.length=n}if(t.c!=t.a.length){var r={};for(n=e=0;e<t.a.length;)_n(r,i=t.a[e])||(t.a[n++]=i,r[i]=1),e++;t.a.length=n}}function _n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}T(bn,Ue),bn.prototype[Ye]=!0,bn.prototype.addEventListener=function(t,e,n,i){an(this,t,e,n,i)},bn.prototype.removeEventListener=function(t,e,n,i){cn(this,t,e,n,i)},bn.prototype.dispatchEvent=function(t){var e,n=this.fb;if(n)for(e=[];n;n=n.fb)e.push(n);n=this.$b;var i=t.type||t;if("string"==typeof t)t=new We(t,n);else if(t instanceof We)t.target=t.target||n;else{var r=t;pt(t=new We(i,n),r)}if(r=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];r=In(a,i,!0,t)&&r}if(r=In(a=t.b=n,i,!0,t)&&r,r=In(a,i,!1,t)&&r,e)for(o=0;o<e.length;o++)r=In(a=t.b=e[o],i,!1,t)&&r;return r},bn.prototype.Da=function(){if(bn.$a.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],i=0;i<n.length;i++)0,Qe(n[i]);delete e.a[t],e.b--}}this.fb=null},(t=Sn.prototype).V=function(){Nn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return Nn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return _n(this.b,t)?this.b[t]:e},t.set=function(t,e){_n(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),i=0;i<n.length;i++){var r=n[i],o=this.get(r);t.call(e,o,r,this)}};var On=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/\\#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Cn(t,e){var n;this.a=this.l=this.f="",this.g=null,this.h=this.c="",this.i=!1,t instanceof Cn?(this.i=void 0!==e?e:t.i,Rn(this,t.f),this.l=t.l,this.a=t.a,Pn(this,t.g),this.c=t.c,Dn(this,Zn(t.b)),this.h=t.h):t&&(n=String(t).match(On))?(this.i=!!e,Rn(this,n[1]||"",!0),this.l=jn(n[2]||""),this.a=jn(n[3]||"",!0),Pn(this,n[4]),this.c=jn(n[5]||"",!0),Dn(this,n[6]||"",!0),this.h=jn(n[7]||"")):(this.i=!!e,this.b=new Bn(null,this.i))}function Rn(t,e,n){t.f=n?jn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Pn(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function Dn(t,e,n){e instanceof Bn?(t.b=e,function(t,e){e&&!t.f&&(Wn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Jn(this,e),zn(this,n,t))},t)),t.f=e}(t.b,t.i)):(n||(e=Un(e,Hn)),t.b=new Bn(e,t.i))}function Ln(t,e,n){t.b.set(e,n)}function xn(t,e){return t.b.get(e)}function Mn(t){return t instanceof Cn?new Cn(t):new Cn(t,void 0)}function Fn(t,e,n,i){var r=new Cn(null,void 0);return t&&Rn(r,t),e&&(r.a=e),n&&Pn(r,n),i&&(r.c=i),r}function jn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Un(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Vn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Vn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Cn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Un(e,$n,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Un(e,$n,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.c)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Un(n,"/"==n.charAt(0)?qn:Kn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Un(n,Gn)),t.join("")},Cn.prototype.resolve=function(t){var e=new Cn(this),n=!!t.f;n?Rn(e,t.f):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var i=t.c;if(n)Pn(e,t.g);else if(n=!!t.c){if("/"!=i.charAt(0))if(this.a&&!this.c)i="/"+i;else{var r=e.c.lastIndexOf("/");-1!=r&&(i=e.c.substr(0,r+1)+i)}if(".."==(r=i)||"."==r)i="";else if(ot(r,"./")||ot(r,"/.")){i=0==r.lastIndexOf("/",0),r=r.split("/");for(var o=[],a=0;a<r.length;){var s=r[a++];"."==s?i&&a==r.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),i&&a==r.length&&o.push("")):(o.push(s),i=!0)}i=o.join("/")}else i=r}return n?e.c=i:n=""!==t.b.toString(),n?Dn(e,Zn(t.b)):n=!!t.h,n&&(e.h=t.h),e};var $n=/[#\/\?@]/g,Kn=/[#\?:]/g,qn=/[#\?]/g,Hn=/[#\?@]/g,Gn=/#/g;function Bn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Wn(t){t.a||(t.a=new Sn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var i=t[n].indexOf("="),r=null;if(0<=i){var o=t[n].substring(0,i);r=t[n].substring(i+1)}else o=t[n];e(o,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Xn(t){var e=An(t);if(void 0===e)throw Error("Keys are undefined");var n=new Bn(null,void 0);t=kn(t);for(var i=0;i<e.length;i++){var r=e[i],o=t[i];Array.isArray(o)?zn(n,r,o):n.add(r,o)}return n}function Jn(t,e){Wn(t),e=Qn(t,e),_n(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,_n((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Nn(t)))}function Yn(t,e){return Wn(t),e=Qn(t,e),_n(t.a.b,e)}function zn(t,e,n){Jn(t,e),0<n.length&&(t.c=null,t.a.set(Qn(t,e),J(n)),t.b+=n.length)}function Zn(t){var e=new Bn;return e.c=t.c,t.a&&(e.a=new Sn(t.a),e.b=t.b),e}function Qn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function ti(t){var e=[];return function t(e,n,i){if(null==n)i.push("null");else{if("object"==typeof n){if(Array.isArray(n)){var r=n;n=r.length,i.push("[");for(var o="",a=0;a<n;a++)i.push(o),t(e,r[a],i),o=",";return void i.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(r in i.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,r)&&"function"!=typeof(a=n[r])&&(i.push(o),ri(r,i),i.push(":"),t(e,a,i),o=",");return void i.push("}")}n=n.valueOf()}switch(typeof n){case"string":ri(n,i);break;case"number":i.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":i.push(String(n));break;case"function":i.push("null");break;default:throw Error("Unknown type: "+typeof n);}}}(new ei,t,e),e.join("")}function ei(){}(t=Bn.prototype).add=function(t,e){Wn(this),this.c=null,t=Qn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Wn(this),this.a.forEach(function(n,i){$(n,function(n){t.call(e,n,i,this)},this)},this)},t.Y=function(){Wn(this);for(var t=this.a.V(),e=this.a.Y(),n=[],i=0;i<e.length;i++)for(var r=t[i],o=0;o<r.length;o++)n.push(e[i]);return n},t.V=function(t){Wn(this);var e=[];if("string"==typeof t)Yn(this,t)&&(e=X(e,this.a.get(Qn(this,t))));else{t=this.a.V();for(var n=0;n<t.length;n++)e=X(e,t[n])}return e},t.set=function(t,e){return Wn(this),this.c=null,Yn(this,t=Qn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.V(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var i=e[n],r=encodeURIComponent(String(i));i=this.V(i);for(var o=0;o<i.length;o++){var a=r;""!==i[o]&&(a+="="+encodeURIComponent(String(i[o]))),t.push(a)}}return this.c=t.join("&")};var ni={"\"":"\\\"","\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\u000b"},ii=/\uffff/.test("\uFFFF")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function ri(t,e){e.push("\"",t.replace(ii,function(t){var e=ni[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),ni[t]=e),e}),"\"")}function oi(){var t=ki();return Gt&&!!te&&11==te||/Edge\/\d+/.test(t)}function ai(){return a.window&&a.window.location.href||self&&self.location&&self.location.href||""}function si(t,e){e=e||a.window;var n="about:blank";t&&(n=Ot(Rt(t))),e.location.href=n}function ui(t){return!!((t=(t||ki()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ci(t){t=t||a.window;try{t.close()}catch(e){}}function hi(t,e,n){var i=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<r?r:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=ki().toLowerCase(),i&&(e.target=i,ot(n,"crios/")&&(e.target="_blank")),Ii(ki())==yi&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),i=window,e=n instanceof _t?n:Rt(void 0!==n.href?n.href:String(n)),n=t.target||n.target,r=[],t)switch(a){case"width":case"height":case"top":case"left":r.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(a+"="+(t[a]?1:0));}var a=r.join(",");if((ct("iPhone")&&!ct("iPod")&&!ct("iPad")||ct("iPad")||ct("iPod"))&&i.navigator&&i.navigator.standalone&&n&&"_self"!=n?(vt(a=he(document,"A"),"HTMLAnchorElement"),e instanceof _t||e instanceof _t||(e="object"==typeof e&&e.sa?e.ra():String(e),Ct.test(e)||(e="about:invalid#zClosurez"),e=new _t(Dt,e)),a.href=Ot(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,i,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=i.open("",n,a),t=Ot(e),a&&(Wt&&ot(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t=Ft("<meta name=\"referrer\" content=\"no-referrer\"><meta http-equiv=\"refresh\" content=\"0; url="+Vt(t)+"\">"),i=a.document)&&(i.write(xt(t)),i.close())):(a=i.open(Ot(e),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var li=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fi=/^[^@]+@[^@]+$/;function di(){var t=null;return new be(function(e){"complete"==a.document.readyState?e():(t=function(){e()},un(window,"load",t))}).s(function(e){throw cn(window,"load",t),e})}function pi(t){return t=t||ki(),!("file:"!==Oi()&&"ionic:"!==Oi()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function vi(){var t=a.window;try{return!(!t||t==t.top)}catch(e){return!1}}function mi(){return void 0!==a.WorkerGlobalScope&&"function"==typeof a.importScripts}function gi(){return gb.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":gb.INTERNAL.hasOwnProperty("node")?"Node":mi()?"Worker":"Browser"}function bi(){var t=gi();return"ReactNative"===t||"Node"===t}var yi="Firefox",wi="Chrome";function Ii(t){var e=t.toLowerCase();return ot(e,"opera/")||ot(e,"opr/")||ot(e,"opios/")?"Opera":ot(e,"iemobile")?"IEMobile":ot(e,"msie")||ot(e,"trident/")?"IE":ot(e,"edge/")?"Edge":ot(e,"firefox/")?yi:ot(e,"silk/")?"Silk":ot(e,"blackberry")?"Blackberry":ot(e,"webos")?"Webos":!ot(e,"safari/")||ot(e,"chrome/")||ot(e,"crios/")||ot(e,"android")?!ot(e,"chrome/")&&!ot(e,"crios/")||ot(e,"edge/")?ot(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":wi:"Safari"}var Ti={ld:"FirebaseCore-web",nd:"FirebaseUI-web"};function Ei(t,e){e=e||[];var n,i=[],r={};for(n in Ti)r[Ti[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],i.push(e[n]));return i.sort(),(e=i).length||(e=["FirebaseCore-web"]),"Browser"===(i=gi())?i=Ii(r=ki()):"Worker"===i&&(i=Ii(r=ki())+"-"+i),i+"/JsCore/"+t+"/"+e.join(",")}function ki(){return a.navigator&&a.navigator.userAgent||""}function Ai(t,e){t=t.split("."),e=e||a;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Si(){try{var t=a.localStorage,e=Li();if(t)return t.setItem(e,"1"),t.removeItem(e),!oi()||!!a.indexedDB}catch(n){return mi()&&!!a.indexedDB}return!1}function Ni(){return(_i()||"chrome-extension:"===Oi()||pi())&&!bi()&&Si()&&!mi()}function _i(){return"http:"===Oi()||"https:"===Oi()}function Oi(){return a.location&&a.location.protocol||null}function Ci(t){return!ui(t=t||ki())&&Ii(t)!=yi}function Ri(t){return void 0===t?null:ti(t)}function Pi(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Di(t){if(null!==t)return JSON.parse(t)}function Li(t){return t||Math.floor(1e9*Math.random()).toString()}function xi(t){return"Safari"!=Ii(t=t||ki())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Mi(){var t=a.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Fi(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=ki(),e=gi(),this.b=ui(t)||"ReactNative"===e}function ji(){var t=a.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Ui(t){"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t)}function Vi(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(n){}return null}function $i(){return!(!Ai("fireauth.oauthhelper",a)&&!Ai("fireauth.iframe",a))}Fi.prototype.get=function(){var t=a.navigator;return!t||"boolean"!=typeof t.onLine||!_i()&&"chrome-extension:"!==Oi()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Ki,qi={};function Hi(t){qi[t]||(qi[t]=!0,Ui(t))}try{var Gi={};Object.defineProperty(Gi,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Gi,"abcd",{configurable:!0,enumerable:!0,value:2}),Ki=2==Gi.abcd}catch(qt){Ki=!1}function Bi(t,e,n){Ki?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Wi(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Bi(t,n,e[n])}function Xi(t){var e={};return Wi(e,t),e}function Ji(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Bi(e,n,Ji(t[n]));return e}function Yi(t){var e=t&&(t[er]?"phone":null);if(!(e&&t&&t[tr]))throw new E("internal-error","Internal assert: invalid MultiFactorInfo object");Bi(this,"uid",t[tr]),Bi(this,"displayName",t[Zi]||null);var n=null;t[Qi]&&(n=new Date(t[Qi]).toUTCString()),Bi(this,"enrollmentTime",n),Bi(this,"factorId",e)}function zi(t){try{var e=new nr(t)}catch(n){e=null}return e}Yi.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var Zi="displayName",Qi="enrolledAt",tr="mfaEnrollmentId",er="phoneInfo";function nr(t){Yi.call(this,t),Bi(this,"phoneNumber",t[er])}function ir(t){var e={},n=t[sr],i=t[cr],r=t[hr];if(t=zi(t[ur]),!r||r!=or&&r!=ar&&!n||r==ar&&!i||r==rr&&!t)throw Error("Invalid checkActionCode response!");r==ar?(e[fr]=n||null,e[pr]=n||null,e[lr]=i):(e[fr]=i||null,e[pr]=i||null,e[lr]=n||null),e[dr]=t||null,Bi(this,mr,r),Bi(this,vr,Ji(e))}T(nr,Yi),nr.prototype.w=function(){var t=nr.$a.w.call(this);return t.phoneNumber=this.phoneNumber,t};var rr="REVERT_SECOND_FACTOR_ADDITION",or="EMAIL_SIGNIN",ar="VERIFY_AND_CHANGE_EMAIL",sr="email",ur="mfaInfo",cr="newEmail",hr="requestType",lr="email",fr="fromEmail",dr="multiFactorInfo",pr="previousEmail",vr="data",mr="operation";function gr(t){var e=xn(t=Mn(t),br)||null,n=xn(t,yr)||null,i=xn(t,Tr)||null;if(i=i&&kr[i]||null,!e||!n||!i)throw new E("argument-error",br+", "+yr+"and "+Tr+" are required in a valid action code URL.");Wi(this,{apiKey:e,operation:i,code:n,continueUrl:xn(t,wr)||null,languageCode:xn(t,Ir)||null,tenantId:xn(t,Er)||null})}var br="apiKey",yr="oobCode",wr="continueUrl",Ir="languageCode",Tr="mode",Er="tenantId",kr={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:rr,signIn:or,verifyAndChangeEmail:ar,verifyEmail:"VERIFY_EMAIL"};function Ar(t){try{return new gr(t)}catch(e){return null}}function Sr(t){var e=t[Rr];if(void 0===e)throw new E("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new E("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Nr];if(n&&"object"==typeof n){e=n[Lr];var i=n[Pr];if(n=n[Dr],"string"==typeof e&&e.length){if(this.a=e,void 0!==i&&"boolean"!=typeof i)throw new E("argument-error",Pr+" property must be a boolean when specified.");if(this.g=!!i,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new E("argument-error",Dr+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new E("argument-error",Lr+" property must be a non empty string when specified.");if(void 0!==i||void 0!==n)throw new E("missing-android-pkg-name")}}else if(void 0!==n)throw new E("argument-error",Nr+" property must be a non null object when specified.");if(this.f=null,(e=t[Cr])&&"object"==typeof e){if("string"==typeof(e=e[xr])&&e.length)this.f=e;else if(void 0!==e)throw new E("argument-error",xr+" property must be a non empty string when specified.")}else if(void 0!==e)throw new E("argument-error",Cr+" property must be a non null object when specified.");if(void 0!==(e=t[Or])&&"boolean"!=typeof e)throw new E("argument-error",Or+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[_r])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new E("argument-error",_r+" property must be a non empty string when specified.");this.i=t||null}var Nr="android",_r="dynamicLinkDomain",Or="handleCodeInApp",Cr="iOS",Rr="url",Pr="installApp",Dr="minimumVersion",Lr="packageName",xr="bundleId";function Mr(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Fr=null;function jr(t){var e="";return function(t,e){function n(e){for(;i<t.length;){var n=t.charAt(i++),r=Fr[n];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Fr){Fr={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var i=t.concat(e[n].split("")),r=0;r<i.length;r++){var o=i[r];void 0===Fr[o]&&(Fr[o]=r)}}}();for(var i=0;;){var r=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===r)break;e(r<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,function(t){e+=String.fromCharCode(t)}),e}function Ur(t){var e=$r(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.g=t,this.c=e.exp,this.h=e.sub,I(),this.a=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.b=!!e.is_anonymous||"anonymous"==this.a}function Vr(t){try{return new Ur(t)}catch(e){return null}}function $r(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(jr(t))}catch(i){}return null}Ur.prototype.S=function(){return this.f},Ur.prototype.i=function(){return this.b},Ur.prototype.toString=function(){return this.g};var Kr="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),qr=["client_id","response_type","scope","redirect_uri","state"],Hr={md:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Wa:qr},od:{Ja:null,ua:500,ta:750,fa:"github.com",Wa:qr},pd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Wa:qr},vd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Wa:Kr},jd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Wa:[]}};function Gr(t){for(var e in Hr)if(Hr[e].fa==t)return Hr[e];return null}function Br(t){var e={};e["facebook.com"]=zr,e["google.com"]=Qr,e["github.com"]=Zr,e["twitter.com"]=to;var n=t&&t[Xr];try{if(n)return e[n]?new e[n](t):new Yr(t);if(void 0!==t[Wr])return new Jr(t)}catch(i){}return null}var Wr="idToken",Xr="providerId";function Jr(t){var e=t[Xr];if(!e&&t[Wr]){var n=Vr(t[Wr]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Bi(this,"providerId",e),Bi(this,"isNewUser",n)}function Yr(t){Jr.call(this,t),Bi(this,"profile",Ji((t=Di(t.rawUserInfo||"{}"))||{}))}function zr(t){if(Yr.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Zr(t){if(Yr.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Bi(this,"username",this.profile&&this.profile.login||null)}function Qr(t){if(Yr.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function to(t){if(Yr.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Bi(this,"username",t.screenName||null)}function eo(t){var e=Mn(t),n=xn(e,"link"),i=xn(Mn(n),"link");return e=xn(e,"deep_link_id"),xn(Mn(e),"link")||e||i||n||t}function no(t,e){if(!t&&!e)throw new E("internal-error","Internal assert: no raw session string available");if(t&&e)throw new E("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?io:ro}T(Yr,Jr),T(zr,Yr),T(Zr,Yr),T(Qr,Yr),T(to,Yr);var io="enroll",ro="signin";function oo(){}function ao(t,e){return t.then(function(t){if(t[Xa]){var n=Vr(t[Xa]);if(!n||e!=n.h)throw new E("user-mismatch");return t}throw new E("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==S+"user-not-found"?new E("user-mismatch"):t})}function so(t,e){if(!e)throw new E("internal-error","failed to construct a credential");this.a=e,Bi(this,"providerId",t),Bi(this,"signInMethod",t)}function uo(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function co(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new so(t.providerId,t.pendingToken)}catch(e){}return null}function ho(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Bi(this,"idToken",e.idToken),e.accessToken&&Bi(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Bi(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new E("internal-error","failed to construct a credential");Bi(this,"accessToken",e.oauthToken),Bi(this,"secret",e.oauthTokenSecret)}Bi(this,"providerId",t),Bi(this,"signInMethod",n)}function lo(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Xn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function fo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new ho(t.providerId,e,t.signInMethod)}catch(n){}}return null}function po(t,e){this.Pc=e||[],Wi(this,{providerId:t,isOAuthProvider:!0}),this.Hb={},this.ob=(Gr(t)||{}).Ja||null,this.nb=null}function vo(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new E("argument-error","SAML provider IDs must be prefixed with \"saml.\"");po.call(this,t,[])}function mo(t){po.call(this,t,qr),this.a=[]}function go(){mo.call(this,"facebook.com")}function bo(t){if(!t)throw new E("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),new go().credential({accessToken:e})}function yo(){mo.call(this,"github.com")}function wo(t){if(!t)throw new E("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return d(t)&&(e=t.accessToken),new yo().credential({accessToken:e})}function Io(){mo.call(this,"google.com"),this.Ca("profile")}function To(t,e){var n=t;return d(t)&&(n=t.idToken,e=t.accessToken),new Io().credential({idToken:n,accessToken:e})}function Eo(){po.call(this,"twitter.com",Kr)}function ko(t,e){var n=t;if(d(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new E("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new ho("twitter.com",n,"twitter.com")}function Ao(t,e,n){this.a=t,this.f=e,Bi(this,"providerId","password"),Bi(this,"signInMethod",n===No.EMAIL_LINK_SIGN_IN_METHOD?No.EMAIL_LINK_SIGN_IN_METHOD:No.EMAIL_PASSWORD_SIGN_IN_METHOD)}function So(t){return t&&t.email&&t.password?new Ao(t.email,t.password,t.signInMethod):null}function No(){Wi(this,{providerId:"password",isOAuthProvider:!1})}function _o(t,e){if(!(e=Oo(e)))throw new E("argument-error","Invalid email link!");return new Ao(t,e.code,No.EMAIL_LINK_SIGN_IN_METHOD)}function Oo(t){return(t=Ar(t=eo(t)))&&t.operation===or?t:null}function Co(t){if(!(t.cb&&t.bb||t.La&&t.ea))throw new E("internal-error");this.a=t,Bi(this,"providerId","phone"),this.fa="phone",Bi(this,"signInMethod","phone")}function Ro(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return $(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(n){t[n]&&(e[n]=t[n])}),new Co(e)}return null}function Po(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.cb,code:t.a.bb}}function Do(t){try{this.a=t||gb.auth()}catch(e){throw new E("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Wi(this,{providerId:"phone",isOAuthProvider:!1})}function Lo(t,e){if(!t)throw new E("missing-verification-id");if(!e)throw new E("missing-verification-code");return new Co({cb:t,bb:e})}function xo(t){if(t.temporaryProof&&t.phoneNumber)return new Co({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,i=t&&t.oauthTokenSecret,r=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return To(o,n);case"facebook.com":return bo(n);case"github.com":return wo(n);case"twitter.com":return ko(n,i);default:return n||i||o||a?a?0==e.indexOf("saml.")?new so(e,a):new ho(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new mo(e).credential({idToken:o,accessToken:n,rawNonce:r}):null;}}catch(s){return null}}function Mo(t){if(!t.isOAuthProvider)throw new E("invalid-oauth-provider")}function Fo(t,e,n,i,r,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=i||null,this.i=o||null,this.h=a||null,this.a=r||null,!this.g&&!this.a)throw new E("invalid-auth-event");if(this.g&&this.a)throw new E("invalid-auth-event");if(this.g&&!this.f)throw new E("invalid-auth-event")}function jo(t){return(t=t||{}).type?new Fo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&k(t.error),t.postBody,t.tenantId):null}function Uo(){this.b=null,this.a=[]}no.prototype.Ha=function(){return this.a?Ae(this.a):Ae(this.b)},no.prototype.w=function(){return this.type==io?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},oo.prototype.ja=function(){},oo.prototype.b=function(){},oo.prototype.c=function(){},oo.prototype.w=function(){},so.prototype.ja=function(t){return ms(t,uo(this))},so.prototype.b=function(t,e){var n=uo(this);return n.idToken=e,gs(t,n)},so.prototype.c=function(t,e){return ao(bs(t,uo(this)),e)},so.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},ho.prototype.ja=function(t){return ms(t,lo(this))},ho.prototype.b=function(t,e){var n=lo(this);return n.idToken=e,gs(t,n)},ho.prototype.c=function(t,e){return ao(bs(t,lo(this)),e)},ho.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},po.prototype.Ka=function(t){return this.Hb=ft(t),this},T(vo,po),T(mo,po),mo.prototype.Ca=function(t){return G(this.a,t)||this.a.push(t),this},mo.prototype.Pb=function(){return J(this.a)},mo.prototype.credential=function(t,e){var n;if(!(n=d(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new E("argument-error","credential failed: must provide the ID token and/or the access token.");return new ho(this.providerId,n,this.providerId)},T(go,mo),Bi(go,"PROVIDER_ID","facebook.com"),Bi(go,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),T(yo,mo),Bi(yo,"PROVIDER_ID","github.com"),Bi(yo,"GITHUB_SIGN_IN_METHOD","github.com"),T(Io,mo),Bi(Io,"PROVIDER_ID","google.com"),Bi(Io,"GOOGLE_SIGN_IN_METHOD","google.com"),T(Eo,po),Bi(Eo,"PROVIDER_ID","twitter.com"),Bi(Eo,"TWITTER_SIGN_IN_METHOD","twitter.com"),Ao.prototype.ja=function(t){return this.signInMethod==No.EMAIL_LINK_SIGN_IN_METHOD?Qs(t,Ss,{email:this.a,oobCode:this.f}):Qs(t,Xs,{email:this.a,password:this.f})},Ao.prototype.b=function(t,e){return this.signInMethod==No.EMAIL_LINK_SIGN_IN_METHOD?Qs(t,Ns,{idToken:e,email:this.a,oobCode:this.f}):Qs(t,Vs,{idToken:e,email:this.a,password:this.f})},Ao.prototype.c=function(t,e){return ao(this.ja(t),e)},Ao.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Wi(No,{PROVIDER_ID:"password"}),Wi(No,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Wi(No,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Co.prototype.ja=function(t){return t.eb(Po(this))},Co.prototype.b=function(t,e){var n=Po(this);return n.idToken=e,Qs(t,Ys,n)},Co.prototype.c=function(t,e){var n=Po(this);return n.operation="REAUTH",ao(t=Qs(t,zs,n),e)},Co.prototype.w=function(){var t={providerId:"phone"};return this.a.cb&&(t.verificationId=this.a.cb),this.a.bb&&(t.verificationCode=this.a.bb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},Do.prototype.eb=function(t,e){var n=this.a.a;return Ae(e.verify()).then(function(i){if("string"!=typeof i)throw new E("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var r=d(t)?t.session:null,o=d(t)?t.phoneNumber:t;return(r&&r.type==io?r.Ha().then(function(t){return Qs(n,Ks,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:i}}).then(function(t){return t.phoneSessionInfo.sessionInfo})}):r&&r.type==ro?r.Ha().then(function(e){return function(t,e){return Qs(t,qs,e).then(function(t){return t.phoneResponseInfo.sessionInfo})}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:i}})}):function(t,e){return Qs(t,js,e)}(n,{phoneNumber:o,recaptchaToken:i})).then(function(t){return"function"==typeof e.reset&&e.reset(),t},function(t){throw"function"==typeof e.reset&&e.reset(),t});default:throw new E("argument-error","Only firebase.auth.ApplicationVerifiers with type=\"recaptcha\" are currently supported.");}})},Wi(Do,{PROVIDER_ID:"phone"}),Wi(Do,{PHONE_SIGN_IN_METHOD:"phone"}),Fo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Fo.prototype.S=function(){return this.h},Fo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Vo,$o=null;function Ko(t){var e="unauthorized-domain",n=void 0,i=Mn(t);t=i.a,"chrome-extension"==(i=i.f)?n=Ut("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==i||"https"==i?n=Ut("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",E.call(this,e,n)}function qo(t,e,n){E.call(this,t,n),(t=e||{}).Ib&&Bi(this,"email",t.Ib),t.ea&&Bi(this,"phoneNumber",t.ea),t.credential&&Bi(this,"credential",t.credential),t.Yb&&Bi(this,"tenantId",t.Yb)}function Ho(t){if(t.code){var e=t.code||"";0==e.indexOf(S)&&(e=e.substring(S.length));var n={credential:xo(t),Yb:t.tenantId};if(t.email)n.Ib=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new E(e,t.message||void 0);return new qo(e,n,t.message)}return null}function Go(){}function Bo(t){return t.c||(t.c=t.b())}function Wo(){}function Xo(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var i=e[n];try{return new ActiveXObject(i),t.f=i}catch(r){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Jo(){}function Yo(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=y(this.pc,this),this.a.onerror=y(this.Rb,this),this.a.onprogress=y(this.qc,this),this.a.ontimeout=y(this.uc,this)}function zo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Zo(t,e,n){this.reset(t,e,n,void 0,void 0)}T(Ko,E),T(qo,E),qo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&pt(t,e),t},qo.prototype.toJSON=function(){return this.w()},Go.prototype.c=null,T(Wo,Go),Wo.prototype.a=function(){var t=Xo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Wo.prototype.b=function(){var t={};return Xo(this)&&(t[0]=!0,t[1]=!0),t},Vo=new Wo,T(Jo,Go),Jo.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Yo;throw Error("Unsupported browser")},Jo.prototype.b=function(){return{}},(t=Yo.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.pc=function(){this.status=200,this.response=this.responseText=this.a.responseText,zo(this,4)},t.Rb=function(){this.status=500,this.response=this.responseText="",zo(this,4)},t.uc=function(){this.Rb()},t.qc=function(){this.status=200,zo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Zo.prototype.a=null;function Qo(t){this.f=t,this.b=this.c=this.a=null}function ta(t,e){this.name=t,this.value=e}Zo.prototype.reset=function(t,e,n,i,r){"number"==typeof r||0,i||I(),delete this.a},ta.prototype.toString=function(){return this.name};var ea=new ta("SEVERE",1e3),na=new ta("WARNING",900),ia=new ta("CONFIG",700),ra=new ta("FINE",500);Qo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(D("Root logger has no level set."),null)}(this).value)for(f(e)&&(e=e()),t=new Zo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var oa={},aa=null;function sa(t){var e;if(aa||(aa=new Qo(""),oa[""]=aa,aa.c=ia),!(e=oa[t])){e=new Qo(t);var n=t.lastIndexOf("."),i=t.substr(n+1);(n=sa(t.substr(0,n))).b||(n.b={}),n.b[i]=e,e.a=n,oa[t]=e}return e}function ua(t,e){t&&t.log(ra,e,void 0)}function ca(t){this.f=t}function ha(t){bn.call(this),this.o=t,this.readyState=la,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=sa("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}T(ca,Go),ca.prototype.a=function(){return new ha(this.f)},ca.prototype.b=function(t){return function(){return t}}({}),T(ha,bn);var la=0;function fa(t){t.c.read().then(t.oc.bind(t)).catch(t.Ta.bind(t))}function da(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,pa(t)}function pa(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function va(t){bn.call(this),this.headers=new Sn,this.O=t||null,this.c=!1,this.A=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.G=!1,this.g=0,this.o=null,this.m=ma,this.u=this.R=!1}(t=ha.prototype).open=function(t,e){if(this.readyState!=la)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,pa(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.tc.bind(this),this.Ta.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,da(this,!1)),this.readyState=la},t.tc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,pa(this)),this.a&&(this.readyState=3,pa(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.rc.bind(this),this.Ta.bind(this)):void 0!==a.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,fa(this)):t.text().then(this.sc.bind(this),this.Ta.bind(this)))))},t.oc=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?da(this,!0):pa(this),3==this.readyState&&fa(this)}},t.sc=function(t){this.a&&(this.response=this.responseText=t,da(this,!0))},t.rc=function(t){this.a&&(this.response=t,da(this,!0))},t.Ta=function(t){var e=this.h;e&&e.log(na,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&da(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(na,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(na,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},T(va,bn);var ma="";va.prototype.b=sa("goog.net.XhrIo");var ga=/^https?$/i,ba=["POST","PUT"];function ya(t,e,n,i,r){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.G=!1,t.c=!0,t.a=t.O?t.O.a():Vo.a(),t.A=t.O?Bo(t.O):Bo(Vo),t.a.onreadystatechange=y(t.Ub,t);try{ua(t.b,_a(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(s){return ua(t.b,_a(t,"Error opening Xhr: "+s.message)),void Ia(t,s)}e=i||"";var o=new Sn(t.headers);r&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(l(t)||"string"==typeof t)$(t,e,void 0);else for(var n=An(t),i=kn(t),r=i.length,o=0;o<r;o++)e.call(void 0,i[o],n&&n[o],t)}(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=wa,n=t.length,i="string"==typeof t?t.split(""):t,r=0;r<n;r++)if(r in i&&e.call(void 0,i[r],r,t)){e=r;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),i=a.FormData&&e instanceof a.FormData,!G(ba,n)||r||i||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.R&&(t.a.withCredentials=t.R);try{Aa(t),0<t.g&&(t.u=function(t){return Gt&&ne(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),ua(t.b,_a(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=y(t.Ma,t)):t.o=Tn(t.Ma,t.g,t)),ua(t.b,_a(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(s){ua(t.b,_a(t,"Send error: "+s.message)),Ia(t,s)}}function wa(t){return"content-type"==t.toLowerCase()}function Ia(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Ta(t),ka(t)}function Ta(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function Ea(t){if(t.c&&void 0!==o)if(t.A[1]&&4==Sa(t)&&2==Na(t))ua(t.b,_a(t,"Local request error detected and ignored"));else if(t.i&&4==Sa(t))Tn(t.Ub,0,t);else if(t.dispatchEvent("readystatechange"),4==Sa(t)){ua(t.b,_a(t,"Request complete")),t.c=!1;try{var e,n=Na(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var i=!0;break t;default:i=!1;}if(!(e=i)){var r;if(r=0===n){var s=String(t.l).match(On)[1]||null;if(!s&&a.self&&a.self.location){var u=a.self.location.protocol;s=u.substr(0,u.length-1)}r=!ga.test(s?s.toLowerCase():"")}e=r}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Sa(t)?t.a.statusText:""}catch(h){ua(t.b,"Can not get status: "+h.message),c=""}t.h=c+" ["+Na(t)+"]",Ta(t)}}finally{ka(t)}}}function ka(t,e){if(t.a){Aa(t);var n=t.a,i=t.A[0]?c:null;t.a=null,t.A=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(r){(t=t.b)&&t.log(ea,"Problem encountered resetting onreadystatechange: "+r.message,void 0)}}}function Aa(t){t.a&&t.u&&(t.a.ontimeout=null),t.o&&(a.clearTimeout(t.o),t.o=null)}function Sa(t){return t.a?t.a.readyState:0}function Na(t){try{return 2<Sa(t)?t.a.status:-1}catch(e){return-1}}function _a(t,e){return e+" ["+t.P+" "+t.l+" "+Na(t)+"]"}function Oa(t){var e=Va;this.g=[],this.u=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.m=this.A=this.i=!1,this.h=0,this.b=null,this.l=0}function Ca(t,e,n){t.a=!0,t.c=n,t.f=!e,La(t)}function Ra(t){if(t.a){if(!t.m)throw new xa(t);t.m=!1}}function Pa(t,e,n,i){t.g.push([e,n,i]),t.a&&La(t)}function Da(t){return H(t.g,function(t){return f(t[1])})}function La(t){if(t.h&&t.a&&Da(t)){var e=t.h,n=ja[e];n&&(a.clearTimeout(n.a),delete ja[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var i=n=!1;t.g.length&&!t.i;){var r=t.g.shift(),o=r[0],s=r[1];if(r=r[2],o=t.f?s:o)try{var u=o.call(r||t.o,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(C(e)||"function"==typeof a.Promise&&e instanceof a.Promise)&&(i=!0,t.i=!0)}catch(c){e=c,t.f=!0,Da(t)||(n=!0)}}t.c=e,i&&(u=y(t.v,t,!0),i=y(t.v,t,!1),e instanceof Oa?(Pa(e,u,i),e.A=!0):e.then(u,i)),n&&(e=new Fa(e),ja[e.a]=e,t.h=e.a)}function xa(){R.call(this)}function Ma(){R.call(this)}function Fa(t){this.a=a.setTimeout(y(this.c,this),0),this.b=t}(t=va.prototype).Ma=function(){void 0!==o&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ua(this.b,_a(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ua(this.b,_a(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ka(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),ka(this,!0)),va.$a.Da.call(this)},t.Ub=function(){this.xa||(this.N||this.i||this.f?Ea(this):this.Ic())},t.Ic=function(){Ea(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ma:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer;}var t=this.b;return t&&t.log(ea,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(e){return ua(this.b,"Can not get response: "+e.message),null}},Oa.prototype.cancel=function(t){if(this.a)this.c instanceof Oa&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.o,this):this.m=!0,this.a||(t=new Ma(this),Ra(this),Ca(this,!1,t))}},Oa.prototype.v=function(t,e){this.i=!1,Ca(this,t,e)},Oa.prototype.then=function(t,e,n){var i,r,o=new be(function(t,e){i=t,r=e});return Pa(this,i,function(t){t instanceof Ma?o.cancel():r(t)}),o.then(t,e,n)},Oa.prototype.$goog_Thenable=!0,T(xa,R),xa.prototype.message="Deferred has already fired",xa.prototype.name="AlreadyCalledError",T(Ma,R),Ma.prototype.message="Deferred was canceled",Ma.prototype.name="CanceledError",Fa.prototype.c=function(){throw delete ja[this.a],this.b};var ja={};function Ua(t){var e={},n=e.document||document,i=Tt(t).toString(),r=he(document,"SCRIPT"),o={Vb:r,Ma:void 0},c=new Oa(o),h=null,l=null!=e.timeout?e.timeout:5e3;return 0<l&&(h=window.setTimeout(function(){$a(r,!0);var t=new Ha(qa,"Timeout reached for loading script "+i);Ra(c),Ca(c,!1,t)},l),o.Ma=h),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||($a(r,e.wd||!1,h),Ra(c),Ca(c,!0,null))},r.onerror=function(){$a(r,!0,h);var t=new Ha(Ka,"Error while loading script "+i);Ra(c),Ca(c,!1,t)},pt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),oe(r,o),function(t,e){vt(t,"HTMLScriptElement"),t.src=Tt(e),null===u&&(u=(e=(e=a.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&s.test(e)?e:""),(e=u)&&t.setAttribute("nonce",e)}(r,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(r),c}function Va(){if(this&&this.Vb){var t=this.Vb;t&&"SCRIPT"==t.tagName&&$a(t,!0,this.Ma)}}function $a(t,e,n){null!=n&&a.clearTimeout(n),t.onload=c,t.onerror=c,t.onreadystatechange=c,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var Ka=0,qa=1;function Ha(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),R.call(this,n),this.code=t}function Ga(t){this.f=t}function Ba(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.v=t.secureTokenTimeout||Ja,this.g=ft(t.secureTokenHeaders||Ya),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.m=t.firebaseTimeout||za,this.a=ft(t.firebaseHeaders||Za),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==gi(),!(n=a.XMLHttpRequest||n&&gb.INTERNAL.node&&gb.INTERNAL.node.XMLHttpRequest)&&!mi())throw new E("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,mi()?this.f=new ca(self):bi()?this.f=new Ga(n):this.f=new Jo,this.b=null}T(Ha,R),T(Ga,Go),Ga.prototype.a=function(){return new this.f},Ga.prototype.b=function(){return{}};var Wa,Xa="idToken",Ja=new Fi(3e4,6e4),Ya={"Content-Type":"application/x-www-form-urlencoded"},za=new Fi(3e4,6e4),Za={"Content-Type":"application/json"};function Qa(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function ts(t,e){e&&(t.l=es("https://securetoken.googleapis.com/v1/token",e),t.h=es("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=es("https://identitytoolkit.googleapis.com/v2/",e))}function es(t,e){return t=Mn(t),e=Mn(e.url),t.c=t.a+t.c,Rn(t,e.f),t.a=e.a,Pn(t,e.g),t.toString()}function ns(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function is(t,e,n,i,r,o,s){(function(){var t=ki();return!((t=Ii(t)!=wi?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Gt&&te&&!(9<te))})()||mi()?t=y(t.u,t):(Wa||(Wa=new be(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{a[os]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=Et(rs,{onload:os});!function(t,e){Pa(t,null,e,void 0)}(Ua(n),function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)})),t=y(t.o,t)),t(e,n,i,r,o,s)}Ba.prototype.S=function(){return this.b},Ba.prototype.u=function(t,e,n,i,r,o){if(mi()&&(void 0===a.fetch||void 0===a.Headers||void 0===a.Request))throw new E("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new va(this.f);if(o){s.g=Math.max(0,o);var u=setTimeout(function(){s.dispatchEvent("timeout")},o)}yn(s,"complete",function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ua(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(n){t=null}e&&e(t)}),wn(s,"ready",function(){u&&clearTimeout(u),Ke(this)}),wn(s,"timeout",function(){u&&clearTimeout(u),Ke(this),e&&e(null)}),ya(s,t,n,i,r)};var rs=new mt(yt,"https://apis.google.com/js/client.js?onload=%{onload}"),os="__fcb"+Math.floor(1e6*Math.random()).toString();function as(t,e,n,i,r,o,a){var s=Mn(e+n);Ln(s,"key",t.c),a&&Ln(s,"cb",I().toString());var u="GET"==i;if(u)for(var c in r)r.hasOwnProperty(c)&&Ln(s,c,r[c]);return new be(function(e,n){is(t,s.toString(),function(t){t?t.error?n(eu(t,o||{})):e(t):n(new E("network-request-failed"))},i,u?void 0:ti(Pi(r)),t.a,t.m.get())})}function ss(t){if("string"!=typeof(t=t.email)||!fi.test(t))throw new E("invalid-email")}function us(t){"email"in t&&ss(t)}function cs(t){if(!t[Xa]){if(t.mfaPendingCredential)throw new E("multi-factor-auth-required",null,ft(t));throw new E("internal-error")}}function hs(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new E("internal-error")}else{if(!t.sessionInfo)throw new E("missing-verification-id");if(!t.code)throw new E("missing-verification-code")}}Ba.prototype.o=function(t,e,n,i,r){var o=this;Wa.then(function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:i,headers:r,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).s(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},Ba.prototype.yb=function(){return Qs(this,$s,{})},Ba.prototype.Ab=function(t,e){return Qs(this,Us,{idToken:t,email:e})},Ba.prototype.Bb=function(t,e){return Qs(this,Vs,{idToken:t,password:e})};var ls={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function fs(t){if(!t.phoneVerificationInfo)throw new E("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new E("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new E("missing-verification-code")}function ds(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new E("internal-error")}function ps(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&Yn(t=new Bn(t.postBody),"nonce")&&(e.nonce=t.get("nonce"))),e}function vs(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=Ho(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=Ho(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=Ho(t)):t.errorMessage&&(e=tu(t.errorMessage)),e)throw e;cs(t)}function ms(t,e){return e.returnIdpCredential=!0,Qs(t,Hs,e)}function gs(t,e){return e.returnIdpCredential=!0,Qs(t,Bs,e)}function bs(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Qs(t,Gs,e)}function ys(t){if(!t.oobCode)throw new E("invalid-action-code")}(t=Ba.prototype).Cb=function(t,e){var n={idToken:t},i=[];return ht(ls,function(t,r){var o=e[r];null===o?i.push(t):r in e&&(n[r]=o)}),i.length&&(n.deleteAttribute=i),Qs(this,Us,n)},t.ub=function(t,e){return pt(t={requestType:"PASSWORD_RESET",email:t},e),Qs(this,Ls,t)},t.vb=function(t,e){return pt(t={requestType:"EMAIL_SIGNIN",email:t},e),Qs(this,Rs,t)},t.tb=function(t,e){return pt(t={requestType:"VERIFY_EMAIL",idToken:t},e),Qs(this,Ps,t)},t.Db=function(t,e,n){return pt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),Qs(this,Ds,t)},t.eb=function(t){return Qs(this,Js,t)},t.mb=function(t,e){return Qs(this,Fs,{oobCode:t,newPassword:e})},t.Qa=function(t){return Qs(this,Is,{oobCode:t})},t.ib=function(t){return Qs(this,ws,{oobCode:t})};var ws={endpoint:"setAccountInfo",B:ys,Z:"email",C:!0},Is={endpoint:"resetPassword",B:ys,F:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new E("internal-error")},C:!0},Ts={endpoint:"signupNewUser",B:function(t){if(ss(t),!t.password)throw new E("weak-password")},F:cs,U:!0,C:!0},Es={endpoint:"createAuthUri",C:!0},ks={endpoint:"deleteAccount",M:["idToken"]},As={endpoint:"setAccountInfo",M:["idToken","deleteProvider"],B:function(t){if("array"!=h(t.deleteProvider))throw new E("internal-error")}},Ss={endpoint:"emailLinkSignin",M:["email","oobCode"],B:ss,F:cs,U:!0,C:!0},Ns={endpoint:"emailLinkSignin",M:["idToken","email","oobCode"],B:ss,F:cs,U:!0},_s={endpoint:"accounts/mfaEnrollment:finalize",M:["idToken","phoneVerificationInfo"],B:fs,F:cs,C:!0,Na:!0},Os={endpoint:"accounts/mfaSignIn:finalize",M:["mfaPendingCredential","phoneVerificationInfo"],B:fs,F:cs,C:!0,Na:!0},Cs={endpoint:"getAccountInfo"},Rs={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new E("internal-error");ss(t)},Z:"email",C:!0},Ps={endpoint:"getOobConfirmationCode",M:["idToken","requestType"],B:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new E("internal-error")},Z:"email",C:!0},Ds={endpoint:"getOobConfirmationCode",M:["idToken","newEmail","requestType"],B:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new E("internal-error")},Z:"email",C:!0},Ls={endpoint:"getOobConfirmationCode",M:["requestType"],B:function(t){if("PASSWORD_RESET"!=t.requestType)throw new E("internal-error");ss(t)},Z:"email",C:!0},xs={kb:!0,endpoint:"getProjectConfig",Tb:"GET"},Ms={kb:!0,endpoint:"getRecaptchaParam",Tb:"GET",F:function(t){if(!t.recaptchaSiteKey)throw new E("internal-error")}},Fs={endpoint:"resetPassword",B:ys,Z:"email",C:!0},js={endpoint:"sendVerificationCode",M:["phoneNumber","recaptchaToken"],Z:"sessionInfo",C:!0},Us={endpoint:"setAccountInfo",M:["idToken"],B:us,U:!0},Vs={endpoint:"setAccountInfo",M:["idToken"],B:function(t){if(us(t),!t.password)throw new E("weak-password")},F:cs,U:!0},$s={endpoint:"signupNewUser",F:cs,U:!0,C:!0},Ks={endpoint:"accounts/mfaEnrollment:start",M:["idToken","phoneEnrollmentInfo"],B:function(t){if(!t.phoneEnrollmentInfo)throw new E("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new E("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new E("missing-app-credential")},F:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new E("internal-error")},C:!0,Na:!0},qs={endpoint:"accounts/mfaSignIn:start",M:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],B:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new E("missing-app-credential")},F:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new E("internal-error")},C:!0,Na:!0},Hs={endpoint:"verifyAssertion",B:ds,Xa:ps,F:vs,U:!0,C:!0},Gs={endpoint:"verifyAssertion",B:ds,Xa:ps,F:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new E("user-not-found");if(t.errorMessage)throw tu(t.errorMessage);cs(t)},U:!0,C:!0},Bs={endpoint:"verifyAssertion",B:function(t){if(ds(t),!t.idToken)throw new E("internal-error")},Xa:ps,F:vs,U:!0},Ws={endpoint:"verifyCustomToken",B:function(t){if(!t.token)throw new E("invalid-custom-token")},F:cs,U:!0,C:!0},Xs={endpoint:"verifyPassword",B:function(t){if(ss(t),!t.password)throw new E("wrong-password")},F:cs,U:!0,C:!0},Js={endpoint:"verifyPhoneNumber",B:hs,F:cs,C:!0},Ys={endpoint:"verifyPhoneNumber",B:function(t){if(!t.idToken)throw new E("internal-error");hs(t)},F:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",Ho(t);cs(t)}},zs={Gb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",B:hs,F:cs,C:!0},Zs={endpoint:"accounts/mfaEnrollment:withdraw",M:["idToken","mfaEnrollmentId"],F:function(t){if(!!t[Xa]^!!t.refreshToken)throw new E("internal-error")},C:!0,Na:!0};function Qs(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var i=t[e[n]];if(null==i||""===i)return!1}return!0}(n,e.M))return Se(new E("internal-error"));var i,r=!!e.Na,o=e.Tb||"POST";return Ae(n).then(e.B).then(function(){return e.U&&(n.returnSecureToken=!0),e.C&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),as(t,r?t.i:t.h,e.endpoint,o,n,e.Gb,e.kb||!1)}).then(function(t){return i=t,e.Xa?e.Xa(n,i):i}).then(e.F).then(function(){if(!e.Z)return i;if(!(e.Z in i))throw new E("internal-error");return i[e.Z]})}function tu(t){return eu({error:{errors:[{message:t}],code:400,message:t}})}function eu(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",i={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=i[n]?new E(i[n]):null)return n;for(var r in n=t.error&&t.error.message||"",pt(i={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,i)if(0===n.indexOf(r))return new E(i[r],e);return!e&&t&&(e=Ri(t)),new E("internal-error",e)}function nu(t){this.b=t,this.a=null,this.qb=function(t){return(au||(au=new be(function(t,e){function n(){Mi(),Ai("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Mi(),e(Error("Network Error"))},timeout:ru.get()})}if(Ai("gapi.iframes.Iframe"))t();else if(Ai("gapi.load"))n();else{var i="__iframefcb"+Math.floor(1e6*Math.random()).toString();a[i]=function(){Ai("gapi.load")?n():e(Error("Network Error"))},Ae(Ua(i=Et(iu,{onload:i}))).s(function(){e(Error("Network Error"))})}}).s(function(t){throw au=null,t}))).then(function(){return new be(function(e,n){Ai("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Ai("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(i){function r(){clearTimeout(o),e()}t.a=i,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},ou.get());i.ping(r).then(r,function(){n(Error("Network Error"))})})})})}(this)}var iu=new mt(yt,"https://apis.google.com/js/api.js?onload=%{onload}"),ru=new Fi(3e4,6e4),ou=new Fi(5e3,15e3),au=null;function su(t,e,n,i){this.l=t,this.h=e,this.i=n,this.g=i,this.f=null,this.g?t=Fn((t=Mn(this.g.url)).f,t.a,t.g,"/emulator/auth/iframe"):t=Fn("https",this.l,null,"/__/auth/iframe"),this.a=t,Ln(this.a,"apiKey",this.h),Ln(this.a,"appName",this.i),this.b=null,this.c=[]}function uu(t,e,n,i,r,o){this.u=t,this.o=e,this.c=n,this.v=i,this.m=o,this.i=this.g=this.l=null,this.a=r,this.h=this.f=null}function cu(t){try{return gb.app(t).auth().Ga()}catch(e){return[]}}function hu(t,e,n,i,r,o){this.o=t,this.g=e,this.b=n,this.f=o,this.c=i||null,this.i=r||null,this.l=this.u=this.A=null,this.h=[],this.v=this.a=null}function lu(t){var e=ai();return function(t){return Qs(t,xs,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var n=Mn(e),i=n.f;n=n.a;for(var r=0;r<t.length;r++){var o=t[r],a=n,s=i;if(0==o.indexOf("chrome-extension://")?a=Mn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:li.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Ko(ai())})}function fu(t){return t.v?t.v:(t.v=di().then(function(){if(!t.u){var e=t.c,n=t.i,i=cu(t.b),r=new su(t.o,t.g,t.b,t.f);r.f=e,r.b=n,r.c=J(i||[]),t.u=r.toString()}t.m=new nu(t.u),function(t){if(!t.m)throw Error("IfcHandler must be initialized!");!function(t,e){t.qb.then(function(){t.a.register("authEvent",e,Ai("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(t.m,function(e){var n={};if(e&&e.authEvent){var i=!1;for(e=jo(e.authEvent),n=0;n<t.h.length;n++)i=t.h[n](e)||i;return(n={}).status=i?"ACK":"ERROR",Ae(n)}return n.status="ERROR",Ae(n)})}(t)}),t.v)}function du(t){return t.l||(t.A=t.c?Ei(t.c,cu(t.b)):null,t.l=new Ba(t.g,O(t.i),t.A),t.f&&ts(t.l,t.f)),t.l}function pu(t,e,n,i,r,o,a,s,u,c,h,l){return(t=new uu(t,e,n,i,r,l)).l=o,t.g=a,t.i=s,t.b=ft(u||null),t.f=c,t.xb(h).toString()}function vu(t){if(this.a=t||gb.INTERNAL.reactNative&&gb.INTERNAL.reactNative.AsyncStorage,!this.a)throw new E("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function mu(t){this.b=t,this.a={},this.f=y(this.c,this)}su.prototype.toString=function(){return this.f?Ln(this.a,"v",this.f):Jn(this.a.b,"v"),this.b?Ln(this.a,"eid",this.b):Jn(this.a.b,"eid"),this.c.length?Ln(this.a,"fw",this.c.join(",")):Jn(this.a.b,"fw"),this.a.toString()},uu.prototype.xb=function(t){return this.h=t,this},uu.prototype.toString=function(){if(this.m){var t=Mn(this.m.url);t=Fn(t.f,t.a,t.g,"/emulator/auth/handler")}else t=Fn("https",this.u,null,"/__/auth/handler");if(Ln(t,"apiKey",this.o),Ln(t,"appName",this.c),Ln(t,"authType",this.v),this.a.isOAuthProvider){var e=this.a;try{var n=gb.app(this.c).auth().ka()}catch(s){n=null}for(var i in e.nb=n,Ln(t,"providerId",this.a.providerId),e=Pi((n=this.a).Hb))e[i]=e[i].toString();i=n.Pc,e=ft(e);for(var r=0;r<i.length;r++){var o=i[r];o in e&&delete e[o]}n.ob&&n.nb&&!e[n.ob]&&(e[n.ob]=n.nb),lt(e)||Ln(t,"customParameters",Ri(e))}if("function"==typeof this.a.Pb&&(n=this.a.Pb()).length&&Ln(t,"scopes",n.join(",")),this.l?Ln(t,"redirectUrl",this.l):Jn(t.b,"redirectUrl"),this.g?Ln(t,"eventId",this.g):Jn(t.b,"eventId"),this.i?Ln(t,"v",this.i):Jn(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!xn(t,a)&&Ln(t,a,this.b[a]);return this.h?Ln(t,"tid",this.h):Jn(t.b,"tid"),this.f?Ln(t,"eid",this.f):Jn(t.b,"eid"),(a=cu(this.c)).length&&Ln(t,"fw",a.join(",")),t.toString()},(t=hu.prototype).Nb=function(t,e,n){var i=new E("popup-closed-by-user"),r=new E("web-storage-unsupported"),o=this,a=!1;return this.la().then(function(){(function(t){var e={type:"webStorageSupport"};return fu(t).then(function(){return function(t,e){return t.qb.then(function(){return new be(function(n){t.a.send(e.type,e,n,Ai("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.m,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(n){n||(t&&ci(t),e(r),a=!0)})}).s(function(){}).then(function(){if(!a)return function(t){return new be(function(e){return function n(){En(2e3).then(function(){if(t&&!t.closed)return n();e()})}()})}(t)}).then(function(){if(!a)return En(n).then(function(){e(i)})})},t.Wb=function(){var t=ki();return!Ci(t)&&!xi(t)},t.Sb=function(){return!1},t.Lb=function(t,e,n,i,r,o,a,s){if(!t)return Se(new E("popup-blocked"));if(a&&!Ci())return this.la().s(function(e){ci(t),r(e)}),i(),Ae();this.a||(this.a=lu(du(this)));var u=this;return this.a.then(function(){var e=u.la().s(function(e){throw ci(t),r(e),e});return i(),e}).then(function(){(Mo(n),a)||si(pu(u.o,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)}).s(function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t})},t.Mb=function(t,e,n,i){this.a||(this.a=lu(du(this)));var r=this;return this.a.then(function(){Mo(e),si(pu(r.o,r.g,r.b,t,e,ai(),n,r.c,void 0,r.i,i,r.f))}).s(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},t.la=function(){var t=this;return fu(this).then(function(){return t.m.qb}).s(function(){throw t.a=null,new E("network-request-failed")})},t.Zb=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Ra=function(t){W(this.h,function(e){return e==t})},(t=vu.prototype).get=function(t){return Ae(this.a.getItem(t)).then(function(t){return t&&Di(t)})},t.set=function(t,e){return Ae(this.a.setItem(t,Ri(e)))},t.T=function(t){return Ae(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var gu,bu=[];function yu(t,e,n){lt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function wu(t){this.a=t}function Iu(t){this.c=t,this.b=!1,this.a=[]}function Tu(t,e,n,i){var r,o,a,s,u=n||{},c=null;if(t.b)return Se(Error("connection_unavailable"));var h=i?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new be(function(n,i){l?(r=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),a=setTimeout(function(){i(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===r&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout(function(){i(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):i(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),i(Error("invalid_response"))))}},t.a.push(c),l.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:r,data:u},[l.port2])):i(Error("connection_unavailable"))}).then(function(e){return Eu(t,c),e}).s(function(e){throw Eu(t,c),e})}function Eu(t,e){if(e){var n=e.messageChannel,i=e.onMessage;n&&(n.port1.removeEventListener("message",i),n.port1.close()),W(t.a,function(t){return t==e})}}function ku(){if(!Nu())throw new E("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=a.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var t=this;mi()&&self?(this.l=function(){var t=mi()?self:null;if($(bu,function(n){n.b==t&&(e=n)}),!e){var e=new mu(t);bu.push(e)}return e}(),yu(this.l,"keyChanged",function(e,n){return Pu(t).then(function(e){return 0<e.length&&$(t.a,function(t){t(e)}),{keyProcessed:G(e,n.key)}})}),yu(this.l,"ping",function(){return Ae(["keyChanged"])})):function(){var t=a.navigator;return t&&t.serviceWorker?Ae().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):Ae(null)}().then(function(e){(t.h=e)&&(t.g=new Iu(new wu(e)),Tu(t.g,"ping",null,!0).then(function(e){e[0].fulfilled&&G(e[0].value,"keyChanged")&&(t.o=!0)}).s(function(){}))})}function Au(t){return new be(function(e,n){var i=t.m.open("firebaseLocalStorageDb",1);i.onerror=function(t){try{t.preventDefault()}catch(e){}n(Error(t.target.error))},i.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(e){n(e)}},i.onsuccess=function(i){(i=i.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(i):function(t){return new be(function(e,n){var i=t.m.deleteDatabase("firebaseLocalStorageDb");i.onsuccess=function(){e()},i.onerror=function(t){n(Error(t.target.error))}})}(t).then(function(){return Au(t)}).then(function(t){e(t)}).s(function(t){n(t)})}})}function Su(t){return t.v||(t.v=Au(t)),t.v}function Nu(){try{return!!a.indexedDB}catch(qt){return!1}}function _u(t){return t.objectStore("firebaseLocalStorage")}function Ou(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function Cu(t){return new be(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function Ru(t,e){return t.g&&t.h&&function(){var t=a.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Tu(t.g,"keyChanged",{key:e},t.o).then(function(){}).s(function(){}):Ae()}function Pu(t){return Su(t).then(function(t){var e=_u(Ou(t,!1));return e.getAll?Cu(e.getAll()):new be(function(t,n){var i=[],r=e.openCursor();r.onsuccess=function(e){(e=e.target.result)?(i.push(e.value),e.continue()):t(i)},r.onerror=function(t){n(t.target.error)}})}).then(function(e){var n={},i=[];if(0==t.b){for(i=0;i<e.length;i++)n[e[i].fbase_key]=e[i].value;i=function t(e,n){var i,r=[];for(i in e)i in n?typeof e[i]!=typeof n[i]?r.push(i):"object"==typeof e[i]&&null!=e[i]&&null!=n[i]?0<t(e[i],n[i]).length&&r.push(i):e[i]!==n[i]&&r.push(i):r.push(i);for(i in n)i in e||r.push(i);return r}(t.c,n),t.c=n}return i})}function Du(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Lu(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Ae().then(function(){if(Nu()){var t=Li(),i="__sak"+t;return gu||(gu=new ku),(n=gu).set(i,t).then(function(){return n.get(i)}).then(function(e){if(e!==t)throw Error("indexedDB not supported!");return n.T(i)}).then(function(){return n}).s(function(){return e.c})}return e.c}).then(function(t){return e.type=t.type,t.ca(function(t){$(e.a,function(e){e(t)})}),t})}function xu(){this.a={},this.type="inMemory"}function Mu(){if(!function(){var t="Node"==gi();if(!(t=Fu()||t&&gb.INTERNAL.node&&gb.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==gi())throw new E("internal-error","The LocalStorage compatibility library was not found.");throw new E("web-storage-unsupported")}this.a=Fu()||gb.INTERNAL.node.localStorage,this.type="localStorage"}function Fu(){try{var t=a.localStorage,e=Li();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function ju(){this.type="nullStorage"}function Uu(){if(!function(){var t="Node"==gi();if(!(t=Vu()||t&&gb.INTERNAL.node&&gb.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(e){return!1}}()){if("Node"==gi())throw new E("internal-error","The SessionStorage compatibility library was not found.");throw new E("web-storage-unsupported")}this.a=Vu()||gb.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Vu(){try{var t=a.sessionStorage,e=Li();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(n){return null}}function $u(){var t={};t.Browser=Hu,t.Node=Gu,t.ReactNative=Bu,t.Worker=Wu,this.a=t[gi()]}mu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,i=this.a[e];if(i&&0<i.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var r=[];$(i,function(e){r.push(Ae().then(function(){return e(t.origin,t.data.data)}))}),_e(r).then(function(i){var r=[];$(i,function(t){r.push({fulfilled:t.Ob,value:t.value,reason:t.reason?t.reason.message:void 0})}),$(r,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:r})})}},wu.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Iu.prototype.close=function(){for(;0<this.a.length;)Eu(this,this.a[0]);this.b=!0},(t=ku.prototype).set=function(t,e){var n,i=!1,r=this;return Su(this).then(function(e){return Cu((e=_u(Ou(n=e,!0))).get(t))}).then(function(o){var a=_u(Ou(n,!0));return o?(o.value=e,Cu(a.put(o))):(r.b++,i=!0,(o={}).fbase_key=t,o.value=e,Cu(a.add(o)))}).then(function(){return r.c[t]=e,Ru(r,t)}).na(function(){i&&r.b--})},t.get=function(t){return Su(this).then(function(e){return Cu(_u(Ou(e,!1)).get(t))}).then(function(t){return t&&t.value})},t.T=function(t){var e=!1,n=this;return Su(this).then(function(i){return e=!0,n.b++,Cu(_u(Ou(i,!0)).delete(t))}).then(function(){return delete n.c[t],Ru(n,t)}).na(function(){e&&n.b--})},t.ca=function(t){0==this.a.length&&function(t){Du(t),function e(){t.f=setTimeout(function(){t.i=Pu(t).then(function(e){0<e.length&&$(t.a,function(t){t(e)})}).then(function(){e()}).s(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()}(this),this.a.push(t)},t.ia=function(t){W(this.a,function(e){return e==t}),0==this.a.length&&Du(this)},(t=Lu.prototype).get=function(t){return this.b.then(function(e){return e.get(t)})},t.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},t.T=function(t){return this.b.then(function(e){return e.T(t)})},t.ca=function(t){this.a.push(t)},t.ia=function(t){W(this.a,function(e){return e==t})},(t=xu.prototype).get=function(t){return Ae(this.a[t])},t.set=function(t,e){return this.a[t]=e,Ae()},t.T=function(t){return delete this.a[t],Ae()},t.ca=function(){},t.ia=function(){},(t=Mu.prototype).get=function(t){var e=this;return Ae().then(function(){return Di(e.a.getItem(t))})},t.set=function(t,e){var n=this;return Ae().then(function(){var i=Ri(e);null===i?n.T(t):n.a.setItem(t,i)})},t.T=function(t){var e=this;return Ae().then(function(){e.a.removeItem(t)})},t.ca=function(t){a.window&&an(a.window,"storage",t)},t.ia=function(t){a.window&&cn(a.window,"storage",t)},(t=ju.prototype).get=function(){return Ae(null)},t.set=function(){return Ae()},t.T=function(){return Ae()},t.ca=function(){},t.ia=function(){},(t=Uu.prototype).get=function(t){var e=this;return Ae().then(function(){return Di(e.a.getItem(t))})},t.set=function(t,e){var n=this;return Ae().then(function(){var i=Ri(e);null===i?n.T(t):n.a.setItem(t,i)})},t.T=function(t){var e=this;return Ae().then(function(){e.a.removeItem(t)})},t.ca=function(){},t.ia=function(){};var Ku,qu,Hu={D:Mu,ab:Uu},Gu={D:Mu,ab:Uu},Bu={D:vu,ab:ju},Wu={D:Mu,ab:ju},Xu={qd:"local",NONE:"none",sd:"session"};function Ju(){var t=!(xi(ki())||!vi()),e=Ci(),n=Si();this.v=t,this.h=e,this.l=n,this.a={},Ku||(Ku=new $u),t=Ku;try{this.g=!oi()&&$i()||!a.indexedDB?new t.a.D:new Lu(mi()?new xu:new t.a.D)}catch(i){this.g=new xu,this.h=!0}try{this.i=new t.a.ab}catch(i){this.i=new xu}this.m=new xu,this.f=y(this.Xb,this),this.b={}}function Yu(){return qu||(qu=new Ju),qu}function zu(t,e){switch(e){case"session":return t.i;case"none":return t.m;default:return t.g;}}function Zu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Qu(t,e,n){return n=Zu(e,n),"local"==e.D&&(t.b[n]=null),zu(t,e.D).T(n)}function tc(t){t.c&&(clearInterval(t.c),t.c=null)}function ec(t){this.a=t,this.b=Yu()}(t=Ju.prototype).get=function(t,e){return zu(this,t.D).get(Zu(t,e))},t.set=function(t,e,n){var i=Zu(t,n),r=this,o=zu(this,t.D);return o.set(i,e).then(function(){return o.get(i)}).then(function(e){"local"==t.D&&(r.b[i]=e)})},t.addListener=function(t,e,n){t=Zu(t,e),this.l&&(this.b[t]=a.localStorage.getItem(t)),lt(this.a)&&(zu(this,"local").ca(this.f),this.h||(oi()||!$i())&&a.indexedDB||!this.l||function(t){tc(t),t.c=setInterval(function(){for(var e in t.a){var n=a.localStorage.getItem(e),i=t.b[e];n!=i&&(t.b[e]=n,n=new Xe({type:"storage",key:e,target:window,oldValue:i,newValue:n,a:!0}),t.Xb(n))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=Zu(t,e),this.a[t]&&(W(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),lt(this.a)&&(zu(this,"local").ia(this.f),tc(this))},t.Xb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var i=this.b[n];void 0===i&&(i=null);var r=a.localStorage.getItem(n);r!==i&&(this.b[n]=r,this.lb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?zu(this,"local").ia(this.f):tc(this),this.v)if(n=a.localStorage.getItem(e),(i=t.a.newValue)!==n)null!==i?a.localStorage.setItem(e,i):a.localStorage.removeItem(e);else if(this.b[e]===i&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===a.localStorage.getItem(e)||(o.b[e]=a.localStorage.getItem(e),o.lb(e))},Gt&&te&&10==te&&a.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else $(t,y(this.lb,this))},t.lb=function(t){this.a[t]&&$(this.a[t],function(t){t()})};var nc,ic={name:"authEvent",D:"local"};function rc(){this.a=Yu()}function oc(t,e){this.b=ac,this.f=a.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=a.Int32Array?new Int32Array(64):Array(64),void 0===nc&&(nc=a.Int32Array?new Int32Array(dc):dc),this.reset()}T(oc,function(){this.b=-1});for(var ac=64,sc=ac-1,uc=[],cc=0;cc<sc;cc++)uc[cc]=0;var hc=X(128,uc);function lc(t){for(var e=t.f,n=t.l,i=0,r=0;r<e.length;)n[i++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*i;for(e=16;64>e;e++){r=0|n[e-15],i=0|n[e-2];var o=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,a=(0|n[e-7])+((i>>>17|i<<15)^(i>>>19|i<<13)^i>>>10)|0;n[e]=o+a|0}i=0|t.a[0],r=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&r^i&s^r&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&h^~c&l)+(0|nc[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+a|0,u=s,s=r,r=i,i=a+f|0}t.a[0]=t.a[0]+i|0,t.a[1]=t.a[1]+r|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function fc(t,e,n){void 0===n&&(n=e.length);var i=0,r=t.c;if("string"==typeof e)for(;i<n;)t.f[r++]=e.charCodeAt(i++),r==t.b&&(lc(t),r=0);else{if(!l(e))throw Error("message must be string or array");for(;i<n;){var o=e[i++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[r++]=o,r==t.b&&(lc(t),r=0)}}t.c=r,t.g+=n}oc.prototype.reset=function(){this.g=this.c=0,this.a=a.Int32Array?new Int32Array(this.h):J(this.h)};var dc=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function pc(){oc.call(this,8,vc)}T(pc,oc);var vc=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function mc(t,e,n,i,r,o){this.m=t,this.i=e,this.l=n,this.v=i||null,this.u=r||null,this.o=o,this.h=e+":"+n,this.A=new rc,this.g=new ec(this.h),this.f=null,this.b=[],this.a=this.c=null}function gc(t){return new E("invalid-cordova-configuration",t)}function bc(t){var e=new pc;fc(e,t),t=[];var n=8*e.g;56>e.c?fc(e,hc,56-e.c):fc(e,hc,e.b-(e.c-56));for(var i=63;56<=i;i--)e.f[i]=255&n,n/=256;for(lc(e),i=n=0;i<e.i;i++)for(var r=24;0<=r;r-=8)t[n++]=e.a[i]>>r&255;return function(t){return q(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function yc(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(i){}}function wc(t){return t.f||(t.f=t.la().then(function(){return new be(function(e){t.Ea(function n(i){return e(i),t.Ra(n),!1}),function(t){function e(e){i=!0,r&&r.cancel(),Ic(t).then(function(i){var r=n;if(i&&e&&e.url){var o=null;-1!=(r=eo(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Di(xn(o=Mn(r),"firebaseError")||null))?k(o):null)?new Fo(i.c,i.b,null,null,o,null,i.S()):new Fo(i.c,i.b,r,i.f,null,null,i.S())),r=o||n}yc(t,r)})}var n=new Fo("unknown",null,null,null,new E("no-auth-event")),i=!1,r=En(500).then(function(){return Ic(t).then(function(){i||yc(t,n)})}),o=a.handleOpenURL;a.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Ai("BuildInfo.packageName",a).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(n){console.error(n)}},$o||($o=new Uo),function(t){var e=$o;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Ai("universalLinks.subscribe",a))&&t(null,e.b))}(e)}(t)})})),t.f}function Ic(t){var e=null;return function(t){return t.b.get(ic,t.a).then(function(t){return jo(t)})}(t.g).then(function(n){return e=n,Qu((n=t.g).b,ic,n.a)}).then(function(){return e})}function Tc(t){this.a=t,this.b=Yu()}(t=mc.prototype).la=function(){return this.Ia?this.Ia:this.Ia=(pi(void 0)?di().then(function(){return new be(function(t,e){var n=a.document,i=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(i),t()},!1)})}):Se(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof Ai("universalLinks.subscribe",a))throw gc("cordova-universal-links-plugin-fix is not installed");if(void 0===Ai("BuildInfo.packageName",a))throw gc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Ai("cordova.plugins.browsertab.openUrl",a))throw gc("cordova-plugin-browsertab is not installed");if("function"!=typeof Ai("cordova.InAppBrowser.open",a))throw gc("cordova-plugin-inappbrowser is not installed")},function(){throw new E("cordova-not-ready")})},t.Nb=function(t,e){return e(new E("operation-not-supported-in-this-environment")),Ae()},t.Lb=function(){return Se(new E("operation-not-supported-in-this-environment"))},t.Zb=function(){return!1},t.Wb=function(){return!0},t.Sb=function(){return!0},t.Mb=function(t,e,n,i){if(this.c)return Se(new E("redirect-operation-pending"));var r=this,o=a.document,s=null,u=null,c=null,h=null;return this.c=Ae().then(function(){return Mo(e),wc(r)}).then(function(){return function(t,e,n,i,r){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new Fo(e,i,null,o,new E("no-auth-event"),null,r),u=Ai("BuildInfo.packageName",a);if("string"!=typeof u)throw new E("invalid-cordova-configuration");var c=Ai("BuildInfo.displayName",a),h={};if(ki().toLowerCase().match(/iphone|ipad|ipod/))h.ibi=u;else{if(!ki().toLowerCase().match(/android/))return Se(new E("operation-not-supported-in-this-environment"));h.apn=u}c&&(h.appDisplayName=c),o=bc(o),h.sessionId=o;var l=pu(t.m,t.i,t.l,e,n,null,i,t.v,h,t.u,r,t.o);return t.la().then(function(){var e=t.h;return t.A.a.set(ic,s.w(),e)}).then(function(){var e=Ai("cordova.plugins.browsertab.isAvailable",a);if("function"!=typeof e)throw new E("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=Ai("cordova.plugins.browsertab.openUrl",a)))throw new E("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=Ai("cordova.InAppBrowser.open",a)))throw new E("invalid-cordova-configuration");e=ki(),t.a=n(l,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(r,t,e,n,i)}).then(function(){return new be(function(t,e){u=function(){var e=Ai("cordova.plugins.browsertab.close",a);return t(),"function"==typeof e&&e(),r.a&&"function"==typeof r.a.close&&(r.a.close(),r.a=null),!1},r.Ea(u),c=function(){s||(s=En(2e3).then(function(){e(new E("redirect-cancelled-by-user"))}))},h=function(){ji()&&c()},o.addEventListener("resume",c,!1),ki().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",h,!1)}).s(function(t){return Ic(r).then(function(){throw t})})}).na(function(){c&&o.removeEventListener("resume",c,!1),h&&o.removeEventListener("visibilitychange",h,!1),s&&s.cancel(),u&&r.Ra(u),r.c=null})},t.Ea=function(t){this.b.push(t),wc(this).s(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Fo("unknown",null,null,null,new E("no-auth-event")),t(e))})},t.Ra=function(t){W(this.b,function(e){return e==t})};var Ec={name:"pendingRedirect",D:"session"};function kc(t){return Qu(t.b,Ec,t.a)}function Ac(t,e,n,i){this.i={},this.u=0,this.O=t,this.m=e,this.v=n,this.G=i,this.h=[],this.f=!1,this.l=y(this.o,this),this.b=new Vc,this.A=new Gc,this.g=new Tc(jc(this.m,this.v)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.A,this.c.linkViaPopup=this.A,this.c.reauthViaPopup=this.A,this.a=Sc(this.O,this.m,this.v,A,this.G)}function Sc(t,e,n,i,r){var o=gb.SDK_VERSION||null;return pi()?new mc(t,e,n,o,i,r):new hu(t,e,n,o,i,r)}function Nc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.la().s(function(n){throw t.a==e&&t.reset(),n})}function _c(t){t.a.Wb()&&Nc(t).s(function(e){var n=new Fo("unknown",null,null,null,new E("operation-not-supported-in-this-environment"));Lc(e)&&t.o(n)}),t.a.Sb()||$c(t.b)}function Oc(t,e){G(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(Ec,t.a).then(function(t){return"pending"==t})}(t.g).then(function(e){e?kc(t.g).then(function(){Nc(t).s(function(e){var n=new Fo("unknown",null,null,null,new E("operation-not-supported-in-this-environment"));Lc(e)&&t.o(n)})}):_c(t)}).s(function(){_c(t)})}function Cc(t,e){W(t.h,function(t){return t==e})}Ac.prototype.reset=function(){this.f=!1,this.a.Ra(this.l),this.a=Sc(this.O,this.m,this.v,null,this.G),this.i={}},Ac.prototype.o=function(t){if(!t)throw new E("invalid-auth-event");if(6e5<=I()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var i=this.h[n];if(i.Eb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,i),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=I())),e=!0;break}}return $c(this.b),e};var Rc=new Fi(2e3,1e4),Pc=new Fi(3e4,6e4);function Dc(t,e,n,i,r,o,a){return t.a.Lb(e,n,i,function(){t.f||(t.f=!0,t.a.Ea(t.l))},function(){t.reset()},r,o,a)}function Lc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function xc(t,e,n,i,r){var o;return function(t){return t.b.set(Ec,"pending",t.a)}(t.g).then(function(){return t.a.Mb(e,n,i,r).s(function(e){if(Lc(e))throw new E("operation-not-supported-in-this-environment");return o=e,kc(t.g).then(function(){throw o})}).then(function(){return t.a.Zb()?new be(function(){}):kc(t.g).then(function(){return t.qa()}).then(function(){}).s(function(){})})})}function Mc(t,e,n,i,r){return t.a.Nb(i,function(t){e.ma(n,null,t,r)},Rc.get())}Ac.prototype.qa=function(){return this.b.qa()};var Fc={};function jc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Uc(t,e,n,i){var r=jc(e,n,i);return Fc[r]||(Fc[r]=new Ac(t,e,n,i)),Fc[r]}function Vc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function $c(t){t.g||(t.g=!0,Hc(t,!1,null,null))}function Kc(t){t.g&&!t.i&&Hc(t,!1,null,null)}function qc(t,e){if(t.b=function(){return Ae(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Hc(t,e,n,i){e?i?function(t,e){if(t.b=function(){return Se(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,i):qc(t,n):qc(t,{user:null}),t.f=[],t.c=[]}function Gc(){}function Bc(){this.hb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.hb},set:function(t){this.hb=t},enumerable:!1})}function Wc(t,e){this.a=e,Bi(this,"verificationId",t)}function Xc(t,e,n,i){return new Do(t).eb(e,n).then(function(t){return new Wc(t,i)})}function Jc(t){var e=$r(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new E("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Wi(this,{token:t,expirationTime:Vi(1e3*e.exp),authTime:Vi(1e3*e.auth_time),issuedAtTime:Vi(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function Yc(t,e,n){var i=e&&e[Zc];if(!i)throw new E("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=ft(e),this.g=n,this.c=new no(null,i),this.b=[];var r=this;$(e[zc]||[],function(t){(t=zi(t))&&r.b.push(t)}),Bi(this,"auth",this.a),Bi(this,"session",this.c),Bi(this,"hints",this.b)}Vc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Vc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,i=t.b,r=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!r&&!o),"unknown"!=n||r||o?t.a?(Hc(this,!0,null,t.a),Ae()):e.Fa(n,i)?function(t,e,n){n=n.Fa(e.c,e.b);var i=e.g,r=e.f,o=e.i,a=e.S(),s=!!e.c.match(/Redirect$/);n(i,r,a,o).then(function(e){Hc(t,s,e,null)}).s(function(e){Hc(t,s,null,e)})}(this,t,e):Se(new E("invalid-auth-event")):(Hc(this,!1,null,null),Ae())}else Se(new E("invalid-auth-event"))},Vc.prototype.qa=function(){var t=this;return new be(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new E("timeout");t.a&&t.a.cancel(),t.a=En(Pc.get()).then(function(){t.b||(t.g=!0,Hc(t,!0,null,e))})}(t))})},Gc.prototype.h=function(t,e){if(t){var n=t.c,i=t.b;t.a?(e.ma(t.c,null,t.a,t.b),Ae()):e.Fa(n,i)?function(t,e){var n=t.b,i=t.c;e.Fa(i,n)(t.g,t.f,t.S(),t.i).then(function(t){e.ma(i,t,null,n)}).s(function(t){e.ma(i,null,t,n)})}(t,e):Se(new E("invalid-auth-event"))}else Se(new E("invalid-auth-event"))},Wc.prototype.confirm=function(t){return t=Lo(this.verificationId,t),this.a(t)};var zc="mfaInfo",Zc="mfaPendingCredential";function Qc(t,e,n,i){E.call(this,"multi-factor-auth-required",i,e),this.b=new Yc(t,e,n),Bi(this,"resolver",this.b)}function th(t,e,n){if(t&&d(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new Qc(e,t.serverResponse,n,t.message)}catch(i){}return null}function eh(){}function nh(t){Bi(this,"factorId",t.fa),this.a=t}function ih(t){if(nh.call(this,t),this.a.fa!=Do.PROVIDER_ID)throw new E("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function rh(t,e){for(var n in We.call(this,t),e)this[n]=e[n]}function oh(t,e){this.a=t,this.b=[],this.c=y(this.xc,this),an(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&$(e.multiFactor.enrolledFactors,function(t){var e=null,i={};if(t){t.uid&&(i[tr]=t.uid),t.displayName&&(i[Zi]=t.displayName),t.enrollmentTime&&(i[Qi]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(i[er]=t.phoneNumber);try{e=new nr(i)}catch(r){}t=e}else t=null;t&&n.push(t)}),ah(this,n)}function ah(t,e){t.b=e,Bi(t,"enrolledFactors",e)}function sh(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function uh(t){this.c=t,this.b=this.a=null}function ch(t){return t.b&&1e3*t.b.c||0}function hh(t,e){var n=e.refreshToken;t.b=Vr(e[Xa]||""),t.a=n}function lh(t,e){return function(t,e){return new be(function(n,i){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?is(t,t.l+"?key="+encodeURIComponent(t.c),function(t){t?t.error?i(eu(t)):t.access_token&&t.refresh_token?n(t):i(new E("internal-error")):i(new E("network-request-failed"))},"POST",Xn(e).toString(),t.g,t.v.get()):i(new E("internal-error"))})}(t.c,e).then(function(e){return t.b=Vr(e.access_token),t.a=e.refresh_token,{accessToken:t.b.toString(),refreshToken:t.a}}).s(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function fh(t,e){this.a=t||null,this.b=e||null,Wi(this,{lastSignInTime:Vi(e||null),creationTime:Vi(t||null)})}function dh(t,e,n,i,r,o){Wi(this,{uid:t,displayName:i||null,photoURL:r||null,email:n||null,phoneNumber:o||null,providerId:e})}function ph(t,e,n){this.G=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null;var i=gb.SDK_VERSION?Ei(gb.SDK_VERSION):null;this.a=new Ba(this.l,O(A),i),t.emulatorConfig&&ts(this.a,t.emulatorConfig),this.b=new uh(this.a),Th(this,e[Xa]),hh(this.b,e),Bi(this,"refreshToken",this.b.a),Ah(this,n||{}),bn.call(this),this.P=!1,this.o&&Ni()&&(this.i=Uc(this.o,this.l,this.m)),this.R=[],this.f=null,this.u=function(t){return new sh(function(){return t.I(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=ch(t.b)-I()-3e5;return 0<e?e:0})}(this),this.$=y(this.gb,this);var r=this;this.pa=null,this.Ba=function(t){r.wa(t.h)},this.ba=null,this.za=function(t){ts(r.a,t.c)},this.W=null,this.X=[],this.Aa=function(t){gh(r,t.f)},this.aa=null,this.N=new oh(this,n),Bi(this,"multiFactor",this.N)}function vh(t,e){t.ba&&cn(t.ba,"languageCodeChanged",t.Ba),(t.ba=e)&&an(e,"languageCodeChanged",t.Ba)}function mh(t,e){t.W&&cn(t.W,"emulatorConfigChanged",t.za),(t.W=e)&&an(e,"emulatorConfigChanged",t.za)}function gh(t,e){t.X=e,ns(t.a,gb.SDK_VERSION?Ei(gb.SDK_VERSION,t.X):null)}function bh(t,e){t.aa&&cn(t.aa,"frameworkChanged",t.Aa),(t.aa=e)&&an(e,"frameworkChanged",t.Aa)}function yh(t){try{return gb.app(t.m).auth()}catch(e){throw new E("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function wh(t){t.A||t.u.b||(t.u.start(),cn(t,"tokenChanged",t.$),an(t,"tokenChanged",t.$))}function Ih(t){cn(t,"tokenChanged",t.$),t.u.stop()}function Th(t,e){t.ya=e,Bi(t,"_lat",e)}function Eh(t){for(var e=[],n=0;n<t.R.length;n++)e.push(t.R[n](t));return _e(e).then(function(){return t})}function kh(t){t.i&&!t.P&&(t.P=!0,Oc(t.i,t))}function Ah(t,e){Wi(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new fh(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Sh(){}function Nh(t){return Ae().then(function(){if(t.A)throw new E("app-deleted")})}function _h(t){return q(t.providerData,function(t){return t.providerId})}function Oh(t,e){e&&(Ch(t,e.providerId),t.providerData.push(e))}function Ch(t,e){W(t.providerData,function(t){return t.providerId==e})}function Rh(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Bi(t,e,n)}function Ph(t,e){t!=e&&(Wi(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Bi(t,"metadata",function(t){return new fh(t.a,t.b)}(e.metadata)):Bi(t,"metadata",new fh),$(e.providerData,function(e){Oh(t,e)}),function(t,e){t.b=e.b,t.a=e.a}(t.b,e.b),Bi(t,"refreshToken",t.b.a),ah(t.N,e.N.b))}function Dh(t){return t.I().then(function(e){var n=t.isAnonymous;return function(t,e){return Qs(t.a,Cs,{idToken:e}).then(y(t.Jc,t))}(t,e).then(function(){return n||Rh(t,"isAnonymous",!1),e})})}function Lh(t,e){e[Xa]&&t.ya!=e[Xa]&&(hh(t.b,e),t.dispatchEvent(new rh("tokenChanged")),Th(t,e[Xa]),Rh(t,"refreshToken",t.b.a))}function xh(t,e){return Dh(t).then(function(){if(G(_h(t),e))return Eh(t).then(function(){throw new E("provider-already-linked")})})}function Mh(t,e,n){return Xi({user:t,credential:xo(e),additionalUserInfo:e=Br(e),operationType:n})}function Fh(t,e){return Lh(t,e),t.reload().then(function(){return t})}function jh(t,e,n,i,r){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));if(t.f&&!r)return Se(t.f);var o=Gr(n.providerId),a=Li(t.uid+":::"),s=null;(!Ci()||vi())&&t.o&&n.isOAuthProvider&&(s=pu(t.o,t.l,t.m,e,n,null,a,gb.SDK_VERSION||null,null,null,t.tenantId));var u=hi(s,o&&o.ua,o&&o.ta);return i=i().then(function(){if(Vh(t),!r)return t.I().then(function(){})}).then(function(){return Dc(t.i,u,e,n,a,!!s,t.tenantId)}).then(function(){return new be(function(n,i){t.ma(e,null,new E("cancelled-popup-request"),t.h||null),t.g=n,t.O=i,t.h=a,t.c=Mc(t.i,t,e,u,a)})}).then(function(t){return u&&ci(u),t?Xi(t):null}).s(function(t){throw u&&ci(u),t}),$h(t,i,r)}function Uh(t,e,n,i,r){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));if(t.f&&!r)return Se(t.f);var o=null,a=Li(t.uid+":::");return i=i().then(function(){if(Vh(t),!r)return t.I().then(function(){})}).then(function(){return t.ga=a,Eh(t)}).then(function(e){return t.ha&&(e=(e=t.ha).b.set(Hh,t.w(),e.a)),e}).then(function(){return xc(t.i,e,n,a,t.tenantId)}).s(function(e){if(o=e,t.ha)return Gh(t.ha);throw o}).then(function(){if(o)throw o}),$h(t,i,r)}function Vh(t){if(!t.i||!t.P){if(t.i&&!t.P)throw new E("internal-error");throw new E("auth-domain-config-required")}}function $h(t,e,n){var i=function(t,e,n){return t.f&&!n?(e.cancel(),Se(t.f)):e.s(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.f||t.dispatchEvent(new rh("userInvalidated")),t.f=e),e})}(t,e,n);return t.G.push(i),i.na(function(){B(t.G,i)}),i.s(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=th(e.w(),yh(t),y(t.ic,t))),n||e})}function Kh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[Xa]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var i=new ph(e,n,t);return t.providerData&&$(t.providerData,function(t){t&&Oh(i,Xi(t))}),t.redirectEventId&&(i.ga=t.redirectEventId),i}function qh(t){this.a=t,this.b=Yu()}Yc.prototype.Qc=function(t){var e=this;return t.rb(this.a.a,this.c).then(function(t){var n=ft(e.f);return delete n[zc],delete n[Zc],pt(n,t),e.g(n)})},T(Qc,E),eh.prototype.rb=function(t,e,n){return e.type==io?function(t,e,n,i){return n.Ha().then(function(n){return n={idToken:n},void 0!==i&&(n.displayName=i),pt(n,{phoneVerificationInfo:Po(t.a)}),Qs(e,_s,n)})}(this,t,e,n):function(t,e,n){return n.Ha().then(function(n){return pt(n={mfaPendingCredential:n},{phoneVerificationInfo:Po(t.a)}),Qs(e,Os,n)})}(this,t,e)},T(nh,eh),T(ih,nh),T(rh,We),(t=oh.prototype).xc=function(t){ah(this,function(t){var e=[];return $(t.mfaInfo||[],function(t){(t=zi(t))&&e.push(t)}),e}(t.gd))},t.Qb=function(){return this.a.I().then(function(t){return new no(t,null)})},t.ec=function(t,e){var n=this,i=this.a.a;return this.Qb().then(function(n){return t.rb(i,n,e)}).then(function(t){return Lh(n.a,t),n.a.reload()})},t.ad=function(t){var e=this,n="string"==typeof t?t:t.uid,i=this.a.a;return this.a.I().then(function(t){return Qs(i,Zs,{idToken:t,mfaEnrollmentId:n})}).then(function(t){var i=K(e.b,function(t){return t.uid!=n});return ah(e,i),Lh(e.a,t),e.a.reload().s(function(t){if("auth/user-token-expired"!=t.code)throw t})})},t.w=function(){return{multiFactor:{enrolledFactors:q(this.b,function(t){return t.w()})}}},sh.prototype.start=function(){this.a=this.c,function t(e,n){e.stop();e.b=En(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(e,n)).then(function(){return t=a.document,e=null,ji()||!t?Ae():new be(function(n){e=function(){ji()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).s(function(n){throw t.removeEventListener("visibilitychange",e,!1),n});var t,e}).then(function(){return e.h()}).then(function(){t(e,!0)}).s(function(n){e.i(n)&&t(e,!1)})}(this,!0)},sh.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},uh.prototype.w=function(){return{apiKey:this.c.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:ch(this)}},uh.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Se(new E("user-token-expired")):t||!this.b||I()>ch(this)-3e4?this.a?lh(this,{grant_type:"refresh_token",refresh_token:this.a}):Ae(null):Ae({accessToken:this.b.toString(),refreshToken:this.a})},fh.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},T(ph,bn),ph.prototype.wa=function(t){this.pa=t,Qa(this.a,t)},ph.prototype.ka=function(){return this.pa},ph.prototype.Ga=function(){return J(this.X)},ph.prototype.gb=function(){this.u.b&&(this.u.stop(),this.u.start())},Bi(ph.prototype,"providerId","firebase"),(t=ph.prototype).reload=function(){var t=this;return $h(this,Nh(this).then(function(){return Dh(t).then(function(){return Eh(t)}).then(Sh)}))},t.nc=function(t){return this.I(t).then(function(t){return new Jc(t)})},t.I=function(t){var e=this;return $h(this,Nh(this).then(function(){return e.b.getToken(t)}).then(function(t){if(!t)throw new E("internal-error");return t.accessToken!=e.ya&&(Th(e,t.accessToken),e.dispatchEvent(new rh("tokenChanged"))),Rh(e,"refreshToken",t.refreshToken),t.accessToken}))},t.Jc=function(t){if(!(t=t.users)||!t.length)throw new E("internal-error");Ah(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?q(t,function(t){return new dh(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)Oh(this,e[n]);Rh(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new rh("userReloaded",{gd:t}))},t.Kc=function(t){return Hi("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.sb(t)},t.sb=function(t){var e=this,n=null;return $h(this,t.c(this.a,this.uid).then(function(t){return Lh(e,t),n=Mh(e,t,"reauthenticate"),e.f=null,e.reload()}).then(function(){return n}),!0)},t.Bc=function(t){return Hi("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.pb(t)},t.pb=function(t){var e=this,n=null;return $h(this,xh(this,t.providerId).then(function(){return e.I()}).then(function(n){return t.b(e.a,n)}).then(function(t){return n=Mh(e,t,"link"),Fh(e,t)}).then(function(){return n}))},t.Cc=function(t,e){var n=this;return $h(this,xh(this,"phone").then(function(){return Xc(yh(n),t,e,y(n.pb,n))}))},t.Lc=function(t,e){var n=this;return $h(this,Ae().then(function(){return Xc(yh(n),t,e,y(n.sb,n))}),!0)},t.Ab=function(t){var e=this;return $h(this,this.I().then(function(n){return e.a.Ab(n,t)}).then(function(t){return Lh(e,t),e.reload()}))},t.dd=function(t){var e=this;return $h(this,this.I().then(function(n){return t.b(e.a,n)}).then(function(t){return Lh(e,t),e.reload()}))},t.Bb=function(t){var e=this;return $h(this,this.I().then(function(n){return e.a.Bb(n,t)}).then(function(t){return Lh(e,t),e.reload()}))},t.Cb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Nh(this);var e=this;return $h(this,this.I().then(function(n){return e.a.Cb(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Lh(e,t),Rh(e,"displayName",t.displayName||null),Rh(e,"photoURL",t.photoUrl||null),$(e.providerData,function(t){"password"===t.providerId&&(Bi(t,"displayName",e.displayName),Bi(t,"photoURL",e.photoURL))}),Eh(e)}).then(Sh))},t.bd=function(t){var e=this;return $h(this,Dh(this).then(function(n){return G(_h(e),t)?function(t,e,n){return Qs(t,As,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then(function(t){var n={};return $(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),$(_h(e),function(t){n[t]||Ch(e,t)}),n[Do.PROVIDER_ID]||Bi(e,"phoneNumber",null),Eh(e)}):Eh(e).then(function(){throw new E("no-such-provider")})}))},t.delete=function(){var t=this;return $h(this,this.I().then(function(e){return Qs(t.a,ks,{idToken:e})}).then(function(){t.dispatchEvent(new rh("userDeleted"))})).then(function(){for(var e=0;e<t.G.length;e++)t.G[e].cancel("app-deleted");vh(t,null),mh(t,null),bh(t,null),t.G=[],t.A=!0,Ih(t),Bi(t,"refreshToken",null),t.i&&Cc(t.i,t)})},t.Eb=function(t,e){return!!("linkViaPopup"==t&&(this.h||null)==e&&this.g||"reauthViaPopup"==t&&(this.h||null)==e&&this.g||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.ma=function(t,e,n,i){"linkViaPopup"!=t&&"reauthViaPopup"!=t||i!=(this.h||null)||(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.h||null)?y(this.Jb,this):"reauthViaPopup"==t&&e==(this.h||null)?y(this.Kb,this):"linkViaRedirect"==t&&(this.ga||null)==e?y(this.Jb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?y(this.Kb,this):null},t.Dc=function(t){var e=this;return jh(this,"linkViaPopup",t,function(){return xh(e,t.providerId).then(function(){return Eh(e)})},!1)},t.Mc=function(t){return jh(this,"reauthViaPopup",t,function(){return Ae()},!0)},t.Ec=function(t){var e=this;return Uh(this,"linkViaRedirect",t,function(){return xh(e,t.providerId)},!1)},t.Nc=function(t){return Uh(this,"reauthViaRedirect",t,function(){return Ae()},!0)},t.Jb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return $h(this,this.I().then(function(n){return gs(r.a,{requestUri:t,postBody:i,sessionId:e,idToken:n})}).then(function(t){return o=Mh(r,t,"link"),Fh(r,t)}).then(function(){return o}))},t.Kb=function(t,e,n,i){var r=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return $h(this,Ae().then(function(){return ao(bs(r.a,{requestUri:t,sessionId:e,postBody:i,tenantId:n}),r.uid)}).then(function(t){return o=Mh(r,t,"reauthenticate"),Lh(r,t),r.f=null,r.reload()}).then(function(){return o}),!0)},t.tb=function(t){var e=this,n=null;return $h(this,this.I().then(function(e){return n=e,void 0===t||lt(t)?{}:Mr(new Sr(t))}).then(function(t){return e.a.tb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},t.Db=function(t,e){var n=this,i=null;return $h(this,this.I().then(function(t){return i=t,void 0===e||lt(e)?{}:Mr(new Sr(e))}).then(function(e){return n.a.Db(i,t,e)}).then(function(t){if(n.email!=t)return n.reload()}).then(function(){}))},t.ic=function(t){var e=null,n=this;return $h(this,t=ao(Ae(t),n.uid).then(function(t){return e=Mh(n,t,"reauthenticate"),Lh(n,t),n.f=null,n.reload()}).then(function(){return e}),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&pt(t,this.metadata.w()),$(this.providerData,function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))}),pt(t,this.N.w()),t};var Hh={name:"redirectUser",D:"session"};function Gh(t){return Qu(t.b,Hh,t.a)}function Bh(t){this.a=t,this.b=Yu(),this.c=null,this.f=function(t){var e=Jh("local"),n=Jh("session"),i=Jh("none");return function(t,e,n){var i=Zu(e,n),r=zu(t,e.D);return t.get(e,n).then(function(o){var s=null;try{s=Di(a.localStorage.getItem(i))}catch(u){}if(s&&!o)return a.localStorage.removeItem(i),t.set(e,s,n);s&&o&&"localStorage"!=r.type&&a.localStorage.removeItem(i)})}(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(r){return r?n:t.b.get(i,t.a).then(function(n){return n?i:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(Xh,t.a).then(function(t){return t?Jh(t):e})})})}).then(function(e){return t.c=e,Wh(t,e.D)}).s(function(){t.c||(t.c=e)})}(this),this.b.addListener(Jh("local"),this.a,y(this.g,this))}function Wh(t,e){var n,i=[];for(n in Xu)Xu[n]!==e&&i.push(Qu(t.b,Jh(Xu[n]),t.a));return i.push(Qu(t.b,Xh,t.a)),function(t){return new be(function(e,n){var i=t.length,r=[];if(i)for(var o=function(t,n){i--,r[t]=n,0==i&&e(r)},a=function(t){n(t)},s=0;s<t.length;s++)Ne(t[s],w(o,s),a);else e(r)})}(i)}Bh.prototype.g=function(){var t=this,e=Jh("local");Qh(this,function(){return Ae().then(function(){return t.c&&"local"!=t.c.D?t.b.get(e,t.a):null}).then(function(n){if(n)return Wh(t,"local").then(function(){t.c=e})})})};var Xh={name:"persistence",D:"session"};function Jh(t){return{name:"authUser",D:t}}function Yh(t,e){return Qh(t,function(){return t.b.set(t.c,e.w(),t.a)})}function zh(t){return Qh(t,function(){return Qu(t.b,t.c,t.a)})}function Zh(t,e,n){return Qh(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Kh(t||{})})})}function Qh(t,e){return t.f=t.f.then(e,e),t.f}function tl(t){if(this.m=!1,Bi(this,"settings",new Bc),Bi(this,"app",t),!cl(this).options||!cl(this).options.apiKey)throw new E("invalid-api-key");t=gb.SDK_VERSION?Ei(gb.SDK_VERSION):null,this.a=new Ba(cl(this).options&&cl(this).options.apiKey,O(A),t),this.R=[],this.u=[],this.P=[],this.ac=gb.INTERNAL.createSubscribe(y(this.yc,this)),this.X=void 0,this.bc=gb.INTERNAL.createSubscribe(y(this.zc,this)),sl(this,null),this.l=new Bh(cl(this).options.apiKey+":"+cl(this).name),this.G=new qh(cl(this).options.apiKey+":"+cl(this).name),this.$=dl(this,function(t){var e=cl(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(Hh,t.a).then(function(t){return t&&e&&(t.authDomain=e),Kh(t||{})})}(t.G,cl(t).options.authDomain).then(function(e){return(t.o=e)&&(e.ha=t.G),Gh(t.G)});return dl(t,e)}(t).then(function(){return Zh(t.l,e,t.f)}).then(function(e){return e?(e.ha=t.G,t.o&&(t.o.ga||null)==(e.ga||null)?e:e.reload().then(function(){return Yh(t.l,e).then(function(){return e})}).s(function(n){return"auth/network-request-failed"==n.code?e:zh(t.l)})):null}).then(function(e){sl(t,e||null)});return dl(t,n)}(this)),this.i=dl(this,function(t){return t.$.then(function(){return ol(t)}).s(function(){}).then(function(){if(!t.m)return t.pa()}).s(function(){}).then(function(){if(!t.m){t.ba=!0;var e=t.l;e.b.addListener(Jh("local"),e.a,t.pa)}})}(this)),this.ba=!1,this.pa=y(this.Yc,this),this.Ba=y(this.da,this),this.ya=y(this.kc,this),this.za=y(this.vc,this),this.Aa=y(this.wc,this),this.b=null,function(t){var e=cl(t).options.authDomain,n=cl(t).options.apiKey;e&&Ni()&&(t.gb=t.$.then(function(){if(!t.m){if(t.b=Uc(e,n,cl(t).name,t.f),Oc(t.b,t),hl(t)&&kh(hl(t)),t.o){kh(t.o);var i=t.o;i.wa(t.ka()),vh(i,t),gh(i=t.o,t.N),bh(i,t),ts((i=t.o).a,t.f),mh(i,t),t.o=null}return t.b}}))}(this),this.INTERNAL={},this.INTERNAL.delete=y(this.delete,this),this.INTERNAL.logFramework=y(this.Fc,this),this.A=0,bn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ka()},set:function(t){this.wa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.S()},set:function(t){this.xb(t)},enumerable:!1}),t.W=null}(this),this.N=[],this.f=null}function el(t){We.call(this,"languageCodeChanged"),this.h=t}function nl(t){We.call(this,"emulatorConfigChanged"),this.c=t}function il(t){We.call(this,"frameworkChanged"),this.f=t}function rl(t){return t.gb||Se(new E("auth-domain-config-required"))}function ol(t){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));var e=rl(t).then(function(){return t.b.qa()}).then(function(t){return t?Xi(t):null});return dl(t,e)}function al(t,e){var n={};return n.apiKey=cl(t).options.apiKey,n.authDomain=cl(t).options.authDomain,n.appName=cl(t).name,t.f&&(n.emulatorConfig=t.f),t.$.then(function(){return function(t,e,n,i){var r=new ph(t,e);return n&&(r.ha=n),i&&gh(r,i),r.reload().then(function(){return r})}(n,e,t.G,t.Ga())}).then(function(e){return hl(t)&&e.uid==hl(t).uid?(Ph(hl(t),e),t.da(e)):(sl(t,e),kh(e),t.da(e))}).then(function(){fl(t)})}function sl(t,e){hl(t)&&(function(t,e){W(t.R,function(t){return t==e})}(hl(t),t.Ba),cn(hl(t),"tokenChanged",t.ya),cn(hl(t),"userDeleted",t.za),cn(hl(t),"userInvalidated",t.Aa),Ih(hl(t))),e&&(e.R.push(t.Ba),an(e,"tokenChanged",t.ya),an(e,"userDeleted",t.za),an(e,"userInvalidated",t.Aa),0<t.A&&wh(e)),Bi(t,"currentUser",e),e&&(e.wa(t.ka()),vh(e,t),gh(e,t.N),bh(e,t),ts(e.a,t.f),mh(e,t))}function ul(t,e){var n=null,i=null;return dl(t,e.then(function(e){return n=xo(e),i=Br(e),al(t,e)},function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=th(e.w(),t,y(t.jc,t))),n||e}).then(function(){return Xi({user:hl(t),credential:n,additionalUserInfo:i,operationType:"signIn"})}))}function cl(t){return t.app}function hl(t){return t.currentUser}function ll(t){return hl(t)&&hl(t)._lat||null}function fl(t){if(t.ba){for(var e=0;e<t.u.length;e++)t.u[e]&&t.u[e](ll(t));if(t.X!==t.getUid()&&t.P.length)for(t.X=t.getUid(),e=0;e<t.P.length;e++)t.P[e]&&t.P[e](ll(t))}}function dl(t,e){return t.R.push(e),e.na(function(){B(t.R,e)}),e}function pl(){}function vl(){this.a={},this.b=1e12}Bh.prototype.wb=function(t){var e=null,n=this;return function(t){var e=new E("invalid-persistence-type"),n=new E("unsupported-persistence-type");t:{for(i in Xu)if(Xu[i]==t){var i=!0;break t}i=!1}if(!i||"string"!=typeof t)throw e;switch(gi()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Nu()&&"none"!==t)throw n;break;default:if(!Si()&&"none"!==t)throw n;}}(t),Qh(this,function(){return t!=n.c.D?n.b.get(n.c,n.a).then(function(i){return e=i,Wh(n,t)}).then(function(){if(n.c=Jh(t),e)return n.b.set(n.c,e,n.a)}):Ae()})},T(tl,bn),T(el,We),T(nl,We),T(il,We),(t=tl.prototype).wb=function(t){return dl(this,t=this.l.wb(t))},t.wa=function(t){this.aa===t||this.m||(this.aa=t,Qa(this.a,this.aa),this.dispatchEvent(new el(this.ka())))},t.ka=function(){return this.aa},t.ed=function(){var t=a.navigator;this.wa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.fd=function(t){if(!this.f){if(!/^https?:\/\//.test(t))throw new E("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");Ui("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),a.document&&di().then(function(){var t=a.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#ff0000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),a.document.body.appendChild(t)}),this.f={url:t},this.settings.hb=!0,ts(this.a,this.f),this.dispatchEvent(new nl(this.f))}},t.Fc=function(t){this.N.push(t),ns(this.a,gb.SDK_VERSION?Ei(gb.SDK_VERSION,this.N):null),this.dispatchEvent(new il(this.N))},t.Ga=function(){return J(this.N)},t.xb=function(t){this.W===t||this.m||(this.W=t,this.a.b=this.W)},t.S=function(){return this.W},t.toJSON=function(){return{apiKey:cl(this).options.apiKey,authDomain:cl(this).options.authDomain,appName:cl(this).name,currentUser:hl(this)&&hl(this).w()}},t.Eb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.h==e&&!!this.g;default:return!1;}},t.ma=function(t,e,n,i){"signInViaPopup"==t&&this.h==i&&(n&&this.O?this.O(n):e&&!n&&this.g&&this.g(e),this.c&&(this.c.cancel(),this.c=null),delete this.g,delete this.O)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.h==e&&this.g?y(this.hc,this):null},t.hc=function(t,e,n,i){var r=this,o={requestUri:t,postBody:i,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),r.$.then(function(){return ul(r,ms(r.a,o))})},t.Wc=function(t){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));var e=this,n=Gr(t.providerId),i=Li(),r=null;(!Ci()||vi())&&cl(this).options.authDomain&&t.isOAuthProvider&&(r=pu(cl(this).options.authDomain,cl(this).options.apiKey,cl(this).name,"signInViaPopup",t,null,i,gb.SDK_VERSION||null,null,null,this.S(),this.f));var o=hi(r,n&&n.ua,n&&n.ta);return dl(this,n=rl(this).then(function(n){return Dc(n,o,"signInViaPopup",t,i,!!r,e.S())}).then(function(){return new be(function(t,n){e.ma("signInViaPopup",null,new E("cancelled-popup-request"),e.h),e.g=t,e.O=n,e.h=i,e.c=Mc(e.b,e,"signInViaPopup",o,i)})}).then(function(t){return o&&ci(o),t?Xi(t):null}).s(function(t){throw o&&ci(o),t}))},t.Xc=function(t){if(!Ni())return Se(new E("operation-not-supported-in-this-environment"));var e=this;return dl(this,rl(this).then(function(){return Qh(t=e.l,function(){return t.b.set(Xh,t.c.D,t.a)});var t}).then(function(){return xc(e.b,"signInViaRedirect",t,void 0,e.S())}))},t.qa=function(){var t=this;return ol(this).then(function(e){return t.b&&Kc(t.b.b),e}).s(function(e){throw t.b&&Kc(t.b.b),e})},t.cd=function(t){if(!t)return Se(new E("null-user"));if(this.W!=t.tenantId)return Se(new E("tenant-id-mismatch"));var e=this,n={};n.apiKey=cl(this).options.apiKey,n.authDomain=cl(this).options.authDomain,n.appName=cl(this).name;var i=function(t,e,n,i){var r=t.b,o={};return o[Xa]=r.b&&r.b.toString(),o.refreshToken=r.a,e=new ph(e||{apiKey:t.l,authDomain:t.o,appName:t.m},o),n&&(e.ha=n),i&&gh(e,i),Ph(e,t),e}(t,n,e.G,e.Ga());return dl(this,this.i.then(function(){if(cl(e).options.apiKey!=t.l)return i.reload()}).then(function(){return hl(e)&&t.uid==hl(e).uid?(Ph(hl(e),t),e.da(t)):(sl(e,i),kh(i),e.da(i))}).then(function(){fl(e)}))},t.zb=function(){var t=this;return dl(this,this.i.then(function(){return t.b&&Kc(t.b.b),hl(t)?(sl(t,null),zh(t.l).then(function(){fl(t)})):Ae()}))},t.Yc=function(){var t=this;return Zh(this.l,cl(this).options.authDomain).then(function(e){if(!t.m){var n;if(n=hl(t)&&e){n=hl(t).uid;var i=e.uid;n=null!=n&&""!==n&&null!=i&&""!==i&&n==i}if(n)return Ph(hl(t),e),hl(t).I();(hl(t)||e)&&(sl(t,e),e&&(kh(e),e.ha=t.G),t.b&&Oc(t.b,t),fl(t))}})},t.da=function(t){return Yh(this.l,t)},t.kc=function(){fl(this),this.da(hl(this))},t.vc=function(){this.zb()},t.wc=function(){this.zb()},t.jc=function(t){var e=this;return this.i.then(function(){return ul(e,Ae(t))})},t.yc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(hl(e))})},t.zc=function(t){var e=this;!function(t,e){t.P.push(e),dl(t,t.i.then(function(){!t.m&&G(t.P,e)&&t.X!==t.getUid()&&(t.X=t.getUid(),e(ll(t)))}))}(this,function(){t.next(hl(e))})},t.Hc=function(t,e,n){var i=this;return this.ba&&Promise.resolve().then(function(){"function"==typeof t?t(hl(i)):"function"==typeof t.next&&t.next(hl(i))}),this.ac(t,e,n)},t.Gc=function(t,e,n){var i=this;return this.ba&&Promise.resolve().then(function(){i.X=i.getUid(),"function"==typeof t?t(hl(i)):"function"==typeof t.next&&t.next(hl(i))}),this.bc(t,e,n)},t.mc=function(t){var e=this;return dl(this,this.i.then(function(){return hl(e)?hl(e).I(t).then(function(t){return{accessToken:t}}):null}))},t.Sc=function(t){var e=this;return this.i.then(function(){return ul(e,Qs(e.a,Ws,{token:t}))}).then(function(t){var n=t.user;return Rh(n,"isAnonymous",!1),e.da(n),t})},t.Tc=function(t,e){var n=this;return this.i.then(function(){return ul(n,Qs(n.a,Xs,{email:t,password:e}))})},t.dc=function(t,e){var n=this;return this.i.then(function(){return ul(n,Qs(n.a,Ts,{email:t,password:e}))})},t.Za=function(t){var e=this;return this.i.then(function(){return ul(e,t.ja(e.a))})},t.Rc=function(t){return Hi("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Za(t)},t.yb=function(){var t=this;return this.i.then(function(){var e=hl(t);if(e&&e.isAnonymous){var n=Xi({providerId:null,isNewUser:!1});return Xi({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return ul(t,t.a.yb()).then(function(e){var n=e.user;return Rh(n,"isAnonymous",!0),t.da(n),e})})},t.getUid=function(){return hl(this)&&hl(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.A++,0<this.A&&hl(this)&&wh(hl(this))},t.Oc=function(t){var e=this;$(this.u,function(n){n==t&&e.A--}),0>this.A&&(this.A=0),0==this.A&&hl(this)&&Ih(hl(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.u.push(t),dl(this,this.i.then(function(){e.m||G(e.u,t)&&t(ll(e))}))},t.removeAuthTokenListener=function(t){W(this.u,function(e){return e==t})},t.delete=function(){this.m=!0;for(var t=0;t<this.R.length;t++)this.R[t].cancel("app-deleted");return this.R=[],this.l&&(t=this.l).b.removeListener(Jh("local"),t.a,this.pa),this.b&&(Cc(this.b,this),Kc(this.b.b)),Promise.resolve()},t.gc=function(t){return dl(this,function(t,e){return Qs(t,Es,{identifier:e,continueUri:_i()?ai():"http://localhost"}).then(function(t){return t.signinMethods||[]})}(this.a,t))},t.Ac=function(t){return!!Oo(t)},t.vb=function(t,e){var n=this;return dl(this,Ae().then(function(){var t=new Sr(e);if(!t.c)throw new E("argument-error",Or+" must be true when sending sign in link to email");return Mr(t)}).then(function(e){return n.a.vb(t,e)}).then(function(){}))},t.hd=function(t){return this.Qa(t).then(function(t){return t.data.email})},t.mb=function(t,e){return dl(this,this.a.mb(t,e).then(function(){}))},t.Qa=function(t){return dl(this,this.a.Qa(t).then(function(t){return new ir(t)}))},t.ib=function(t){return dl(this,this.a.ib(t).then(function(){}))},t.ub=function(t,e){var n=this;return dl(this,Ae().then(function(){return void 0===e||lt(e)?{}:Mr(new Sr(e))}).then(function(e){return n.a.ub(t,e)}).then(function(){}))},t.Vc=function(t,e){return dl(this,Xc(this,t,e,y(this.Za,this)))},t.Uc=function(t,e){var n=this;return dl(this,Ae().then(function(){var i=e||ai(),r=_o(t,i);if(!(i=Oo(i)))throw new E("argument-error","Invalid email link!");if(i.tenantId!==n.S())throw new E("tenant-id-mismatch");return n.Za(r)}))},pl.prototype.render=function(){},pl.prototype.reset=function(){},pl.prototype.getResponse=function(){},pl.prototype.execute=function(){};var ml=null;function gl(t,e){return(e=bl(e))&&t.a[e]||null}function bl(t){return(t=void 0===t?1e12:t)?t.toString():null}function yl(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=re(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():an(this.f,"click",this.i)}function wl(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Il(){}function Tl(){}vl.prototype.render=function(t,e){return this.a[this.b.toString()]=new yl(t,e),this.b++},vl.prototype.reset=function(t){var e=gl(this,t);t=bl(t),e&&t&&(e.delete(),delete this.a[t])},vl.prototype.getResponse=function(t){return(t=gl(this,t))?t.getResponse():null},vl.prototype.execute=function(t){(t=gl(this,t))&&t.execute()},yl.prototype.getResponse=function(){return wl(this),this.b},yl.prototype.execute=function(){wl(this);var t=this;this.a||(this.a=setTimeout(function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(i){}t.a=setTimeout(function(){if(t.a=null,t.b=null,n)try{n()}catch(i){}t.h&&t.execute()},6e4)},500))},yl.prototype.delete=function(){wl(this),this.g=!0,clearTimeout(this.a),this.a=null,cn(this.f,"click",this.i)},Bi(Il,"FACTOR_ID","phone"),Tl.prototype.g=function(){return ml||(ml=new vl),Ae(ml)},Tl.prototype.c=function(){};var El=null;function kl(){this.b=a.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Al=new mt(yt,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Sl=new Fi(3e4,6e4);kl.prototype.g=function(t){var e=this;return new be(function(n,i){var r=setTimeout(function(){i(new E("network-request-failed"))},Sl.get());!a.grecaptcha||t!==e.f&&!e.b?(a[e.a]=function(){if(a.grecaptcha){e.f=t;var o=a.grecaptcha.render;a.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(r),n(a.grecaptcha)}else clearTimeout(r),i(new E("internal-error"));delete a[e.a]},Ae(Ua(Et(Al,{onload:e.a,hl:t||""}))).s(function(){clearTimeout(r),i(new E("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(r),n(a.grecaptcha))})},kl.prototype.c=function(){this.b--};var Nl=null;function _l(t,e,n,i,r,o,s){if(Bi(this,"type","recaptcha"),this.c=this.f=null,this.A=!1,this.m=e,this.g=null,s?(El||(El=new Tl),s=El):(Nl||(Nl=new kl),s=Nl),this.v=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Rl])throw new E("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Pl],!a.document)throw new E("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!re(e)||!this.i&&re(e).hasChildNodes())throw new E("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Ba(t,o||null,r||null),this.u=i||function(){return null};var u=this;this.l=[];var c=this.a[Ol];this.a[Ol]=function(t){if(Dl(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Ai(c,a);"function"==typeof e&&e(t)}};var h=this.a[Cl];this.a[Cl]=function(){if(Dl(u,null),"function"==typeof h)h();else if("string"==typeof h){var t=Ai(h,a);"function"==typeof t&&t()}}}var Ol="callback",Cl="expired-callback",Rl="sitekey",Pl="size";function Dl(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(i){}}function Ll(t,e){return t.h.push(e),e.na(function(){B(t.h,e)}),e}function xl(t){if(t.A)throw new E("internal-error","RecaptchaVerifier instance has been destroyed.")}function Ml(t,e,n){var i=!1;try{this.b=n||gb.app()}catch(a){throw new E("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new E("invalid-api-key");n=this.b.options.apiKey;var r=this,o=null;try{o=this.b.auth().Ga()}catch(a){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(a){}o=gb.SDK_VERSION?Ei(gb.SDK_VERSION,o):null,_l.call(this,n,t,e,function(){try{var t=r.b.auth().ka()}catch(e){t=null}return t},o,O(A),i)}function Fl(t,e,n,i){t:{n=Array.prototype.slice.call(n);for(var r=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new E("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(o=e.length,n.length<r||o<n.length)i="Expected "+(r==o?1==r?"1 argument":r+" arguments":r+"-"+o+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(o=e[r].optional&&void 0===n[r],!e[r].K(n[r])&&!o){if(e=e[r],0>r||r>=jl.length)throw new E("internal-error","Argument validator received an unsupported number of arguments.");n=jl[r],i=(i?"":n+" argument ")+(e.name?"\""+e.name+"\" ":"")+"must be "+e.J+".";break t}i=null}}if(i)throw new E("argument-error",t+" failed: "+i)}(t=_l.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Ll(this,Ae().then(function(){if(_i()&&!mi())return di();throw new E("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return t.v.g(t.u())}).then(function(e){return t.g=e,Qs(t.o,Ms,{})}).then(function(e){t.a[Rl]=e.recaptchaSiteKey}).s(function(e){throw t.f=null,e}))},t.render=function(){xl(this);var t=this;return Ll(this,this.Ia().then(function(){if(null===t.c){var e=t.m;if(!t.i){var n=re(e);e=ce("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c}))},t.verify=function(){xl(this);var t=this;return Ll(this,this.render().then(function(e){return new be(function(n){var i=t.g.getResponse(e);if(i)n(i);else{var r=function(e){e&&(function(t,e){W(t.l,function(t){return t==e})}(t,r),n(e))};t.l.push(r),t.i&&t.g.execute(t.c)}})}))},t.reset=function(){xl(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){xl(this),this.A=!0,this.v.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=re(this.m);for(var e;e=t.firstChild;)t.removeChild(e)}},T(Ml,_l);var jl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Ul(t,e){return{name:t||"",J:"a valid string",optional:!!e,K:function(t){return"string"==typeof t}}}function Vl(t,e){return{name:t||"",J:"a boolean",optional:!!e,K:function(t){return"boolean"==typeof t}}}function $l(t,e){return{name:t||"",J:"a valid object",optional:!!e,K:d}}function Kl(t,e){return{name:t||"",J:"a function",optional:!!e,K:function(t){return"function"==typeof t}}}function ql(t,e){return{name:t||"",J:"null",optional:!!e,K:function(t){return null===t}}}function Hl(t){return{name:t?t+"Credential":"credential",J:t?"a valid "+t+" credential":"a valid credential",optional:!1,K:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ja||!n)}}}function Gl(t,e){return d(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function Bl(t){return d(t)&&"string"==typeof t.uid}function Wl(t,e,n,i){return{name:n||"",J:t.J+" or "+e.J,optional:!!i,K:function(n){return t.K(n)||e.K(n)}}}function Xl(t,e){for(var n in e){var i=e[n].name;t[i]=zl(i,t[n],e[n].j)}}function Jl(t,e){for(var n in e){var i=e[n].name;i!==n&&Object.defineProperty(t,i,{get:w(function(t){return this[t]},n),set:w(function(t,e,n,i){Fl(t,[n],[i],!0),this[e]=i},i,n,e[n].jb),enumerable:!0})}}function Yl(t,e,n,i){t[e]=zl(e,n,i)}function zl(t,e,n){function i(){var t=Array.prototype.slice.call(arguments);return Fl(o,n,t),e.apply(this,t)}if(!n)return e;var r,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(r in e)i[r]=e[r];for(r in e.prototype)i.prototype[r]=e.prototype[r];return i}Xl(tl.prototype,{ib:{name:"applyActionCode",j:[Ul("code")]},Qa:{name:"checkActionCode",j:[Ul("code")]},mb:{name:"confirmPasswordReset",j:[Ul("code"),Ul("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Ul("email"),Ul("password")]},gc:{name:"fetchSignInMethodsForEmail",j:[Ul("email")]},qa:{name:"getRedirectResult",j:[]},Ac:{name:"isSignInWithEmailLink",j:[Ul("emailLink")]},Gc:{name:"onAuthStateChanged",j:[Wl($l(),Kl(),"nextOrObserver"),Kl("opt_error",!0),Kl("opt_completed",!0)]},Hc:{name:"onIdTokenChanged",j:[Wl($l(),Kl(),"nextOrObserver"),Kl("opt_error",!0),Kl("opt_completed",!0)]},ub:{name:"sendPasswordResetEmail",j:[Ul("email"),Wl($l("opt_actionCodeSettings",!0),ql(null,!0),"opt_actionCodeSettings",!0)]},vb:{name:"sendSignInLinkToEmail",j:[Ul("email"),$l("actionCodeSettings")]},wb:{name:"setPersistence",j:[Ul("persistence")]},Rc:{name:"signInAndRetrieveDataWithCredential",j:[Hl()]},yb:{name:"signInAnonymously",j:[]},Za:{name:"signInWithCredential",j:[Hl()]},Sc:{name:"signInWithCustomToken",j:[Ul("token")]},Tc:{name:"signInWithEmailAndPassword",j:[Ul("email"),Ul("password")]},Uc:{name:"signInWithEmailLink",j:[Ul("email"),Ul("emailLink",!0)]},Vc:{name:"signInWithPhoneNumber",j:[Ul("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Wc:{name:"signInWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Xc:{name:"signInWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},cd:{name:"updateCurrentUser",j:[Wl({name:"user",J:"an instance of Firebase User",optional:!1,K:function(t){return!!(t&&t instanceof ph)}},ql(),"user")]},zb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Ul(null,!0)]},ed:{name:"useDeviceLanguage",j:[]},fd:{name:"useEmulator",j:[Ul("url")]},hd:{name:"verifyPasswordResetCode",j:[Ul("code")]}}),Jl(tl.prototype,{lc:{name:"languageCode",jb:Wl(Ul(),ql(),"languageCode")},ti:{name:"tenantId",jb:Wl(Ul(),ql(),"tenantId")}}),tl.Persistence=Xu,tl.Persistence.LOCAL="local",tl.Persistence.SESSION="session",tl.Persistence.NONE="none",Xl(ph.prototype,{delete:{name:"delete",j:[]},nc:{name:"getIdTokenResult",j:[Vl("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Vl("opt_forceRefresh",!0)]},Bc:{name:"linkAndRetrieveDataWithCredential",j:[Hl()]},pb:{name:"linkWithCredential",j:[Hl()]},Cc:{name:"linkWithPhoneNumber",j:[Ul("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Dc:{name:"linkWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ec:{name:"linkWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Kc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Hl()]},sb:{name:"reauthenticateWithCredential",j:[Hl()]},Lc:{name:"reauthenticateWithPhoneNumber",j:[Ul("phoneNumber"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Mc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Nc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",J:"a valid Auth provider",optional:!1,K:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},tb:{name:"sendEmailVerification",j:[Wl($l("opt_actionCodeSettings",!0),ql(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Ul(null,!0)]},bd:{name:"unlink",j:[Ul("provider")]},Ab:{name:"updateEmail",j:[Ul("email")]},Bb:{name:"updatePassword",j:[Ul("password")]},dd:{name:"updatePhoneNumber",j:[Hl("phone")]},Cb:{name:"updateProfile",j:[$l("profile")]},Db:{name:"verifyBeforeUpdateEmail",j:[Ul("email"),Wl($l("opt_actionCodeSettings",!0),ql(null,!0),"opt_actionCodeSettings",!0)]}}),Xl(vl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Xl(pl.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Xl(be.prototype,{na:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),Jl(Bc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",jb:Vl("appVerificationDisabledForTesting")}}),Xl(Wc.prototype,{confirm:{name:"confirm",j:[Ul("verificationCode")]}}),Yl(oo,"fromJSON",function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[fo,So,Ro,co],i=0;i<n.length;i++)if(e=n[i](t))return e;return null},[Wl(Ul(),$l(),"json")]),Yl(No,"credential",function(t,e){return new Ao(t,e)},[Ul("email"),Ul("password")]),Xl(Ao.prototype,{w:{name:"toJSON",j:[Ul(null,!0)]}}),Xl(go.prototype,{Ca:{name:"addScope",j:[Ul("scope")]},Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),Yl(go,"credential",bo,[Wl(Ul(),$l(),"token")]),Yl(No,"credentialWithLink",_o,[Ul("email"),Ul("emailLink")]),Xl(yo.prototype,{Ca:{name:"addScope",j:[Ul("scope")]},Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),Yl(yo,"credential",wo,[Wl(Ul(),$l(),"token")]),Xl(Io.prototype,{Ca:{name:"addScope",j:[Ul("scope")]},Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),Yl(Io,"credential",To,[Wl(Ul(),Wl($l(),ql()),"idToken"),Wl(Ul(),ql(),"accessToken",!0)]),Xl(Eo.prototype,{Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),Yl(Eo,"credential",ko,[Wl(Ul(),$l(),"token"),Ul("secret",!0)]),Xl(mo.prototype,{Ca:{name:"addScope",j:[Ul("scope")]},credential:{name:"credential",j:[Wl(Ul(),Wl($l(),ql()),"optionsOrIdToken"),Wl(Ul(),ql(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[$l("customOAuthParameters")]}}),Xl(ho.prototype,{w:{name:"toJSON",j:[Ul(null,!0)]}}),Xl(so.prototype,{w:{name:"toJSON",j:[Ul(null,!0)]}}),Yl(Do,"credential",Lo,[Ul("verificationId"),Ul("verificationCode")]),Xl(Do.prototype,{eb:{name:"verifyPhoneNumber",j:[Wl(Ul(),{name:"phoneInfoOptions",J:"valid phone info options",optional:!1,K:function(t){return!!t&&(t.session&&t.phoneNumber?Gl(t.session,io)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?Gl(t.session,ro)&&Bl(t.multiFactorHint):t.session&&t.multiFactorUid?Gl(t.session,ro)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",J:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,K:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),Xl(Co.prototype,{w:{name:"toJSON",j:[Ul(null,!0)]}}),Xl(E.prototype,{toJSON:{name:"toJSON",j:[Ul(null,!0)]}}),Xl(qo.prototype,{toJSON:{name:"toJSON",j:[Ul(null,!0)]}}),Xl(Ko.prototype,{toJSON:{name:"toJSON",j:[Ul(null,!0)]}}),Xl(Qc.prototype,{toJSON:{name:"toJSON",j:[Ul(null,!0)]}}),Xl(Yc.prototype,{Qc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}}]}}),Xl(oh.prototype,{Qb:{name:"getSession",j:[]},ec:{name:"enroll",j:[{name:"multiFactorAssertion",J:"a valid multiFactorAssertion",optional:!1,K:function(t){return!!t&&!!t.rb}},Ul("displayName",!0)]},ad:{name:"unenroll",j:[Wl({name:"multiFactorInfo",J:"a valid multiFactorInfo",optional:!1,K:Bl},Ul(),"multiFactorInfoIdentifier")]}}),Xl(Ml.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),Yl(gr,"parseLink",Ar,[Ul("link")]),Yl(Il,"assertion",function(t){return new ih(t)},[Hl("phone")]),function(){if("undefined"==typeof gb||!gb.INTERNAL||!gb.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:or,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:rr,VERIFY_AND_CHANGE_EMAIL:ar,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:tl,AuthCredential:oo,Error:E};Yl(t,"EmailAuthProvider",No,[]),Yl(t,"FacebookAuthProvider",go,[]),Yl(t,"GithubAuthProvider",yo,[]),Yl(t,"GoogleAuthProvider",Io,[]),Yl(t,"TwitterAuthProvider",Eo,[]),Yl(t,"OAuthProvider",mo,[Ul("providerId")]),Yl(t,"SAMLAuthProvider",vo,[Ul("providerId")]),Yl(t,"PhoneAuthProvider",Do,[{name:"auth",J:"an instance of Firebase Auth",optional:!0,K:function(t){return!!(t&&t instanceof tl)}}]),Yl(t,"RecaptchaVerifier",Ml,[Wl(Ul(),{name:"",J:"an HTML element",optional:!1,K:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),$l("recaptchaParameters",!0),{name:"app",J:"an instance of Firebase App",optional:!0,K:function(t){return!!(t&&t instanceof gb.app.App)}}]),Yl(t,"ActionCodeURL",gr,[]),Yl(t,"PhoneMultiFactorGenerator",Il,[]),gb.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new tl(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),gb.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:y((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:y(t.mc,t),addAuthTokenListener:y(t.cc,t),removeAuthTokenListener:y(t.Oc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),gb.registerVersion("@firebase/auth","0.15.1"),gb.INTERNAL.extendNamespace({User:ph})}()}).apply("undefined"!=typeof Qb?Qb:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var bj=(xd(),wd);var oE=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Db(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:hg(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),pE=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return Pb(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),Uq=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new oE(t)}}catch(r){}return new pE},Zd=Uq("localStorage"),Dk=Uq("sessionStorage"),Gf=new Pq("@firebase/database"),Vq=function(){var e=1;return function(){return e++}}(),Wq=function(e){var t=WD(e),r=new SD;r.update(t);var n=r.digest();return xk.encodeByteArray(n)},kg=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r="",n=0;n<e.length;n++){var i=e[n];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?r+=kg.apply(null,i):r+="object"==typeof i?Db(i):i,r+=" "}return r},cj=null,qE=!0,Xq=function(e,t){cb(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(Gf.logLevel=ub.VERBOSE,cj=Gf.log.bind(Gf),t&&Dk.set("logging_enabled",!0)):"function"==typeof e?cj=e:(cj=null,Dk.remove("logging_enabled"))},Hb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===qE&&(qE=!1,null===cj&&!0===Dk.get("logging_enabled")&&Xq(!0)),cj){var r=kg.apply(null,e);cj(r)}},lg=function(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];Hb.apply(void 0,Yd([e],t))}},Ek=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE INTERNAL ERROR: "+kg.apply(void 0,Yd(e));Gf.error(r)},gd=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE FATAL ERROR: "+kg.apply(void 0,Yd(e));throw Gf.error(r),new Error(r)},Lb=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="FIREBASE WARNING: "+kg.apply(void 0,Yd(e));Gf.warn(r)},rE=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Lb("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},dj=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},sE=function(e){if(fd()||"complete"===document.readyState)e();else{var t=!1,r=function(){document.body?t||(t=!0,e()):setTimeout(r,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",r,!1),window.addEventListener("load",r,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&r()}),window.attachEvent("onload",r))}},$d="[MIN_NAME]",Ed="[MAX_NAME]",_d=function(e,t){if(e===t)return 0;if(e===$d||t===Ed)return-1;if(t===$d||e===Ed)return 1;var r=$q(e),n=$q(t);return null!==r?null!==n?r-n==0?e.length-t.length:r-n:-1:null!==n?1:e<t?-1:1},tE=function(e,t){return e===t?0:e<t?-1:1},mg=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Db(t))},Fk=function(e){if("object"!=typeof e||null===e)return Db(e);var t=[];for(var r in e)t.push(r);t.sort();for(var n="{",i=0;i<t.length;i++)0!==i&&(n+=","),n+=Db(t[i]),n+=":",n+=Fk(e[t[i]]);return n+="}"},Yq=function(e,t){var r=e.length;if(r<=t)return[e];for(var n=[],i=0;i<r;i+=t)i+t>r?n.push(e.substring(i,r)):n.push(e.substring(i,i+t));return n};function Ab(e,t){for(var r in e)e.hasOwnProperty(r)&&t(r,e[r])}var Zq=function(e){cb(!dj(e),"Invalid JSON number");var t,r,n,i,o;0===e?(r=0,n=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(r=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,n=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(r=0,n=Math.round(e/Math.pow(2,-1074))));var a=[];for(o=52;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);for(o=11;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);a.push(t?1:0),a.reverse();var s=a.join(""),l="";for(o=0;o<64;o+=8){var $=parseInt(s.substr(o,8),2).toString(16);1===$.length&&($="0"+$),l+=$}return l.toLowerCase()},uE=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},vE=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},wE=function(e,t){var r="Unknown Error";"too_big"===e?r="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?r="Client doesn't have permission to access the desired data.":"unavailable"===e&&(r="The service is unavailable");var n=new Error(e+" at "+t.path.toString()+": "+r);return n.code=e.toUpperCase(),n},xE=new RegExp("^-?(0*)\\d{1,10}$"),$q=function(e){if(xE.test(e)){var t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},Hf=function(e){try{e()}catch(t){setTimeout(function(){var e=t.stack||"";throw Lb("Exception was thrown by user callback.",e),t},Math.floor(0))}},yE=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},ng=function(e,t){var r=setTimeout(e,t);return"object"==typeof r&&r.unref&&r.unref(),r},db=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var r=0,n=0;n<this.pieces_.length;n++)this.pieces_[n].length>0&&(this.pieces_[r]=this.pieces_[n],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return Object.defineProperty(e,"Empty",{get:function(){return new e("")},enumerable:!1,configurable:!0}),e.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},e.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},e.prototype.popFront=function(){var t=this.pieceNum_;return t<this.pieces_.length&&t++,new e(this.pieces_,t)},e.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e.prototype.toUrlEncodedString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+encodeURIComponent(String(this.pieces_[t])));return e||"/"},e.prototype.slice=function(e){return void 0===e&&(e=0),this.pieces_.slice(this.pieceNum_+e)},e.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var t=[],r=this.pieceNum_;r<this.pieces_.length-1;r++)t.push(this.pieces_[r]);return new e(t,0)},e.prototype.child=function(t){for(var r=[],n=this.pieceNum_;n<this.pieces_.length;n++)r.push(this.pieces_[n]);if(t instanceof e)for(n=t.pieceNum_;n<t.pieces_.length;n++)r.push(t.pieces_[n]);else{var i=t.split("/");for(n=0;n<i.length;n++)i[n].length>0&&r.push(i[n])}return new e(r,0)},e.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},e.relativePath=function(t,r){var n=t.getFront(),i=r.getFront();if(null===n)return r;if(n===i)return e.relativePath(t.popFront(),r.popFront());throw new Error("INTERNAL ERROR: innerPath ("+r+") is not within outerPath ("+t+")")},e.comparePaths=function(e,t){for(var r=e.slice(),n=t.slice(),i=0;i<r.length&&i<n.length;i++){var o=_d(r[i],n[i]);if(0!==o)return o}return r.length===n.length?0:r.length<n.length?-1:1},e.prototype.equals=function(e){if(this.getLength()!==e.getLength())return!1;for(var t=this.pieceNum_,r=e.pieceNum_;t<=this.pieces_.length;t++,r++)if(this.pieces_[t]!==e.pieces_[r])return!1;return!0},e.prototype.contains=function(e){var t=this.pieceNum_,r=e.pieceNum_;if(this.getLength()>e.getLength())return!1;for(;t<this.pieces_.length;){if(this.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0},e}(),zE=function(){function e(e,t){this.errorPrefix_=t,this.parts_=e.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=$g(this.parts_[r]);this.checkValid_()}return Object.defineProperty(e,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!1,configurable:!0}),Object.defineProperty(e,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!1,configurable:!0}),e.prototype.push=function(e){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(e),this.byteLength_+=$g(e),this.checkValid_()},e.prototype.pop=function(){var e=this.parts_.pop();this.byteLength_-=$g(e),this.parts_.length>0&&(this.byteLength_-=1)},e.prototype.checkValid_=function(){if(this.byteLength_>e.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+e.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>e.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+e.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},e.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},e}(),_q="5",av="f",bv="firebaseio.com",cv="websocket",dv="long_polling",Gk=function(){function e(e,t,r,n,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=t,this.namespace=r,this.webSocketOnly=n,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.host=e.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=Zd.get("host:"+e)||this.host}return e.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},e.prototype.updateHost=function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Zd.set("host:"+this.host,this.internalHost))},e.prototype.connectionURL=function(e,t){var r;if(cb("string"==typeof e,"typeof type must == string"),cb("object"==typeof t,"typeof params must == object"),e===cv)r=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(e!==dv)throw new Error("Unknown connection type: "+e);r=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(t.ns=this.namespace);var n=[];return Ab(t,function(e,t){n.push(e+"="+t)}),r+n.join("&")},e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},e}();function AE(e){for(var t="",r=e.split("/"),n=0;n<r.length;n++)if(r[n].length>0){var i=r[n];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}t+="/"+i}return t}function BE(e){var t,r,n={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=Kb(e.split("&")),o=i.next();!o.done;o=i.next()){var a=o.value;if(0!==a.length){var s=a.split("=");2===s.length?n[decodeURIComponent(s[0])]=decodeURIComponent(s[1]):Lb("Invalid query segment '"+a+"' in query '"+e+"'")}}}catch(l){t={error:l}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n}var Hk,ev,Ik=function(e,t){var r=CE(e),n=r.namespace;"firebase.com"===r.domain&&gd(r.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!==n||"localhost"===r.domain||gd("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),r.secure||rE();var i="ws"===r.scheme||"wss"===r.scheme;return{repoInfo:new Gk(r.host,r.secure,n,t,i,"",n!==r.subdomain),path:new db(r.pathString)}},CE=function(e){var t="",r="",n="",i="",o="",a=!0,s="https",l=443;if("string"==typeof e){var $=e.indexOf("//");$>=0&&(s=e.substring(0,$-1),e=e.substring($+2));var h=e.indexOf("/");-1===h&&(h=e.length);var u=e.indexOf("?");-1===u&&(u=e.length),t=e.substring(0,Math.min(h,u)),h<u&&(i=AE(e.substring(h,u)));var c=BE(e.substring(Math.min(e.length,u)));($=t.indexOf(":"))>=0?(a="https"===s||"wss"===s,l=parseInt(t.substring($+1),10)):$=t.length;var p=t.slice(0,$);if("localhost"===p.toLowerCase())r="localhost";else if(p.split(".").length<=2)r=p;else{var d=t.indexOf(".");n=t.substring(0,d).toLowerCase(),r=t.substring(d+1),o=n}"ns"in c&&(o=c.ns)}return{host:t,port:l,domain:r,subdomain:n,secure:a,scheme:s,pathString:i,namespace:o}},DE=/[\[\].#$\/\u0000-\u001F\u007F]/,EE=/[\[\].#$\u0000-\u001F\u007F]/,Jk=10485760,ej=function(e){return"string"==typeof e&&0!==e.length&&!DE.test(e)},fv=function(e){return"string"==typeof e&&0!==e.length&&!EE.test(e)},FE=function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),fv(e)},og=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!dj(e)||e&&"object"==typeof e&&Pb(e,".sv")},Fd=function(e,t,r,n,i){i&&void 0===r||pg(Wb(e,t,i),r,n)},pg=function(e,t,r){var n=r instanceof db?new zE(r,e):r;if(void 0===t)throw new Error(e+"contains undefined "+n.toErrorString());if("function"==typeof t)throw new Error(e+"contains a function "+n.toErrorString()+" with contents = "+t.toString());if(dj(t))throw new Error(e+"contains "+t.toString()+" "+n.toErrorString());if("string"==typeof t&&t.length>Jk/3&&$g(t)>Jk)throw new Error(e+"contains a string greater than "+Jk+" utf8 bytes "+n.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,o=!1;if(Ab(t,function(t,r){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!ej(t)))throw new Error(e+" contains an invalid key ("+t+") "+n.toErrorString()+".  Keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"");n.push(t),pg(e,r,n),n.pop()}),i&&o)throw new Error(e+" contains \".value\" child "+n.toErrorString()+" in addition to actual children.")}},GE=function(e,t){var r,n;for(r=0;r<t.length;r++)for(var i=(n=t[r]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!ej(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+n.toString()+". Keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\"");t.sort(db.comparePaths);var a=null;for(r=0;r<t.length;r++){if(n=t[r],null!==a&&a.contains(n))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+n.toString());a=n}},gv=function(e,t,r,n,i){if(!i||void 0!==r){var o=Wb(e,t,i);if(!r||"object"!=typeof r||Array.isArray(r))throw new Error(o+" must be an object containing the children to replace.");var a=[];Ab(r,function(e,t){var r=new db(e);if(pg(o,t,n.child(r)),".priority"===r.getBack()&&!og(t))throw new Error(o+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)}),GE(o,a)}},Kk=function(e,t,r,n){if(!n||void 0!==r){if(dj(r))throw new Error(Wb(e,t,n)+"is "+r.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!og(r))throw new Error(Wb(e,t,n)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Lk=function(e,t,r,n){if(!n||void 0!==r)switch(r){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Wb(e,t,n)+"must be a valid event type = \"value\", \"child_added\", \"child_removed\", \"child_changed\", or \"child_moved\".");}},Mk=function(e,t,r,n){if(!(n&&void 0===r||ej(r)))throw new Error(Wb(e,t,n)+"was an invalid key = \""+r+"\".  Firebase keys must be non-empty strings and can't contain \".\", \"#\", \"$\", \"/\", \"[\", or \"]\").")},qg=function(e,t,r,n){if(!(n&&void 0===r||fv(r)))throw new Error(Wb(e,t,n)+"was an invalid path = \""+r+"\". Paths must be non-empty strings and can't contain \".\", \"#\", \"$\", \"[\", or \"]\"")},HE=function(e,t,r,n){r&&(r=r.replace(/^\/*\.info(\/|$)/,"/")),qg(e,t,r,n)},Xb=function(e,t){if(".info"===t.getFront())throw new Error(e+" failed = Can't modify data under /.info/")},hv=function(e,t,r){var n=r.path.toString();if("string"!=typeof r.repoInfo.host||0===r.repoInfo.host.length||!ej(r.repoInfo.namespace)&&"localhost"!==r.repoInfo.host.split(":")[0]||0!==n.length&&!FE(n))throw new Error(Wb(e,t,!1)+"must be a valid firebase URL and the path can't contain \".\", \"#\", \"$\", \"[\", or \"]\".")},IE=function(e,t,r,n){if((!n||void 0!==r)&&"boolean"!=typeof r)throw new Error(Wb(e,t,n)+"must be a boolean.")},JE=function(){function e(e,t){this.repo_=e,this.path_=t}return e.prototype.cancel=function(e){fb("OnDisconnect.cancel",0,1,arguments.length),Eb("OnDisconnect.cancel",1,e,!0);var t=new Vb;return this.repo_.onDisconnectCancel(this.path_,t.wrapCallback(e)),t.promise},e.prototype.remove=function(e){fb("OnDisconnect.remove",0,1,arguments.length),Xb("OnDisconnect.remove",this.path_),Eb("OnDisconnect.remove",1,e,!0);var t=new Vb;return this.repo_.onDisconnectSet(this.path_,null,t.wrapCallback(e)),t.promise},e.prototype.set=function(e,t){fb("OnDisconnect.set",1,2,arguments.length),Xb("OnDisconnect.set",this.path_),Fd("OnDisconnect.set",1,e,this.path_,!1),Eb("OnDisconnect.set",2,t,!0);var r=new Vb;return this.repo_.onDisconnectSet(this.path_,e,r.wrapCallback(t)),r.promise},e.prototype.setWithPriority=function(e,t,r){fb("OnDisconnect.setWithPriority",2,3,arguments.length),Xb("OnDisconnect.setWithPriority",this.path_),Fd("OnDisconnect.setWithPriority",1,e,this.path_,!1),Kk("OnDisconnect.setWithPriority",2,t,!1),Eb("OnDisconnect.setWithPriority",3,r,!0);var n=new Vb;return this.repo_.onDisconnectSetWithPriority(this.path_,e,t,n.wrapCallback(r)),n.promise},e.prototype.update=function(e,t){if(fb("OnDisconnect.update",1,2,arguments.length),Xb("OnDisconnect.update",this.path_),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,Lb("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}gv("OnDisconnect.update",1,e,this.path_,!1),Eb("OnDisconnect.update",2,t,!0);var i=new Vb;return this.repo_.onDisconnectUpdate(this.path_,e,i.wrapCallback(t)),i.promise},e}(),KE=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return fb("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),LE=function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,r=[];return function(n){var i,o=n===t;t=n;var a=new Array(8);for(i=7;i>=0;i--)a[i]=e.charAt(n%64),n=Math.floor(n/64);cb(0===n,"Cannot push at time == 0");var s=a.join("");if(o){for(i=11;i>=0&&63===r[i];i--)r[i]=0;r[i]++}else for(i=0;i<12;i++)r[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)s+=e.charAt(r[i]);return cb(20===s.length,"nextPushId: Length should be 20."),s}}(),lb=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,r){return new e(t,r)},e}(),fj=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var r=new lb($d,e),n=new lb($d,t);return 0!==this.compare(r,n)},e.prototype.minPost=function(){return lb.MIN},e}(),iv=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zb(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return Hk},set:function(e){Hk=e},enumerable:!1,configurable:!0}),t.prototype.compare=function(e,t){return _d(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Cf("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return lb.MIN},t.prototype.maxPost=function(){return new lb(Ed,Hk)},t.prototype.makePost=function(e,t){return cb("string"==typeof e,"KeyIndex indexValue must always be a string."),new lb(e,Hk)},t.prototype.toString=function(){return".key"},t}(fj),Gd=new iv;function ME(e){ev=e}var NE,OE,PE,jv=function(e){return"number"==typeof e?"number:"+Zq(e):"string:"+e},kv=function(e){if(e.isLeafNode()){var t=e.val();cb("string"==typeof t||"number"==typeof t||"object"==typeof t&&Pb(t,".sv"),"Priority must be a string or number.")}else cb(e===ev||e.isEmpty(),"priority of unexpected type.");cb(e===ev||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},If=function(){function e(t,r){void 0===r&&(r=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=r,this.lazyHash_=null,cb(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),kv(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return NE},set:function(e){NE=e},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,r){var n=t.getFront();return null===n?r:r.isEmpty()&&".priority"!==n?this:(cb(".priority"!==n||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(n,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),r)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+jv(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?Zq(this.value_):this.value_,this.lazyHash_=Wq(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(cb(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var r=typeof t.value_,n=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(r),o=e.VALUE_TYPE_ORDER.indexOf(n);return cb(i>=0,"Unknown leaf type: "+r),cb(o>=0,"Unknown leaf type: "+n),i===o?"object"===n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();function QE(e){OE=e}function RE(e){PE=e}var SE,gj,TE=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zb(t,e),t.prototype.compare=function(e,t){var r=e.node.getPriority(),n=t.node.getPriority(),i=r.compareTo(n);return 0===i?_d(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return lb.MIN},t.prototype.maxPost=function(){return new lb(Ed,new If("[PRIORITY-POST]",PE))},t.prototype.makePost=function(e,t){var r=OE(e);return new lb(t,new If("[PRIORITY-POST]",r))},t.prototype.toString=function(){return".priority"},t}(fj),qb=new TE,hj=function(){function e(e,t,r,n,i){void 0===i&&(i=null),this.isReverse_=n,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?r(e.key,t):1,n&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),ad=function(){function e(t,r,n,i,o){this.key=t,this.value=r,this.color=null!=n?n:e.RED,this.left=null!=i?i:pd.EMPTY_NODE,this.right=null!=o?o:pd.EMPTY_NODE}return e.prototype.copy=function(t,r,n,i,o){return new e(null!=t?t:this.key,null!=r?r:this.value,null!=n?n:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,r){var n=this,i=r(e,n.key);return(n=i<0?n.copy(null,null,null,n.left.insert(e,t,r),null):0===i?n.copy(null,t,null,null,null):n.copy(null,null,null,null,n.right.insert(e,t,r))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return pd.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var r,n;if(t(e,(r=this).key)<0)r.left.isEmpty()||r.left.isRed_()||r.left.left.isRed_()||(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),r.right.isEmpty()||r.right.isRed_()||r.right.left.isRed_()||(r=r.moveRedRight_()),0===t(e,r.key)){if(r.right.isEmpty())return pd.EMPTY_NODE;n=r.right.min_(),r=r.copy(n.key,n.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),UE=function(){function e(){}return e.prototype.copy=function(e,t,r,n,i){return this},e.prototype.insert=function(e,t,r){return new ad(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),pd=function(){function e(t,r){void 0===r&&(r=e.EMPTY_NODE),this.comparator_=t,this.root_=r}return e.prototype.insert=function(t,r){return new e(this.comparator_,this.root_.insert(t,r,this.comparator_).copy(null,null,ad.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,ad.BLACK,null,null))},e.prototype.get=function(e){for(var t,r=this.root_;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key)))return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,r=this.root_,n=null;!r.isEmpty();){if(0===(t=this.comparator_(e,r.key))){if(r.left.isEmpty())return n?n.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(n=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new hj(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new hj(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new hj(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new hj(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new UE,e}(),VE=Math.log(2),WE=function(){function e(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/VE,10)),this.current_=this.count-1;var r,n=(r=this.count,parseInt(Array(r+1).join("1"),2));this.bits_=e+1&n}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),ij=function(e,t,r,n){e.sort(t);var i=function(t,n){var o,a,s=n-t;if(0===s)return null;if(1===s)return o=e[t],a=r?r(o):o,new ad(a,o.node,ad.BLACK,null,null);var l=parseInt(s/2,10)+t,$=i(t,l),h=i(l+1,n);return o=e[l],a=r?r(o):o,new ad(a,o.node,ad.BLACK,$,h)},o=function(t){for(var n=null,o=null,a=e.length,s=function(t,n){var o=a-t,s=a;a-=t;var $=i(o+1,s),h=e[o],u=r?r(h):h;l(new ad(u,h.node,n,null,$))},l=function(e){n?(n.left=e,n=e):(o=e,n=e)},$=0;$<t.count;++$){var h=t.nextBitIsOne(),u=Math.pow(2,t.count-($+1));h?s(u,ad.BLACK):(s(u,ad.BLACK),s(u,ad.RED))}return o}(new WE(e.length));return new pd(n||t,o)},Jf={},jj=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return cb(Jf&&qb,"ChildrenNode.ts has not been loaded"),SE=SE||new e({".priority":Jf},{".priority":qb})},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=$b(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof pd?t:null},e.prototype.hasIndex=function(e){return Pb(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,r){cb(t!==Gd,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,i=[],o=!1,a=r.getIterator(lb.Wrap),s=a.getNext();s;)o=o||t.isDefinedOn(s.node),i.push(s),s=a.getNext();n=o?ij(i,t.getCompare()):Jf;var l=t.toString(),$=Xd({},this.indexSet_);$[l]=t;var h=Xd({},this.indexes_);return h[l]=n,new e(h,$)},e.prototype.addToIndexes=function(t,r){var n=this;return new e(Zg(this.indexes_,function(e,i){var o=$b(n.indexSet_,i);if(cb(o,"Missing index implementation for "+i),e===Jf){if(o.isDefinedOn(t.node)){for(var a=[],s=r.getIterator(lb.Wrap),l=s.getNext();l;)l.name!==t.name&&a.push(l),l=s.getNext();return a.push(t),ij(a,o.getCompare())}return Jf}var $=r.get(t.name),h=e;return $&&(h=h.remove(new lb(t.name,$))),h.insert(t,t.node)}),this.indexSet_)},e.prototype.removeFromIndexes=function(t,r){return new e(Zg(this.indexes_,function(e){if(e===Jf)return e;var n=r.get(t.name);return n?e.remove(new lb(t.name,n)):e}),this.indexSet_)},e}();function XE(e,t){return _d(e.name,t.name)}function Nk(e,t){return _d(e,t)}var hb=function(){function e(e,t,r){this.children_=e,this.priorityNode_=t,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&kv(this.priorityNode_),this.children_.isEmpty()&&cb(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return gj||(gj=new e(new pd(Nk),null,jj.Default))},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||gj},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?gj:t},e.prototype.getChild=function(e){var t=e.getFront();return null===t?this:this.getImmediateChild(t).getChild(e.popFront())},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,r){if(cb(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);var n=new lb(t,r),i=void 0,o=void 0;r.isEmpty()?(i=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(n,this.children_)):(i=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(n,this.children_));var a=i.isEmpty()?gj:this.priorityNode_;return new e(i,a,o)},e.prototype.updateChild=function(e,t){var r=e.getFront();if(null===r)return t;cb(".priority"!==e.getFront()||1===e.getLength(),".priority must be the last token in a path");var n=this.getImmediateChild(r).updateChild(e.popFront(),t);return this.updateImmediateChild(r,n)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var r={},n=0,i=0,o=!0;if(this.forEachChild(qb,function(a,s){r[a]=s.val(t),n++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!t&&o&&i<2*n){var a=[];for(var s in r)a[s]=r[s];return a}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+jv(this.getPriority().val())+":"),this.forEachChild(qb,function(t,r){var n=r.hash();""!==n&&(e+=":"+t+":"+n)}),this.lazyHash_=""===e?"":Wq(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,r){var n=this.resolveIndex_(r);if(n){var i=n.getPredecessorKey(new lb(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.minKey();return r&&r.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new lb(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var r=t.maxKey();return r&&r.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new lb(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var r=this.resolveIndex_(e);return r?r.inorderTraversal(function(e){return t(e.name,e.node)}):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getIteratorFrom(e,function(e){return e});for(var n=this.children_.getIteratorFrom(e.name,lb.Wrap),i=n.peek();null!=i&&t.compare(i,e)<0;)n.getNext(),i=n.peek();return n},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var r=this.resolveIndex_(t);if(r)return r.getReverseIteratorFrom(e,function(e){return e});for(var n=this.children_.getReverseIteratorFrom(e.name,lb.Wrap),i=n.peek();null!=i&&t.compare(i,e)>0;)n.getNext(),i=n.peek();return n},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===rg?-1:0},e.prototype.withIndex=function(t){if(t===Gd||this.indexMap_.hasIndex(t))return this;var r=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,r)},e.prototype.isIndexed=function(e){return e===Gd||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var r=this.getIterator(qb),n=t.getIterator(qb),i=r.getNext(),o=n.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=r.getNext(),o=n.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===Gd?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),YE=function(e){function t(){return e.call(this,new pd(Nk),hb.EMPTY_NODE,jj.Default)||this}return Zb(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return hb.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(hb),rg=new YE;Object.defineProperties(lb,{MIN:{value:new lb($d,hb.EMPTY_NODE)},MAX:{value:new lb(Ed,rg)}}),iv.__EMPTY_NODE=hb.EMPTY_NODE,If.__childrenNodeConstructor=hb,ME(rg),RE(rg);var ZE=!0;function yb(e,t){if(void 0===t&&(t=null),null===e)return hb.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),cb(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e)return new If(e,yb(t));if(e instanceof Array||!ZE){var r=hb.EMPTY_NODE;return Ab(e,function(t,n){if(Pb(e,t)&&"."!==t.substring(0,1)){var i=yb(n);!i.isLeafNode()&&i.isEmpty()||(r=r.updateImmediateChild(t,i))}}),r.updatePriority(yb(t))}var n=[],i=!1;if(Ab(e,function(e,t){if("."!==e.substring(0,1)){var r=yb(t);r.isEmpty()||(i=i||!r.getPriority().isEmpty(),n.push(new lb(e,r)))}}),0===n.length)return hb.EMPTY_NODE;var o=ij(n,XE,function(e){return e.name},Nk);if(i){var a=ij(n,qb.getCompare());return new hb(o,yb(t),new jj({".priority":a},{".priority":qb}))}return new hb(o,yb(t),jj.Default)}QE(yb);var lv,$E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Zb(t,e),t.prototype.compare=function(e,t){var r=e.node.compareTo(t.node);return 0===r?_d(e.name,t.name):r},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return lb.MIN},t.prototype.maxPost=function(){return lb.MAX},t.prototype.makePost=function(e,t){var r=yb(e);return new lb(t,r)},t.prototype.toString=function(){return".value"},t}(fj),Ok=new $E,Pk=function(e){function t(t){var r=e.call(this)||this;return r.indexPath_=t,cb(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),r}return Zb(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var r=this.extractChild(e.node),n=this.extractChild(t.node),i=r.compareTo(n);return 0===i?_d(e.name,t.name):i},t.prototype.makePost=function(e,t){var r=yb(e),n=hb.EMPTY_NODE.updateChild(this.indexPath_,r);return new lb(t,n)},t.prototype.maxPost=function(){var e=hb.EMPTY_NODE.updateChild(this.indexPath_,rg);return new lb(Ed,e)},t.prototype.toString=function(){return this.indexPath_.slice().join("/")},t}(fj),Kf=function(){function e(e,t,r){this.node_=e,this.ref_=t,this.index_=r}return e.prototype.val=function(){return fb("DataSnapshot.val",0,0,arguments.length),this.node_.val()},e.prototype.exportVal=function(){return fb("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},e.prototype.toJSON=function(){return fb("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},e.prototype.exists=function(){return fb("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},e.prototype.child=function(t){fb("DataSnapshot.child",0,1,arguments.length),t=String(t),qg("DataSnapshot.child",1,t,!1);var r=new db(t),n=this.ref_.child(r);return new e(this.node_.getChild(r),n,qb)},e.prototype.hasChild=function(e){fb("DataSnapshot.hasChild",1,1,arguments.length),qg("DataSnapshot.hasChild",1,e,!1);var t=new db(e);return!this.node_.getChild(t).isEmpty()},e.prototype.getPriority=function(){return fb("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},e.prototype.forEach=function(t){var r=this;return fb("DataSnapshot.forEach",1,1,arguments.length),Eb("DataSnapshot.forEach",1,t,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(n,i){return t(new e(i,r.ref_.child(n),qb))})},e.prototype.hasChildren=function(){return fb("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(e.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!1,configurable:!0}),e.prototype.numChildren=function(){return fb("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},e.prototype.getRef=function(){return fb("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),mv=function(){function e(e,t,r,n){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=n}return e.prototype.getPath=function(){var e=this.snapshot.getRef();return"value"===this.eventType?e.path:e.getParent().path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Db(this.snapshot.exportVal())},e}(),nv=function(){function e(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),ov=function(){function e(e,t,r){this.callback_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var r=t.getQueryParams().getIndex();return new mv("value",this,new Kf(e.snapshotNode,t.getRef(),r))},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){cb(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callback_;return function(){n.call(t,e.snapshot)}},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new nv(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},e.prototype.hasAnyCallback=function(){return null!==this.callback_},e}(),pv=function(){function e(e,t,r){this.callbacks_=e,this.cancelCallback_=t,this.context_=r}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,Pb(this.callbacks_,t)},e.prototype.createCancelEvent=function(e,t){return this.cancelCallback_?new nv(this,e,t):null},e.prototype.createEvent=function(e,t){cb(null!=e.childName,"Child events should have a childName.");var r=t.getRef().child(e.childName),n=t.getQueryParams().getIndex();return new mv(e.type,this,new Kf(e.snapshotNode,r,n),e.prevName)},e.prototype.getEventRunner=function(e){var t=this.context_;if("cancel"===e.getEventType()){cb(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var r=this.cancelCallback_;return function(){r.call(t,e.error)}}var n=this.callbacks_[e.eventType];return function(){n.call(t,e.snapshot,e.prevName)}},e.prototype.matches=function(t){var r=this;if(t instanceof e){if(!this.callbacks_||!t.callbacks_)return!0;if(this.context_===t.context_){var n=Object.keys(t.callbacks_),i=Object.keys(this.callbacks_),o=n.length;if(o===i.length){if(1===o){var a=n[0],s=i[0];return!(s!==a||t.callbacks_[a]&&this.callbacks_[s]&&t.callbacks_[a]!==this.callbacks_[s])}return i.every(function(e){return t.callbacks_[e]===r.callbacks_[e]})}}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks_},e}(),Qk=function(){function e(e,t,r,n){this.repo=e,this.path=t,this.queryParams_=r,this.orderByCalled_=n}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return cb(lv,"Reference.ts has not been loaded"),lv},set:function(e){lv=e},enumerable:!1,configurable:!0}),e.validateQueryEndpoints_=function(e){var t=null,r=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(r=e.getIndexEndValue()),e.getIndex()===Gd){var n="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==$d)throw new Error(n);if("string"!=typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==Ed)throw new Error(n);if("string"!=typeof r)throw new Error(i)}}else if(e.getIndex()===qb){if(null!=t&&!og(t)||null!=r&&!og(r))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(cb(e.getIndex()instanceof Pk||e.getIndex()===Ok,"unknown index type."),null!=t&&"object"==typeof t||null!=r&&"object"==typeof r)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},e.validateLimit_=function(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},e.prototype.validateNoPreviousOrderByCall_=function(e){if(!0===this.orderByCalled_)throw new Error(e+": You can't combine multiple orderBy calls.")},e.prototype.getQueryParams=function(){return this.queryParams_},e.prototype.getRef=function(){return fb("Query.ref",0,0,arguments.length),new e.__referenceConstructor(this.repo,this.path)},e.prototype.on=function(t,r,n,i){fb("Query.on",2,4,arguments.length),Lk("Query.on",1,t,!1),Eb("Query.on",2,r,!1);var o=e.getCancelAndContextArgs_("Query.on",n,i);if("value"===t)this.onValueEvent(r,o.cancel,o.context);else{var a={};a[t]=r,this.onChildEvent(a,o.cancel,o.context)}return r},e.prototype.onValueEvent=function(e,t,r){var n=new ov(e,t||null,r||null);this.repo.addEventCallbackForQuery(this,n)},e.prototype.onChildEvent=function(e,t,r){var n=new pv(e,t,r);this.repo.addEventCallbackForQuery(this,n)},e.prototype.off=function(e,t,r){fb("Query.off",0,3,arguments.length),Lk("Query.off",1,e,!0),Eb("Query.off",2,t,!0),Lq("Query.off",3,r,!0);var n=null,i=null;"value"===e?n=new ov(t||null,null,r||null):e&&(t&&((i={})[e]=t),n=new pv(i,null,r||null));this.repo.removeEventCallbackForQuery(this,n)},e.prototype.once=function(t,r,n,i){var o=this;fb("Query.once",1,4,arguments.length),Lk("Query.once",1,t,!1),Eb("Query.once",2,r,!0);var a=e.getCancelAndContextArgs_("Query.once",n,i),s=!0,l=new Vb;l.promise.catch(function(){});var $=function(e){s&&(s=!1,o.off(t,$),r&&r.bind(a.context)(e),l.resolve(e))};return this.on(t,$,function(e){o.off(t,$),a.cancel&&a.cancel.bind(a.context)(e),l.reject(e)}),l.promise},e.prototype.limitToFirst=function(t){if(fb("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},e.prototype.limitToLast=function(t){if(fb("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new e(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)},e.prototype.orderByChild=function(t){if(fb("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error("Query.orderByChild: \"$key\" is invalid.  Use Query.orderByKey() instead.");if("$priority"===t)throw new Error("Query.orderByChild: \"$priority\" is invalid.  Use Query.orderByPriority() instead.");if("$value"===t)throw new Error("Query.orderByChild: \"$value\" is invalid.  Use Query.orderByValue() instead.");qg("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var r=new db(t);if(r.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var n=new Pk(r),i=this.queryParams_.orderBy(n);return e.validateQueryEndpoints_(i),new e(this.repo,this.path,i,!0)},e.prototype.orderByKey=function(){fb("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(Gd);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByPriority=function(){fb("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(qb);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.orderByValue=function(){fb("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(Ok);return e.validateQueryEndpoints_(t),new e(this.repo,this.path,t,!0)},e.prototype.startAt=function(t,r){void 0===t&&(t=null),fb("Query.startAt",0,2,arguments.length),Fd("Query.startAt",1,t,this.path,!0),Mk("Query.startAt",2,r,!0);var n=this.queryParams_.startAt(t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(t=null,r=null),new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.endAt=function(t,r){void 0===t&&(t=null),fb("Query.endAt",0,2,arguments.length),Fd("Query.endAt",1,t,this.path,!0),Mk("Query.endAt",2,r,!0);var n=this.queryParams_.endAt(t,r);if(e.validateLimit_(n),e.validateQueryEndpoints_(n),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new e(this.repo,this.path,n,this.orderByCalled_)},e.prototype.equalTo=function(e,t){if(fb("Query.equalTo",1,2,arguments.length),Fd("Query.equalTo",1,e,this.path,!1),Mk("Query.equalTo",2,t,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(e,t).endAt(e,t)},e.prototype.toString=function(){return fb("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},e.prototype.toJSON=function(){return fb("Query.toJSON",0,1,arguments.length),this.toString()},e.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},e.prototype.queryIdentifier=function(){var e=this.queryObject(),t=Fk(e);return"{}"===t?"default":t},e.prototype.isEqual=function(t){if(fb("Query.isEqual",1,1,arguments.length),!(t instanceof e)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var r=this.repo===t.repo,n=this.path.equals(t.path),i=this.queryIdentifier()===t.queryIdentifier();return r&&n&&i},e.getCancelAndContextArgs_=function(e,t,r){var n={cancel:null,context:null};if(t&&r)n.cancel=t,Eb(e,3,n.cancel,!0),n.context=r,Lq(e,4,n.context,!0);else if(t)if("object"==typeof t&&null!==t)n.context=t;else{if("function"!=typeof t)throw new Error(Wb(e,3,!0)+" must either be a cancel callback or a context object.");n.cancel=t}return n},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),_E=function(){function e(e){this.node_=e}return e.prototype.getImmediateChild=function(t){return new e(this.node_.getImmediateChild(t))},e.prototype.node=function(){return this.node_},e}(),aF=function(){function e(e,t){this.syncTree_=e,this.path_=t}return e.prototype.getImmediateChild=function(t){var r=this.path_.child(t);return new e(this.syncTree_,r)},e.prototype.node=function(){return this.syncTree_.calcCompleteEventCache(this.path_)},e}(),bF=function(e){return(e=e||{}).timestamp=e.timestamp||new Date().getTime(),e},qv=function(e,t,r){return e&&"object"==typeof e?(cb(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"]?cF(e[".sv"],t,r):"object"==typeof e[".sv"]?dF(e[".sv"],t):void cb(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},cF=function(e,t,r){switch(e){case"timestamp":return r.timestamp;default:cb(!1,"Unexpected server value: "+e);}},dF=function(e,t,r){e.hasOwnProperty("increment")||cb(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var n=e.increment;"number"!=typeof n&&cb(!1,"Unexpected increment value: "+n);var i=t.node();if(cb(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return n;var o=i.getValue();return"number"!=typeof o?n:o+n},rv=function(e,t,r,n){return Sk(t,new aF(r,e),n)},Rk=function(e,t,r){return Sk(e,new _E(t),r)};function Sk(e,t,r){var n,i=e.getPriority().val(),o=qv(i,t.getImmediateChild(".priority"),r);if(e.isLeafNode()){var a=e,s=qv(a.getValue(),t,r);return s!==a.getValue()||o!==a.getPriority().val()?new If(s,yb(o)):e}var l=e;return n=l,o!==l.getPriority().val()&&(n=n.updatePriority(new If(o))),l.forEachChild(qb,function(e,i){var o=Sk(i,t.getImmediateChild(e),r);o!==i&&(n=n.updateImmediateChild(e,o))}),n}var hd,Tk=function(){function e(){this.value=null,this.children=new Map}return e.prototype.find=function(e){if(null!=this.value)return this.value.getChild(e);if(!e.isEmpty()&&this.children.size>0){var t=e.getFront();return e=e.popFront(),this.children.has(t)?this.children.get(t).find(e):null}return null},e.prototype.remember=function(t,r){if(t.isEmpty())this.value=r,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(t,r);else{var n=t.getFront();this.children.has(n)||this.children.set(n,new e);var i=this.children.get(n);t=t.popFront(),i.remember(t,r)}},e.prototype.forget=function(e){if(e.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var t=this.value;this.value=null;var r=this;return t.forEachChild(qb,function(e,t){r.remember(new db(e),t)}),this.forget(e)}if(this.children.size>0){var n=e.getFront();if(e=e.popFront(),this.children.has(n))this.children.get(n).forget(e)&&this.children.delete(n);return 0===this.children.size}return!0},e.prototype.forEachTree=function(e,t){null!==this.value?t(e,this.value):this.forEachChild(function(r,n){var i=new db(e.toString()+"/"+r);n.forEachTree(i,t)})},e.prototype.forEachChild=function(e){this.children.forEach(function(t,r){e(r,t)})},e}();!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(hd||(hd={}));var sv,Uk,qd=function(){function e(e,t,r,n){this.fromUser=e,this.fromServer=t,this.queryId=r,this.tagged=n,cb(!n||t,"Tagged queries must be from server.")}return e.User=new e(!0,!1,null,!1),e.Server=new e(!1,!0,null,!1),e.forServerTaggedQuery=function(t){return new e(!1,!0,t,!0)},e}(),eF=function(){function e(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=hd.ACK_USER_WRITE,this.source=qd.User}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return cb(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var r=this.affectedTree.subtree(new db(t));return new e(db.Empty,r,this.revert)}return cb(this.path.getFront()===t,"operationForChild called for unrelated child."),new e(this.path.popFront(),this.affectedTree,this.revert)},e}(),fF=function(){return sv||(sv=new pd(tE)),sv},Rb=function(){function e(e,t){void 0===t&&(t=fF()),this.value=e,this.children=t}return e.fromObject=function(t){var r=e.Empty;return Ab(t,function(e,t){r=r.set(new db(e),t)}),r},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:db.Empty,value:this.value};if(e.isEmpty())return null;var r=e.getFront(),n=this.children.get(r);if(null!==n){var i=n.findRootMostMatchingPathAndValue(e.popFront(),t);return null!=i?{path:new db(r).child(i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},e.prototype.subtree=function(t){if(t.isEmpty())return this;var r=t.getFront(),n=this.children.get(r);return null!==n?n.subtree(t.popFront()):e.Empty},e.prototype.set=function(t,r){if(t.isEmpty())return new e(r,this.children);var n=t.getFront(),i=(this.children.get(n)||e.Empty).set(t.popFront(),r),o=this.children.insert(n,i);return new e(this.value,o)},e.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?e.Empty:new e(null,this.children);var r=t.getFront(),n=this.children.get(r);if(n){var i=n.remove(t.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),null===this.value&&o.isEmpty()?e.Empty:new e(this.value,o)}return this},e.prototype.get=function(e){if(e.isEmpty())return this.value;var t=e.getFront(),r=this.children.get(t);return r?r.get(e.popFront()):null},e.prototype.setTree=function(t,r){if(t.isEmpty())return r;var n=t.getFront(),i=(this.children.get(n)||e.Empty).setTree(t.popFront(),r),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),new e(this.value,o)},e.prototype.fold=function(e){return this.fold_(db.Empty,e)},e.prototype.fold_=function(e,t){var r={};return this.children.inorderTraversal(function(n,i){r[n]=i.fold_(e.child(n),t)}),t(e,this.value,r)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,db.Empty,t)},e.prototype.findOnPath_=function(e,t,r){var n=!!this.value&&r(t,this.value);if(n)return n;if(e.isEmpty())return null;var i=e.getFront(),o=this.children.get(i);return o?o.findOnPath_(e.popFront(),t.child(i),r):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,db.Empty,t)},e.prototype.foreachOnPath_=function(t,r,n){if(t.isEmpty())return this;this.value&&n(r,this.value);var i=t.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(t.popFront(),r.child(i),n):e.Empty},e.prototype.foreach=function(e){this.foreach_(db.Empty,e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal(function(r,n){n.foreach_(e.child(r),t)}),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal(function(t,r){r.value&&e(t,r.value)})},e.Empty=new e(null),e}(),tv=function(){function e(e,t){this.source=e,this.path=t,this.type=hd.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,db.Empty):new e(this.source,this.path.popFront())},e}(),kj=function(){function e(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=hd.OVERWRITE}return e.prototype.operationForChild=function(t){return this.path.isEmpty()?new e(this.source,db.Empty,this.snap.getImmediateChild(t)):new e(this.source,this.path.popFront(),this.snap)},e}(),Vk=function(){function e(e,t,r){this.source=e,this.path=t,this.children=r,this.type=hd.MERGE}return e.prototype.operationForChild=function(t){if(this.path.isEmpty()){var r=this.children.subtree(new db(t));return r.isEmpty()?null:r.value?new kj(this.source,db.Empty,r.value):new e(this.source,db.Empty,r)}return cb(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,this.path.popFront(),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),rd=function(){function e(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(e.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var t=e.getFront();return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),uv=function(){function e(e,t){this.eventCache_=e,this.serverCache_=t}return e.prototype.updateEventSnap=function(t,r,n){return new e(new rd(t,r,n),this.serverCache_)},e.prototype.updateServerSnap=function(t,r,n){return new e(this.eventCache_,new rd(t,r,n))},e.prototype.getEventCache=function(){return this.eventCache_},e.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},e.prototype.getServerCache=function(){return this.serverCache_},e.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},e.Empty=new e(new rd(hb.EMPTY_NODE,!1,!1),new rd(hb.EMPTY_NODE,!1,!1)),e}(),ib=function(){function e(e,t,r,n,i){this.type=e,this.snapshotNode=t,this.childName=r,this.oldSnap=n,this.prevName=i}return e.valueChange=function(t){return new e(e.VALUE,t)},e.childAddedChange=function(t,r){return new e(e.CHILD_ADDED,r,t)},e.childRemovedChange=function(t,r){return new e(e.CHILD_REMOVED,r,t)},e.childChangedChange=function(t,r,n){return new e(e.CHILD_CHANGED,r,t,n)},e.childMovedChange=function(t,r){return new e(e.CHILD_MOVED,r,t)},e.CHILD_ADDED="child_added",e.CHILD_REMOVED="child_removed",e.CHILD_CHANGED="child_changed",e.CHILD_MOVED="child_moved",e.VALUE="value",e}(),Wk=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,r,n,i,o){cb(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=e.getImmediateChild(t);return a.getChild(n).equals(r.getChild(n))&&a.isEmpty()===r.isEmpty()?e:(null!=o&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(ib.childRemovedChange(t,a)):cb(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ib.childAddedChange(t,r)):o.trackChildChange(ib.childChangedChange(t,r,a))),e.isLeafNode()&&r.isEmpty()?e:e.updateImmediateChild(t,r).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(qb,function(e,n){t.hasChild(e)||r.trackChildChange(ib.childRemovedChange(e,n))}),t.isLeafNode()||t.forEachChild(qb,function(t,n){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(n)||r.trackChildChange(ib.childChangedChange(t,n,i))}else r.trackChildChange(ib.childAddedChange(t,n))})),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?hb.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),gF=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,r=e.childName;cb(t===ib.CHILD_ADDED||t===ib.CHILD_CHANGED||t===ib.CHILD_REMOVED,"Only child changes supported for tracking"),cb(".priority"!==r,"Only non-priority child changes can be tracked.");var n=this.changeMap.get(r);if(n){var i=n.type;if(t===ib.CHILD_ADDED&&i===ib.CHILD_REMOVED)this.changeMap.set(r,ib.childChangedChange(r,e.snapshotNode,n.snapshotNode));else if(t===ib.CHILD_REMOVED&&i===ib.CHILD_ADDED)this.changeMap.delete(r);else if(t===ib.CHILD_REMOVED&&i===ib.CHILD_CHANGED)this.changeMap.set(r,ib.childRemovedChange(r,n.oldSnap));else if(t===ib.CHILD_CHANGED&&i===ib.CHILD_ADDED)this.changeMap.set(r,ib.childAddedChange(r,e.snapshotNode));else{if(t!==ib.CHILD_CHANGED||i!==ib.CHILD_CHANGED)throw Cf("Illegal combination of changes: "+e+" occurred after "+n);this.changeMap.set(r,ib.childChangedChange(r,e.snapshotNode,n.oldSnap))}}else this.changeMap.set(r,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),hF=function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,r){return null},e}(),vv=new hF,Xk=function(){function e(e,t,r){void 0===r&&(r=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.getEventCache();if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var r=null!=this.optCompleteServerCache_?new rd(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(e,r)},e.prototype.getChildAfterChild=function(e,t,r){var n=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(n,t,1,r,e);return 0===i.length?null:i[0]},e}(),iF=function(){return function(e,t){this.viewCache=e,this.changes=t}}(),jF=function(){function e(e){this.filter_=e}return e.prototype.assertIndexed=function(e){cb(e.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),cb(e.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},e.prototype.applyOperation=function(t,r,n,i){var o,a,s=new gF;if(r.type===hd.OVERWRITE){var l=r;l.source.fromUser?o=this.applyUserOverwrite_(t,l.path,l.snap,n,i,s):(cb(l.source.fromServer,"Unknown source."),a=l.source.tagged||t.getServerCache().isFiltered()&&!l.path.isEmpty(),o=this.applyServerOverwrite_(t,l.path,l.snap,n,i,a,s))}else if(r.type===hd.MERGE){var $=r;$.source.fromUser?o=this.applyUserMerge_(t,$.path,$.children,n,i,s):(cb($.source.fromServer,"Unknown source."),a=$.source.tagged||t.getServerCache().isFiltered(),o=this.applyServerMerge_(t,$.path,$.children,n,i,a,s))}else if(r.type===hd.ACK_USER_WRITE){var h=r;o=h.revert?this.revertUserWrite_(t,h.path,n,i,s):this.ackUserWrite_(t,h.path,h.affectedTree,n,i,s)}else{if(r.type!==hd.LISTEN_COMPLETE)throw Cf("Unknown operation type: "+r.type);o=this.listenComplete_(t,r.path,n,s)}var u=s.getChanges();return e.maybeAddValueEvent_(t,o,u),new iF(o,u)},e.maybeAddValueEvent_=function(e,t,r){var n=t.getEventCache();if(n.isFullyInitialized()){var i=n.getNode().isLeafNode()||n.getNode().isEmpty(),o=e.getCompleteEventSnap();(r.length>0||!e.getEventCache().isFullyInitialized()||i&&!n.getNode().equals(o)||!n.getNode().getPriority().equals(o.getPriority()))&&r.push(ib.valueChange(t.getCompleteEventSnap()))}},e.prototype.generateEventCacheAfterServerEvent_=function(e,t,r,n,i){var o=e.getEventCache();if(null!=r.shadowingWrite(t))return e;var a=void 0,s=void 0;if(t.isEmpty()){if(cb(e.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),e.getServerCache().isFiltered()){var l=e.getCompleteServerSnap(),$=l instanceof hb?l:hb.EMPTY_NODE,h=r.calcCompleteEventChildren($);a=this.filter_.updateFullNode(e.getEventCache().getNode(),h,i)}else{var u=r.calcCompleteEventCache(e.getCompleteServerSnap());a=this.filter_.updateFullNode(e.getEventCache().getNode(),u,i)}}else{var c=t.getFront();if(".priority"===c){cb(1===t.getLength(),"Can't have a priority with additional path components");var p=o.getNode();s=e.getServerCache().getNode();var d=r.calcEventCacheAfterServerOverwrite(t,p,s);a=null!=d?this.filter_.updatePriority(p,d):o.getNode()}else{var v=t.popFront(),E=void 0;if(o.isCompleteForChild(c)){s=e.getServerCache().getNode();var _=r.calcEventCacheAfterServerOverwrite(t,o.getNode(),s);E=null!=_?o.getNode().getImmediateChild(c).updateChild(v,_):o.getNode().getImmediateChild(c)}else E=r.calcCompleteChild(c,e.getServerCache());a=null!=E?this.filter_.updateChild(o.getNode(),c,E,v,n,i):o.getNode()}}return e.updateEventSnap(a,o.isFullyInitialized()||t.isEmpty(),this.filter_.filtersNodes())},e.prototype.applyServerOverwrite_=function(e,t,r,n,i,o,a){var s,l=e.getServerCache(),$=o?this.filter_:this.filter_.getIndexedFilter();if(t.isEmpty())s=$.updateFullNode(l.getNode(),r,null);else if($.filtersNodes()&&!l.isFiltered()){var h=l.getNode().updateChild(t,r);s=$.updateFullNode(l.getNode(),h,null)}else{var u=t.getFront();if(!l.isCompleteForPath(t)&&t.getLength()>1)return e;var c=t.popFront(),p=l.getNode().getImmediateChild(u).updateChild(c,r);s=".priority"===u?$.updatePriority(l.getNode(),p):$.updateChild(l.getNode(),u,p,c,vv,null)}var d=e.updateServerSnap(s,l.isFullyInitialized()||t.isEmpty(),$.filtersNodes()),v=new Xk(n,d,i);return this.generateEventCacheAfterServerEvent_(d,t,n,v,a)},e.prototype.applyUserOverwrite_=function(e,t,r,n,i,o){var a,s,l=e.getEventCache(),$=new Xk(n,e,i);if(t.isEmpty())s=this.filter_.updateFullNode(e.getEventCache().getNode(),r,o),a=e.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var h=t.getFront();if(".priority"===h)s=this.filter_.updatePriority(e.getEventCache().getNode(),r),a=e.updateEventSnap(s,l.isFullyInitialized(),l.isFiltered());else{var u=t.popFront(),c=l.getNode().getImmediateChild(h),p=void 0;if(u.isEmpty())p=r;else{var d=$.getCompleteChild(h);p=null!=d?".priority"===u.getBack()&&d.getChild(u.parent()).isEmpty()?d:d.updateChild(u,r):hb.EMPTY_NODE}if(c.equals(p))a=e;else{var v=this.filter_.updateChild(l.getNode(),h,p,u,$,o);a=e.updateEventSnap(v,l.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},e.cacheHasChild_=function(e,t){return e.getEventCache().isCompleteForChild(t)},e.prototype.applyUserMerge_=function(t,r,n,i,o,a){var s=this,l=t;return n.foreach(function(n,$){var h=r.child(n);e.cacheHasChild_(t,h.getFront())&&(l=s.applyUserOverwrite_(l,h,$,i,o,a))}),n.foreach(function(n,$){var h=r.child(n);e.cacheHasChild_(t,h.getFront())||(l=s.applyUserOverwrite_(l,h,$,i,o,a))}),l},e.prototype.applyMerge_=function(e,t){return t.foreach(function(t,r){e=e.updateChild(t,r)}),e},e.prototype.applyServerMerge_=function(e,t,r,n,i,o,a){var s=this;if(e.getServerCache().getNode().isEmpty()&&!e.getServerCache().isFullyInitialized())return e;var l,$=e;l=t.isEmpty()?r:Rb.Empty.setTree(t,r);var h=e.getServerCache().getNode();return l.children.inorderTraversal(function(t,r){if(h.hasChild(t)){var l=e.getServerCache().getNode().getImmediateChild(t),u=s.applyMerge_(l,r);$=s.applyServerOverwrite_($,new db(t),u,n,i,o,a)}}),l.children.inorderTraversal(function(t,r){var l=!e.getServerCache().isCompleteForChild(t)&&null==r.value;if(!h.hasChild(t)&&!l){var u=e.getServerCache().getNode().getImmediateChild(t),c=s.applyMerge_(u,r);$=s.applyServerOverwrite_($,new db(t),c,n,i,o,a)}}),$},e.prototype.ackUserWrite_=function(e,t,r,n,i,o){if(null!=n.shadowingWrite(t))return e;var a=e.getServerCache().isFiltered(),s=e.getServerCache();if(null!=r.value){if(t.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(t))return this.applyServerOverwrite_(e,t,s.getNode().getChild(t),n,i,a,o);if(t.isEmpty()){var l=Rb.Empty;return s.getNode().forEachChild(Gd,function(e,t){l=l.set(new db(e),t)}),this.applyServerMerge_(e,t,l,n,i,a,o)}return e}var $=Rb.Empty;return r.foreach(function(e,r){var n=t.child(e);s.isCompleteForPath(n)&&($=$.set(e,s.getNode().getChild(n)))}),this.applyServerMerge_(e,t,$,n,i,a,o)},e.prototype.listenComplete_=function(e,t,r,n){var i=e.getServerCache(),o=e.updateServerSnap(i.getNode(),i.isFullyInitialized()||t.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,t,r,vv,n)},e.prototype.revertUserWrite_=function(e,t,r,n,i){var o;if(null!=r.shadowingWrite(t))return e;var a=new Xk(r,e,n),s=e.getEventCache().getNode(),l=void 0;if(t.isEmpty()||".priority"===t.getFront()){var $=void 0;if(e.getServerCache().isFullyInitialized())$=r.calcCompleteEventCache(e.getCompleteServerSnap());else{var h=e.getServerCache().getNode();cb(h instanceof hb,"serverChildren would be complete if leaf node"),$=r.calcCompleteEventChildren(h)}$=$,l=this.filter_.updateFullNode(s,$,i)}else{var u=t.getFront(),c=r.calcCompleteChild(u,e.getServerCache());null==c&&e.getServerCache().isCompleteForChild(u)&&(c=s.getImmediateChild(u)),(l=null!=c?this.filter_.updateChild(s,u,c,t.popFront(),a,i):e.getEventCache().getNode().hasChild(u)?this.filter_.updateChild(s,u,hb.EMPTY_NODE,t.popFront(),a,i):s).isEmpty()&&e.getServerCache().isFullyInitialized()&&(o=r.calcCompleteEventCache(e.getCompleteServerSnap())).isLeafNode()&&(l=this.filter_.updateFullNode(l,o,i))}return o=e.getServerCache().isFullyInitialized()||null!=r.shadowingWrite(db.Empty),e.updateEventSnap(l,o,this.filter_.filtersNodes())},e}(),kF=function(){function e(e){this.query_=e,this.index_=this.query_.getQueryParams().getIndex()}return e.prototype.generateEventsForChanges=function(e,t,r){var n=this,i=[],o=[];return e.forEach(function(e){e.type===ib.CHILD_CHANGED&&n.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push(ib.childMovedChange(e.childName,e.snapshotNode))}),this.generateEventsForType_(i,ib.CHILD_REMOVED,e,r,t),this.generateEventsForType_(i,ib.CHILD_ADDED,e,r,t),this.generateEventsForType_(i,ib.CHILD_MOVED,o,r,t),this.generateEventsForType_(i,ib.CHILD_CHANGED,e,r,t),this.generateEventsForType_(i,ib.VALUE,e,r,t),i},e.prototype.generateEventsForType_=function(e,t,r,n,i){var o=this,a=r.filter(function(e){return e.type===t});a.sort(this.compareChanges_.bind(this)),a.forEach(function(t){var r=o.materializeSingleChange_(t,i);n.forEach(function(n){n.respondsTo(t.type)&&e.push(n.createEvent(r,o.query_))})})},e.prototype.materializeSingleChange_=function(e,t){return"value"===e.type||"child_removed"===e.type?e:(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,this.index_),e)},e.prototype.compareChanges_=function(e,t){if(null==e.childName||null==t.childName)throw Cf("Should only compare child_ events.");var r=new lb(e.childName,e.snapshotNode),n=new lb(t.childName,t.snapshotNode);return this.index_.compare(r,n)},e}(),lF=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var r=this.query_.getQueryParams(),n=new Wk(r.getIndex()),i=r.getNodeFilter();this.processor_=new jF(i);var o=t.getServerCache(),a=t.getEventCache(),s=n.updateFullNode(hb.EMPTY_NODE,o.getNode(),null),l=i.updateFullNode(hb.EMPTY_NODE,a.getNode(),null),$=new rd(s,o.isFullyInitialized(),n.filtersNodes()),h=new rd(l,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new uv(h,$),this.eventGenerator_=new kF(this.query_)}return e.prototype.getQuery=function(){return this.query_},e.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},e.prototype.getCompleteServerCache=function(e){var t=this.viewCache_.getCompleteServerSnap();return t&&(this.query_.getQueryParams().loadsAllData()||!e.isEmpty()&&!t.getImmediateChild(e.getFront()).isEmpty())?t.getChild(e):null},e.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},e.prototype.addEventRegistration=function(e){this.eventRegistrations_.push(e)},e.prototype.removeEventRegistration=function(e,t){var r=[];if(t){cb(null==e,"A cancel should cancel all event registrations.");var n=this.query_.path;this.eventRegistrations_.forEach(function(e){t=t;var i=e.createCancelEvent(t,n);i&&r.push(i)})}if(e){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(e)){if(e.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return r},e.prototype.applyOperation=function(e,t,r){e.type===hd.MERGE&&null!==e.source.queryId&&(cb(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),cb(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var n=this.viewCache_,i=this.processor_.applyOperation(n,e,t,r);return this.processor_.assertIndexed(i.viewCache),cb(i.viewCache.getServerCache().isFullyInitialized()||!n.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},e.prototype.getInitialEvents=function(e){var t=this.viewCache_.getEventCache(),r=[];t.getNode().isLeafNode()||t.getNode().forEachChild(qb,function(e,t){r.push(ib.childAddedChange(e,t))});return t.isFullyInitialized()&&r.push(ib.valueChange(t.getNode())),this.generateEventsForChanges_(r,t.getNode(),e)},e.prototype.generateEventsForChanges_=function(e,t,r){var n=r?[r]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(e,t,n)},e}(),wv=function(){function e(){this.views=new Map}return Object.defineProperty(e,"__referenceConstructor",{get:function(){return cb(Uk,"Reference.ts has not been loaded"),Uk},set:function(e){cb(!Uk,"__referenceConstructor has already been defined"),Uk=e},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.views.size},e.prototype.applyOperation=function(e,t,r){var n,i,o=e.source.queryId;if(null!==o){var a=this.views.get(o);return cb(null!=a,"SyncTree gave us an op for an invalid query."),a.applyOperation(e,t,r)}var s=[];try{for(var l=Kb(this.views.values()),$=l.next();!$.done;$=l.next()){a=$.value;s=s.concat(a.applyOperation(e,t,r))}}catch(h){n={error:h}}finally{try{$&&!$.done&&(i=l.return)&&i.call(l)}finally{if(n)throw n.error}}return s},e.prototype.addEventRegistration=function(e,t,r,n,i){var o=e.queryIdentifier(),a=this.views.get(o);if(!a){var s=r.calcCompleteEventCache(i?n:null),l=!1;s?l=!0:n instanceof hb?(s=r.calcCompleteEventChildren(n),l=!1):(s=hb.EMPTY_NODE,l=!1);var $=new uv(new rd(s,l,!1),new rd(n,i,!1));a=new lF(e,$),this.views.set(o,a)}return a.addEventRegistration(t),a.getInitialEvents(t)},e.prototype.removeEventRegistration=function(t,r,n){var i,o,a=t.queryIdentifier(),s=[],l=[],$=this.hasCompleteView();if("default"===a)try{for(var h=Kb(this.views.entries()),u=h.next();!u.done;u=h.next()){var c=fg(u.value,2),p=c[0],d=c[1];l=l.concat(d.removeEventRegistration(r,n)),d.isEmpty()&&(this.views.delete(p),d.getQuery().getQueryParams().loadsAllData()||s.push(d.getQuery()))}}catch(v){i={error:v}}finally{try{u&&!u.done&&(o=h.return)&&o.call(h)}finally{if(i)throw i.error}}else(d=this.views.get(a))&&(l=l.concat(d.removeEventRegistration(r,n)),d.isEmpty()&&(this.views.delete(a),d.getQuery().getQueryParams().loadsAllData()||s.push(d.getQuery())));return $&&!this.hasCompleteView()&&s.push(new e.__referenceConstructor(t.repo,t.path)),{removed:s,events:l}},e.prototype.getQueryViews=function(){var e,t,r=[];try{for(var n=Kb(this.views.values()),i=n.next();!i.done;i=n.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||r.push(o)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return r},e.prototype.getCompleteServerCache=function(e){var t,r,n=null;try{for(var i=Kb(this.views.values()),o=i.next();!o.done;o=i.next()){var a=o.value;n=n||a.getCompleteServerCache(e)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return n},e.prototype.viewForQuery=function(e){if(e.getQueryParams().loadsAllData())return this.getCompleteView();var t=e.queryIdentifier();return this.views.get(t)},e.prototype.viewExistsForQuery=function(e){return null!=this.viewForQuery(e)},e.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},e.prototype.getCompleteView=function(){var e,t;try{for(var r=Kb(this.views.values()),n=r.next();!n.done;n=r.next()){var i=n.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(o){e={error:o}}finally{try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return null},e}(),xv=function(){function e(e){this.writeTree_=e}return e.prototype.addWrite=function(t,r){if(t.isEmpty())return new e(new Rb(r));var n=this.writeTree_.findRootMostValueAndPath(t);if(null!=n){var i=n.path,o=n.value,a=db.relativePath(i,t);return o=o.updateChild(a,r),new e(this.writeTree_.set(i,o))}var s=new Rb(r);return new e(this.writeTree_.setTree(t,s))},e.prototype.addWrites=function(e,t){var r=this;return Ab(t,function(t,n){r=r.addWrite(e.child(t),n)}),r},e.prototype.removeWrite=function(t){return t.isEmpty()?e.Empty:new e(this.writeTree_.setTree(t,Rb.Empty))},e.prototype.hasCompleteWrite=function(e){return null!=this.getCompleteNode(e)},e.prototype.getCompleteNode=function(e){var t=this.writeTree_.findRootMostValueAndPath(e);return null!=t?this.writeTree_.get(t.path).getChild(db.relativePath(t.path,e)):null},e.prototype.getCompleteChildren=function(){var e=[],t=this.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(qb,function(t,r){e.push(new lb(t,r))}):this.writeTree_.children.inorderTraversal(function(t,r){null!=r.value&&e.push(new lb(t,r.value))}),e},e.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var r=this.getCompleteNode(t);return new e(null!=r?new Rb(r):this.writeTree_.subtree(t))},e.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},e.prototype.apply=function(e){return yv(db.Empty,this.writeTree_,e)},e.Empty=new e(new Rb(null)),e}();function yv(e,t,r){if(null!=t.value)return r.updateChild(e,t.value);var n=null;return t.children.inorderTraversal(function(t,i){".priority"===t?(cb(null!==i.value,"Priority writes must always be leaf nodes"),n=i.value):r=yv(e.child(t),i,r)}),r.getChild(e).isEmpty()||null===n||(r=r.updateChild(e.child(".priority"),n)),r}var mF=function(){function e(){this.visibleWrites_=xv.Empty,this.allWrites_=[],this.lastWriteId_=-1}return e.prototype.childWrites=function(e){return new nF(e,this)},e.prototype.addOverwrite=function(e,t,r,n){cb(r>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===n&&(n=!0),this.allWrites_.push({path:e,snap:t,writeId:r,visible:n}),n&&(this.visibleWrites_=this.visibleWrites_.addWrite(e,t)),this.lastWriteId_=r},e.prototype.addMerge=function(e,t,r){cb(r>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:e,children:t,writeId:r,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(e,t),this.lastWriteId_=r},e.prototype.getWrite=function(e){for(var t=0;t<this.allWrites_.length;t++){var r=this.allWrites_[t];if(r.writeId===e)return r}return null},e.prototype.removeWrite=function(e){var t=this,r=this.allWrites_.findIndex(function(t){return t.writeId===e});cb(r>=0,"removeWrite called with nonexistent writeId.");var n=this.allWrites_[r];this.allWrites_.splice(r,1);for(var i=n.visible,o=!1,a=this.allWrites_.length-1;i&&a>=0;){var s=this.allWrites_[a];s.visible&&(a>=r&&this.recordContainsPath_(s,n.path)?i=!1:n.path.contains(s.path)&&(o=!0)),a--}if(i){if(o)return this.resetTree_(),!0;n.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(n.path):Ab(n.children,function(e){t.visibleWrites_=t.visibleWrites_.removeWrite(n.path.child(e))});return!0}return!1},e.prototype.getCompleteWriteData=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcCompleteEventCache=function(t,r,n,i){if(n||i){var o=this.visibleWrites_.childCompoundWrite(t);if(!i&&o.isEmpty())return r;if(i||null!=r||o.hasCompleteWrite(db.Empty)){var a=e.layerTree_(this.allWrites_,function(e){return(e.visible||i)&&(!n||!~n.indexOf(e.writeId))&&(e.path.contains(t)||t.contains(e.path))},t);$=r||hb.EMPTY_NODE;return a.apply($)}return null}var s=this.visibleWrites_.getCompleteNode(t);if(null!=s)return s;var l=this.visibleWrites_.childCompoundWrite(t);if(l.isEmpty())return r;if(null!=r||l.hasCompleteWrite(db.Empty)){var $=r||hb.EMPTY_NODE;return l.apply($)}return null},e.prototype.calcCompleteEventChildren=function(e,t){var r=hb.EMPTY_NODE,n=this.visibleWrites_.getCompleteNode(e);if(n)return n.isLeafNode()||n.forEachChild(qb,function(e,t){r=r.updateImmediateChild(e,t)}),r;if(t){var i=this.visibleWrites_.childCompoundWrite(e);return t.forEachChild(qb,function(e,t){var n=i.childCompoundWrite(new db(e)).apply(t);r=r.updateImmediateChild(e,n)}),i.getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r}return this.visibleWrites_.childCompoundWrite(e).getCompleteChildren().forEach(function(e){r=r.updateImmediateChild(e.name,e.node)}),r},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r,n){cb(r||n,"Either existingEventSnap or existingServerSnap must exist");var i=e.child(t);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?n.getChild(t):o.apply(n.getChild(t))},e.prototype.calcCompleteChild=function(e,t,r){var n=e.child(t),i=this.visibleWrites_.getCompleteNode(n);return null!=i?i:r.isCompleteForChild(t)?this.visibleWrites_.childCompoundWrite(n).apply(r.getNode().getImmediateChild(t)):null},e.prototype.shadowingWrite=function(e){return this.visibleWrites_.getCompleteNode(e)},e.prototype.calcIndexedSlice=function(e,t,r,n,i,o){var a,s=this.visibleWrites_.childCompoundWrite(e),l=s.getCompleteNode(db.Empty);if(null!=l)a=l;else{if(null==t)return[];a=s.apply(t)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];for(var $=[],h=o.getCompare(),u=i?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),c=u.getNext();c&&$.length<n;)0!==h(c,r)&&$.push(c),c=u.getNext();return $},e.prototype.recordContainsPath_=function(e,t){if(e.snap)return e.path.contains(t);for(var r in e.children)if(e.children.hasOwnProperty(r)&&e.path.child(r).contains(t))return!0;return!1},e.prototype.resetTree_=function(){this.visibleWrites_=e.layerTree_(this.allWrites_,e.DefaultFilter_,db.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},e.DefaultFilter_=function(e){return e.visible},e.layerTree_=function(e,t,r){for(var n=xv.Empty,i=0;i<e.length;++i){var o=e[i];if(t(o)){var a=o.path,s=void 0;if(o.snap)r.contains(a)?(s=db.relativePath(r,a),n=n.addWrite(s,o.snap)):a.contains(r)&&(s=db.relativePath(a,r),n=n.addWrite(db.Empty,o.snap.getChild(s)));else{if(!o.children)throw Cf("WriteRecord should have .snap or .children");if(r.contains(a))s=db.relativePath(r,a),n=n.addWrites(s,o.children);else if(a.contains(r))if((s=db.relativePath(a,r)).isEmpty())n=n.addWrites(db.Empty,o.children);else{var l=$b(o.children,s.getFront());if(l){var $=l.getChild(s.popFront());n=n.addWrite(db.Empty,$)}}}}}return n},e}(),nF=function(){function e(e,t){this.treePath_=e,this.writeTree_=t}return e.prototype.calcCompleteEventCache=function(e,t,r){return this.writeTree_.calcCompleteEventCache(this.treePath_,e,t,r)},e.prototype.calcCompleteEventChildren=function(e){return this.writeTree_.calcCompleteEventChildren(this.treePath_,e)},e.prototype.calcEventCacheAfterServerOverwrite=function(e,t,r){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,e,t,r)},e.prototype.shadowingWrite=function(e){return this.writeTree_.shadowingWrite(this.treePath_.child(e))},e.prototype.calcIndexedSlice=function(e,t,r,n,i){return this.writeTree_.calcIndexedSlice(this.treePath_,e,t,r,n,i)},e.prototype.calcCompleteChild=function(e,t){return this.writeTree_.calcCompleteChild(this.treePath_,e,t)},e.prototype.child=function(t){return new e(this.treePath_.child(t),this.writeTree_)},e}(),zv=function(){function e(e){this.listenProvider_=e,this.syncPointTree_=Rb.Empty,this.pendingWriteTree_=new mF,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return e.prototype.applyUserOverwrite=function(e,t,r,n){return this.pendingWriteTree_.addOverwrite(e,t,r,n),n?this.applyOperationToSyncPoints_(new kj(qd.User,e,t)):[]},e.prototype.applyUserMerge=function(e,t,r){this.pendingWriteTree_.addMerge(e,t,r);var n=Rb.fromObject(t);return this.applyOperationToSyncPoints_(new Vk(qd.User,e,n))},e.prototype.ackUserWrite=function(e,t){void 0===t&&(t=!1);var r=this.pendingWriteTree_.getWrite(e);if(this.pendingWriteTree_.removeWrite(e)){var n=Rb.Empty;return null!=r.snap?n=n.set(db.Empty,!0):Ab(r.children,function(e,t){n=n.set(new db(e),t)}),this.applyOperationToSyncPoints_(new eF(r.path,n,t))}return[]},e.prototype.applyServerOverwrite=function(e,t){return this.applyOperationToSyncPoints_(new kj(qd.Server,e,t))},e.prototype.applyServerMerge=function(e,t){var r=Rb.fromObject(t);return this.applyOperationToSyncPoints_(new Vk(qd.Server,e,r))},e.prototype.applyListenComplete=function(e){return this.applyOperationToSyncPoints_(new tv(qd.Server,e))},e.prototype.applyTaggedQueryOverwrite=function(t,r,n){var i=this.queryKeyForTag_(n);if(null!=i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,l=db.relativePath(a,t),$=new kj(qd.forServerTaggedQuery(s),l,r);return this.applyTaggedOperation_(a,$)}return[]},e.prototype.applyTaggedQueryMerge=function(t,r,n){var i=this.queryKeyForTag_(n);if(i){var o=e.parseQueryKey_(i),a=o.path,s=o.queryId,l=db.relativePath(a,t),$=Rb.fromObject(r),h=new Vk(qd.forServerTaggedQuery(s),l,$);return this.applyTaggedOperation_(a,h)}return[]},e.prototype.applyTaggedListenComplete=function(t,r){var n=this.queryKeyForTag_(r);if(n){var i=e.parseQueryKey_(n),o=i.path,a=i.queryId,s=db.relativePath(o,t),l=new tv(qd.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,l)}return[]},e.prototype.addEventRegistration=function(t,r){var n=t.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(n,function(e,t){var r=db.relativePath(e,n);i=i||t.getCompleteServerCache(r),o=o||t.hasCompleteView()});var a,s=this.syncPointTree_.get(n);(s?(o=o||s.hasCompleteView(),i=i||s.getCompleteServerCache(db.Empty)):(s=new wv,this.syncPointTree_=this.syncPointTree_.set(n,s)),null!=i)?a=!0:(a=!1,i=hb.EMPTY_NODE,this.syncPointTree_.subtree(n).foreachChild(function(e,t){var r=t.getCompleteServerCache(db.Empty);r&&(i=i.updateImmediateChild(e,r))}));var l=s.viewExistsForQuery(t);if(!l&&!t.getQueryParams().loadsAllData()){var $=e.makeQueryKey_(t);cb(!this.queryToTagMap.has($),"View does not exist, but we have a tag");var h=e.getNextQueryTag_();this.queryToTagMap.set($,h),this.tagToQueryMap.set(h,$)}var u=this.pendingWriteTree_.childWrites(n),c=s.addEventRegistration(t,r,u,i,a);if(!l&&!o){var p=s.viewForQuery(t);c=c.concat(this.setupListener_(t,p))}return c},e.prototype.removeEventRegistration=function(t,r,n){var i=this,o=t.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===t.queryIdentifier()||a.viewExistsForQuery(t))){var l=a.removeEventRegistration(t,r,n);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var $=l.removed;s=l.events;var h=-1!==$.findIndex(function(e){return e.getQueryParams().loadsAllData()}),u=this.syncPointTree_.findOnPath(o,function(e,t){return t.hasCompleteView()});if(h&&!u){var c=this.syncPointTree_.subtree(o);if(!c.isEmpty())for(var p=this.collectDistinctViewsForSubTree_(c),d=0;d<p.length;++d){var v=p[d],E=v.getQuery(),_=this.createListenerForView_(v);this.listenProvider_.startListening(e.queryForListening_(E),this.tagForQuery_(E),_.hashFn,_.onComplete)}}if(!u&&$.length>0&&!n)if(h){this.listenProvider_.stopListening(e.queryForListening_(t),null)}else $.forEach(function(t){var r=i.queryToTagMap.get(e.makeQueryKey_(t));i.listenProvider_.stopListening(e.queryForListening_(t),r)});this.removeTags_($)}return s},e.prototype.calcCompleteEventCache=function(e,t){var r=this.pendingWriteTree_,n=this.syncPointTree_.findOnPath(e,function(t,r){var n=db.relativePath(t,e),i=r.getCompleteServerCache(n);if(i)return i});return r.calcCompleteEventCache(e,n,t,!0)},e.prototype.collectDistinctViewsForSubTree_=function(e){return e.fold(function(e,t,r){if(t&&t.hasCompleteView())return[t.getCompleteView()];var n=[];return t&&(n=t.getQueryViews()),Ab(r,function(e,t){n=n.concat(t)}),n})},e.prototype.removeTags_=function(t){for(var r=0;r<t.length;++r){var n=t[r];if(!n.getQueryParams().loadsAllData()){var i=e.makeQueryKey_(n),o=this.queryToTagMap.get(i);this.queryToTagMap.delete(i),this.tagToQueryMap.delete(o)}}},e.queryForListening_=function(e){return e.getQueryParams().loadsAllData()&&!e.getQueryParams().isDefault()?e.getRef():e},e.prototype.setupListener_=function(t,r){var n=t.path,i=this.tagForQuery_(t),o=this.createListenerForView_(r),a=this.listenProvider_.startListening(e.queryForListening_(t),i,o.hashFn,o.onComplete),s=this.syncPointTree_.subtree(n);if(i)cb(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var l=s.fold(function(e,t,r){if(!e.isEmpty()&&t&&t.hasCompleteView())return[t.getCompleteView().getQuery()];var n=[];return t&&(n=n.concat(t.getQueryViews().map(function(e){return e.getQuery()}))),Ab(r,function(e,t){n=n.concat(t)}),n}),$=0;$<l.length;++$){var h=l[$];this.listenProvider_.stopListening(e.queryForListening_(h),this.tagForQuery_(h))}return a},e.prototype.createListenerForView_=function(e){var t=this,r=e.getQuery(),n=this.tagForQuery_(r);return{hashFn:function(){return(e.getServerCache()||hb.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return n?t.applyTaggedListenComplete(r.path,n):t.applyListenComplete(r.path);var i=wE(e,r);return t.removeEventRegistration(r,null,i)}}},e.makeQueryKey_=function(e){return e.path.toString()+"$"+e.queryIdentifier()},e.parseQueryKey_=function(e){var t=e.indexOf("$");return cb(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new db(e.substr(0,t))}},e.prototype.queryKeyForTag_=function(e){return this.tagToQueryMap.get(e)},e.prototype.tagForQuery_=function(t){var r=e.makeQueryKey_(t);return this.queryToTagMap.get(r)},e.getNextQueryTag_=function(){return e.nextQueryTag_++},e.prototype.applyTaggedOperation_=function(e,t){var r=this.syncPointTree_.get(e);cb(r,"Missing sync point for query tag that we're tracking");var n=this.pendingWriteTree_.childWrites(e);return r.applyOperation(t,n,null)},e.prototype.applyOperationToSyncPoints_=function(e){return this.applyOperationHelper_(e,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(db.Empty))},e.prototype.applyOperationHelper_=function(e,t,r,n){if(e.path.isEmpty())return this.applyOperationDescendantsHelper_(e,t,r,n);var i=t.get(db.Empty);null==r&&null!=i&&(r=i.getCompleteServerCache(db.Empty));var o=[],a=e.path.getFront(),s=e.operationForChild(a),l=t.children.get(a);if(l&&s){var $=r?r.getImmediateChild(a):null,h=n.child(a);o=o.concat(this.applyOperationHelper_(s,l,$,h))}return i&&(o=o.concat(i.applyOperation(e,n,r))),o},e.prototype.applyOperationDescendantsHelper_=function(e,t,r,n){var i=this,o=t.get(db.Empty);null==r&&null!=o&&(r=o.getCompleteServerCache(db.Empty));var a=[];return t.children.inorderTraversal(function(t,o){var s=r?r.getImmediateChild(t):null,l=n.child(t),$=e.operationForChild(t);$&&(a=a.concat(i.applyOperationDescendantsHelper_($,o,s,l)))}),o&&(a=a.concat(o.applyOperation(e,n,r))),a},e.nextQueryTag_=1,e}(),oF=function(){function e(){this.rootNode_=hb.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}(),pF=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),Pb(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return Iq(this.counters_)},e}(),lj=function(){function e(){}return e.getCollection=function(e){var t=e.toString();return this.collections_[t]||(this.collections_[t]=new pF),this.collections_[t]},e.getOrCreateReporter=function(e,t){var r=e.toString();return this.reporters_[r]||(this.reporters_[r]=t()),this.reporters_[r]},e.collections_={},e.reporters_={},e}(),Av=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=Xd({},e);return this.last_&&Ab(this.last_,function(e,r){t[e]=t[e]-r}),this.last_=e,t},e}(),Bv=1e4,qF=3e4,rF=3e5,sF=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Av(e);var r=Bv+(qF-Bv)*Math.random();ng(this.reportStats_.bind(this),Math.floor(r))}return e.prototype.includeStat=function(e){this.statsToReport_[e]=!0},e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),r={},n=!1;Ab(t,function(t,i){i>0&&Pb(e.statsToReport_,t)&&(r[t]=i,n=!0)}),n&&this.server_.reportStats(r),ng(this.reportStats_.bind(this),Math.floor(2*Math.random()*rF))},e}(),tF=function(){function e(){this.eventLists_=[],this.recursionDepth_=0}return e.prototype.queueEvents=function(e){for(var t=null,r=0;r<e.length;r++){var n=e[r],i=n.getPath();null===t||i.equals(t.getPath())||(this.eventLists_.push(t),t=null),null===t&&(t=new uF(i)),t.add(n)}t&&this.eventLists_.push(t)},e.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.equals(e)})},e.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.contains(e)||e.contains(t)})},e.prototype.raiseQueuedEventsMatchingPredicate_=function(e){this.recursionDepth_++;for(var t=!0,r=0;r<this.eventLists_.length;r++){var n=this.eventLists_[r];if(n)e(n.getPath())?(this.eventLists_[r].raise(),this.eventLists_[r]=null):t=!1}t&&(this.eventLists_=[]),this.recursionDepth_--},e}(),uF=function(){function e(e){this.path_=e,this.events_=[]}return e.prototype.add=function(e){this.events_.push(e)},e.prototype.raise=function(){for(var e=0;e<this.events_.length;e++){var t=this.events_[e];if(null!==t){this.events_[e]=null;var r=t.getEventRunner();cj&&Hb("event: "+t.toString()),Hf(r)}}},e.prototype.getPath=function(){return this.path_},e}(),Cv=function(){function e(e){this.allowedEvents_=e,this.listeners_={},cb(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(Array.isArray(this.listeners_[e]))for(var n=Yd(this.listeners_[e]),i=0;i<n.length;i++)n[i].callback.apply(n[i].context,t)},e.prototype.on=function(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});var n=this.getInitialEvent(e);n&&t.apply(r,n)},e.prototype.off=function(e,t,r){this.validateEventType_(e);for(var n=this.listeners_[e]||[],i=0;i<n.length;i++)if(n[i].callback===t&&(!r||r===n[i].context))return void n.splice(i,1)},e.prototype.validateEventType_=function(e){cb(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},e}(),vF=function(e){function t(){var t,r,n=e.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(r="visibilitychange",t="hidden"):void 0!==document.mozHidden?(r="mozvisibilitychange",t="mozHidden"):void 0!==document.msHidden?(r="msvisibilitychange",t="msHidden"):void 0!==document.webkitHidden&&(r="webkitvisibilitychange",t="webkitHidden")),n.visible_=!0,r&&document.addEventListener(r,function(){var e=!document[t];e!==n.visible_&&(n.visible_=e,n.trigger("visible",e))},!1),n}return Zb(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return cb("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(Cv),Dv=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||Jq()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}return Zb(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return cb("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(Cv),wF=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var r=this;this.pendingResponses[e]=t;for(var n=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&Hf(function(){r.onMessage_(e[t])})},n=0;n<e.length;++n)t(n);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===n())break}},e}(),Ev="start",xF="close",yF="pLPCommand",zF="pRTLPCB",AF="seg",BF="ts",CF="d",Fv=1870,Gv=30,DF=Fv-Gv,EF=25e3,FF=3e4,Yk=function(){function e(e,t,r,n,i){this.connId=e,this.repoInfo=t,this.applicationId=r,this.transportSessionId=n,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=lg(e),this.stats_=lj.getCollection(t),this.urlFn=function(e){return t.connectionURL(dv,e)}}return e.prototype.open=function(e,t){var r=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new wF(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){r.log_("Timed out trying to connect."),r.onClosed_(),r.connectTimeoutTimer_=null},Math.floor(FF)),sE(function(){if(!r.isClosed_){r.scriptTagHolder=new GF(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=fg(e,5),i=n[0],o=n[1],a=n[2];n[3],n[4];if(r.incrementIncomingBytes_(e),r.scriptTagHolder)if(r.connectTimeoutTimer_&&(clearTimeout(r.connectTimeoutTimer_),r.connectTimeoutTimer_=null),r.everConnected_=!0,i===Ev)r.id=o,r.password=a;else{if(i!==xF)throw new Error("Unrecognized command received: "+i);o?(r.scriptTagHolder.sendNewPolls=!1,r.myPacketOrderer.closeAfter(o,function(){r.onClosed_()})):r.onClosed_()}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=fg(e,2),i=n[0],o=n[1];r.incrementIncomingBytes_(e),r.myPacketOrderer.handleResponse(i,o)},function(){r.onClosed_()},r.urlFn);var e={};e[Ev]="t",r.scriptTagHolder.uniqueCallbackIdentifier&&r.scriptTagHolder.uniqueCallbackIdentifier,r.transportSessionId&&r.transportSessionId,r.lastSessionId&&r.lastSessionId,r.applicationId&&r.applicationId,"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(bv)&&av;var t=r.urlFn(e);r.log_("Connecting via long-poll to "+t),r.scriptTagHolder.addTag(t,function(){})}})},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!fd()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!uE()&&!vE())},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Db(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var r=GD(t),n=Yq(r,DF),i=0;i<n.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,n.length,n[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!fd()){this.myDisconnFrame=document.createElement("iframe");var r={};this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=Db(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),GF=function(){function e(t,r,n,i){if(this.onDisconnect=n,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,fd())this.commandCB=t,this.onMessageCB=r;else{this.uniqueCallbackIdentifier=Vq(),window[yF+this.uniqueCallbackIdentifier]=t,window[zF+this.uniqueCallbackIdentifier]=r,this.myIFrame=e.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))o="<script>document.domain=\""+document.domain+"\";</script>";var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(s){Hb("frame writing exception"),s.stack&&Hb(s.stack),Hb(s)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Hb("No IE domain setting required")}catch(r){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};for(var t=this.urlFn(e),r="",n=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+Gv+r.length<=Fv))break;var i=this.pendingSegs.shift();r=r+"&"+AF+n+"="+i.seg+"&"+BF+n+"="+i.ts+"&"+CF+n+"="+i.d,n++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var r=this;this.outstandingRequests.add(t);var n=function(){r.outstandingRequests.delete(t),r.newRequest_()},i=setTimeout(n,Math.floor(EF));this.addTag(e,function(){clearTimeout(i),n()})},e.prototype.addTag=function(e,t){var r=this;fd()?this.doNodeLongPoll(e,t):setTimeout(function(){try{if(!r.sendNewPolls)return;var n=r.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){var e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=function(){Hb("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(n)}catch(i){}},Math.floor(1))},e}(),Hv="";function Iv(e){Hv=e}var HF=16384,IF=45e3,Zk=null;"undefined"!=typeof MozWebSocket?Zk=MozWebSocket:"undefined"!=typeof WebSocket&&(Zk=WebSocket);var af=function(){function e(t,r,n,i,o){this.connId=t,this.applicationId=n,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=lg(this.connId),this.stats_=lj.getCollection(r),this.connURL=e.connectionURL_(r,i,o),this.nodeAdmin=r.nodeAdmin}return e.connectionURL_=function(e,t,r){var n={};return!fd()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(bv)&&av,t&&t,r&&r,e.connectionURL(cv,n)},e.prototype.open=function(e,t){var r=this;this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Zd.set("previous_websocket_failure",!0);try{if(fd()){var n=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/"+_q+"/"+Hv+"/"+bj.platform+"/"+n,"X-Firebase-GMPID":this.applicationId||""}},o=bj.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a}),this.mySock=new Zk(this.connURL,[],i)}else{i={headers:{"X-Firebase-GMPID":this.applicationId||""}};this.mySock=new Zk(this.connURL,[],i)}}catch(l){this.log_("Error instantiating WebSocket.");var s=l.message||l.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&r.log_(t),r.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var r=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);r&&r.length>1&&parseFloat(r[1])<4.4&&(t=!0)}return!t&&null!==Zk&&!e.forceDisallow_},e.previouslyFailed=function(){return Zd.isInMemoryStorage||!0===Zd.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){Zd.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var r=hg(t);this.onMessage(r)}},e.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},e.prototype.extractFrameCount_=function(e){if(cb(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},e.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var r=this.extractFrameCount_(t);null!==r&&this.appendFrame_(r)}}},e.prototype.send=function(e){this.resetKeepAlive();var t=Db(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var r=Yq(t,HF);r.length>1&&this.sendString_(String(r.length));for(var n=0;n<r.length;n++)this.sendString_(r[n])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(IF))},e.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}(),JF=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[Yk,af]},enumerable:!1,configurable:!0}),e.prototype.initTransports_=function(t){var r,n,i=af&&af.isAvailable(),o=i&&!af.previouslyFailed();if(t.webSocketOnly&&(i||Lb("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[af];else{var a=this.transports_=[];try{for(var s=Kb(e.ALL_TRANSPORTS),l=s.next();!l.done;l=s.next()){var $=l.value;$&&$.isAvailable()&&a.push($)}}catch(h){r={error:h}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),KF=6e4,LF=5e3,MF=10240,NF=102400,$k="t",Jv="d",OF="s",Kv="r",PF="e",Lv="o",Mv="a",Nv="n",Ov="p",QF="h",Pv=function(){function e(e,t,r,n,i,o,a,s){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.onMessage_=n,this.onReady_=i,this.onDisconnect_=o,this.onKill_=a,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=lg("c:"+this.id+":"),this.transportManager_=new JF(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(r,n)},Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=ng(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>NF?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>MF?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(r){e===t.conn_?t.onConnectionLost_(r):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(r){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(r):e===t.secondaryConn_?t.onSecondaryMessageReceived_(r):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if($k in e){var t=e[$k];t===Mv?this.upgradeIfSecondaryHealthy_():t===Kv?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):t===Lv&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=mg("t",e),r=mg("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Ov,d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:Mv,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Nv,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=mg("t",e),r=mg("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=mg($k,e);if(Jv in e){var r=e[Jv];if(t===QF)this.onHandshake_(r);else if(t===Nv){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var n=0;n<this.pendingDataMessages.length;++n)this.onDataMessage_(this.pendingDataMessages[n]);this.pendingDataMessages=[],this.tryCleanupConnection()}else t===OF?this.onConnectionShutdown_(r):t===Kv?this.onReset_(r):t===PF?Ek("Server Error: "+r):t===Lv?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Ek("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,r=e.v,n=e.h;this.sessionId=e.s,this.repoInfo_.updateHost(n),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),_q!==r&&Lb("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,n),ng(function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())},Math.floor(KF))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.updateHost(e),1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var r=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ng(function(){r.sendPingOnPrimaryIfNecessary_()},Math.floor(LF))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Ov,d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Zd.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),Qv=function(){function e(){}return e.prototype.put=function(e,t,r,n){},e.prototype.merge=function(e,t,r,n){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,r){},e.prototype.onDisconnectMerge=function(e,t,r){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),sg=1e3,RF=3e5,Rv=3e4,SF=1.3,TF=3e4,UF="server_kill",VF=3,bf=function(e){function t(r,n,i,o,a,s,l){var $=e.call(this)||this;if($.repoInfo_=r,$.applicationId_=n,$.onDataUpdate_=i,$.onConnectStatus_=o,$.onServerInfoUpdate_=a,$.authTokenProvider_=s,$.authOverride_=l,$.id=t.nextPersistentConnectionId_++,$.log_=lg("p:"+$.id+":"),$.interruptReasons_={},$.listens=new Map,$.outstandingPuts_=[],$.outstandingPutCount_=0,$.onDisconnectRequestQueue_=[],$.connected_=!1,$.reconnectDelay_=sg,$.maxReconnectDelay_=RF,$.securityDebugCallback_=null,$.lastSessionId=null,$.establishConnectionTimer_=null,$.visible_=!1,$.requestCBHash_={},$.requestNumber_=0,$.realtime_=null,$.authToken_=null,$.forceTokenRefresh_=!1,$.invalidAuthTokenCount_=0,$.firstConnection_=!0,$.lastConnectionAttemptTime_=null,$.lastConnectionEstablishedTime_=null,l&&!fd())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return $.scheduleConnect_(0),vF.getInstance().on("visible",$.onVisible_,$),-1===r.host.indexOf("fblocal")&&Dv.getInstance().on("online",$.onOnline_,$),$}return Zb(t,e),t.prototype.sendRequest=function(e,t,r){var n=++this.requestNumber_,i={r:n,a:e,b:t};this.log_(Db(i)),cb(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),r&&(this.requestCBHash_[n]=r)},t.prototype.listen=function(e,t,r,n){var i=e.queryIdentifier(),o=e.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),cb(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),cb(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var a={onComplete:n,hashFn:t,query:e,tag:r};this.listens.get(o).set(i,a),this.connected_&&this.sendListen_(a)},t.prototype.sendListen_=function(e){var r=this,n=e.query,i=n.path.toString(),o=n.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=n.queryObject(),a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,l=a.s;t.warnOnListenWarnings_(s,n),(r.listens.get(i)&&r.listens.get(i).get(o))===e&&(r.log_("listen response",a),"ok"!==l&&r.removeListen_(i,o),e.onComplete&&e.onComplete(l,s))})},t.warnOnListenWarnings_=function(e,t){if(e&&"object"==typeof e&&Pb(e,"w")){var r=$b(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){var n="\".indexOn\": \""+t.getQueryParams().getIndex().toString()+"\"",i=t.path.toString();Lb("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+n+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||QD(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=Rv)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,r=PD(t)?"auth":"gauth",n={cred:t};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(r,n,function(r){var n=r.s,i=r.d||"error";e.authToken_===t&&("ok"===n?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(n,i))})}},t.prototype.unlisten=function(e,t){var r=e.path.toString(),n=e.queryIdentifier();this.log_("Unlisten called for "+r+" "+n),cb(e.getQueryParams().isDefault()||!e.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,n)&&this.connected_&&this.sendUnlisten_(r,n,e.queryObject(),t)},t.prototype.sendUnlisten_=function(e,t,r,n){this.log_("Unlisten on "+e+" for "+t);var i={p:e};n&&(i.q=r,i.t=n),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,r){this.connected_?this.sendOnDisconnect_("o",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:r})},t.prototype.onDisconnectMerge=function(e,t,r){this.connected_?this.sendOnDisconnect_("om",e,t,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:r})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,r,n){var i={p:t,d:r};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,function(e){n&&setTimeout(function(){n(e.s,e.d)},Math.floor(0))})},t.prototype.put=function(e,t,r,n){this.putInternal("p",e,t,r,n)},t.prototype.merge=function(e,t,r,n){this.putInternal("m",e,t,r,n)},t.prototype.putInternal=function(e,t,r,n,i){var o={p:t,d:r};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:n}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,r=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,n,function(n){t.log_(r+" response",n),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(n.s,n.d)})},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var r={c:e};this.log_("reportStats",r),this.sendRequest("s",r,function(e){if("ok"!==e.s){var r=e.d;t.log_("reportStats","Error sending stats: "+r)}})}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Db(e));var t=e.r,r=this.requestCBHash_[t];r&&(delete this.requestCBHash_[t],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):Ek("Unrecognized action received from server: "+Db(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;cb(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){t.establishConnectionTimer_=null,t.establishConnection_()},Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=sg,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=sg,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){new Date().getTime()-this.lastConnectionEstablishedTime_>TF&&(this.reconnectDelay_=sg),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime();var e=new Date().getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*SF)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){var e=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;var r=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),o=this.id+":"+t.nextConnectionId_++,a=this,s=this.lastSessionId,l=!1,$=null,h=function(){$?$.close():(l=!0,i())};this.realtime_={close:h,sendRequest:function(e){cb($,"sendRequest call when we're not connected not allowed."),$.sendRequest(e)}};var u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(u).then(function(e){l?Hb("getToken() completed but was canceled"):(Hb("getToken() completed. Creating connection."),a.authToken_=e&&e.accessToken,$=new Pv(o,a.repoInfo_,a.applicationId_,r,n,i,function(e){Lb(e+" ("+a.repoInfo_.toString()+")"),a.interrupt(UF)},s))}).then(null,function(t){a.log_("Failed to get token: "+t),l||(e.repoInfo_.nodeAdmin&&Lb(t),h())})}},t.prototype.interrupt=function(e){Hb("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){Hb("Resuming connection for reason: "+e),delete this.interruptReasons_[e],zk(this.interruptReasons_)&&(this.reconnectDelay_=sg,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var r;r=t?t.map(function(e){return Fk(e)}).join("$"):"default";var n=this.removeListen_(e,r);n&&n.onComplete&&n.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var r,n=new db(e).toString();if(this.listens.has(n)){var i=this.listens.get(n);r=i.get(t),i.delete(t),0===i.size&&this.listens.delete(n)}else r=void 0;return r},t.prototype.onAuthRevoked_=function(e,t){Hb("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=VF&&(this.reconnectDelay_=Rv,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,r,n;this.tryAuth();try{for(var i=Kb(this.listens.values()),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(r=void 0,Kb(a.values())),l=s.next();!l.done;l=s.next()){var $=l.value;this.sendListen_($)}}catch(c){r={error:c}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}catch(p){e={error:p}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var u=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(u.action,u.pathString,u.data,u.onComplete)}},t.prototype.sendConnectStats_=function(){var e={},t="js";fd()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+Hv.replace(/\./g,"-")]=1,Jq()?e["framework.cordova"]=1:KD()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=Dv.getInstance().currentlyOnline();return zk(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(Qv),WF=function(e){function t(t,r,n){var i=e.call(this)||this;return i.repoInfo_=t,i.onDataUpdate_=r,i.authTokenProvider_=n,i.log_=lg("p:rest:"),i.listens_={},i}return Zb(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(cb(e.getQueryParams().isDefault(),"should have a tag if it's not a default query."),e.path.toString())},t.prototype.listen=function(e,r,n,i){var o=this,a=e.path.toString();this.log_("Listen called for "+a+" "+e.queryIdentifier());var s=t.getListenId_(e,n),l={};this.listens_[s]=l;var $=e.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",$,function(e,t){var r=t;(404===e&&(r=null,e=null),null===e&&o.onDataUpdate_(a,r,!1,n),$b(o.listens_,s)===l)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})},t.prototype.unlisten=function(e,r){var n=t.getListenId_(e,r);delete this.listens_[n]},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,r){var n=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var o=i&&i.accessToken;o&&(t.auth=o);var a=(n.repoInfo_.secure?"https://":"http://")+n.repoInfo_.host+e+"?ns="+n.repoInfo_.namespace+RD(t);n.log_("Sending REST request for "+a);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(r&&4===s.readyState){n.log_("REST Response for "+a+" received. status:",s.status,"response:",s.responseText);var e=null;if(s.status>=200&&s.status<300){try{e=hg(s.responseText)}catch(t){Lb("Failed to parse JSON response for "+a+": "+s.responseText)}r(null,e)}else 401!==s.status&&404!==s.status&&Lb("Got unsuccessful REST response for "+a+" Status: "+s.status),r(s.status);r=null}},s.open("GET",a,!0),s.send()})},t}(Qv),Sv="repo_interrupt",Fb=function(){function e(e,t,r,n){this.repoInfo_=e,this.forceRestClient_=t,this.app=r,this.authTokenProvider_=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new tF,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new Tk,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e.prototype.start=function(){var e=this;if(this.stats_=lj.getCollection(this.repoInfo_),this.forceRestClient_||yE())this.server_=new WF(this.repoInfo_,this.onDataUpdate_.bind(this),this.authTokenProvider_),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var t=this.app.options.databaseAuthVariableOverride;if(null!=t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Db(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}this.persistentConnection_=new bf(this.repoInfo_,this.app.options.appId,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),this.authTokenProvider_,t),this.server_=this.persistentConnection_}this.authTokenProvider_.addTokenChangeListener(function(t){e.server_.refreshAuthToken(t)}),this.statsReporter_=lj.getOrCreateReporter(this.repoInfo_,function(){return new sF(e.stats_,e.server_)}),this.transactionsInit_(),this.infoData_=new oF,this.infoSyncTree_=new zv({startListening:function(t,r,n,i){var o=[],a=e.infoData_.getNode(t.path);return a.isEmpty()||(o=e.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new zv({startListening:function(t,r,n,i){return e.server_.listen(t,n,r,function(r,n){var o=i(r,n);e.eventQueue_.raiseEventsForChangedPath(t.path,o)}),[]},stopListening:function(t,r){e.server_.unlisten(t,r)}})},e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e.prototype.name=function(){return this.repoInfo_.namespace},e.prototype.serverTime=function(){var e=this.infoData_.getNode(new db(".info/serverTimeOffset")).val()||0;return new Date().getTime()+e},e.prototype.generateServerValues=function(){return bF({timestamp:this.serverTime()})},e.prototype.onDataUpdate_=function(e,t,r,n){this.dataUpdateCount++;var i=new db(e);t=this.interceptServerDataCallback_?this.interceptServerDataCallback_(e,t):t;var o=[];if(n){if(r){var a=Zg(t,function(e){return yb(e)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,n)}else{var s=yb(t);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,s,n)}}else if(r){var l=Zg(t,function(e){return yb(e)});o=this.serverSyncTree_.applyServerMerge(i,l)}else{var $=yb(t);o=this.serverSyncTree_.applyServerOverwrite(i,$)}var h=i;o.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,o)},e.prototype.interceptServerData_=function(e){this.interceptServerDataCallback_=e},e.prototype.onConnectStatus_=function(e){this.updateInfo_("connected",e),!1===e&&this.runOnDisconnectEvents_()},e.prototype.onServerInfoUpdate_=function(e){var t=this;Ab(e,function(e,r){t.updateInfo_(e,r)})},e.prototype.updateInfo_=function(e,t){var r=new db("/.info/"+e),n=yb(t);this.infoData_.updateSnapshot(r,n);var i=this.infoSyncTree_.applyServerOverwrite(r,n);this.eventQueue_.raiseEventsForChangedPath(r,i)},e.prototype.getNextWriteId_=function(){return this.nextWriteId_++},e.prototype.setWithPriority=function(e,t,r,n){var i=this;this.log_("set",{path:e.toString(),value:t,priority:r});var o=this.generateServerValues(),a=yb(t,r),s=this.serverSyncTree_.calcCompleteEventCache(e),l=Rk(a,s,o),$=this.getNextWriteId_(),h=this.serverSyncTree_.applyUserOverwrite(e,l,$,!0);this.eventQueue_.queueEvents(h),this.server_.put(e.toString(),a.val(!0),function(t,r){var o="ok"===t;o||Lb("set at "+e+" failed: "+t);var a=i.serverSyncTree_.ackUserWrite($,!o);i.eventQueue_.raiseEventsForChangedPath(e,a),i.callOnCompleteCallback(n,t,r)});var u=this.abortTransactions_(e);this.rerunTransactions_(u),this.eventQueue_.raiseEventsForChangedPath(u,[])},e.prototype.update=function(e,t,r){var n=this;this.log_("update",{path:e.toString(),value:t});var i=!0,o=this.generateServerValues(),a={};if(Ab(t,function(t,r){i=!1,a[t]=rv(e.child(t),yb(r),n.serverSyncTree_,o)}),i)Hb("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(r,"ok");else{var s=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserMerge(e,a,s);this.eventQueue_.queueEvents(l),this.server_.merge(e.toString(),t,function(t,i){var o="ok"===t;o||Lb("update at "+e+" failed: "+t);var a=n.serverSyncTree_.ackUserWrite(s,!o),l=a.length>0?n.rerunTransactions_(e):e;n.eventQueue_.raiseEventsForChangedPath(l,a),n.callOnCompleteCallback(r,t,i)}),Ab(t,function(t){var r=n.abortTransactions_(e.child(t));n.rerunTransactions_(r)}),this.eventQueue_.raiseEventsForChangedPath(e,[])}},e.prototype.runOnDisconnectEvents_=function(){var e=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),r=new Tk;this.onDisconnect_.forEachTree(db.Empty,function(n,i){var o=rv(n,i,e.serverSyncTree_,t);r.remember(n,o)});var n=[];r.forEachTree(db.Empty,function(t,r){n=n.concat(e.serverSyncTree_.applyServerOverwrite(t,r));var i=e.abortTransactions_(t);e.rerunTransactions_(i)}),this.onDisconnect_=new Tk,this.eventQueue_.raiseEventsForChangedPath(db.Empty,n)},e.prototype.onDisconnectCancel=function(e,t){var r=this;this.server_.onDisconnectCancel(e.toString(),function(n,i){"ok"===n&&r.onDisconnect_.forget(e),r.callOnCompleteCallback(t,n,i)})},e.prototype.onDisconnectSet=function(e,t,r){var n=this,i=yb(t);this.server_.onDisconnectPut(e.toString(),i.val(!0),function(t,o){"ok"===t&&n.onDisconnect_.remember(e,i),n.callOnCompleteCallback(r,t,o)})},e.prototype.onDisconnectSetWithPriority=function(e,t,r,n){var i=this,o=yb(t,r);this.server_.onDisconnectPut(e.toString(),o.val(!0),function(t,r){"ok"===t&&i.onDisconnect_.remember(e,o),i.callOnCompleteCallback(n,t,r)})},e.prototype.onDisconnectUpdate=function(e,t,r){var n=this;if(zk(t))return Hb("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(r,"ok");this.server_.onDisconnectMerge(e.toString(),t,function(i,o){"ok"===i&&Ab(t,function(t,r){var i=yb(r);n.onDisconnect_.remember(e.child(t),i)}),n.callOnCompleteCallback(r,i,o)})},e.prototype.addEventCallbackForQuery=function(e,t){var r;r=".info"===e.path.getFront()?this.infoSyncTree_.addEventRegistration(e,t):this.serverSyncTree_.addEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,r)},e.prototype.removeEventCallbackForQuery=function(e,t){var r;r=".info"===e.path.getFront()?this.infoSyncTree_.removeEventRegistration(e,t):this.serverSyncTree_.removeEventRegistration(e,t),this.eventQueue_.raiseEventsAtPath(e.path,r)},e.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(Sv)},e.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(Sv)},e.prototype.stats=function(e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var t;e?(this.statsListener_||(this.statsListener_=new Av(this.stats_)),t=this.statsListener_.get()):t=this.stats_.get();var r=Object.keys(t).reduce(function(e,t){return Math.max(t.length,e)},0);Ab(t,function(e,t){for(var n=e,i=e.length;i<r+2;i++)n+=" ";console.log(n+t)})}},e.prototype.statsIncrementCounter=function(e){this.stats_.incrementCounter(e),this.statsReporter_.includeStat(e)},e.prototype.log_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r="";this.persistentConnection_&&(r=this.persistentConnection_.id+":"),Hb.apply(void 0,Yd([r],e))},e.prototype.callOnCompleteCallback=function(e,t,r){e&&Hf(function(){if("ok"===t)e(null);else{var n=(t||"error").toUpperCase(),i=n;r&&(i+=": "+r);var o=new Error(i);o.code=n,e(o)}})},Object.defineProperty(e.prototype,"database",{get:function(){return this.__database||(this.__database=new _k(this))},enumerable:!1,configurable:!0}),e}(),Tv=function(){function e(t){this.indexedFilter_=new Wk(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,r,n,i,o){return this.matches(new lb(t,r))||(r=hb.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,n,i,o)},e.prototype.updateFullNode=function(e,t,r){t.isLeafNode()&&(t=hb.EMPTY_NODE);var n=t.withIndex(this.index_);n=n.updatePriority(hb.EMPTY_NODE);var i=this;return t.forEachChild(qb,function(e,t){i.matches(new lb(e,t))||(n=n.updateImmediateChild(e,hb.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),XF=function(){function e(e){this.rangedFilter_=new Tv(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,r,n,i,o){return this.rangedFilter_.matches(new lb(t,r))||(r=hb.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,n,i,o):this.fullLimitUpdateChild_(e,t,r,i,o)},e.prototype.updateFullNode=function(e,t,r){var n;if(t.isLeafNode()||t.isEmpty())n=hb.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){n=hb.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;n=n.updateImmediateChild(a.name,a.node),o++}}else{n=(n=t.withIndex(this.index_)).updatePriority(hb.EMPTY_NODE);var s=void 0,l=void 0,$=void 0;i=void 0;if(this.reverse_){i=n.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();$=function(e,t){return h(t,e)}}else i=n.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),$=this.index_.getCompare();o=0;for(var u=!1;i.hasNext();){a=i.getNext();!u&&$(s,a)<=0&&(u=!0),u&&o<this.limit_&&$(a,l)<=0?o++:n=n.updateImmediateChild(a.name,hb.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,n,r)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,r,n,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(e,t){return a(t,e)}}else o=this.index_.getCompare();var s=e;cb(s.numChildren()===this.limit_,"");var l=new lb(t,r),$=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),h=this.rangedFilter_.matches(l);if(s.hasChild(t)){for(var u=s.getImmediateChild(t),c=n.getChildAfterChild(this.index_,$,this.reverse_);null!=c&&(c.name===t||s.hasChild(c.name));)c=n.getChildAfterChild(this.index_,c,this.reverse_);var p=null==c?1:o(c,l);if(h&&!r.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(ib.childChangedChange(t,r,u)),s.updateImmediateChild(t,r);null!=i&&i.trackChildChange(ib.childRemovedChange(t,u));var d=s.updateImmediateChild(t,hb.EMPTY_NODE);return null!=c&&this.rangedFilter_.matches(c)?(null!=i&&i.trackChildChange(ib.childAddedChange(c.name,c.node)),d.updateImmediateChild(c.name,c.node)):d}return r.isEmpty()?e:h&&o($,l)>=0?(null!=i&&(i.trackChildChange(ib.childRemovedChange($.name,$.node)),i.trackChildChange(ib.childAddedChange(t,r))),s.updateImmediateChild(t,r).updateImmediateChild($.name,hb.EMPTY_NODE)):e},e}(),YF=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=qb}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},e.prototype.getIndexStartValue=function(){return cb(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return cb(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:$d},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return cb(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return cb(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Ed},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return cb(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.copy_=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e.prototype.limit=function(e){var t=this.copy_();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="",t},e.prototype.limitToFirst=function(t){var r=this.copy_();return r.limitSet_=!0,r.limit_=t,r.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,r},e.prototype.limitToLast=function(t){var r=this.copy_();return r.limitSet_=!0,r.limit_=t,r.viewFrom_=e.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,r},e.prototype.startAt=function(e,t){var r=this.copy_();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r},e.prototype.endAt=function(e,t){var r=this.copy_();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r},e.prototype.orderBy=function(e){var t=this.copy_();return t.index_=e,t},e.prototype.getQueryObject=function(){var t=e.WIRE_PROTOCOL_CONSTANTS_,r={};if(this.startSet_&&(r[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(r[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(r[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(r[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){r[t.LIMIT]=this.limit_;var n=this.viewFrom_;""===n&&(n=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),r[t.VIEW_FROM]=n}return this.index_!==qb&&(r[t.INDEX]=this.index_.toString()),r},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===qb},e.prototype.getNodeFilter=function(){return this.loadsAllData()?new Wk(this.getIndex()):this.hasLimit()?new XF(this):new Tv(this)},e.prototype.toRestQueryStringParameters=function(){var t,r=e.REST_QUERY_CONSTANTS_,n={};return this.isDefault()?n:(this.index_===qb?t=r.PRIORITY_INDEX:this.index_===Ok?t=r.VALUE_INDEX:this.index_===Gd?t=r.KEY_INDEX:(cb(this.index_ instanceof Pk,"Unrecognized index type!"),t=this.index_.toString()),n[r.ORDER_BY]=Db(t),this.startSet_&&(n[r.START_AT]=Db(this.indexStartValue_),this.startNameSet_&&(n[r.START_AT]+=","+Db(this.indexStartName_))),this.endSet_&&(n[r.END_AT]=Db(this.indexEndValue_),this.endNameSet_&&(n[r.END_AT]+=","+Db(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[r.LIMIT_TO_FIRST]=this.limit_:n[r.LIMIT_TO_LAST]=this.limit_),n)},e.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},e.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},e.DEFAULT=new e,e}(),sd=function(e){function t(t,r){if(!(t instanceof Fb))throw new Error("new Reference() no longer supported - use app.database().");return e.call(this,t,r,YF.DEFAULT,!1)||this}return Zb(t,e),t.prototype.getKey=function(){return fb("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},t.prototype.child=function(e){return fb("Reference.child",1,1,arguments.length),"number"==typeof e?e=String(e):e instanceof db||(null===this.path.getFront()?HE("Reference.child",1,e,!1):qg("Reference.child",1,e,!1)),new t(this.repo,this.path.child(e))},t.prototype.getParent=function(){fb("Reference.parent",0,0,arguments.length);var e=this.path.parent();return null===e?null:new t(this.repo,e)},t.prototype.getRoot=function(){fb("Reference.root",0,0,arguments.length);for(var e=this;null!==e.getParent();)e=e.getParent();return e},t.prototype.databaseProp=function(){return this.repo.database},t.prototype.set=function(e,t){fb("Reference.set",1,2,arguments.length),Xb("Reference.set",this.path),Fd("Reference.set",1,e,this.path,!1),Eb("Reference.set",2,t,!0);var r=new Vb;return this.repo.setWithPriority(this.path,e,null,r.wrapCallback(t)),r.promise},t.prototype.update=function(e,t){if(fb("Reference.update",1,2,arguments.length),Xb("Reference.update",this.path),Array.isArray(e)){for(var r={},n=0;n<e.length;++n)r[""+n]=e[n];e=r,Lb("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}gv("Reference.update",1,e,this.path,!1),Eb("Reference.update",2,t,!0);var i=new Vb;return this.repo.update(this.path,e,i.wrapCallback(t)),i.promise},t.prototype.setWithPriority=function(e,t,r){if(fb("Reference.setWithPriority",2,3,arguments.length),Xb("Reference.setWithPriority",this.path),Fd("Reference.setWithPriority",1,e,this.path,!1),Kk("Reference.setWithPriority",2,t,!1),Eb("Reference.setWithPriority",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var n=new Vb;return this.repo.setWithPriority(this.path,e,t,n.wrapCallback(r)),n.promise},t.prototype.remove=function(e){return fb("Reference.remove",0,1,arguments.length),Xb("Reference.remove",this.path),Eb("Reference.remove",1,e,!0),this.set(null,e)},t.prototype.transaction=function(e,t,r){if(fb("Reference.transaction",1,3,arguments.length),Xb("Reference.transaction",this.path),Eb("Reference.transaction",1,e,!1),Eb("Reference.transaction",2,t,!0),IE("Reference.transaction",3,r,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===r&&(r=!0);var n=new Vb;"function"==typeof t&&n.promise.catch(function(){});return this.repo.startTransaction(this.path,e,function(e,r,i){e?n.reject(e):n.resolve(new KE(r,i)),"function"==typeof t&&t(e,r,i)},r),n.promise},t.prototype.setPriority=function(e,t){fb("Reference.setPriority",1,2,arguments.length),Xb("Reference.setPriority",this.path),Kk("Reference.setPriority",1,e,!1),Eb("Reference.setPriority",2,t,!0);var r=new Vb;return this.repo.setWithPriority(this.path.child(".priority"),e,null,r.wrapCallback(t)),r.promise},t.prototype.push=function(e,t){fb("Reference.push",0,2,arguments.length),Xb("Reference.push",this.path),Fd("Reference.push",1,e,this.path,!0),Eb("Reference.push",2,t,!0);var r,n=this.repo.serverTime(),i=LE(n),o=this.child(i),a=this.child(i);return r=null!=e?o.set(e,t).then(function(){return a}):Promise.resolve(a),o.then=r.then.bind(r),o.catch=r.then.bind(r,void 0),"function"==typeof t&&r.catch(function(){}),o},t.prototype.onDisconnect=function(){return Xb("Reference.onDisconnect",this.path),new JE(this.repo,this.path)},Object.defineProperty(t.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),t}(Qk);Qk.__referenceConstructor=sd,wv.__referenceConstructor=sd;var Bb,Uv=function(){return function(){this.children={},this.childCount=0,this.value=null}}(),ZF=function(){function e(e,t,r){void 0===e&&(e=""),void 0===t&&(t=null),void 0===r&&(r=new Uv),this.name_=e,this.parent_=t,this.node_=r}return e.prototype.subTree=function(t){for(var r=t instanceof db?t:new db(t),n=this,i=r.getFront();null!==i;){n=new e(i,n,$b(n.node_.children,i)||new Uv),i=(r=r.popFront()).getFront()}return n},e.prototype.getValue=function(){return this.node_.value},e.prototype.setValue=function(e){cb(void 0!==e,"Cannot set value to undefined"),this.node_.value=e,this.updateParents_()},e.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},e.prototype.hasChildren=function(){return this.node_.childCount>0},e.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},e.prototype.forEachChild=function(t){var r=this;Ab(this.node_.children,function(n,i){t(new e(n,r,i))})},e.prototype.forEachDescendant=function(e,t,r){t&&!r&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,r)}),t&&r&&e(this)},e.prototype.forEachAncestor=function(e,t){for(var r=t?this:this.parent();null!==r;){if(e(r))return!0;r=r.parent()}return!1},e.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},e.prototype.path=function(){return new db(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},e.prototype.name=function(){return this.name_},e.prototype.parent=function(){return this.parent_},e.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},e.prototype.updateChild_=function(e,t){var r=t.isEmpty(),n=Pb(this.node_.children,e);r&&n?(delete this.node_.children[e],this.node_.childCount--,this.updateParents_()):r||n||(this.node_.children[e]=t.node_,this.node_.childCount++,this.updateParents_())},e}();!function(e){e[e.RUN=0]="RUN",e[e.SENT=1]="SENT",e[e.COMPLETED=2]="COMPLETED",e[e.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",e[e.NEEDS_ABORT=4]="NEEDS_ABORT"}(Bb||(Bb={})),Fb.MAX_TRANSACTION_RETRIES_=25,Fb.prototype.transactionsInit_=function(){this.transactionQueueTree_=new ZF},Fb.prototype.startTransaction=function(e,t,r,n){this.log_("transaction on "+e);var i=function(){},o=new sd(this,e);o.on("value",i);var a={path:e,update:t,onComplete:r,status:null,order:Vq(),applyLocally:n,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},s=this.getLatestState_(e);a.currentInputSnapshot=s;var l=a.update(s.val());if(void 0===l){if(a.unwatcher(),a.currentOutputSnapshotRaw=null,a.currentOutputSnapshotResolved=null,a.onComplete){var $=new Kf(a.currentInputSnapshot,new sd(this,a.path),qb);a.onComplete(null,!1,$)}}else{pg("transaction failed: Data returned ",l,a.path),a.status=Bb.RUN;var h=this.transactionQueueTree_.subTree(e),u=h.getValue()||[];u.push(a),h.setValue(u);var c=void 0;if("object"==typeof l&&null!==l&&Pb(l,".priority"))c=$b(l,".priority"),cb(og(c),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else c=(this.serverSyncTree_.calcCompleteEventCache(e)||hb.EMPTY_NODE).getPriority().val();c=c;var p=this.generateServerValues(),d=yb(l,c),v=Rk(d,s,p);a.currentOutputSnapshotRaw=d,a.currentOutputSnapshotResolved=v,a.currentWriteId=this.getNextWriteId_();var E=this.serverSyncTree_.applyUserOverwrite(e,v,a.currentWriteId,a.applyLocally);this.eventQueue_.raiseEventsForChangedPath(e,E),this.sendReadyTransactions_()}},Fb.prototype.getLatestState_=function(e,t){return this.serverSyncTree_.calcCompleteEventCache(e,t)||hb.EMPTY_NODE},Fb.prototype.sendReadyTransactions_=function(e){var t=this;if(void 0===e&&(e=this.transactionQueueTree_),e||this.pruneCompletedTransactionsBelowNode_(e),null!==e.getValue()){var r=this.buildTransactionQueue_(e);cb(r.length>0,"Sending zero length transaction queue"),r.every(function(e){return e.status===Bb.RUN})&&this.sendTransactionQueue_(e.path(),r)}else e.hasChildren()&&e.forEachChild(function(e){t.sendReadyTransactions_(e)})},Fb.prototype.sendTransactionQueue_=function(e,t){for(var r=this,n=t.map(function(e){return e.currentWriteId}),i=this.getLatestState_(e,n),o=i,a=i.hash(),s=0;s<t.length;s++){var l=t[s];cb(l.status===Bb.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=Bb.SENT,l.retryCount++;var $=db.relativePath(e,l.path);o=o.updateChild($,l.currentOutputSnapshotRaw)}var h=o.val(!0),u=e;this.server_.put(u.toString(),h,function(n){r.log_("transaction put response",{path:u.toString(),status:n});var i=[];if("ok"===n){for(var o=[],a=0;a<t.length;a++){if(t[a].status=Bb.COMPLETED,i=i.concat(r.serverSyncTree_.ackUserWrite(t[a].currentWriteId)),t[a].onComplete){var s=t[a].currentOutputSnapshotResolved,l=new sd(r,t[a].path),$=new Kf(s,l,qb);o.push(t[a].onComplete.bind(null,null,!0,$))}t[a].unwatcher()}r.pruneCompletedTransactionsBelowNode_(r.transactionQueueTree_.subTree(e)),r.sendReadyTransactions_(),r.eventQueue_.raiseEventsForChangedPath(e,i);for(a=0;a<o.length;a++)Hf(o[a])}else{if("datastale"===n)for(a=0;a<t.length;a++)t[a].status===Bb.SENT_NEEDS_ABORT?t[a].status=Bb.NEEDS_ABORT:t[a].status=Bb.RUN;else{Lb("transaction at "+u.toString()+" failed: "+n);for(a=0;a<t.length;a++)t[a].status=Bb.NEEDS_ABORT,t[a].abortReason=n}r.rerunTransactions_(e)}},a)},Fb.prototype.rerunTransactions_=function(e){var t=this.getAncestorTransactionNode_(e),r=t.path(),n=this.buildTransactionQueue_(t);return this.rerunTransactionQueue_(n,r),r},Fb.prototype.rerunTransactionQueue_=function(e,t){if(0!==e.length){for(var r,n=[],i=[],o=e.filter(function(e){return e.status===Bb.RUN}).map(function(e){return e.currentWriteId}),a=0;a<e.length;a++){var s=e[a],l=db.relativePath(t,s.path),$=!1,h=void 0;if(cb(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===Bb.NEEDS_ABORT)$=!0,h=s.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===Bb.RUN)if(s.retryCount>=Fb.MAX_TRANSACTION_RETRIES_)$=!0,h="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var u=this.getLatestState_(s.path,o);s.currentInputSnapshot=u;var c=e[a].update(u.val());if(void 0!==c){pg("transaction failed: Data returned ",c,s.path);var p=yb(c);"object"==typeof c&&null!=c&&Pb(c,".priority")||(p=p.updatePriority(u.getPriority()));var d=s.currentWriteId,v=this.generateServerValues(),E=Rk(p,u,v);s.currentOutputSnapshotRaw=p,s.currentOutputSnapshotResolved=E,s.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(d),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(s.path,E,s.currentWriteId,s.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(d,!0))}else $=!0,h="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(t,i),i=[],$&&(e[a].status=Bb.COMPLETED,r=e[a].unwatcher,setTimeout(r,Math.floor(0)),e[a].onComplete))if("nodata"===h){var _=new sd(this,e[a].path),f=e[a].currentInputSnapshot,y=new Kf(f,_,qb);n.push(e[a].onComplete.bind(null,null,!1,y))}else n.push(e[a].onComplete.bind(null,new Error(h),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(a=0;a<n.length;a++)Hf(n[a]);this.sendReadyTransactions_()}},Fb.prototype.getAncestorTransactionNode_=function(e){var t,r=this.transactionQueueTree_;for(t=e.getFront();null!==t&&null===r.getValue();)r=r.subTree(t),t=(e=e.popFront()).getFront();return r},Fb.prototype.buildTransactionQueue_=function(e){var t=[];return this.aggregateTransactionQueuesForNode_(e,t),t.sort(function(e,t){return e.order-t.order}),t},Fb.prototype.aggregateTransactionQueuesForNode_=function(e,t){var r=this,n=e.getValue();if(null!==n)for(var i=0;i<n.length;i++)t.push(n[i]);e.forEachChild(function(e){r.aggregateTransactionQueuesForNode_(e,t)})},Fb.prototype.pruneCompletedTransactionsBelowNode_=function(e){var t=this,r=e.getValue();if(r){for(var n=0,i=0;i<r.length;i++)r[i].status!==Bb.COMPLETED&&(r[n]=r[i],n++);r.length=n,e.setValue(r.length>0?r:null)}e.forEachChild(function(e){t.pruneCompletedTransactionsBelowNode_(e)})},Fb.prototype.abortTransactions_=function(e){var t=this,r=this.getAncestorTransactionNode_(e).path(),n=this.transactionQueueTree_.subTree(e);return n.forEachAncestor(function(e){t.abortTransactionsOnNode_(e)}),this.abortTransactionsOnNode_(n),n.forEachDescendant(function(e){t.abortTransactionsOnNode_(e)}),r},Fb.prototype.abortTransactionsOnNode_=function(e){var t=e.getValue();if(null!==t){for(var r=[],n=[],i=-1,o=0;o<t.length;o++)if(t[o].status===Bb.SENT_NEEDS_ABORT);else if(t[o].status===Bb.SENT)cb(i===o-1,"All SENT items should be at beginning of queue."),i=o,t[o].status=Bb.SENT_NEEDS_ABORT,t[o].abortReason="set";else if(cb(t[o].status===Bb.RUN,"Unexpected transaction status in abort"),t[o].unwatcher(),n=n.concat(this.serverSyncTree_.ackUserWrite(t[o].currentWriteId,!0)),t[o].onComplete){r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))}-1===i?e.setValue(null):t.length=i+1,this.eventQueue_.raiseEventsForChangedPath(e.path(),n);for(o=0;o<r.length;o++)Hf(r[o])}};var Vv,$F=function(){function e(e,t){var r=this;this.app_=e,this.authProvider_=t,this.auth_=null,this.auth_=t.getImmediate({optional:!0}),this.auth_||t.get().then(function(e){return r.auth_=e})}return e.prototype.getToken=function(e){return this.auth_?this.auth_.getToken(e).catch(function(e){return e&&"auth/token-not-initialized"===e.code?(Hb("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)}):Promise.resolve(null)},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):(setTimeout(function(){return e(null)},0),this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)}))},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})},e.prototype.notifyForInvalidToken=function(){var e="Provided authentication credentials for the app named \""+this.app_.name+"\" are invalid. This usually indicates your app was not initialized correctly. ";"credential"in this.app_.options?e+="Make sure the \"credential\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.":"serviceAccount"in this.app_.options?e+="Make sure the \"serviceAccount\" property provided to initializeApp() is authorized to access the specified \"databaseURL\" and is from the correct project.":e+="Make sure the \"apiKey\" and \"databaseURL\" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.",Lb(e)},e}(),Wv=function(){function e(){}return e.prototype.getToken=function(t){return Promise.resolve({accessToken:e.EMULATOR_AUTH_TOKEN})},e.prototype.addTokenChangeListener=function(t){t(e.EMULATOR_AUTH_TOKEN)},e.prototype.removeTokenChangeListener=function(e){},e.prototype.notifyForInvalidToken=function(){},e.EMULATOR_AUTH_TOKEN="owner",e}(),_F="FIREBASE_DATABASE_EMULATOR_HOST",tg=function(){function e(){this.repos_={},this.useRestClient_=!1}return e.getInstance=function(){return Vv||(Vv=new e),Vv},e.prototype.interrupt=function(){var e,t,r,n;try{for(var i=Kb(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(r=void 0,Kb(Object.keys(this.repos_[a]))),l=s.next();!l.done;l=s.next()){var $=l.value;this.repos_[a][$].interrupt()}}catch(h){r={error:h}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}catch(u){e={error:u}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.resume=function(){var e,t,r,n;try{for(var i=Kb(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var a=o.value;try{for(var s=(r=void 0,Kb(Object.keys(this.repos_[a]))),l=s.next();!l.done;l=s.next()){var $=l.value;this.repos_[a][$].resume()}}catch(h){r={error:h}}finally{try{l&&!l.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}}catch(u){e={error:u}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},e.prototype.applyEmulatorSettings=function(e,t,r){e.repoInfo_=new Gk(t+":"+r,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),e.repoInfo_.nodeAdmin&&(e.authTokenProvider_=new Wv)},e.prototype.databaseFromApp=function(e,t,r,n){var i=r||e.options.databaseURL;void 0===i&&(e.options.projectId||gd("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Hb("Using default host for project ",e.options.projectId),i=e.options.projectId+"-default-rtdb.firebaseio.com");var o,a=Ik(i,n),s=a.repoInfo,l=void 0;void 0!==bj&&(l=bj.env[_F]),l?(o=!0,i="http://"+l+"?ns="+s.namespace,s=(a=Ik(i,n)).repoInfo):o=!a.repoInfo.secure;var $=n&&o?new Wv:new $F(e,t);return hv("Invalid Firebase Database URL",1,a),a.path.isEmpty()||gd("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(s,e,$).database},e.prototype.deleteRepo=function(e){var t=$b(this.repos_,e.app.name);t&&$b(t,e.key)===e||gd("Database "+e.app.name+"("+e.repoInfo_+") has already been deleted."),e.interrupt(),delete t[e.key]},e.prototype.createRepo=function(e,t,r){var n=$b(this.repos_,t.name);n||(n={},this.repos_[t.name]=n);var i=$b(n,e.toURLString());return i&&gd("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new Fb(e,this.useRestClient_,t,r),n[e.toURLString()]=i,i},e.prototype.forceRestClient=function(e){this.useRestClient_=e},e}(),_k=function(){function e(e){var t=this;this.repoInternal_=e,this.instanceStarted_=!1,this.INTERNAL={delete:function(){return Dq(t,void 0,void 0,function(){return Eq(this,function(e){return this.checkDeleted_("delete"),tg.getInstance().deleteRepo(this.repo_),this.repoInternal_=null,this.rootInternal_=null,[2]})})}},e instanceof Fb||gd("Don't call new Database() directly - please use firebase.database().")}return Object.defineProperty(e.prototype,"repo_",{get:function(){return this.instanceStarted_||(this.repoInternal_.start(),this.instanceStarted_=!0),this.repoInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root_",{get:function(){return this.rootInternal_||(this.rootInternal_=new sd(this.repo_,db.Empty)),this.rootInternal_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"app",{get:function(){return this.repo_.app},enumerable:!1,configurable:!0}),e.prototype.useEmulator=function(e,t){this.checkDeleted_("useEmulator"),this.instanceStarted_?gd("Cannot call useEmulator() after instance has already been initialized."):tg.getInstance().applyEmulatorSettings(this.repoInternal_,e,t)},e.prototype.ref=function(e){return this.checkDeleted_("ref"),fb("database.ref",0,1,arguments.length),e instanceof sd?this.refFromURL(e.toString()):void 0!==e?this.root_.child(e):this.root_},e.prototype.refFromURL=function(e){var t="database.refFromURL";this.checkDeleted_(t),fb(t,1,1,arguments.length);var r=Ik(e,this.repo_.repoInfo_.nodeAdmin);hv(t,1,r);var n=r.repoInfo;return n.isCustomHost()||n.host===this.repo_.repoInfo_.host||gd(t+": Host name does not match the current database: (found "+n.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(r.path.toString())},e.prototype.checkDeleted_=function(e){null===this.repoInternal_&&gd("Cannot call "+e+" on a deleted database.")},e.prototype.goOffline=function(){fb("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},e.prototype.goOnline=function(){fb("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},e.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:function(e){return{".sv":{increment:e}}}},e}(),aG=function(){af.forceDisallow(),Yk.forceAllow()},bG=function(){Yk.forceDisallow()},cG=function(){return af.isAvailable()},dG=function(e,t){e.repo.persistentConnection_.securityDebugCallback_=t},eG=function(e,t){e.repo.stats(t)},fG=function(e,t){e.repo.statsIncrementCounter(t)},gG=function(e){return e.repo.dataUpdateCount},hG=function(e,t){return e.repo.interceptServerData_(t)};function iG(e){var t=e.app,r=e.url,n=e.version,i=e.customAuthImpl,o=e.namespace,a=e.nodeAdmin,s=void 0!==a&&a;Iv(n);var l=new Mq("auth-internal",new Nq("database-standalone"));return l.setComponent(new ig("auth-internal",function(){return i},"PRIVATE")),{instance:tg.getInstance().databaseFromApp(t,l,r,s),namespace:o}}var jG=Object.freeze({__proto__:null,forceLongPolling:aG,forceWebSockets:bG,isWebSocketsAvailable:cG,setSecurityDebugCallback:dG,stats:eG,statsIncrementCounter:fG,dataUpdateCount:gG,interceptServerData:hG,initStandalone:iG}),kG=bf;bf.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},bf.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var lG=Pv,mG=function(e){var t=bf.prototype.put;return bf.prototype.put=function(r,n,i,o){void 0!==o&&(o=e()),t.call(this,r,n,i,o)},function(){bf.prototype.put=t}},nG=Gk,oG=function(e){return e.queryIdentifier()},pG=function(e){tg.getInstance().forceRestClient(e)},qG=Object.freeze({__proto__:null,DataConnection:kG,RealTimeConnection:lG,hijackHash:mG,ConnectionTarget:nG,queryIdentifier:oG,forceRestClient:pG}),rG="@firebase/database",sG="0.7.0",tG=_k.ServerValue;function uG(e){Iv(e.SDK_VERSION);var t=e.INTERNAL.registerComponent(new ig("database",function(e,t){var r=e.getProvider("app").getImmediate(),n=e.getProvider("auth-internal");return tg.getInstance().databaseFromApp(r,n,t)},"PUBLIC").setServiceProps({Reference:sd,Query:Qk,Database:_k,DataSnapshot:Kf,enableLogging:Xq,INTERNAL:jG,ServerValue:tG,TEST_ACCESS:qG}).setMultipleInstances(!0));e.registerVersion(rG,sG),fd()&&t}uG(gb);gb.initializeApp({apiKey:"AIzaSyDMhnS2dJk0yTMERT0j4g6jEQ80_nikPHw",authDomain:"flickering-torch-6356.firebaseapp.com",databaseURL:"https://flickering-torch-6356.firebaseio.com",projectId:"flickering-torch-6356",storageBucket:"flickering-torch-6356.appspot.com",messagingSenderId:"60549942221"});var Xv=gb.auth();Yg.auth=Xv;var Yv=gb.database();Yg.database=Yv;function vG(r,t){return zG(r)||yG(r,t)||xG(r,t)||wG()}function wG(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function xG(r,t){if(r){if("string"==typeof r)return Zv(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return"Object"===e&&r.constructor&&(e=r.constructor.name),"Map"===e||"Set"===e?Array.from(r):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Zv(r,t):void 0}}function Zv(r,t){(null==t||t>r.length)&&(t=r.length);for(var e=0,a=new Array(t);e<t;e++)a[e]=r[e];return a}function yG(r,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(r)){var e=[],a=!0,n=!1,o=void 0;try{for(var $,i=r[Symbol.iterator]();!(a=($=i.next()).done)&&(e.push($.value),!t||e.length!==t);a=!0);}catch(l){n=!0,o=l}finally{try{a||null==i.return||i.return()}finally{if(n)throw o}}return e}}function zG(r){if(Array.isArray(r))return r}function $v(r){var t=vG(r,4),e=t[0],a=t[1],n=t[2],o=t[3],$=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=e+e,l=a+a,u=n+n,y=e*i,v=e*l,c=e*u,f=a*l,s=a*u,L=n*u,O=o*i,b=o*l,d=o*u;return $[0]=1-(f+L),$[1]=v+d,$[2]=c-b,$[4]=v-d,$[5]=1-(y+L),$[6]=s+O,$[8]=c+b,$[9]=s-O,$[10]=1-(y+f),$}function AG(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _v(t,i){for(var e=0;e<i.length;e++){var s=i[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function BG(t,i,e){return i&&_v(t.prototype,i),e&&_v(t,e),t}function Lf($){return Math.abs(parseInt("".concat($),10))}function Ib($,n){return $.x*n.x+$.y*n.y}function Mf($,n){return $.x*n.y-$.y*n.x}function cf($){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new ab(n*$.y,-n*$.x)}function mj(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return new ab(-$*n.y,$*n.x)}function df($,n){return new ab($.col1.x*n.x+$.col2.x*n.y,$.col1.y*n.x+$.col2.y*n.y)}function Hd($,n){return new ab(Ib(n,$.col1),Ib(n,$.col2))}function vb($,n){var o=df($.R,n);return o.x+=$.position.x,o.y+=$.position.y,o}function CG($,n){var o=rb(n,$.position),t=o.x*$.R.col1.x+o.y*$.R.col1.y;return o.y=o.x*$.R.col2.x+o.y*$.R.col2.y,o.x=t,o}function nj($,n){return new ab($.x+n.x,$.y+n.y)}function rb($,n){return new ab($.x-n.x,$.y-n.y)}function aw(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1?arguments[1]:void 0;return new ab($*n.x,$*n.y)}function Ql(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return $>0?$:-$}function DG($){return new ab(Ql($.x),Ql($.y))}function EG(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $<n?$:n}function ug(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $>n?$:n}function td(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return $<n?n:$>o?o:$}function FG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function bw(e,t){for(var o=0;o<t.length;o++){var l=t[o];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(e,l.key,l)}}function GG(e,t,o){return t&&bw(e.prototype,t),o&&bw(e,o),e}var Id=function(){function e(){FG(this,e),this.col1=new ab,this.col2=new ab,this.SetIdentity()}return GG(e,[{key:"Set",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=Math.cos(e),o=Math.sin(e);this.col1.x=t,this.col2.x=-o,this.col1.y=o,this.col2.y=t}},{key:"SetVV",value:function(e,t){this.col1.SetV(e),this.col2.SetV(t)}},{key:"Copy",value:function(){var t=new e;return t.SetM(this),t}},{key:"SetM",value:function(e){this.col1.SetV(e.col1),this.col2.SetV(e.col2)}},{key:"AddM",value:function(e){this.col1.x+=e.col1.x,this.col1.y+=e.col1.y,this.col2.x+=e.col2.x,this.col2.y+=e.col2.y}},{key:"SetIdentity",value:function(){this.col1.x=1,this.col2.x=0,this.col1.y=0,this.col2.y=1}},{key:"SetZero",value:function(){this.col1.x=0,this.col2.x=0,this.col1.y=0,this.col2.y=0}},{key:"GetAngle",value:function(){return Math.atan2(this.col1.y,this.col1.x)}},{key:"GetInverse",value:function(e){var t=this.col1.x,o=this.col2.x,l=this.col1.y,c=this.col2.y,i=t*c-o*l;return 0!==i&&(i=1/i),e.col1.x=i*c,e.col2.x=-i*o,e.col1.y=-i*l,e.col2.y=i*t,e}},{key:"Solve",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=this.col1.x,c=this.col2.x,i=this.col1.y,n=this.col2.y,r=l*n-c*i;return 0!==r&&(r=1/r),e.x=r*(n*t-c*o),e.y=r*(l*o-i*t),e}},{key:"Abs",value:function(){this.col1.Abs(),this.col2.Abs()}}],[{key:"FromAngle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=new e;return o.Set(t),o}},{key:"FromVV",value:function(t,o){var l=new e;return l.SetVV(t,o),l}}]),e}();var ab=function(){function t(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;AG(this,t),this.x=i,this.y=e}return BG(t,[{key:"SetZero",value:function(){this.x=0,this.y=0}},{key:"Set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.x=t,this.y=i}},{key:"SetV",value:function(t){this.x=t.x,this.y=t.y}},{key:"GetNegative",value:function(){return new t(-this.x,-this.y)}},{key:"NegativeSelf",value:function(){this.x=-this.x,this.y=-this.y}},{key:"Copy",value:function(){return new t(this.x,this.y)}},{key:"Add",value:function(t){this.x+=t.x,this.y+=t.y}},{key:"Subtract",value:function(t){this.x-=t.x,this.y-=t.y}},{key:"Multiply",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.x*=t,this.y*=t}},{key:"MulM",value:function(t){var i=this.x;this.x=t.col1.x*i+t.col2.x*this.y,this.y=t.col1.y*i+t.col2.y*this.y}},{key:"MulTM",value:function(t){var i=Ib(this,t.col1);this.y=Ib(this,t.col2),this.x=i}},{key:"CrossVF",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.x;this.x=t*this.y,this.y=-t*i}},{key:"CrossFV",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=this.x;this.x=-t*this.y,this.y=t*i}},{key:"MinV",value:function(t){this.x=this.x<t.x?this.x:t.x,this.y=this.y<t.y?this.y:t.y}},{key:"MaxV",value:function(t){this.x=this.x>t.x?this.x:t.x,this.y=this.y>t.y?this.y:t.y}},{key:"Abs",value:function(){this.x<0&&(this.x=-this.x),this.y<0&&(this.y=-this.y)}},{key:"Length",value:function(){return Math.hypot(this.x,this.y)}},{key:"LengthSquared",value:function(){return this.x*this.x+this.y*this.y}},{key:"Normalize",value:function(){var t=this.Length();if(t<Number.MIN_VALUE)return 0;var i=1/t;return this.x*=i,this.y*=i,t}},{key:"IsValid",value:function(){return isFinite(this.x)&&isFinite(this.y)}}],[{key:"Make",value:function(){return new t(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}}]),t}();function HG(t,a){if(!(t instanceof a))throw new TypeError("Cannot call a class as a function")}function IG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function cw(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function JG(t,e,i){return e&&cw(t.prototype,e),i&&cw(t,i),t}var Zl=Math.PI;var bd=2;var oj=.1;var dw=2;var ud=.005;var vg=8*ud;var KG=32;var LG=32;var MG=1;var NG=.2;var Nf=2;var ew=Nf*Nf;var Of=.5*Zl;var fw=Of*Of;var am=.2;var OG=.5;var gw=.01;var hw=2/180*Zl;function PG(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Math.sqrt($*r)}function QG(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return $>r?$:r}function wb($){if(!$)throw new Error("Assertion failed!")}function RG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iw(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function SG(t,e,i){return e&&iw(t.prototype,e),i&&iw(t,i),t}var ef=function(){function t(){RG(this,t),this.localCenter=new ab,this.c0=new ab,this.c=new ab,this.a0=0,this.a=0,this.t0=0}return SG(t,[{key:"Set",value:function(t){this.localCenter.SetV(t.localCenter),this.c0.SetV(t.c0),this.c.SetV(t.c),this.a0=t.a0,this.a=t.a,this.t0=t.t0}},{key:"Copy",value:function(){var e=new t;return e.Set(this),e}},{key:"GetTransform",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.position.x=(1-e)*this.c0.x+e*this.c.x,t.position.y=(1-e)*this.c0.y+e*this.c.y;var i=(1-e)*this.a0+e*this.a;t.R.Set(i);var s=t.R;t.position.x-=s.col1.x*this.localCenter.x+s.col2.x*this.localCenter.y,t.position.y-=s.col1.y*this.localCenter.x+s.col2.y*this.localCenter.y}},{key:"Advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.t0<t&&1-this.t0>Number.MIN_VALUE){var e=(t-this.t0)/(1-this.t0);this.c0.x=(1-e)*this.c0.x+e*this.c.x,this.c0.y=(1-e)*this.c0.y+e*this.c.y,this.a0=(1-e)*this.a0+e*this.a,this.t0=t}}}]),t}();function TG(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jw(e,t){for(var a=0;a<t.length;a++){var c=t[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}function UG(e,t,a){return t&&jw(e.prototype,t),a&&jw(e,a),e}var vd=function(){function e(t,a){TG(this,e),this.position=new ab,this.R=new Id,t&&this.position.SetV(t),a&&this.R.SetM(a)}return UG(e,[{key:"Initialize",value:function(e,t){this.position.SetV(e),this.R.SetM(t)}},{key:"SetIdentity",value:function(){this.position.SetZero(),this.R.SetIdentity()}},{key:"Set",value:function(e){this.position.SetV(e.position),this.R.SetM(e.R)}},{key:"GetAngle",value:function(){return Math.atan2(this.R.col1.y,this.R.col1.x)}}]),e}();function VG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kw(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function WG(t,e,r){return e&&kw(t.prototype,e),r&&kw(t,r),t}function XG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lw(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function YG(t,e,r){return e&&lw(t.prototype,e),r&&lw(t,r),t}var mw=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;XG(this,t),this._r=0,this._g=0,this._b=0,this.Set(e,r,n)}return YG(t,[{key:"Set",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.r=t,this.g=e,this.b=r}},{key:"r",get:function(){return this._r},set:function(t){this._r=Lf(255*td(t,0,1))}},{key:"g",get:function(){return this._g},set:function(t){this._g=Lf(255*td(t,0,1))}},{key:"b",get:function(){return this._b},set:function(t){this._b=Lf(255*td(t,0,1))}},{key:"color",get:function(){return this._r<<16|this._g<<8|this._b}}]),t}();function ZG(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nw(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function $G(t,e,i){return e&&nw(t.prototype,e),i&&nw(t,i),t}var Mb=function(){function t(){var e=this;ZG(this,t),this.m_drawScale=1,this.m_lineThickness=1,this.m_alpha=1,this.m_fillAlpha=1,this.m_xformScale=1,this.m_sprite={graphics:{clear:function(){if(e.m_ctx){var t=e.m_ctx.canvas,i=t.width,a=t.height;e.m_ctx.clearRect(0,0,i,a)}}}},this.m_drawFlags=0}return $G(t,[{key:"_color",value:function(t,e){return"rgba(".concat((16711680&t)>>16,",").concat((65280&t)>>8,",").concat(255&t,",").concat(e,")")}},{key:"SetFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags=t}},{key:"GetFlags",value:function(){return this.m_drawFlags}},{key:"AppendFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags|=t}},{key:"ClearFlags",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawFlags&=~t}},{key:"SetSprite",value:function(t){this.m_ctx=t}},{key:"GetSprite",value:function(){return this.m_ctx}},{key:"SetDrawScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_drawScale=t}},{key:"GetDrawScale",value:function(){return this.m_drawScale}},{key:"SetLineThickness",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_lineThickness=t,this.m_ctx&&(this.m_ctx.lineWidth=t)}},{key:"GetLineThickness",value:function(){return this.m_lineThickness}},{key:"SetAlpha",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_alpha=t}},{key:"GetAlpha",value:function(){return this.m_alpha}},{key:"SetFillAlpha",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_fillAlpha=t}},{key:"GetFillAlpha",value:function(){return this.m_fillAlpha}},{key:"SetXFormScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_xformScale=t}},{key:"GetXFormScale",value:function(){return this.m_xformScale}},{key:"DrawPolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.moveTo(t[0].x*l,t[0].y*l);for(var o=1;o<e;o++)a.lineTo(t[o].x*l,t[o].y*l);a.lineTo(t[0].x*l,t[0].y*l),a.closePath(),a.stroke()}}},{key:"DrawSolidPolygon",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.fillStyle=this._color(i.color,this.m_fillAlpha),a.moveTo(t[0].x*l,t[0].y*l);for(var o=1;o<e;o++)a.lineTo(t[o].x*l,t[o].y*l);a.lineTo(t[0].x*l,t[0].y*l),a.closePath(),a.fill(),a.stroke()}}},{key:"DrawCircle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if(this.m_ctx&&e){var a=this.m_ctx,l=this.m_drawScale,o=t.x*l,r=t.y*l;a.beginPath(),a.strokeStyle=this._color(i.color,this.m_alpha),a.arc(o,r,e*l,0,2*Math.PI,!0),a.closePath(),a.stroke()}}},{key:"DrawSolidCircle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(this.m_ctx&&e){var l=this.m_ctx,o=this.m_drawScale,r=t.x*o,s=t.y*o;l.moveTo(0,0),l.beginPath(),l.strokeStyle=this._color(a.color,this.m_alpha),l.fillStyle=this._color(a.color,this.m_fillAlpha),l.arc(r,s,e*o,0,2*Math.PI,!0),l.moveTo(r,s),l.lineTo((t.x+i.x*e)*o,(t.y+i.y*e)*o),l.closePath(),l.fill(),l.stroke()}}},{key:"DrawSegment",value:function(t,e,i){if(this.m_ctx){var a=this.m_ctx,l=this.m_drawScale;a.strokeStyle=this._color(i.color,this.m_alpha),a.beginPath(),a.moveTo(t.x*l,t.y*l),a.lineTo(e.x*l,e.y*l),a.closePath(),a.stroke()}}},{key:"DrawTransform",value:function(t){if(this.m_ctx){var e=this.m_ctx,i=this.m_drawScale;e.beginPath(),e.strokeStyle=this._color(16711680,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col1.x)*i,(t.position.y+this.m_xformScale*t.R.col1.y)*i),e.strokeStyle=this._color(65280,this.m_alpha),e.moveTo(t.position.x*i,t.position.y*i),e.lineTo((t.position.x+this.m_xformScale*t.R.col2.x)*i,(t.position.y+this.m_xformScale*t.R.col2.y)*i),e.closePath(),e.stroke()}}}]),t}();Mb.e_shapeBit=1,Mb.e_jointBit=2,Mb.e_aabbBit=4,Mb.e_pairBit=8,Mb.e_centerOfMassBit=16,Mb.e_controllerBit=32;function _G(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function ow(t,r){for(var e=0;e<r.length;e++){var i=r[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function aH(t,r,e){return r&&ow(t.prototype,r),e&&ow(t,e),t}var bm=function(){function t(){_G(this,t),this.dt=1/60,this.inv_dt=1/this.dt,this.positionIterations=10,this.velocityIterations=10,this.dtRatio=1,this.warmStarting=!0}return aH(t,[{key:"Set",value:function(t){var r=t.dt,e=t.inv_dt,i=t.positionIterations,a=t.velocityIterations,n=t.warmStarting;this.dt=r,this.inv_dt=e,this.positionIterations=i,this.velocityIterations=a,this.warmStarting=n}}]),t}();function bH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pw(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function cH(t,e,o){return e&&pw(t.prototype,e),o&&pw(t,o),t}function dH(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function qw(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function eH(e,r,t){return r&&qw(e.prototype,r),t&&qw(e,t),e}function fH(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rw(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function gH(t,e,i){return e&&rw(t.prototype,e),i&&rw(t,i),t}function hH(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function sw(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function iH(e,r,t){return r&&sw(e.prototype,r),t&&sw(e,t),e}var tw=function(){function e(){hH(this,e),this.categoryBits=1,this.maskBits=65535,this.groupIndex=0}return iH(e,[{key:"Copy",value:function(){var r=new e;return r.categoryBits=this.categoryBits,r.maskBits=this.maskBits,r.groupIndex=this.groupIndex,r}}]),e}();function jH(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function uw(e,r){for(var n=0;n<r.length;n++){var u=r[n];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(e,u.key,u)}}function kH(e,r,n){return r&&uw(e.prototype,r),n&&uw(e,n),e}var Jd=function(){function e(){jH(this,e),this.lowerBound=new ab,this.upperBound=new ab}return kH(e,[{key:"IsValid",value:function(){var e=this.upperBound.x-this.lowerBound.x,r=this.upperBound.y-this.lowerBound.y;return e>=0&&r>=0&&this.lowerBound.IsValid()&&this.upperBound.IsValid()}},{key:"GetCenter",value:function(){return new ab((this.lowerBound.x+this.upperBound.x)/2,(this.lowerBound.y+this.upperBound.y)/2)}},{key:"GetExtents",value:function(){return new ab((this.upperBound.x-this.lowerBound.x)/2,(this.upperBound.y-this.lowerBound.y)/2)}},{key:"Contains",value:function(e){return this.lowerBound.x<=e.lowerBound.x&&this.lowerBound.y<=e.lowerBound.y&&e.upperBound.x<=this.upperBound.x&&e.upperBound.y<=this.upperBound.y}},{key:"RayCast",value:function(e,r){var n=-Number.MAX_VALUE,u=Number.MAX_VALUE,o=r.p1.x,t=r.p1.y,i=r.p2.x-r.p1.x,p=r.p2.y-r.p1.y,a=Math.abs(i),s=Math.abs(p),d=e.normal,l=0,B=0,h=0,$=0,y=0;if(a<Number.MIN_VALUE){if(o<this.lowerBound.x||this.upperBound.x<o)return!1}else if(l=1/i,y=-1,(B=(this.lowerBound.x-o)*l)>(h=(this.upperBound.x-o)*l)&&($=B,B=h,h=$,y=1),B>n&&(d.x=y,d.y=0,n=B),n>(u=Math.min(u,h)))return!1;if(s<Number.MIN_VALUE){if(t<this.lowerBound.y||this.upperBound.y<t)return!1}else if(l=1/p,y=-1,(B=(this.lowerBound.y-t)*l)>(h=(this.upperBound.y-t)*l)&&($=B,B=h,h=$,y=1),B>n&&(d.y=y,d.x=0,n=B),n>(u=Math.min(u,h)))return!1;return e.fraction=n,!0}},{key:"TestOverlap",value:function(e){var r=e.lowerBound.x-this.upperBound.x,n=e.lowerBound.y-this.upperBound.y,u=this.lowerBound.x-e.upperBound.x,o=this.lowerBound.y-e.upperBound.y;return r<0||n<0||u<0||o<0}},{key:"Combine",value:function(e,r){this.lowerBound.x=Math.min(e.lowerBound.x,r.lowerBound.x),this.lowerBound.y=Math.min(e.lowerBound.y,r.lowerBound.y),this.upperBound.x=Math.max(e.upperBound.x,r.upperBound.x),this.upperBound.y=Math.max(e.upperBound.y,r.upperBound.y)}}],[{key:"Combine",value:function(r,n){var u=new e;return u.Combine(r,n),u}}]),e}();function lH(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function vw(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mH(e,n,t){return n&&vw(e.prototype,n),t&&vw(e,t),e}function nH(o,r){if(!(o instanceof r))throw new TypeError("Cannot call a class as a function")}function oH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ww(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function pH(e,t,r){return t&&ww(e.prototype,t),r&&ww(e,r),e}var Pf=function(){function e(){oH(this,e),this.m_vertices=[],this.m_count=0,this.m_radius=0}return pH(e,[{key:"Set",value:function(e){switch(e.GetType()){case mb.e_circleShape:var t=e;this.m_vertices=[t.m_p],this.m_count=1,this.m_radius=t.m_radius;break;case mb.e_polygonShape:var r=e;this.m_vertices=r.m_vertices,this.m_count=r.m_vertexCount,this.m_radius=r.m_radius;break;default:wb(!1);}}},{key:"GetSupport",value:function(e){for(var t=0,r=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y,i=1;i<this.m_count;++i){var s=this.m_vertices[i].x*e.x+this.m_vertices[i].y*e.y;s>r&&(t=i,r=s)}return t}},{key:"GetSupportVertex",value:function(e){for(var t=0,r=this.m_vertices[0].x*e.x+this.m_vertices[0].y*e.y,i=1;i<this.m_count;++i){var s=this.m_vertices[i].x*e.x+this.m_vertices[i].y*e.y;s>r&&(t=i,r=s)}return this.m_vertices[t]}},{key:"GetVertexCount",value:function(){return this.m_count}},{key:"GetVertex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return wb(0<=e&&e<this.m_count),this.m_vertices[e]}}]),e}();var xw=function o(){nH(this,o),this.proxyA=new Pf,this.proxyB=new Pf,this.transformA=new vd,this.transformB=new vd,this.sweepA=new ef,this.sweepB=new ef,this.useRadii=!1};function qH(s,t){if(!(s instanceof t))throw new TypeError("Cannot call a class as a function")}var yw=function s(){qH(this,s),this.pointA=new ab,this.pointB=new ab,this.distance=0,this.iterations=0};function rH(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var zw=function a(){rH(this,a),this.indexA=new Array(3).fill(0),this.indexB=new Array(3).fill(0),this.count=0,this.metric=0};function sH(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Aw(t,i){for(var e=0;e<i.length;e++){var r=i[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tH(t,i,e){return i&&Aw(t.prototype,i),e&&Aw(t,e),t}function uH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bw(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function vH(e,t,r){return t&&Bw(e.prototype,t),r&&Bw(e,r),e}var cm=function(){function e(){uH(this,e),this.wA=new ab,this.wB=new ab,this.w=new ab,this.a=0,this.indexA=0,this.indexB=0}return vH(e,[{key:"Set",value:function(e){this.wA.SetV(e.wA),this.wB.SetV(e.wB),this.w.SetV(e.w),this.a=e.a,this.indexA=e.indexA,this.indexB=e.indexB}}]),e}();var wH=function(){function t(){sH(this,t),this.m_v1=new cm,this.m_v2=new cm,this.m_v3=new cm,this.m_vertices=new Array(3),this.m_count=0,this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3}return tH(t,[{key:"ReadCache",value:function(t,i,e,r,s){var m,$;wb(0<=t.count&&t.count<=3),this.m_count=t.count;for(var o,v=this.m_vertices,a=0;a<this.m_count;a++)(o=v[a]).indexA=t.indexA[a],o.indexB=t.indexB[a],m=i.GetVertex(o.indexA),$=r.GetVertex(o.indexB),o.wA=vb(e,m),o.wB=vb(s,$),o.w=rb(o.wB,o.wA),o.a=0;if(this.m_count>1){var h=t.metric,n=this.GetMetric();(n<.5*h||2*h<n||n<Number.MIN_VALUE)&&(this.m_count=0)}0===this.m_count&&((o=v[0]).indexA=0,o.indexB=0,m=i.GetVertex(0),$=r.GetVertex(0),o.wA=vb(e,m),o.wB=vb(s,$),o.w=rb(o.wB,o.wA),this.m_count=1)}},{key:"WriteCache",value:function(t){t.metric=this.GetMetric(),t.count=Lf(this.m_count);for(var i=this.m_vertices,e=0;e<this.m_count;e++)t.indexA[e]=Lf(i[e].indexA),t.indexB[e]=Lf(i[e].indexB)}},{key:"GetSearchDirection",value:function(){switch(this.m_count){case 1:return this.m_v1.w.GetNegative();case 2:var t=rb(this.m_v2.w,this.m_v1.w);return Mf(t,this.m_v1.w.GetNegative())>0?mj(1,t):cf(t,1);default:return wb(!1),new ab;}}},{key:"GetClosestPoint",value:function(){switch(this.m_count){case 0:return wb(!1),new ab;case 1:return this.m_v1.w;case 2:return new ab(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);default:return wb(!1),new ab;}}},{key:"GetWitnessPoints",value:function(t,i){switch(this.m_count){case 0:wb(!1);break;case 1:t.SetV(this.m_v1.wA),i.SetV(this.m_v1.wB);break;case 2:t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,i.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,i.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:i.x=t.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,i.y=t.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:wb(!1);}}},{key:"GetMetric",value:function(){switch(this.m_count){case 0:return wb(!1),0;case 1:return 0;case 2:return rb(this.m_v1.w,this.m_v2.w).Length();case 3:return Mf(rb(this.m_v2.w,this.m_v1.w),rb(this.m_v3.w,this.m_v1.w));default:return wb(!1),0;}}},{key:"Solve2",value:function(){var t=this.m_v1.w,i=this.m_v2.w,e=rb(i,t),r=-(t.x*e.x+t.y*e.y);if(r<=0)return this.m_v1.a=1,void(this.m_count=1);var s=i.x*e.x+i.y*e.y;if(s<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);var m=1/(s+r);this.m_v1.a=s*m,this.m_v2.a=r*m,this.m_count=2}},{key:"Solve3",value:function(){var t=this.m_v1.w,i=this.m_v2.w,e=this.m_v3.w,r=rb(i,t),s=Ib(t,r),m=Ib(i,r),$=-s,o=rb(e,t),v=Ib(t,o),a=Ib(e,o),h=-v,n=rb(e,i),_=Ib(i,n),c=Ib(e,n),u=-_,A=Mf(r,o),p=A*Mf(i,e),P=A*Mf(e,t),w=A*Mf(t,i);if($<=0&&h<=0)return this.m_v1.a=1,void(this.m_count=1);if(m>0&&$>0&&w<=0){var J=1/(m+$);return this.m_v1.a=m*J,this.m_v2.a=$*J,void(this.m_count=2)}if(a>0&&h>0&&P<=0){var V=1/(a+h);return this.m_v1.a=a*V,this.m_v3.a=h*V,this.m_count=2,void this.m_v2.Set(this.m_v3)}if(m<=0&&u<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Set(this.m_v2);if(a<=0&&c<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Set(this.m_v3);if(c>0&&u>0&&p<=0){var l=1/(c+u);return this.m_v2.a=c*l,this.m_v3.a=u*l,this.m_count=2,void this.m_v1.Set(this.m_v3)}var x=1/(p+P+w);this.m_v1.a=p*x,this.m_v2.a=P*x,this.m_v3.a=w*x,this.m_count=3}}]),t}();var xH=new wH;var yH=new Array(3).fill(0);var zH=new Array(3).fill(0);var AH=0;var BH=0;var CH=0;function Cw(e,t,$){++AH;var r=$.proxyA,o=$.proxyB,s=$.transformA,i=$.transformB,a=xH;a.ReadCache(t,r,s,o,i);for(var p,d=a.m_vertices,x=yH,n=zH,N=0,E=(a.GetClosestPoint().LengthSquared(),0);E<20;){N=a.m_count;for(var _=0;_<N;_++)x[_]=d[_].indexA,n[_]=d[_].indexB;switch(a.m_count){case 1:break;case 2:a.Solve2();break;case 3:a.Solve3();break;default:wb(!1);}if(3===a.m_count)break;(p=a.GetClosestPoint()).LengthSquared();var m=a.GetSearchDirection();if(m.LengthSquared()<Number.MIN_VALUE*Number.MIN_VALUE)break;var l=d[a.m_count];l.indexA=r.GetSupport(Hd(s.R,m.GetNegative())),l.wA=vb(s,r.GetVertex(l.indexA)),l.indexB=o.GetSupport(Hd(i.R,m)),l.wB=vb(i,o.GetVertex(l.indexB)),l.w=rb(l.wB,l.wA),++E,++BH;for(var c=!1,b=0;b<N;b++)if(l.indexA===x[b]&&l.indexB===n[b]){c=!0;break}if(c)break;++a.m_count}if(CH=ug(CH,E),a.GetWitnessPoints(e.pointA,e.pointB),e.distance=rb(e.pointA,e.pointB).Length(),e.iterations=E,a.WriteCache(t),$.useRadii){var u=r.m_radius,v=o.m_radius;if(e.distance>u+v&&e.distance>Number.MIN_VALUE){e.distance-=u+v;var A=rb(e.pointB,e.pointA);A.Normalize(),e.pointA.x+=u*A.x,e.pointA.y+=u*A.y,e.pointB.x-=v*A.x,e.pointB.y-=v*A.y}else(p=new ab).x=.5*(e.pointA.x+e.pointB.x),p.y=.5*(e.pointA.y+e.pointB.y),e.pointA.x=e.pointB.x=p.x,e.pointA.y=e.pointB.y=p.y,e.distance=0}}var mb=function(){function e(){lH(this,e),this.m_type=e.e_unknownShape,this.m_radius=ud}return mH(e,[{key:"Set",value:function(e){this.m_radius=e.m_radius}},{key:"GetType",value:function(){return this.m_type}},{key:"TestPoint",value:function(e,n){return!1}},{key:"RayCast",value:function(e,n,t){return!1}},{key:"ComputeAABB",value:function(e,n){}},{key:"ComputeMass",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1]}}],[{key:"TestOverlap",value:function(e,n,t,r){var u=new xw;u.proxyA=new Pf,u.proxyA.Set(e),u.proxyB=new Pf,u.proxyB.Set(t),u.transformA=n,u.transformB=r,u.useRadii=!0;var a=new zw;a.count=0;var $=new yw;return Cw($,a,u),$.distance<10*Number.MIN_VALUE}}]),e}();mb.e_unknownShape=parseInt("-1",10),mb.e_circleShape=0,mb.e_polygonShape=1,mb.e_edgeShape=2,mb.e_shapeTypeCount=3,mb.e_hitCollide=1,mb.e_missCollide=0,mb.e_startsInsideCollide=parseInt("-1",10);function DH(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var Dw=function a(){DH(this,a),this.mass=0,this.center=new ab(0,0),this.I=0};var wg=function(){function t(){fH(this,t),this.m_filter=new tw,this.m_aabb=new Jd,this.m_density=0,this.m_friction=0,this.m_restitution=0,this.m_isSensor=!1}return gH(t,[{key:"GetType",value:function(){return this.m_shape?this.m_shape.GetType():mb.e_unknownShape}},{key:"GetShape",value:function(){return this.m_shape}},{key:"SetSensor",value:function(t){if(this.m_isSensor!==t&&(this.m_isSensor=t,this.m_body))for(var e=this.m_body.GetContactList();e;){var i=e.contact,s=i.GetFixtureA(),r=i.GetFixtureB();s!==this&&r!==this||i.SetSensor(s.IsSensor()||r.IsSensor()),e=e.next}}},{key:"IsSensor",value:function(){return this.m_isSensor}},{key:"SetFilterData",value:function(t){if(this.m_filter=t.Copy(),this.m_body)for(var e=this.m_body.GetContactList();e;){var i=e.contact,s=i.GetFixtureA(),r=i.GetFixtureB();s!==this&&r!==this||i.FlagForFiltering(),e=e.next}}},{key:"GetFilterData",value:function(){return this.m_filter.Copy()}},{key:"GetBody",value:function(){return this.m_body}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(t){this.m_userData=t}},{key:"TestPoint",value:function(t){return!(!this.m_shape||!this.m_body)&&this.m_shape.TestPoint(this.m_body.GetTransform(),t)}},{key:"RayCast",value:function(t,e){return!(!this.m_shape||!this.m_body)&&this.m_shape.RayCast(t,e,this.m_body.GetTransform())}},{key:"GetMassData",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dw;return!(!this.m_shape||!this.m_body)&&(this.m_shape.ComputeMass(t,this.m_density),t)}},{key:"SetDensity",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_density=t}},{key:"GetDensity",value:function(){return this.m_density}},{key:"GetFriction",value:function(){return this.m_friction}},{key:"SetFriction",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_friction=t}},{key:"GetRestitution",value:function(){return this.m_restitution}},{key:"SetRestitution",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_restitution=t}},{key:"GetAABB",value:function(){return this.m_aabb}},{key:"Create",value:function(t,e,i){this.m_userData=i.userData,this.m_friction=i.friction,this.m_restitution=i.restitution,this.m_body=t,this.m_next=void 0,this.m_filter=i.filter.Copy(),this.m_isSensor=i.isSensor,this.m_shape=i.shape.Copy(),this.m_density=i.density}},{key:"Destroy",value:function(){this.m_shape=void 0}},{key:"CreateProxy",value:function(t,e){if(!this.m_shape||!this.m_body)return!1;this.m_shape.ComputeAABB(this.m_aabb,e),this.m_proxy=t.CreateProxy(this.m_aabb,this)}},{key:"DestroyProxy",value:function(t){null!=this.m_proxy&&(t.DestroyProxy(this.m_proxy),this.m_proxy=void 0)}},{key:"Synchronize",value:function(t,e,i){if(this.m_proxy&&this.m_shape){var s=new Jd,r=new Jd;this.m_shape.ComputeAABB(s,e),this.m_shape.ComputeAABB(r,i),this.m_aabb.Combine(s,r);var n=rb(i.position,e.position);t.MoveProxy(this.m_proxy,this.m_aabb,n)}}}]),t}();var dm=function(){function e(){dH(this,e)}return eH(e,[{key:"ShouldCollide",value:function(e,r){var t=e.GetFilterData(),a=r.GetFilterData();return t.groupIndex===a.groupIndex&&0!==t.groupIndex?t.groupIndex>0:0!=(t.maskBits&a.categoryBits)&&0!=(t.categoryBits&a.maskBits)}},{key:"RayCollide",value:function(e,r){return!(e instanceof wg)||this.ShouldCollide(e,r)}}]),e}();dm.b2_defaultFilter=new dm;function EH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ew(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function FH(e,t,a){return t&&Ew(e.prototype,t),a&&Ew(e,a),e}var em=function(){function e(){EH(this,e)}return FH(e,[{key:"BeginContact",value:function(e){}},{key:"EndContact",value:function(e){}},{key:"PreSolve",value:function(e,t){}},{key:"PostSolve",value:function(e,t){}}]),e}();em.b2_defaultListener=new em;function GH(e,r){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=HH(e))||r&&e&&"number"==typeof e.length){t&&(e=t);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,i=!0,u=!1;return{s:function(){t=e[Symbol.iterator]()},n:function(){var e=t.next();return i=e.done,e},e:function(e){u=!0,n=e},f:function(){try{i||null==t.return||t.return()}finally{if(u)throw n}}}}function HH(e,r){if(e){if("string"==typeof e)return Fw(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Fw(e,r):void 0}}function Fw(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=new Array(r);t<r;t++)a[t]=e[t];return a}function IH(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Gw(e,r){for(var t=0;t<r.length;t++){var a=r[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function JH(e,r,t){return r&&Gw(e.prototype,r),t&&Gw(e,t),e}function KH(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function Hw(e,a){for(var r=0;r<a.length;r++){var t=a[r];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}function LH(e,a,r){return a&&Hw(e.prototype,a),r&&Hw(e,r),e}function MH(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Iw(e,r){for(var a=0;a<r.length;a++){var $=r[a];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function NH(e,r,a){return r&&Iw(e.prototype,r),a&&Iw(e,a),e}var OH=function(){function e(){MH(this,e),this.aabb=new Jd}return NH(e,[{key:"IsLeaf",value:function(){return null==this.child1}}]),e}();function PH(t,$){if(!(t instanceof $))throw new TypeError("Cannot call a class as a function")}var Jw=function t(){var $=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ab,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ab,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;PH(this,t),this.p1=$,this.p2=a,this.maxFraction=e};var QH=function(){function e(){KH(this,e),this.m_root=null,this.m_freeList=null,this.m_path=0,this.m_insertionCount=0}return LH(e,[{key:"CreateProxy",value:function(e,a){var r=this.AllocateNode(),t=oj,o=oj;return r.aabb.lowerBound.x=e.lowerBound.x-t,r.aabb.lowerBound.y=e.lowerBound.y-o,r.aabb.upperBound.x=e.upperBound.x+t,r.aabb.upperBound.y=e.upperBound.y+o,r.userData=a,this.InsertLeaf(r),r}},{key:"DestroyProxy",value:function(e){this.RemoveLeaf(e),this.FreeNode(e)}},{key:"MoveProxy",value:function(e,a,r){if(wb(e.IsLeaf()),e.aabb.Contains(a))return!1;this.RemoveLeaf(e);var t=oj+dw*(r.x>0?r.x:-r.x),o=oj+dw*(r.y>0?r.y:-r.y);return e.aabb.lowerBound.x=a.lowerBound.x-t,e.aabb.lowerBound.y=a.lowerBound.y-o,e.aabb.upperBound.x=a.upperBound.x+t,e.aabb.upperBound.y=a.upperBound.y+o,this.InsertLeaf(e),!0}},{key:"Rebalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.m_root)for(var a=0;a<e;a++){for(var r=this.m_root,t=0;!r.IsLeaf();)r=this.m_path>>t&1?r.child2:r.child1,t=t+1&31;++this.m_path,this.RemoveLeaf(r),this.InsertLeaf(r)}}},{key:"GetFatAABB",value:function(e){return e.aabb}},{key:"GetUserData",value:function(e){return e.userData}},{key:"Query",value:function(e,a){if(this.m_root){var r=[],t=0;for(r[t++]=this.m_root;t>0;){var o=r[--t];if(o.aabb.TestOverlap(a))if(o.IsLeaf()){if(!e(o))return}else r[t++]=o.child1,r[t++]=o.child2}}}},{key:"RayCast",value:function(e,a){if(this.m_root){var r=a.p1,t=a.p2,o=rb(r,t);o.Normalize();var i=mj(1,o),n=DG(i),u=a.maxFraction,l=new Jd,b=0,s=0;b=r.x+u*(t.x-r.x),s=r.y+u*(t.y-r.y),l.lowerBound.x=Math.min(r.x,b),l.lowerBound.y=Math.min(r.y,s),l.upperBound.x=Math.max(r.x,b),l.upperBound.y=Math.max(r.y,s);var p=[],h=0;for(p[h++]=this.m_root;h>0;){var $=p[--h];if(!1!==$.aabb.TestOverlap(l)){var v=$.aabb.GetCenter(),d=$.aabb.GetExtents();if(!(Math.abs(i.x*(r.x-v.x)+i.y*(r.y-v.y))-n.x*d.x-n.y*d.y>0))if($.IsLeaf()){var c=new Jw;if(c.p1=a.p1,c.p2=a.p2,c.maxFraction=a.maxFraction,0===(u=e(c,$)))return;u>0&&(b=r.x+u*(t.x-r.x),s=r.y+u*(t.y-r.y),l.lowerBound.x=Math.min(r.x,b),l.lowerBound.y=Math.min(r.y,s),l.upperBound.x=Math.max(r.x,b),l.upperBound.y=Math.max(r.y,s))}else p[h++]=$.child1,p[h++]=$.child2}}}}},{key:"AllocateNode",value:function(){if(this.m_freeList){var e=this.m_freeList;return this.m_freeList=e.parent,e.parent=null,e.child1=null,e.child2=null,e}return new OH}},{key:"FreeNode",value:function(e){e.parent=this.m_freeList,this.m_freeList=e}},{key:"InsertLeaf",value:function(e){if(++this.m_insertionCount,null==this.m_root)return this.m_root=e,void(this.m_root.parent=null);var a=e.aabb.GetCenter(),r=this.m_root;if(!1===r.IsLeaf())do{var t=r.child1,o=r.child2;r=Math.abs((t.aabb.lowerBound.x+t.aabb.upperBound.x)/2-a.x)+Math.abs((t.aabb.lowerBound.y+t.aabb.upperBound.y)/2-a.y)<Math.abs((o.aabb.lowerBound.x+o.aabb.upperBound.x)/2-a.x)+Math.abs((o.aabb.lowerBound.y+o.aabb.upperBound.y)/2-a.y)?t:o}while(!r.IsLeaf());var i=r.parent,n=this.AllocateNode();if(n.parent=i,n.userData=null,n.aabb.Combine(e.aabb,r.aabb),i){r.parent.child1===r?i.child1=n:i.child2=n,n.child1=r,n.child2=e,r.parent=n,e.parent=n;do{if(i.aabb.Contains(n.aabb))break;i.aabb.Combine(i.child1.aabb,i.child2.aabb),n=i,i=i.parent}while(i)}else n.child1=r,n.child2=e,r.parent=n,e.parent=n,this.m_root=n}},{key:"RemoveLeaf",value:function(e){if(e!==this.m_root){var a,r=e.parent,t=r.parent;if(a=r.child1===e?r.child2:r.child1,t)for(t.child1===r?t.child1=a:t.child2=a,a.parent=t,this.FreeNode(r);t;){var o=t.aabb;if(t.aabb=Jd.Combine(t.child1.aabb,t.child2.aabb),o.Contains(t.aabb))break;t=t.parent}else this.m_root=a,a.parent=null,this.FreeNode(r)}else this.m_root=null}}]),e}();function RH(a,c){if(!(a instanceof c))throw new TypeError("Cannot call a class as a function")}var SH=function a(){RH(this,a)};var TH=function(){function e(){IH(this,e),this.m_tree=new QH,this.m_moveBuffer=[],this.m_pairBuffer=[],this.m_pairCount=0,this.m_proxyCount=0}return JH(e,[{key:"CreateProxy",value:function(e,r){var t=this.m_tree.CreateProxy(e,r);return++this.m_proxyCount,this.BufferMove(t),t}},{key:"DestroyProxy",value:function(e){this.UnBufferMove(e),--this.m_proxyCount,this.m_tree.DestroyProxy(e)}},{key:"MoveProxy",value:function(e,r,t){this.m_tree.MoveProxy(e,r,t)&&this.BufferMove(e)}},{key:"TestOverlap",value:function(e,r){var t=this.m_tree.GetFatAABB(e),a=this.m_tree.GetFatAABB(r);return t.TestOverlap(a)}},{key:"GetUserData",value:function(e){return this.m_tree.GetUserData(e)}},{key:"GetFatAABB",value:function(e){return this.m_tree.GetFatAABB(e)}},{key:"GetProxyCount",value:function(){return this.m_proxyCount}},{key:"UpdatePairs",value:function(e){var r=this;this.m_pairCount=0;var t,a=GH(this.m_moveBuffer);try{var o=function(){var e=t.value,a=r.m_tree.GetFatAABB(e);r.m_tree.Query(function(t){if(t===e)return!0;r.m_pairCount===r.m_pairBuffer.length&&(r.m_pairBuffer[r.m_pairCount]=new SH);var a=r.m_pairBuffer[r.m_pairCount];return a.proxyA=t<e?t:e,a.proxyB=t>=e?t:e,++r.m_pairCount,!0},a)};for(a.s();!(t=a.n()).done;)o()}catch(f){a.e(f)}finally{a.f()}this.m_moveBuffer.length=0;for(var n=0;n<this.m_pairCount;){var i=this.m_pairBuffer[n];for(e(this.m_tree.GetUserData(i.proxyA),this.m_tree.GetUserData(i.proxyB)),++n;n<this.m_pairCount;){var u=this.m_pairBuffer[n];if(u.proxyA!==i.proxyA||u.proxyB!==i.proxyB)break;++n}}}},{key:"Query",value:function(e,r){this.m_tree.Query(e,r)}},{key:"RayCast",value:function(e,r){this.m_tree.RayCast(e,r)}},{key:"Validate",value:function(){}},{key:"Rebalance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_tree.Rebalance(e)}},{key:"BufferMove",value:function(e){this.m_moveBuffer[this.m_moveBuffer.length]=e}},{key:"UnBufferMove",value:function(e){var r=parseInt("".concat(this.m_moveBuffer.indexOf(e)),10);this.m_moveBuffer.splice(r,1)}},{key:"ComparePairs",value:function(e,r){return 0}}]),e}();function UH(c,$){if(!(c instanceof $))throw new TypeError("Cannot call a class as a function")}function VH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Kw(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function WH(e,t,r){return t&&Kw(e.prototype,t),r&&Kw(e,r),e}function XH(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Lw(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function YH(e,t,i){return t&&Lw(e.prototype,t),i&&Lw(e,i),e}var ZH=function(){function e(){XH(this,e),this._referenceEdge=0,this._incidentEdge=0,this._incidentVertex=0,this._flip=0}return YH(e,[{key:"referenceEdge",get:function(){return this._referenceEdge},set:function(e){this._referenceEdge!==e&&(this._referenceEdge=e,this.m_id.key=4294967040&this.m_id.key|255&this._referenceEdge)}},{key:"incidentEdge",get:function(){return this._incidentEdge},set:function(e){this._incidentEdge!==e&&(this._incidentEdge=e,this.m_id.key=4294902015&this.m_id.key|this._incidentEdge<<8&65280)}},{key:"incidentVertex",get:function(){return this._incidentVertex},set:function(e){this._incidentVertex!==e&&(this._incidentVertex=e,this.m_id.key=4278255615&this.m_id.key|this._incidentVertex<<16&16711680)}},{key:"flip",get:function(){return this._flip},set:function(e){this._flip!==e&&(this._flip=e,this.m_id.key=16777215&this.m_id.key|this._flip<<24&4278190080)}}]),e}();var fm=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ZH;VH(this,e),this.features=t,this._key=0,this.features.m_id=this}return WH(e,[{key:"Set",value:function(e){this.key=e.key}},{key:"Copy",value:function(){var t=new e;return t.key=this.key,t}},{key:"key",get:function(){return this._key},set:function(e){this._key!==e&&(this._key=e,this.features.referenceEdge=255&this._key,this.features.incidentEdge=(65280&this._key)>>8&255,this.features.incidentVertex=(16711680&this._key)>>16&255,this.features.flip=(4278190080&this._key)>>24&255)}}]),e}();var $H=function c(){UH(this,c),this.position=new ab,this.velocity=new ab,this.normal=new ab,this.id=new fm};function _H(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mw(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function aI(e,t,r){return t&&Mw(e.prototype,t),r&&Mw(e,r),e}function bI(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}var cI=function a(){bI(this,a),this.poolCount=0};function dI(t){return(dI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Nw(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fI(t,e,r){return e&&Nw(t.prototype,e),r&&Nw(t,r),t}function gI(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hI(t,e)}function hI(t,e){return(hI=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function iI(t){var e=lI();return function(){var r,o=Ow(t);if(e){var n=Ow(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return jI(this,r)}}function jI(t,e){return!e||"object"!==dI(e)&&"function"!=typeof e?kI(t):e}function kI(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lI(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function Ow(t){return(Ow=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mI(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pw(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function nI(e,t,i){return t&&Pw(e.prototype,t),i&&Pw(e,i),e}function oI(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}var Qw=function a(){oI(this,a)};function pI(o,t){if(!(o instanceof t))throw new TypeError("Cannot call a class as a function")}function Rw(o,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(o,r.key,r)}}function qI(o,t,e){return t&&Rw(o.prototype,t),e&&Rw(o,e),o}function rI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Sw(t,e){for(var l=0;l<e.length;l++){var a=e[l];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function sI(t,e,l){return e&&Sw(t.prototype,e),l&&Sw(t,l),t}var gm=function(){function t(){rI(this,t),this.m_localPoint=new ab,this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id=new fm,this.Reset()}return sI(t,[{key:"Reset",value:function(){this.m_localPoint.SetZero(),this.m_normalImpulse=0,this.m_tangentImpulse=0,this.m_id.key=0}},{key:"Set",value:function(t){this.m_localPoint.SetV(t.m_localPoint),this.m_normalImpulse=t.m_normalImpulse,this.m_tangentImpulse=t.m_tangentImpulse,this.m_id.Set(t.m_id)}}]),t}();var Gb=function(){function o(){pI(this,o),this.m_pointCount=0,this.m_points=new Array(bd),this.m_localPlaneNormal=new ab,this.m_localPoint=new ab,this.m_type=0;for(var t=0;t<bd;t++)this.m_points[t]=new gm}return qI(o,[{key:"Reset",value:function(){for(var o=0;o<bd;o++)(this.m_points[o]instanceof gm?this.m_points[o]:null).Reset();this.m_localPlaneNormal.SetZero(),this.m_localPoint.SetZero(),this.m_type=0,this.m_pointCount=0}},{key:"Set",value:function(o){this.m_pointCount=o.m_pointCount;for(var t=0;t<bd;t++)(this.m_points[t]instanceof gm?this.m_points[t]:null).Set(o.m_points[t]);this.m_localPlaneNormal.SetV(o.m_localPlaneNormal),this.m_localPoint.SetV(o.m_localPoint),this.m_type=o.m_type}},{key:"Copy",value:function(){var t=new o;return t.Set(this),t}}]),o}();Gb.e_circles=1,Gb.e_faceA=2,Gb.e_faceB=4;function tI(e,$){if(!(e instanceof $))throw new TypeError("Cannot call a class as a function")}var uI=function e(){tI(this,e),this.proxyA=new Pf,this.proxyB=new Pf,this.sweepA=new ef,this.sweepB=new ef,this.tolerance=1};function vI(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Tw(t,i){for(var o=0;o<i.length;o++){var e=i[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function wI(t,i,o){return i&&Tw(t.prototype,i),o&&Tw(t,o),t}var pj=function(){function t(){vI(this,t),this.m_localPoint=new ab,this.m_axis=new ab,this.m_type=t.e_points}return wI(t,[{key:"Initialize",value:function(i,o,e,x,c){this.m_proxyA=o,this.m_proxyB=x;var r,s,n,$,l,y,a=parseInt("".concat(i.count),10);wb(0<a&&a<3);var m,p,_=0,h=0,B=0,u=0,I=0,V=0,f=0;if(1===a)this.m_type=t.e_points,r=this.m_proxyA.GetVertex(i.indexA[0]),$=this.m_proxyB.GetVertex(i.indexB[0]),p=r,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),this.m_axis.x=B-_,this.m_axis.y=u-h,this.m_axis.Normalize();else if(i.indexB[0]===i.indexB[1])this.m_type=t.e_faceA,s=this.m_proxyA.GetVertex(i.indexA[0]),n=this.m_proxyA.GetVertex(i.indexA[1]),$=this.m_proxyB.GetVertex(i.indexB[0]),this.m_localPoint.x=.5*(s.x+n.x),this.m_localPoint.y=.5*(s.y+n.y),this.m_axis=cf(rb(n,s),1),this.m_axis.Normalize(),p=this.m_axis,I=(m=e.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,(f=((B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y))-_)*I+((u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y))-h)*V)<0&&this.m_axis.NegativeSelf();else if(i.indexA[0]==i.indexA[0])this.m_type=t.e_faceB,l=this.m_proxyB.GetVertex(i.indexB[0]),y=this.m_proxyB.GetVertex(i.indexB[1]),r=this.m_proxyA.GetVertex(i.indexA[0]),this.m_localPoint.x=.5*(l.x+y.x),this.m_localPoint.y=.5*(l.y+y.y),this.m_axis=cf(rb(y,l),1),this.m_axis.Normalize(),p=this.m_axis,I=(m=c.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=r,m=e.R,(f=((_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y))-B)*I+((h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y))-u)*V)<0&&this.m_axis.NegativeSelf();else{s=this.m_proxyA.GetVertex(i.indexA[0]),n=this.m_proxyA.GetVertex(i.indexA[1]),l=this.m_proxyB.GetVertex(i.indexB[0]),y=this.m_proxyB.GetVertex(i.indexB[1]);var v=df(e.R,rb(n,s)),d=df(c.R,rb(y,l)),A=v.x*v.x+v.y*v.y,M=d.x*d.x+d.y*d.y,R=rb(d,v),G=v.x*R.x+v.y*R.y,P=d.x*R.x+d.y*R.y,S=v.x*d.x+v.y*d.y,b=A*M-S*S;f=0,0!==b&&(f=td((S*P-G*M)/b,0,1));var C=(S*f+P)/M;C<0&&(C=0,f=td((S-G)/A,0,1)),(r=new ab).x=s.x+f*(n.x-s.x),r.y=s.y+f*(n.y-s.y),($=new ab).x=l.x+f*(y.x-l.x),$.y=l.y+f*(y.y-l.y),0===f||1===f?(this.m_type=t.e_faceB,this.m_axis=cf(rb(y,l),1),this.m_axis.Normalize(),this.m_localPoint=$,p=this.m_axis,I=(m=c.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=r,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),f<0&&this.m_axis.NegativeSelf()):(this.m_type=t.e_faceA,this.m_axis=cf(rb(n,s),1),this.m_localPoint=r,p=this.m_axis,I=(m=e.R).col1.x*p.x+m.col2.x*p.y,V=m.col1.y*p.x+m.col2.y*p.y,p=this.m_localPoint,m=e.R,_=e.position.x+(m.col1.x*p.x+m.col2.x*p.y),h=e.position.y+(m.col1.y*p.x+m.col2.y*p.y),p=$,m=c.R,B=c.position.x+(m.col1.x*p.x+m.col2.x*p.y),u=c.position.y+(m.col1.y*p.x+m.col2.y*p.y),f<0&&this.m_axis.NegativeSelf())}}},{key:"Evaluate",value:function(i,o){if(!this.m_proxyA||!this.m_proxyB)return 0;var e,x,c,r,s,n,$;switch(this.m_type){case t.e_points:return e=Hd(i.R,this.m_axis),x=Hd(o.R,this.m_axis.GetNegative()),c=this.m_proxyA.GetSupportVertex(e),r=this.m_proxyB.GetSupportVertex(x),s=vb(i,c),((n=vb(o,r)).x-s.x)*this.m_axis.x+(n.y-s.y)*this.m_axis.y;case t.e_faceA:return $=df(i.R,this.m_axis),s=vb(i,this.m_localPoint),x=Hd(o.R,$.GetNegative()),r=this.m_proxyB.GetSupportVertex(x),((n=vb(o,r)).x-s.x)*$.x+(n.y-s.y)*$.y;case t.e_faceB:return $=df(o.R,this.m_axis),n=vb(o,this.m_localPoint),e=Hd(i.R,$.GetNegative()),c=this.m_proxyA.GetSupportVertex(e),((s=vb(i,c)).x-n.x)*$.x+(s.y-n.y)*$.y;default:return wb(!1),0;}}}]),t}();pj.e_points=1,pj.e_faceA=2,pj.e_faceB=4;var xI=0;var yI=0;var zI=0;var AI=0;var BI=0;var hm=new zw;var Qf=new xw;var Kd=new vd;var Ld=new vd;var qj=new pj;var Uw=new yw;function CI($){++xI;var t=$.proxyA,a=$.proxyB,r=$.sweepA,e=$.sweepB;wb(r.t0===e.t0),wb(1-r.t0>Number.MIN_VALUE);var o=t.m_radius+a.m_radius,b=$.tolerance,s=0,p=0,x=0;for(hm.count=0,Qf.useRadii=!1;;){if(r.GetTransform(Kd,s),e.GetTransform(Ld,s),Qf.proxyA=t,Qf.proxyB=a,Qf.transformA=Kd,Qf.transformB=Ld,Cw(Uw,hm,Qf),Uw.distance<=0){s=1;break}qj.Initialize(hm,t,Kd,a,Ld);var R=qj.Evaluate(Kd,Ld);if(R<=0){s=1;break}if(0===p&&(x=R>o?ug(o-b,.75*o):ug(R-b,.02*o)),R-x<.5*b){if(0===p){s=1;break}break}var k=s,i=s,_=1,n=R;r.GetTransform(Kd,_),e.GetTransform(Ld,_);var c=qj.Evaluate(Kd,Ld);if(c>=x){s=1;break}for(var f=0;;){var u=0;u=1&f?i+(x-n)*(_-i)/(c-n):.5*(i+_),r.GetTransform(Kd,u),e.GetTransform(Ld,u);var m=qj.Evaluate(Kd,Ld);if(Ql(m-x)<.025*b){k=u;break}if(m>x?(i=u,n=m):(_=u,c=m),++f,++AI,50===f)break}if(BI=ug(BI,f),k<(1+100*Number.MIN_VALUE)*s)break;if(s=k,p++,++yI,1e3===p)break}return zI=ug(zI,p),s}var sb=function(){function e(){mI(this,e),this.m_nodeA=new Qw,this.m_nodeB=new Qw,this.m_manifold=new Gb,this.m_oldManifold=new Gb,this.m_flags=0,this.m_toi=1}return nI(e,[{key:"GetManifold",value:function(){return this.m_manifold}},{key:"GetWorldManifold",value:function(e){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),n=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();t&&i&&n&&a&&e.Initialize(this.m_manifold,t.GetTransform(),n.m_radius,i.GetTransform(),a.m_radius)}}},{key:"IsTouching",value:function(){return(this.m_flags&e.e_touchingFlag)===e.e_touchingFlag}},{key:"IsContinuous",value:function(){return(this.m_flags&e.e_continuousFlag)===e.e_continuousFlag}},{key:"SetSensor",value:function(t){t?this.m_flags|=e.e_sensorFlag:this.m_flags&=~e.e_sensorFlag}},{key:"IsSensor",value:function(){return(this.m_flags&e.e_sensorFlag)===e.e_sensorFlag}},{key:"SetEnabled",value:function(t){t?this.m_flags|=e.e_enabledFlag:this.m_flags&=~e.e_enabledFlag}},{key:"IsEnabled",value:function(){return(this.m_flags&e.e_enabledFlag)===e.e_enabledFlag}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetFixtureA",value:function(){return this.m_fixtureA}},{key:"GetFixtureB",value:function(){return this.m_fixtureB}},{key:"FlagForFiltering",value:function(){this.m_flags|=e.e_filterFlag}},{key:"Reset",value:function(t,i){if(this.m_flags=e.e_enabledFlag,!t||!i)return this.m_fixtureA=void 0,void(this.m_fixtureB=void 0);(t.IsSensor()||i.IsSensor())&&(this.m_flags|=e.e_sensorFlag);var n=t.GetBody(),a=i.GetBody();n&&a&&((n.GetType()!==eb.b2_dynamicBody||n.IsBullet()||a.GetType()!==eb.b2_dynamicBody||a.IsBullet())&&(this.m_flags|=e.e_continuousFlag),this.m_fixtureA=t,this.m_fixtureB=i,this.m_manifold.m_pointCount=0,this.m_prev=void 0,this.m_next=void 0,this.m_nodeA.contact=void 0,this.m_nodeA.prev=void 0,this.m_nodeA.next=void 0,this.m_nodeA.other=void 0,this.m_nodeB.contact=void 0,this.m_nodeB.prev=void 0,this.m_nodeB.next=void 0,this.m_nodeB.other=void 0)}},{key:"Update",value:function(t){var i=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=i,this.m_flags|=e.e_enabledFlag;var n=!1,a=(this.m_flags&e.e_touchingFlag)===e.e_touchingFlag;if(this.m_fixtureA&&this.m_fixtureB){var o=this.m_fixtureA.m_body,s=this.m_fixtureB.m_body;if(o&&s){var r=this.m_fixtureA.m_aabb.TestOverlap(this.m_fixtureB.m_aabb);if(this.m_flags&e.e_sensorFlag){if(r){var l=this.m_fixtureA.GetShape(),u=this.m_fixtureB.GetShape();if(!l||!u)return;var _=o.GetTransform(),m=s.GetTransform();n=mb.TestOverlap(l,_,u,m)}this.m_manifold.m_pointCount=0}else{if(o.GetType()!==eb.b2_dynamicBody||o.IsBullet()||s.GetType()!==eb.b2_dynamicBody||s.IsBullet()?this.m_flags|=e.e_continuousFlag:this.m_flags&=~e.e_continuousFlag,r){this.Evaluate(),n=this.m_manifold.m_pointCount>0;for(var h=0;h<this.m_manifold.m_pointCount;++h){var f=this.m_manifold.m_points[h];f.m_normalImpulse=0,f.m_tangentImpulse=0;for(var d=f.m_id,$=0;$<this.m_oldManifold.m_pointCount;++$){var p=this.m_oldManifold.m_points[$];if(p.m_id.key===d.key){f.m_normalImpulse=p.m_normalImpulse,f.m_tangentImpulse=p.m_tangentImpulse;break}}}}else this.m_manifold.m_pointCount=0;n!==a&&(o.SetAwake(!0),s.SetAwake(!0))}n?this.m_flags|=e.e_touchingFlag:this.m_flags&=~e.e_touchingFlag,!1===a&&!0===n&&t.BeginContact(this),!0===a&&!1===n&&t.EndContact(this),0==(this.m_flags&e.e_sensorFlag)&&t.PreSolve(this,this.m_oldManifold)}}}},{key:"Evaluate",value:function(){}},{key:"ComputeTOI",value:function(t,i){if(!this.m_fixtureA||!this.m_fixtureB)return 0;var n=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();return n&&a?(e.s_input.proxyA.Set(n),e.s_input.proxyB.Set(a),e.s_input.sweepA=t,e.s_input.sweepB=i,e.s_input.tolerance=ud,CI(e.s_input)):0}}]),e}();sb.e_sensorFlag=1,sb.e_continuousFlag=2,sb.e_islandFlag=4,sb.e_toiFlag=8,sb.e_touchingFlag=16,sb.e_enabledFlag=32,sb.e_filterFlag=64,sb.s_input=new uI;function DI(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Vw(e,r){for(var t=0;t<r.length;t++){var $=r[t];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}function EI(e,r,t){return r&&Vw(e.prototype,r),t&&Vw(e,t),e}var Ww=function(){function e(){DI(this,e),this.v=new ab,this.id=new fm}return EI(e,[{key:"Set",value:function(e){this.v.SetV(e.v),this.id.Set(e.id)}}]),e}();var FI=km();var GI=km();var HI=km();var im=new Array(1).fill(0);var jm=new Array(1).fill(0);var II=new ab;var JI=new ab;var KI=new ab;var LI=new ab;var MI=new ab;var NI=new ab;var OI=new ab;var PI=new ab;var e=new ab;function Xw(o,e,l){var t,$=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=0,n=(t=e[0]).v,i=(t=e[1]).v,x=l.x*n.x+l.y*n.y-$,a=l.x*i.x+l.y*i.y-$;if(x<=0&&o[r++].Set(e[0]),a<=0&&o[r++].Set(e[1]),x*a<0){var p,c=x/(x-a),s=(t=o[r]).v;s.x=n.x+c*(i.x-n.x),s.y=n.y+c*(i.y-n.y),t=o[r],x>0?(p=e[0],t.id=p.id):(p=e[1],t.id=p.id),++r}return r}function rj(o,e){var l,t,$=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=o.m_vertices,x=o.m_normals,a=parseInt("".concat(r.m_vertexCount),10),p=r.m_vertices;l=e.R,t=x[$];for(var c=l.col1.x*t.x+l.col2.x*t.y,s=l.col1.y*t.x+l.col2.y*t.y,_=(l=n.R).col1.x*c+l.col1.y*s,y=l.col2.x*c+l.col2.y*s,m=0,E=Number.MAX_VALUE,d=0;d<a;++d){var v=(t=p[d]).x*_+t.y*y;v<E&&(E=v,m=d)}t=i[$],l=e.R;var g=e.position.x+(l.col1.x*t.x+l.col2.x*t.y),u=e.position.y+(l.col1.y*t.x+l.col2.y*t.y);t=p[m],l=n.R;var f=n.position.x+(l.col1.x*t.x+l.col2.x*t.y),P=n.position.y+(l.col1.y*t.x+l.col2.y*t.y);return(f-=g)*c+(P-=u)*s}function Yw(){var o,e,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,$=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,i=parseInt("".concat(t.m_vertexCount),10),x=t.m_normals;e=n.R,o=r.m_centroid;var a=n.position.x+(e.col1.x*o.x+e.col2.x*o.y),p=n.position.y+(e.col1.y*o.x+e.col2.y*o.y);e=$.R,o=t.m_centroid,a-=$.position.x+(e.col1.x*o.x+e.col2.x*o.y),p-=$.position.y+(e.col1.y*o.x+e.col2.y*o.y);for(var c=a*$.R.col1.x+p*$.R.col1.y,s=a*$.R.col2.x+p*$.R.col2.y,_=0,y=-Number.MAX_VALUE,m=0;m<i;++m){var E=(o=x[m]).x*c+o.y*s;E>y&&(y=E,_=m)}var d=rj(t,$,_,r,n),v=parseInt("".concat(_-1>=0?_-1:i-1),10),g=rj(t,$,v,r,n),u=parseInt("".concat(_+1<i?_+1:0),10),f=rj(t,$,u,r,n),P=0,C=0,V=0;if(g>d&&g>f)P=-1,C=v,V=g;else{if(!(f>d))return l[0]=_,d;P=1,C=u,V=f}for(;(d=rj(t,$,_=-1===P?C-1>=0?C-1:i-1:C+1<i?C+1:0,r,n))>V;)C=_,V=d;return l[0]=C,V}function QI(o,e,l){var t,$,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,x=e.m_normals,a=parseInt("".concat(n.m_vertexCount),10),p=n.m_vertices,c=n.m_normals;t=l.R,$=x[r];var s=t.col1.x*$.x+t.col2.x*$.y,_=t.col1.y*$.x+t.col2.y*$.y,y=(t=i.R).col1.x*s+t.col1.y*_;_=t.col2.x*s+t.col2.y*_,s=y;for(var m,E=0,d=Number.MAX_VALUE,v=0;v<a;++v){var g=s*($=c[v]).x+_*$.y;g<d&&(d=g,E=v)}var u=parseInt("".concat(E),10),f=parseInt("".concat(u+1<a?u+1:0),10);m=o[0],$=p[u],t=i.R,m.v.x=i.position.x+(t.col1.x*$.x+t.col2.x*$.y),m.v.y=i.position.y+(t.col1.y*$.x+t.col2.y*$.y),m.id.features.referenceEdge=r,m.id.features.incidentEdge=u,m.id.features.incidentVertex=0,m=o[1],$=p[f],t=i.R,m.v.x=i.position.x+(t.col1.x*$.x+t.col2.x*$.y),m.v.y=i.position.y+(t.col1.y*$.x+t.col2.y*$.y),m.id.features.referenceEdge=r,m.id.features.incidentEdge=f,m.id.features.incidentVertex=1}function km(){return[new Ww,new Ww]}function RI(o,e,l,t,$){var r;o.m_pointCount=0;var n=e.m_radius+t.m_radius,i=0;im[0]=i;var x=Yw(im,e,l,t,$);if(i=im[0],!(x>n)){var a=0;jm[0]=a;var p=Yw(jm,t,$,e,l);if(a=jm[0],!(p>n)){var c,s,_,y,m,E=0,d=0;p>.98*x+.001?(c=t,s=e,_=$,y=l,E=a,o.m_type=Gb.e_faceB,d=1):(c=e,s=t,_=l,y=$,E=i,o.m_type=Gb.e_faceA,d=0);var v=FI;QI(v,c,_,E,s,y);var g,u=parseInt("".concat(c.m_vertexCount),10),f=c.m_vertices,P=f[E];g=E+1<u?f[parseInt("".concat(E+1),10)]:f[0];var C=II;C.Set(g.x-P.x,g.y-P.y),C.Normalize();var V=JI;V.x=C.y,V.y=-C.x;var S=KI;S.Set(.5*(P.x+g.x),.5*(P.y+g.y));var N=MI;m=_.R,N.x=m.col1.x*C.x+m.col2.x*C.y,N.y=m.col1.y*C.x+m.col2.y*C.y;var A=NI;A.x=-N.x,A.y=-N.y;var M=LI;M.x=N.y,M.y=-N.x;var R=OI,I=PI;R.x=_.position.x+(m.col1.x*P.x+m.col2.x*P.y),R.y=_.position.y+(m.col1.y*P.x+m.col2.y*P.y),I.x=_.position.x+(m.col1.x*g.x+m.col2.x*g.y),I.y=_.position.y+(m.col1.y*g.x+m.col2.y*g.y);var O=M.x*R.x+M.y*R.y,T=-N.x*R.x-N.y*R.y+n,h=N.x*I.x+N.y*I.y+n,w=GI,b=HI;if(!(Xw(w,v,A,T)<2||Xw(b,w,N,h)<2)){o.m_localPlaneNormal.SetV(V),o.m_localPoint.SetV(S);for(var F=0,k=0;k<bd;++k){if(r=b[k],M.x*r.v.x+M.y*r.v.y-O<=n){var L=o.m_points[F];m=y.R;var B=r.v.x-y.position.x,U=r.v.y-y.position.y;L.m_localPoint.x=B*m.col1.x+U*m.col1.y,L.m_localPoint.y=B*m.col2.x+U*m.col2.y,L.m_id.Set(r.id),L.m_id.features.flip=d,++F}}o.m_pointCount=F}}}}function SI(o,e,l,t,$){var r,n;o.m_pointCount=0,r=l.R,n=e.m_p;var i=l.position.x+(r.col1.x*n.x+r.col2.x*n.y),x=l.position.y+(r.col1.y*n.x+r.col2.y*n.y);r=$.R,n=t.m_p;var a=$.position.x+(r.col1.x*n.x+r.col2.x*n.y)-i,p=$.position.y+(r.col1.y*n.x+r.col2.y*n.y)-x,c=a*a+p*p,s=e.m_radius+t.m_radius;c>s*s||(o.m_type=Gb.e_circles,o.m_localPoint.SetV(e.m_p),o.m_localPlaneNormal.SetZero(),o.m_pointCount=1,o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0)}function TI(o,e,l,t,$){o.m_pointCount=0;var r,n,i=0,x=0;n=$.R,r=t.m_p;var a=$.position.x+(n.col1.x*r.x+n.col2.x*r.y),p=$.position.y+(n.col1.y*r.x+n.col2.y*r.y);i=a-l.position.x,x=p-l.position.y;for(var c=i*(n=l.R).col1.x+x*n.col1.y,s=i*n.col2.x+x*n.col2.y,_=0,y=-Number.MAX_VALUE,m=e.m_radius+t.m_radius,E=parseInt("".concat(e.m_vertexCount),10),d=e.m_vertices,v=e.m_normals,g=0;g<E;++g){i=c-(r=d[g]).x,x=s-r.y;var u=(r=v[g]).x*i+r.y*x;if(u>m)return;u>y&&(y=u,_=g)}var f=parseInt("".concat(_),10),P=parseInt("".concat(f+1<E?f+1:0),10),C=d[f],V=d[P];if(y<Number.MIN_VALUE)return o.m_pointCount=1,o.m_type=Gb.e_faceA,o.m_localPlaneNormal.SetV(v[_]),o.m_localPoint.x=.5*(C.x+V.x),o.m_localPoint.y=.5*(C.y+V.y),o.m_points[0].m_localPoint.SetV(t.m_p),void(o.m_points[0].m_id.key=0);var S=(c-C.x)*(V.x-C.x)+(s-C.y)*(V.y-C.y),N=(c-V.x)*(C.x-V.x)+(s-V.y)*(C.y-V.y);if(S<=0){if((c-C.x)*(c-C.x)+(s-C.y)*(s-C.y)>m*m)return;o.m_pointCount=1,o.m_type=Gb.e_faceA,o.m_localPlaneNormal.x=c-C.x,o.m_localPlaneNormal.y=s-C.y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.SetV(C),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}else if(N<=0){if((c-V.x)*(c-V.x)+(s-V.y)*(s-V.y)>m*m)return;o.m_pointCount=1,o.m_type=Gb.e_faceA,o.m_localPlaneNormal.x=c-V.x,o.m_localPlaneNormal.y=s-V.y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.SetV(V),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}else{var A=.5*(C.x+V.x),M=.5*(C.y+V.y);if((y=(c-A)*v[f].x+(s-M)*v[f].y)>m)return;o.m_pointCount=1,o.m_type=Gb.e_faceA,o.m_localPlaneNormal.x=v[f].x,o.m_localPlaneNormal.y=v[f].y,o.m_localPlaneNormal.Normalize(),o.m_localPoint.Set(A,M),o.m_points[0].m_localPoint.SetV(t.m_p),o.m_points[0].m_id.key=0}}function UI(t){return(UI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function VI(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Zw(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function WI(t,e,r){return e&&Zw(t.prototype,e),r&&Zw(t,r),t}function XI(t,e,r){return(XI="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var n=YI(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(r):o.value}})(t,e,r||t)}function YI(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=sj(t)););return t}function ZI(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&$I(t,e)}function $I(t,e){return($I=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _I(t){var e=cJ();return function(){var r,n=sj(t);if(e){var o=sj(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return aJ(this,r)}}function aJ(t,e){return!e||"object"!==UI(e)&&"function"!=typeof e?bJ(t):e}function bJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function cJ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function sj(t){return(sj=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var Rf=function(t){ZI(r,mb);var e=_I(r);function r(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return VI(this,r),(t=e.call(this)).m_radius=n,t.m_p=new ab,t.m_type=mb.e_circleShape,t}return WI(r,[{key:"Copy",value:function(){var t=new r;return t.Set(this),t}},{key:"Set",value:function(t){XI(sj(r.prototype),"Set",this).call(this,t),t instanceof r&&this.m_p.SetV(t.m_p)}},{key:"TestPoint",value:function(t,e){var r=t.R,n=t.position.x+(r.col1.x*this.m_p.x+r.col2.x*this.m_p.y),o=t.position.y+(r.col1.y*this.m_p.x+r.col2.y*this.m_p.y);return(n=e.x-n)*n+(o=e.y-o)*o<=this.m_radius*this.m_radius}},{key:"RayCast",value:function(t,e,r){var n=r.R,o=r.position.x+(n.col1.x*this.m_p.x+n.col2.x*this.m_p.y),i=r.position.y+(n.col1.y*this.m_p.x+n.col2.y*this.m_p.y),a=e.p1.x-o,s=e.p1.y-i,u=a*a+s*s-this.m_radius*this.m_radius,$=e.p2.x-e.p1.x,c=e.p2.y-e.p1.y,p=a*$+s*c,l=$*$+c*c,f=p*p-l*u;if(f<0||l<Number.MIN_VALUE)return!1;var _=-(p+Math.sqrt(f));return 0<=_&&_<=e.maxFraction*l&&(_/=l,t.fraction=_,t.normal.x=a+_*$,t.normal.y=s+_*c,t.normal.Normalize(),!0)}},{key:"ComputeAABB",value:function(t,e){var r=e.R,n=e.position.x+(r.col1.x*this.m_p.x+r.col2.x*this.m_p.y),o=e.position.y+(r.col1.y*this.m_p.x+r.col2.y*this.m_p.y);t.lowerBound.Set(n-this.m_radius,o-this.m_radius),t.upperBound.Set(n+this.m_radius,o+this.m_radius)}},{key:"ComputeMass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t.mass=e*Zl*this.m_radius*this.m_radius,t.center.SetV(this.m_p),t.I=t.mass*(.5*this.m_radius*this.m_radius+(this.m_p.x*this.m_p.x+this.m_p.y*this.m_p.y))}},{key:"ComputeSubmergedArea",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,o=vb(r,this.m_p),i=-(Ib(t,o)-e);if(i<-this.m_radius+Number.MIN_VALUE)return 0;if(i>this.m_radius)return n.SetV(o),Math.PI*this.m_radius*this.m_radius;var a=this.m_radius*this.m_radius,s=i*i,u=a*(Math.asin(i/this.m_radius)+Math.PI/2)+i*Math.sqrt(a-s),$=-2/3*Math.pow(a-s,1.5)/u;return n.x=o.x+t.x*$,n.y=o.y+t.y*$,u}},{key:"GetLocalPosition",value:function(){return this.m_p}},{key:"SetLocalPosition",value:function(t){this.m_p.SetV(t)}},{key:"GetRadius",value:function(){return this.m_radius}},{key:"SetRadius",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_radius=t}}]),r}();var $w=function(t){gI(r,sb);var e=iI(r);function r(){return eI(this,r),e.apply(this,arguments)}return fI(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&e&&r instanceof Rf&&o instanceof Rf&&SI(this.m_manifold,r,t.m_xf,o,e.m_xf)}}}],[{key:"Create",value:function(t){return new r}},{key:"Destroy",value:function(t,e){}}]),r}();function dJ(t){return(dJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function eJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _w(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function fJ(t,e,r){return e&&_w(t.prototype,e),r&&_w(t,r),t}function gJ(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&hJ(t,e)}function hJ(t,e){return(hJ=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function iJ(t){var e=lJ();return function(){var r,o=ax(t);if(e){var n=ax(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return jJ(this,r)}}function jJ(t,e){return!e||"object"!==dJ(e)&&"function"!=typeof e?kJ(t):e}function kJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lJ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function ax(t){return(ax=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mJ(t){return(mJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function nJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function bx(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function oJ(t,e,r){return e&&bx(t.prototype,e),r&&bx(t,r),t}function pJ(t,e,r){return(pJ="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=qJ(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(r):i.value}})(t,e,r||t)}function qJ(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=tj(t)););return t}function rJ(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&sJ(t,e)}function sJ(t,e){return(sJ=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function tJ(t){var e=wJ();return function(){var r,o=tj(t);if(e){var i=tj(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return uJ(this,r)}}function uJ(t,e){return!e||"object"!==mJ(e)&&"function"!=typeof e?vJ(t):e}function vJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wJ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function tj(t){return(tj=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var ff=function(t){rJ(r,mb);var e=tJ(r);function r(){var t;return nJ(this,r),(t=e.call(this)).m_centroid=new ab,t.m_vertexCount=0,t.m_vertices=[],t.m_normals=[],t.m_type=mb.e_polygonShape,t.m_centroid=new ab,t.m_vertices=[],t.m_normals=[],t}return oJ(r,[{key:"Copy",value:function(){var t=new r;return t.Set(this),t}},{key:"Set",value:function(t){if(pJ(tj(r.prototype),"Set",this).call(this,t),t instanceof r){this.m_centroid.SetV(t.m_centroid),this.m_vertexCount=t.m_vertexCount,this.Reserve(this.m_vertexCount);for(var e=0;e<this.m_vertexCount;e++)this.m_vertices[e].SetV(t.m_vertices[e]),this.m_normals[e].SetV(t.m_normals[e])}}},{key:"SetAsArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.SetAsVector(t.slice(),e)}},{key:"SetAsVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;0===e&&(e=t.length),wb(2<=e),this.m_vertexCount=e,this.Reserve(e);for(var o=0;o<this.m_vertexCount;o++)this.m_vertices[o].SetV(t[o]);for(var i=0;i<this.m_vertexCount;++i){var n=parseInt("".concat(i),10),s=parseInt("".concat(i+1<this.m_vertexCount?i+1:0),10),a=rb(this.m_vertices[s],this.m_vertices[n]);wb(a.LengthSquared()>Number.MIN_VALUE),this.m_normals[i].SetV(cf(a,1)),this.m_normals[i].Normalize()}this.m_centroid=r.ComputeCentroid(this.m_vertices,this.m_vertexCount)}},{key:"SetAsBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid.SetZero()}},{key:"SetAsOrientedBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ab,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.m_vertexCount=4,this.Reserve(4),this.m_vertices[0].Set(-t,-e),this.m_vertices[1].Set(t,-e),this.m_vertices[2].Set(t,e),this.m_vertices[3].Set(-t,e),this.m_normals[0].Set(0,-1),this.m_normals[1].Set(1,0),this.m_normals[2].Set(0,1),this.m_normals[3].Set(-1,0),this.m_centroid=r;var i=new vd;i.position=r,i.R.Set(o);for(var n=0;n<this.m_vertexCount;++n)this.m_vertices[n]=vb(i,this.m_vertices[n]),this.m_normals[n]=df(i.R,this.m_normals[n])}},{key:"SetAsEdge",value:function(t,e){this.m_vertexCount=2,this.Reserve(2),this.m_vertices[0].SetV(t),this.m_vertices[1].SetV(e),this.m_centroid.x=.5*(t.x+e.x),this.m_centroid.y=.5*(t.y+e.y),this.m_normals[0]=cf(rb(e,t),1),this.m_normals[0].Normalize(),this.m_normals[1].x=-this.m_normals[0].x,this.m_normals[1].y=-this.m_normals[0].y}},{key:"TestPoint",value:function(t,e){for(var r,o=t.R,i=e.x-t.position.x,n=e.y-t.position.y,s=i*o.col1.x+n*o.col1.y,a=i*o.col2.x+n*o.col2.y,c=0;c<this.m_vertexCount;++c){if(i=s-(r=this.m_vertices[c]).x,n=a-r.y,(r=this.m_normals[c]).x*i+r.y*n>0)return!1}return!0}},{key:"RayCast",value:function(t,e,r){var o,i,n=0,s=e.maxFraction,a=0,c=0;a=e.p1.x-r.position.x,c=e.p1.y-r.position.y;var u=a*(o=r.R).col1.x+c*o.col1.y,v=a*o.col2.x+c*o.col2.y;a=e.p2.x-r.position.x,c=e.p2.y-r.position.y;for(var m=a*(o=r.R).col1.x+c*o.col1.y-u,$=a*o.col2.x+c*o.col2.y-v,l=parseInt("-1",10),h=0;h<this.m_vertexCount;++h){a=(i=this.m_vertices[h]).x-u,c=i.y-v;var _=(i=this.m_normals[h]).x*a+i.y*c,y=i.x*m+i.y*$;if(0===y){if(_<0)return!1}else y<0&&_<n*y?(n=_/y,l=h):y>0&&_<s*y&&(s=_/y);if(s<n-Number.MIN_VALUE)return!1}return l>=0&&(t.fraction=n,o=r.R,i=this.m_normals[l],t.normal.x=o.col1.x*i.x+o.col2.x*i.y,t.normal.y=o.col1.y*i.x+o.col2.y*i.y,!0)}},{key:"ComputeAABB",value:function(t,e){for(var r=e.R,o=this.m_vertices[0],i=e.position.x+(r.col1.x*o.x+r.col2.x*o.y),n=e.position.y+(r.col1.y*o.x+r.col2.y*o.y),s=i,a=n,c=1;c<this.m_vertexCount;++c){o=this.m_vertices[c];var u=e.position.x+(r.col1.x*o.x+r.col2.x*o.y),v=e.position.y+(r.col1.y*o.x+r.col2.y*o.y);i=i<u?i:u,n=n<v?n:v,s=s>u?s:u,a=a>v?a:v}t.lowerBound.x=i-this.m_radius,t.lowerBound.y=n-this.m_radius,t.upperBound.x=s+this.m_radius,t.upperBound.y=a+this.m_radius}},{key:"ComputeMass",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(2===this.m_vertexCount)return t.center.x=.5*(this.m_vertices[0].x+this.m_vertices[1].x),t.center.y=.5*(this.m_vertices[0].y+this.m_vertices[1].y),t.mass=0,void(t.I=0);for(var r=0,o=0,i=0,n=0,s=0;s<this.m_vertexCount;++s){var a=this.m_vertices[s],c=s+1<this.m_vertexCount?this.m_vertices[parseInt("".concat(s+1),10)]:this.m_vertices[0],u=a.x-0,v=a.y-0,m=c.x-0,$=c.y-0,l=u*$-v*m,h=.5*l;i+=h,r+=h*(1/3)*(0+a.x+c.x),o+=h*(1/3)*(0+a.y+c.y);n+=l*(1/3*(.25*(u*u+m*u+m*m)+(0*u+0*m))+0+(1/3*(.25*(v*v+$*v+$*$)+(0*v+0*$))+0))}t.mass=e*i,r*=1/i,o*=1/i,t.center.Set(r,o),t.I=e*n}},{key:"ComputeSubmergedArea",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,i=Hd(r.R,t),n=e-Ib(t,r.position),s=[],a=0,c=parseInt("".concat(-1),10),u=parseInt("".concat(-1),10),v=!1,m=0;m<this.m_vertexCount;++m){s[m]=Ib(i,this.m_vertices[m])-n;var $=s[m]<-Number.MIN_VALUE;m>0&&($?v||(c=m-1,a++):v&&(u=m-1,a++)),v=$}switch(a){case 0:if(v){var l=new Dw;return this.ComputeMass(l,1),o.SetV(vb(r,l.center)),l.mass}return 0;case 1:-1===c?c=this.m_vertexCount-1:u=this.m_vertexCount-1;}for(var h,_=parseInt("".concat((c+1)%this.m_vertexCount),10),y=parseInt("".concat((u+1)%this.m_vertexCount),10),p=(0-s[c])/(s[_]-s[c]),f=(0-s[u])/(s[y]-s[u]),x=new ab(this.m_vertices[c].x*(1-p)+this.m_vertices[_].x*p,this.m_vertices[c].y*(1-p)+this.m_vertices[_].y*p),M=new ab(this.m_vertices[u].x*(1-f)+this.m_vertices[y].x*f,this.m_vertices[u].y*(1-f)+this.m_vertices[y].y*f),E=0,j=new ab,X=this.m_vertices[_],d=_;d!==y;){h=(d=(d+1)%this.m_vertexCount)===y?M:this.m_vertices[d];var S=.5*((X.x-x.x)*(h.y-x.y)-(X.y-x.y)*(h.x-x.x));E+=S,j.x+=S*(x.x+X.x+h.x)/3,j.y+=S*(x.y+X.y+h.y)/3,X=h}return j.Multiply(1/E),o.SetV(vb(r,j)),E}},{key:"GetVertexCount",value:function(){return this.m_vertexCount}},{key:"GetVertices",value:function(){return this.m_vertices}},{key:"GetNormals",value:function(){return this.m_normals}},{key:"GetSupport",value:function(t){for(var e=0,r=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;o<this.m_vertexCount;++o){var i=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;i>r&&(e=o,r=i)}return e}},{key:"GetSupportVertex",value:function(t){for(var e=0,r=this.m_vertices[0].x*t.x+this.m_vertices[0].y*t.y,o=1;o<this.m_vertexCount;++o){var i=this.m_vertices[o].x*t.x+this.m_vertices[o].y*t.y;i>r&&(e=o,r=i)}return this.m_vertices[e]}},{key:"Validate",value:function(){return!1}},{key:"Reserve",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=parseInt("".concat(this.m_vertices.length),10);e<t;e++)this.m_vertices[e]=new ab,this.m_normals[e]=new ab}}],[{key:"ComputeCentroid",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=new ab,o=0,i=0;i<e;++i){var n=t[i],s=i+1<e?t[parseInt("".concat(i+1),10)]:t[0],a=n.x-0,c=n.y-0,u=s.x-0,v=.5*(a*(s.y-0)-c*u);o+=v,r.x+=v*(1/3)*(0+n.x+s.x),r.y+=v*(1/3)*(0+n.y+s.y)}return r.x*=1/o,r.y*=1/o,r}},{key:"ComputeOBB",value:function(t,e){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=new Array(r+1),i=0;i<r;++i)o[i]=e[i];o[r]=o[0];for(var n=Number.MAX_VALUE,s=1;s<=r;++s){for(var a=o[parseInt("".concat(s-1),10)],c=o[s].x-a.x,u=o[s].y-a.y,v=Math.sqrt(c*c+u*u),m=-(u/=v),$=c/=v,l=Number.MAX_VALUE,h=Number.MAX_VALUE,_=-Number.MAX_VALUE,y=-Number.MAX_VALUE,p=0;p<r;++p){var f=o[p].x-a.x,x=o[p].y-a.y,M=c*f+u*x,E=m*f+$*x;M<l&&(l=M),E<h&&(h=E),M>_&&(_=M),E>y&&(y=E)}var j=(_-l)*(y-h);if(j<.95*n){n=j,t.R.col1.x=c,t.R.col1.y=u,t.R.col2.x=m,t.R.col2.y=$;var X=.5*(l+_),d=.5*(h+y),S=t.R;t.center.x=a.x+(S.col1.x*X+S.col2.x*d),t.center.y=a.y+(S.col1.y*X+S.col2.y*d),t.extents.x=.5*(_-l),t.extents.y=.5*(y-h)}}}},{key:"AsArray",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new r;return o.SetAsArray(t,e),o}},{key:"AsVector",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new r;return o.SetAsVector(t,e),o}},{key:"AsBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=new r;return o.SetAsBox(t,e),o}},{key:"AsOrientedBox",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ab,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=new r;return n.SetAsOrientedBox(t,e,o,i),n}},{key:"AsEdge",value:function(t,e){var o=new r;return o.SetAsEdge(t,e),o}}]),r}();ff.s_mat=new Id;var cx=function(t){gJ(r,sb);var e=iJ(r);function r(){return eJ(this,r),e.apply(this,arguments)}return fJ(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&e&&r instanceof ff&&o instanceof Rf&&TI(this.m_manifold,r,t.m_xf,o,e.m_xf)}}}],[{key:"Create",value:function(t){return new r}},{key:"Destroy",value:function(t,e){}}]),r}();function xJ(t){return(xJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yJ(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function dx(t,r){for(var e=0;e<r.length;e++){var o=r[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function zJ(t,r,e){return r&&dx(t.prototype,r),e&&dx(t,e),t}function AJ(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),r&&BJ(t,r)}function BJ(t,r){return(BJ=Object.setPrototypeOf||function(t,r){return t.__proto__=r,t})(t,r)}function CJ(t){var r=FJ();return function(){var e,o=ex(t);if(r){var n=ex(this).constructor;e=Reflect.construct(o,arguments,n)}else e=o.apply(this,arguments);return DJ(this,e)}}function DJ(t,r){return!r||"object"!==xJ(r)&&"function"!=typeof r?EJ(t):r}function EJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FJ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function ex(t){return(ex=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var fx=function(t){AJ(e,sb);var r=CJ(e);function e(){return yJ(this,e),r.apply(this,arguments)}return zJ(e,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),r=this.m_fixtureB.GetBody(),e=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&r&&e instanceof ff&&o instanceof ff&&RI(this.m_manifold,e,t.m_xf,o,r.m_xf)}}}],[{key:"Create",value:function(t){return new e}},{key:"Destroy",value:function(t,r){}}]),e}();function GJ(t){return(GJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function HJ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gx(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function IJ(t,e,r){return e&&gx(t.prototype,e),r&&gx(t,r),t}function JJ(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&KJ(t,e)}function KJ(t,e){return(KJ=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function LJ(t){var e=OJ();return function(){var r,o=hx(t);if(e){var n=hx(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return MJ(this,r)}}function MJ(t,e){return!e||"object"!==GJ(e)&&"function"!=typeof e?NJ(t):e}function NJ(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function OJ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function hx(t){return(hx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function PJ(e){return(PJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function QJ(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function ix(e,o){for(var t=0;t<o.length;t++){var r=o[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RJ(e,o,t){return o&&ix(e.prototype,o),t&&ix(e,t),e}function SJ(e,o){if("function"!=typeof o&&null!==o)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(o&&o.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),o&&TJ(e,o)}function TJ(e,o){return(TJ=Object.setPrototypeOf||function(e,o){return e.__proto__=o,e})(e,o)}function UJ(e){var o=XJ();return function(){var t,r=jx(e);if(o){var n=jx(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return VJ(this,t)}}function VJ(e,o){return!o||"object"!==PJ(o)&&"function"!=typeof o?WJ(e):o}function WJ(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function XJ(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function jx(e){return(jx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var lm=function(e){SJ(t,mb);var o=UJ(t);function t(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ab,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ab;return QJ(this,t),(e=o.call(this)).s_supportVec=new ab,e.m_v1=new ab,e.m_v2=new ab,e.m_coreV1=new ab,e.m_coreV2=new ab,e.m_normal=new ab,e.m_direction=new ab,e.m_cornerDir1=new ab,e.m_cornerDir2=new ab,e.m_length=0,e.m_cornerConvex1=!1,e.m_cornerConvex2=!1,e.m_type=mb.e_edgeShape,e.m_prevEdge=void 0,e.m_nextEdge=void 0,e.m_v1=r,e.m_v2=n,e.m_direction.Set(e.m_v2.x-e.m_v1.x,e.m_v2.y-e.m_v1.y),e.m_length=e.m_direction.Normalize(),e.m_normal.Set(e.m_direction.y,-e.m_direction.x),e.m_coreV1.Set(-vg*(e.m_normal.x-e.m_direction.x)+e.m_v1.x,-vg*(e.m_normal.y-e.m_direction.y)+e.m_v1.y),e.m_coreV2.Set(-vg*(e.m_normal.x+e.m_direction.x)+e.m_v2.x,-vg*(e.m_normal.y+e.m_direction.y)+e.m_v2.y),e.m_cornerDir1=e.m_normal,e.m_cornerDir2.Set(-e.m_normal.x,-e.m_normal.y),e}return RJ(t,[{key:"RayCast",value:function(e,o,t){var r=t.R,n=o.p2.x-o.p1.x,i=o.p2.y-o.p1.y,c=t.position.x+(r.col1.x*this.m_v1.x+r.col2.x*this.m_v1.y),$=t.position.y+(r.col1.y*this.m_v1.x+r.col2.y*this.m_v1.y),u=t.position.y+(r.col1.y*this.m_v2.x+r.col2.y*this.m_v2.y)-$,m=-(t.position.x+(r.col1.x*this.m_v2.x+r.col2.x*this.m_v2.y)-c),s=100*Number.MIN_VALUE,a=-(n*u+i*m);if(a>s){var _=o.p1.x-c,l=o.p1.y-$,p=_*u+l*m;if(0<=p&&p<=o.maxFraction*a){var y=-n*l+i*_;if(-s*a<=y&&y<=a*(1+s)){p/=a,e.fraction=p;var v=Math.sqrt(u*u+m*m);return e.normal.x=u/v,e.normal.y=m/v,!0}}}return!1}},{key:"ComputeAABB",value:function(e,o){var t=o.R,r=o.position.x+(t.col1.x*this.m_v1.x+t.col2.x*this.m_v1.y),n=o.position.y+(t.col1.y*this.m_v1.x+t.col2.y*this.m_v1.y),i=o.position.x+(t.col1.x*this.m_v2.x+t.col2.x*this.m_v2.y),c=o.position.y+(t.col1.y*this.m_v2.x+t.col2.y*this.m_v2.y);r<i?(e.lowerBound.x=r,e.upperBound.x=i):(e.lowerBound.x=i,e.upperBound.x=r),n<c?(e.lowerBound.y=n,e.upperBound.y=c):(e.lowerBound.y=c,e.upperBound.y=n)}},{key:"ComputeMass",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.mass=0,e.center.SetV(this.m_v1),e.I=0}},{key:"ComputeSubmergedArea",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,n=new ab(e.x*o,e.y*o),i=vb(t,this.m_v1),c=vb(t,this.m_v2),$=Ib(e,i)-o,u=Ib(e,c)-o;if($>0){if(u>0)return 0;i.x=-u/($-u)*i.x+$/($-u)*c.x,i.y=-u/($-u)*i.y+$/($-u)*c.y}else u>0&&(c.x=-u/($-u)*i.x+$/($-u)*c.x,c.y=-u/($-u)*i.y+$/($-u)*c.y);return r.x=(n.x+i.x+c.x)/3,r.y=(n.y+i.y+c.y)/3,.5*((i.x-n.x)*(c.y-n.y)-(i.y-n.y)*(c.x-n.x))}},{key:"GetLength",value:function(){return this.m_length}},{key:"GetVertex1",value:function(){return this.m_v1}},{key:"GetVertex2",value:function(){return this.m_v2}},{key:"GetCoreVertex1",value:function(){return this.m_coreV1}},{key:"GetCoreVertex2",value:function(){return this.m_coreV2}},{key:"GetNormalVector",value:function(){return this.m_normal}},{key:"GetDirectionVector",value:function(){return this.m_direction}},{key:"GetCorner1Vector",value:function(){return this.m_cornerDir1}},{key:"GetCorner2Vector",value:function(){return this.m_cornerDir2}},{key:"Corner1IsConvex",value:function(){return this.m_cornerConvex1}},{key:"Corner2IsConvex",value:function(){return this.m_cornerConvex2}},{key:"GetFirstVertex",value:function(e){var o=e.R;return new ab(e.position.x+(o.col1.x*this.m_coreV1.x+o.col2.x*this.m_coreV1.y),e.position.y+(o.col1.y*this.m_coreV1.x+o.col2.y*this.m_coreV1.y))}},{key:"GetNextEdge",value:function(){return this.m_nextEdge}},{key:"GetPrevEdge",value:function(){return this.m_prevEdge}},{key:"Support",value:function(e){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=e.R,n=e.position.x+(r.col1.x*this.m_coreV1.x+r.col2.x*this.m_coreV1.y),i=e.position.y+(r.col1.y*this.m_coreV1.x+r.col2.y*this.m_coreV1.y),c=e.position.x+(r.col1.x*this.m_coreV2.x+r.col2.x*this.m_coreV2.y),$=e.position.y+(r.col1.y*this.m_coreV2.x+r.col2.y*this.m_coreV2.y);return n*o+i*t>c*o+$*t?(this.s_supportVec.x=n,this.s_supportVec.y=i):(this.s_supportVec.x=c,this.s_supportVec.y=$),this.s_supportVec}},{key:"SetPrevEdge",value:function(e,o,t,r){this.m_prevEdge=e,this.m_coreV1=o,this.m_cornerDir1=t,this.m_cornerConvex1=r}},{key:"SetNextEdge",value:function(e,o,t,r){this.m_nextEdge=e,this.m_coreV2=o,this.m_cornerDir2=t,this.m_cornerConvex2=r}}]),t}();var kx=function(t){JJ(r,sb);var e=LJ(r);function r(){return HJ(this,r),e.apply(this,arguments)}return IJ(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var t=this.m_fixtureA.GetBody(),e=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();t&&e&&r instanceof lm&&o instanceof Rf&&this.CollideEdgeAndCircle(this.m_manifold,r,t.m_xf,o,e.m_xf)}}},{key:"CollideEdgeAndCircle",value:function(t,e,r,o,n){}}],[{key:"Create",value:function(t){return new r}},{key:"Destroy",value:function(t,e){}}]),r}();function YJ(e){return(YJ="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ZJ(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function lx(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function $J(e,t,r){return t&&lx(e.prototype,t),r&&lx(e,r),e}function _J(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&aK(e,t)}function aK(e,t){return(aK=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bK(e){var t=eK();return function(){var r,o=mx(e);if(t){var n=mx(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return cK(this,r)}}function cK(e,t){return!t||"object"!==YJ(t)&&"function"!=typeof t?dK(e):t}function dK(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function mx(e){return(mx=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var nx=function(e){_J(r,sb);var t=bK(r);function r(){return ZJ(this,r),t.apply(this,arguments)}return $J(r,[{key:"Evaluate",value:function(){if(this.m_fixtureA&&this.m_fixtureB){var e=this.m_fixtureA.GetBody(),t=this.m_fixtureB.GetBody(),r=this.m_fixtureA.GetShape(),o=this.m_fixtureB.GetShape();e&&t&&r instanceof ff&&o instanceof lm&&this.CollidePolyAndEdge(this.m_manifold,r,e.m_xf,o,t.m_xf)}}},{key:"CollidePolyAndEdge",value:function(e,t,r,o,n){}}],[{key:"Create",value:function(e){return new r}},{key:"Destroy",value:function(e,t){}}]),r}();var fK=function(){function e(t){_H(this,e),this.m_allocator=t,this.m_registers={},this.InitializeRegisters()}return aI(e,[{key:"AddType",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.m_registers[r][o].createFn=e,this.m_registers[r][o].destroyFn=t,this.m_registers[r][o].primary=!0,r!==o&&(this.m_registers[o][r].createFn=e,this.m_registers[o][r].destroyFn=t,this.m_registers[o][r].primary=!1)}},{key:"InitializeRegisters",value:function(){this.m_registers=new Array(mb.e_shapeTypeCount);for(var e=0;e<mb.e_shapeTypeCount;e++){this.m_registers[e]=new Array(mb.e_shapeTypeCount);for(var t=0;t<mb.e_shapeTypeCount;t++)this.m_registers[e][t]=new cI}this.AddType($w.Create,$w.Destroy,mb.e_circleShape,mb.e_circleShape),this.AddType(cx.Create,cx.Destroy,mb.e_polygonShape,mb.e_circleShape),this.AddType(fx.Create,fx.Destroy,mb.e_polygonShape,mb.e_polygonShape),this.AddType(kx.Create,kx.Destroy,mb.e_edgeShape,mb.e_circleShape),this.AddType(nx.Create,nx.Destroy,mb.e_polygonShape,mb.e_edgeShape)}},{key:"Create",value:function(e,t){var r,o=parseInt("".concat(e.GetType()),10),a=parseInt("".concat(t.GetType()),10),i=this.m_registers[o][a];if(i.pool)return r=i.pool,i.pool=r.m_next,i.poolCount--,r.Reset(e,t),r;var $=i.createFn;return $?i.primary?((r=$(this.m_allocator)).Reset(e,t),r):((r=$(this.m_allocator)).Reset(t,e),r):void 0}},{key:"Destroy",value:function(e){if(e.m_fixtureA&&e.m_fixtureB&&e.m_fixtureA.m_body&&e.m_fixtureB.m_body){e.m_manifold.m_pointCount>0&&(e.m_fixtureA.m_body.SetAwake(!0),e.m_fixtureB.m_body.SetAwake(!0));var t=parseInt("".concat(e.m_fixtureA.GetType()),10),r=parseInt("".concat(e.m_fixtureB.GetType()),10),o=this.m_registers[t][r];o.poolCount++,e.m_next=o.pool,o.pool=e;var a=o.destroyFn;a&&a(e,this.m_allocator)}}}]),e}();var ox=function(){function t(){bH(this,t),this.m_contactCount=0,this.m_contactFilter=dm.b2_defaultFilter,this.m_contactListener=em.b2_defaultListener,this.m_contactFactory=new fK(void 0),this.m_broadPhase=new TH}return cH(t,[{key:"AddPair",value:function(t,e){var o=t.GetBody(),n=e.GetBody();if(this.m_world&&o&&n&&o!==n){for(var r=n.GetContactList();r;){if(r.other===o){var i=r.contact.GetFixtureA(),a=r.contact.GetFixtureB();if(i===t&&a===e)return;if(i===e&&a===t)return}r=r.next}if(!1!==n.ShouldCollide(o)&&!1!==this.m_contactFilter.ShouldCollide(t,e)){var c=this.m_contactFactory.Create(t,e);t=c.GetFixtureA(),e=c.GetFixtureB(),o=t.m_body,n=e.m_body,o&&n&&(c.m_prev=void 0,c.m_next=this.m_world.m_contactList,null!=this.m_world.m_contactList&&(this.m_world.m_contactList.m_prev=c),this.m_world.m_contactList=c,c.m_nodeA.contact=c,c.m_nodeA.other=n,c.m_nodeA.prev=void 0,c.m_nodeA.next=o.m_contactList,null!=o.m_contactList&&(o.m_contactList.prev=c.m_nodeA),o.m_contactList=c.m_nodeA,c.m_nodeB.contact=c,c.m_nodeB.other=o,c.m_nodeB.prev=void 0,c.m_nodeB.next=n.m_contactList,null!=n.m_contactList&&(n.m_contactList.prev=c.m_nodeB),n.m_contactList=c.m_nodeB,++this.m_world.m_contactCount)}}}},{key:"FindNewContacts",value:function(){var t=this;this.m_broadPhase.UpdatePairs(function(e,o){t.AddPair(e,o)})}},{key:"Destroy",value:function(t){if(this.m_world){var e=t.GetFixtureA(),o=t.GetFixtureB(),n=e.GetBody(),r=o.GetBody();t.IsTouching()&&this.m_contactListener.EndContact(t),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_world.m_contactList&&(this.m_world.m_contactList=t.m_next),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA===n.m_contactList&&(n.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB===r.m_contactList&&(r.m_contactList=t.m_nodeB.next),this.m_contactFactory.Destroy(t),--this.m_contactCount}}},{key:"Collide",value:function(){if(this.m_world)for(var t=this.m_world.m_contactList;t;){var e=t.GetFixtureA(),o=t.GetFixtureB();if(!e||!o)return;var n=e.GetBody(),r=o.GetBody();if(!n||!r)return;if(!1!==n.IsAwake()||!1!==r.IsAwake()){if(t.m_flags&sb.e_filterFlag){if(!1===r.ShouldCollide(n)){var i=t;t=i.GetNext(),this.Destroy(i);continue}if(!1===this.m_contactFilter.ShouldCollide(e,o)){var a=t;t=a.GetNext(),this.Destroy(a);continue}t.m_flags&=~sb.e_filterFlag}var c=e.m_proxy,_=o.m_proxy;if(!1!==this.m_broadPhase.TestOverlap(c,_))t.Update(this.m_contactListener),t=t.GetNext();else{var m=t;t=m.GetNext(),this.Destroy(m)}}else t=t.GetNext()}}}]),t}();ox.s_evalCP=new $H;function gK(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function px(r,n){for(var o=0;o<n.length;o++){var t=n[o];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(r,t.key,t)}}function hK(r,n,o){return n&&px(r.prototype,n),o&&px(r,o),r}function iK(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function qx(o,i){for(var t=0;t<i.length;t++){var l=i[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,l.key,l)}}function jK(o,i,t){return i&&qx(o.prototype,i),t&&qx(o,t),o}var kK=function(){function o(){iK(this,o),this.m_normal=new ab,this.m_points=new Array(bd),this.m_points=this.m_points.fill(0).map(function(){return new ab})}return jK(o,[{key:"Initialize",value:function(o,i){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,l=arguments.length>3?arguments[3]:void 0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(0!==o.m_pointCount){var a,r,e=0,c=0,s=0,x=0,m=0,$=0;switch(o.m_type){case Gb.e_circles:r=i.R,a=o.m_localPoint;var y=i.position.x+r.col1.x*a.x+r.col2.x*a.y,_=i.position.y+r.col1.y*a.x+r.col2.y*a.y;r=l.R,a=o.m_points[0].m_localPoint;var p=l.position.x+r.col1.x*a.x+r.col2.x*a.y,J=l.position.y+r.col1.y*a.x+r.col2.y*a.y,h=p-y,f=J-_,u=h*h+f*f;if(u>Number.MIN_VALUE*Number.MIN_VALUE){var v=Math.sqrt(u);this.m_normal.x=h/v,this.m_normal.y=f/v}else this.m_normal.x=1,this.m_normal.y=0;var O=y+t*this.m_normal.x,d=_+t*this.m_normal.y,P=p-n*this.m_normal.x,b=J-n*this.m_normal.y;this.m_points[0].x=.5*(O+P),this.m_points[0].y=.5*(d+b);break;case Gb.e_faceA:r=i.R,a=o.m_localPlaneNormal,e=r.col1.x*a.x+r.col2.x*a.y,c=r.col1.y*a.x+r.col2.y*a.y,r=i.R,a=o.m_localPoint,s=i.position.x+r.col1.x*a.x+r.col2.x*a.y,x=i.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_normal.x=e,this.m_normal.y=c;for(var C=0;C<o.m_pointCount;C++)r=l.R,a=o.m_points[C].m_localPoint,m=l.position.x+r.col1.x*a.x+r.col2.x*a.y,$=l.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_points[C].x=m+.5*(t-(m-s)*e-($-x)*c-n)*e,this.m_points[C].y=$+.5*(t-(m-s)*e-($-x)*c-n)*c;break;case Gb.e_faceB:r=l.R,a=o.m_localPlaneNormal,e=r.col1.x*a.x+r.col2.x*a.y,c=r.col1.y*a.x+r.col2.y*a.y,r=l.R,a=o.m_localPoint,s=l.position.x+r.col1.x*a.x+r.col2.x*a.y,x=l.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_normal.x=-e,this.m_normal.y=-c;for(var R=0;R<o.m_pointCount;R++)r=i.R,a=o.m_points[R].m_localPoint,m=i.position.x+r.col1.x*a.x+r.col2.x*a.y,$=i.position.y+r.col1.y*a.x+r.col2.y*a.y,this.m_points[R].x=m+.5*(n-(m-s)*e-($-x)*c-t)*e,this.m_points[R].y=$+.5*(n-(m-s)*e-($-x)*c-t)*c;}}}}]),o}();function lK(o,i){if(!(o instanceof i))throw new TypeError("Cannot call a class as a function")}function rx(o,i){for(var t=0;t<i.length;t++){var l=i[t];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(o,l.key,l)}}function mK(o,i,t){return i&&rx(o.prototype,i),t&&rx(o,t),o}var mm=function(){function o(){lK(this,o),this.m_normal=new ab,this.m_separations=new Array(bd).fill(0),this.m_points=new Array(bd).fill(0),this.m_points=this.m_points.map(function(){return new ab})}return mK(o,[{key:"Initialize",value:function(o){wb(o.pointCount>0);var i,t,l=0,n=0,r=0,a=0;switch(o.type){case Gb.e_circles:i=o.bodyA.m_xf.R,t=o.localPoint;var e=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),s=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y);i=o.bodyB.m_xf.R,t=o.points[0].localPoint;var m=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),c=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),x=m-e,y=c-s,$=x*x+y*y;if($>Number.MIN_VALUE*Number.MIN_VALUE){var _=Math.sqrt($);this.m_normal.x=x/_,this.m_normal.y=y/_}else this.m_normal.x=1,this.m_normal.y=0;this.m_points[0].x=.5*(e+m),this.m_points[0].y=.5*(s+c),this.m_separations[0]=x*this.m_normal.x+y*this.m_normal.y-o.radius;break;case Gb.e_faceA:i=o.bodyA.m_xf.R,t=o.localPlaneNormal,this.m_normal.x=i.col1.x*t.x+i.col2.x*t.y,this.m_normal.y=i.col1.y*t.x+i.col2.y*t.y,i=o.bodyA.m_xf.R,t=o.localPoint,r=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),a=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),i=o.bodyB.m_xf.R;for(var p=0;p<o.pointCount;++p)t=o.points[p].localPoint,l=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),n=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),this.m_separations[p]=(l-r)*this.m_normal.x+(n-a)*this.m_normal.y-o.radius,this.m_points[p].x=l,this.m_points[p].y=n;break;case Gb.e_faceB:i=o.bodyB.m_xf.R,t=o.localPlaneNormal,this.m_normal.x=i.col1.x*t.x+i.col2.x*t.y,this.m_normal.y=i.col1.y*t.x+i.col2.y*t.y,i=o.bodyB.m_xf.R,t=o.localPoint,r=o.bodyB.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),a=o.bodyB.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),i=o.bodyA.m_xf.R;for(var f=0;f<o.pointCount;++f)t=o.points[f].localPoint,l=o.bodyA.m_xf.position.x+(i.col1.x*t.x+i.col2.x*t.y),n=o.bodyA.m_xf.position.y+(i.col1.y*t.x+i.col2.y*t.y),this.m_separations[f]=(l-r)*this.m_normal.x+(n-a)*this.m_normal.y-o.radius,this.m_points[f].Set(l,n);this.m_normal.x*=-1,this.m_normal.y*=-1;}}}]),o}();mm.circlePointA=new ab,mm.circlePointB=new ab;function nK(t,$){if(!(t instanceof $))throw new TypeError("Cannot call a class as a function")}function oK($,e){if(!($ instanceof e))throw new TypeError("Cannot call a class as a function")}var pK=function $(){oK(this,$),this.localPoint=new ab,this.rA=new ab,this.rB=new ab};var qK=function t(){nK(this,t),this.localPlaneNormal=new ab,this.localPoint=new ab,this.normal=new ab,this.normalMass=new Id,this.K=new Id,this.points=new Array(bd).fill(0),this.points=this.points.map(function(){return new pK})};var uj=function(){function r(){gK(this,r),this.m_step=new bm,this.m_constraints=new Array,this.m_constraintCount=0}return hK(r,[{key:"Initialize",value:function(n,o){var t,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;this.m_step.Set(n),this.m_allocator=i;var e=0;for(this.m_constraintCount=a;this.m_constraints.length<this.m_constraintCount;)this.m_constraints[this.m_constraints.length]=new qK;for(e=0;e<a;++e){var s=(t=o[e]).m_fixtureA,l=t.m_fixtureB;if(s&&l){var m=s.m_shape,p=l.m_shape;if(m&&p){var _=m.m_radius,y=p.m_radius,c=s.m_body,u=l.m_body;if(c&&u){var x=t.GetManifold(),v=PG(s.GetFriction(),l.GetFriction()),$=QG(s.GetRestitution(),l.GetRestitution()),f=c.m_linearVelocity.x,d=c.m_linearVelocity.y,I=u.m_linearVelocity.x,B=u.m_linearVelocity.y,A=c.m_angularVelocity,G=u.m_angularVelocity;wb(x.m_pointCount>0),r.s_worldManifold.Initialize(x,c.m_xf,_,u.m_xf,y);var M=r.s_worldManifold.m_normal.x,h=r.s_worldManifold.m_normal.y,C=this.m_constraints[e];C.bodyA=c,C.bodyB=u,C.manifold=x,C.normal.x=M,C.normal.y=h,C.pointCount=x.m_pointCount,C.friction=v,C.restitution=$,C.localPlaneNormal.x=x.m_localPlaneNormal.x,C.localPlaneNormal.y=x.m_localPlaneNormal.y,C.localPoint.x=x.m_localPoint.x,C.localPoint.y=x.m_localPoint.y,C.radius=_+y,C.type=x.m_type;for(var w=0;w<C.pointCount;++w){var D=x.m_points[w],J=C.points[w];J.normalImpulse=D.m_normalImpulse,J.tangentImpulse=D.m_tangentImpulse,J.localPoint.SetV(D.m_localPoint);var g=J.rA.x=r.s_worldManifold.m_points[w].x-c.m_sweep.c.x,b=J.rA.y=r.s_worldManifold.m_points[w].y-c.m_sweep.c.y,V=J.rB.x=r.s_worldManifold.m_points[w].x-u.m_sweep.c.x,P=J.rB.y=r.s_worldManifold.m_points[w].y-u.m_sweep.c.y,k=g*h-b*M,S=V*h-P*M;k*=k,S*=S;var q=c.m_invMass+u.m_invMass+c.m_invI*k+u.m_invI*S;J.normalMass=1/q;var z=c.m_mass*c.m_invMass+u.m_mass*u.m_invMass;z+=c.m_mass*c.m_invI*k+u.m_mass*u.m_invI*S,J.equalizedMass=1/z;var K=-M,R=g*K-b*h,T=V*K-P*h;R*=R,T*=T;var F=c.m_invMass+u.m_invMass+c.m_invI*R+u.m_invI*T;J.tangentMass=1/F,J.velocityBias=0;var N=I+-G*P-f- -A*b,j=B+G*V-d-A*g,E=C.normal.x*N+C.normal.y*j;E<-MG&&(J.velocityBias+=-C.restitution*E)}if(2===C.pointCount){var L=C.points[0],O=C.points[1],W=c.m_invMass,H=c.m_invI,Q=u.m_invMass,U=u.m_invI,X=L.rA.x*h-L.rA.y*M,Y=L.rB.x*h-L.rB.y*M,Z=O.rA.x*h-O.rA.y*M,rr=O.rB.x*h-O.rB.y*M,nr=W+Q+H*X*X+U*Y*Y,or=W+Q+H*Z*Z+U*rr*rr,tr=W+Q+H*X*Z+U*Y*rr;nr*nr<100*(nr*or-tr*tr)?(C.K.col1.Set(nr,tr),C.K.col2.Set(tr,or),C.K.GetInverse(C.normalMass)):C.pointCount=1}}}}}}},{key:"InitVelocityConstraints",value:function(r){for(var n=0;n<this.m_constraintCount;++n){var o=this.m_constraints[n],t=o.bodyA,a=o.bodyB,i=t.m_invMass,e=t.m_invI,s=a.m_invMass,l=a.m_invI,m=o.normal.x,p=o.normal.y,_=p,y=-m,c=0;if(r.warmStarting){c=o.pointCount;for(var u=0;u<c;++u){var x=o.points[u];x.normalImpulse*=r.dtRatio,x.tangentImpulse*=r.dtRatio;var v=x.normalImpulse*m+x.tangentImpulse*_,$=x.normalImpulse*p+x.tangentImpulse*y;t.m_angularVelocity-=e*(x.rA.x*$-x.rA.y*v),t.m_linearVelocity.x-=i*v,t.m_linearVelocity.y-=i*$,a.m_angularVelocity+=l*(x.rB.x*$-x.rB.y*v),a.m_linearVelocity.x+=s*v,a.m_linearVelocity.y+=s*$}}else{c=o.pointCount;for(var f=0;f<c;++f){var d=o.points[f];d.normalImpulse=0,d.tangentImpulse=0}}}}},{key:"SolveVelocityConstraints",value:function(){for(var r,n,o=0,t=0,a=0,i=0,e=0,s=0,l=0,m=0,p=0,_=0,y=0,c=0,u=0,x=0;x<this.m_constraintCount;++x){for(var v=this.m_constraints[x],$=v.bodyA,f=v.bodyB,d=$.m_angularVelocity,I=f.m_angularVelocity,B=$.m_linearVelocity,A=f.m_linearVelocity,G=$.m_invMass,M=$.m_invI,h=f.m_invMass,C=f.m_invI,w=v.normal.x,D=v.normal.y,J=D,g=-w,b=v.friction,V=0;V<v.pointCount;V++)r=v.points[V],t=(A.x-I*r.rB.y-B.x+d*r.rA.y)*J+(A.y+I*r.rB.x-B.y-d*r.rA.x)*g,a=r.tangentMass*-t,i=b*r.normalImpulse,s=(a=(e=td(r.tangentImpulse+a,-i,i))-r.tangentImpulse)*J,l=a*g,B.x-=G*s,B.y-=G*l,d-=M*(r.rA.x*l-r.rA.y*s),A.x+=h*s,A.y+=h*l,I+=C*(r.rB.x*l-r.rB.y*s),r.tangentImpulse=e;if(1===v.pointCount)r=v.points[0],o=(A.x+-I*r.rB.y-B.x- -d*r.rA.y)*w+(A.y+I*r.rB.x-B.y-d*r.rA.x)*D,a=-r.normalMass*(o-r.velocityBias),s=(a=(e=(e=r.normalImpulse+a)>0?e:0)-r.normalImpulse)*w,l=a*D,B.x-=G*s,B.y-=G*l,d-=M*(r.rA.x*l-r.rA.y*s),A.x+=h*s,A.y+=h*l,I+=C*(r.rB.x*l-r.rB.y*s),r.normalImpulse=e;else{var P=v.points[0],k=v.points[1],S=P.normalImpulse,q=k.normalImpulse,z=(A.x-I*P.rB.y-B.x+d*P.rA.y)*w+(A.y+I*P.rB.x-B.y-d*P.rA.x)*D,K=(A.x-I*k.rB.y-B.x+d*k.rA.y)*w+(A.y+I*k.rB.x-B.y-d*k.rA.x)*D,R=z-P.velocityBias,T=K-k.velocityBias;for(R-=(n=v.K).col1.x*S+n.col2.x*q,T-=n.col1.y*S+n.col2.y*q;;){var F=-((n=v.normalMass).col1.x*R+n.col2.x*T),N=-(n.col1.y*R+n.col2.y*T);if(F>=0&&N>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}if(F=-P.normalMass*R,N=0,z=0,K=v.K.col1.y*F+T,F>=0&&K>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}if(F=0,N=-k.normalMass*T,z=v.K.col2.x*N+R,K=0,N>=0&&z>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}if(F=0,N=0,K=T,(z=R)>=0&&K>=0){_=(m=F-S)*w,y=m*D,c=(p=N-q)*w,u=p*D,B.x-=G*(_+c),B.y-=G*(y+u),d-=M*(P.rA.x*y-P.rA.y*_+k.rA.x*u-k.rA.y*c),A.x+=h*(_+c),A.y+=h*(y+u),I+=C*(P.rB.x*y-P.rB.y*_+k.rB.x*u-k.rB.y*c),P.normalImpulse=F,k.normalImpulse=N;break}break}}$.m_angularVelocity=d,f.m_angularVelocity=I}}},{key:"FinalizeVelocityConstraints",value:function(){for(var r=0;r<this.m_constraintCount;++r)for(var n=this.m_constraints[r],o=n.manifold,t=0;t<n.pointCount;++t){var a=o.m_points[t],i=n.points[t];a.m_normalImpulse=i.normalImpulse,a.m_tangentImpulse=i.tangentImpulse}}},{key:"SolvePositionConstraints",value:function(){for(var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=0,t=0;t<this.m_constraintCount;t++){var a=this.m_constraints[t],i=a.bodyA,e=a.bodyB,s=i.m_mass*i.m_invMass,l=i.m_mass*i.m_invI,m=e.m_mass*e.m_invMass,p=e.m_mass*e.m_invI;r.s_psm.Initialize(a);for(var _=r.s_psm.m_normal,y=0;y<a.pointCount;y++){var c=a.points[y],u=r.s_psm.m_points[y],x=r.s_psm.m_separations[y],v=u.x-i.m_sweep.c.x,$=u.y-i.m_sweep.c.y,f=u.x-e.m_sweep.c.x,d=u.y-e.m_sweep.c.y;o=o<x?o:x;var I=td(n*(x+ud),-NG,0),B=-c.equalizedMass*I,A=B*_.x,G=B*_.y;i.m_sweep.c.x-=s*A,i.m_sweep.c.y-=s*G,i.m_sweep.a-=l*(v*G-$*A),i.SynchronizeTransform(),e.m_sweep.c.x+=m*A,e.m_sweep.c.y+=m*G,e.m_sweep.a+=p*(f*G-d*A),e.SynchronizeTransform()}}return o>-1.5*ud}}]),r}();uj.s_worldManifold=new kK,uj.s_psm=new mm;function rK(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function sx(t,i){for(var o=0;o<i.length;o++){var e=i[o];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function sK(t,i,o){return i&&sx(t.prototype,i),o&&sx(t,o),t}function tK(a,n){if(!(a instanceof n))throw new TypeError("Cannot call a class as a function")}var uK=function a(){tK(this,a),this.normalImpulses=new Array(bd),this.tangentImpulses=new Array(bd)};var tx=function(){function t(){rK(this,t),this.m_bodies=new Array,this.m_contacts=new Array,this.m_joints=new Array,this.m_bodyCapacity=0,this.m_contactCapacity=0,this.m_jointCapacity=0,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=void 0,this.m_listener=void 0,this.m_contactSolver=new uj}return sK(t,[{key:"Initialize",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0,a=arguments.length>5?arguments[5]:void 0;this.m_bodyCapacity=t,this.m_contactCapacity=i,this.m_jointCapacity=o,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=e,this.m_listener=n,this.m_contactSolver=a;for(var r=this.m_bodies.length;r<t;r++)this.m_bodies[r]=null;for(var s=this.m_contacts.length;s<i;s++)this.m_contacts[s]=null;for(var m=this.m_joints.length;m<o;m++)this.m_joints[m]=null}},{key:"Clear",value:function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0}},{key:"Solve",value:function(t,i,o){var e,n=0,a=0;for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).GetType()===eb.b2_dynamicBody&&(e.m_linearVelocity.x+=t.dt*(i.x+e.m_invMass*e.m_force.x),e.m_linearVelocity.y+=t.dt*(i.y+e.m_invMass*e.m_force.y),e.m_angularVelocity+=t.dt*e.m_invI*e.m_torque,e.m_linearVelocity.Multiply(td(1-t.dt*e.m_linearDamping,0,1)),e.m_angularVelocity*=td(1-t.dt*e.m_angularDamping,0,1));this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var r=this.m_contactSolver;for(r.InitVelocityConstraints(t),n=0;n<this.m_jointCount;++n)this.m_joints[n].InitVelocityConstraints(t);for(n=0;n<t.velocityIterations;++n){for(a=0;a<this.m_jointCount;++a)this.m_joints[a].SolveVelocityConstraints(t);r.SolveVelocityConstraints()}for(n=0;n<this.m_jointCount;++n)this.m_joints[n].FinalizeVelocityConstraints();for(r.FinalizeVelocityConstraints(),n=0;n<this.m_bodyCount;++n)if((e=this.m_bodies[n]).GetType()!==eb.b2_staticBody){var s=t.dt*e.m_linearVelocity.x,m=t.dt*e.m_linearVelocity.y;s*s+m*m>ew&&(e.m_linearVelocity.Normalize(),e.m_linearVelocity.x*=Nf*t.inv_dt,e.m_linearVelocity.y*=Nf*t.inv_dt);var l=t.dt*e.m_angularVelocity;l*l>fw&&(e.m_angularVelocity<0?e.m_angularVelocity=-Of*t.inv_dt:e.m_angularVelocity=Of*t.inv_dt),e.m_sweep.c0.SetV(e.m_sweep.c),e.m_sweep.a0=e.m_sweep.a,e.m_sweep.c.x+=t.dt*e.m_linearVelocity.x,e.m_sweep.c.y+=t.dt*e.m_linearVelocity.y,e.m_sweep.a+=t.dt*e.m_angularVelocity,e.SynchronizeTransform()}for(n=0;n<t.positionIterations;++n){var _=r.SolvePositionConstraints(am),c=!0;for(a=0;a<this.m_jointCount;++a){var $=this.m_joints[a].SolvePositionConstraints(am);c=c&&$}if(_&&c)break}if(this.Report(r.m_constraints),o){var y=Number.MAX_VALUE,p=gw*gw,u=hw*hw;for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).GetType()!==eb.b2_staticBody&&(0==(e.m_flags&eb.e_allowSleepFlag)&&(e.m_sleepTime=0,y=0),0==(e.m_flags&eb.e_allowSleepFlag)||e.m_angularVelocity*e.m_angularVelocity>u||Ib(e.m_linearVelocity,e.m_linearVelocity)>p?(e.m_sleepTime=0,y=0):(e.m_sleepTime+=t.dt,y=EG(y,e.m_sleepTime)));if(y>=OG)for(n=0;n<this.m_bodyCount;++n)(e=this.m_bodies[n]).SetAwake(!1)}}},{key:"SolveTOI",value:function(t){var i=0,o=0;this.m_contactSolver.Initialize(t,this.m_contacts,this.m_contactCount,this.m_allocator);var e=this.m_contactSolver;for(i=0;i<this.m_jointCount;++i)this.m_joints[i].InitVelocityConstraints(t);for(i=0;i<t.velocityIterations;++i)for(e.SolveVelocityConstraints(),o=0;o<this.m_jointCount;++o)this.m_joints[o].SolveVelocityConstraints(t);for(i=0;i<this.m_bodyCount;++i){var n=this.m_bodies[i];if(n.GetType()!==eb.b2_staticBody){var a=t.dt*n.m_linearVelocity.x,r=t.dt*n.m_linearVelocity.y;a*a+r*r>ew&&(n.m_linearVelocity.Normalize(),n.m_linearVelocity.x*=Nf*t.inv_dt,n.m_linearVelocity.y*=Nf*t.inv_dt);var s=t.dt*n.m_angularVelocity;s*s>fw&&(n.m_angularVelocity<0?n.m_angularVelocity=-Of*t.inv_dt:n.m_angularVelocity=Of*t.inv_dt),n.m_sweep.c0.SetV(n.m_sweep.c),n.m_sweep.a0=n.m_sweep.a,n.m_sweep.c.x+=t.dt*n.m_linearVelocity.x,n.m_sweep.c.y+=t.dt*n.m_linearVelocity.y,n.m_sweep.a+=t.dt*n.m_angularVelocity,n.SynchronizeTransform()}}for(i=0;i<t.positionIterations;++i){var m=e.SolvePositionConstraints(.75),l=!0;for(o=0;o<this.m_jointCount;++o){var _=this.m_joints[o].SolvePositionConstraints(am);l=l&&_}if(m&&l)break}this.Report(e.m_constraints)}},{key:"Report",value:function(i){if(this.m_listener)for(var o=0;o<this.m_contactCount;++o)for(var e=i[o],n=0;n<e.pointCount;++n)t.s_impulse.normalImpulses[n]=e.points[n].normalImpulse,t.s_impulse.tangentImpulses[n]=e.points[n].tangentImpulse}},{key:"AddBody",value:function(t){t.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=t}},{key:"AddContact",value:function(t){this.m_contacts[this.m_contactCount++]=t}},{key:"AddJoint",value:function(t){this.m_joints[this.m_jointCount++]=t}}]),t}();tx.s_impulse=new uK;function vK(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ux(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function wK(e,t,n){return t&&ux(e.prototype,t),n&&ux(e,n),e}function xK(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var vx=function a(){xK(this,a)};var ob=function(){function e(t){vK(this,e),this.m_edgeA=new vx,this.m_edgeB=new vx,this.m_localCenterA=new ab,this.m_localCenterB=new ab,this.m_type=e.e_unknownJoint,this.m_collideConnected=!1,this.m_islandFlag=!1,wb(t.bodyA!==t.bodyB),this.m_type=t.type,this.m_prev=void 0,this.m_next=void 0,this.m_bodyA=t.bodyA,this.m_bodyB=t.bodyB,this.m_collideConnected=t.collideConnected,this.m_islandFlag=!1,this.m_userData=t.userData}return wK(e,[{key:"GetType",value:function(){return this.m_type}},{key:"GetAnchorA",value:function(){return new ab}},{key:"GetAnchorB",value:function(){return new ab}},{key:"GetReactionForce",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new ab}},{key:"GetReactionTorque",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0}},{key:"GetBodyA",value:function(){return this.m_bodyA}},{key:"GetBodyB",value:function(){return this.m_bodyB}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(e){this.m_userData=e}},{key:"IsActive",value:function(){return this.m_bodyA&&this.m_bodyA.IsActive()&&this.m_bodyB&&this.m_bodyB.IsActive()}},{key:"InitVelocityConstraints",value:function(e){}},{key:"SolveVelocityConstraints",value:function(e){}},{key:"FinalizeVelocityConstraints",value:function(){}},{key:"SolvePositionConstraints",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!1}}],[{key:"Destroy",value:function(e,t){}}]),e}();ob.e_unknownJoint=0,ob.e_revoluteJoint=1,ob.e_prismaticJoint=2,ob.e_distanceJoint=3,ob.e_pulleyJoint=4,ob.e_mouseJoint=5,ob.e_gearJoint=6,ob.e_lineJoint=7,ob.e_weldJoint=8,ob.e_frictionJoint=9,ob.e_inactiveLimit=0,ob.e_atLowerLimit=1,ob.e_atUpperLimit=2,ob.e_equalLimits=3;function yK(e,t){switch(e.type){case ob.e_distanceJoint:break;case ob.e_mouseJoint:return new HK(e);case ob.e_prismaticJoint:case ob.e_revoluteJoint:case ob.e_pulleyJoint:case ob.e_gearJoint:case ob.e_lineJoint:case ob.e_weldJoint:case ob.e_frictionJoint:}return new ob(e)}function zK(t){return(zK="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function AK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wx(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function BK(t,e,o){return e&&wx(t.prototype,e),o&&wx(t,o),t}function CK(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&DK(t,e)}function DK(t,e){return(DK=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function EK(t){var e=GK();return function(){var o,r=yx(t);if(e){var i=yx(this).constructor;o=Reflect.construct(r,arguments,i)}else o=r.apply(this,arguments);return xx(this,o)}}function xx(t,e){return!e||"object"!==zK(e)&&"function"!=typeof e?FK(t):e}function FK(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GK(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function yx(t){return(yx=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var HK=function(t){CK(o,ob);var e=EK(o);function o(t){var r;if(AK(this,o),(r=e.call(this,t)).K=new Id,r.K1=new Id,r.K2=new Id,r.m_localAnchor=new ab,r.m_target=new ab,r.m_impulse=new ab,r.m_mass=new Id,r.m_C=new ab,r.m_maxForce=1/0,r.m_frequencyHz=0,r.m_dampingRatio=0,r.m_beta=0,r.m_gamma=0,r.m_target.SetV(t.target),!r.m_bodyB)return xx(r);var i=r.m_target.x-r.m_bodyB.m_xf.position.x,n=r.m_target.y-r.m_bodyB.m_xf.position.y,a=r.m_bodyB.m_xf.R;return r.m_localAnchor.x=i*a.col1.x+n*a.col1.y,r.m_localAnchor.y=i*a.col2.x+n*a.col2.y,r.m_maxForce=t.maxForce,r.m_frequencyHz=t.frequencyHz,r.m_dampingRatio=t.dampingRatio,r}return BK(o,[{key:"GetAnchorA",value:function(){return this.m_target}},{key:"GetAnchorB",value:function(){return this.m_bodyB?this.m_bodyB.GetWorldPoint(this.m_localAnchor):new ab}},{key:"GetReactionForce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new ab(t*this.m_impulse.x,t*this.m_impulse.y)}},{key:"GetReactionTorque",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return 0}},{key:"GetTarget",value:function(){return this.m_target}},{key:"SetTarget",value:function(t){this.m_bodyB&&(!1===this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_target=t)}},{key:"GetMaxForce",value:function(){return this.m_maxForce}},{key:"SetMaxForce",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_maxForce=t}},{key:"GetFrequency",value:function(){return this.m_frequencyHz}},{key:"SetFrequency",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_frequencyHz=t}},{key:"GetDampingRatio",value:function(){return this.m_dampingRatio}},{key:"SetDampingRatio",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_dampingRatio=t}},{key:"InitVelocityConstraints",value:function(t){var e=this.m_bodyB,o=e.GetMass(),r=2*Math.PI*this.m_frequencyHz,i=2*o*this.m_dampingRatio*r,n=o*r*r;this.m_gamma=t.dt*(i+t.dt*n),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_beta=t.dt*n*this.m_gamma;var a=e.m_xf.R,m=this.m_localAnchor.x-e.m_sweep.localCenter.x,s=this.m_localAnchor.y-e.m_sweep.localCenter.y,c=a.col1.x*m+a.col2.x*s;s=a.col1.y*m+a.col2.y*s,m=c;var l=e.m_invMass,u=e.m_invI;this.K1.col1.x=l,this.K1.col2.x=0,this.K1.col1.y=0,this.K1.col2.y=l,this.K2.col1.x=u*s*s,this.K2.col2.x=-u*m*s,this.K2.col1.y=-u*m*s,this.K2.col2.y=u*m*m,this.K.SetM(this.K1),this.K.AddM(this.K2),this.K.col1.x+=this.m_gamma,this.K.col2.y+=this.m_gamma,this.K.GetInverse(this.m_mass),this.m_C.x=e.m_sweep.c.x+m-this.m_target.x,this.m_C.y=e.m_sweep.c.y+s-this.m_target.y,e.m_angularVelocity*=.98,this.m_impulse.x*=t.dtRatio,this.m_impulse.y*=t.dtRatio,e.m_linearVelocity.x+=l*this.m_impulse.x,e.m_linearVelocity.y+=l*this.m_impulse.y,e.m_angularVelocity+=u*(m*this.m_impulse.y-s*this.m_impulse.x)}},{key:"SolveVelocityConstraints",value:function(t){var e,o=this.m_bodyB,r=0,i=o.m_xf.R,n=this.m_localAnchor.x-o.m_sweep.localCenter.x,a=this.m_localAnchor.y-o.m_sweep.localCenter.y;r=i.col1.x*n+i.col2.x*a,a=i.col1.y*n+i.col2.y*a,n=r;var m=o.m_linearVelocity.x+-o.m_angularVelocity*a,s=o.m_linearVelocity.y+o.m_angularVelocity*n;i=this.m_mass,r=m+this.m_beta*this.m_C.x+this.m_gamma*this.m_impulse.x,e=s+this.m_beta*this.m_C.y+this.m_gamma*this.m_impulse.y;var c=-(i.col1.x*r+i.col2.x*e),l=-(i.col1.y*r+i.col2.y*e),u=this.m_impulse.x,_=this.m_impulse.y;this.m_impulse.x+=c,this.m_impulse.y+=l;var $=t.dt*this.m_maxForce;this.m_impulse.LengthSquared()>$*$&&this.m_impulse.Multiply($/this.m_impulse.Length()),c=this.m_impulse.x-u,l=this.m_impulse.y-_,o.m_linearVelocity.x+=o.m_invMass*c,o.m_linearVelocity.y+=o.m_invMass*l,o.m_angularVelocity+=o.m_invI*(n*l-a*c)}},{key:"SolvePositionConstraints",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!0}}]),o}();function IK(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var JK=function a(){IK(this,a),this.normal=new ab,this.fraction=0};var Sb=function(){function t(e,r){VG(this,t),this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_controllerCount=0,this.m_allowSleep=!0,this.m_gravity=new ab,this.m_inv_dt0=0,this.m_flags=0,this.m_contactManager=new ox,this.m_contactSolver=new uj,this.m_island=new tx,this.m_groundBody=this.CreateBody(new nm),this.s_stack=[],this.m_gravity=e,this.m_allowSleep=r,this.m_contactManager.m_world=this}return WG(t,[{key:"SetDestructionListener",value:function(t){this.m_destructionListener=t}},{key:"SetContactFilter",value:function(t){this.m_contactManager.m_contactFilter=t}},{key:"SetContactListener",value:function(t){this.m_contactManager.m_contactListener=t}},{key:"SetDebugDraw",value:function(t){this.m_debugDraw=t}},{key:"SetBroadPhase",value:function(t){var e=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=t;for(var r=this.m_bodyList;r;r=r.m_next)for(var o=r.m_fixtureList;o;o=o.m_next)o.m_proxy=t.CreateProxy(e.GetFatAABB(o.m_proxy),o)}},{key:"Validate",value:function(){this.m_contactManager.m_broadPhase.Validate()}},{key:"GetProxyCount",value:function(){return this.m_contactManager.m_broadPhase.GetProxyCount()}},{key:"CreateBody",value:function(t){if(this.IsLocked())throw new Error("Cannot create bodies on a locked world.");var e=new eb(t,this);return e.m_prev=null,e.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=e),this.m_bodyList=e,++this.m_bodyCount,e}},{key:"DestroyBody",value:function(t){if(!this.IsLocked()){for(var e=t.m_jointList;e;){var r=e;e=e.next,this.m_destructionListener&&(this.m_destructionListener.SayGoodbyeJoint(r.joint),this.DestroyJoint(r.joint))}for(var o=t.m_controllerList;o;){var i=o;o=o.nextController,i.controller.RemoveBody(t)}for(var n=t.m_contactList;n;){var a=n;n=n.next,this.m_contactManager.Destroy(a.contact)}t.m_contactList=null;for(var s=t.m_fixtureList;s;){var m=s;s=s.m_next,this.m_destructionListener&&(this.m_destructionListener.SayGoodbyeFixture(m),m.DestroyProxy(this.m_contactManager.m_broadPhase),m.Destroy())}t.m_fixtureList=null,t.m_fixtureCount=0,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_bodyList&&(this.m_bodyList=t.m_next),--this.m_bodyCount}}},{key:"CreateJoint",value:function(t){if(t.bodyA&&t.bodyB){var e=yK(t,null);if(e.m_bodyA&&e.m_bodyB){e.m_prev=void 0,e.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=e),this.m_jointList=e,++this.m_jointCount,e.m_edgeA.joint=e,e.m_edgeA.other=e.m_bodyB,e.m_edgeA.prev=void 0,e.m_edgeA.next=e.m_bodyA.m_jointList,e.m_bodyA.m_jointList&&(e.m_bodyA.m_jointList.prev=e.m_edgeA),e.m_bodyA.m_jointList=e.m_edgeA,e.m_edgeB.joint=e,e.m_edgeB.other=e.m_bodyA,e.m_edgeB.prev=void 0,e.m_edgeB.next=e.m_bodyB.m_jointList,e.m_bodyB.m_jointList&&(e.m_bodyB.m_jointList.prev=e.m_edgeB),e.m_bodyB.m_jointList=e.m_edgeB;var r=t.bodyA,o=t.bodyB;if(!1===t.collideConnected)for(var i=o.GetContactList();i;)i.other===r&&i.contact.FlagForFiltering(),i=i.next;return e}}}},{key:"DestroyJoint",value:function(t){var e=t.m_collideConnected;t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t===this.m_jointList&&(this.m_jointList=t.m_next);var r=t.m_bodyA,o=t.m_bodyB;if(r&&o&&(r.SetAwake(!0),o.SetAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA===r.m_jointList&&(r.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=void 0,t.m_edgeA.next=void 0,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB===o.m_jointList&&(o.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=void 0,t.m_edgeB.next=void 0,ob.Destroy(t,null),--this.m_jointCount,!1===e))for(var i=o.GetContactList();i;)i.other===r&&i.contact.FlagForFiltering(),i=i.next}},{key:"AddController",value:function(t){return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList=t,t.m_world=this,this.m_controllerCount++,t}},{key:"RemoveController",value:function(t){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),this.m_controllerList===t&&(this.m_controllerList=t.m_next),this.m_controllerCount--}},{key:"CreateController",value:function(t){if(t.m_world!==this)throw new Error("Controller can only be a member of one world");return t.m_next=this.m_controllerList,t.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=t),this.m_controllerList=t,++this.m_controllerCount,t.m_world=this,t}},{key:"DestroyController",value:function(t){t.Clear(),t.m_next&&(t.m_next.m_prev=t.m_prev),t.m_prev&&(t.m_prev.m_next=t.m_next),t===this.m_controllerList&&(this.m_controllerList=t.m_next),--this.m_controllerCount}},{key:"SetWarmStarting",value:function(e){t.m_warmStarting=e}},{key:"SetContinuousPhysics",value:function(e){t.m_continuousPhysics=e}},{key:"GetBodyCount",value:function(){return this.m_bodyCount}},{key:"GetJointCount",value:function(){return this.m_jointCount}},{key:"GetContactCount",value:function(){return this.m_contactCount}},{key:"SetGravity",value:function(t){this.m_gravity=t}},{key:"GetGravity",value:function(){return this.m_gravity}},{key:"GetGroundBody",value:function(){return this.m_groundBody}},{key:"Step",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.m_flags&t.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~t.e_newFixture),this.m_flags|=t.e_locked;var i=t.s_timestep2;i.dt=e,i.velocityIterations=r,i.positionIterations=o,i.inv_dt=e>0?1/e:0,i.dtRatio=this.m_inv_dt0*e,i.warmStarting=t.m_warmStarting,this.m_contactManager.Collide(),i.dt>0&&this.Solve(i),t.m_continuousPhysics&&i.dt>0&&this.SolveTOI(i),i.dt>0&&(this.m_inv_dt0=i.inv_dt),this.m_flags&=~t.e_locked}},{key:"ClearForces",value:function(){for(var t=this.m_bodyList;t;t=t.m_next)t.m_force.SetZero(),t.m_torque=0}},{key:"DrawDebugData",value:function(){if(this.m_debugDraw){this.m_debugDraw.m_sprite.graphics.clear();var e,r,o,i,n,a,s=this.m_debugDraw.GetFlags(),m=[new ab,new ab,new ab,new ab],_=new mw(0,0,0);if(s&Mb.e_shapeBit)for(e=this.m_bodyList;e;e=e.m_next)for(a=e.m_xf,r=e.GetFixtureList();r;r=r.m_next)o=r.GetShape(),!1===e.IsActive()?(_.Set(.5,.5,.3),this.DrawShape(o,a,_)):e.GetType()===eb.b2_staticBody?(_.Set(.5,.9,.5),this.DrawShape(o,a,_)):e.GetType()===eb.b2_kinematicBody?(_.Set(.5,.5,.9),this.DrawShape(o,a,_)):!1===e.IsAwake()?(_.Set(.6,.6,.6),this.DrawShape(o,a,_)):(_.Set(.9,.7,.7),this.DrawShape(o,a,_));if(s&Mb.e_jointBit)for(i=this.m_jointList;i;i=i.m_next)this.DrawJoint(i);if(s&Mb.e_controllerBit)for(var $=this.m_controllerList;$;$=$.m_next)$.Draw(this.m_debugDraw);if(s&Mb.e_pairBit){_.Set(.3,.9,.9);for(var c=this.m_contactManager.m_contactList;c;c=c.GetNext()){var l=c.GetFixtureA(),d=c.GetFixtureB();if(l&&d){var u=l.GetAABB().GetCenter(),p=d.GetAABB().GetCenter();this.m_debugDraw.DrawSegment(u,p,_)}}}if(s&Mb.e_aabbBit)for(n=this.m_contactManager.m_broadPhase,m=[new ab,new ab,new ab,new ab],e=this.m_bodyList;e;e=e.GetNext())if(e.IsActive())for(r=e.GetFixtureList();r;r=r.GetNext()){var x=n.GetFatAABB(r.m_proxy);m[0].Set(x.lowerBound.x,x.lowerBound.y),m[1].Set(x.upperBound.x,x.lowerBound.y),m[2].Set(x.upperBound.x,x.upperBound.y),m[3].Set(x.lowerBound.x,x.upperBound.y),this.m_debugDraw.DrawPolygon(m,4,_)}if(s&Mb.e_centerOfMassBit)for(e=this.m_bodyList;e;e=e.m_next)(a=t.s_xf).R=e.m_xf.R,a.position=e.GetWorldCenter(),this.m_debugDraw.DrawTransform(a)}}},{key:"QueryAABB",value:function(t,e){var r=this.m_contactManager.m_broadPhase;r.Query(function(e){return t(r.GetUserData(e))},e)}},{key:"QueryShape",value:function(t,e,r){r||(r=new vd).SetIdentity();var o=this.m_contactManager.m_broadPhase,i=new Jd;e.ComputeAABB(i,r),o.Query(function(i){var n=o.GetUserData(i)instanceof wg?o.GetUserData(i):null;return!mb.TestOverlap(e,r,n.GetShape(),n.GetBody().GetTransform())||t(n)},i)}},{key:"QueryPoint",value:function(t,e){var r=this.m_contactManager.m_broadPhase,o=new Jd;o.lowerBound.Set(e.x-ud,e.y-ud),o.upperBound.Set(e.x+ud,e.y+ud),r.Query(function(o){var i=r.GetUserData(o)instanceof wg?r.GetUserData(o):null;return!i.TestPoint(e)||t(i)},o)}},{key:"RayCast",value:function(t,e,r){var o=this.m_contactManager.m_broadPhase,i=new JK,n=new Jw(e,r);o.RayCast(function(n,a){var s=o.GetUserData(a);if(!(s instanceof wg))return n.maxFraction;if(s.RayCast(i,n)){var m=i.fraction,_=new ab((1-m)*e.x+m*r.x,(1-m)*e.y+m*r.y);return t(s,_,i.normal,m)}},n)}},{key:"RayCastOne",value:function(t,e){var r;return this.RayCast(function(t,e,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return r=t,i},t,e),r}},{key:"RayCastAll",value:function(t,e){var r=new Array;return this.RayCast(function(t,e,o){arguments.length>3&&void 0!==arguments[3]&&arguments[3];return r[r.length]=t,1},t,e),r}},{key:"GetBodyList",value:function(){return this.m_bodyList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetContactList",value:function(){return this.m_contactList}},{key:"IsLocked",value:function(){return(this.m_flags&t.e_locked)>0}},{key:"Solve",value:function(t){for(var e,r=this.m_controllerList;r;r=r.m_next)r.Step(t);var o=this.m_island;for(o.Initialize(this.m_bodyCount,this.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener,this.m_contactSolver),e=this.m_bodyList;e;e=e.m_next)e.m_flags&=~eb.e_islandFlag;for(var i=this.m_contactList;i;i=i.m_next)i.m_flags&=~sb.e_islandFlag;for(var n=this.m_jointList;n;n=n.m_next)n.m_islandFlag=!1;for(var a=this.s_stack,s=this.m_bodyList;s;s=s.m_next)if(!(s.m_flags&eb.e_islandFlag)&&!1!==s.IsAwake()&&!1!==s.IsActive()&&s.GetType()!==eb.b2_staticBody){o.Clear();var m=0;for(a[m++]=s,s.m_flags|=eb.e_islandFlag;m>0;)if(e=a[--m],o.AddBody(e),!1===e.IsAwake()&&e.SetAwake(!0),e.GetType()!==eb.b2_staticBody){for(var _=void 0,$=e.m_contactList;$;$=$.next)$.contact.m_flags&sb.e_islandFlag||!0!==$.contact.IsSensor()&&!1!==$.contact.IsEnabled()&&!1!==$.contact.IsTouching()&&(o.AddContact($.contact),$.contact.m_flags|=sb.e_islandFlag,(_=$.other).m_flags&eb.e_islandFlag||(a[m++]=_,_.m_flags|=eb.e_islandFlag));for(var c=e.m_jointList;c;c=c.next)!0!==c.joint.m_islandFlag&&!1!==(_=c.other).IsActive()&&(o.AddJoint(c.joint),c.joint.m_islandFlag=!0,_.m_flags&eb.e_islandFlag||(a[m++]=_,_.m_flags|=eb.e_islandFlag))}o.Solve(t,this.m_gravity,this.m_allowSleep);for(var l=0;l<o.m_bodyCount;++l)(e=o.m_bodies[l]).GetType()===eb.b2_staticBody&&(e.m_flags&=~eb.e_islandFlag)}for(var d=0;d<a.length&&a[d];++d)a[d]=null;for(e=this.m_bodyList;e;e=e.m_next)!1!==e.IsAwake()&&!1!==e.IsActive()&&e.GetType()!==eb.b2_staticBody&&e.SynchronizeFixtures();this.m_contactManager.FindNewContacts()}},{key:"SolveTOI",value:function(e){var r,o,i,n,a,s,m,_=this.m_island;_.Initialize(this.m_bodyCount,KG,LG,null,this.m_contactManager.m_contactListener,this.m_contactSolver);var $,c=t.s_queue;for(r=this.m_bodyList;r;r=r.m_next)r.m_flags&=~eb.e_islandFlag,r.m_sweep.t0=0;for($=this.m_contactList;$;$=$.m_next)$.m_flags&=~(sb.e_toiFlag|sb.e_islandFlag);for(m=this.m_jointList;m;m=m.m_next)m.m_islandFlag=!1;for(;;){var l=null,d=1;for($=this.m_contactList;$;$=$.m_next)if(!0!==$.IsSensor()&&!1!==$.IsEnabled()&&!1!==$.IsContinuous()){var u=1;if($.m_flags&sb.e_toiFlag)u=$.m_toi;else{if(o=$.m_fixtureA,i=$.m_fixtureB,n=o.m_body,a=i.m_body,!(n.GetType()===eb.b2_dynamicBody&&!1!==n.IsAwake()||a.GetType()===eb.b2_dynamicBody&&!1!==a.IsAwake()))continue;var p=n.m_sweep.t0;n.m_sweep.t0<a.m_sweep.t0?(p=a.m_sweep.t0,n.m_sweep.Advance(p)):a.m_sweep.t0<n.m_sweep.t0&&(p=n.m_sweep.t0,a.m_sweep.Advance(p)),u=$.ComputeTOI(n.m_sweep,a.m_sweep),wb(0<=u&&u<=1),u>0&&u<1&&(u=(1-u)*p+u)>1&&(u=1),$.m_toi=u,$.m_flags|=sb.e_toiFlag}Number.MIN_VALUE<u&&u<d&&(l=$,d=u)}if(null===l||1-100*Number.MIN_VALUE<d)break;if(o=l.m_fixtureA,i=l.m_fixtureB,n=o.m_body,a=i.m_body,t.s_backupA.Set(n.m_sweep),t.s_backupB.Set(a.m_sweep),n.Advance(d),a.Advance(d),l.Update(this.m_contactManager.m_contactListener),l.m_flags&=~sb.e_toiFlag,!0!==l.IsSensor()&&!1!==l.IsEnabled()){if(!1!==l.IsTouching()){var x=n;x.GetType()!==eb.b2_dynamicBody&&(x=a),_.Clear();var y=0,h=0;for(c[y+h++]=x,x.m_flags|=eb.e_islandFlag;h>0;)if(r=c[y++],--h,_.AddBody(r),!1===r.IsAwake()&&r.SetAwake(!0),r.GetType()===eb.b2_dynamicBody){for(s=r.m_contactList;s&&_.m_contactCount!==_.m_contactCapacity;s=s.next)if(!(s.contact.m_flags&sb.e_islandFlag)&&!0!==s.contact.IsSensor()&&!1!==s.contact.IsEnabled()&&!1!==s.contact.IsTouching()){_.AddContact(s.contact),s.contact.m_flags|=sb.e_islandFlag;var f=s.other;f.m_flags&eb.e_islandFlag||(f.GetType()!==eb.b2_staticBody&&(f.Advance(d),f.SetAwake(!0)),c[y+h]=f,++h,f.m_flags|=eb.e_islandFlag)}for(var v=r.m_jointList;v;v=v.next)if(_.m_jointCount!==_.m_jointCapacity&&!0!==v.joint.m_islandFlag){var g=v.other;!1!==g.IsActive()&&(_.AddJoint(v.joint),v.joint.m_islandFlag=!0,g.m_flags&eb.e_islandFlag||(g.GetType()!==eb.b2_staticBody&&(g.Advance(d),g.SetAwake(!0)),c[y+h]=g,++h,g.m_flags|=eb.e_islandFlag))}}var z=t.s_timestep;z.warmStarting=!1,z.dt=(1-d)*e.dt,z.inv_dt=1/z.dt,z.dtRatio=0,z.velocityIterations=e.velocityIterations,z.positionIterations=e.positionIterations,_.SolveTOI(z);for(var Y=0;Y<_.m_bodyCount;++Y)if((r=_.m_bodies[Y]).m_flags&=~eb.e_islandFlag,!1!==r.IsAwake()&&r.GetType()===eb.b2_dynamicBody)for(r.SynchronizeFixtures(),s=r.m_contactList;s;s=s.next)s.contact.m_flags&=~sb.e_toiFlag;for(var w=0;w<_.m_contactCount;++w)($=_.m_contacts[w]).m_flags&=~(sb.e_toiFlag|sb.e_islandFlag);for(var b=0;b<_.m_jointCount;++b)(m=_.m_joints[b]).m_islandFlag=!1;this.m_contactManager.FindNewContacts()}}else n.m_sweep.Set(t.s_backupA),a.m_sweep.Set(t.s_backupB),n.SynchronizeTransform(),a.SynchronizeTransform()}}},{key:"DrawJoint",value:function(e){if(this.m_debugDraw){var r=e.GetBodyA(),o=e.GetBodyB();if(r&&o){var i=r.m_xf,n=o.m_xf,a=i.position,s=n.position,m=e.GetAnchorA(),_=e.GetAnchorB();if(m&&_){var $=t.s_jointColor;switch(e.m_type){case ob.e_distanceJoint:this.m_debugDraw.DrawSegment(m,_,$);break;case ob.e_pulleyJoint:break;case ob.e_mouseJoint:this.m_debugDraw.DrawSegment(m,_,$);break;default:r!==this.m_groundBody&&this.m_debugDraw.DrawSegment(a,m,$),this.m_debugDraw.DrawSegment(m,_,$),o!==this.m_groundBody&&this.m_debugDraw.DrawSegment(s,_,$);}}}}}},{key:"DrawShape",value:function(t,e,r){if(this.m_debugDraw)switch(t.m_type){case mb.e_circleShape:if(!(t instanceof Rf))return;var o=t,i=vb(e,o.m_p),n=o.m_radius,a=e.R.col1;this.m_debugDraw.DrawSolidCircle(i,n,a,r);break;case mb.e_polygonShape:if(!(t instanceof ff))return;for(var s=t,m=parseInt("".concat(s.GetVertexCount()),10),_=s.GetVertices(),$=new Array(m),c=0;c<m;++c)$[c]=vb(e,_[c]);this.m_debugDraw.DrawSolidPolygon($,m,r);break;case mb.e_edgeShape:if(!(t instanceof lm))return;var l=t;this.m_debugDraw.DrawSegment(vb(e,l.GetVertex1()),vb(e,l.GetVertex2()),r);}}}]),t}();Sb.s_timestep2=new bm,Sb.s_xf=new vd,Sb.s_backupA=new ef,Sb.s_backupB=new ef,Sb.s_timestep=new bm,Sb.s_queue=new Array,Sb.s_jointColor=new mw(.5,.8,.8),Sb.e_newFixture=1,Sb.e_locked=2,Sb.m_warmStarting=!0,Sb.m_continuousPhysics=!0;function KK(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var zx=function t(){KK(this,t),this.filter=new tw,this.shape=void 0,this.userData=void 0,this.friction=.2,this.restitution=0,this.density=0,this.isSensor=!1,this.filter.categoryBits=1,this.filter.maskBits=65535,this.filter.groupIndex=0};var eb=function(){function t(e,i){IG(this,t),this.m_world=i,this.m_xf=new vd,this.m_sweep=new ef,this.m_linearVelocity=new ab,this.m_angularVelocity=0,this.m_linearDamping=0,this.m_angularDamping=0,this.m_force=new ab,this.m_torque=0,this.m_flags=0,this.m_islandIndex=0,this.m_flags=0,e.bullet&&(this.m_flags|=t.e_bulletFlag),e.fixedRotation&&(this.m_flags|=t.e_fixedRotationFlag),e.allowSleep&&(this.m_flags|=t.e_allowSleepFlag),e.awake&&(this.m_flags|=t.e_awakeFlag),e.active&&(this.m_flags|=t.e_activeFlag),this.m_xf.position.SetV(e.position),this.m_xf.R.Set(e.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.t0=1,this.m_sweep.a0=this.m_sweep.a=e.angle;var s=this.m_xf.R,a=this.m_sweep.localCenter;this.m_sweep.c.x=s.col1.x*a.x+s.col2.x*a.y,this.m_sweep.c.y=s.col1.y*a.x+s.col2.y*a.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_jointList=null,this.m_controllerList=null,this.m_contactList=null,this.m_controllerCount=0,this.m_prev=null,this.m_next=null,this.m_linearVelocity.SetV(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_force.Set(0,0),this.m_torque=0,this.m_sleepTime=0,this.m_type=e.type,this.m_type===t.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_inertiaScale=e.inertiaScale,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0}return JG(t,[{key:"connectEdges",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=Math.atan2(e.GetDirectionVector().y,e.GetDirectionVector().x),a=Math.tan(.5*(s-i)),n=aw(a,e.GetDirectionVector());n=rb(n,e.GetNormalVector()),n=aw(vg,n),n=nj(n,e.GetVertex1());var o=nj(t.GetDirectionVector(),e.GetDirectionVector());o.Normalize();var r=Ib(t.GetDirectionVector(),e.GetNormalVector())>0;return t.SetNextEdge(e,n,o,r),e.SetPrevEdge(t,n,o,r),s}},{key:"CreateFixture",value:function(e){if(this.m_world&&!this.m_world.IsLocked()){var i=new wg;if(i.Create(this,this.m_xf,e),this.m_flags&t.e_activeFlag){var s=this.m_world.m_contactManager.m_broadPhase;i.CreateProxy(s,this.m_xf)}return i.m_next=this.m_fixtureList,this.m_fixtureList=i,++this.m_fixtureCount,i.m_body=this,i.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=Sb.e_newFixture,i}}},{key:"CreateFixture2",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=new zx;return i.shape=t,i.density=e,this.CreateFixture(i)}},{key:"DestroyFixture",value:function(e){if(this.m_world&&!this.m_world.IsLocked()){for(var i=this.m_fixtureList,s=null;null!==i;){if(i===e){s?s.m_next=e.m_next:this.m_fixtureList=e.m_next;break}s=i,i=i.m_next}for(var a=this.m_contactList;a;){var n=a.contact;a=a.next;var o=n.GetFixtureA(),r=n.GetFixtureB();e!==o&&e!==r||this.m_world.m_contactManager.Destroy(n)}if(this.m_flags&t.e_activeFlag){var l=this.m_world.m_contactManager.m_broadPhase;e.DestroyProxy(l)}e.Destroy(),e.m_body=void 0,e.m_next=void 0,--this.m_fixtureCount,this.ResetMassData()}}},{key:"SetPositionAndAngle",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.m_world&&!this.m_world.IsLocked()){this.m_xf.R.Set(e),this.m_xf.position.SetV(t);var i=this.m_xf.R,s=this.m_sweep.localCenter;this.m_sweep.c.x=i.col1.x*s.x+i.col2.x*s.y,this.m_sweep.c.y=i.col1.y*s.x+i.col2.y*s.y,this.m_sweep.c.x+=this.m_xf.position.x,this.m_sweep.c.y+=this.m_xf.position.y,this.m_sweep.c0.SetV(this.m_sweep.c),this.m_sweep.a0=this.m_sweep.a=e;for(var a=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(a,this.m_xf,this.m_xf);this.m_world.m_contactManager.FindNewContacts()}}},{key:"SetTransform",value:function(t){this.SetPositionAndAngle(t.position,t.GetAngle())}},{key:"GetTransform",value:function(){return this.m_xf}},{key:"GetPosition",value:function(){return this.m_xf.position}},{key:"SetPosition",value:function(t){this.SetPositionAndAngle(t,this.GetAngle())}},{key:"GetAngle",value:function(){return this.m_sweep.a}},{key:"SetAngle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.SetPositionAndAngle(this.GetPosition(),t)}},{key:"GetWorldCenter",value:function(){return this.m_sweep.c}},{key:"GetLocalCenter",value:function(){return this.m_sweep.localCenter}},{key:"SetLinearVelocity",value:function(e){this.m_type!==t.b2_staticBody&&this.m_linearVelocity.SetV(e)}},{key:"GetLinearVelocity",value:function(){return this.m_linearVelocity}},{key:"SetAngularVelocity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_type!==t.b2_staticBody&&(this.m_angularVelocity=e)}},{key:"GetAngularVelocity",value:function(){return this.m_angularVelocity}},{key:"GetDefinition",value:function(){var e=new nm;return e.type=this.GetType(),e.allowSleep=(this.m_flags&t.e_allowSleepFlag)===t.e_allowSleepFlag,e.angle=this.GetAngle(),e.angularDamping=this.m_angularDamping,e.angularVelocity=this.m_angularVelocity,e.fixedRotation=(this.m_flags&t.e_fixedRotationFlag)===t.e_fixedRotationFlag,e.bullet=(this.m_flags&t.e_bulletFlag)===t.e_bulletFlag,e.awake=(this.m_flags&t.e_awakeFlag)===t.e_awakeFlag,e.linearDamping=this.m_linearDamping,e.linearVelocity.SetV(this.GetLinearVelocity()),e.position=this.GetPosition(),e.userData=this.GetUserData(),e}},{key:"ApplyForce",value:function(e,i){this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_force.x+=e.x,this.m_force.y+=e.y,this.m_torque+=(i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x)}},{key:"ApplyTorque",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_torque+=e)}},{key:"ApplyImpulse",value:function(e,i){this.m_type===t.b2_dynamicBody&&(!1===this.IsAwake()&&this.SetAwake(!0),this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y,this.m_angularVelocity+=this.m_invI*((i.x-this.m_sweep.c.x)*e.y-(i.y-this.m_sweep.c.y)*e.x))}},{key:"Split",value:function(t){if(this.m_world&&!this.m_world.IsLocked()){var e=this.GetLinearVelocity().Copy(),i=this.GetAngularVelocity(),s=this.GetWorldCenter(),a=this.m_world.CreateBody(this.GetDefinition());if(a){for(var n,o=this.m_fixtureList;o;)if(t(o)){var r=o.m_next;n?n.m_next=r:this.m_fixtureList=r,this.m_fixtureCount--,o.m_next=a.m_fixtureList,a.m_fixtureList=o,a.m_fixtureCount++,o.m_body=a,o=r}else n=o,o=o.m_next;this.ResetMassData(),a.ResetMassData();var l=this.GetWorldCenter(),m=a.GetWorldCenter(),_=nj(e,mj(i,rb(l,s))),h=nj(e,mj(i,rb(m,s)));return this.SetLinearVelocity(_),a.SetLinearVelocity(h),this.SetAngularVelocity(i),a.SetAngularVelocity(i),this.SynchronizeFixtures(),a.SynchronizeFixtures(),a}}}},{key:"Merge",value:function(t){for(var e=t,i=t.m_fixtureList;i;){var s=i.m_next;t.m_fixtureCount--,i.m_next=this.m_fixtureList,this.m_fixtureList=i,this.m_fixtureCount++,i.m_body=e,i=s}this.m_fixtureCount=0,this.ResetMassData(),this.SynchronizeFixtures()}},{key:"GetMass",value:function(){return this.m_mass}},{key:"GetInertia",value:function(){return this.m_I}},{key:"GetMassData",value:function(t){t.mass=this.m_mass,t.I=this.m_I,t.center.SetV(this.m_sweep.localCenter)}},{key:"SetMassData",value:function(e){if(this.m_world&&!this.m_world.IsLocked()&&(wb(!1===this.m_world.IsLocked()),this.m_type===t.b2_dynamicBody)){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&t.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*(e.center.x*e.center.x+e.center.y*e.center.y),this.m_invI=1/this.m_I);var i=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e.center),this.m_sweep.c0.SetV(vb(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-i.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-i.x)}}},{key:"ResetMassData",value:function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type!==t.b2_staticBody&&this.m_type!==t.b2_kinematicBody){for(var e=ab.Make(0,0),i=this.m_fixtureList;i;i=i.m_next)if(0!==i.m_density){var s=i.GetMassData();this.m_mass+=s.mass,e.x+=s.center.x*s.mass,e.y+=s.center.y*s.mass,this.m_I+=s.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&t.e_fixedRotationFlag)?(this.m_I-=this.m_mass*(e.x*e.x+e.y*e.y),this.m_I*=this.m_inertiaScale,wb(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var a=this.m_sweep.c.Copy();this.m_sweep.localCenter.SetV(e),this.m_sweep.c0.SetV(vb(this.m_xf,this.m_sweep.localCenter)),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_linearVelocity.x+=this.m_angularVelocity*-(this.m_sweep.c.y-a.y),this.m_linearVelocity.y+=this.m_angularVelocity*+(this.m_sweep.c.x-a.x)}}},{key:"GetWorldPoint",value:function(t){var e=this.m_xf.R,i=new ab(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,i}},{key:"GetWorldVector",value:function(t){return df(this.m_xf.R,t)}},{key:"GetLocalPoint",value:function(t){return CG(this.m_xf,t)}},{key:"GetLocalVector",value:function(t){return Hd(this.m_xf.R,t)}},{key:"GetLinearVelocityFromWorldPoint",value:function(t){return new ab(this.m_linearVelocity.x-this.m_angularVelocity*(t.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(t.x-this.m_sweep.c.x))}},{key:"GetLinearVelocityFromLocalPoint",value:function(t){var e=this.m_xf.R,i=new ab(e.col1.x*t.x+e.col2.x*t.y,e.col1.y*t.x+e.col2.y*t.y);return i.x+=this.m_xf.position.x,i.y+=this.m_xf.position.y,new ab(this.m_linearVelocity.x-this.m_angularVelocity*(i.y-this.m_sweep.c.y),this.m_linearVelocity.y+this.m_angularVelocity*(i.x-this.m_sweep.c.x))}},{key:"GetLinearDamping",value:function(){return this.m_linearDamping}},{key:"SetLinearDamping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_linearDamping=t}},{key:"GetAngularDamping",value:function(){return this.m_angularDamping}},{key:"SetAngularDamping",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_angularDamping=t}},{key:"SetType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.m_type!==e){this.m_type=e,this.ResetMassData(),this.m_type===t.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var i=this.m_contactList;i;i=i.next)i.contact.FlagForFiltering()}}},{key:"GetType",value:function(){return this.m_type}},{key:"SetBullet",value:function(e){e?this.m_flags|=t.e_bulletFlag:this.m_flags&=~t.e_bulletFlag}},{key:"IsBullet",value:function(){return(this.m_flags&t.e_bulletFlag)===t.e_bulletFlag}},{key:"SetSleepingAllowed",value:function(e){e?this.m_flags|=t.e_allowSleepFlag:(this.m_flags&=~t.e_allowSleepFlag,this.SetAwake(!0))}},{key:"SetAwake",value:function(e){e?(this.m_flags|=t.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~t.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)}},{key:"IsAwake",value:function(){return(this.m_flags&t.e_awakeFlag)===t.e_awakeFlag}},{key:"SetFixedRotation",value:function(e){e?this.m_flags|=t.e_fixedRotationFlag:this.m_flags&=~t.e_fixedRotationFlag,this.ResetMassData()}},{key:"IsFixedRotation",value:function(){return(this.m_flags&t.e_fixedRotationFlag)===t.e_fixedRotationFlag}},{key:"SetActive",value:function(e){if(e!==this.IsActive()&&this.m_world&&!this.m_world.IsLocked()){var i=this.m_world.m_contactManager.m_broadPhase;if(e){this.m_flags|=t.e_activeFlag;for(var s=this.m_fixtureList;s;s=s.m_next)s.CreateProxy(i,this.m_xf)}else{this.m_flags&=~t.e_activeFlag;for(var a=this.m_fixtureList;a;a=a.m_next)a.DestroyProxy(i);for(var n=this.m_contactList;n;){var o=n;n=n.next,this.m_world.m_contactManager.Destroy(o.contact)}this.m_contactList=null}}}},{key:"IsActive",value:function(){return(this.m_flags&t.e_activeFlag)===t.e_activeFlag}},{key:"IsSleepingAllowed",value:function(){return(this.m_flags&t.e_allowSleepFlag)===t.e_allowSleepFlag}},{key:"GetFixtureList",value:function(){return this.m_fixtureList}},{key:"GetJointList",value:function(){return this.m_jointList}},{key:"GetControllerList",value:function(){return this.m_controllerList}},{key:"GetContactList",value:function(){return this.m_contactList}},{key:"GetNext",value:function(){return this.m_next}},{key:"GetUserData",value:function(){return this.m_userData}},{key:"SetUserData",value:function(t){this.m_userData=t}},{key:"GetWorld",value:function(){return this.m_world}},{key:"SynchronizeFixtures",value:function(){if(this.m_world&&!this.m_world.IsLocked()){var e=t.s_xf1;e.R.Set(this.m_sweep.a0);var i=e.R,s=this.m_sweep.localCenter;e.position.x=this.m_sweep.c0.x-(i.col1.x*s.x+i.col2.x*s.y),e.position.y=this.m_sweep.c0.y-(i.col1.y*s.x+i.col2.y*s.y);for(var a=this.m_world.m_contactManager.m_broadPhase,n=this.m_fixtureList;n;n=n.m_next)n.Synchronize(a,e,this.m_xf)}}},{key:"SynchronizeTransform",value:function(){this.m_xf.R.Set(this.m_sweep.a);var t=this.m_xf.R,e=this.m_sweep.localCenter;this.m_xf.position.x=this.m_sweep.c.x-(t.col1.x*e.x+t.col2.x*e.y),this.m_xf.position.y=this.m_sweep.c.y-(t.col1.y*e.x+t.col2.y*e.y)}},{key:"ShouldCollide",value:function(e){if(this.m_type!==t.b2_dynamicBody&&e.m_type!==t.b2_dynamicBody)return!1;for(var i=this.m_jointList;i;i=i.next)if(i.other===e&&!1===i.joint.m_collideConnected)return!1;return!0}},{key:"Advance",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.m_sweep.Advance(t),this.m_sweep.c.SetV(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.SynchronizeTransform()}}]),t}();eb.s_xf1=new vd,eb.e_islandFlag=1,eb.e_awakeFlag=2,eb.e_allowSleepFlag=4,eb.e_bulletFlag=8,eb.e_fixedRotationFlag=16,eb.e_activeFlag=32,eb.b2_staticBody=0,eb.b2_kinematicBody=1,eb.b2_dynamicBody=2;var nm=function t(){HG(this,t),this.position=new ab,this.linearVelocity=new ab,this.angle=0,this.angularVelocity=0,this.linearDamping=0,this.angularDamping=0,this.allowSleep=!0,this.awake=!0,this.fixedRotation=!1,this.bullet=!1,this.type=eb.b2_staticBody,this.active=!0,this.inertiaScale=1};var vj=30;function LK(e){var r=e.canvas,t=new Sb(new ab(0,30),!1),$=new zx;$.density=1,$.friction=.5,$.restitution=.2;var o=new nm;o.type=eb.b2_staticBody,$.shape=new ff;var i=r.width/vj,s=r.height/vj;$.shape.SetAsBox(i/2,1),o.position.Set(i/2,-1),t.CreateBody(o).CreateFixture($),o.position.Set(i/2,s+1),t.CreateBody(o).CreateFixture($),$.shape.SetAsBox(1,s/2),o.position.Set(-1,s/2),t.CreateBody(o).CreateFixture($),o.position.Set(i+1,s/2),t.CreateBody(o).CreateFixture($),o.type=eb.b2_dynamicBody,$.shape=new Rf(i/8),o.position.Set(i/2,s/2),t.CreateBody(o).CreateFixture($);var a=new Mb;a.SetDrawScale(vj),a.SetSprite(e),a.SetFillAlpha(.5),a.SetLineThickness(1),a.SetFlags(Mb.e_shapeBit|Mb.e_jointBit),t.SetDebugDraw(a);return requestAnimationFrame(function e(r){requestAnimationFrame(e),t.Step(1/60,5,5),t.DrawDebugData(),t.ClearForces()}),t}var om={},MK=(yd(),Tb).Buffer;function Ax(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,r=new Uint8Array(e);return e>0&&crypto.getRandomValues(r),MK.from(r.buffer)}om.default=Ax;var NK=document.querySelector("ul"),pm=document.querySelector("pre"),OK=document.querySelector("canvas"),Sf=function(r){pm.textContent+=r,pm.scrollTo({top:pm.scrollHeight,behavior:"smooth"})},Bx=location,PK=Bx.origin,QK=Bx.pathname,RK="".concat(PK).concat(QK).replace("/host","/player"),SK=Ax(),qm=SK.toString("hex").slice(0,7);location.hash="#".concat(qm);var TK={color:{light:"#ffffff66"}};DD(OK,"".concat(RK,"#").concat(qm),TK,function(r){r&&Sf("qrcode error:\n".concat(r.message))});var gf={};var Cx=function(r){requestAnimationFrame(Cx),Object.entries(gf).forEach(function(r){var e=tm(r,2),t=e[0],a=e[1].orientation,n=document.getElementById("connection-".concat(t));if(n){var o=n.querySelector("p");if(o){var $=$v(a);$[1]=-$[1],$[4]=-$[4];var c="matrix3d(".concat($.join(","),")");n.style.transform=c}}})};requestAnimationFrame(Cx);var Dx=function(r){gf[r]&&(gf[r].host.destroy(),delete gf[r]);var e=document.getElementById("connection-".concat(r));e&&e.remove()};Xv.signInAnonymously().then(function(r){if(r&&r.user){var e=r.user.uid,t=Yv.ref("/rooms/".concat(qm)),a=t.child("/connections").ref;t.onDisconnect().set(null);a.on("child_added",function(r){if(r&&r.key){var $Jlv9$$interop$default=Ex(Xp);var t=r.key,a=r.child("offer").ref,n=r.child("answer").ref,o=new $Jlv9$$interop$default.d({initiator:!1,trickle:!1});gf[t]={orientation:[0,0,0,1],host:o};var $=document.createElement("li");$.id="connection-".concat(t);var c,i=document.createElement("canvas");$.append(i);var d=function(r){r?Sf("error:\n".concat(r.message,"\n\n")):gf[t]&&Sf("connection: ".concat(t," - disconnected\n")),Dx(t)};o.on("signal",function(r){"answer"===r.type&&n.set(sm(sm({},r),{},{uid:e}))}).on("connect",function(){Sf("connection: ".concat(t," - connected\n")),NK.appendChild($);var r=new Date().toLocaleTimeString();o.send(JSON.stringify({host:t,time:r}))}).on("error",d).on("close",d).on("end",d).on("data",function(r){var e=JSON.parse(r),a=e.time,n=e.player,d=e.width,y=e.height,l=e.orientation;if(a){var v=new Date().toLocaleTimeString();Sf("\nplayer: ".concat(n," - added\nplayer time: ").concat(a,"\nhost time: ").concat(v,"\n\n")),$.style.width=i.style.width="".concat(d/2,"px"),$.style.height=i.style.height="".concat(y/2,"px"),i.width=d/2,i.height=y/2,c=LK(i.getContext("2d"));var s=document.createElement("p");$.append(s),s.innerText=n;var u=360*Math.random(),x=(u+120*(1+Math.round(Math.random())))%360,G=Math.round(Math.random())?"linear-gradient(hsl(".concat(u,", 80%, 50%), hsl(").concat(x,", 80%, 50%))"):"radial-gradient(circle at center, hsl(".concat(u,", 80%, 50%), hsl(").concat(x,", 80%, 50%))");return $.style.background=G,void o.send(JSON.stringify({bkgd:G}))}var p=tm($v(l),2),m=p[0],f=p[1],h=new ab(-f,m);h.Normalize(),h.Multiply(vj),c.SetGravity(h),gf[t].orientation=l}),a.on("value",function(r){r&&r.val()&&o.signal(r.val())})}}),a.on("child_removed",function(r){if(r&&r.key){var e=r.key;Dx(e),Sf("connection: ".concat(e," - removed\n"))}})}});Yg.__esModule=true;vk.__esModule=true;om.__esModule=true;return{"Jlv9":Xp,"d2yc":Yg,"OJEJ":vk,"Uuoh":{},"ela3":om,"Gdyx":{}};});